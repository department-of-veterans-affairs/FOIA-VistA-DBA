Released QAN*2*26 SEQ #27
Extracted from mail message
**KIDS**:QAN*2.0*26^

**INSTALL NAME**
QAN*2.0*26
"BLD",769,0)
QAN*2.0*26^INCIDENT REPORTING^0^2991122^y
"BLD",769,4,0)
^9.64PA^742.4^2
"BLD",769,4,740,0)
740
"BLD",769,4,740,222)
y^n^f^^^^n
"BLD",769,4,742.4,0)
742.4
"BLD",769,4,742.4,2,0)
^9.641^742.4^1
"BLD",769,4,742.4,2,742.4,0)
QA INCIDENT REPORT  (File-top level)
"BLD",769,4,742.4,2,742.4,1,0)
^9.6411^52^2
"BLD",769,4,742.4,2,742.4,1,.21,0)
INCIDENT TRANSMITTED TO DATABASE
"BLD",769,4,742.4,2,742.4,1,52,0)
DIVISION
"BLD",769,4,742.4,222)
y^n^p^^^^n
"BLD",769,4,"APDD",742.4,742.4)

"BLD",769,4,"APDD",742.4,742.4,.21)

"BLD",769,4,"APDD",742.4,742.4,52)

"BLD",769,4,"B",740,740)

"BLD",769,4,"B",742.4,742.4)

"BLD",769,"ABNS",0)
^9.66A^^
"BLD",769,"ABPKG")
y^n
"BLD",769,"INI")
QAN26PRE
"BLD",769,"INID")
^^y
"BLD",769,"INIT")
QANDBASE
"BLD",769,"KRN",0)
^9.67PA^19^18
"BLD",769,"KRN",.4,0)
.4
"BLD",769,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",769,"KRN",.401,0)
.401
"BLD",769,"KRN",.401,"NM",0)
^9.68A^^0
"BLD",769,"KRN",.402,0)
.402
"BLD",769,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",769,"KRN",.402,"NM",1,0)
QAQA QAN SITE PARAMETERS    FILE #740^740^0
"BLD",769,"KRN",.402,"NM","B","QAQA QAN SITE PARAMETERS    FILE #740",1)

"BLD",769,"KRN",.403,0)
.403
"BLD",769,"KRN",.5,0)
.5
"BLD",769,"KRN",.84,0)
.84
"BLD",769,"KRN",3.6,0)
3.6
"BLD",769,"KRN",3.8,0)
3.8
"BLD",769,"KRN",9.2,0)
9.2
"BLD",769,"KRN",9.8,0)
9.8
"BLD",769,"KRN",9.8,"NM",0)
^9.68A^43^18
"BLD",769,"KRN",9.8,"NM",7,0)
QANAHOC^^0^B23503311
"BLD",769,"KRN",9.8,"NM",27,0)
QANAUX1^^0^B21403297
"BLD",769,"KRN",9.8,"NM",28,0)
QANBENE^^0^B12503309
"BLD",769,"KRN",9.8,"NM",29,0)
QANBENE0^^0^B25480223
"BLD",769,"KRN",9.8,"NM",30,0)
QANBENE1^^0^B19551489
"BLD",769,"KRN",9.8,"NM",31,0)
QANBENE2^^0^B27003308
"BLD",769,"KRN",9.8,"NM",32,0)
QANBENE3^^0^B7524612
"BLD",769,"KRN",9.8,"NM",33,0)
QANOPEN^^0^B15136926
"BLD",769,"KRN",9.8,"NM",34,0)
QANRPT1^^0^B40703019
"BLD",769,"KRN",9.8,"NM",35,0)
QANRPT2^^0^B22159232
"BLD",769,"KRN",9.8,"NM",36,0)
QANUTL4^^0^B23170861
"BLD",769,"KRN",9.8,"NM",37,0)
QANUTL5^^0^B14620419
"BLD",769,"KRN",9.8,"NM",38,0)
QANCDNT^^0^B67154336
"BLD",769,"KRN",9.8,"NM",39,0)
QANUTL3^^0^B9859549
"BLD",769,"KRN",9.8,"NM",40,0)
QANUTL2^^0^B23441520
"BLD",769,"KRN",9.8,"NM",41,0)
QANQUCK^^0^B19039602
"BLD",769,"KRN",9.8,"NM",42,0)
QANEDIT^^0^B48890391
"BLD",769,"KRN",9.8,"NM",43,0)
QANDBASE^^0^B4826024
"BLD",769,"KRN",9.8,"NM","B","QANAHOC",7)

"BLD",769,"KRN",9.8,"NM","B","QANAUX1",27)

"BLD",769,"KRN",9.8,"NM","B","QANBENE",28)

"BLD",769,"KRN",9.8,"NM","B","QANBENE0",29)

"BLD",769,"KRN",9.8,"NM","B","QANBENE1",30)

"BLD",769,"KRN",9.8,"NM","B","QANBENE2",31)

"BLD",769,"KRN",9.8,"NM","B","QANBENE3",32)

"BLD",769,"KRN",9.8,"NM","B","QANCDNT",38)

"BLD",769,"KRN",9.8,"NM","B","QANDBASE",43)

"BLD",769,"KRN",9.8,"NM","B","QANEDIT",42)

"BLD",769,"KRN",9.8,"NM","B","QANOPEN",33)

"BLD",769,"KRN",9.8,"NM","B","QANQUCK",41)

"BLD",769,"KRN",9.8,"NM","B","QANRPT1",34)

"BLD",769,"KRN",9.8,"NM","B","QANRPT2",35)

"BLD",769,"KRN",9.8,"NM","B","QANUTL2",40)

"BLD",769,"KRN",9.8,"NM","B","QANUTL3",39)

"BLD",769,"KRN",9.8,"NM","B","QANUTL4",36)

"BLD",769,"KRN",9.8,"NM","B","QANUTL5",37)

"BLD",769,"KRN",19,0)
19
"BLD",769,"KRN",19,"NM",0)
^9.68A^^0
"BLD",769,"KRN",19.1,0)
19.1
"BLD",769,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",769,"KRN",101,0)
101
"BLD",769,"KRN",409.61,0)
409.61
"BLD",769,"KRN",771,0)
771
"BLD",769,"KRN",869.2,0)
869.2
"BLD",769,"KRN",870,0)
870
"BLD",769,"KRN",8994,0)
8994
"BLD",769,"KRN","B",.4,.4)

"BLD",769,"KRN","B",.401,.401)

"BLD",769,"KRN","B",.402,.402)

"BLD",769,"KRN","B",.403,.403)

"BLD",769,"KRN","B",.5,.5)

"BLD",769,"KRN","B",.84,.84)

"BLD",769,"KRN","B",3.6,3.6)

"BLD",769,"KRN","B",3.8,3.8)

"BLD",769,"KRN","B",9.2,9.2)

"BLD",769,"KRN","B",9.8,9.8)

"BLD",769,"KRN","B",19,19)

"BLD",769,"KRN","B",19.1,19.1)

"BLD",769,"KRN","B",101,101)

"BLD",769,"KRN","B",409.61,409.61)

"BLD",769,"KRN","B",771,771)

"BLD",769,"KRN","B",869.2,869.2)

"BLD",769,"KRN","B",870,870)

"BLD",769,"KRN","B",8994,8994)

"BLD",769,"PRE")

"BLD",769,"QUES",0)
^9.62^^
"BLD",769,"REQB",0)
^9.611^1^1
"BLD",769,"REQB",1,0)
QAN*2.0*27^1
"BLD",769,"REQB","B","QAN*2.0*27",1)

"FIA",740)
QUALITY ASSURANCE SITE PARAMETERS
"FIA",740,0)
^QA(740,
"FIA",740,0,0)
740P
"FIA",740,0,1)
y^n^f^^^^n
"FIA",740,0,10)

"FIA",740,0,11)

"FIA",740,0,"RLRO")

"FIA",740,0,"VR")
2.0^QAN
"FIA",740,740)
0
"FIA",740,740.01)
0
"FIA",740,740.02)
0
"FIA",740,740.03)
0
"FIA",740,740.0752)
0
"FIA",742.4)
QA INCIDENT REPORT
"FIA",742.4,0)
^QA(742.4,
"FIA",742.4,0,0)
742.4I
"FIA",742.4,0,1)
y^n^p^^^^n
"FIA",742.4,0,10)

"FIA",742.4,0,11)

"FIA",742.4,0,"RLRO")

"FIA",742.4,0,"VR")
2.0^QAN
"FIA",742.4,742.4)
1
"FIA",742.4,742.4,.21)

"FIA",742.4,742.4,52)

"INI")
QAN26PRE
"INIT")
QANDBASE
"KRN",.402,1594,-1)
0^1
"KRN",.402,1594,0)
QAQA QAN SITE PARAMETERS^2990602.1511^^740^^^2990916
"KRN",.402,1594,"DIAB",1,1,740.0752,0)
ALL
"KRN",.402,1594,"DR",1,740)
742.01;742.02;742.03;742.04;I $P($G(^QA(740,1,"QAN")),U,5)'=1 S Y="@752";752;@752;
"KRN",.402,1594,"DR",2,740.0752)
.01
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",371,-1)
1^1
"PKG",371,0)
INCIDENT REPORTING^QAN^This package is designed to track a hospital incident.
"PKG",371,20,0)
^9.402P^^
"PKG",371,22,0)
^9.49I^1^1
"PKG",371,22,1,0)
2.0^2921015^2950914
"PKG",371,22,1,"PAH",1,0)
26^2991122
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
19
"RTN","QAN26PRE")
0^^B451024
"RTN","QAN26PRE",1,0)
QAN26PRE ;;WCIOFO/ERC - Pre-install for QAN*2*26 ;7/23/99
"RTN","QAN26PRE",2,0)
 ;;2.0;Incident Reporting;**26**;08/07/1992
"RTN","QAN26PRE",3,0)
 ;
"RTN","QAN26PRE",4,0)
 ;This routine will eliminate two fields from the QA INCIDENTS FILE
"RTN","QAN26PRE",5,0)
 ;(file 742.1) that refer to regions.  It will also set to null the
"RTN","QAN26PRE",6,0)
 ;data in these fields.  The fields are .03 - E-MAIL TO REGION and
"RTN","QAN26PRE",7,0)
 ;.05 NOTIFY RD BY PHONE (IMMEDIATE).
"RTN","QAN26PRE",8,0)
 ;
"RTN","QAN26PRE",9,0)
NULL ;sets to null any data in .03 or .05
"RTN","QAN26PRE",10,0)
 N QANAA
"RTN","QAN26PRE",11,0)
 S QANAA=0
"RTN","QAN26PRE",12,0)
 F  S QANAA=$O(^QA(742.1,QANAA)) Q:QANAA'>0  D
"RTN","QAN26PRE",13,0)
 . S $P(^QA(742.1,QANAA,0),U,3)=""
"RTN","QAN26PRE",14,0)
 . S $P(^QA(742.1,QANAA,0),U,5)=""
"RTN","QAN26PRE",15,0)
 ;
"RTN","QAN26PRE",16,0)
DELE ;delete the fields
"RTN","QAN26PRE",17,0)
 S DIK="^DD(742.1,",DA(1)=742.1
"RTN","QAN26PRE",18,0)
 F DA=.03,.05 D ^DIK
"RTN","QAN26PRE",19,0)
 K DA,DIK
"RTN","QAN26PRE",20,0)
 Q
"RTN","QANAHOC")
0^7^B23503311
"RTN","QANAHOC",1,0)
QANAHOC ;HISC/DAD-Ad Hoc Report interface for the QA Patient Incident Review file (#742) ;2/8/93  10:12
"RTN","QANAHOC",2,0)
 ;;2.0;Incident Reporting;**1,15,17,27,26**;08/07/1992
"RTN","QANAHOC",3,0)
 ; *** Set up required and optional variables and call Ad Hoc Rpt Gen
"RTN","QANAHOC",4,0)
 S QAQMRTN="MENU^QANAHOC",QAQORTN="OTHER^QANAHOC",QAQDIC=742
"RTN","QANAHOC",5,0)
 S QANXIT=0 D ^QAQAHOC0
"RTN","QANAHOC",6,0)
 K %Y,B,D,DIJ,DP,QAND0,QAQ,QANXIT,QAQFOUND,QB,QC
"RTN","QANAHOC",7,0)
 Q
"RTN","QANAHOC",8,0)
CONVERT ;Convert sort parameters for Incident Case Status.
"RTN","QANAHOC",9,0)
 ;Codes from ^DD(742.4,.09,0)
"RTN","QANAHOC",10,0)
 ;0 --->'Closed'               1 --->'Open'
"RTN","QANAHOC",11,0)
 ;2 --->'Deleted'              3 --->'Quick'
"RTN","QANAHOC",12,0)
 Q:'$D(QAQBEGIN(QB))!('$D(QAQEND(QB)))
"RTN","QANAHOC",13,0)
 Q:(QAQBEGIN(QB)=0)&(QAQEND(QB)=0)
"RTN","QANAHOC",14,0)
 Q:(QAQBEGIN(QB)=2)&(QAQEND(QB)=2)
"RTN","QANAHOC",15,0)
 ;Quit if the input vars do not exist, of if 'open' is not included in
"RTN","QANAHOC",16,0)
 ;the sort parameters.
"RTN","QANAHOC",17,0)
 ;If 'open' is included, and 'deleted' is not, screen out 'deleted'.
"RTN","QANAHOC",18,0)
 ;If 'open' is included, and 'closed' is not, screen out 'closed'.
"RTN","QANAHOC",19,0)
 I QAQBEGIN(QB)=0,(QAQEND(QB)=1) D  Q
"RTN","QANAHOC",20,0)
 . S TO(QB)=3
"RTN","QANAHOC",21,0)
 . S DIS(0)="S QAND0=$P($G(^QA(742,D0,0)),U,3) I $G(QAND0)]"""",($P($G(^QA(742.4,QAND0,0)),U,8))#3'>1"
"RTN","QANAHOC",22,0)
 I QAQBEGIN(QB)=0,(QAQEND(QB)=2) S TO(QB)=3 Q
"RTN","QANAHOC",23,0)
 I QAQBEGIN(QB)=1,(QAQEND(QB)=1) D  Q
"RTN","QANAHOC",24,0)
 . S TO(QB)=3
"RTN","QANAHOC",25,0)
 . S DIS(0)="S QAND0=$P($G(^QA(742,D0,0)),U,3) I $G(QAND0)]"""",($P($G(^QA(742.4,QAND0,0)),U,8)>0),($P($G(^QA(742.4,QAND0,0)),U,8)#3'>1)"
"RTN","QANAHOC",26,0)
 I QAQBEGIN(QB)=1,(QAQEND(QB)=2) S TO(QB)=3 Q
"RTN","QANAHOC",27,0)
 Q
"RTN","QANAHOC",28,0)
MENU ; *** Build the menu array
"RTN","QANAHOC",29,0)
 F QA=1:1 S X=$P($T(TEXT+QA),";;",2,99) Q:X=""  S QAQMENU(QA)=X
"RTN","QANAHOC",30,0)
 Q
"RTN","QANAHOC",31,0)
OTHER ; *** Set up other (optional) EN1^DIP variables, e.g.
"RTN","QANAHOC",32,0)
 ; *** DCOPIES,DHD,DHIT,DIOBEG,DIOEND,DIS(),IOP,PG
"RTN","QANAHOC",33,0)
 K DIS,QAQFOUND S QAQFOUND=0,DHIT="S QAQFOUND=1"
"RTN","QANAHOC",34,0)
 S DIOEND="I 'QAQFOUND W !!,""No data found for this report !!"""
"RTN","QANAHOC",35,0)
 ;Check if 'Incident Case Status' is a sort field.
"RTN","QANAHOC",36,0)
 F QB=0:0 S QB=$O(QAQOPTN("S",QB)) Q:QB'>0!(QANXIT)  D
"RTN","QANAHOC",37,0)
 . S QC=$O(QAQOPTN("S",QB,0)) Q:QC'>0
"RTN","QANAHOC",38,0)
 . I $P(QAQOPTN("S",QB,QC),";",1)=".03:,.09" S QANXIT=1 D CONVERT
"RTN","QANAHOC",39,0)
 F  S %=2 W !!?5,"Do you want the report to include 'deleted' records" D YN^DICN Q:"-12"[%  W !?5,"Please answer (Y)es or (N)o."
"RTN","QANAHOC",40,0)
 I %=2 D
"RTN","QANAHOC",41,0)
 . I $D(DIS(0)) S DIS(0)=DIS(0)_",($P($G(^QA(742,D0,0)),U,12)'=-1),($P($G(^QA(742.4,QAND0,0)),U,8)'=2)"
"RTN","QANAHOC",42,0)
 . E  S DIS(0)="S QAND0=$P($G(^QA(742,D0,0)),U,3) I $G(QAND0)]"""",($P($G(^QA(742,D0,0)),U,12)'=-1),($P($G(^QA(742.4,QAND0,0)),U,8)'=2)"
"RTN","QANAHOC",43,0)
 Q
"RTN","QANAHOC",44,0)
TEXT ;;*** Sort Yes/No ^ Menu Text ^ ~Field # ^ DIR(0)
"RTN","QANAHOC",45,0)
 ;;1^Patient^~.01;"Patient"^PAO^2:AEMNQZ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAHOC",46,0)
 ;;1^Patient Id^~.02;"Patient Id"^FAO^1:30^
"RTN","QANAHOC",47,0)
 ;;1^Date of Admission^~.04;"Date Of Admission"^DAO^::AET^S Y=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_(1700+$E(Y,1,3))
"RTN","QANAHOC",48,0)
 ;;1^Patient Type^~.05;"Patient Type"^SO^0:OUTPATIENT;1:INPATIENT;^;I $D(Y(0))#2 S Y=$P(Y(0),U)
"RTN","QANAHOC",49,0)
 ;;1^Ward/Clinic^~.06;"Ward/Clinic"^PAO^44:AEMNQZ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAHOC",50,0)
 ;;1^Treating Specialty^~.07;"Treating Specialty"^PAO^45.7:AEMNQZ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAHOC",51,0)
 ;;1^Service^~.08;"Service"^PAO^730:AEMNQZ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAHOC",52,0)
 ;;1^Responsible Service^.12,~.01;"Responsible Service"^PAO^730:AEMNQZ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAHOC",53,0)
 ;;1^Medication Errors^~.11;"Medication Errors"^PAO^742.13:AEMNQZ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAHOC",54,0)
 ;;0^Case Number^~.03:.01;"Case Number"^FAO^7:13^
"RTN","QANAHOC",55,0)
 ;;1^Incident^~.03:.02;"Incident"^PAO^742.1:AEMNQZ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAHOC",56,0)
 ;;1^Incident Location^~.03:.04;"Incident Location"^PAO^742.5:AEMNQZ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAHOC",57,0)
 ;;1^Type of Death^~.03:.15;"Type of Death"^PAO^742.14:AEMNQZ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAHOC",58,0)
 ;;1^Level of Review^~.03:.12;"Level of Review"^SO^^;I $D(Y(0))#2 S Y=$P(Y(0),U)
"RTN","QANAHOC",59,0)
 ;;1^Date of Incident^~.03:.03;"Date of Incident"^DAO^::AET^S Y=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_(1700+$E(Y,1,3))
"RTN","QANAHOC",60,0)
 ;;1^Incident Case Status^~.03:,.09;"Incident Case Status"^SO^0:CLOSED;1:OPEN;2:DELETED;^;I $D(Y(0))#2 S Y=$P(Y(0),U)
"RTN","QANAHOC",61,0)
 ;;1^Severity Level^~.1;"Severity Level"^SO^0:NO INJURY OR DISABILITY;1:MINOR;2:MAJOR;3:DEATH;^;I $D(Y(0))#2 S Y=$P(Y(0),U)
"RTN","QANAHOC",62,0)
 ;;1^National Case Status^~.03:.17;"National Case Status"^SO^^;I $D(Y(0))#2 S Y=$P(Y(0),U)
"RTN","QANAHOC",63,0)
 ;;0^Fall Assessment Score^~.09;"Fall Assessment Score"^FAO^1:3^
"RTN","QANAHOC",64,0)
 ;;0^Person Reporting the Incident^~.03:.06;"Person Reporting the Incident"^PAO^200:AEMNQZ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAHOC",65,0)
 ;;0^Patient Diagnosis^.15,~.01;"Patient Diagnosis"^FAO^3:60^
"RTN","QANAHOC",66,0)
 ;;0^Medical Center Action^.03:.16;"Medical Center Action"^SO^1:CHANGE IN POLICY/PROCEDURE;2:EDUCATION/TRAINING;3:SYSTEMS CHANGE;4:DISCIPLINARY;5:DISTRICT COUNCIL NOTIFIED;6:NONE INDICATED;^;I $D(Y(0))#2 S Y=$P(Y(0),U)
"RTN","QANAHOC",67,0)
 ;;0^Incident Description^.03:.05;"Incident Description"^
"RTN","QANAHOC",68,0)
 ;;0^Pertinent Information^.03:.2;"Pertinent Information"^
"RTN","QANAHOC",69,0)
 ;;1^Division^~.03:52;"Division"^PAO^4:AEMNZQ^I $D(Y(0,0))#2 S Y=$P(Y(0,0),U)
"RTN","QANAUX1")
0^27^B21403297
"RTN","QANAUX1",1,0)
QANAUX1 ;;HISC/GJC-UTILITIES FOR INCIDENT REPORTING ;4/26/91
"RTN","QANAUX1",2,0)
 ;;2.0;Incident Reporting;**26**;08/07/1992
"RTN","QANAUX1",3,0)
 ;
"RTN","QANAUX1",4,0)
EN0 ;Mark a incident record for deletion, also the associated patient(s).
"RTN","QANAUX1",5,0)
 W !!,$C(7),"This option will allow the user to open, close, or delete a record at the local level.",!,"The appropriate patient(s) records are marked to reflect the change."
"RTN","QANAUX1",6,0)
 K DIC,DINUM,DLAYGO S DIC=742.4,DIC(0)="QEAMZ",DIC("A")="Select Incident: "
"RTN","QANAUX1",7,0)
 D ^DIC K DIC,DINUM,DLAYGO Q:+Y=-1
"RTN","QANAUX1",8,0)
 S QANIEN=+Y K DIE,DR S DIE="^QA(742.4,",DA=QANIEN,DR=".09" D ^DIE K DIE,DR,DA S QAN0=$G(^QA(742.4,QANIEN,0))
"RTN","QANAUX1",9,0)
 I $D(Y)!(QAN0="") W !!,$C(7),"No action taken, premature exit action encountered." G KILL
"RTN","QANAUX1",10,0)
 S QANMSS(0)="W !!,$C(7),""Appropriate Patient(s) records now being marked as deleted!"""
"RTN","QANAUX1",11,0)
 S QANMSS(1)="W !!,$C(7),""Appropriate Patient(s) records now being marked as closed!"""
"RTN","QANAUX1",12,0)
 S QANMSS(2)="W !!,$C(7),""Appropriate Patient(s) records now being marked as open!"""
"RTN","QANAUX1",13,0)
 X $S(+$P(QAN0,U,8)=2:QANMSS(0),+$P(QAN0,U,8)=0:QANMSS(1),1:QANMSS(2))
"RTN","QANAUX1",14,0)
 K DIE,DR S DIE="^QA(742,",DR=$S(+$P(QAN0,U,8)=2:".13///^S X=""-1""",+$P(QAN0,U,8)=0:".13///^S X=""0""",1:".13///^S X=""1""")
"RTN","QANAUX1",15,0)
 F QAN=0:0 S QAN=$O(^QA(742,"BCS",QANIEN,QAN)) Q:QAN'>0  S DA=QAN D ^DIE
"RTN","QANAUX1",16,0)
KILL K QANIEN,QAN0,QAN,DA,DIE,DR,QANMSS,Y
"RTN","QANAUX1",17,0)
 Q
"RTN","QANAUX1",18,0)
EN1 ;Choose the MAILGROUP.
"RTN","QANAUX1",19,0)
 L +^QA(740,1,0):5 I '$T W !!?16,$C(7),"Another person is editing this entry." Q
"RTN","QANAUX1",20,0)
 K DA,DIE,DR S DIE="^QA(740,",DA=1,DR="[QAQA QAN SITE PARAMETERS]" D ^DIE
"RTN","QANAUX1",21,0)
 L -^QA(740,1,0)
"RTN","QANAUX1",22,0)
 K %X,%Y,D,D0,DA,DI,DIC,DIE,DQ,DR
"RTN","QANAUX1",23,0)
 Q
"RTN","QANAUX1",24,0)
EN2 ;INCIDENT STATUS ENTER/EDIT
"RTN","QANAUX1",25,0)
 S (DIC,DIE)="^QA(742.1,",DIC("A")="Select Incident Type: ",DIC(0)="QEALMNZ",D="B^BUPPER",DIC("S")="I $P(^(0),U,6)'=""N"""
"RTN","QANAUX1",26,0)
 D MIX^DIC1 K DIC,DINUM,DLAYGO Q:+Y=-1
"RTN","QANAUX1",27,0)
 S QANQAN=+Y,DA=QANQAN
"RTN","QANAUX1",28,0)
 I $P(Y,U,3)=1 S DR=".07///"_"L" D ^DIE
"RTN","QANAUX1",29,0)
 L +^QA(742.1,QANQAN,0):5 I '$T W !!?16,$C(7),"Another person is editing this entry." Q
"RTN","QANAUX1",30,0)
 S DR=".01  INCIDENT" D ^DIE
"RTN","QANAUX1",31,0)
 I $D(Y) L -^QA(742.1,QANQAN,0) Q
"RTN","QANAUX1",32,0)
 S QAN0=$G(^QA(742.1,QANQAN,0))
"RTN","QANAUX1",33,0)
 S DA=QANQAN,DR=".02;.04;.06" D ^DIE ;remove .03 and .05 from DR in QAN26
"RTN","QANAUX1",34,0)
 K DIR S DIR(0)="SA^1:INACTIVE;L:LOCAL",DIR("A")="Incident Status: "
"RTN","QANAUX1",35,0)
 S DIR("?")="Enter ""1"" for Inactive, ""L"" for Local."
"RTN","QANAUX1",36,0)
 S DIR("B")=$S($P(QAN0,U,6)="L":"LOCAL",1:"INACTIVE") D ^DIR K DIR
"RTN","QANAUX1",37,0)
 I $D(DTOUT)!($D(DUOUT))!($D(DIROUT)) L -^QA(742.1,QANQAN,0) Q
"RTN","QANAUX1",38,0)
 S DR=$S(Y=1:".07///1",1:".07///L") D ^DIE
"RTN","QANAUX1",39,0)
 L -^QA(742.1,QANQAN,0)
"RTN","QANAUX1",40,0)
 Q
"RTN","QANAUX1",41,0)
EN3 ;Choose X again.
"RTN","QANAUX1",42,0)
 W !!?5,$C(7),"Number """_X_""" previously chosen, try again"
"RTN","QANAUX1",43,0)
 K X
"RTN","QANAUX1",44,0)
 Q
"RTN","QANAUX1",45,0)
HDR ;Header generator.
"RTN","QANAUX1",46,0)
 S PAGE=PAGE+1 W @IOF,!,?$S(IOM=132:114,1:69),TODAY,!,?$S(IOM=132:114,1:69),"Page: ",PAGE,!!
"RTN","QANAUX1",47,0)
 W ?(IOM-$L(QANHEAD(0))\2),QANHEAD(0)
"RTN","QANAUX1",48,0)
 I $D(QANCHOS),QANCHOS="I" W !,?(IOM-$L(QANHEAD(1))\2),QANHEAD(1)
"RTN","QANAUX1",49,0)
 I '$D(QANCHOS) W !,?(IOM-$L(QANHEAD(1))\2),QANHEAD(1)
"RTN","QANAUX1",50,0)
 I $D(QANCHOS),QANCHOS="W" W !,?(IOM-$L(QANHEAD(2))\2),QANHEAD(2)
"RTN","QANAUX1",51,0)
 W !,?(IOM-$L(QANHEAD(3))\2),QANHEAD(3),!
"RTN","QANAUX1",52,0)
 I $G(QANDVFLG)=1 W !,?(IOM-$L(QANHEAD(4))\2),QANHEAD(4),!
"RTN","QANAUX1",53,0)
 F LOOP=1:1:2 W BNDRY,!
"RTN","QANAUX1",54,0)
 W:$D(QANCHOS) !,$S(QANCHOS="I":"INCIDENT LOCATION",1:"PATIENT'S WARD"),?35,"INCIDENT",?70,"NUMBER",!,"------------------",?35,"--------",?70,"------",!
"RTN","QANAUX1",55,0)
 W:'$D(QANCHOS) !?17,"INCIDENT",?57,"NUMBER",!?17,"--------",?57,"------"
"RTN","QANAUX1",56,0)
 Q
"RTN","QANAUX1",57,0)
WARN ;Deleting a patient's record.
"RTN","QANAUX1",58,0)
 W !?5,"Patient: ",$P(^DPT($P(^QA(742,QANPAT,0),U),0),U)_"// "
"RTN","QANAUX1",59,0)
WARN1 F QAN=0:0 R QANST:DTIME S:'$T QANST="^" Q:QANST?1"@"!(QANST']"")!(QANST["^")  W !!?5,$C(7),"Enter ""@"" to delete a record, <CR> to keep the patient active.",!!?5,"Patient: ",$P(^DPT($P(^QA(742,QANPAT,0),U),0),U)_"// "
"RTN","QANAUX1",60,0)
 Q:QANST["^"!(QANST']"")
"RTN","QANAUX1",61,0)
WARN2 ;Checks for associated incident deletion
"RTN","QANAUX1",62,0)
 S QANYN=0
"RTN","QANAUX1",63,0)
 I QANST["@" W !!,$C(7),"Are you sure you want to delete?",!,"Deletion marks the associated incident as deleted."
"RTN","QANAUX1",64,0)
 I  K DIR S DIR(0)="Y" D ^DIR S QANYN=+Y
"RTN","QANAUX1",65,0)
 I QANYN K DA,DIE,DR S DIE="^QA(742,",DA=QANPAT,DR=".13///^S X=""-1""" D ^DIE K DA,DIE,DR S DIE="^QA(742.4,",DA=QANINCD,DR=".09///^S X=""2""" D ^DIE K DA,DIE,DR
"RTN","QANAUX1",66,0)
 I QANYN D AUDIT
"RTN","QANAUX1",67,0)
 ;CODE TO DELETE A PATIENT AND DELETE AN INCIDENT
"RTN","QANAUX1",68,0)
 Q
"RTN","QANAUX1",69,0)
AUDIT ;Enter entries in the QA Audit file.
"RTN","QANAUX1",70,0)
 K QAUDIT S QAUDIT("FILE")="742^50",QAUDIT("DA")=QANPAT,QAUDIT("ACTION")="d",QAUDIT("COMMENT")="Delete a patient record" D ^QAQAUDIT
"RTN","QANAUX1",71,0)
 K QAUDIT S QAUDIT("FILE")="742.4^50",QAUDIT("DA")=QANINCD,QAUDIT("ACTION")="d",QAUDIT("COMMENT")="Delete an incident record" D ^QAQAUDIT
"RTN","QANAUX1",72,0)
 Q
"RTN","QANBENE")
0^28^B12503309
"RTN","QANBENE",1,0)
QANBENE ;HISC/GJC-Special incidents invol. a beneficiary ;3/3/92 [ 09/15/95  7:51 AM ]
"RTN","QANBENE",2,0)
 ;;2.0;Incident Reporting;**1,18,23,26**;08/07/1992
"RTN","QANBENE",3,0)
 ;
"RTN","QANBENE",4,0)
 D KILL^QANBENE0,^QAQDATE I QAQQUIT D K^QAQDATE W !!,$C(7),"Invalid date range, no report will be produced." Q
"RTN","QANBENE",5,0)
 S (PAGE,QANCONT,QANQUIT)=0
"RTN","QANBENE",6,0)
 S Y=QAQNBEG D DD^%DT S QANDATE(0)=Y
"RTN","QANBENE",7,0)
 S Y=QAQNEND D DD^%DT S QANDATE(1)=Y
"RTN","QANBENE",8,0)
 S QANLWLT=QAQNBEG-.0000001,QANUPLT=QAQNEND_".9999999"
"RTN","QANBENE",9,0)
 S QANSITE(0)=$S($G(^QA(740,1,0))]"":$P(^(0),U),1:"")
"RTN","QANBENE",10,0)
 I QANSITE(0)']"" W !!,$C(7),"Site Parameters file incomplete, contact your site manager." D KILL^QANBENE0 Q
"RTN","QANBENE",11,0)
 S QANSITE=$$PRIM^VASITE(DT),QANSITE=$$SITE^VASITE(DT,QANSITE)
"RTN","QANBENE",12,0)
 S QANSITE(1)=$P(QANSITE,U,3)
"RTN","QANBENE",13,0)
 S QANSITE=$P(QANSITE,U,2)
"RTN","QANBENE",14,0)
 S QANHEAD(0)="Summary of Incidents Involving Patients (RCS 10-0073)"
"RTN","QANBENE",15,0)
 S QANHEAD(1)="For the period "_QANDATE(0)_" to "_QANDATE(1)
"RTN","QANBENE",16,0)
 S QANHEAD(2)="Site Name: "_QANSITE_"          FTS#:____________________"
"RTN","QANBENE",17,0)
 ;/*** SET UP TABS ***/
"RTN","QANBENE",18,0)
 S QANTAB(1)=$J(((5/80)*IOM),2,0),QANTAB(2)=$J(((10/80)*IOM),2,0),QANTAB(3)=$J(((25/80)*IOM),2,0),QANTAB(4)=$J(((27/80)*IOM),2,0),QANTAB(5)=$J(((45/80)*IOM),2,0),QANTAB(6)=$J(((55/80)*IOM),2,0)
"RTN","QANBENE",19,0)
 ;/*** SET UP TABS ***/
"RTN","QANBENE",20,0)
 D DIV^QANRPT1
"RTN","QANBENE",21,0)
 K DIR S DIR(0)="FAO^1:1^K:""BCO""'[X X",DIR("A")="Select Incident Status (B/C/O): ",DIR("?")="Enter ""O"" to select open cases, ""C"" for closed cases, or ""B"" for both open and closed cases" D ^DIR K DIR
"RTN","QANBENE",22,0)
 I $D(DIRUT) D KILL^QANBENE0 Q
"RTN","QANBENE",23,0)
 S QANFLG("IR STAT")=$S("B"[Y:"013","C"[Y:"0",1:"13") ;set IR Status flag
"RTN","QANBENE",24,0)
EN2 ;Call to ^QANBENE0
"RTN","QANBENE",25,0)
 D EN1^QANBENE0
"RTN","QANBENE",26,0)
 Q
"RTN","QANBENE",27,0)
VALID ;Validate as a reportable incident.
"RTN","QANBENE",28,0)
 S QANSWCH=0
"RTN","QANBENE",29,0)
 I $D(^QA(742.1,"BUPPER","PATIENT ABUSE",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",30,0)
 I $D(^QA(742.1,"BUPPER","DEATH",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",31,0)
 I $D(^QA(742.1,"BUPPER","INFORMED CONSENT-FAIL. TO OBTAIN",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",32,0)
 I $D(^QA(742.1,"BUPPER","FALL",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",33,0)
 I $D(^QA(742.1,"BUPPER","HOMICIDE",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",34,0)
 I $D(^QA(742.1,"BUPPER","MEDICATION ERROR",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",35,0)
 I $D(^QA(742.1,"BUPPER","MISSING PATIENT",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",36,0)
 I $D(^QA(742.1,"BUPPER","ASSAULT-PATIENT TO PATIENT",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",37,0)
 I $D(^QA(742.1,"BUPPER","INFORMED CONSENT, FAIL. TO OBTAIN",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",38,0)
 I $D(^QA(742.1,"BUPPER","ASSAULT-PATIENT/STAFF",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",39,0)
 I $D(^QA(742.1,"BUPPER","ASSAULT, PATIENT TO PATIENT",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",40,0)
 I $D(^QA(742.1,"BUPPER","ASSAULT, PATIENT/STAFF",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",41,0)
 I $D(^QA(742.1,"BUPPER","FIRE, PATIENT INVOLVED IN",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",42,0)
 I $D(^QA(742.1,"BUPPER","INJURY NOT OTHERWISE LISTED",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",43,0)
 I $D(^QA(742.1,"BUPPER","FIRE-PATIENT INVOLVED IN",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",44,0)
 I $D(^QA(742.1,"BUPPER","SEXUAL ASSAULT",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",45,0)
 I $D(^QA(742.1,"BUPPER","SUICIDE ATTEMPT",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",46,0)
 I $D(^QA(742.1,"BUPPER","SUICIDE",QAN("INC"))) S QANSWCH=1 Q
"RTN","QANBENE",47,0)
 I $D(^QA(742.1,"BUPPER","TRANSFUSION ERROR",QAN("INC"))) S QANSWCH=1
"RTN","QANBENE",48,0)
 Q
"RTN","QANBENE0")
0^29^B25480223
"RTN","QANBENE0",1,0)
QANBENE0 ;HISC/GJC-SPECIAL INCIDENTS INVOL. A BENEFICIARY ;4/13/93  08:24
"RTN","QANBENE0",2,0)
 ;;2.0;Incident Reporting;**18,26**;08/07/1992
"RTN","QANBENE0",3,0)
 ;
"RTN","QANBENE0",4,0)
EN1 ;/*** Catagorize incidents ***/
"RTN","QANBENE0",5,0)
 K DIR S DIR(0)="FAO^1:1^K:""ACDINO""'[X X",DIR("A")="Select Ward type (A/C/D/I/N/O): "
"RTN","QANBENE0",6,0)
 S DIR("?",1)="Enter ""A"" to generate separate reports for Domiciliaries, NHCU'S, "
"RTN","QANBENE0",7,0)
 S DIR("?",2)="Inpatients and Outpatients."
"RTN","QANBENE0",8,0)
 S DIR("?",3)="Enter ""C"" to generate a report of combined data for Domiciliaries, NHCU'S, "
"RTN","QANBENE0",9,0)
 S DIR("?",4)="Inpatients and Outpatients."
"RTN","QANBENE0",10,0)
 S DIR("?",5)="Enter ""D"" for Domiciliary, ""I"" for Inpatients other than Domiciliary or "
"RTN","QANBENE0",11,0)
 S DIR("?")="NHCU, ""N"" for NHCU units, or ""O"" for Outpatients."
"RTN","QANBENE0",12,0)
 D ^DIR K DIR
"RTN","QANBENE0",13,0)
 I $D(DIRUT) D KILL Q
"RTN","QANBENE0",14,0)
 S QANFLG("WARD")=Y
"RTN","QANBENE0",15,0)
TASK ;Call to %ZTLOAD
"RTN","QANBENE0",16,0)
 S Y=DT X ^DD("DD") S TODAY=Y
"RTN","QANBENE0",17,0)
 K IOP,%ZIS S %ZIS("A")="Print on device: ",%ZIS="MQ" W ! D ^%ZIS W !!
"RTN","QANBENE0",18,0)
 G:POP KILL
"RTN","QANBENE0",19,0)
 I $D(IO("Q")) S ZTRTN="START^QANBENE0",ZTDESC="Generate Special Incident Reports For A Beneficiary." D QLOOP,^%ZTLOAD W !,$S($D(ZTSK):"Request Queued!",1:"Request Cancelled!"),! G EXIT
"RTN","QANBENE0",20,0)
START ;IO requests
"RTN","QANBENE0",21,0)
 U IO
"RTN","QANBENE0",22,0)
 I QANFLG("WARD")="A" S QANFLG("WARD A")="D^I^N^O"
"RTN","QANBENE0",23,0)
 I $D(QANFLG("WARD A")),(QANFLG("WARD A")="D^I^N^O") F QAN=1:1:$L(QANFLG("WARD A"),"^") S QANFLG("WARD")=$P(QANFLG("WARD A"),"^",QAN) Q:QANFLG("WARD")']""  D
"RTN","QANBENE0",24,0)
 . W @IOF
"RTN","QANBENE0",25,0)
 . S PAGE=0
"RTN","QANBENE0",26,0)
 . K ^TMP("QANBEN",$J),QANCOUNT
"RTN","QANBENE0",27,0)
 . D GO D:'QANQUIT HDH^QANBENE3 Q:QANQUIT
"RTN","QANBENE0",28,0)
 G:QANQUIT EXIT
"RTN","QANBENE0",29,0)
 I '$D(QANFLG("WARD A")) D GO
"RTN","QANBENE0",30,0)
EXIT ;
"RTN","QANBENE0",31,0)
 W ! D ^%ZISC,HOME^%ZIS
"RTN","QANBENE0",32,0)
KILL ;Kill and quit.
"RTN","QANBENE0",33,0)
 K %ZIS,D,DIC,DIRUT,I,PAGE,POP
"RTN","QANBENE0",34,0)
 K QAN,QAN742,QAN7424,QANAA,QANAB,QANBB,QANBENE,QANCC,QANCONT
"RTN","QANBENE0",35,0)
 K QANCOUNT,QANDATE,QAN1DIV,QANDIV,QANDTH,QANDV,QANDVFLG
"RTN","QANBENE0",36,0)
 K QANFLG,QANHEAD,QANHLOC,QANINPT,QANLBL,QANLP,QANLWLT
"RTN","QANBENE0",37,0)
 K QANPTTY,QANQUIT,QANSLEV,QANSTAT,QANTAB,QANUPLT,QANWARD
"RTN","QANBENE0",38,0)
 K QANINVST,QANSITE,QANSWCH,QANWHICH
"RTN","QANBENE0",39,0)
 K QAQNBEG,QAQNEND
"RTN","QANBENE0",40,0)
 K TODAY,X,Y,ZTDESC,ZTRTN,ZTSAVE,ZTSK
"RTN","QANBENE0",41,0)
 D K^QAQDATE
"RTN","QANBENE0",42,0)
 K ^TMP("QANBEN",$J)
"RTN","QANBENE0",43,0)
 Q
"RTN","QANBENE0",44,0)
GO ;Set up variables.
"RTN","QANBENE0",45,0)
 S QANLP=QANLWLT
"RTN","QANBENE0",46,0)
 F  S QANLP=$O(^QA(742.4,"BDT",QANLP)) Q:QANLP'>0!(QANLP>QANUPLT)  D
"RTN","QANBENE0",47,0)
 . S QANLP(1)=0
"RTN","QANBENE0",48,0)
 . F  S QANLP(1)=$O(^QA(742.4,"BDT",QANLP,QANLP(1))) Q:QANLP(1)'>0  D
"RTN","QANBENE0",49,0)
 . . I $G(^QA(742.4,QANLP(1),0))]"" D LGIC I QANQUIT S QANQUIT=0 Q
"RTN","QANBENE0",50,0)
 . . S QANLP(2)=0
"RTN","QANBENE0",51,0)
 . . F  S QANLP(2)=$O(^QA(742,"BCS",QANLP(1),QANLP(2))) Q:QANLP(2)'>0  D
"RTN","QANBENE0",52,0)
 . . . I $G(^QA(742,QANLP(2),0)) D LGIC1
"RTN","QANBENE0",53,0)
 . . . I QANQUIT S QANQUIT=0 Q
"RTN","QANBENE0",54,0)
 . . . S ^TMP("QANBEN",$J,"BEN",QANDIV,QANWARD,QANLP(1),QANLP(2))=""
"RTN","QANBENE0",55,0)
 S QANHEAD(3)=$S(QANFLG("WARD")="I":"INPATIENTS",QANFLG("WARD")="D":"DOMICILIARY",QANFLG("WARD")="N":"NHCU",QANFLG("WARD")="O":"OUTPATIENTS",1:"ALL INCIDENTS REGARDLESS OF LOCATION")
"RTN","QANBENE0",56,0)
 I $G(QANDVFLG)'=1 D HDR
"RTN","QANBENE0",57,0)
 D EN1^QANBENE1
"RTN","QANBENE0",58,0)
 Q
"RTN","QANBENE0",59,0)
LGIC ;Set up valid incidents
"RTN","QANBENE0",60,0)
 S QAN7424=^QA(742.4,QANLP(1),0),QAN("INC")=$P(QAN7424,U,2)
"RTN","QANBENE0",61,0)
 Q:QAN("INC")'<200  ;Quit if NOT a National incident.
"RTN","QANBENE0",62,0)
 D VALID^QANBENE Q:'QANSWCH  ;Quit if NOT a valid incident.
"RTN","QANBENE0",63,0)
 S QANSTAT=+$P(QAN7424,U,8),QANBENE=+$P(QAN7424,U,17)
"RTN","QANBENE0",64,0)
 I 'QANBENE!(QANFLG("IR STAT")'[QANSTAT) S QANQUIT=1 Q
"RTN","QANBENE0",65,0)
 S QANDIV=$P(QAN7424,U,22)
"RTN","QANBENE0",66,0)
 I $G(QANDIV)']"" S QANDIV=0
"RTN","QANBENE0",67,0)
 I $G(QAN1DIV)]"" I QAN1DIV'=QANDIV S QANQUIT=1 Q
"RTN","QANBENE0",68,0)
 I '$D(^QA(740,1,"QAN2","B",QANDIV)) S QANDIV=0
"RTN","QANBENE0",69,0)
 I $G(QANDVFLG)'=1 S QANDIV=0
"RTN","QANBENE0",70,0)
 I $G(QANQUIT) Q
"RTN","QANBENE0",71,0)
 Q
"RTN","QANBENE0",72,0)
HDR ;Header generator.
"RTN","QANBENE0",73,0)
 S PAGE=PAGE+1 W @IOF,!?69,TODAY,!?69,"Page: ",PAGE,!!
"RTN","QANBENE0",74,0)
 W ?(IOM-$L(QANHEAD(0))\2),QANHEAD(0),!,?(IOM-$L(QANHEAD(1))\2),QANHEAD(1),!
"RTN","QANBENE0",75,0)
 W !?(IOM-$L(QANHEAD(2))\2),QANHEAD(2),!
"RTN","QANBENE0",76,0)
 W !?(IOM-$L(QANHEAD(3))\2),QANHEAD(3)
"RTN","QANBENE0",77,0)
 I $G(QANDVFLG)=1,($G(QANHEAD(4))) W !?(IOM-$L(QANHEAD(4))\2),QANHEAD(4)
"RTN","QANBENE0",78,0)
 W !!?QANTAB(5),"Total",?QANTAB(6),"Resulted in"
"RTN","QANBENE0",79,0)
 W !?QANTAB(2),"Incident",?QANTAB(4),"Severity",?QANTAB(5),"Number",?QANTAB(6),"Investigation",!?QANTAB(2),"--------",?QANTAB(4),"--------",?QANTAB(5),"------",?QANTAB(6),"-------------"
"RTN","QANBENE0",80,0)
 I QANCONT,$D(QANLBL) W !!?QANTAB(2),QANLBL_" (cont)"
"RTN","QANBENE0",81,0)
 Q
"RTN","QANBENE0",82,0)
LGIC1 ;Sorting wards into categories.
"RTN","QANBENE0",83,0)
 Q:$D(^QA(742,"BPRS",-1,QANLP(2)))  ;Quit if a deleted patient
"RTN","QANBENE0",84,0)
 S QAN742=^QA(742,QANLP(2),0)
"RTN","QANBENE0",85,0)
 S QANPTTY=+$P(QAN742,U,5),QANWARD=+$P(QAN742,U,6),QANSLEV=+$P(QAN742,U,10)
"RTN","QANBENE0",86,0)
 I $G(QANWARD)'>0 S QANQUIT=1 Q
"RTN","QANBENE0",87,0)
 I '$D(^SC(QANWARD)) S QANQUIT=1 Q
"RTN","QANBENE0",88,0)
 D WARD
"RTN","QANBENE0",89,0)
 Q
"RTN","QANBENE0",90,0)
QLOOP ;Save variables for %ZTLOAD.
"RTN","QANBENE0",91,0)
 F I="^TMP(""QANBEN"",$J,","PAGE","TODAY","QAN*","QAQ*" S ZTSAVE(I)=""
"RTN","QANBENE0",92,0)
 Q
"RTN","QANBENE0",93,0)
WARD ;determine if record should be included in report
"RTN","QANBENE0",94,0)
 S QANWARD=$G(^SC(QANWARD,42)) D
"RTN","QANBENE0",95,0)
 . I $G(QANWARD)']"" S QANWARD="O" Q
"RTN","QANBENE0",96,0)
 . I $G(QANWARD) S QANWARD=$P(^DIC(42,QANWARD,0),U,3)
"RTN","QANBENE0",97,0)
 . I $G(QANWARD)]"" S QANWARD=$S($G(QANWARD)="D":"D",$G(QANWARD)="NH":"N",1:"I") Q
"RTN","QANBENE0",98,0)
 . I $G(QANWARD)']"" S QANWARD="O"
"RTN","QANBENE0",99,0)
 S QANXXX=$S(QANFLG("WARD")="C":1,QANFLG("WARD")="A":1,QANFLG("WARD")=QANWARD:1,$G(QANFLG("WARD A")):1,1:0)
"RTN","QANBENE0",100,0)
 I QANXXX<1 S QANQUIT=1 Q
"RTN","QANBENE0",101,0)
 Q
"RTN","QANBENE0",102,0)
TALLY ;create and increment globals for report
"RTN","QANBENE0",103,0)
 ;S ^TMP("QANBEN",$J,"LBL",QANDIV,QANWARD,QANLBL)=$G(^TMP("QANBEN",$J,"LBL",QANDIV,QANWARD,QANLBL))+1
"RTN","QANBENE0",104,0)
 ;S ^TMP("QANBEN",$J,"SLEV",QANDIV,QANWARD,QANLBL,QANSLEV)=$G(TMP("QANBEN",$J,"SLEV",QANDIV,QANWARD,QANLBL,QANSLEV))+1
"RTN","QANBENE0",105,0)
 ;S ^TMP("QANBEN",$J,"INV",QANDIV,QANWARD,QANLBL,QANSLEV,QANINVST)=$G(^TMP("QANBEN",$J,"INV",QANDIV,QANWARD,QANLBL,QANSLEV,QANINVST))+1
"RTN","QANBENE0",106,0)
 S QANCOUNT("SLEV",QANAA,QANLBL,QANSLEV)=$G(QANCOUNT("SLEV",QANAA,QANLBL,QANSLEV))+1
"RTN","QANBENE0",107,0)
 I $G(QANINVST)>1 S QANCOUNT("INV",QANAA,QANLBL,QANSLEV)=$G(QANCOUNT("INV",QANAA,QANLBL,QANSLEV))+1
"RTN","QANBENE0",108,0)
 Q
"RTN","QANBENE1")
0^30^B19551489
"RTN","QANBENE1",1,0)
QANBENE1 ;HISC/GJC-Special incidents invol. a beneficiary ;3/3/92
"RTN","QANBENE1",2,0)
 ;;2.0;Incident Reporting;**1,8,11,18,26**;08/07/1992
"RTN","QANBENE1",3,0)
 ;
"RTN","QANBENE1",4,0)
EN1 ;Format of the print for our Beneficiary Report.
"RTN","QANBENE1",5,0)
 S QANWHICH=$S(QANFLG("WARD")="D":"Domiciliary",QANFLG("WARD")="NH":"NHCU",QANFLG("WARD")="I":"Inpatient",QANFLG("WARD")="O":"Outpatient",1:"total")
"RTN","QANBENE1",6,0)
 ;I '$D(^TMP("QANBEN",$J,"BEN")) F  W ! D:$Y>(IOSL-4) PRINT^QANBENE3 Q:$Y>(IOSL-4)
"RTN","QANBENE1",7,0)
 I '$D(^TMP("QANBEN",$J,"BEN")) D PRINT^QANBENE3 Q
"RTN","QANBENE1",8,0)
 ;Q:'$D(^TMP("QANBEN",$J,"BEN"))
"RTN","QANBENE1",9,0)
 S QANAA=""
"RTN","QANBENE1",10,0)
 F  S QANAA=$O(^TMP("QANBEN",$J,"BEN",QANAA)) Q:QANAA']""  D
"RTN","QANBENE1",11,0)
 . S QANBB=""
"RTN","QANBENE1",12,0)
 . F  S QANBB=$O(^TMP("QANBEN",$J,"BEN",QANAA,QANBB)) Q:QANBB']""  D
"RTN","QANBENE1",13,0)
 . . S QANLP(1)=0
"RTN","QANBENE1",14,0)
 . . F  S QANLP(1)=$O(^TMP("QANBEN",$J,"BEN",QANAA,QANBB,QANLP(1))) Q:QANLP(1)'>0  D INC
"RTN","QANBENE1",15,0)
 I '$D(^TMP("QANBEN",$J,"BEN")) W !!,"There exist zero (0) "_QANWHICH_" incidents for this date range."
"RTN","QANBENE1",16,0)
 D EN1^QANBENE2 ;Prints out the data.
"RTN","QANBENE1",17,0)
 Q
"RTN","QANBENE1",18,0)
INC ;Checks for appropriate incident data.
"RTN","QANBENE1",19,0)
 K QANLBL S QAN7424=$G(^QA(742.4,QANLP(1),0)) Q:QAN7424']""
"RTN","QANBENE1",20,0)
 S QANINPT=$P(QAN7424,U,2),QANINVST=+$P(QAN7424,U,11)
"RTN","QANBENE1",21,0)
 I $D(^QA(742.1,"BUPPER","PATIENT ABUSE",QANINPT)) D PROVE Q
"RTN","QANBENE1",22,0)
 I $D(^QA(742.1,"BUPPER","DEATH",QANINPT)) D DEATH Q
"RTN","QANBENE1",23,0)
 I $D(^QA(742.1,"BUPPER","FALL",QANINPT)) S QANLBL="FALLS"
"RTN","QANBENE1",24,0)
 I $D(^QA(742.1,"BUPPER","INFORMED CONSENT-FAIL. TO OBTAIN",QANINPT)) S QANLBL="INFORMED"
"RTN","QANBENE1",25,0)
 I $D(^QA(742.1,"BUPPER","INFORMED CONSENT, FAIL. TO OBTAIN",QANINPT)) S QANLBL="INFORMED"
"RTN","QANBENE1",26,0)
 I $D(^QA(742.1,"BUPPER","HOMICIDE",QANINPT)) S QANLBL="HOMICIDE"
"RTN","QANBENE1",27,0)
 I $D(^QA(742.1,"BUPPER","MEDICATION ERROR",QANINPT)) S QANLBL="MED ERR"
"RTN","QANBENE1",28,0)
 I $D(^QA(742.1,"BUPPER","MISSING PATIENT",QANINPT)) S QANLBL="MISSING PAT"
"RTN","QANBENE1",29,0)
 I $D(^QA(742.1,"BUPPER","ASSAULT-PATIENT TO PATIENT",QANINPT)) S QANLBL="ASSAULT PAT/PAT"
"RTN","QANBENE1",30,0)
 I $D(^QA(742.1,"BUPPER","ASSAULT, PATIENT TO PATIENT",QANINPT)) S QANLBL="ASSAULT PAT/PAT"
"RTN","QANBENE1",31,0)
 I $D(^QA(742.1,"BUPPER","ASSAULT-PATIENT/STAFF",QANINPT)) S QANLBL="ASSAULT PAT/STAFF"
"RTN","QANBENE1",32,0)
 I $D(^QA(742.1,"BUPPER","ASSAULT, PATIENT/STAFF",QANINPT)) S QANLBL="ASSAULT PAT/STAFF"
"RTN","QANBENE1",33,0)
 I $D(^QA(742.1,"BUPPER","INJURY NOT OTHERWISE LISTED",QANINPT)) S QANLBL="OTHER"
"RTN","QANBENE1",34,0)
 I $D(^QA(742.1,"BUPPER","FIRE-PATIENT INVOLVED IN",QANINPT)) S QANLBL="FIRE"
"RTN","QANBENE1",35,0)
 I $D(^QA(742.1,"BUPPER","FIRE, PATIENT INVOLVED IN",QANINPT)) S QANLBL="FIRE"
"RTN","QANBENE1",36,0)
 I $D(^QA(742.1,"BUPPER","SEXUAL ASSAULT",QANINPT)) S QANLBL="SEX"
"RTN","QANBENE1",37,0)
 I $D(^QA(742.1,"BUPPER","SUICIDE ATTEMPT",QANINPT)) S QANLBL="SUI ATT"
"RTN","QANBENE1",38,0)
 I $D(^QA(742.1,"BUPPER","SUICIDE",QANINPT)) S QANLBL="SUICIDE"
"RTN","QANBENE1",39,0)
 I $D(^QA(742.1,"BUPPER","TRANSFUSION ERROR",QANINPT)) S QANLBL="TRANS ERR"
"RTN","QANBENE1",40,0)
 Q:$G(QANLBL)']""  ;Not a valid label
"RTN","QANBENE1",41,0)
 F QANLP(2)=0:0 S QANLP(2)=$O(^TMP("QANBEN",$J,"BEN",QANAA,QANBB,QANLP(1),QANLP(2))) Q:QANLP(2)'>0  D
"RTN","QANBENE1",42,0)
 . S QANSLEV=$P(^QA(742,QANLP(2),0),U,10) Q:$G(QANSLEV)']""
"RTN","QANBENE1",43,0)
 . I $G(QANLBL)]"" D TALLY^QANBENE0
"RTN","QANBENE1",44,0)
 I '$D(^TMP("QANBEN",$J,"BEN")) W !!,"There exist zero (0) incidents within this data range." Q
"RTN","QANBENE1",45,0)
 Q
"RTN","QANBENE1",46,0)
DEATH ;Tracking Deaths.
"RTN","QANBENE1",47,0)
 F QANLP(2)=0:0 S QANLP(2)=$O(^TMP("QANBEN",$J,"BEN",QANAA,QANBB,QANLP(1),QANLP(2))) Q:QANLP(2)'>0  D
"RTN","QANBENE1",48,0)
 . S QANSLEV=$P(^QA(742,QANLP(2),0),U,10) Q:'$G(QANSLEV)
"RTN","QANBENE1",49,0)
 . D DEATH1
"RTN","QANBENE1",50,0)
 . Q:$G(QANDTH)']""
"RTN","QANBENE1",51,0)
 . D:$G(QANLBL)]"" TALLY^QANBENE0
"RTN","QANBENE1",52,0)
 Q
"RTN","QANBENE1",53,0)
DEATH1 ;Tracking Deaths.
"RTN","QANBENE1",54,0)
 S QANDTH=$P(QAN7424,U,14) Q:QANDTH']""
"RTN","QANBENE1",55,0)
 Q:$D(^QA(742.14,"BUPPER","OTHER",QANDTH))
"RTN","QANBENE1",56,0)
 Q:$D(^QA(742.14,"BUPPER","WITHIN 24 HOURS OF ADMISSION (EX. DOA'S AND TERMINALS)",QANDTH))
"RTN","QANBENE1",57,0)
 I $D(^QA(742.14,"BUPPER","CONJUNCTION WITH A PROCEDURE",QANDTH)) S QANLBL="DEATH-CON"
"RTN","QANBENE1",58,0)
 I $D(^QA(742.14,"BUPPER","DURING INDUCTION OF ANES.",QANDTH)) S QANLBL="DEATH-ANESTH"
"RTN","QANBENE1",59,0)
 I $D(^QA(742.14,"BUPPER","FAILURE TO DIAGNOSE OR TREAT",QANDTH)) S QANLBL="DEATH-FAIL"
"RTN","QANBENE1",60,0)
 I $D(^QA(742.14,"BUPPER","ON MEDICAL CENTER GROUNDS",QANDTH)) S QANLBL="DEATH-MED CEN"
"RTN","QANBENE1",61,0)
 I $D(^QA(742.14,"BUPPER","OPERATING ROOM",QANDTH)) S QANLBL="DEATH-OR"
"RTN","QANBENE1",62,0)
 I $D(^QA(742.14,"BUPPER","RECOVERY ROOM",QANDTH)) S QANLBL="DEATH-RR"
"RTN","QANBENE1",63,0)
 I $D(^QA(742.14,"BUPPER","CASES ACCEPTED BY M.E.",QANDTH)) S QANLBL="DEATH-M.E."
"RTN","QANBENE1",64,0)
 I $D(^QA(742.14,"BUPPER","EQUIPMENT MALFUNCTION",QANDTH)) S QANLBL="DEATH-EQ"
"RTN","QANBENE1",65,0)
 I $D(^QA(742.14,"BUPPER","WITHIN 48 HOURS OF SURGERY",QANDTH)) S QANLBL="DEATH-48"
"RTN","QANBENE1",66,0)
 Q
"RTN","QANBENE1",67,0)
PROVE ;Sets Patient Abuse Array.
"RTN","QANBENE1",68,0)
 S QANAB=+$P(QAN7424,U,16),QANLBL=$S(QANAB=1:"PATIENT ABUSE/PROVEN",1:"PATIENT ABUSE/ALLEGED")
"RTN","QANBENE1",69,0)
 F QANLP(2)=0:0 S QANLP(2)=$O(^TMP("QANBEN",$J,"BEN",QANAA,QANBB,QANLP(1),QANLP(2))) Q:QANLP(2)'>0  D
"RTN","QANBENE1",70,0)
 . S QANSLEV=$P(^QA(742,QANLP(2),0),U,10)
"RTN","QANBENE1",71,0)
 . Q:$G(QANLBL)']""!('$G(QANSLEV))
"RTN","QANBENE1",72,0)
 . D TALLY^QANBENE0
"RTN","QANBENE1",73,0)
 Q
"RTN","QANBENE2")
0^31^B27003308
"RTN","QANBENE2",1,0)
QANBENE2 ;HISC/GJC-Special incidents invol. a beneficiary ;3/3/92
"RTN","QANBENE2",2,0)
 ;;2.0;Incident Reporting;**1,26**;08/07/1992
"RTN","QANBENE2",3,0)
 ;
"RTN","QANBENE2",4,0)
EN1 ;sort through divisions, if integrated
"RTN","QANBENE2",5,0)
 I $G(QANDVFLG) D  Q
"RTN","QANBENE2",6,0)
 . S QANCC=""
"RTN","QANBENE2",7,0)
 . F  S QANCC=$O(^TMP("QANBEN",$J,"BEN",QANCC)) Q:QANCC']""  D
"RTN","QANBENE2",8,0)
 . . D INST^QANRPT1(QANCC,.QANDV)
"RTN","QANBENE2",9,0)
 . . S QANHEAD(4)="REPORT FOR DIVISION: "_QANDV
"RTN","QANBENE2",10,0)
 . . D HDH Q:QANQUIT
"RTN","QANBENE2",11,0)
 . . D EN2
"RTN","QANBENE2",12,0)
 I $G(QANDVFLG)']"" S (QANCC,QANDIV)=0,QANDV="Unknown"
"RTN","QANBENE2",13,0)
EN2 ;Format of the print for our Beneficiary Report.
"RTN","QANBENE2",14,0)
 S QANLBL="PATIENT ABUSE/ALLEGED"
"RTN","QANBENE2",15,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",16,0)
 W !!?QANTAB(1),"(1)",?QANTAB(2),"Alleged Patient Abuse" D STNDRD Q:QANQUIT
"RTN","QANBENE2",17,0)
 S QANLBL="PATIENT ABUSE/PROVEN"
"RTN","QANBENE2",18,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",19,0)
 W !!?QANTAB(1),"(2)",?QANTAB(2),"Proven Patient Abuse" D SPECIAL^QANBENE3 Q:QANQUIT
"RTN","QANBENE2",20,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",21,0)
 W !!?QANTAB(1),"(3)",?QANTAB(2),"Deaths" D DEATH Q:QANQUIT
"RTN","QANBENE2",22,0)
 S QANLBL="INFORMED"
"RTN","QANBENE2",23,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",24,0)
 W !!?QANTAB(1),"(4)",?QANTAB(2),"Failure to Obtain",!?QANTAB(2),"Informed Consent" D RGLAR Q:QANQUIT
"RTN","QANBENE2",25,0)
 S QANLBL="FALLS"
"RTN","QANBENE2",26,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",27,0)
 W !!?QANTAB(1),"(5)",?QANTAB(2),"Falls" D STNDRD Q:QANQUIT
"RTN","QANBENE2",28,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",29,0)
 S QANLBL="HOMICIDE"
"RTN","QANBENE2",30,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",31,0)
 W !!?QANTAB(1),"(6)",?QANTAB(2),"Homicide" D RGLAR2 Q:QANQUIT
"RTN","QANBENE2",32,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",33,0)
 S QANLBL="MED ERR"
"RTN","QANBENE2",34,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",35,0)
 W !!?QANTAB(1),"(7)",?QANTAB(2),"Medication Errors" D STNDRD Q:QANQUIT
"RTN","QANBENE2",36,0)
 I PAGE,($E(IOST)'="C") D PRINT^QANBENE3
"RTN","QANBENE2",37,0)
 D:$Y>(IOSL-8) HDH Q:QANQUIT
"RTN","QANBENE2",38,0)
 S QANLBL="MISSING PAT"
"RTN","QANBENE2",39,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",40,0)
 W !!?QANTAB(1),"(8)",?QANTAB(2),"Missing Patient" D STNDRD Q:QANQUIT
"RTN","QANBENE2",41,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",42,0)
 S QANLBL="ASSAULT PAT/PAT"
"RTN","QANBENE2",43,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",44,0)
 W !!?QANTAB(1),"(9)",?QANTAB(2),"Patient on Patient",!?QANTAB(2),"Assault" D STNDRD Q:QANQUIT
"RTN","QANBENE2",45,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",46,0)
 D EN1^QANBENE3 Q:QANQUIT
"RTN","QANBENE2",47,0)
 Q
"RTN","QANBENE2",48,0)
DEATH ;Prints for deaths.
"RTN","QANBENE2",49,0)
 S QANLBL="DEATH-OR"
"RTN","QANBENE2",50,0)
 W !?QANTAB(3),"In Operating Room",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",51,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",52,0)
 S QANLBL="DEATH-RR"
"RTN","QANBENE2",53,0)
 W !?QANTAB(3),"In Recovery Room",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",54,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",55,0)
 S QANLBL="DEATH-ANESTH" W !?QANTAB(3),"During induction"
"RTN","QANBENE2",56,0)
 W !?QANTAB(3)," of anesthesia",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",57,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",58,0)
 S QANLBL="DEATH-48" W !?QANTAB(3),"Within 48 hrs. of"
"RTN","QANBENE2",59,0)
 W !?QANTAB(3)," surgery",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",60,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",61,0)
 S QANLBL="DEATH-CON" W !?QANTAB(3),"In conjunction with"
"RTN","QANBENE2",62,0)
 W !?QANTAB(3)," a procedure",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",63,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",64,0)
 S QANLBL="DEATH-EQ" W !?QANTAB(3),"Equipment mal-"
"RTN","QANBENE2",65,0)
 W !?QANTAB(3)," function",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",66,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",67,0)
 S QANLBL="DEATH-FAIL" W !?QANTAB(3),"Due to failure to"
"RTN","QANBENE2",68,0)
 W !?QANTAB(3)," diagnose or treat",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",69,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",70,0)
 S QANLBL="DEATH-M.E." W !?QANTAB(3),"Cases accepted by",!?QANTAB(3)," Medical Examiner"
"RTN","QANBENE2",71,0)
 W ?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",72,0)
 S QANLBL="DEATH-MED CEN" W !?QANTAB(3),"On medical center",!?QANTAB(3)," grounds while not"
"RTN","QANBENE2",73,0)
 W !?QANTAB(3)," being treated",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",74,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",75,0)
 Q
"RTN","QANBENE2",76,0)
RGLAR ;Regular w/o Severity Levels.
"RTN","QANBENE2",77,0)
 W ?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,2),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,2),0)
"RTN","QANBENE2",78,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",79,0)
 Q
"RTN","QANBENE2",80,0)
RGLAR2 ;Regular w/o severity levels - (homicide & suicide)
"RTN","QANBENE2",81,0)
 W ?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0),?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",82,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",83,0)
 Q
"RTN","QANBENE2",84,0)
STNDRD ;Printing 'Severity Level'
"RTN","QANBENE2",85,0)
 W !?QANTAB(3),"Severity Level 0",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,0),0)
"RTN","QANBENE2",86,0)
 W ?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,0),0)
"RTN","QANBENE2",87,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",88,0)
 W !?QANTAB(3),"Severity Level 1",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,1),0)
"RTN","QANBENE2",89,0)
 W ?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,1),0)
"RTN","QANBENE2",90,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",91,0)
 W !?QANTAB(3),"Severity Level 2",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,2),0)
"RTN","QANBENE2",92,0)
 W ?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,2),0)
"RTN","QANBENE2",93,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",94,0)
 W !?QANTAB(3),"Severity Level 3",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",95,0)
 W ?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,3),0)
"RTN","QANBENE2",96,0)
 D:$Y>(IOSL-4) HDH Q:QANQUIT
"RTN","QANBENE2",97,0)
 Q
"RTN","QANBENE2",98,0)
HDH ;End of screen interface.
"RTN","QANBENE2",99,0)
 I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR K DIR S:+Y=0 QANQUIT=1
"RTN","QANBENE2",100,0)
 Q:QANQUIT
"RTN","QANBENE2",101,0)
 D HDR^QANBENE0
"RTN","QANBENE2",102,0)
 Q
"RTN","QANBENE3")
0^32^B7524612
"RTN","QANBENE3",1,0)
QANBENE3 ;HISC/GJC-Special incidents invol. a beneficiary ;3/3/92
"RTN","QANBENE3",2,0)
 ;;2.0;Incident Reporting;**1,26**;08/07/1992
"RTN","QANBENE3",3,0)
 ;
"RTN","QANBENE3",4,0)
EN1 ;Format of the print for our Beneficiary Report.
"RTN","QANBENE3",5,0)
 S QANLBL="ASSAULT PAT/STAFF"
"RTN","QANBENE3",6,0)
 D:$Y>(IOSL-4) HDH^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",7,0)
 W !!?QANTAB(1),"(10)",?QANTAB(2),"Patient on Staff",!?QANTAB(2),"Assault" D STNDRD^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",8,0)
 S QANLBL="OTHER"
"RTN","QANBENE3",9,0)
 D:$Y>(IOSL-4) HDH^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",10,0)
 W !!?QANTAB(1),"(11)",?QANTAB(2),"Patient Injury",!?QANTAB(2),"(not otherwise listed)" D STNDRD^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",11,0)
 S QANLBL="FIRE"
"RTN","QANBENE3",12,0)
 D:$Y>(IOSL-4) HDH^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",13,0)
 W !!?QANTAB(1),"(12)",?QANTAB(2),"Patient Involved",!?QANTAB(2),"in Fire" D STNDRD^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",14,0)
 S QANLBL="SEX"
"RTN","QANBENE3",15,0)
 D:$Y>(IOSL-4) HDH^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",16,0)
 W !!?QANTAB(1),"(13)",?QANTAB(2),"Sexual Assault" D RGLAR^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",17,0)
 S QANLBL="SUI ATT"
"RTN","QANBENE3",18,0)
 D:$Y>(IOSL-4) HDH^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",19,0)
 W !!?QANTAB(1),"(14)",?QANTAB(2),"Suicide Attempt" D SPECIAL Q:QANQUIT
"RTN","QANBENE3",20,0)
 S QANLBL="SUICIDE"
"RTN","QANBENE3",21,0)
 D:$Y>(IOSL-4) HDH^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",22,0)
 W !!?QANTAB(1),"(15)",?QANTAB(2),"Suicide" D RGLAR2^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",23,0)
 S QANLBL="TRANS ERR"
"RTN","QANBENE3",24,0)
 D:$Y>(IOSL-4) HDH^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",25,0)
 W !!?QANTAB(1),"(16)",?QANTAB(2),"Transfusion Error" D STNDRD^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",26,0)
 I PAGE,($E(IOST)'="C") D PRINT
"RTN","QANBENE3",27,0)
 Q
"RTN","QANBENE3",28,0)
HDH ;End of report interface.
"RTN","QANBENE3",29,0)
 I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR K DIR S:+Y=0 QANQUIT=1
"RTN","QANBENE3",30,0)
 Q
"RTN","QANBENE3",31,0)
PRINT ;Print out labels.
"RTN","QANBENE3",32,0)
 I '$D(^TMP("QANBEN")) D HDH^QANBENE2 W !!!,"No Incidents to report.",!!!
"RTN","QANBENE3",33,0)
 W !,"VA Form 10-0139"_$S(QANFLG("WARD")="D":"E",QANFLG("WARD")="N":"D",QANFLG("WARD")="O":"C",QANFLG("WARD")="I":"B",QANFLG("WARD")="C":"BCDE",1:"")
"RTN","QANBENE3",34,0)
 Q
"RTN","QANBENE3",35,0)
SPECIAL ;Special output "Proven Patient Abuse" and "Suicide Attempt"
"RTN","QANBENE3",36,0)
 W !?QANTAB(3),"Severity Level 0",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,0),0)
"RTN","QANBENE3",37,0)
 W ?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,0),0)
"RTN","QANBENE3",38,0)
 D:$Y>(IOSL-4) HDH^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",39,0)
 W !?QANTAB(3),"Severity Level 1",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,1),0)
"RTN","QANBENE3",40,0)
 W ?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,1),0)
"RTN","QANBENE3",41,0)
 D:$Y>(IOSL-4) HDH^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",42,0)
 W !?QANTAB(3),"Severity Level 2",?QANTAB(5),$G(QANCOUNT("SLEV",QANCC,QANLBL,2),0)
"RTN","QANBENE3",43,0)
 W ?QANTAB(6),$G(QANCOUNT("INV",QANCC,QANLBL,2),0)
"RTN","QANBENE3",44,0)
 D:$Y>(IOSL-4) HDH^QANBENE2 Q:QANQUIT
"RTN","QANBENE3",45,0)
 Q
"RTN","QANCDNT")
0^38^B67154336
"RTN","QANCDNT",1,0)
QANCDNT ;HISC/GJC-Initial sighting of an incident ;10/9/92
"RTN","QANCDNT",2,0)
 ;;2.0;Incident Reporting;**1,9,14,27,26**;08/07/1992
"RTN","QANCDNT",3,0)
 ;
"RTN","QANCDNT",4,0)
 N QANQFLG
"RTN","QANCDNT",5,0)
 D NEWREC I $G(QANLOCK)=1 L -^QA(742.4) S QANLOCK=0 Q
"RTN","QANCDNT",6,0)
 D DIV
"RTN","QANCDNT",7,0)
 I $G(QANQFLG)=1 D DEL Q
"RTN","QANCDNT",8,0)
 D DIE
"RTN","QANCDNT",9,0)
 Q
"RTN","QANCDNT",10,0)
NEWREC  ;create new record number
"RTN","QANCDNT",11,0)
 ;record number will be in the format XXX.YYnnnn where XXX is the
"RTN","QANCDNT",12,0)
 ;three digit station number, YY is the 2 digit year and nnnn is
"RTN","QANCDNT",13,0)
 ;the sequence number (and is also the IEN of file 742.4)
"RTN","QANCDNT",14,0)
 N EE,QANCNT,QANLIST,QANNO,QANQFLG
"RTN","QANCDNT",15,0)
 K QANLOCK
"RTN","QANCDNT",16,0)
 L +^QA(742.4):5 I '$T W !!,"Another user is editing this file." S QANLOCK=1 Q
"RTN","QANCDNT",17,0)
 S (QANFLAG,QANXIT,QANOUT)=0,QANST=$S($D(^QA(740,1,0))#2:$P(^(0),"^"),1:""),QANST1=$S($D(^DIC(4,QANST,99))#2:$P(^(99),"^"),1:QANST)
"RTN","QANCDNT",18,0)
 S QANDUZ=$S($D(DUZ):DUZ,1:""),QANTTL=$P(^VA(200,QANDUZ,0),U,9)
"RTN","QANCDNT",19,0)
 ;set QANDT variable as "." concatonated with 2 digit year so that
"RTN","QANCDNT",20,0)
 ;years 2000-2009 don't have leading zeroes.
"RTN","QANCDNT",21,0)
 S QANDT=$S($D(DT):$E(DT,2,3),1:""),QANDT="."_QANDT
"RTN","QANCDNT",22,0)
 S QANINCR=+$P($G(^QA(742.4,0)),U,3)+1 ;Grab the new IEN
"RTN","QANCDNT",23,0)
 F  Q:$D(^QA(742.4,QANINCR,0))=0  S QANINCR=QANINCR+1
"RTN","QANCDNT",24,0)
 S QANCODE(0)=QANDT_QANINCR
"RTN","QANCDNT",25,0)
 I $L(QANINCR)<4 S QANCODE(0)=QANDT_$E("000",1,(4-$L(QANINCR)))_QANINCR
"RTN","QANCDNT",26,0)
 S QANCODE(1)=QANST1_QANCODE(0)
"RTN","QANCDNT",27,0)
 S QANCHK=$O(^QA(742.4,"B",QANCODE(1),0)) I +QANCHK,$D(^(QANCHK))#2 D  Q
"RTN","QANCDNT",28,0)
 . W !!,$C(7),"CASE NUMBER VIOLATION, CONTACT YOUR QA COORDINATOR!!"
"RTN","QANCDNT",29,0)
 . S QANXIT=1
"RTN","QANCDNT",30,0)
 . K QANST,QANST1,QANDT,QANCODE,QANINCR,QANFLAG,QANOUT,QANDUZ,QANCHK,QANTTL
"RTN","QANCDNT",31,0)
 . L -^QA(742.4)
"RTN","QANCDNT",32,0)
 K DIC,DD,DO,DLAYGO,DINUM S (DIC,DIE)="^QA(742.4,",DIC(0)="L",X=QANCODE(1)
"RTN","QANCDNT",33,0)
 D FILE^DICN
"RTN","QANCDNT",34,0)
 L -^QA(742.4)
"RTN","QANCDNT",35,0)
 K DIC,DD,DO,DLAYGO,DINUM
"RTN","QANCDNT",36,0)
 L +^QA(742.4,+Y):5 I '$T W !!,"Another user is editing this incident." S QANLOCK=1 Q
"RTN","QANCDNT",37,0)
 S QANBFLG=1 ;set brief flag so that if this subroutine was called
"RTN","QANCDNT",38,0)
 ;from full incident edit you do not re-lock the record when you
"RTN","QANCDNT",39,0)
 ;get back to full incident edit.
"RTN","QANCDNT",40,0)
 Q:+Y<1  S QANIEN=+Y
"RTN","QANCDNT",41,0)
 S QANHOME=$G(^QA(742.4,QANIEN,0)),$P(QANHOME,U,5)=QANDUZ,$P(QANHOME,U,6)=QANTTL,$P(QANHOME,U,15)=1,$P(QANHOME,U,8)=1
"RTN","QANCDNT",42,0)
 K DA,DIK S DIK="^QA(742.4,",DA=QANIEN,^QA(742.4,QANIEN,0)=QANHOME D IX1^DIK K DA,DIK
"RTN","QANCDNT",43,0)
 Q
"RTN","QANCDNT",44,0)
DIV ;check to see if station is multi-divisional for Incid Reporting.  If
"RTN","QANCDNT",45,0)
 ;so, and there are hosp locations in file 740 (node "QAN2") then
"RTN","QANCDNT",46,0)
 ;prompt user for Division.
"RTN","QANCDNT",47,0)
 I $P($G(^QA(740,1,"QAN")),U,5)=1 S TEMPY=$G(Y) D  S Y=$G(TEMPY)
"RTN","QANCDNT",48,0)
 . W !!,"DIVISION: "
"RTN","QANCDNT",49,0)
 . S QANCNT=0 S QANLIST="S EE=0 F  S EE=$O(^QA(740,1,""QAN2"",EE)) Q:EE'>0  W !?5,EE,?10,$P(^DIC(4,$P(^QA(740,1,""QAN2"",EE,0),U),0),U) S QANCNT=QANCNT+1"
"RTN","QANCDNT",50,0)
LIST . S QANCNT=0 X QANLIST
"RTN","QANCDNT",51,0)
 . I $G(QANCNT)<1 W !?5,"There are no divisions entered in your QA Site Parameter File (#704).",!?5,"Ask your IRM support person to edit this file.  If your site"
"RTN","QANCDNT",52,0)
 . I $G(QANCNT)<1 W !?5,"is entered in file #740 as a MULTI-DIVISIONAL INCID REP FACILITY you need",!?5,"entries in the IR HOSPITAL DIVISION multiple."
"RTN","QANCDNT",53,0)
 . S DIR(0)="NA"
"RTN","QANCDNT",54,0)
 . S DIR("A")="Enter the number of your choice: "
"RTN","QANCDNT",55,0)
 . S DIR("?")="Choose the number of your division."
"RTN","QANCDNT",56,0)
 . S DIR("??")="^S X=QANCNT X QANLIST"
"RTN","QANCDNT",57,0)
 . D ^DIR
"RTN","QANCDNT",58,0)
 . I $G(Y)']""!($G(Y)="^") D
"RTN","QANCDNT",59,0)
 . . W !!?5,"You must enter a Division.",!
"RTN","QANCDNT",60,0)
 . . D ^DIR
"RTN","QANCDNT",61,0)
 . . I $G(Y)']""!($G(Y)="^") S QANQFLG=1 Q
"RTN","QANCDNT",62,0)
 . I $G(QANQFLG)=1 Q
"RTN","QANCDNT",63,0)
 . I '$G(^QA(740,1,"QAN2",+Y,0)) W !,"Enter the number of your choice." S QANCNT=0 G LIST
"RTN","QANCDNT",64,0)
 . S QANNO=+Y
"RTN","QANCDNT",65,0)
 . S DIE="^QA(742.4,",DR="52///^S X=$P(^DIC(4,+^QA(740,1,""QAN2"",QANNO,0),0),U)"
"RTN","QANCDNT",66,0)
 . S DA=QANIEN
"RTN","QANCDNT",67,0)
 . D ^DIE I $D(Y)>0 S QANCNT=0 G LIST
"RTN","QANCDNT",68,0)
 Q
"RTN","QANCDNT",69,0)
DIE S DIE="^QA(742.4,",DA=QANIEN,DR=".02;.03;.04;S X=X"
"RTN","QANCDNT",70,0)
 D ^DIE K DIE,DR I $D(Y) D DEL Q:QANXIT
"RTN","QANCDNT",71,0)
 S QANST=$P(^QA(742.4,QANIEN,0),U,2) I "12"[$P(^QA(742.1,QANST,0),U,2) S $P(^QA(742.4,QANIEN,0),U,9)=DT,QAQADICT=742.4,QAQAFLD=".1",X=DT D ENSET^QAQAXREF
"RTN","QANCDNT",72,0)
 K ^UTILITY($J,"QAN PAT") F  D PAT Q:QANXIT!(QANOUT)  ;get the patient
"RTN","QANCDNT",73,0)
 Q:QANXIT
"RTN","QANCDNT",74,0)
SC1 ;
"RTN","QANCDNT",75,0)
 K Y S DIE="^QA(742.4,",DA=QANIEN,DR=".05;@1;.08;S X=X" D ^DIE K DIE,DR I $D(Y) Q:QANXIT
"RTN","QANCDNT",76,0)
 K QAUDIT S QAUDIT("FILE")="742.4^50",QAUDIT("DA")=QANIEN,QAUDIT("ACTION")="o",QAUDIT("COMMENT")="Open an incident record" D ^QAQAUDIT
"RTN","QANCDNT",77,0)
 S DIE="^QA(742.4,",DR=".09///"_1,DA=QANIEN D ^DIE ; Set 'Local Case' flag to open.
"RTN","QANCDNT",78,0)
 I $G(QANFFLG)<1 D DISP
"RTN","QANCDNT",79,0)
 I $G(QANFFLG)<0 L -^QA(742.4,QANIEN) ;if this subroutine has not
"RTN","QANCDNT",80,0)
 ;been called from the full incident edit, then unlock incident report.
"RTN","QANCDNT",81,0)
 ;D ^QANBRIF ;transmit message to local mail group
"RTN","QANCDNT",82,0)
 Q
"RTN","QANCDNT",83,0)
DEL ;Delete incident.
"RTN","QANCDNT",84,0)
 K DIK S DIK="^QA(742.4,",DA=QANIEN W !!,$C(7),"Insufficient data entered for an incident, deleting!!" D ^DIK K DA,DIK S QANXIT=1
"RTN","QANCDNT",85,0)
 Q
"RTN","QANCDNT",86,0)
PAT ;Patient data.
"RTN","QANCDNT",87,0)
 K DIC S DIC="^DPT(",DIC(0)="QEAMNZ",DIC("A")="Select Patient: ",DIC("W")="W "" "",$P(^(0),U,9)",D="B^BS5"
"RTN","QANCDNT",88,0)
 D MIX^DIC1 K DIC S:+Y<1&($G(QANFLAG)) QANOUT=1
"RTN","QANCDNT",89,0)
 D:+Y<1&('$G(QANFLAG)) DEL^QANCDNT Q:QANXIT!(QANOUT)
"RTN","QANCDNT",90,0)
 F  D  Q:"-12"[%
"RTN","QANCDNT",91,0)
 . W !?5,$G(Y(0,0))_" OK?"
"RTN","QANCDNT",92,0)
 . S %=1 D YN^DICN Q:"-12"[%
"RTN","QANCDNT",93,0)
 . W " Confirm that this is the correct patient."
"RTN","QANCDNT",94,0)
 D:%=-1&('$G(QANFLAG)) DEL^QANCDNT Q:QANXIT!(QANOUT)
"RTN","QANCDNT",95,0)
 I %=-1,($G(QANFLAG)) S QANXIT=1 Q
"RTN","QANCDNT",96,0)
 I %=2 W " ??" G PAT
"RTN","QANCDNT",97,0)
 D PRIOR I QANXIT D  Q
"RTN","QANCDNT",98,0)
 . I '$G(QANFLAG) K DA,DIK S DA=QANIEN,DIK="^QA(742.4," D ^DIK K DA,DIK
"RTN","QANCDNT",99,0)
 I $D(^UTILITY($J,"QAN PAT",+Y)) W !!,$C(7),$P(^DPT(+Y,0),U)_" has been previously entered for this incident." K Y G PAT
"RTN","QANCDNT",100,0)
 I $D(^DPT(+Y,.35)),$P(^DPT(+Y,.35),U)]"",($P(^DPT(+Y,.35),U)<$P(^QA(742.4,QANIEN,0),U,3)) W !!,$C(7),"The date of death for patient: "_$P(^DPT(+Y,0),U)_" precedes the incident date." K Y G PAT
"RTN","QANCDNT",101,0)
 I $G(QANXIT)!($G(QANOUT)) D DEL Q
"RTN","QANCDNT",102,0)
 S QANPIEN=+Y,QANZERO=Y(0),QANAME=Y(0,0),QANSSN=$P(QANZERO,U,9),^UTILITY($J,"QAN PAT",+Y)=""
"RTN","QANCDNT",103,0)
 S QANDOB=$P(^DPT(QANPIEN,0),U,3)
"RTN","QANCDNT",104,0)
 I QANDOB]"" S X=DT,X1=X,X2=QANDOB,X="" D:X2 ^%DTC S X=X\365.25,QANAGE=X
"RTN","QANCDNT",105,0)
 S QANPSDO(0)=Y(0),QANPSDO(0,0)=Y(0,0)
"RTN","QANCDNT",106,0)
 S QANPID=$E($P(Y(0,0),",",2))_$E($P(Y(0,0)," ",2))_$E($P(Y(0,0),","))_$E(QANSSN,6,9)
"RTN","QANCDNT",107,0)
 D ADMDT^QANUTL1
"RTN","QANCDNT",108,0)
 L +^QA(742):10 I '$T W !!,"Another user is editing this file." Q
"RTN","QANCDNT",109,0)
 K DIC,DD,DO,DINUM,DLAYGO S DLAYGO=742,DIC="^QA(742,",DIC(0)="L",X=QANPIEN D FILE^DICN K DIC,DD,DO,DINUM,DLAYGO
"RTN","QANCDNT",110,0)
 I +Y=-1,('$G(QANFLAG)) D DEL Q
"RTN","QANCDNT",111,0)
 I +Y=-1,($G(QANFLAG)) S QANXIT=1 Q  ;Something is wrong, exit.
"RTN","QANCDNT",112,0)
 S QANDFN=+Y
"RTN","QANCDNT",113,0)
 L -^QA(742)
"RTN","QANCDNT",114,0)
 L +^QA(742,QANDFN):10 I '$T W !!,"Another user is editing this patient incident." Q
"RTN","QANCDNT",115,0)
 S $P(^QA(742,QANDFN,0),U,2,6)=QANPID_U_QANIEN_U_QANADMDT_U_QANINPAT_U_QANWARD
"RTN","QANCDNT",116,0)
 S $P(^QA(742,QANDFN,0),U,7)=QANTRSP,$P(^QA(742,QANDFN,0),U,12)=1
"RTN","QANCDNT",117,0)
 S DIK="^QA(742,",DA=QANDFN D IX1^DIK K DA,DIK
"RTN","QANCDNT",118,0)
 L -^QA(742,QANDFN)
"RTN","QANCDNT",119,0)
 S QANFLAG=1 ;D:'$D(QANF) BULL^QANUTL3
"RTN","QANCDNT",120,0)
 K QAUDIT S QAUDIT("FILE")="742^50",QAUDIT("DA")=QANDFN,QAUDIT("ACTION")="o",QAUDIT("COMMENT")="Open a patient record" D ^QAQAUDIT
"RTN","QANCDNT",121,0)
 Q
"RTN","QANCDNT",122,0)
PRIOR ;
"RTN","QANCDNT",123,0)
 S QANTST(1)=$G(^QA(742.4,QANIEN,0))
"RTN","QANCDNT",124,0)
 S QANTST("INC")=$P(QANTST(1),U,2),QANTST("DATE")=$P(QANTST(1),U,3)
"RTN","QANCDNT",125,0)
 F QAN99=0:0 S QAN99=$O(^QA(742,"AA",+Y,QAN99)) Q:QAN99'>0!(QANXIT)  S QANPRS=+$O(^QA(742,"AA",+Y,QAN99,"")) I QANPRS>0,($P(^QA(742,QANPRS,0),U,12)'<0) S QANTST(2)=$G(^QA(742.4,QAN99,0)) D PRIOR1
"RTN","QANCDNT",126,0)
 K QAN99,QANPRS,QANTST
"RTN","QANCDNT",127,0)
 Q
"RTN","QANCDNT",128,0)
PRIOR1 ;
"RTN","QANCDNT",129,0)
 I (QANTST("INC")=$P(QANTST(2),U,2)),(QANTST("DATE")=$P(QANTST(2),U,3)) D
"RTN","QANCDNT",130,0)
 . W !!,$C(7),"Patient "_$P(^DPT(+Y,0),U)_" has a duplicate incident on record."
"RTN","QANCDNT",131,0)
 . W:'$G(QANFLAG) !,"Deleting the incident."
"RTN","QANCDNT",132,0)
 . W:$G(QANFLAG) !,"Exiting!"
"RTN","QANCDNT",133,0)
 . S QANXIT=1
"RTN","QANCDNT",134,0)
 Q
"RTN","QANCDNT",135,0)
DISP ;display to user what has been entered and ask if it is okay
"RTN","QANCDNT",136,0)
 N QANCC,QANEE
"RTN","QANCDNT",137,0)
 W @IOF
"RTN","QANCDNT",138,0)
 S QAN74240=^QA(742.4,QANIEN,0)
"RTN","QANCDNT",139,0)
 W !!!,"Incident Report: "_$P(QAN74240,U)
"RTN","QANCDNT",140,0)
 S Y=$P(QAN74240,U,3) D DD^%DT
"RTN","QANCDNT",141,0)
 W ?35,"Date of Incident: "_Y
"RTN","QANCDNT",142,0)
 W !,"Patient: "
"RTN","QANCDNT",143,0)
 S QANCC=0 F  S QANCC=$O(^QA(742,"BCS",QANIEN,QANCC)) Q:QANCC'>0  D
"RTN","QANCDNT",144,0)
 . W ?10,$P(^DPT($P(^QA(742,QANCC,0),U),0),U),!
"RTN","QANCDNT",145,0)
 W !,"Incident Type: "
"RTN","QANCDNT",146,0)
 I $P(QAN74240,U,2)]"" W $P(^QA(742.1,$P(QAN74240,U,2),0),U)
"RTN","QANCDNT",147,0)
 W !,"Incident Location: "
"RTN","QANCDNT",148,0)
 I $P(QAN74240,U,4)]"" W $P(^QA(742.5,$P(QAN74240,U,4),0),U)
"RTN","QANCDNT",149,0)
 W !,"Was the Incident Witnessed?: "_$S($P(QAN74240,U,7)=1:"Yes",$P(QAN74240,U,7)=0:"No",1:"")
"RTN","QANCDNT",150,0)
 W !,"Incident Description: "
"RTN","QANCDNT",151,0)
 S QANEE=0 F  S QANEE=$O(^QA(742.4,QANIEN,1,QANEE)) Q:QANEE'>0  D
"RTN","QANCDNT",152,0)
 . W !?3,^QA(742.4,QANIEN,1,QANEE,0)
"RTN","QANCDNT",153,0)
 W !!
"RTN","QANCDNT",154,0)
 S DIR("A")="Is this information correct?"
"RTN","QANCDNT",155,0)
 S DIR("B")="Yes"
"RTN","QANCDNT",156,0)
 S DIR("?")="Enter 'Yes' or 'No'."
"RTN","QANCDNT",157,0)
 S DIR(0)="YAO"
"RTN","QANCDNT",158,0)
 S DIR("?",1)="Enter 'Yes' if the information displayed is correct."
"RTN","QANCDNT",159,0)
 S DIR("?",2)="Enter 'No' if you need to edit this information."
"RTN","QANCDNT",160,0)
 D ^DIR
"RTN","QANCDNT",161,0)
GOEDIT ;
"RTN","QANCDNT",162,0)
 ;if info is not right, use code from QANEDIT to edit just the fields
"RTN","QANCDNT",163,0)
 ;in a brief incident.  There must be at least one patient/report.
"RTN","QANCDNT",164,0)
 I Y=0 S QANOUT=0 D
"RTN","QANCDNT",165,0)
 . D DIE^QANEDIT
"RTN","QANCDNT",166,0)
 . I $O(^QA(742,"BCS",QANIEN,0))']"" D
"RTN","QANCDNT",167,0)
 . . W !!,"No patients on this Incident Report - deleting Report."
"RTN","QANCDNT",168,0)
 . . S DIK="^QA(742.4,",DA=QANIEN D ^DIK K DIK
"RTN","QANCDNT",169,0)
 . . ;also need to remove entry from QA Audit file (#740.5)
"RTN","QANCDNT",170,0)
 . . ;get most recent entry for 742 and 742.4 and if matches
"RTN","QANCDNT",171,0)
 . . ;this entry, delete
"RTN","QANCDNT",172,0)
 . . F QANFILE=742,742.4 D DIKAUDIT^QANEDIT(QANFILE) K QANFILE
"RTN","QANCDNT",173,0)
 I $G(^QA(742.4,QANIEN,0))]"" D
"RTN","QANCDNT",174,0)
 . D ^QANBRIF ;transmit message to local mail group
"RTN","QANCDNT",175,0)
 . S QANCC=0
"RTN","QANCDNT",176,0)
 . F  S QANCC=$O(^QA(742,"BCS",QANIEN,QANCC)) Q:QANCC'>0  D
"RTN","QANCDNT",177,0)
 . . S QANPTNUM=$P(^QA(742,QANCC,0),U)
"RTN","QANCDNT",178,0)
 . . S QANODE=^DPT(QANPTNUM,0)
"RTN","QANCDNT",179,0)
 . . S QANAME=$P(QANODE,U)
"RTN","QANCDNT",180,0)
 . . S QANSSN=$P(QANODE,U,9)
"RTN","QANCDNT",181,0)
 . . D:'$D(QANF) BULL^QANUTL3
"RTN","QANCDNT",182,0)
 Q
"RTN","QANDBASE")
0^43^B4826024
"RTN","QANDBASE",1,0)
QANDBASE ;WCIOFO/ERC - TEST FOR BAD RECORDS IN ^QA(742 ;9/20/99
"RTN","QANDBASE",2,0)
 ;;2.0;Incident Reporting;;*26*;08/07/1992
"RTN","QANDBASE",3,0)
 S QANSIT=$P(^QA(740,1,0),U)
"RTN","QANDBASE",4,0)
 S QANSIT=$P(^DIC(4,QANSIT,0),U)
"RTN","QANDBASE",5,0)
 S QANCNT=1
"RTN","QANDBASE",6,0)
 N QANCC,QANEE,QANRR
"RTN","QANDBASE",7,0)
 S QANFLG=0
"RTN","QANDBASE",8,0)
START ; use date cross-reference to determine starting record in 742
"RTN","QANDBASE",9,0)
 S QANSTART=2990501 ; use date before QAN27
"RTN","QANDBASE",10,0)
 S QANSTART=$O(^QA(742.4,"BDT",QANSTART)) Q:QANSTART'>0  D
"RTN","QANDBASE",11,0)
 . S QANEE=$O(^QA(742.4,"BDT",QANSTART,0)) Q:QANEE'>0  D
"RTN","QANDBASE",12,0)
 . . S QANCC=$O(^QA(742,"BCS",QANEE,0)) Q:QANCC'>0  D 742
"RTN","QANDBASE",13,0)
 Q
"RTN","QANDBASE",14,0)
742 ; loop through 742, using QANCC as first record
"RTN","QANDBASE",15,0)
 S QANRR=QANCC-1
"RTN","QANDBASE",16,0)
 F  S QANRR=$O(^QA(742,QANRR)) Q:QANRR'>0  D
"RTN","QANDBASE",17,0)
 . D NOZERO
"RTN","QANDBASE",18,0)
 . D NO7424
"RTN","QANDBASE",19,0)
 I $G(QANFLG)=0 S QANTXT(QANCNT)="No records in file 742 with missing .01 field.",QANCNT=QANCNT+1
"RTN","QANDBASE",20,0)
 S QANTXT(QANCNT)="Last entry in file 742 is "_$P(^QA(742,0),U,3)
"RTN","QANDBASE",21,0)
 D MAIL
"RTN","QANDBASE",22,0)
 Q
"RTN","QANDBASE",23,0)
NOZERO ; check for .01 FIELD
"RTN","QANDBASE",24,0)
 I $P(^QA(742,QANRR,0),U)']"" S QANTXT(QANCNT)="File 742 record #"_QANRR_" is bad - no .01 Field" S QANFLG=1,QANCNT=QANCNT+1
"RTN","QANDBASE",25,0)
 Q
"RTN","QANDBASE",26,0)
NO7424 ; sub-routine will check entries in 742 for valid pointer to 742.4
"RTN","QANDBASE",27,0)
 S QAN7424=$P(^QA(742,QANRR,0),U,3) Q:$G(QAN7424)']""
"RTN","QANDBASE",28,0)
 I '$D(^QA(742.4,QAN7424,0)) D
"RTN","QANDBASE",29,0)
 . S QANTXT(QANCNT)="File 742 record #"_QANRR_" points to a non-existent record in file 742.4.",QANCNT=QANCNT+1
"RTN","QANDBASE",30,0)
 . S DFN=$P(^QA(742,QANRR,0),U)
"RTN","QANDBASE",31,0)
 . D DEM^VADPT
"RTN","QANDBASE",32,0)
 . S QANTXT(QANCNT)="    Patient for file 742 record #"_QANRR_" is "_VADM(1),QANCNT=QANCNT+1
"RTN","QANDBASE",33,0)
 . K DFN,VADM
"RTN","QANDBASE",34,0)
 Q
"RTN","QANDBASE",35,0)
MAIL ;
"RTN","QANDBASE",36,0)
 N DIFROM,XMROU
"RTN","QANDBASE",37,0)
 D KILL^XM
"RTN","QANDBASE",38,0)
 S XMDUZ=.5,XMY(DUZ)=""
"RTN","QANDBASE",39,0)
 S XMTEXT="QANTXT("
"RTN","QANDBASE",40,0)
 S XMY("CURTIN,EDNA@FORUM.VA.GOV")=""
"RTN","QANDBASE",41,0)
 S XMSUB="QAN FILE 742 REPORT - "_QANSIT
"RTN","QANDBASE",42,0)
 D ^XMD
"RTN","QANDBASE",43,0)
 D KILL^XM
"RTN","QANDBASE",44,0)
KILL ;
"RTN","QANDBASE",45,0)
 K QAN7424,QANCNT,QANFLG,QANSIT,QANSTART,QANTXT
"RTN","QANDBASE",46,0)
 K XMDUZ,XMTEXT,XMY
"RTN","QANDBASE",47,0)
 Q
"RTN","QANEDIT")
0^42^B48890391
"RTN","QANEDIT",1,0)
QANEDIT ;WCIOFO/ERC-Edit a Brief Incident ;4/22/99
"RTN","QANEDIT",2,0)
 ;;2.0;Incident Reporting;**27,26**;08/07/1992
"RTN","QANEDIT",3,0)
 ;
"RTN","QANEDIT",4,0)
START ;
"RTN","QANEDIT",5,0)
 W @IOF
"RTN","QANEDIT",6,0)
 N QANBFLG,QANIEN,QANNOPAT
"RTN","QANEDIT",7,0)
 F  W !!,"Do you want to edit one of your open Incident Reports" S %=1 D YN^DICN Q:"-112"[%  W !!,"Enter (Y)es, (N)o or ""^"" to exit"
"RTN","QANEDIT",8,0)
 I %=1 D EDIT
"RTN","QANEDIT",9,0)
 K QANXIT
"RTN","QANEDIT",10,0)
 Q
"RTN","QANEDIT",11,0)
EDIT ;
"RTN","QANEDIT",12,0)
 K ^TMP("QAN EDIT")
"RTN","QANEDIT",13,0)
 S QANCNT=1
"RTN","QANEDIT",14,0)
 S QANDUZ=DUZ
"RTN","QANEDIT",15,0)
 S QANEE=0
"RTN","QANEDIT",16,0)
 F  S QANEE=$O(^QA(742.4,"ACS",1,QANEE)) Q:QANEE'>0  D
"RTN","QANEDIT",17,0)
 . I QANDUZ=$P(^QA(742.4,QANEE,0),U,5) S ^TMP("QAN EDIT",$J,QANCNT,QANEE)="",QANCNT=QANCNT+1
"RTN","QANEDIT",18,0)
 W @IOF
"RTN","QANEDIT",19,0)
 I '$D(^TMP("QAN EDIT")) D  Q
"RTN","QANEDIT",20,0)
 . W !!,"**** You have no open Incident Reports to edit.  Exiting.",!!
"RTN","QANEDIT",21,0)
 W !!,"Here are your open Incident Reports."
"RTN","QANEDIT",22,0)
 S QANEE=0
"RTN","QANEDIT",23,0)
 S QANTOT=0
"RTN","QANEDIT",24,0)
 F  S QANEE=$O(^TMP("QAN EDIT",$J,QANEE)) Q:QANEE'>0  D
"RTN","QANEDIT",25,0)
 . S QANIEN=$O(^TMP("QAN EDIT",$J,QANEE,0)) Q:QANIEN'>0
"RTN","QANEDIT",26,0)
 . S QAN0=^QA(742.4,QANIEN,0)
"RTN","QANEDIT",27,0)
 . S QANCC=0,QANCNT=1
"RTN","QANEDIT",28,0)
 . S QANTOT=QANTOT+1 ;gets number of IRs for selecting record to edit
"RTN","QANEDIT",29,0)
 . F  S QANCC=$O(^QA(742,"BCS",QANIEN,QANCC)) Q:QANCC'>0  D
"RTN","QANEDIT",30,0)
 . . S QANNAME=$P(^DPT($P(^QA(742,QANCC,0),U),0),U)
"RTN","QANEDIT",31,0)
 . . S Y=$P(QAN0,U,3) D DD^%DT S QANDATE=Y
"RTN","QANEDIT",32,0)
 . . S QANINC=$P(^QA(742.1,$P(QAN0,U,2),0),U)
"RTN","QANEDIT",33,0)
 . . I $Y>(IOSL-6) K DIR S DIR(0)="E" D ^DIR K DIR W @IOF
"RTN","QANEDIT",34,0)
 . . I QANCNT=1 W !,QANEE,?4,QANDATE,?25,$E(QANINC,1,25),?51,QANNAME
"RTN","QANEDIT",35,0)
 . . I QANCNT>1 W !?51,QANNAME
"RTN","QANEDIT",36,0)
 . . S QANCNT=QANCNT+1
"RTN","QANEDIT",37,0)
DIR ;
"RTN","QANEDIT",38,0)
 I $G(QANTOT)=1 S QANIEN=$O(^TMP("QAN EDIT",$J,1,0)) G DIE
"RTN","QANEDIT",39,0)
 K DIR
"RTN","QANEDIT",40,0)
 S DIR(0)="NOA"
"RTN","QANEDIT",41,0)
 S DIR("A")="Select a number from 1 to "_QANTOT_": "
"RTN","QANEDIT",42,0)
 D ^DIR K DIR Q:$D(DIRUT)!(+Y<1)
"RTN","QANEDIT",43,0)
 I +Y>QANTOT W !,"Number selected must be from 1 to "_QANTOT_", try again." G DIR
"RTN","QANEDIT",44,0)
 S QANIEN=$O(^TMP("QAN EDIT",$J,+Y,0))
"RTN","QANEDIT",45,0)
 I $G(QANIEN)]"",($D(^QA(742.4,QANIEN,0))) D
"RTN","QANEDIT",46,0)
 . L +^QA(742.4,QANIEN):5 I '$T W !!,"Another user is editing this record." Q
"RTN","QANEDIT",47,0)
 . S QANEDFLG=1
"RTN","QANEDIT",48,0)
 . D DIE
"RTN","QANEDIT",49,0)
 . I $O(^QA(742,"BCS",QANIEN,0))']"" D
"RTN","QANEDIT",50,0)
 . . ;if no patients entered, delete the incident
"RTN","QANEDIT",51,0)
 . . W !!,"No patients on this Incident Report - deleting Report."
"RTN","QANEDIT",52,0)
 . . S DIK="^QA(742.4,",DA=QANIEN D ^DIK K DIK
"RTN","QANEDIT",53,0)
 . D EXIT
"RTN","QANEDIT",54,0)
 Q
"RTN","QANEDIT",55,0)
DIE ;
"RTN","QANEDIT",56,0)
 W !!
"RTN","QANEDIT",57,0)
 N QANCNT,QANEE
"RTN","QANEDIT",58,0)
 S QANEFLG=0
"RTN","QANEDIT",59,0)
 S QANEE=0
"RTN","QANEDIT",60,0)
 S QANCNT=1
"RTN","QANEDIT",61,0)
 F  S QANEE=$O(^QA(742,"BCS",QANIEN,QANEE)) Q:QANEE'>0  D
"RTN","QANEDIT",62,0)
 . S QANPAT(QANCNT)=QANEE
"RTN","QANEDIT",63,0)
 . S QANCNT=QANCNT+1
"RTN","QANEDIT",64,0)
 K DIE S DIE="^QA(742.4,",DA=QANIEN,DR=".02;.03;.04"
"RTN","QANEDIT",65,0)
 D ^DIE K DIE
"RTN","QANEDIT",66,0)
 L -^QA(742.4,QANIEN)
"RTN","QANEDIT",67,0)
PAT ;edit patient(s) on report
"RTN","QANEDIT",68,0)
 ;if no patients entered go directly to PTADD
"RTN","QANEDIT",69,0)
 I $O(^QA(742,"BCS",QANIEN,0))']"" G PTADD
"RTN","QANEDIT",70,0)
 K QANPNAM,QANPNUM
"RTN","QANEDIT",71,0)
 W !,"Patient(s) on this Incident Report."
"RTN","QANEDIT",72,0)
 S QANEE=0
"RTN","QANEDIT",73,0)
 S QANCNT=1
"RTN","QANEDIT",74,0)
 F  S QANEE=$O(QANPAT(QANEE)) Q:QANEE'>0  D
"RTN","QANEDIT",75,0)
 . S QANPNUM(QANEE)=$P(^QA(742,QANPAT(QANEE),0),U)
"RTN","QANEDIT",76,0)
 . S QANPNAM(QANEE)=$P(^DPT(QANPNUM(QANEE),0),U)
"RTN","QANEDIT",77,0)
 . W !?5,QANCNT,"  ",QANPNAM(QANEE)
"RTN","QANEDIT",78,0)
 . S QANCNT=QANCNT+1
"RTN","QANEDIT",79,0)
 S DIR("A")="Is this correct"
"RTN","QANEDIT",80,0)
 S DIR("B")="YES"
"RTN","QANEDIT",81,0)
 S DIR(0)="Y"
"RTN","QANEDIT",82,0)
 D ^DIR K DIR Q:$D(DIRUT)
"RTN","QANEDIT",83,0)
 I Y<1 D
"RTN","QANEDIT",84,0)
 . S DIR(0)="Y",DIR("A")="Would you like to add a patient"
"RTN","QANEDIT",85,0)
 . S DIR("B")="YES"
"RTN","QANEDIT",86,0)
 . K DIRUT
"RTN","QANEDIT",87,0)
 . D ^DIR K DIR Q:$D(DIRUT)
"RTN","QANEDIT",88,0)
 . I Y=1 D PTADD S (QANEFLG,QANEDFLG)=1 Q
"RTN","QANEDIT",89,0)
 . ;deleting patients from record only allowed if editing a new record
"RTN","QANEDIT",90,0)
 . I $G(QANBFLG)'=1 Q
"RTN","QANEDIT",91,0)
 . K DIR S DIR(0)="Y",DIR("A")="Would you like to delete a patient"
"RTN","QANEDIT",92,0)
 . S DIR("B")="NO"
"RTN","QANEDIT",93,0)
 . K DIRUT
"RTN","QANEDIT",94,0)
 . D ^DIR K DIR Q:$D(DIRUT)
"RTN","QANEDIT",95,0)
 . I Y=1 D PTDEL S (QANEFLG,QANEDFLG)=1
"RTN","QANEDIT",96,0)
 ;if the user has deleted all patients and has not re-entered one,
"RTN","QANEDIT",97,0)
 ;exit the subroutine (a message will be displayed & the record deleted)
"RTN","QANEDIT",98,0)
 I $G(QANNOPAT)=1 K QANNOPAT Q
"RTN","QANEDIT",99,0)
 I $G(QANEFLG)=1 S QANEFLG=0 G PAT
"RTN","QANEDIT",100,0)
 ;if no patients on report skip description and witnessed and quit
"RTN","QANEDIT",101,0)
 I $O(^QA(742,"BCS",QANIEN,0))']"" Q
"RTN","QANEDIT",102,0)
 K DIE S DIE="^QA(742.4,",DR=".05;.08"
"RTN","QANEDIT",103,0)
 D ^DIE K DIE
"RTN","QANEDIT",104,0)
 Q
"RTN","QANEDIT",105,0)
PTADD ;
"RTN","QANEDIT",106,0)
 K DIC S DIC="^DPT(",DIC(0)="QEAMNZ",DIC("A")="Select Patient: ",DIC("W")="W "" "",$P(^(0),U,9)",D="B^BS5"
"RTN","QANEDIT",107,0)
 D MIX^DIC1 K DIC
"RTN","QANEDIT",108,0)
 I +Y<1 S QANXIT=1 Q
"RTN","QANEDIT",109,0)
 F  D  Q:"-12"[%
"RTN","QANEDIT",110,0)
 . W !?5,$G(Y(0,0))_" OK"
"RTN","QANEDIT",111,0)
 . S %=1 D YN^DICN Q:"-12"[%
"RTN","QANEDIT",112,0)
 . W " Confirm that this is the correct patient."
"RTN","QANEDIT",113,0)
 I %=-1 S QANXIT=1 Q
"RTN","QANEDIT",114,0)
 I %=2 W " ??" G PTADD
"RTN","QANEDIT",115,0)
 S QANEE=0
"RTN","QANEDIT",116,0)
 F  S QANEE=$O(QANPNUM(QANEE)) Q:QANEE'>0  D
"RTN","QANEDIT",117,0)
 . I +Y=QANPNUM(QANEE) W !!,$C(7),$P(^DPT(+Y,0),U)_" has been previously entered for this incident." K Y S QANXFLG=1 Q
"RTN","QANEDIT",118,0)
 I $G(QANXFLG)=1 S QANXFLG=0 G PTADD
"RTN","QANEDIT",119,0)
 I $D(^DPT(+Y,.35)),$P(^DPT(+Y,.35),U)]"",($P(^DPT(+Y,.35),U)<$P(^QA(742.4,QANIEN,0),U,3)) W !!,$C(7),"The date of death for patient: "_$P(^DPT(+Y,0),U)_" precedes the incident date." K Y G PTADD
"RTN","QANEDIT",120,0)
 S QANPIEN=+Y,QANZERO=Y(0),QANAME=Y(0,0),QANSSN=$P(QANZERO,U,9),^UTILITY($J,"QAN PAT",+Y)=""
"RTN","QANEDIT",121,0)
 S QANDOB=$P(^DPT(QANPIEN,0),U,3)
"RTN","QANEDIT",122,0)
 I QANDOB]"" S X=DT,X1=X,X2=QANDOB,X="" D:X2 ^%DTC S X=X\365.25,QANAGE=X
"RTN","QANEDIT",123,0)
 S QANPSDO(0)=Y(0),QANPSDO(0,0)=Y(0,0)
"RTN","QANEDIT",124,0)
 S QANPID=$E($P(Y(0,0),",",2))_$E($P(Y(0,0)," ",2))_$E($P(Y(0,0),","))_$E(QANSSN,6,9)
"RTN","QANEDIT",125,0)
 D ADMDT^QANUTL1
"RTN","QANEDIT",126,0)
 K DIC,DD,DO,DINUM,DLAYGO S DLAYGO=742,DIC="^QA(742,",DIC(0)="L",X=QANPIEN D FILE^DICN K DIC,DD,DO,DINUM,DLAYGO
"RTN","QANEDIT",127,0)
 I +Y=-1,($G(QANFLAG)) S QANXIT=1 Q
"RTN","QANEDIT",128,0)
 S QANDFN=+Y
"RTN","QANEDIT",129,0)
 S $P(^QA(742,QANDFN,0),U,2,6)=QANPID_U_QANIEN_U_QANADMDT_U_QANINPAT_U_QANWARD
"RTN","QANEDIT",130,0)
 S $P(^QA(742,QANDFN,0),U,7)=QANTRSP,$P(^QA(742,QANDFN,0),U,12)=1
"RTN","QANEDIT",131,0)
 S DIK="^QA(742,",DA=QANDFN D IX1^DIK K DA,DIK
"RTN","QANEDIT",132,0)
 S QANNUM=$O(QANPAT(" "),-1)+1
"RTN","QANEDIT",133,0)
 S QANPAT(QANNUM)=QANDFN
"RTN","QANEDIT",134,0)
 S QANPNUM(QANNUM)=QANPIEN
"RTN","QANEDIT",135,0)
 S QANPNAM(QANNUM)=QANAME
"RTN","QANEDIT",136,0)
 S QANFLAG=1 D:'$D(QANF) BULL^QANUTL3
"RTN","QANEDIT",137,0)
 K QAUDIT S QAUDIT("FILE")="742^50",QAUDIT("DA")=QANDFN,QAUDIT("ACTION")="e",QAUDIT("COMMENT")="Edit a brief patient record" D ^QAQAUDIT
"RTN","QANEDIT",138,0)
 Q
"RTN","QANEDIT",139,0)
PTDEL ;
"RTN","QANEDIT",140,0)
 S QANCC=0
"RTN","QANEDIT",141,0)
 F  S QANCC=$O(QANPNUM(QANCC)) Q:QANCC'>0  D
"RTN","QANEDIT",142,0)
 . S QANNUM=QANCC
"RTN","QANEDIT",143,0)
 . W !?5,QANCC_"   "_QANPNAM(QANCC)
"RTN","QANEDIT",144,0)
 I '$G(QANNUM) S QANXIT=1 Q
"RTN","QANEDIT",145,0)
 S DIR(0)="NOA"
"RTN","QANEDIT",146,0)
 S DIR("A")="Delete which patient number: "
"RTN","QANEDIT",147,0)
 D ^DIR K DIR Q:$D(DIRUT)
"RTN","QANEDIT",148,0)
 I $G(QANPNAM(+Y))']"" W !!?5,"Choice must be one of the displayed numbers." G PTDEL
"RTN","QANEDIT",149,0)
 I Y>QANNUM W !!?5,"Answer must be a number less than ",QANNUM+1 G PTDEL
"RTN","QANEDIT",150,0)
 I Y<1 S QANXIT=1 Q
"RTN","QANEDIT",151,0)
 S QANTEMP=+Y
"RTN","QANEDIT",152,0)
 S QANDFN=QANPAT(+Y)
"RTN","QANEDIT",153,0)
 S QANAME=QANPNAM(+Y)
"RTN","QANEDIT",154,0)
 S DIK="^QA(742,",DA=QANPAT(+Y) D ^DIK
"RTN","QANEDIT",155,0)
 ;D BULL^QANUTL3
"RTN","QANEDIT",156,0)
 ;K QAUDIT S QAUDIT("FILE")="742^50",QAUDIT("DA")=QANDFN,QAUDIT("ACTION")="d",QAUDIT("COMMENT")="Delete a brief patient record" D ^QAQAUDIT
"RTN","QANEDIT",157,0)
 K QANPAT(QANTEMP),QANPNUM(QANTEMP),QANPNAM(QANTEMP)
"RTN","QANEDIT",158,0)
 ;if there are no patients on the report set a flag and go back to PTADD
"RTN","QANEDIT",159,0)
 I $O(^QA(742,"BCS",QANIEN,0))']"" W !!,"You must have at least one patient on an incident report." S QANNOPAT=1 G PTADD
"RTN","QANEDIT",160,0)
 G PTDEL
"RTN","QANEDIT",161,0)
 Q
"RTN","QANEDIT",162,0)
EXIT ;
"RTN","QANEDIT",163,0)
 K QAN0,QANADMDT,QANCC,QANCNT,QANDATE,QANDFN,QANDOB,QANEE
"RTN","QANEDIT",164,0)
 K QANEDFLG,QANELFG,QANFLAG,QANIEN,QANINC,QANAME,QANNAME,QANNOPAT
"RTN","QANEDIT",165,0)
 K QANNUM,QANPAT,QANPID,QANPIEN,QANPNAM,QANPNUM,QANPSDO,QANTEMP
"RTN","QANEDIT",166,0)
 K QANTOT,QANTRSP,QANXFLG,QANXIT,QANY,QANZERO
"RTN","QANEDIT",167,0)
 Q
"RTN","QANEDIT",168,0)
DIKAUDIT(QANFIL) ;
"RTN","QANEDIT",169,0)
 ;deletes the entries for this Incident Report from
"RTN","QANEDIT",170,0)
 ;the QA Audit file.  Input is the QA file (742 for the patient,
"RTN","QANEDIT",171,0)
 ;742.4 for the incident).
"RTN","QANEDIT",172,0)
 ;
"RTN","QANEDIT",173,0)
 S QANID=$S(QANFIL=742:QANDFN,1:QANIEN)
"RTN","QANEDIT",174,0)
 S QANEE=$O(^QA(740.5,"B",QANFIL," "),-1)+1
"RTN","QANEDIT",175,0)
 F  S QANEE=$O(^QA(740.5,"B",QANFIL,QANEE),-1) Q:QANEE'>0  I $P(^QA(740.5,QANEE,0),U,2)=QANID S QANAUD=QANID Q
"RTN","QANEDIT",176,0)
 I $G(QANAUD)]"" D
"RTN","QANEDIT",177,0)
 . S DIK="^QA(740.5,",DA=QANEE
"RTN","QANEDIT",178,0)
 . D ^DIK K DIK
"RTN","QANEDIT",179,0)
 . K QANID,QANAUD,QANEE
"RTN","QANEDIT",180,0)
 Q
"RTN","QANOPEN")
0^33^B15136926
"RTN","QANOPEN",1,0)
QANOPEN ;GJC/HISC-Open Incident Case Report ;6/15/92
"RTN","QANOPEN",2,0)
 ;;2.0;Incident Reporting;**26**;08/07/1992
"RTN","QANOPEN",3,0)
 S QANHD(0)="Open Incidents and the Associated Patient(s)"
"RTN","QANOPEN",4,0)
 S QANHD(1)="""c"" denotes a Closed Patient Record"
"RTN","QANOPEN",5,0)
 S QANHD(2)="""d"" denotes a Deleted Patient Record"
"RTN","QANOPEN",6,0)
 S QANHD(3)="No Open Cases found!"
"RTN","QANOPEN",7,0)
 S $P(QANLN,"+",$S(IOM=132:133,1:81))="",(QANPG,QANXIT)=0
"RTN","QANOPEN",8,0)
 S Y=DT X ^DD("DD") S QANTDY=Y
"RTN","QANOPEN",9,0)
 D DIV^QANRPT1 I $G(QANPOP) G KILL
"RTN","QANOPEN",10,0)
 F QANAA=1:2:3 D
"RTN","QANOPEN",11,0)
 . S QANIEN=0
"RTN","QANOPEN",12,0)
 . F  S QANIEN=$O(^QA(742.4,"ACS",QANAA,QANIEN)) Q:QANAA'>0!(QANIEN'>0)  D
"RTN","QANOPEN",13,0)
 . . D INCD
"RTN","QANOPEN",14,0)
TASK ;Call to ^%ZTLOAD
"RTN","QANOPEN",15,0)
 K IOP,%ZIS S %ZIS("A")="Print on device: ",%ZIS="MQ" W ! D ^%ZIS W !!
"RTN","QANOPEN",16,0)
 G:POP KILL
"RTN","QANOPEN",17,0)
 I $D(IO("Q")) S ZTRTN="START^QANOPEN",ZTDESC="Open Incident/Patient report." D ZLOOP,^%ZTLOAD W !,$S($D(ZTSK):"Request Queued!",1:"Request Cancelled!"),! G EXIT
"RTN","QANOPEN",18,0)
START ;
"RTN","QANOPEN",19,0)
 U IO W @IOF
"RTN","QANOPEN",20,0)
 I '$D(^TMP("QAN",$J)) D HDH W !!!!!?(IOM-$L(QANHD(3))\2),QANHD(3) G EXIT
"RTN","QANOPEN",21,0)
 S QANCC=""
"RTN","QANOPEN",22,0)
 F  S QANCC=$O(^TMP("QAN",$J,"DIV",QANCC)) Q:QANCC']""  D
"RTN","QANOPEN",23,0)
 . I QANCC>0 S Y=QANCC I Y]"" S C=$P(^DD(742.4,52,0),U,2) D Y^DIQ S QANDIVN=Y
"RTN","QANOPEN",24,0)
 . I QANCC=0 S QANDIVN="Unknown"
"RTN","QANOPEN",25,0)
 . S QANHD(4)="Report for Division: "_QANDIVN
"RTN","QANOPEN",26,0)
 . W @IOF D HDR
"RTN","QANOPEN",27,0)
 . S QAN0=0
"RTN","QANOPEN",28,0)
 . F  S QAN0=$O(^TMP("QAN",$J,"DIV",QANCC,QAN0)) Q:QAN0'>0  D
"RTN","QANOPEN",29,0)
 . . S QAN1=0
"RTN","QANOPEN",30,0)
 . . F  S QAN1=$O(^TMP("QAN",$J,QAN0,QAN1)) Q:QAN1'>0!(QANXIT)  D OUT1
"RTN","QANOPEN",31,0)
EXIT ;Close device
"RTN","QANOPEN",32,0)
 W ! D ^%ZISC,HOME^%ZIS
"RTN","QANOPEN",33,0)
KILL ;Kill and quit
"RTN","QANOPEN",34,0)
 K %ZIS,C,D,DIC,DIR,POP,QA,QAN0,QAN1,QANCASE,QANDATE,QANDFN,QANHD,QANIEN
"RTN","QANOPEN",35,0)
 K QANINCD,QANLCS,QANLN,QANPAT,QANPG,QANPRS,QANPT,QANTDY,QANXIT,QANZER0
"RTN","QANOPEN",36,0)
 K DTOUT,DIRUT,DIROUT,DUOUT,QANZERO,QAQ,X,Y,ZTDESC,ZTRTN,ZTSAVE,ZTSK
"RTN","QANOPEN",37,0)
 K ^TMP("QAN",$J)
"RTN","QANOPEN",38,0)
 Q
"RTN","QANOPEN",39,0)
HDH ;End of Screen interface
"RTN","QANOPEN",40,0)
 I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR S:+Y=0 QANXIT=1 Q:QANXIT
"RTN","QANOPEN",41,0)
 W @IOF D HDR
"RTN","QANOPEN",42,0)
 Q
"RTN","QANOPEN",43,0)
HDR ;Standard header
"RTN","QANOPEN",44,0)
 S QANPG=QANPG+1
"RTN","QANOPEN",45,0)
 W !,?63,"Date: ",?69,QANTDY,!?63,"Page: ",?69,QANPG
"RTN","QANOPEN",46,0)
 W !?(IOM-$L(QANHD(0))\2),QANHD(0)
"RTN","QANOPEN",47,0)
 W !?(IOM-$L(QANHD(1))\2),QANHD(1)
"RTN","QANOPEN",48,0)
 W !?(IOM-$L(QANHD(2))\2),QANHD(2)
"RTN","QANOPEN",49,0)
 I $G(QANDVFLG)=1,($G(QANHD(4))]"") W !?(IOM-$L(QANHD(4))\2),QANHD(4)
"RTN","QANOPEN",50,0)
 F QAQ=1:1:2 W !,QANLN
"RTN","QANOPEN",51,0)
 Q
"RTN","QANOPEN",52,0)
INCD ;Incident data
"RTN","QANOPEN",53,0)
 S QANZERO=$G(^QA(742.4,QANIEN,0)) Q:QANZERO']""
"RTN","QANOPEN",54,0)
 S QANDIV=$P(QANZERO,U,22)
"RTN","QANOPEN",55,0)
 I $G(QAN1DIV)]"" Q:QAN1DIV'=QANDIV
"RTN","QANOPEN",56,0)
 I '$G(QANDVFLG) S QANDIV=0
"RTN","QANOPEN",57,0)
 I $G(QANDVFLG)=1 D DIV
"RTN","QANOPEN",58,0)
 S ^TMP("QAN",$J,"DIV",QANDIV,QANIEN)=""
"RTN","QANOPEN",59,0)
 S QANCASE=$P(QANZERO,U),QANINCD=$P(QANZERO,U,2),QANDATE=$P(QANZERO,U,3)
"RTN","QANOPEN",60,0)
 S Y=QANINCD I Y]"" S C=$P(^DD(742.4,.02,0),U,2) D Y^DIQ S QANINCD=Y
"RTN","QANOPEN",61,0)
 S Y=QANDATE I Y]"" S C=$P(^DD(742.4,.03,0),U,2) D Y^DIQ S QANDATE=Y
"RTN","QANOPEN",62,0)
 S ^TMP("QAN",$J,QANIEN,"CASE")=$S(QANCASE]"":QANCASE,1:"N/A")
"RTN","QANOPEN",63,0)
 S ^TMP("QAN",$J,QANIEN,"INCD")=$S(QANINCD]"":QANINCD,1:"N/A")
"RTN","QANOPEN",64,0)
 S ^TMP("QAN",$J,QANIEN,"DATE")=$S(QANDATE]"":QANDATE,1:"N/A")
"RTN","QANOPEN",65,0)
 F QANDFN=0:0 S QANDFN=$O(^QA(742,"BCS",QANIEN,QANDFN)) Q:QANDFN'>0  D PAT
"RTN","QANOPEN",66,0)
 Q
"RTN","QANOPEN",67,0)
OUT1 ;Output data/results
"RTN","QANOPEN",68,0)
 I $Y>(IOSL-6) D HDH Q:QANXIT
"RTN","QANOPEN",69,0)
 W !!,"Case Number: ",$G(^TMP("QAN",$J,QAN0,"CASE")),?30,"Incident: ",$G(^TMP("QAN",$J,QAN0,"INCD"))
"RTN","QANOPEN",70,0)
 W !,"Date: ",$G(^TMP("QAN",$J,QAN0,"DATE")),?30,"Patient: ",$G(^TMP("QAN",$J,QAN0,QAN1,"PAT"))
"RTN","QANOPEN",71,0)
 Q
"RTN","QANOPEN",72,0)
PAT ;Patient information
"RTN","QANOPEN",73,0)
 S QANZER0=$G(^QA(742,QANDFN,0)) Q:QANZER0']""
"RTN","QANOPEN",74,0)
 S QANPRS=+$P(QANZER0,U,12),QANPT=+$P(QANZER0,U)
"RTN","QANOPEN",75,0)
 I $G(^DPT(QANPT,0))]"" S QANPAT=$P(^DPT(QANPT,0),U)_$S(QANPRS<0:" (d)",QANPRS=0:" (c)",1:"")
"RTN","QANOPEN",76,0)
 I $G(^DPT(QANPT,0))']"" S QANPAT="N/A"
"RTN","QANOPEN",77,0)
 S ^TMP("QAN",$J,QANIEN,QANDFN,"PAT")=QANPAT
"RTN","QANOPEN",78,0)
 Q
"RTN","QANOPEN",79,0)
ZLOOP ;Ztsave variable for ^%ZTLOAD
"RTN","QANOPEN",80,0)
 F QA="QA*","^TMP(""QAN"",$J," S ZTSAVE(QA)=""
"RTN","QANOPEN",81,0)
 Q
"RTN","QANOPEN",82,0)
DIV ;
"RTN","QANOPEN",83,0)
 S (QANBB,QANOK)=0
"RTN","QANOPEN",84,0)
 F  S QANBB=$O(^QA(740,1,"QAN2",QANBB)) Q:QANBB'>0!($G(QANOK))  D
"RTN","QANOPEN",85,0)
 . I QANDIV=^QA(740,1,"QAN2",QANBB,0) S QANOK=1
"RTN","QANOPEN",86,0)
 I $G(QANOK)'=1 S QANDIV=0
"RTN","QANOPEN",87,0)
 S QANOK=0
"RTN","QANOPEN",88,0)
 Q
"RTN","QANQUCK")
0^41^B19039602
"RTN","QANQUCK",1,0)
QANQUCK ;HISC/GJC-Intial sighting of an Incident for a QA person ;10/9/92
"RTN","QANQUCK",2,0)
 ;;2.0;Incident Reporting;**1,9,14,27,26**;08/07/1992
"RTN","QANQUCK",3,0)
 ;
"RTN","QANQUCK",4,0)
 K QANLOCK
"RTN","QANQUCK",5,0)
 D NEWREC^QANCDNT
"RTN","QANQUCK",6,0)
 D DIV^QANCDNT
"RTN","QANQUCK",7,0)
 I $G(QANQFLG)=1 Q
"RTN","QANQUCK",8,0)
 S QANDEATH=$O(^QA(742.1,"BUPPER","DEATH",0)),QANSUI=$O(^QA(742.1,"BUPPER","SUICIDE",0)),QANHOMCD=$O(^QA(742.1,"BUPPER","HOMICIDE",0))
"RTN","QANQUCK",9,0)
 S QANPTAB=$O(^QA(742.1,"BUPPER","PATIENT ABUSE",0))
"RTN","QANQUCK",10,0)
 S DIE="^QA(742.4,",DA=QANIEN,DR=".02;I X'=QANDEATH S Y=""@1"";.15;@1;.03;S X=X" D ^DIE K DIE,DR I $D(Y) D DEL D:QANXIT KILL Q
"RTN","QANQUCK",11,0)
 S QANLTTR=$P(^QA(742.4,QANIEN,0),U,2)
"RTN","QANQUCK",12,0)
 S QANST=$P(^QA(742.4,QANIEN,0),U,2) I "12"[$P(^QA(742.1,QANST,0),U,2) S $P(^QA(742.4,QANIEN,0),U,9)=DT,QAQADICT=742.4,QAQAFLD=".1",X=DT D ENSET^QAQAXREF
"RTN","QANQUCK",13,0)
 K QAUDIT S QAUDIT("FILE")="742.4^50",QAUDIT("DA")=QANIEN,QAUDIT("ACTION")="o",QAUDIT("COMMENT")="Open an incident record" D ^QAQAUDIT
"RTN","QANQUCK",14,0)
 S DIE="^QA(742.4,",DR=".09///"_3,DA=QANIEN D ^DIE ; Set 'Local Case' flag to brief.
"RTN","QANQUCK",15,0)
 ;Get the patient.
"RTN","QANQUCK",16,0)
 K ^UTILITY($J,"QAN PAT") F  D PAT Q:QANXIT!(QANOUT)
"RTN","QANQUCK",17,0)
 L -^QA(742.4,QANIEN) ;unlock record - it was locked in NEWREC^QANCDNT
"RTN","QANQUCK",18,0)
KILL K D0,DA,QANADMDT,QANAGE,QANAME,QANCHK,QANCODE,QANDFN,QANDOB,QANDT,QANDUZ
"RTN","QANQUCK",19,0)
 K QANFLAG,QANHOMCD,QANHOME,QANIEN,QANINCR,QANINPAT,QANLTTR,QANOUT
"RTN","QANQUCK",20,0)
 K QANPTAB,QANPID,QANPIEN,QANPSDO,QANSSN,QANSUI,QANDEATH,QANST,QANST1
"RTN","QANQUCK",21,0)
 K QANTRSP,QANTTL,QANWARD,QANXIT,QANZERO,QAQADICT,QAQAFLD,QUES,VAERR,X
"RTN","QANQUCK",22,0)
 K QANPRS,X1,X2,Y,QANCODE,QANBFLG
"RTN","QANQUCK",23,0)
 Q
"RTN","QANQUCK",24,0)
DEL ;
"RTN","QANQUCK",25,0)
 K DIK S DIK="^QA(742.4,",DA=QANIEN W !!,$C(7),"Insufficient data entered for an incident, deleting!!" D ^DIK K DA,DIK S QANXIT=1
"RTN","QANQUCK",26,0)
 Q
"RTN","QANQUCK",27,0)
PAT ;Patient data.
"RTN","QANQUCK",28,0)
 K DIC S DIC="^DPT(",DIC(0)="QEAMNZ",DIC("A")="Select Patient: ",DIC("W")="W "" "",$P(^(0),U,9)",D="B^BS5"
"RTN","QANQUCK",29,0)
 D MIX^DIC1 K DIC S:+Y<1&(QANFLAG) QANOUT=1
"RTN","QANQUCK",30,0)
 D:+Y<1&('QANFLAG) DEL^QANCDNT Q:QANXIT!(QANOUT)
"RTN","QANQUCK",31,0)
 F  D  Q:"-12"[%
"RTN","QANQUCK",32,0)
 . W !?5,$G(Y(0,0))_" OK?"
"RTN","QANQUCK",33,0)
 . S %=1 D YN^DICN Q:"-12"[%
"RTN","QANQUCK",34,0)
 . W " Confirm that this is the correct patient."
"RTN","QANQUCK",35,0)
 D:%=-1&('QANFLAG) DEL^QANQUCK Q:QANXIT!(QANOUT)
"RTN","QANQUCK",36,0)
 I %=-1,(QANFLAG) S QANXIT=1 Q
"RTN","QANQUCK",37,0)
 I %=2 W " ??" G PAT
"RTN","QANQUCK",38,0)
 D PRIOR^QANCDNT I QANXIT D  Q
"RTN","QANQUCK",39,0)
 . I 'QANFLAG K DA,DIK S DA=QANIEN,DIK="^QA(742.4," D ^DIK K DA,DIK
"RTN","QANQUCK",40,0)
 I $D(^UTILITY($J,"QAN PAT",+Y)) W !!,$C(7),$P(^DPT(+Y,0),U)_" has been previously entered for this incident." K Y G PAT
"RTN","QANQUCK",41,0)
 I $D(^DPT(+Y,.35)),$P(^DPT(+Y,.35),U)]"",($P(^DPT(+Y,.35),U)<$P(^QA(742.4,QANIEN,0),U,3)) W !!,$C(7),"The date of death for patient: "_$P(^DPT(+Y,0),U)_" precedes the incident date." K Y G PAT
"RTN","QANQUCK",42,0)
 S QANPIEN=+Y,QANZERO=Y(0),QANAME=Y(0,0),QANSSN=$P(QANZERO,U,9),^UTILITY($J,"QAN PAT",+Y)=""
"RTN","QANQUCK",43,0)
 S QANDOB=$P(^DPT(QANPIEN,0),U,3)
"RTN","QANQUCK",44,0)
 I QANDOB]"" S X=DT,X1=X,X2=QANDOB,X="" D:X2 ^%DTC S X=X\365.25,QANAGE=X
"RTN","QANQUCK",45,0)
 S QANPSDO(0)=Y(0),QANPSDO(0,0)=Y(0,0)
"RTN","QANQUCK",46,0)
 S QANPID=$E($P(Y(0,0),",",2))_$E($P(Y(0,0)," ",2))_$E($P(Y(0,0),","))_$E(QANSSN,6,9)
"RTN","QANQUCK",47,0)
 D ADMDT^QANUTL1
"RTN","QANQUCK",48,0)
 L +^QA(742):10 I '$T W !!,"Another user is editing this file." Q
"RTN","QANQUCK",49,0)
 K DIC,DD,DO,DINUM,DLAYGO S DLAYGO=742,DIC="^QA(742,",DIC(0)="L",X=QANPIEN D FILE^DICN K DIC,DD,DO,DINUM,DLAYGO
"RTN","QANQUCK",50,0)
 I +Y=-1,('QANFLAG) D DEL Q
"RTN","QANQUCK",51,0)
 I +Y=-1,(QANFLAG) S QANXIT=1 Q  ;Something is wrong, exit.
"RTN","QANQUCK",52,0)
 S QANDFN=+Y
"RTN","QANQUCK",53,0)
 L -^QA(742)
"RTN","QANQUCK",54,0)
 L +^QA(742,QANDFN):10 I '$T W !!,"Another user is editing this patient incident." Q
"RTN","QANQUCK",55,0)
 S $P(^QA(742,QANDFN,0),U,2,6)=QANPID_U_QANIEN_U_QANADMDT_U_QANINPAT_U_QANWARD
"RTN","QANQUCK",56,0)
 S $P(^QA(742,QANDFN,0),U,7)=QANTRSP,$P(^QA(742,QANDFN,0),U,12)=1
"RTN","QANQUCK",57,0)
 S DIK="^QA(742,",DA=QANDFN D IX1^DIK K DA,DIK
"RTN","QANQUCK",58,0)
 I (QANSUI=QANLTTR)!(QANDEATH=QANLTTR)!(QANHOMCD=QANLTTR) K DA,DIE,DR S DIE="^QA(742,",DA=QANDFN,DR=".1///^S X=3" D ^DIE K DA,DIE,DR
"RTN","QANQUCK",59,0)
 I (QANSUI'=QANLTTR),(QANDEATH'=QANLTTR),(QANHOMCD'=QANLTTR) K DA,DIE,DR S DIE="^QA(742,",DR=".1",DA=QANDFN D ^DIE K DA,DIE,DR
"RTN","QANQUCK",60,0)
 L -^QA(742,QANDFN)
"RTN","QANQUCK",61,0)
 S QANFLAG=1
"RTN","QANQUCK",62,0)
 K QAUDIT S QAUDIT("FILE")="742^50",QAUDIT("DA")=QANDFN,QAUDIT("ACTION")="o",QAUDIT("COMMENT")="Open a patient record" D ^QAQAUDIT
"RTN","QANQUCK",63,0)
 Q
"RTN","QANRPT1")
0^34^B40703019
"RTN","QANRPT1",1,0)
QANRPT1 ;HISC/GJC-SUMMARY OF INCIDENTS/WARD ;5/6/91
"RTN","QANRPT1",2,0)
 ;;2.0;Incident Reporting;**26**;08/07/1992
"RTN","QANRPT1",3,0)
 ;
"RTN","QANRPT1",4,0)
 N QANINFLG,QANLCFLG
"RTN","QANRPT1",5,0)
 F  W !,"Do you wish to produce a report by Incident Location" S %=1 D YN^DICN Q:"-112"[%  W !,$C(7),"Enter ""Y""es to issue a report by Incident Location,",!,"""N""o to issue a report by Patient's Ward."
"RTN","QANRPT1",6,0)
 I %=-1 K % Q
"RTN","QANRPT1",7,0)
 S:%=2 QANCHOS="W" S:%=1 QANCHOS="I"
"RTN","QANRPT1",8,0)
 D DIV
"RTN","QANRPT1",9,0)
DATE ;
"RTN","QANRPT1",10,0)
 D ^QAQDATE I QAQQUIT W !!,$C(7),"Invalid date range, no report will be produced." D KILL Q
"RTN","QANRPT1",11,0)
 S (PAGE,QANTYPE)=0
"RTN","QANRPT1",12,0)
 I $D(QAQNBEG) S Y=QAQNBEG D DD^%DT S QANDATE(0)=Y
"RTN","QANRPT1",13,0)
 S:$D(QAQNBEG) QAQNBEG=QAQNBEG-.00000001
"RTN","QANRPT1",14,0)
 S:$D(QAQNEND) QAQNEND=QAQNEND_".99999999"
"RTN","QANRPT1",15,0)
 S QANHEAD(0)="QUALITY MANAGEMENT INCIDENT REPORT",QANHEAD(1)="SUMMARY OF INCIDENTS BY INCIDENT LOCATION",QANHEAD(2)="SUMMARY OF INCIDENTS BY PATIENT WARD"
"RTN","QANRPT1",16,0)
 S Y=$P(QAQNEND,".") D DD^%DT S QANDATE(1)=Y
"RTN","QANRPT1",17,0)
 S QANHEAD(3)="FOR THE PERIOD "_QANDATE(0)_" TO "_QANDATE(1)
"RTN","QANRPT1",18,0)
 D INCD^QANUTL4 I QANY D KILL Q
"RTN","QANRPT1",19,0)
 D:QANCHOS="I" QANLOC^QANUTL4 D:QANCHOS="W" WARD^QANUTL4 I QANY D KILL Q
"RTN","QANRPT1",20,0)
LOOP ;
"RTN","QANRPT1",21,0)
 N QANCC,QANEE
"RTN","QANRPT1",22,0)
 S QANEE=QAQNBEG
"RTN","QANRPT1",23,0)
 F  S QANEE=$O(^QA(742.4,"BDT",QANEE)) Q:QANEE'>0!(QANEE>QAQNEND)  D
"RTN","QANRPT1",24,0)
 . S QANCC=0
"RTN","QANRPT1",25,0)
 . F  S QANCC=$O(^QA(742.4,"BDT",QANEE,QANCC)) Q:QANCC'>0  D
"RTN","QANRPT1",26,0)
 . . S QANDD=0
"RTN","QANRPT1",27,0)
 . . F  S QANDD=$O(^QA(742,"BCS",QANCC,QANDD)) Q:QANDD'>0  D
"RTN","QANRPT1",28,0)
 . . . S QAN7424=^QA(742.4,QANCC,0) Q:$G(QAN7424)']""
"RTN","QANRPT1",29,0)
 . . . S QAN742=^QA(742,QANDD,0) Q:$G(QAN742)']""
"RTN","QANRPT1",30,0)
 . . . I $P(QAN7424,U,8)=2 Q
"RTN","QANRPT1",31,0)
 . . . S QANINC=$P(QAN7424,U,2) I $G(QANINC)']"" Q
"RTN","QANRPT1",32,0)
 . . . I $G(QANINFLG)'=1 I $G(^TMP("QANRPT1",$J,"INC",QANINC))']"" Q
"RTN","QANRPT1",33,0)
 . . . I $P(QAN742,U,5)'=1 Q
"RTN","QANRPT1",34,0)
 . . . S QANLCN=$S($G(QANCHOS)="I":$P(QAN7424,U,4),1:$P(QAN742,U,6)) Q:'$G(QANLCN)
"RTN","QANRPT1",35,0)
 . . . I $G(QANCHOS)="I" S QANLOC=$P(^QA(742.5,QANLCN,0),U)
"RTN","QANRPT1",36,0)
 . . . I $G(QANCHOS)="W" S QANLOC=$P(^SC($P(QAN742,U,6),0),U)
"RTN","QANRPT1",37,0)
 . . . I $G(QANLOC)']"" Q
"RTN","QANRPT1",38,0)
 . . . I $G(QANLCFLG)'=1 I $G(^TMP("QANRPT1",$J,"LOC",QANLCN))']"" Q
"RTN","QANRPT1",39,0)
 . . . S QANDIV=$P(QAN7424,U,22) I $G(QANDIV)']"" S QANDIV=0
"RTN","QANRPT1",40,0)
 . . . I $G(QAN1DIV)]"" Q:QAN1DIV'=QANDIV
"RTN","QANRPT1",41,0)
 . . . I '$D(^QA(740,1,"QAN2","B",QANDIV)) S QANDIV=0
"RTN","QANRPT1",42,0)
 . . . I $P($G(^QA(740,1,"QAN")),U,5)'=1 S QANDIV=0
"RTN","QANRPT1",43,0)
 . . . S QANINC=$P(^QA(742.1,QANINC,0),U)
"RTN","QANRPT1",44,0)
 . . . S QANINC=$TR(QANINC,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","QANRPT1",45,0)
 . . . S ^TMP("QANRPT1",$J,"QAN",QANDIV,QANLOC,QANINC,QANCC,QANDD)=""
"RTN","QANRPT1",46,0)
 I '$D(^TMP("QANRPT1",$J)) W !!,$C(7),"Incomplete data, exiting the report." D KILL Q
"RTN","QANRPT1",47,0)
 S QANWORD=$S($G(QANCHOS)="I":"Incident",1:"Ward")
"RTN","QANRPT1",48,0)
 I '$G(QANLCFLG),('$D(^TMP("QANRPT1",$J,"LOC"))) W !!,$C(7),QANWORD," location(s) not found, exiting the report." D KILL Q
"RTN","QANRPT1",49,0)
 I '$G(QANINFLG),('$D(^TMP("QANRPT1",$J,"INC"))) W !!,$C(7),"Incident(s) not found, exiting the report." D KILL Q
"RTN","QANRPT1",50,0)
 D TOTAL
"RTN","QANRPT1",51,0)
TASK S Y=DT X ^DD("DD") S TODAY=Y,$P(BNDRY,"-",$S(IOM=132:133,1:81))="",QANFIN=""
"RTN","QANRPT1",52,0)
 ;*** Choose device ***
"RTN","QANRPT1",53,0)
 K IOP,%ZIS S %ZIS("A")="Print on device: ",%ZIS="MQ" W ! D ^%ZIS W !!
"RTN","QANRPT1",54,0)
 G:POP KILL
"RTN","QANRPT1",55,0)
 I $D(IO("Q")) S ZTRTN="STRT^QANRPT1",ZTDESC="Generate Incident reports for incidents by type." D QLOOP^QANRPT2,^%ZTLOAD W !,$S($D(ZTSK):"Request queued!",1:"Request cancelled!"),! G EXIT
"RTN","QANRPT1",56,0)
STRT U IO
"RTN","QANRPT1",57,0)
 D:QANFIN'["^" PRINT
"RTN","QANRPT1",58,0)
EXIT W ! D ^%ZISC,HOME^%ZIS
"RTN","QANRPT1",59,0)
KILL ;Kill and quit.
"RTN","QANRPT1",60,0)
 D K^QAQDATE
"RTN","QANRPT1",61,0)
 K QAQNBEG,QAQNEND
"RTN","QANRPT1",62,0)
 K QAN742,QAN7424,QANAA,QANBB,QANCC,QANDD,QANEE,QANFF,QANXX,QANYY,QANZZ
"RTN","QANRPT1",63,0)
 K BNDRY,COUNT,LOOP,PAGE,TODAY,X,Y,%
"RTN","QANRPT1",64,0)
 K QANCDNT,QANCHOS,QANCNT,QANDAT1,QANDAT2,QANDATA1,QANDATA2,QANDATE
"RTN","QANRPT1",65,0)
 K QANDIV,QANDV,QANDVFLG,QANDVN,QANDVSN,QANFLG,QANFIN,QANINC,QANINFLG
"RTN","QANRPT1",66,0)
 K QANHEAD,QANINC,QANINCID,QAN,QANLCFLG,QANLOC,QANLOCA
"RTN","QANRPT1",67,0)
 K QANNODE,QANNUM,QANTYPE,QANY
"RTN","QANRPT1",68,0)
 K ^TMP("QANRPT1"),LP,LP0,LP1,LP2,QA,C
"RTN","QANRPT1",69,0)
 K DIROUT,DIRUT,DTOUT,DUOUT,D
"RTN","QANRPT1",70,0)
 Q
"RTN","QANRPT1",71,0)
FINAL ;Final data summation.
"RTN","QANRPT1",72,0)
 D:$Y>(IOSL-4) HDH,HDR^QANAUX1 Q:QANFIN["^"
"RTN","QANRPT1",73,0)
 I $G(COUNT("TOT"))'>0 W !!,"No incidents found, exiting the report." Q
"RTN","QANRPT1",74,0)
 S QANFF=""
"RTN","QANRPT1",75,0)
 F  S QANFF=$O(COUNT("LOC",QANAA,QANFF)) Q:QANFF']""  D
"RTN","QANRPT1",76,0)
 . S QANLOCA=QANFF
"RTN","QANRPT1",77,0)
 . W !,"Total number of incidents for "_$S(QANCHOS="W":"ward ",1:"incident location ")_QANLOCA_": "_COUNT("LOC",QANAA,QANFF)
"RTN","QANRPT1",78,0)
 I $G(QANDVFLG)=1 W !!,"Total number of Incidents for division "_QANDV_": "_COUNT("DIV",QANAA)
"RTN","QANRPT1",79,0)
 W !!,"Total number of incidents this reporting period: "_COUNT("TOT")
"RTN","QANRPT1",80,0)
 D HDH
"RTN","QANRPT1",81,0)
 Q
"RTN","QANRPT1",82,0)
TOTAL ;
"RTN","QANRPT1",83,0)
 N QANAA,QANBB,QANCC,QANDD
"RTN","QANRPT1",84,0)
 S QANAA=""
"RTN","QANRPT1",85,0)
 F  S QANAA=$O(^TMP("QANRPT1",$J,"QAN",QANAA)) Q:QANAA']""  D
"RTN","QANRPT1",86,0)
 . S QANBB=""
"RTN","QANRPT1",87,0)
 . F  S QANBB=$O(^TMP("QANRPT1",$J,"QAN",QANAA,QANBB)) Q:QANBB']""  D
"RTN","QANRPT1",88,0)
 . . S QANCC=""
"RTN","QANRPT1",89,0)
 . . F  S QANCC=$O(^TMP("QANRPT1",$J,"QAN",QANAA,QANBB,QANCC)) Q:QANCC']""  D
"RTN","QANRPT1",90,0)
 . . . S QANDD=0
"RTN","QANRPT1",91,0)
 . . . F  S QANDD=$O(^TMP("QANRPT1",$J,"QAN",QANAA,QANBB,QANCC,QANDD)) Q:QANDD'>0  D
"RTN","QANRPT1",92,0)
 . . . . S COUNT("INC",QANAA,QANBB,QANCC)=$G(COUNT("INC",QANAA,QANBB,QANCC))+1
"RTN","QANRPT1",93,0)
 . . . . S COUNT("TOT")=$G(COUNT("TOT"))+1
"RTN","QANRPT1",94,0)
 . . . . S COUNT("DIV",QANAA)=$G(COUNT("DIV",QANAA))+1
"RTN","QANRPT1",95,0)
 . . . . S COUNT("LOC",QANAA,QANBB)=$G(COUNT("LOC",QANAA,QANBB))+1
"RTN","QANRPT1",96,0)
 Q
"RTN","QANRPT1",97,0)
HDH ;
"RTN","QANRPT1",98,0)
 I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR K DIR S:+Y=0 QANFIN="^"
"RTN","QANRPT1",99,0)
 Q
"RTN","QANRPT1",100,0)
WARD ;
"RTN","QANRPT1",101,0)
 N QANCNT,QANDD
"RTN","QANRPT1",102,0)
 S QANDD=0
"RTN","QANRPT1",103,0)
 S QANCNT=1
"RTN","QANRPT1",104,0)
 F  S QANDD=$O(^QA(742,"BCS",QANIEN,QANDD)) Q:QANDD'>0  D
"RTN","QANRPT1",105,0)
 . Q:'$P($G(^QA(742,QANDD,0)),U,6)
"RTN","QANRPT1",106,0)
 . S QANLOC(QANCNT)=$P(^QA(742,QANDD,0),U,6)
"RTN","QANRPT1",107,0)
 . S QANCNT=QANCNT+1
"RTN","QANRPT1",108,0)
 Q
"RTN","QANRPT1",109,0)
INST(QANIEN,QANDV) ;api for getting division name
"RTN","QANRPT1",110,0)
 N DIC
"RTN","QANRPT1",111,0)
 K QANDV
"RTN","QANRPT1",112,0)
 S DIC="^DIC(4,"
"RTN","QANRPT1",113,0)
 S DIC(0)="NZX"
"RTN","QANRPT1",114,0)
 S DIC("S")="I $D(^QA(740,1,""QAN2"",""B"",X))"
"RTN","QANRPT1",115,0)
 S X=QANIEN
"RTN","QANRPT1",116,0)
 D ^DIC K DIC
"RTN","QANRPT1",117,0)
 I Y<0 S QANDV="Unknown" Q
"RTN","QANRPT1",118,0)
 S QANDV=Y(0,0)
"RTN","QANRPT1",119,0)
 Q
"RTN","QANRPT1",120,0)
PRINT ;print or display data
"RTN","QANRPT1",121,0)
 I '$D(COUNT) G FINAL
"RTN","QANRPT1",122,0)
 S QANAA=""
"RTN","QANRPT1",123,0)
 F  S QANAA=$O(COUNT("INC",QANAA)) Q:QANAA']""  D
"RTN","QANRPT1",124,0)
 . D INST(QANAA,.QANDV)
"RTN","QANRPT1",125,0)
 . I $G(QANDVFLG)=1 S QANHEAD(4)="REPORT FOR DIVISION: "_QANDV
"RTN","QANRPT1",126,0)
 . D HDR^QANAUX1
"RTN","QANRPT1",127,0)
 . S QANBB=""
"RTN","QANRPT1",128,0)
 . F  S QANBB=$O(COUNT("INC",QANAA,QANBB)) Q:QANBB']""  D
"RTN","QANRPT1",129,0)
 . . D:$Y>(IOSL-6) HDH,HDR^QANAUX1 Q:QANFIN["^"  W !!,$E(QANBB,1,32)
"RTN","QANRPT1",130,0)
 . . S QANCC=""
"RTN","QANRPT1",131,0)
 . . F  S QANCC=$O(COUNT("INC",QANAA,QANBB,QANCC)) Q:QANCC']""  D
"RTN","QANRPT1",132,0)
 . . . S QANDD=$O(^TMP("QANRPT1",$J,"QAN",QANAA,QANBB,QANCC,0)) Q:QANDD'>0
"RTN","QANRPT1",133,0)
 . . . S QANINCID=$P(^QA(742.1,$P(^QA(742.4,QANDD,0),U,2),0),U)
"RTN","QANRPT1",134,0)
 . . . S QANNUM=COUNT("INC",QANAA,QANBB,QANCC)
"RTN","QANRPT1",135,0)
 . . . D:$Y>(IOSL-4) HDH,HDR^QANAUX1 W ?35,$E(QANINCID,1,35),?72,QANNUM,!
"RTN","QANRPT1",136,0)
 . D FINAL
"RTN","QANRPT1",137,0)
 Q
"RTN","QANRPT1",138,0)
DIV ;
"RTN","QANRPT1",139,0)
 K QANDVFLG,QAN1DIV
"RTN","QANRPT1",140,0)
 S QANDVFLG=$P($G(^QA(740,1,"QAN")),U,5)
"RTN","QANRPT1",141,0)
 Q:$G(QANDVFLG)'=1
"RTN","QANRPT1",142,0)
 N DIR,DIRUT,DTOUT,DUOUT
"RTN","QANRPT1",143,0)
 S DIR(0)="YA"
"RTN","QANRPT1",144,0)
 S DIR("A")="Select ALL Divisions? "
"RTN","QANRPT1",145,0)
 S DIR("B")="YES"
"RTN","QANRPT1",146,0)
 D ^DIR K DIR I $D(DIRUT) S QANPOP=1 Q
"RTN","QANRPT1",147,0)
 I Y S QAN1DIV="" Q
"RTN","QANRPT1",148,0)
 N DIC
"RTN","QANRPT1",149,0)
 S DIC="^QA(740,1,""QAN2"","
"RTN","QANRPT1",150,0)
 S DIC(0)="AEMZQ"
"RTN","QANRPT1",151,0)
 S DIC("A")="Enter Division: "
"RTN","QANRPT1",152,0)
 S QANDVSN=$O(^QA(740,1,"QAN2",0)) Q:$G(QANDVSN)'>0
"RTN","QANRPT1",153,0)
 D INST($G(^QA(740,1,"QAN2",QANDVSN,0)),.QANDVN)
"RTN","QANRPT1",154,0)
 S DIC("B")=$G(QANDVN)
"RTN","QANRPT1",155,0)
 D ^DIC K DIC
"RTN","QANRPT1",156,0)
 I +Y>0 S QAN1DIV=Y(0)
"RTN","QANRPT1",157,0)
 Q
"RTN","QANRPT2")
0^35^B22159232
"RTN","QANRPT2",1,0)
QANRPT2 ;HISC/GJC-SUMMARY OF INCIDENTS FOR OUTPATIENTS ;5/6/91
"RTN","QANRPT2",2,0)
 ;;2.0;Incident Reporting;**26**;08/07/1992
"RTN","QANRPT2",3,0)
 ;
"RTN","QANRPT2",4,0)
 S PAGE=0
"RTN","QANRPT2",5,0)
 ;D DIV^QANRPT1
"RTN","QANRPT2",6,0)
 ;DON'T FORGET QAQDATE FOR AD HOC REPORTS!
"RTN","QANRPT2",7,0)
 D ^QAQDATE I QAQQUIT D K^QAQDATE W !!,$C(7),"Invalid date range, no report will be produced." D KILL Q
"RTN","QANRPT2",8,0)
 S QAQNBEG(0)=QAQNBEG-.00000001,QAQNEND(0)=QAQNEND_".99999999"
"RTN","QANRPT2",9,0)
 S (PAGE,QANTYPE,QANTINC)=0
"RTN","QANRPT2",10,0)
 S QANHEAD(0)="QUALITY MANAGEMENT INCIDENT REPORT",QANHEAD(1)="SUMMARY OF INCIDENTS FOR OUTPATIENTS."
"RTN","QANRPT2",11,0)
 S Y=$P(QAQNBEG,".") D DD^%DT S QANDATE(0)=Y
"RTN","QANRPT2",12,0)
 S Y=$P(QAQNEND,".") D DD^%DT S QANDATE(1)=Y
"RTN","QANRPT2",13,0)
 D DIV^QANRPT1
"RTN","QANRPT2",14,0)
 S QANHEAD(3)="FOR THE PERIOD "_QANDATE(0)_" TO "_QANDATE(1)
"RTN","QANRPT2",15,0)
 ;F QAN=0:0 S QAN=$O(^QA(742.4,QAN)) Q:QAN'>0  S QANZER0=$G(^QA(742.4,QAN,0)) I QANZER0]"",($P(QANZER0,U,8)'=2) S QANDATE=$P(QANZER0,U,3) I QANDATE'<QAQNBEG(0),(QANDATE'>QAQNEND(0)) S ^UTILITY($J,"QAN DATE",QAN)=""
"RTN","QANRPT2",16,0)
LOOP ;loop through the date x-ref for records in the date range
"RTN","QANRPT2",17,0)
 N QANCC,QANDD,QANEE
"RTN","QANRPT2",18,0)
 S QANEE=QAQNBEG(0)
"RTN","QANRPT2",19,0)
 F  S QANEE=$O(^QA(742.4,"BDT",QANEE)) Q:QANEE'>0!(QANEE>QAQNEND(0))  D
"RTN","QANRPT2",20,0)
 . S QANCC=0
"RTN","QANRPT2",21,0)
 . F  S QANCC=$O(^QA(742.4,"BDT",QANEE,QANCC)) Q:QANCC'>0  D
"RTN","QANRPT2",22,0)
 . . S QANDD=0
"RTN","QANRPT2",23,0)
 . . F  S QANDD=$O(^QA(742,"BCS",QANCC,QANDD)) Q:QANDD'>0  D
"RTN","QANRPT2",24,0)
 . . . Q:$P(^QA(742,QANDD,0),U,5)'=0
"RTN","QANRPT2",25,0)
 . . . S QANIEN=QANCC Q:QANIEN'>0
"RTN","QANRPT2",26,0)
 . . . S QANZER0=^QA(742.4,QANIEN,0)
"RTN","QANRPT2",27,0)
 . . . Q:$P(QANZER0,U,8)=2
"RTN","QANRPT2",28,0)
 . . . S QANDIV=$P(QANZER0,U,22) I $G(QANDIV)']"" S QANDIV=0
"RTN","QANRPT2",29,0)
 . . . I $G(QAN1DIV)]"" Q:QAN1DIV'=QANDIV
"RTN","QANRPT2",30,0)
 . . . I '$D(^QA(740,1,"QAN2","B",QANDIV)) S QANDIV=0
"RTN","QANRPT2",31,0)
 . . . I $P($G(^QA(740,1,"QAN")),U,5)'=1 S QANDIV=0
"RTN","QANRPT2",32,0)
 . . . S QANINC=$P(QANZER0,U,2) Q:$G(QANINC)'>0
"RTN","QANRPT2",33,0)
 . . . S ^TMP("QANRPT2",$J,"QAN",QANDIV,QANINC,QANIEN,QANDD)=""
"RTN","QANRPT2",34,0)
 I '$D(^TMP("QANRPT2",$J)) W !!,$C(7),"Incomplete data, exiting the report." D KILL Q
"RTN","QANRPT2",35,0)
 D TOTAL
"RTN","QANRPT2",36,0)
TASK S Y=DT X ^DD("DD") S TODAY=Y,$P(BNDRY,"-",$S(IOM=132:133,1:81))="",QANFIN=""
"RTN","QANRPT2",37,0)
 ;*** Choose device ***
"RTN","QANRPT2",38,0)
 K IOP,%ZIS S %ZIS("A")="Print on device: ",%ZIS="MQ" W ! D ^%ZIS W !!
"RTN","QANRPT2",39,0)
 G:POP KILL
"RTN","QANRPT2",40,0)
 I $D(IO("Q")) S ZTRTN="STRT^QANRPT2",ZTDESC="Generate Incident reports for incidents by type." D QLOOP,^%ZTLOAD W !,$S($D(ZTSK):"Request queued!",1:"Request cancelled!"),! G EXIT
"RTN","QANRPT2",41,0)
STRT U IO ;D HDR^QANAUX1
"RTN","QANRPT2",42,0)
 D:QANFIN'["^" PRINT ;ORD D:QANFIN'["^" FINAL
"RTN","QANRPT2",43,0)
EXIT W ! D ^%ZISC,HOME^%ZIS
"RTN","QANRPT2",44,0)
KILL ;Kill and quit.
"RTN","QANRPT2",45,0)
 D K^QAQDATE
"RTN","QANRPT2",46,0)
 K %,C,COUNT,D,DIC,BNDRY,LOOP,PAGE
"RTN","QANRPT2",47,0)
 K QAN,QANCDNT,QANFIN,QANHEAD
"RTN","QANRPT2",48,0)
 K QANINC0,QANINC1,QANJD,QANDATE,QANNCDT,QANWARD,QANZER0,TODAY,Y,QANTINC
"RTN","QANRPT2",49,0)
 K QANTYPE,QANINC,QANINCID,QANY,QANCHOS,X
"RTN","QANRPT2",50,0)
 K DTOUT,DIROUT,DIRUT,DUOUT
"RTN","QANRPT2",51,0)
 K ^TMP("QANRPT2")
"RTN","QANRPT2",52,0)
 Q
"RTN","QANRPT2",53,0)
FINAL ;Final data summation.
"RTN","QANRPT2",54,0)
 D:$Y>(IOSL-6) HDR^QANAUX1 Q:QANFIN["^"
"RTN","QANRPT2",55,0)
 I '$G(COUNT("TOT")) W !!,"No incidents found, exiting the report." G EXIT
"RTN","QANRPT2",56,0)
 I $G(QANDVFLG)=1 W !!,"Total number if incidents for division "_QANDV_": "_COUNT("DIV",QANAA)
"RTN","QANRPT2",57,0)
 W !!,"The total number of outpatient incidents is: ",COUNT("TOT")
"RTN","QANRPT2",58,0)
 D HDH
"RTN","QANRPT2",59,0)
 Q
"RTN","QANRPT2",60,0)
ORD ;
"RTN","QANRPT2",61,0)
 Q:'$D(QANINC0)
"RTN","QANRPT2",62,0)
 S (QANSUB,QANSUB(0))="" F  S QANSUB=$O(QANINC0(QANSUB)) Q:QANSUB=""!(QANFIN["^")  D:$Y>(IOSL-4) HDH Q:QANFIN["^"  W !?17,QANSUB,?59,QANINC0(QANSUB),!
"RTN","QANRPT2",63,0)
 Q
"RTN","QANRPT2",64,0)
TOTAL ;
"RTN","QANRPT2",65,0)
 ;F QAN=0:0 S QAN=$O(^UTILITY($J,"QAN DATE",QAN)) Q:QAN'>0  F QAN(0)=0:0 S QAN(0)=$O(^QA(742,"BCS",QAN,QAN(0))) Q:QAN(0)'>0  D TOTAL1
"RTN","QANRPT2",66,0)
 N QANAA,QANBB,QANCC,QANDD
"RTN","QANRPT2",67,0)
 S QANAA=""
"RTN","QANRPT2",68,0)
 F  S QANAA=$O(^TMP("QANRPT2",$J,"QAN",QANAA)) Q:QANAA']""  D
"RTN","QANRPT2",69,0)
 . S QANBB=0
"RTN","QANRPT2",70,0)
 . F  S QANBB=$O(^TMP("QANRPT2",$J,"QAN",QANAA,QANBB)) Q:QANBB'>0  D
"RTN","QANRPT2",71,0)
 . . S QANCC=0
"RTN","QANRPT2",72,0)
 . . F  S QANCC=$O(^TMP("QANRPT2",$J,"QAN",QANAA,QANBB,QANCC)) Q:QANCC'>0  D
"RTN","QANRPT2",73,0)
 . . . S QANDD=0
"RTN","QANRPT2",74,0)
 . . . F  S QANDD=$O(^TMP("QANRPT2",$J,"QAN",QANAA,QANBB,QANCC,QANDD)) Q:QANDD'>0  D
"RTN","QANRPT2",75,0)
 . . . . S COUNT("INC",QANAA,QANBB)=$G(COUNT("INC",QANAA,QANBB))+1
"RTN","QANRPT2",76,0)
 . . . . S COUNT("TOT")=$G(COUNT("TOT"))+1
"RTN","QANRPT2",77,0)
 . . . . S COUNT("DIV",QANAA)=$G(COUNT("DIV",QANAA))+1
"RTN","QANRPT2",78,0)
 Q
"RTN","QANRPT2",79,0)
TOTAL1 ;
"RTN","QANRPT2",80,0)
 ;S QANZER0=$S($D(^QA(742.4,QAN,0))#2:^(0),1:""),QANZERO=$S($D(^QA(742,QAN(0),0))#2:^(0),1:"") Q:QANZER0']""!(QANZERO']"")
"RTN","QANRPT2",81,0)
 ;S Y=$P(QANZER0,U,2) I Y]"" S C=$P(^DD(742.4,.02,0),U,2) D Y^DIQ S QANNCDT=Y
"RTN","QANRPT2",82,0)
 ;I (+$P(QANZERO,U,5)=0) D TOTAL2
"RTN","QANRPT2",83,0)
 S (QANDD,QANOUT)=0
"RTN","QANRPT2",84,0)
 F  S QANDD=$O(^QA(742,"BCS",QANCC,QANDD)) Q:QANDD'>0  D
"RTN","QANRPT2",85,0)
 .  I $P(^QA(742,QANDD,0),U,5)'=0 S QANOUT=1
"RTN","QANRPT2",86,0)
 Q
"RTN","QANRPT2",87,0)
TOTAL2 ;
"RTN","QANRPT2",88,0)
 S QANTINC=QANTINC+1
"RTN","QANRPT2",89,0)
 I $D(QANINC0(QANNCDT)) S QANINC0(QANNCDT)=QANINC0(QANNCDT)+1
"RTN","QANRPT2",90,0)
 E  S QANINC0(QANNCDT)=1
"RTN","QANRPT2",91,0)
 Q
"RTN","QANRPT2",92,0)
HDH ;
"RTN","QANRPT2",93,0)
 I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR K DIR S:+Y=0 QANFIN="^"
"RTN","QANRPT2",94,0)
 ;Q:QANFIN["^"  D HDR^QANAUX1
"RTN","QANRPT2",95,0)
 Q
"RTN","QANRPT2",96,0)
QLOOP ;ZTSAVE for TaskMan.
"RTN","QANRPT2",97,0)
 F BA="^TMP(""QANRPT1"",$J,","^TMP(""QANRPT2"",$J,","BNDRY","PAGE","TODAY","QAN","QAQ*","COUNT(","QANFIN","QANHEAD(","QANCHOS","QANDVFLG" S ZTSAVE(BA)=""
"RTN","QANRPT2",98,0)
 Q
"RTN","QANRPT2",99,0)
PRINT ;print or display data
"RTN","QANRPT2",100,0)
 I '$D(COUNT) G FINAL
"RTN","QANRPT2",101,0)
 S QANAA=""
"RTN","QANRPT2",102,0)
 F  S QANAA=$O(^TMP("QANRPT2",$J,"QAN",QANAA)) Q:QANAA']""  D
"RTN","QANRPT2",103,0)
 . D INST^QANRPT1(QANAA,.QANDV)
"RTN","QANRPT2",104,0)
 . I $G(QANDVFLG)=1 S QANHEAD(4)="REPORT FOR DIVISION: "_QANDV
"RTN","QANRPT2",105,0)
 . D HDR^QANAUX1
"RTN","QANRPT2",106,0)
 . S QANBB=0
"RTN","QANRPT2",107,0)
 . F  S QANBB=$O(^TMP("QANRPT2",$J,"QAN",QANAA,QANBB)) Q:QANBB'>0  D
"RTN","QANRPT2",108,0)
 . . S QANINCID=$P(^QA(742.1,QANBB,0),U)
"RTN","QANRPT2",109,0)
 . . D:$Y>(IOSL-6) HDH,HDR^QANAUX1 Q:QANFIN["^"
"RTN","QANRPT2",110,0)
 . . W !!?17,$E(QANINCID,1,35),?59,COUNT("INC",QANAA,QANBB)
"RTN","QANRPT2",111,0)
 . D HDH,FINAL
"RTN","QANRPT2",112,0)
 Q
"RTN","QANUTL2")
0^40^B23441520
"RTN","QANUTL2",1,0)
QANUTL2 ;HISC/GJC-Utilities for Incident Reporting (Patient Data) ;5/25/93  15:04
"RTN","QANUTL2",2,0)
 ;;2.0;Incident Reporting;**1,7,19,23,27,26**;08/07/1992
"RTN","QANUTL2",3,0)
 ;
"RTN","QANUTL2",4,0)
HDH ;Header
"RTN","QANUTL2",5,0)
 W @IOF,!!?(IOM-$L(QANHEAD(0))\2),QANHEAD(0),!,QANLINE(0),!
"RTN","QANUTL2",6,0)
 Q
"RTN","QANUTL2",7,0)
EN2 ;Edit fields for follow-up data input.  Invoked from: ^QANVAL.
"RTN","QANUTL2",8,0)
 ;VARIABLES PASSED IN *** QANDFN: Patient's ien   QANIEN: Incident's ien.
"RTN","QANUTL2",9,0)
 I +QANDFN'>0!(+QANIEN'>0) S QANXIT=1 Q
"RTN","QANUTL2",10,0)
 L +(^QA(742,QANDFN),^QA(742.4,QANIEN)):5 I '$T W !!?16,$C(7),"Another person is editing this incident record." D EXIT Q
"RTN","QANUTL2",11,0)
 S QANHEAD(0)="Edit the following patient data for "_QANAME_" AGE: "_$S(QANAGE]"":QANAGE,1:"<N/A>") S $P(QANLINE(0),"-",81)="",QANEOP=""
"RTN","QANUTL2",12,0)
 D HDH S QANGLB0=$G(^QA(742.4,QANIEN,0)) S:QANGLB0="" QANXIT=1 D:QANXIT EXIT Q:QANXIT
"RTN","QANUTL2",13,0)
 K DA,DIE,DR S DIE="^QA(742.4,",DA=QANIEN,DR=".09////"_3 D ^DIE
"RTN","QANUTL2",14,0)
 ;if there is a division entered, allow it to edited
"RTN","QANUTL2",15,0)
 I $P(^QA(742.4,QANIEN,0),U,22)]"" S DR=52 D ^DIE
"RTN","QANUTL2",16,0)
 K DA,DIE,DR
"RTN","QANUTL2",17,0)
 S QANIRIN(0)=$P(QANGLB0,U,2),QANDED=$O(^QA(742.1,"BUPPER","DEATH",0))
"RTN","QANUTL2",18,0)
 D K3 S DIE="^QA(742.4,",DA=QANIEN,DR=".02R~;I X'=QANDED S Y=""@1"";.15R~;@1;.03;.04;.05;S X=X;.07;.08" D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",19,0)
 S QANIRIN=$P(^QA(742.4,QANIEN,0),U,2) ;New Incident
"RTN","QANUTL2",20,0)
 I (QANIRIN(0)=QANDED),(QANIRIN(0)'=QANIRIN) D K3 S DA=QANIEN,DIE="^QA(742.4,",DR=".15///@" D ^DIE D K3 ;If changed from death, delete type of death.
"RTN","QANUTL2",21,0)
 K QAUDIT S QAUDIT("FILE")="742.4^50",QAUDIT("DA")=QANIEN,QAUDIT("COMMENT")="Edit an incident record",QAUDIT("ACTION")="e" D ^QAQAUDIT
"RTN","QANUTL2",22,0)
 I QANIRIN(0)'=QANIRIN D K3 S DIE="^QA(742.4,",DA=QANIEN,DR=".17///^S X=1" D ^DIE,K3 ;Resetting an incident reopens a case nationally.
"RTN","QANUTL2",23,0)
 I $D(^QA(742.1,"BUPPER","DEATH",QANIRIN))!($D(^QA(742.1,"BUPPER","SUICIDE",QANIRIN)))!($D(^QA(742.1,"BUPPER","HOMICIDE",QANIRIN))) D K3 S DIE="^QA(742,",DA=QANDFN,DR=".1///"_3 D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",24,0)
 I $D(^QA(742.1,"BUPPER","FALL",QANIRIN)) D K3 S DIE="^QA(742,",DA=QANDFN,DR=".09" D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",25,0)
 I $D(^QA(742.1,"BUPPER","PATIENT ABUSE",QANIRIN)) D K3 S DIE="^QA(742.4,",DA=QANIEN,DR=".18" D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",26,0)
 I $D(^QA(742.1,"BUPPER","MEDICATION ERROR",QANIRIN)) D K3 S DIE="^QA(742,",DA=QANDFN,DR=".11" D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",27,0)
 I $D(^QA(742.1,"BUPPER","MEDICATION ERROR",QANIRIN)),$D(X),$D(^QA(742.13,"B","OTHER",+X))#2 D EN10^QANUTL
"RTN","QANUTL2",28,0)
 D K3 S QAN6O=+$P(^QA(742,QANDFN,0),U,6),DIE="^QA(742,",DA=QANDFN,DR=".06;S X=X" D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",29,0)
 S QAN6N=+$P(^QA(742,QANDFN,0),U,6) I QAN6O'=QAN6N D K3 S QAN6T=$P($G(^SC(QAN6N,0)),U,3),DIE="^QA(742,",DA=QANDFN,DR=".05///^S X="_$S(QAN6T="W":1,1:0) D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",30,0)
 D K3 S DIE="^QA(742,",DA=QANDFN,DR=".07;.08;.15;.1;S X=X" D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",31,0)
 I $D(^QA(742.1,"BUPPER","PATIENT ABUSE",QANIRIN)),(+$P($G(^QA(742.4,QANIEN,0)),U,16)=1),(+$P($G(^QA(742,QANDFN,0)),U,10)=3) D HOMCIDE^QANUTL
"RTN","QANUTL2",32,0)
 I $D(^QA(742.1,"BUPPER","SUICIDE ATTEMPT",QANIRIN)),(+$P($G(^QA(742,QANDFN,0)),U,10)=3) D SUIATMP^QANUTL
"RTN","QANUTL2",33,0)
 K QAUDIT S QAUDIT("FILE")="742^50",QAUDIT("DA")=QANDFN,QAUDIT("COMMENT")="Edit a patient record",QAUDIT("ACTION")="e" D ^QAQAUDIT
"RTN","QANUTL2",34,0)
 D CHECK^QANUTL4 D:QANYN<0 EXIT Q:QANYN<0
"RTN","QANUTL2",35,0)
 D BDCAST^QANUTL5
"RTN","QANUTL2",36,0)
 D K3 S DIE="^QA(742,",DA=QANDFN,DR=".12;S X=X" D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",37,0)
 D K3 S DIE="^QA(742.4,",DA=QANIEN,DR=".12;S:X']""""!(X=1) Y=""@1"" S:X=2 Y=""@2"";.22;@2;.13;S X=X;.14;@1;.16;.2;S X=X" D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",38,0)
 I "12"[+$P(^QA(742.1,QANIRIN,0),U,2) D K3 S DIE="^QA(742.4,",DA=QANIEN,DR=".1;S X=X;.11" D ^DIE,K3 D EXIT:$D(Y) Q:$D(Y)
"RTN","QANUTL2",39,0)
CLOSE S %=2 F  W !!,"Do you wish to close this particular incident" D YN^DICN Q:"-112"[%  W !!,"Enter ""N""o if you wish the incident to stay open,",!,"""Y""es if you wish to close the incident."
"RTN","QANUTL2",40,0)
 S QAN("%")=%
"RTN","QANUTL2",41,0)
 I QAN("%")=1 D K3 S DIE="^QA(742.4,",DA=QANIEN,DR=".21///@" D ^DIE,K3
"RTN","QANUTL2",42,0)
 I QAN("%")=1 K QAUDIT S QAUDIT("FILE")="742.4^50",QAUDIT("DA")=QANIEN,QAUDIT("COMMENT")="Close an incident record",QAUDIT("ACTION")="c" D ^QAQAUDIT
"RTN","QANUTL2",43,0)
 I QAN("%")=1 K QAUDIT S QAUDIT("FILE")="742^50",QAUDIT("DA")=QANDFN,QAUDIT("COMMENT")="Close a patient record",QAUDIT("ACTION")="c" D ^QAQAUDIT
"RTN","QANUTL2",44,0)
 D K3 S DIE="^QA(742.4,",DA=QANIEN,DR=".09///"_$S(QAN("%")=1:0,1:"") D ^DIE,K3
"RTN","QANUTL2",45,0)
 D K3 S DIE="^QA(742,",DA=QANDFN,DR=".13///"_$S(QAN("%")=1:0,1:"") D ^DIE,K3
"RTN","QANUTL2",46,0)
EXIT L -(^QA(742,QANDFN),^QA(742.4,QANIEN)) ;Unlock QA IR globals.
"RTN","QANUTL2",47,0)
 K QAN6N,QAN6O,QAN6T,QANHEAD(0),QANINS,QANLINE(0),QANEOP,QANIRIN,QANDED
"RTN","QANUTL2",48,0)
 K QANLCTN,QANGLB0,QANGLB1,QANGLB2,INCQAN,MSSG0,MSSG1,MSSG2,MSSG3,MSSG4
"RTN","QANUTL2",49,0)
 Q
"RTN","QANUTL2",50,0)
K3 ;
"RTN","QANUTL2",51,0)
 K DIE,DA,DR
"RTN","QANUTL2",52,0)
 Q
"RTN","QANUTL3")
0^39^B9859549
"RTN","QANUTL3",1,0)
QANUTL3 ;HISC/GJC-UTILITIES FOR AN INCIDENT REPORT ;4/22/91
"RTN","QANUTL3",2,0)
 ;;2.0;Incident Reporting;**27,26**;08/07/1992
"RTN","QANUTL3",3,0)
 ;
"RTN","QANUTL3",4,0)
BULL ;Generate the bulletin.
"RTN","QANUTL3",5,0)
 I $P(^QA(740,1,"QAN"),U)="" W !!,$C(7),"*** MAILGROUP NOT SPECIFIED, REPORT TO YOUR QA COORDINATOR ***",!!,$C(7) S QANXIT=1 Q
"RTN","QANUTL3",6,0)
 I $P(^QA(740,1,"QAN"),U,2)="" W !!,$C(7),"*** MAILGROUP BULLETIN NOT SENT, REPORT TO YOUR QA COORDINATOR ***",!!,$C(7) S QANXIT=1 Q
"RTN","QANUTL3",7,0)
 D KILL^XM S QANAFRM=+$S($D(^QA(740,1,"QAN"))#2:$P(^("QAN"),U,2),1:"")
"RTN","QANUTL3",8,0)
 S QANMIEN=+$S($D(^QA(740,1,"QAN"))#2:$P(^("QAN"),U),1:"") Q:QANAFRM'>0!(QANMIEN'>0)
"RTN","QANUTL3",9,0)
 S QANMAIL="G."_$P(^XMB(3.8,QANMIEN,0),U),QANSITE=$P(^DIC(4.2,$P(^XMB(1,1,0),U),0),U)
"RTN","QANUTL3",10,0)
 I QANSITE']"" W !!,$C(7),"*** MAILGROUP BULLETIN NOT SENT, REPORT TO YOUR QA COORDINATOR, DOMAIN INFORMATION MISSING ***",!!,$C(7) S QANXIT=1 Q
"RTN","QANUTL3",11,0)
 S XMY(QANMAIL_"@"_QANSITE)=""
"RTN","QANUTL3",12,0)
 S XMSUB=^DD("SITE")_" ("_^DD("SITE",1)_") QAN INCIDENT EVENT",XMDUZ=.5
"RTN","QANUTL3",13,0)
 I $D(DUZ)#2,DUZ>0,$D(^VA(200,DUZ,0)) S X=$P($P(^(0),U),",",2)_" "_$P($P(^(0),U),",") S QANMAIL(1)=X
"RTN","QANUTL3",14,0)
 S X=$S($D(^QA(742.4,QANIEN,0))#2:$P(^(0),U,6),1:"") S:X]"" QANMAIL(2)=$P(^DIC(3.1,X,0),U) S:X']"" QANMAIL(2)=""
"RTN","QANUTL3",15,0)
 S QANMAIL(3)=$S($D(^QA(742.4,QANIEN,0))#2:$P(^(0),U),1:"")
"RTN","QANUTL3",16,0)
 S X=$S($D(^QA(742.4,QANIEN,0))#2:$P(^(0),U,2),1:"") S:X]"" QANMAIL(4)=$P(^QA(742.1,X,0),U) S:X']"" QANMAIL(4)=""
"RTN","QANUTL3",17,0)
 S Y=DT X ^DD("DD") S X=Y,QANMAIL(5)=X
"RTN","QANUTL3",18,0)
 S X=$S($D(^QA(742.4,QANIEN,0))#2:$P(^(0),U,3),1:"")
"RTN","QANUTL3",19,0)
 S Y=X X ^DD("DD") S X=Y,QANMAIL(6)=X
"RTN","QANUTL3",20,0)
 S QANMAIL(7)=$S($D(QANAME):QANAME,1:"")
"RTN","QANUTL3",21,0)
 S QANMAIL(8)=$S($D(QANSSN):QANSSN,1:"")
"RTN","QANUTL3",22,0)
 S QANWORD=$S($G(QANEDFLG)=1:"edited",1:"entered")
"RTN","QANUTL3",23,0)
 S ^UTILITY($J,"QAN PAT",1)="User "_QANMAIL(1)_" ("_QANMAIL(2)_") "_QANWORD_" incident case number "
"RTN","QANUTL3",24,0)
 S ^UTILITY($J,"QAN PAT",2)=QANMAIL(3)_" involving incident "_QANMAIL(4)_" on "_QANMAIL(5)_"."
"RTN","QANUTL3",25,0)
 S ^UTILITY($J,"QAN PAT",3)="Date of Incident: "_QANMAIL(6)
"RTN","QANUTL3",26,0)
 I $D(QANMAIL(7)) S ^UTILITY($J,"QAN PAT",4)="Patient: "_QANMAIL(7)
"RTN","QANUTL3",27,0)
 I $D(QANMAIL(8)) S ^UTILITY($J,"QAN PAT",4)=^UTILITY($J,"QAN PAT",4)_"    SSN: "_QANMAIL(8)
"RTN","QANUTL3",28,0)
 S XMTEXT="^UTILITY($J,""QAN PAT""," D ^XMD,KILL^XM K X,Y,XMB,QANMAIL,QANAFRM,QANMIEN,QANSITE,XMHOLD,XMANS
"RTN","QANUTL3",29,0)
 Q
"RTN","QANUTL3",30,0)
EN1 ;Incident location enter/edit.
"RTN","QANUTL3",31,0)
 D KDIC S (DIC,DIE)="^QA(742.5,",DLAYGO=742.5,DIC("A")="Select an Incident Location: ",DIC(0)="QEAMNLZ",DIC("W")="W ""  ""_$S($P(^(0),U,2)=1:""ACTIVE"",1:""INACTIVE"")"
"RTN","QANUTL3",32,0)
 D ^DIC
"RTN","QANUTL3",33,0)
 I Y=-1 D KDIC Q
"RTN","QANUTL3",34,0)
 S DA=+Y L +^QA(742.5,DA,0):5 I '$T W !!?16,$C(7),"Another person is editing this entry." D KDIC Q
"RTN","QANUTL3",35,0)
 S DR=".01 Incident:" D ^DIE
"RTN","QANUTL3",36,0)
 I $D(Y) D KDIC Q
"RTN","QANUTL3",37,0)
 S DR=".02 Incident Location Status:" D ^DIE
"RTN","QANUTL3",38,0)
 D KDIC
"RTN","QANUTL3",39,0)
 Q
"RTN","QANUTL3",40,0)
KDIC ;
"RTN","QANUTL3",41,0)
 I $D(DA) L -^QA(752.5,DA,0)
"RTN","QANUTL3",42,0)
 K C,D,DA,DIC,DIE,DLAYGO,DINUM,DR,X,Y
"RTN","QANUTL3",43,0)
 Q
"RTN","QANUTL4")
0^36^B23170861
"RTN","QANUTL4",1,0)
QANUTL4 ;HISC/GJC-Utilities for report generation ;6/16/93  12:05
"RTN","QANUTL4",2,0)
 ;;2.0;Incident Reporting;**1,20,26**;08/07/1992
"RTN","QANUTL4",3,0)
QANLOC ;Finding Incident Locations.
"RTN","QANUTL4",4,0)
 S (QANFLG,QANY)=0
"RTN","QANUTL4",5,0)
 W !!,"Enter the beginning and ending Incident Locations."
"RTN","QANUTL4",6,0)
 R !,"Start with Incident Location: First// ",X:DTIME
"RTN","QANUTL4",7,0)
 I '$T!(X["^") S QANY=1 Q
"RTN","QANUTL4",8,0)
 I X="" S QANLCFLG=1 Q
"RTN","QANUTL4",9,0)
 S X=$E(X)_$TR($E(X,2,999),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","QANUTL4",10,0)
 S DIC=742.5,DIC(0)="EZ" D ^DIC K DIC
"RTN","QANUTL4",11,0)
 I +Y>0 S:$D(Y(0,0)) QANDATA1=Y(0,0),QANDAT1=+Y G QANLOC1
"RTN","QANUTL4",12,0)
 I $D(DTOUT)!$D(DUOUT) S QANY=1 Q
"RTN","QANUTL4",13,0)
 I $D(X),$D(Y),X'["?",+Y=-1 W $C(7)," ??"
"RTN","QANUTL4",14,0)
 G QANLOC
"RTN","QANUTL4",15,0)
QANLOC1 ;
"RTN","QANUTL4",16,0)
 R !,"End with Incident Location: Last// ",X:DTIME
"RTN","QANUTL4",17,0)
 I '$T!(X["^") S QANY=1 Q
"RTN","QANUTL4",18,0)
 I X="" S QANDATA2="~" D QANLOC3 Q
"RTN","QANUTL4",19,0)
 S X=$E(X)_$TR($E(X,2,999),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","QANUTL4",20,0)
 S DIC=742.5,DIC(0)="EZ" D ^DIC K DIC
"RTN","QANUTL4",21,0)
 I +Y>0 S:$D(Y(0,0)) QANDATA2=Y(0,0),QANDAT2=+Y G QANLOC2
"RTN","QANUTL4",22,0)
 I $D(DTOUT)!$D(DUOUT) S QANY=1 Q
"RTN","QANUTL4",23,0)
 I $D(X),$D(Y),X'["?",+Y=-1 W $C(7)," ??"
"RTN","QANUTL4",24,0)
 G QANLOC1
"RTN","QANUTL4",25,0)
QANLOC2 I (QANDATA2']QANDATA1),(QANDATA2'=QANDATA1) D
"RTN","QANUTL4",26,0)
 . W !!,$C(7),"The 'Start With' value must fall before the 'End With' value."
"RTN","QANUTL4",27,0)
 . K QANDATA1,QANDATA2
"RTN","QANUTL4",28,0)
 . S QANFLG=1 Q
"RTN","QANUTL4",29,0)
 I $G(QANFLG) G QANLOC
"RTN","QANUTL4",30,0)
QANLOC3 ;
"RTN","QANUTL4",31,0)
 N QANCC,QANEE
"RTN","QANUTL4",32,0)
 S QANEE=$E(QANDATA1,1,$L(QANDATA1)-1)
"RTN","QANUTL4",33,0)
 S QANCC=QANDATA2_"Z"
"RTN","QANUTL4",34,0)
 F  S QANEE=$O(^QA(742.5,"B",QANEE)) Q:QANEE']""!(QANEE]QANCC)  D
"RTN","QANUTL4",35,0)
 . S QANDD=$O(^QA(742.5,"B",QANEE,0)),^TMP("QANRPT1",$J,"LOC",QANDD)=QANEE
"RTN","QANUTL4",36,0)
 Q
"RTN","QANUTL4",37,0)
WARD ;Grabbing the patient's Ward Location
"RTN","QANUTL4",38,0)
 S (QANFLG,QANY)=0
"RTN","QANUTL4",39,0)
 W !!,"Enter the beginning and ending ward/clinic locations for a patient."
"RTN","QANUTL4",40,0)
 S DIC=44,DIC(0)="QEAMNZ",DIC("A")="Start with Ward/Clinic: First// "
"RTN","QANUTL4",41,0)
 S DIC("S")="S QA=$P(^(0),U,3) I QA=""W""!(QA=""C"")" D ^DIC K DIC
"RTN","QANUTL4",42,0)
 I X="" S QANLCFLG=1 Q
"RTN","QANUTL4",43,0)
 I $D(DTOUT)!$D(DUOUT) S QANY=1 Q
"RTN","QANUTL4",44,0)
 S:$D(Y(0,0)) QANDATA1=Y(0,0),QANDAT1=+Y
"RTN","QANUTL4",45,0)
WARD1 S DIC=44,DIC(0)="QEAMNZ",DIC("A")="End with Ward/Clinic: Last// ",DIC("S")="S QA=$P(^(0),U,3) I QA=""W""!(QA=""C"")" D ^DIC K DIC
"RTN","QANUTL4",46,0)
 I X="" S QANDATA2="~" G WARD2
"RTN","QANUTL4",47,0)
 I $D(DTOUT)!$D(DUOUT) S QANY=1 Q
"RTN","QANUTL4",48,0)
 S:$D(Y(0,0)) QANDATA2=Y(0,0),QANDAT2=+Y
"RTN","QANUTL4",49,0)
WARD2 I (QANDATA2']QANDATA1),(QANDATA2'=QANDATA1) W !!,$C(7),"The 'Start with' values must fall before the 'End with' values." K QANDATA1,QANDATA2 G WARD
"RTN","QANUTL4",50,0)
 D WARD3
"RTN","QANUTL4",51,0)
 Q
"RTN","QANUTL4",52,0)
WARD3 ;STORING THE WARD LOCATION
"RTN","QANUTL4",53,0)
 N QANCC,QANEE
"RTN","QANUTL4",54,0)
 S QANEE=$E(QANDATA1,1,$L(QANDATA1)-1) ;$S($G(QANDATA1)=" ":0,1:$E(QANDATA1,1,$L(QANDATA1)-1))
"RTN","QANUTL4",55,0)
 S QANCC=$S($G(QANDATA2)="~":"ZZ",1:QANDATA2_"Z")
"RTN","QANUTL4",56,0)
 F  S QANEE=$O(^SC("B",QANEE)) Q:QANEE']""!(QANEE]QANCC)  D
"RTN","QANUTL4",57,0)
 . S QANDD=$O(^SC("B",QANEE,0))
"RTN","QANUTL4",58,0)
 . S ^TMP("QANRPT1",$J,"LOC",QANDD)=QANEE
"RTN","QANUTL4",59,0)
 Q
"RTN","QANUTL4",60,0)
INCD ;Grabbing the incident.
"RTN","QANUTL4",61,0)
 S QANY=0 W !!,"Enter the beginning and ending incident for a patient."
"RTN","QANUTL4",62,0)
 S DIC=742.1,DIC(0)="QEAMNZ",DIC("A")="Start with Incident: First// ",D="B^BUPPER" D MIX^DIC1 K D,DIC
"RTN","QANUTL4",63,0)
 I X="" S QANINFLG=1 Q
"RTN","QANUTL4",64,0)
 I $D(DTOUT)!$D(DUOUT) S QANY=1 Q
"RTN","QANUTL4",65,0)
 S:$D(Y(0,0)) QANDATA1=Y(0,0),QANDAT1=+Y
"RTN","QANUTL4",66,0)
INCD1 S DIC=742.1,DIC(0)="QEAMNZ",DIC("A")="End with Incident: Last// ",D="B^BUPPER" D MIX^DIC1 K D,DIC
"RTN","QANUTL4",67,0)
 I X="" S QANDATA2="~" G INCD2
"RTN","QANUTL4",68,0)
 I $D(DTOUT)!$D(DUOUT) S QANY=1 Q
"RTN","QANUTL4",69,0)
 S:$D(Y(0,0)) QANDATA2=Y(0,0),QANDAT2=+Y
"RTN","QANUTL4",70,0)
INCD2 I (QANDATA2']QANDATA1),(QANDATA2'=QANDATA1) W !!,$C(7),"The 'Start with' values must fall before the 'End with' values." K QANDATA1,QANDATA2 G INCD
"RTN","QANUTL4",71,0)
 D INCD3
"RTN","QANUTL4",72,0)
 Q
"RTN","QANUTL4",73,0)
INCD3 ;STORING THE INCIDENT
"RTN","QANUTL4",74,0)
 N QANCC,QANEE
"RTN","QANUTL4",75,0)
 S QANEE=$E(QANDATA1,1,$L(QANDATA1)-1) ;$S(QANDATA1=" ":"A",1:$E(QANDATA1,1,$L(QANDATA1)-1))
"RTN","QANUTL4",76,0)
 S QANCC=QANDATA2_"Z"
"RTN","QANUTL4",77,0)
 F  S QANEE=$O(^QA(742.1,"B",QANEE)) Q:QANEE']""!(QANEE]QANCC)  D
"RTN","QANUTL4",78,0)
 . S QANDD=$O(^QA(742.1,"B",QANEE,0)),^TMP("QANRPT1",$J,"INC",QANDD)=QANEE
"RTN","QANUTL4",79,0)
 Q
"RTN","QANUTL4",80,0)
CHECK ;Check for the final Incident type
"RTN","QANUTL4",81,0)
 W !!?10,"INCIDENT: "_$S(QANIRIN>0:$P(^QA(742.1,QANIRIN,0),U),1:""),!?10,"SEVERITY LEVEL: "_$S("16"'[QANIRIN:$P(^QA(742,QANDFN,0),U,10),"16"[QANIRIN:"3",1:"")
"RTN","QANUTL4",82,0)
 I "16"[QANIRIN,(+$P($G(^QA(742,QANDFN,0)),U,10)'=3) D
"RTN","QANUTL4",83,0)
 . K DA,DIE,DR S DA=QANDFN,DIE="^QA(742,",DR=".1///"_3 D ^DIE
"RTN","QANUTL4",84,0)
 . K DA,DIE,DR
"RTN","QANUTL4",85,0)
 S %=$S(+$P(^QA(742.4,QANIEN,0),U,17)=1:1,1:2)
"RTN","QANUTL4",86,0)
CHK1 F  W !!,"Is this the final incident type" D YN^DICN Q:"-112"[%  W !!,"Enter ""N""o if you wish to enter a new Incident and Severity Level,",!,"""Y""es if the current Incident and Severity Level are correct."
"RTN","QANUTL4",87,0)
 S QANYN=%
"RTN","QANUTL4",88,0)
 K DA,DR,DIE S DIE="^QA(742.4,",DA=QANIEN,DR=".19///"_$S(%=1:1,1:0) D ^DIE K DA,DR,DIE
"RTN","QANUTL4",89,0)
 Q
"RTN","QANUTL5")
0^37^B14620419
"RTN","QANUTL5",1,0)
QANUTL5 ;HISC/GJC-Utilities for Incident Reporting (Incident Status) ;10/6/92
"RTN","QANUTL5",2,0)
 ;;2.0;Incident Reporting;**1,10,18,26**;08/07/1992
"RTN","QANUTL5",3,0)
 ;
"RTN","QANUTL5",4,0)
BDCAST ;Required message broadcast.
"RTN","QANUTL5",5,0)
 S MSSG0="W !?10,""This incident requires immediate phone notification to the VISN."""
"RTN","QANUTL5",6,0)
 S MSSG1="W !?10,""This incident requires E-MAIL to the VISN."""
"RTN","QANUTL5",7,0)
 S MSSG2="W !?10,""This incident requires further investigation."""
"RTN","QANUTL5",8,0)
 S MSSG3="W !?10,""This incident requires a Mortality and Morbidity (M&M) report."""
"RTN","QANUTL5",9,0)
 S MSSG4="W !?10,""This incident requires Psychological Autopsy."""
"RTN","QANUTL5",10,0)
 S QANGLB1=$S($D(^QA(742,QANDFN,0))#2:^(0),1:""),QANGLB2=$S($D(^QA(742.4,QANIEN,0))#2:^(0),1:"") Q:QANGLB1']""!(QANGLB2']"")
"RTN","QANUTL5",11,0)
 S INCQAN("SUICIDE")=$O(^QA(742.1,"BUPPER","SUICIDE",0))
"RTN","QANUTL5",12,0)
 S INCQAN("SUICIDE ATTEMPT")=$O(^QA(742.1,"BUPPER","SUICIDE ATTEMPT",0))
"RTN","QANUTL5",13,0)
 S INCQAN("SEXUAL ASSAULT")=$O(^QA(742.1,"BUPPER","SEXUAL ASSAULT",0))
"RTN","QANUTL5",14,0)
 S INCQAN("HOMICIDE")=$O(^QA(742.1,"BUPPER","HOMICIDE",0))
"RTN","QANUTL5",15,0)
 S INCQAN("PATIENT ABUSE")=$O(^QA(742.1,"BUPPER","PATIENT ABUSE",0))
"RTN","QANUTL5",16,0)
 S INCQAN("FALL")=$O(^QA(742.1,"BUPPER","FALL",0))
"RTN","QANUTL5",17,0)
 S INCQAN("TRANSFUSION ERROR")=$O(^QA(742.1,"BUPPER","TRANSFUSION ERROR",0))
"RTN","QANUTL5",18,0)
 S INCQAN("MEDICATION ERROR")=$O(^QA(742.1,"BUPPER","MEDICATION ERROR",0))
"RTN","QANUTL5",19,0)
 S INCQAN("INJURY NOT OTHERWISE LISTED")=$O(^QA(742.1,"BUPPER","INJURY NOT OTHERWISE LISTED",0))
"RTN","QANUTL5",20,0)
 S INCQAN("FIRE-PATIENT INVOLVED IN")=$O(^QA(742.1,"BUPPER","FIRE-PATIENT INVOLVED IN",0))
"RTN","QANUTL5",21,0)
 S INCQAN("ASSAULT-PATIENT TO PATIENT")=$O(^QA(742.1,"BUPPER","ASSAULT-PATIENT TO PATIENT",0))
"RTN","QANUTL5",22,0)
 S INCQAN("ASSAULT-PATIENT/STAFF")=$O(^QA(742.1,"BUPPER","ASSAULT-PATIENT/STAFF",0))
"RTN","QANUTL5",23,0)
 S INCQAN("DEATH")=$O(^QA(742.1,"BUPPER","DEATH",0))
"RTN","QANUTL5",24,0)
 S INCQAN("MISSING PATIENT")=$O(^QA(742.1,"BUPPER","MISSING PATIENT",0))
"RTN","QANUTL5",25,0)
 S INCQAN("INFORMED CONSENT-FAIL. TO OBTAIN")=$O(^QA(742.1,"BUPPER","INFORMED CONSENT-FAIL. TO OBTAIN",0))
"RTN","QANUTL5",26,0)
 I $P(QANGLB2,U,2)=INCQAN("DEATH") D DEATH^QANUTL Q
"RTN","QANUTL5",27,0)
 I $P(QANGLB2,U,2)=INCQAN("SUICIDE") X MSSG0,MSSG1,MSSG4
"RTN","QANUTL5",28,0)
 I $P(QANGLB2,U,2)=INCQAN("SUICIDE ATTEMPT"),("01"[$P(QANGLB1,U,10)) X MSSG1,MSSG3
"RTN","QANUTL5",29,0)
 I $P(QANGLB2,U,2)=INCQAN("SUICIDE ATTEMPT"),($P(QANGLB1,U,10)["2") X MSSG0,MSSG1,MSSG3
"RTN","QANUTL5",30,0)
 I $P(QANGLB2,U,2)=INCQAN("PATIENT ABUSE") D ABUSE^QANUTL Q
"RTN","QANUTL5",31,0)
 I $P(QANGLB2,U,2)=INCQAN("INFORMED CONSENT-FAIL. TO OBTAIN") X MSSG1
"RTN","QANUTL5",32,0)
 I $P(QANGLB2,U,2)=INCQAN("FALL"),($P(QANGLB1,U,10)["2") X MSSG1
"RTN","QANUTL5",33,0)
 I $P(QANGLB2,U,2)=INCQAN("FALL"),($P(QANGLB1,U,10)["3") X MSSG0,MSSG1,MSSG2
"RTN","QANUTL5",34,0)
 I $P(QANGLB2,U,2)=INCQAN("HOMICIDE") X MSSG0,MSSG1,MSSG2
"RTN","QANUTL5",35,0)
 I $P(QANGLB2,U,2)=INCQAN("MEDICATION ERROR"),($P(QANGLB1,U,10)["2") X MSSG1,MSSG2
"RTN","QANUTL5",36,0)
 I $P(QANGLB2,U,2)=INCQAN("MEDICATION ERROR"),($P(QANGLB1,U,10)["3") X MSSG0,MSSG1,MSSG2
"RTN","QANUTL5",37,0)
 I $P(QANGLB2,U,2)=INCQAN("MISSING PATIENT"),($P(QANGLB1,U,10)["2") X MSSG1,MSSG2
"RTN","QANUTL5",38,0)
 I $P(QANGLB2,U,2)=INCQAN("MISSING PATIENT"),($P(QANGLB1,U,10)["3") X MSSG0,MSSG1,MSSG2
"RTN","QANUTL5",39,0)
 I $P(QANGLB2,U,2)=INCQAN("ASSAULT-PATIENT/STAFF"),($P(QANGLB1,U,10)["2") X MSSG1,MSSG2
"RTN","QANUTL5",40,0)
 I $P(QANGLB2,U,2)=INCQAN("ASSAULT-PATIENT/STAFF"),($P(QANGLB1,U,10)["3") X MSSG0,MSSG1,MSSG2
"RTN","QANUTL5",41,0)
 I $P(QANGLB2,U,2)=INCQAN("ASSAULT-PATIENT TO PATIENT"),("23"[$P(QANGLB1,U,10)) X MSSG0,MSSG1,MSSG2
"RTN","QANUTL5",42,0)
 I $P(QANGLB2,U,2)=INCQAN("INJURY NOT OTHERWISE LISTED"),($P(QANGLB1,U,10)["2") X MSSG1,MSSG2
"RTN","QANUTL5",43,0)
 I $P(QANGLB2,U,2)=INCQAN("INJURY NOT OTHERWISE LISTED"),($P(QANGLB1,U,10)["3") X MSSG0,MSSG1,MSSG2
"RTN","QANUTL5",44,0)
 I $P(QANGLB2,U,2)=INCQAN("FIRE-PATIENT INVOLVED IN"),("23"[$P(QANGLB1,U,10)) X MSSG0,MSSG1,MSSG2
"RTN","QANUTL5",45,0)
 I $P(QANGLB2,U,2)=INCQAN("SEXUAL ASSAULT") X MSSG0,MSSG1,MSSG2
"RTN","QANUTL5",46,0)
 I $P(QANGLB2,U,2)=INCQAN("TRANSFUSION ERROR"),($P(QANGLB1,U,10)["2") X MSSG1,MSSG2
"RTN","QANUTL5",47,0)
 I $P(QANGLB2,U,2)=INCQAN("TRANSFUSION ERROR"),($P(QANGLB1,U,10)["3") X MSSG0,MSSG1,MSSG2
"RTN","QANUTL5",48,0)
EXIT ;Exit and Quit!
"RTN","QANUTL5",49,0)
 Q
"VER")
8.0^22.0
"^DD",740,740,0)
FIELD^^752^64
"^DD",740,740,0,"DDA")
N
"^DD",740,740,0,"DT")
2980305
"^DD",740,740,0,"IX","B",740,.01)

"^DD",740,740,0,"IX","B",741.97,.01)

"^DD",740,740,0,"NM","QUALITY ASSURANCE SITE PARAMETERS")

"^DD",740,740,.001,0)
NUMBER^NJ1,0^^ ^K:+X'=X!(X>1)!(X<1)!(X?.E1"."1N.N) X
"^DD",740,740,.001,3)
Please enter '1', only one entry allowed.
"^DD",740,740,.001,21,0)
^^2^2^2930208^
"^DD",740,740,.001,21,1,0)
This file has DINUM set to one (1).  The only valid entry for this field
"^DD",740,740,.001,21,2,0)
is 1.
"^DD",740,740,.001,"DT")
2891010
"^DD",740,740,.01,0)
NAME^P4'X^DIC(4,^0;1^S DINUM=1
"^DD",740,740,.01,.1)
SITE NAME
"^DD",740,740,.01,1,0)
^.1
"^DD",740,740,.01,1,1,0)
740^B
"^DD",740,740,.01,1,1,1)
S ^QA(740,"B",$E(X,1,30),DA)=""
"^DD",740,740,.01,1,1,2)
K ^QA(740,"B",$E(X,1,30),DA)
"^DD",740,740,.01,3)
Please enter your station name or number.
"^DD",740,740,.01,21,0)
^^1^1^2910329^^
"^DD",740,740,.01,21,1,0)
This is the name of this institution.
"^DD",740,740,.01,"DT")
2911121
"^DD",740,740,740.01,0)
EWS MAIL GROUP/SERVER^F^^0;2^K:$L(X)>32!($L(X)<5)!'(X?1U1"."3.30NUP) X
"^DD",740,740,740.01,3)
Answer must be 5-32 characters in length.
"^DD",740,740,740.01,21,0)
^^3^3^2910911^^^^
"^DD",740,740,740.01,21,1,0)
Enter the mail group or server name that the Early Warning System
"^DD",740,740,740.01,21,2,0)
bulletin should be sent to.  For mail groups you should enter
"^DD",740,740,740.01,21,3,0)
G.(MAILGROUP).  For mail servers you should enter S.(MAILSERVER).
"^DD",740,740,740.01,"DT")
2920402
"^DD",740,740,740.02,0)
EWS DOMAIN^FX^^0;3^S DIC=4.2,DIC(0)="EMNQ" D ^DIC S X=$P(Y,"^",2) K:Y'>0 X
"^DD",740,740,740.02,3)
Answer must be 1-12 characters in length.
"^DD",740,740,740.02,4)
N D,X S D="B",DIC="^DIC(4.2,",DIC(0)="AEMNQ" D DQ^DICQ Q
"^DD",740,740,740.02,21,0)
^^2^2^2910715^^^
"^DD",740,740,740.02,21,1,0)
Enter the domain name that the Early Warning System bulletins
"^DD",740,740,740.02,21,2,0)
should be sent to.
"^DD",740,740,740.02,"DT")
2910610
"^DD",740,740,740.03,0)
NQADB MAIL GROUP/SERVER^F^^0;4^K:$L(X)>32!($L(X)<5)!'(X?1U1"."3.30NUP) X
"^DD",740,740,740.03,3)
Answer must be 5-32 characters in length.
"^DD",740,740,740.03,21,0)
^^3^3^2910708^
"^DD",740,740,740.03,21,1,0)
Enter the mail group or server name that the NQADB bulletin should be sent 
"^DD",740,740,740.03,21,2,0)
to.  For mail groups you should enter, G.MAILGROUP.  For mail servers
"^DD",740,740,740.03,21,3,0)
you should enter, S.MAILSERVER.
"^DD",740,740,740.03,"DT")
2920402
"^DD",740,740,740.04,0)
NQADB DOMAIN^FX^^0;5^S DIC=4.2,DIC(0)="EMNQ" D ^DIC S X=$P(Y,"^",2) K:Y'>0 X
"^DD",740,740,740.04,3)
Answer must be 1-12 characters in length.
"^DD",740,740,740.04,4)
N D,X S D="B",DIC="^DIC(4.2,",DIC(0)="AEMNQ" D DQ^DICQ Q
"^DD",740,740,740.04,21,0)
^^1^1^2910708^
"^DD",740,740,740.04,21,1,0)
Enter the domain name that the NQADB bulletins should be sent to.
"^DD",740,740,740.04,"DT")
2910708
"^DD",740,740,740.05,0)
EWS LOCAL MAIL GROUP^P3.8'^XMB(3.8,^0;6^Q
"^DD",740,740,740.05,3)
Enter the mail group at your site that the automatic EWS bulletins should be sent to.
"^DD",740,740,740.05,21,0)
^^4^4^2910725^^
"^DD",740,740,740.05,21,1,0)
This field contains the local mail group that the EWS bulletins
"^DD",740,740,740.05,21,2,0)
should be sent to.  This will allow the member(s) of the mail
"^DD",740,740,740.05,21,3,0)
group to save the EWS bulletins in their own mail baskets and to
"^DD",740,740,740.05,21,4,0)
check the status of those bulletins.
"^DD",740,740,740.05,"DT")
2910724
"^DD",740,740,740.06,0)
MAIL GROUP (IRM)^P3.8'^XMB(3.8,^0;7^Q
"^DD",740,740,740.06,3)
Enter a mail group in which IRM will receive diagnostic messages.
"^DD",740,740,740.06,21,0)
^^2^2^2930210^^
"^DD",740,740,740.06,21,1,0)
This field contains a mail group in which IRM will receive diagnostic
"^DD",740,740,740.06,21,2,0)
messages pertaining to the QM module.
"^DD",740,740,740.06,"DT")
2930210
"^DD",740,740,740.07,0)
IRM MAIL GROUP SWITCH^S^1:YES;^0;8^Q
"^DD",740,740,740.07,3)
Enter 'Y'es if diagnostic mail is to be delivered to IRM.
"^DD",740,740,740.07,21,0)
^^2^2^2930210^
"^DD",740,740,740.07,21,1,0)
 
"^DD",740,740,740.07,21,2,0)
Indicates if diagnostic mail is to be delivered to IRM.
"^DD",740,740,740.07,"DT")
2930210
"^DD",740,740,740.99,0)
VERSION (QAQ)^F^^VER;5^K:$L(X)>8!($L(X)<1)!'(X?1N.ANP) X
"^DD",740,740,740.99,3)
Enter the version of this package currently running, (1-8 characters).
"^DD",740,740,740.99,21,0)
^^1^1^2930208^
"^DD",740,740,740.99,21,1,0)
Indicates the version of the QM Integration Module package.
"^DD",740,740,740.99,"DT")
2921022
"^DD",740,740,741.01,0)
PEER REVIEW DAYS^NJ3,0^^OS;1^K:+X'=X!(X>365)!(X<0)!(X?.E1"."1N.N) X
"^DD",740,740,741.01,3)
Type a Number between 0 and 365, 0 Decimal Digits
"^DD",740,740,741.01,20,0)
^.3LA^1^1
"^DD",740,740,741.01,20,1,0)
QAOS
"^DD",740,740,741.01,21,0)
^^2^2^2891010^^^
"^DD",740,740,741.01,21,1,0)
This is the allowable number of days between the completion of the
"^DD",740,740,741.01,21,2,0)
Clinical Review and the completion of the Peer Review.
"^DD",740,740,741.01,"DT")
2900201
"^DD",740,740,741.02,0)
MANAGEMENT REVIEW DAYS^NJ3,0^^OS;2^K:+X'=X!(X>365)!(X<0)!(X?.E1"."1N.N) X
"^DD",740,740,741.02,3)
Type a Number between 0 and 365, 0 Decimal Digits
"^DD",740,740,741.02,20,0)
^.3LA^1^1
"^DD",740,740,741.02,20,1,0)
QAOS
"^DD",740,740,741.02,21,0)
^^2^2^2891010^^^
"^DD",740,740,741.02,21,1,0)
This is the number of allowable days between the completion of the
"^DD",740,740,741.02,21,2,0)
Clinical Review and the completion of the Management Review.
"^DD",740,740,741.02,"DT")
2900201
"^DD",740,740,741.03,0)
CLINICAL WORKSHEET PART 1^RS^0:NO;1:YES;^OS;3^Q
"^DD",740,740,741.03,3)
ENTER 'YES' TO PRINT PART 1 OF THE CLINICAL WORKSHEET.
"^DD",740,740,741.03,20,0)
^.3LA^1^1
"^DD",740,740,741.03,20,1,0)
QAOS
"^DD",740,740,741.03,21,0)
^^3^3^2900206^^^^
"^DD",740,740,741.03,21,1,0)
This field controls the printing of PART 1 of the CLINICAL WORKSHEET.
"^DD",740,740,741.03,21,2,0)
        0- 'NO', do not print part 1.
"^DD",740,740,741.03,21,3,0)
        1- 'YES', print part 1.
"^DD",740,740,741.03,"DT")
2891010
"^DD",740,740,741.04,0)
AUTO-PRINT CLINICAL WORKSHEET^RS^0:NO;1:YES;^OS;4^Q
"^DD",740,740,741.04,3)
ENTER 'YES' TO PRINT CLINICAL WORKSHEETS AS PART OF THE AUTO ENROLL PROCESS.
"^DD",740,740,741.04,20,0)
^.3LA^1^1
"^DD",740,740,741.04,20,1,0)
QAOS
"^DD",740,740,741.04,21,0)
^^4^4^2900503^^^^
"^DD",740,740,741.04,21,1,0)
This field controls whether or not Clinical Worksheets are automatically
"^DD",740,740,741.04,21,2,0)
printed as part of the Auto Enrollment process.
"^DD",740,740,741.04,21,3,0)
       0- 'NO', do not print Clinical Worksheets.
"^DD",740,740,741.04,21,4,0)
       1- 'YES', print Clinical Worksheets.
"^DD",740,740,741.04,"DT")
2891010
"^DD",740,740,741.05,0)
DEFAULT OS DEVICE^RFXO^^OS;5^D EN1^QAQAUTL K:Y<0 X
"^DD",740,740,741.05,2)
S Y(0)=Y S Y=$P(Y,";")
"^DD",740,740,741.05,2.1)
S Y=$P(Y,";")
"^DD",740,740,741.05,3)
ENTER THE DEFAULT 'OCCURRENCE SCREEN' PRINTER DEVICE.
"^DD",740,740,741.05,4)
D EN3^QAQAUTL(740,741.05)
"^DD",740,740,741.05,20,0)
^.3LA^1^1
"^DD",740,740,741.05,20,1,0)
QAOS
"^DD",740,740,741.05,21,0)
^^2^2^2920924^^^^
"^DD",740,740,741.05,21,1,0)
This field contains the default printer device for OCCURRENCE SCREEN.
"^DD",740,740,741.05,21,2,0)
Auto-Print Clinical Worksheets will be routed to this device.
"^DD",740,740,741.05,"DT")
2930819
"^DD",740,740,741.06,0)
MIN TIME BETWEEN LOGOUT & ADM^NJ4,1^^OS;6^K:+X'=X!(X>24)!(X<0)!(X?.E1"."2N.N) X
"^DD",740,740,741.06,3)
Type a Number between 0 and 24, up to 1 Decimal Digit
"^DD",740,740,741.06,21,0)
^^6^6^2910509^^^
"^DD",740,740,741.06,21,1,0)
Enter the minimum time, in hours, between a disposition log out and an
"^DD",740,740,741.06,21,2,0)
admission.  This time is used when auto enrolling admissions within 3
"^DD",740,740,741.06,21,3,0)
days following unscheduled ambulatory care visits.  If the time between
"^DD",740,740,741.06,21,4,0)
the log out and the admission is less than this time, the event will not
"^DD",740,740,741.06,21,5,0)
be captured.  If the time is greater than or equal to this time, it will
"^DD",740,740,741.06,21,6,0)
be captured.
"^DD",740,740,741.06,"DT")
2910503
"^DD",740,740,741.07,0)
SCHEDULED ADMISSION CLINIC^740.01PA^^OS1;0
"^DD",740,740,741.07,21,0)
^^3^3^2930208^
"^DD",740,740,741.07,21,1,0)
This field contains the clinic(s) that are used to schedule patient
"^DD",740,740,741.07,21,2,0)
admissions.  The data entered in this field is used by the auto enroll to
"^DD",740,740,741.07,21,3,0)
determine which admissions are scheduled.
"^DD",740,740,741.07,"DT")
2921109
"^DD",740,740,741.08,0)
SURGERY PACKAGE INSTALLED^S^1:YES;0:NO;^OS;7^Q
"^DD",740,740,741.08,3)
Enter Y(es) if the DHCP Surgery package is installed at your site.
"^DD",740,740,741.08,21,0)
^^2^2^2920421^
"^DD",740,740,741.08,21,1,0)
If this field is answered Y(es) the auto enroll will scan the Surgery
"^DD",740,740,741.08,21,2,0)
package for screen 107, Return to the O.R. in the same admission.
"^DD",740,740,741.08,"DT")
2920421
"^DD",740,740,741.09,0)
ALLOW MULT PATIENT SELECTION^S^1:YES;0:NO;^OS;8^Q
"^DD",740,740,741.09,3)
Enter Y(es) to select several patients to edit at once.
"^DD",740,740,741.09,21,0)
^^5^5^2930217^
"^DD",740,740,741.09,21,1,0)
Entering Y(es) at this prompt will allow you to select several patients
"^DD",740,740,741.09,21,2,0)
at once for editing.  Patients may be selected in the normal manner,
"^DD",740,740,741.09,21,3,0)
i.e., by name, SSN, etc., or by an occurrence date range.  The selected
"^DD",740,740,741.09,21,4,0)
patients will then be brought up sequentially for editing.  Entering
"^DD",740,740,741.09,21,5,0)
N(o) will allow you to select only one patient at a time.
"^DD",740,740,741.09,21,6,0)
Multiple patient selection will work in the following options:
"^DD",740,740,741.09,21,7,0)
 1) Quick Exception Edit
"^DD",740,740,741.09,21,8,0)
 2) Validation/Confirmation
"^DD",740,740,741.09,21,9,0)
 3) Delete Occurrence Screen Record
"^DD",740,740,741.09,21,10,0)
 4) Reopen Closed/Deleted Occurrence Screen Record
"^DD",740,740,741.09,"DT")
2920805
"^DD",740,740,741.1,0)
MULTI-DIVISIONAL OS FACILITY^S^0:NO;1:YES;^OS;9^Q
"^DD",740,740,741.1,3)
Enter Y(es) if this is a multi-divisional facility.
"^DD",740,740,741.1,21,0)
^^5^5^2971122^^
"^DD",740,740,741.1,21,1,0)
 
"^DD",740,740,741.1,21,2,0)
This field is used in conjunction with the DIVISION field to determine
"^DD",740,740,741.1,21,3,0)
which output device the auto enroll reports will be sent to.  Answering
"^DD",740,740,741.1,21,4,0)
Y(es) to this field will allow you to select a different auto enroll
"^DD",740,740,741.1,21,5,0)
output device for each division.
"^DD",740,740,741.1,"DT")
2971122
"^DD",740,740,741.11,0)
OS HOSPITAL DIVISION^740.02IPA^^OS2;0
"^DD",740,740,741.11,"DT")
2971122
"^DD",740,740,741.97,0)
*SCREEN FILE CONVERSION DATE^D^^QAO;2^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",740,740,741.97,3)
Enter the date the screen file entries were DINUMed.
"^DD",740,740,741.97,21,0)
^^4^4^2910809^
"^DD",740,740,741.97,21,1,0)
This field contains the date that the entries in the screen file #741.1
"^DD",740,740,741.97,21,2,0)
were DINUMed.  This field is used to prevent the conversion from being
"^DD",740,740,741.97,21,3,0)
run twice.  Running this conversion twice would not corrupt the data,
"^DD",740,740,741.97,21,4,0)
but it could potentially waste a lot of time.
"^DD",740,740,741.97,"DT")
2910809
"^DD",740,740,741.98,0)
*SEVERITY CONVERSION DATE^D^^QAO;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",740,740,741.98,3)
Enter the date that the severity levels were converted.
"^DD",740,740,741.98,21,0)
^^3^3^2910809^^^^
"^DD",740,740,741.98,21,1,0)
This field contains the date that the severity levels in file #741.8
"^DD",740,740,741.98,21,2,0)
were converted from a seven point scale to a four point scale.  This
"^DD",740,740,741.98,21,3,0)
field is used to prevent the conversion from being run twice.
"^DD",740,740,741.98,"DT")
2910613
"^DD",740,740,741.99,0)
VERSION (QAO)^F^^VER;1^K:$L(X)>8!($L(X)<1)!'(X?1N.ANP) X
"^DD",740,740,741.99,3)
Enter the version of this package currently running, (1-8 characters).
"^DD",740,740,741.99,21,0)
^^1^1^2930208^
"^DD",740,740,741.99,21,1,0)
Indicates the version of the Occurrence Screen package.
"^DD",740,740,741.99,21,2,0)
installed with QAO.
"^DD",740,740,741.99,"DT")
2921022
"^DD",740,740,742.01,0)
MAIL GROUP (QAN)^P3.8'^XMB(3.8,^QAN;1^Q
"^DD",740,740,742.01,3)
Enter the MAILGROUP the bulletin should be sent to.
"^DD",740,740,742.01,21,0)
^^2^2^2930204^^^^
"^DD",740,740,742.01,21,1,0)
Indicates the MAILGROUP where the mail message should be sent.
"^DD",740,740,742.01,21,2,0)
A proper recipient should be specified at this time.
"^DD",740,740,742.01,"DT")
2930204
"^DD",740,740,742.02,0)
BULLETIN SENT (QAN)^S^1:YES;^QAN;2^Q
"^DD",740,740,742.02,3)
Enter whether the bulletin should be fired off to the specified mailgroup.
"^DD",740,740,742.02,21,0)
^^1^1^2910916^^^
"^DD",740,740,742.02,21,1,0)
Indicates whether a bulletin will be sent off to the specified mailgroup.
"^DD",740,740,742.02,"DT")
2930204
"^DD",740,740,742.03,0)
RESPONSIBLE PERSON SWITCH^S^0:OFF;1:ON;^QAN;3^Q
"^DD",740,740,742.03,3)
Enter whether the field 'Resposible Person' should be asked.
"^DD",740,740,742.03,21,0)
^^1^1^2930129^
"^DD",740,740,742.03,21,1,0)
Indicates whether or not the 'Responsible Person' field should be asked.
"^DD",740,740,742.03,"DT")
2930129
"^DD",740,740,742.04,0)
QM TIME FRAME^NJ2,0^^QAN;4^K:+X'=X!(X>10)!(X<1)!(X?.E1"."1N.N) X
"^DD",740,740,742.04,3)
Enter the number of days after which you will receive a warning.
"^DD",740,740,742.04,21,0)
^^5^5^2931012^
"^DD",740,740,742.04,21,1,0)
     This field hold the number of days the user wishes to wait before the
"^DD",740,740,742.04,21,2,0)
system warns the user of potential negligence in filing a 'VA 10-2633
"^DD",740,740,742.04,21,3,0)
Report Of Special Incident Involving A Beneficiary' form.  This is only
"^DD",740,740,742.04,21,4,0)
for incident events that do not require immediate notification to the
"^DD",740,740,742.04,21,5,0)
region.
"^DD",740,740,742.04,"DT")
2931012
"^DD",740,740,742.99,0)
VERSION (QAN)^F^^VER;6^K:$L(X)>8!($L(X)<1)!'(X?1N.ANP) X
"^DD",740,740,742.99,3)
Enter the version of this package currently running, (1-8 characters).
"^DD",740,740,742.99,21,0)
^^1^1^2930208^^^
"^DD",740,740,742.99,21,1,0)
Indicates the version of the Incident Reporting package.
"^DD",740,740,742.99,"DT")
2921022
"^DD",740,740,743.01,0)
DAY WEEKLY TIME FRAME BEGINS^S^0:Sunday;1:Monday;2:Tuesday;3:Wednesday;4:Thursday;5:Friday;6:Saturday;^QAM;1^Q
"^DD",740,740,743.01,3)
Enter the day the weekly time frame begins.
"^DD",740,740,743.01,21,0)
^^3^3^2910115^^
"^DD",740,740,743.01,21,1,0)
This field contains the day of the week that the weekly time frame
"^DD",740,740,743.01,21,2,0)
begins.  This data is used by auto enroll for the update of the
"^DD",740,740,743.01,21,3,0)
history file.
"^DD",740,740,743.01,"DT")
2901210
"^DD",740,740,743.02,0)
MONITORING SYSTEM DEVICE^RFXO^^QAM;2^D EN1^QAQAUTL K:Y<0 X
"^DD",740,740,743.02,2)
S Y(0)=Y S Y=$P(Y,";")
"^DD",740,740,743.02,2.1)
S Y=$P(Y,";")
"^DD",740,740,743.02,3)
ENTER THE DEFAULT 'MONITORING SYSTEM' PRINTER DEVICE.
"^DD",740,740,743.02,4)
D EN3^QAQAUTL(740,743.02)
"^DD",740,740,743.02,20,0)
^.3LA^1^1
"^DD",740,740,743.02,20,1,0)
QAM
"^DD",740,740,743.02,21,0)
^^2^2^2910717^^^^
"^DD",740,740,743.02,21,1,0)
This field contains the default printer device for the Monitoring
"^DD",740,740,743.02,21,2,0)
System.  Auto-Print Fall Out Reports will be routed to this device. 
"^DD",740,740,743.02,"DT")
2910717
"^DD",740,740,743.03,0)
MAX DAYS PER MANUAL AUTO RUN^NJ2,0^^QAM;3^K:+X'=X!(X>31)!(X<1)!(X?.E1"."1N.N) X
"^DD",740,740,743.03,3)
Type a Number between 1 and 31, 0 Decimal Digits
"^DD",740,740,743.03,21,0)
^^2^2^2930910^
"^DD",740,740,743.03,21,1,0)
This field gives the maximum number of auto enroll runs that may
"^DD",740,740,743.03,21,2,0)
be run consecutively.
"^DD",740,740,743.03,"DT")
2910109
"^DD",740,740,743.04,0)
TIME BETWEEN MANUAL AUTO RUNS^NJ3,0^^QAM;4^K:+X'=X!(X>120)!(X<1)!(X?.E1"."1N.N) X
"^DD",740,740,743.04,3)
Type the number of minutes between 1 and 120, 0 decimal digits.
"^DD",740,740,743.04,21,0)
^^2^2^2910115^
"^DD",740,740,743.04,21,1,0)
This field contains the number of minutes between queued runs of
"^DD",740,740,743.04,21,2,0)
auto enroll.
"^DD",740,740,743.04,"DT")
2910109
"^DD",740,740,743.05,0)
MANUAL AUTO RUN ALLOWED TIMES^FX^^QAM;5^K:$L(X)>9!($L(X)<9)!'(X?4N1"-"4N) X D:$D(X) EN5^QAQAUTL
"^DD",740,740,743.05,3)
Enter the range of times a manual auto enroll may run.
"^DD",740,740,743.05,21,0)
^^4^4^2910115^
"^DD",740,740,743.05,21,1,0)
This field contains the range of time during which auto enroll may be
"^DD",740,740,743.05,21,2,0)
manually queued to run.  The format is HHMM-HHMM, where HH = Hours
"^DD",740,740,743.05,21,3,0)
(00-23), and MM = Minutes (00-59).  The second time must be greater
"^DD",740,740,743.05,21,4,0)
than the first.
"^DD",740,740,743.05,"DT")
2910322
"^DD",740,740,743.06,0)
ALLOW USE OF `[' IN GROUP EDIT^S^1:YES;0:NO;^QAM;6^Q
"^DD",740,740,743.06,3)
Enter Y(es) if the contains operator ([) is allowed in the group edit.
"^DD",740,740,743.06,21,0)
^^3^3^2910321^^
"^DD",740,740,743.06,21,1,0)
If this field is set to YES the user may enter [GROUP MEMBER at the
"^DD",740,740,743.06,21,2,0)
Select GROUP MEMBER prompt to select all entries that contain the text
"^DD",740,740,743.06,21,3,0)
GROUP MEMBER as part of their name.
"^DD",740,740,743.06,"DT")
2910221
"^DD",740,740,743.99,0)
VERSION (QAM)^F^^VER;2^K:$L(X)>8!($L(X)<1)!'(X?1N.ANP) X
"^DD",740,740,743.99,3)
Enter the version of this package currently running, (1-8 characters).
"^DD",740,740,743.99,21,0)
^^1^1^2930208^
"^DD",740,740,743.99,21,1,0)
Indicates the version of the Monitoring System package.
"^DD",740,740,743.99,"DT")
2921022
"^DD",740,740,745.01,0)
DISPLAY ISSUE CODES?^S^1:YES;0:NO;^QAC;1^Q
"^DD",740,740,745.01,3)
Enter YES if you want to display Issue Codes and Services that were previously selected.
"^DD",740,740,745.01,21,0)
^^3^3^2941214^
"^DD",740,740,745.01,21,1,0)
While editing a contact record, if you want to display all the Issue Codes
"^DD",740,740,745.01,21,2,0)
and Services you previously selected prior to the prompt Issue Codes,
"^DD",740,740,745.01,21,3,0)
enter YES at this prompt.
"^DD",740,740,745.01,"DT")
2941207
"^DD",740,740,745.02,0)
AUTOMATIC ROC ALERT^S^1:YES;0:NO;^QAC;2^Q
"^DD",740,740,745.02,3)
Enter 'YES' to automatically send ROC alerts to entries in the Refer Contact To field.
"^DD",740,740,745.02,21,0)
^^4^4^2950201^
"^DD",740,740,745.02,21,1,0)
If this field contains a 'YES', an alert for a Patient Rep Report of
"^DD",740,740,745.02,21,2,0)
Contact will be sent automatically to the entries in the Refer Contact To
"^DD",740,740,745.02,21,3,0)
field.  Responses from each alert will be automatically laid into the
"^DD",740,740,745.02,21,4,0)
Resolution field for review/edit by the Patient Representative.
"^DD",740,740,745.02,"DT")
2941214
"^DD",740,740,745.99,0)
VERSION (QAC)^F^^VER;7^K:$L(X)>8!($L(X)<1) X
"^DD",740,740,745.99,3)
Enter the version of this package currently running, (1-8 characters).
"^DD",740,740,745.99,21,0)
^^1^1^2931019^
"^DD",740,740,745.99,21,1,0)
Indicates the version of the Patient Representative package.
"^DD",740,740,745.99,"DT")
2931019
"^DD",740,740,747.01,0)
1ST ADDRESS LINE^F^^RC;1^K:$L(X)>30!($L(X)<3) X
"^DD",740,740,747.01,3)
Answer must be 3-30 characters in length.
"^DD",740,740,747.01,21,0)
^^1^1^2921217^
"^DD",740,740,747.01,21,1,0)
This field contains the 1st address line for the Facility.
"^DD",740,740,747.01,"DT")
2891030
"^DD",740,740,747.02,0)
2ND ADDRESS LINE^F^^RC;2^K:$L(X)>30!($L(X)<3) X
"^DD",740,740,747.02,3)
Answer must be 3-30 characters in length.
"^DD",740,740,747.02,21,0)
^^1^1^2921217^
"^DD",740,740,747.02,21,1,0)
This field contains the 2nd address line for the Facility.
"^DD",740,740,747.02,"DT")
2891030
"^DD",740,740,747.03,0)
CITY^F^^RC;3^K:$L(X)>30!($L(X)<3) X
"^DD",740,740,747.03,3)
Answer must be 3-30 characters in length.
"^DD",740,740,747.03,21,0)
^^1^1^2921217^
"^DD",740,740,747.03,21,1,0)
This field contains the city of the Facility.
"^DD",740,740,747.03,"DT")
2891030
"^DD",740,740,747.04,0)
STATE^P5'^DIC(5,^RC;4^Q
"^DD",740,740,747.04,21,0)
^^2^2^2921217^
"^DD",740,740,747.04,21,1,0)
This field is a pointer to the State File and contains the State of the
"^DD",740,740,747.04,21,2,0)
Facility.
"^DD",740,740,747.04,"DT")
2891030
"^DD",740,740,747.05,0)
ZIP ^F^^RC;5^K:$L(X)>10!($L(X)<5) X
"^DD",740,740,747.05,3)
Answer must be 5-10 characters in length.
"^DD",740,740,747.05,21,0)
^^1^1^2921217^
"^DD",740,740,747.05,21,1,0)
This field contains the zip code of the Facility.
"^DD",740,740,747.05,"DT")
2891030
"^DD",740,740,747.06,0)
MAIN TELE. NO.^F^^RC;6^K:$L(X)>14!($L(X)<7) X
"^DD",740,740,747.06,3)
Answer must be 7-14 characters in length.
"^DD",740,740,747.06,21,0)
^^1^1^2910401^
"^DD",740,740,747.06,21,1,0)
Please use the format:(XXX)111-1111
"^DD",740,740,747.06,"DT")
2891030
"^DD",740,740,747.07,0)
COORD. SEC. NAME^F^^RC;7^K:$L(X)>30!($L(X)<3) X
"^DD",740,740,747.07,3)
Answer must be 3-30 characters in length.
"^DD",740,740,747.07,21,0)
^^1^1^2921217^^^^
"^DD",740,740,747.07,21,1,0)
Name of the Credentialing Coordinator's Secretary.
"^DD",740,740,747.07,"DT")
2891030
"^DD",740,740,747.08,0)
COORDINATOR^F^^RC;8^K:$L(X)>30!($L(X)<3) X
"^DD",740,740,747.08,3)
Answer must be 3-30 characters in length.
"^DD",740,740,747.08,21,0)
^^1^1^2921217^^^^
"^DD",740,740,747.08,21,1,0)
Name of Coordinator for the Credentialing process.
"^DD",740,740,747.08,"DT")
2891030
"^DD",740,740,747.09,0)
COORD. TELE.^F^^RC;9^K:$L(X)>25!($L(X)<4) X
"^DD",740,740,747.09,3)
Answer must be 4-25 characters in length.
"^DD",740,740,747.09,21,0)
^^1^1^2921217^
"^DD",740,740,747.09,21,1,0)
This field contains the Coordinator's telephone number.
"^DD",740,740,747.09,"DT")
2891030
"^DD",740,740,747.1,0)
PERSONNEL CHIEF^F^^RC;10^K:$L(X)>30!($L(X)<3) X
"^DD",740,740,747.1,3)
Answer must be 3-30 characters in length.
"^DD",740,740,747.1,21,0)
^^1^1^2921217^
"^DD",740,740,747.1,21,1,0)
This field contains the name of the Personnel Chief for the Facility.
"^DD",740,740,747.1,"DT")
2891030
"^DD",740,740,747.11,0)
DIRECTOR NAME^F^^RC1;1^K:$L(X)>30!($L(X)<3) X
"^DD",740,740,747.11,3)
Answer must be 3-30 characters in length.
"^DD",740,740,747.11,21,0)
^^1^1^2921217^
"^DD",740,740,747.11,21,1,0)
This field contains the name of the Director for the Facility.
"^DD",740,740,747.11,"DT")
2891030
"^DD",740,740,747.12,0)
APPLICANT NAME^CJ30^^ ; ^S X=$S($D(SELAPP):SELAPP,1:"")
"^DD",740,740,747.12,9)
^
"^DD",740,740,747.12,9.01)

"^DD",740,740,747.12,9.1)
S X=$S($D(SELAPP):SELAPP,1:"")
"^DD",740,740,747.12,21,0)
^^1^1^2930105^
"^DD",740,740,747.12,21,1,0)
This field is a computed field and requires no input.
"^DD",740,740,747.12,21,2,0)
date.  The user will not have to input data to this field.
"^DD",740,740,747.13,0)
PERSONNEL ROUTING SYM^F^^RC1;2^K:$L(X)>9!($L(X)<2) X
"^DD",740,740,747.13,3)
Answer must be 2-9 characters in length.
"^DD",740,740,747.13,21,0)
^^1^1^2921217^
"^DD",740,740,747.13,21,1,0)
This field contains the mail routing symbol for the Personnel Service.
"^DD",740,740,747.13,"DT")
2891030
"^DD",740,740,747.14,0)
COORD. ROUTING SYM^F^^RC1;3^K:$L(X)>9!($L(X)<2) X
"^DD",740,740,747.14,3)
Answer must be 2-9 characters in length.
"^DD",740,740,747.14,21,0)
^^2^2^2921217^
"^DD",740,740,747.14,21,1,0)
This field contains the mail routing symbol for the Credentialing
"^DD",740,740,747.14,21,2,0)
Coordinator.
"^DD",740,740,747.14,"DT")
2891102
"^DD",740,740,747.15,0)
COORD. TITLE^F^^RC1;4^K:$L(X)>35!($L(X)<3) X
"^DD",740,740,747.15,3)
Answer must be 3-35 characters in length.
"^DD",740,740,747.15,21,0)
^^1^1^2921217^
"^DD",740,740,747.15,21,1,0)
This field contains the official title of the Credentialing Coordinator.
"^DD",740,740,747.15,"DT")
2900209
"^DD",740,740,747.16,0)
FSMB DOMAIN^FX^^RC1;5^S DIC=4.2,DIC(0)="EMNQ" D ^DIC S X=$P(Y,"^",2) K:Y'>0 X
"^DD",740,740,747.16,3)
Answer must be 1-12 characters in length.
"^DD",740,740,747.16,4)
S D="B",DIC="^DIC(4.2,",DIC(0)="AEMNQ" D DQ^DICQ
"^DD",740,740,747.16,21,0)
^^2^2^2910821^^^^
"^DD",740,740,747.16,21,1,0)
This field is used to input the server name and Domain if your region
"^DD",740,740,747.16,21,2,0)
decides to use the FSMB portion of this package.  ie S.QARFSMB@ISC-CHICAGO.
"^DD",740,740,747.16,"DT")
2910305
"^DD",740,740,747.2,0)
CHIEF OF STAFF^F^^RC1;6^K:$L(X)>30!($L(X)<3) X
"^DD",740,740,747.2,3)
Answer must be 3-30 characters in length.
"^DD",740,740,747.2,21,0)
^^1^1^2921015^^^
"^DD",740,740,747.2,21,1,0)
Name of Chief of Staff for this facility.
"^DD",740,740,747.2,"DT")
2910913
"^DD",740,740,747.21,0)
C.O.S TELE.#^F^^RC1;7^K:$L(X)>15!($L(X)<7) X
"^DD",740,740,747.21,3)
Please Use format (999)123-1234
"^DD",740,740,747.21,21,0)
^^1^1^2920731^
"^DD",740,740,747.21,21,1,0)
This field contains the telephone number of the Chief of Staff.
"^DD",740,740,747.21,"DT")
2910913
"^DD",740,740,747.23,0)
C.O.S. ROUTING SYM^F^^RC1;8^K:$L(X)>9!($L(X)<2) X
"^DD",740,740,747.23,3)
Answer must be 2-9 characters in length.
"^DD",740,740,747.23,21,0)
^^1^1^2921217^
"^DD",740,740,747.23,21,1,0)
This field contains the mail routing symbol for the Chief of Staff.
"^DD",740,740,747.23,"DT")
2910913
"^DD",740,740,747.99,0)
VERSION (QAR)^F^^VER;4^K:$L(X)>8!($L(X)<1)!'(X?1N.ANP) X
"^DD",740,740,747.99,3)
Enter the version of this package currently running, (1-8 characters).
"^DD",740,740,747.99,21,0)
^^1^1^2930208^
"^DD",740,740,747.99,21,1,0)
Indicates the version of the Credentials Tracking package.
"^DD",740,740,747.99,21,2,0)
installed with QAR.
"^DD",740,740,747.99,"DT")
2921022
"^DD",740,740,748.99,0)
VERSION (QAP)^F^^VER;3^K:$L(X)>8!($L(X)<1)!'(X?1N.ANP) X
"^DD",740,740,748.99,3)
Enter the version of this package currently running, (1-8 characters).
"^DD",740,740,748.99,21,0)
^^1^1^2930208^
"^DD",740,740,748.99,21,1,0)
Indicates the version of the Survey Generator package.
"^DD",740,740,748.99,"DT")
2921022
"^DD",740,740,749,0)
MULTI-DIVISIONAL PAT REP FACILITY^S^0:NO;1:YES;^QAC;3^Q
"^DD",740,740,749,3)
Enter Y(ES) if facility is multi-divisional for Pet. Rep.
"^DD",740,740,749,21,0)
^^3^3^2971122^
"^DD",740,740,749,21,1,0)
This field is set to YES if the facility has been integrated via
"^DD",740,740,749,21,2,0)
the DBIA process, and has one computer system and database for
"^DD",740,740,749,21,3,0)
more than one station.
"^DD",740,740,749,"DT")
2971122
"^DD",740,740,750,0)
PAT REP HOSPITAL DIVISION^740.03PA^^QAC2;0
"^DD",740,740,751,0)
MULTI-DIVISIONAL INCID REP FACILITY^S^1:YES;0:NO;^QAN;5^Q
"^DD",740,740,751,3)
Enter '1' if your site has integrated through NDBI.
"^DD",740,740,751,21,0)
^^2^2^2990722^^
"^DD",740,740,751,21,1,0)
This field holds a '1' or 'YES' if the station is an NDBI integrated 
"^DD",740,740,751,21,2,0)
Facility, with more than one Medical Center using one database.
"^DD",740,740,751,"DT")
2971209
"^DD",740,740,752,0)
IR HOSPITAL DIVISION^740.0752PA^^QAN2;0
"^DD",740,740,752,21,0)
^^3^3^2990727^
"^DD",740,740,752,21,1,0)
This field is a pointer to the INSTITUTION file (#4).  It is used by 
"^DD",740,740,752,21,2,0)
integrated sites to store the names of the Medical Centers in the
"^DD",740,740,752,21,3,0)
integrated group.
"^DD",740,740.01,0)
SCHEDULED ADMISSION CLINIC SUB-FIELD^^.01^1
"^DD",740,740.01,0,"DT")
2920331
"^DD",740,740.01,0,"IX","B",740.01,.01)

"^DD",740,740.01,0,"NM","SCHEDULED ADMISSION CLINIC")

"^DD",740,740.01,0,"UP")
740
"^DD",740,740.01,.01,0)
SCHEDULED ADMISSION CLINIC^M*P44'^SC(^0;1^S DIC("S")="I $P(^(0),""^"",3)=""C""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",740,740.01,.01,1,0)
^.1
"^DD",740,740.01,.01,1,1,0)
740.01^B
"^DD",740,740.01,.01,1,1,1)
S ^QA(740,DA(1),"OS1","B",$E(X,1,30),DA)=""
"^DD",740,740.01,.01,1,1,2)
K ^QA(740,DA(1),"OS1","B",$E(X,1,30),DA)
"^DD",740,740.01,.01,3)
Enter the clinic(s) used to schedule patient admissions.
"^DD",740,740.01,.01,12)
Only clinics are selectable.
"^DD",740,740.01,.01,12.1)
S DIC("S")="I $P(^(0),""^"",3)=""C"""
"^DD",740,740.01,.01,21,0)
^^3^3^2930208^^
"^DD",740,740.01,.01,21,1,0)
This field contains the clinic(s) that are used to schedule patient
"^DD",740,740.01,.01,21,2,0)
admissions.  The data entered in this field is used by the auto
"^DD",740,740.01,.01,21,3,0)
enroll to determine which admissions are scheduled.
"^DD",740,740.01,.01,"DT")
2921109
"^DD",740,740.02,0)
OS HOSPITAL DIVISION SUB-FIELD^^.02^2
"^DD",740,740.02,0,"DT")
2920924
"^DD",740,740.02,0,"ID",.02)
W "   ",$P(^(0),U,2)
"^DD",740,740.02,0,"IX","B",740.02,.01)

"^DD",740,740.02,0,"NM","OS HOSPITAL DIVISION")

"^DD",740,740.02,0,"UP")
740
"^DD",740,740.02,.01,0)
OS HOSPITAL DIVISION^MP40.8'X^DG(40.8,^0;1^S DINUM=X
"^DD",740,740.02,.01,1,0)
^.1
"^DD",740,740.02,.01,1,1,0)
740.02^B
"^DD",740,740.02,.01,1,1,1)
S ^QA(740,DA(1),"OS2","B",$E(X,1,30),DA)=""
"^DD",740,740.02,.01,1,1,2)
K ^QA(740,DA(1),"OS2","B",$E(X,1,30),DA)
"^DD",740,740.02,.01,3)
Enter a division at your facility.
"^DD",740,740.02,.01,21,0)
^^3^3^2971203^^^^
"^DD",740,740.02,.01,21,1,0)
 
"^DD",740,740.02,.01,21,2,0)
Enter a division at your facility.  This field is used to control the
"^DD",740,740.02,.01,21,3,0)
automatic reports generated by the auto enroll process.
"^DD",740,740.02,.01,"DT")
2971122
"^DD",740,740.02,.02,0)
DEVICE^RFXO^^0;2^D EN1^QAQAUTL K:Y<0 X
"^DD",740,740.02,.02,2)
S Y(0)=Y S Y=$P(Y,";")
"^DD",740,740.02,.02,2.1)
S Y=$P(Y,";")
"^DD",740,740.02,.02,3)
Enter the auto enroll device for this division.
"^DD",740,740.02,.02,4)
D EN3^QAQAUTL(740.02,.02)
"^DD",740,740.02,.02,21,0)
^^3^3^2920924^
"^DD",740,740.02,.02,21,1,0)
 
"^DD",740,740.02,.02,21,2,0)
This field contains the default printer device for this hospital division.
"^DD",740,740.02,.02,21,3,0)
All auto enroll output for this division will be sent to this device.
"^DD",740,740.02,.02,"DT")
2920924
"^DD",740,740.03,0)
PAT REP HOSPITAL DIVISION SUB-FIELD^^.01^1
"^DD",740,740.03,0,"DT")
2971122
"^DD",740,740.03,0,"IX","B",740.03,.01)

"^DD",740,740.03,0,"NM","PAT REP HOSPITAL DIVISION")

"^DD",740,740.03,0,"UP")
740
"^DD",740,740.03,.01,0)
PAT REP HOSPITAL DIVISION^MP4'^DIC(4,^0;1^Q
"^DD",740,740.03,.01,1,0)
^.1
"^DD",740,740.03,.01,1,1,0)
740.03^B
"^DD",740,740.03,.01,1,1,1)
S ^QA(740,DA(1),"QAC2","B",$E(X,1,30),DA)=""
"^DD",740,740.03,.01,1,1,2)
K ^QA(740,DA(1),"QAC2","B",$E(X,1,30),DA)
"^DD",740,740.03,.01,3)
Enter the name of the station(s) in your integration group.
"^DD",740,740.03,.01,21,0)
^^3^3^2971209^^^
"^DD",740,740.03,.01,21,1,0)
This field stores the names of the stations contained in an integration
"^DD",740,740.03,.01,21,2,0)
group.  The field is used for determining which station initiated a
"^DD",740,740.03,.01,21,3,0)
Report of Contact from within an integration group.
"^DD",740,740.03,.01,"DT")
2971122
"^DD",740,740.0752,0)
IR HOSPITAL DIVISION SUB-FIELD^^.01^1
"^DD",740,740.0752,0,"DT")
2971209
"^DD",740,740.0752,0,"IX","B",740.0752,.01)

"^DD",740,740.0752,0,"NM","IR HOSPITAL DIVISION")

"^DD",740,740.0752,0,"UP")
740
"^DD",740,740.0752,.01,0)
IR HOSPITAL DIVISION^MP4'^DIC(4,^0;1^Q
"^DD",740,740.0752,.01,1,0)
^.1
"^DD",740,740.0752,.01,1,1,0)
740.0752^B
"^DD",740,740.0752,.01,1,1,1)
S ^QA(740,DA(1),"QAN2","B",$E(X,1,30),DA)=""
"^DD",740,740.0752,.01,1,1,2)
K ^QA(740,DA(1),"QAN2","B",$E(X,1,30),DA)
"^DD",740,740.0752,.01,3)
Enter the name of the station(s) in your Integration Group.
"^DD",740,740.0752,.01,21,0)
^^3^3^2990727^
"^DD",740,740.0752,.01,21,1,0)
A multiple field holding a pointer to the INSTITUTION file (#4).
"^DD",740,740.0752,.01,21,2,0)
It is used by integrated sites for the member Hospitals in the
"^DD",740,740.0752,.01,21,3,0)
integrated group.
"^DD",740,740.0752,.01,"DT")
2971209
"^DD",742.4,742.4,.21,0)
INCIDENT TRANSMITTED TO DATABASE^S^1:TRANSMITTED;0:NOT TRANSMITTED;^0;18^Q
"^DD",742.4,742.4,.21,3)
Enter whether the Incident has been previously rolled up to the system.
"^DD",742.4,742.4,.21,21,0)
^^2^2^2921006^^^
"^DD",742.4,742.4,.21,21,1,0)
This field flags whether an incident has been 'rolled' up to the regional
"^DD",742.4,742.4,.21,21,2,0)
NQABD system.
"^DD",742.4,742.4,.21,"DT")
2980522
"^DD",742.4,742.4,52,0)
DIVISION^*P4'^DIC(4,^0;22^S DIC("S")="I $D(^QA(740,1,""QAN2"",""B"",Y))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",742.4,742.4,52,3)
Choice to be made from entries in site's QA Site Parameter file (#740).
"^DD",742.4,742.4,52,12)
Choice to be made from entries in site's QA Site parameter file (#740).
"^DD",742.4,742.4,52,12.1)
S DIC("S")="I $D(^QA(740,1,""QAN2"",""B"",Y))"
"^DD",742.4,742.4,52,"DT")
2971224
"^DIC",740,740,0)
QUALITY ASSURANCE SITE PARAMETERS^740P
"^DIC",740,740,0,"GL")
^QA(740,
"^DIC",740,740,"%D",0)
^^9^9^2980305^^^^
"^DIC",740,740,"%D",1,0)
Contains the site-specific parameters (such as site name) for each VAMC.
"^DIC",740,740,"%D",2,0)
This file serves the entire QM package.  Each component, such as
"^DIC",740,740,"%D",3,0)
Occurrence Screening, has one set of fields in the file.  This set of
"^DIC",740,740,"%D",4,0)
fields is both number and node spaced.  This file is pointed to by the
"^DIC",740,740,"%D",5,0)
Occurrence Screening file (#741).  This file is populated at the site.
"^DIC",740,740,"%D",6,0)
 PACKAGES USING SITE PARAMETER FILE:
"^DIC",740,740,"%D",7,0)
   Occurrence Screen 2.0
"^DIC",740,740,"%D",8,0)
   Credentials Tracking 1.0
"^DIC",740,740,"%D",9,0)
   Patient Representative 2.0
"^DIC",740,740,"%D",10,0)
   Incident Reporting
"^DIC",740,740,"%D",11,0)
   Survey Generator
"^DIC",740,"B","QUALITY ASSURANCE SITE PARAMETERS",740)

**END**
**END**
