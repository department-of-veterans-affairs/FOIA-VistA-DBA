Released DG*5.3*586 SEQ #501
Extracted from mail message
**KIDS**:DG*5.3*586^

**INSTALL NAME**
DG*5.3*586
"BLD",4801,0)
DG*5.3*586^REGISTRATION^0^3040218^y
"BLD",4801,4,0)
^9.64PA^^
"BLD",4801,"KRN",0)
^9.67PA^8989.52^19
"BLD",4801,"KRN",.4,0)
.4
"BLD",4801,"KRN",.401,0)
.401
"BLD",4801,"KRN",.402,0)
.402
"BLD",4801,"KRN",.403,0)
.403
"BLD",4801,"KRN",.5,0)
.5
"BLD",4801,"KRN",.84,0)
.84
"BLD",4801,"KRN",3.6,0)
3.6
"BLD",4801,"KRN",3.8,0)
3.8
"BLD",4801,"KRN",9.2,0)
9.2
"BLD",4801,"KRN",9.8,0)
9.8
"BLD",4801,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",4801,"KRN",9.8,"NM",1,0)
DGPREP0^^0^B25392656
"BLD",4801,"KRN",9.8,"NM","B","DGPREP0",1)
 
"BLD",4801,"KRN",19,0)
19
"BLD",4801,"KRN",19.1,0)
19.1
"BLD",4801,"KRN",101,0)
101
"BLD",4801,"KRN",409.61,0)
409.61
"BLD",4801,"KRN",771,0)
771
"BLD",4801,"KRN",870,0)
870
"BLD",4801,"KRN",8989.51,0)
8989.51
"BLD",4801,"KRN",8989.52,0)
8989.52
"BLD",4801,"KRN",8994,0)
8994
"BLD",4801,"KRN","B",.4,.4)
 
"BLD",4801,"KRN","B",.401,.401)
 
"BLD",4801,"KRN","B",.402,.402)
 
"BLD",4801,"KRN","B",.403,.403)
 
"BLD",4801,"KRN","B",.5,.5)
 
"BLD",4801,"KRN","B",.84,.84)
 
"BLD",4801,"KRN","B",3.6,3.6)
 
"BLD",4801,"KRN","B",3.8,3.8)
 
"BLD",4801,"KRN","B",9.2,9.2)
 
"BLD",4801,"KRN","B",9.8,9.8)
 
"BLD",4801,"KRN","B",19,19)
 
"BLD",4801,"KRN","B",19.1,19.1)
 
"BLD",4801,"KRN","B",101,101)
 
"BLD",4801,"KRN","B",409.61,409.61)
 
"BLD",4801,"KRN","B",771,771)
 
"BLD",4801,"KRN","B",870,870)
 
"BLD",4801,"KRN","B",8989.51,8989.51)
 
"BLD",4801,"KRN","B",8989.52,8989.52)
 
"BLD",4801,"KRN","B",8994,8994)
 
"BLD",4801,"QUES",0)
^9.62^^
"BLD",4801,"REQB",0)
^9.611^1^1
"BLD",4801,"REQB",1,0)
DG*5.3*546^1
"BLD",4801,"REQB","B","DG*5.3*546",1)
 
"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2941102^2941102
"PKG",5,22,1,"PAH",1,0)
586^3040218
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")
 
"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DGPREP0")
0^1^B25392656
"RTN","DGPREP0",1,0)
DGPREP0 ;Boise/WRL/ALB/SCK-Program to Display Pre-Registration List ; 2/18/04 4:56pm
"RTN","DGPREP0",2,0)
 ;;5.3;Registration;**109,546,586**;Aug 13, 1993
"RTN","DGPREP0",3,0)
 Q
"RTN","DGPREP0",4,0)
 ;
"RTN","DGPREP0",5,0)
EN ; -- main entry point
"RTN","DGPREP0",6,0)
 N VAUTD,X1
"RTN","DGPREP0",7,0)
 ;
"RTN","DGPREP0",8,0)
 I '$D(^XUSEC("DGPRE EDIT",DUZ))&('$D(^XUSEC("DGPRE SUPV",DUZ))) D  G ENQ
"RTN","DGPREP0",9,0)
 . W !!,"You do not have the DG PREREGISTRATION EDIT Key allocated, contact your Supervisor."
"RTN","DGPREP0",10,0)
 ;  *** Select Divisions
"RTN","DGPREP0",11,0)
 I $P($G(^DG(43,1,"GL")),U,2) D
"RTN","DGPREP0",12,0)
 . D DIVISION^VAUTOMA
"RTN","DGPREP0",13,0)
 E  D
"RTN","DGPREP0",14,0)
 . S DGSNGLDV=1
"RTN","DGPREP0",15,0)
 . S VAUTD=1
"RTN","DGPREP0",16,0)
 ;
"RTN","DGPREP0",17,0)
 D EN^VALM("DGPRE RG")
"RTN","DGPREP0",18,0)
ENQ Q
"RTN","DGPREP0",19,0)
 ;
"RTN","DGPREP0",20,0)
HDR ; -- header code
"RTN","DGPREP0",21,0)
 ; Variables
"RTN","DGPREP0",22,0)
 ;   DGPSRT  - Sort Method for call list display
"RTN","DGPREP0",23,0)
 ;
"RTN","DGPREP0",24,0)
 N DGPSRT
"RTN","DGPREP0",25,0)
 I $D(VAUTD) S VALMHDR(1)="Call List sorted by Division and then "
"RTN","DGPREP0",26,0)
 S DGPSRT=$P($G(^DG(43,1,"DGPRE")),U)
"RTN","DGPREP0",27,0)
 S VALMHDR(1)=$G(VALMHDR(1))_"Sorted by "_$S(DGPSRT="P":"Patient Name",DGPSRT="S":"Medical Service")_"."
"RTN","DGPREP0",28,0)
 I $G(VAUTD) S VALMHDR(2)="All Divisions selected."
"RTN","DGPREP0",29,0)
 Q
"RTN","DGPREP0",30,0)
 ;
"RTN","DGPREP0",31,0)
INIT ; -- Retrieve data from call list and build TMP global for sorting Call lsit
"RTN","DGPREP0",32,0)
 ;  Variables
"RTN","DGPREP0",33,0)
 ;    DGPNR    - 
"RTN","DGPREP0",34,0)
 ;    DGPDATA  - 0 Node from ^DGS(41.42,X
"RTN","DGPREP0",35,0)
 ;    DGPDATA1 - 1 Node from ^DGS(41.42,X
"RTN","DGPREP0",36,0)
 ;    DGPDIV   - Division IEN from ^DGS(41.42,
"RTN","DGPREP0",37,0)
 ;    DGPDVN   - Division Name
"RTN","DGPREP0",38,0)
 ;    DGPSV    - Medical Service for appointment clinic
"RTN","DGPREP0",39,0)
 ;    DGPAT    - Appt. date/time
"RTN","DGPREP0",40,0)
 ;    DGPPN    - Patients name
"RTN","DGPREP0",41,0)
 ;    DGPNR    - Index No. for LM
"RTN","DGPREP0",42,0)
 ;    DGPSRT   - Call list sort method
"RTN","DGPREP0",43,0)
 ;    DGPN0,DGPN1,DGPNX - Local Var's for $O
"RTN","DGPREP0",44,0)
 ;
"RTN","DGPREP0",45,0)
 N DGQ,DGPDATA,DGPDATA1,DGPDIV,DGPDVN,DGPNX,DGPN1,DGPN2
"RTN","DGPREP0",46,0)
 ;
"RTN","DGPREP0",47,0)
 K ^TMP("DGPRERG",$J)
"RTN","DGPREP0",48,0)
 K ^TMP($J)
"RTN","DGPREP0",49,0)
 S DGPSRT=$P($G(^DG(43,1,"DGPRE")),U)
"RTN","DGPREP0",50,0)
 I $P($G(^DGS(41.42,0)),U,4)>1 W !!,"Sorting Entries..."
"RTN","DGPREP0",51,0)
 ;
"RTN","DGPREP0",52,0)
 S DGPN1=0 F  S DGPN1=$O(^DGS(41.42,DGPN1)) Q:'DGPN1  D
"RTN","DGPREP0",53,0)
 . S DGPDATA=$G(^DGS(41.42,DGPN1,0)),DGPDATA1=$G(^DGS(41.42,DGPN1,1))
"RTN","DGPREP0",54,0)
 . Q:DGPDATA']""!(DGPDATA1']"")
"RTN","DGPREP0",55,0)
 . ; ****  Division handling
"RTN","DGPREP0",56,0)
 . S DGPDIV=$P(DGPDATA,U,2)
"RTN","DGPREP0",57,0)
 . I +DGPDIV'>0 D
"RTN","DGPREP0",58,0)
 .. I $G(DGSNGLDV) S DGPDIV=$S($D(^DG(40.8,1)):1,1:0) Q
"RTN","DGPREP0",59,0)
 .. S DGPDIV=-1
"RTN","DGPREP0",60,0)
 . K DGQ
"RTN","DGPREP0",61,0)
 . I '$G(DGSNGLDV) D  Q:$G(DGQ)
"RTN","DGPREP0",62,0)
 .. I '$G(VAUTD),'$D(VAUTD(DGPDIV)) S DGQ=1
"RTN","DGPREP0",63,0)
 . ;
"RTN","DGPREP0",64,0)
 . S DGPSV=$P(DGPDATA1,U)
"RTN","DGPREP0",65,0)
 . S DGPAT=$P(DGPDATA,U,8)
"RTN","DGPREP0",66,0)
 . S DGPPN=$P(^DPT($P(^DGS(41.42,DGPN1,0),U),0),U)
"RTN","DGPREP0",67,0)
 . ;
"RTN","DGPREP0",68,0)
 . I DGPSRT="S" D
"RTN","DGPREP0",69,0)
 .. I DGPSV']"" W !,"NO SERVICE ENTRY FOR RECORD# ",DGPN1 Q
"RTN","DGPREP0",70,0)
 .. S ^TMP($J,DGPDIV,DGPSV,DGPN1)=$P(^DGS(41.42,DGPN1,0),U)
"RTN","DGPREP0",71,0)
 . ;
"RTN","DGPREP0",72,0)
 . I DGPSRT="P" D
"RTN","DGPREP0",73,0)
 .. I DGPPN']"" W !,"NO PATIENT ENTRY FOR RECORD# ",DGPN1 Q
"RTN","DGPREP0",74,0)
 .. S ^TMP($J,DGPDIV,DGPPN,DGPN1)=$P($G(^DGS(41.42,DGPN1,0)),U)
"RTN","DGPREP0",75,0)
 . ;
"RTN","DGPREP0",76,0)
 . I DGPSRT']"" D
"RTN","DGPREP0",77,0)
 .. I DGPPN']"" W !,"NO PATIENT ENTRY FOR RECORD# ",DGPN1 Q
"RTN","DGPREP0",78,0)
 .. S ^TMP($J,DGPDIV,DGPPN,DGPN1)=$P(^DGS(41.42,DGPN1,0),U)
"RTN","DGPREP0",79,0)
 . W "."
"RTN","DGPREP0",80,0)
 ;
"RTN","DGPREP0",81,0)
 I $D(^TMP($J)) W !!,"Loading Sorted Entries into List..."
"RTN","DGPREP0",82,0)
 E  D
"RTN","DGPREP0",83,0)
 . W *7,!!,"No appointments were found for the selected divisions"
"RTN","DGPREP0",84,0)
 . K DIR S DIR(0)="E" D ^DIR K DIR
"RTN","DGPREP0",85,0)
 ;
"RTN","DGPREP0",86,0)
 ; Retreive sorted call list form ^TMP and build LM arrays
"RTN","DGPREP0",87,0)
 ;
"RTN","DGPREP0",88,0)
 S DGPNR=1
"RTN","DGPREP0",89,0)
 S DGPN0="" F  S DGPN0=$O(^TMP($J,DGPN0)) Q:DGPN0=""  D
"RTN","DGPREP0",90,0)
 . S DGPN1="" F  S DGPN1=$O(^TMP($J,DGPN0,DGPN1)) Q:DGPN1=""  D
"RTN","DGPREP0",91,0)
 .. S DGPNX="" F  S DGPNX=$O(^TMP($J,DGPN0,DGPN1,DGPNX)) Q:DGPNX=""  D
"RTN","DGPREP0",92,0)
 ... S DGPDATA=$G(^DGS(41.42,DGPNX,0))
"RTN","DGPREP0",93,0)
 ... S DGPDATA1=$G(^DGS(41.42,DGPNX,1))
"RTN","DGPREP0",94,0)
 ... S DGPSV=$P(DGPDATA1,U)
"RTN","DGPREP0",95,0)
 ... S X=$$SETFLD^VALM1(DGPNR,"","INDEX")
"RTN","DGPREP0",96,0)
 ... S X=$$SETFLD^VALM1($E($P(^DPT($P(DGPDATA,U),0),U),1,30),X,"PATIENT")
"RTN","DGPREP0",97,0)
 ... S DGPDFN=$P(DGPDATA,U)
"RTN","DGPREP0",98,0)
 ... D BLDHIST
"RTN","DGPREP0",99,0)
 ... S X=$$SETFLD^VALM1($P(DGPDATA1,U,2),X,"SSN")
"RTN","DGPREP0",100,0)
 ... S X=$$SETFLD^VALM1(DGPSV,X,"SVC")
"RTN","DGPREP0",101,0)
 ... S X=$$SETFLD^VALM1($E($P(DGPDATA1,U,3),1,18),X,"PHONE")
"RTN","DGPREP0",102,0)
 ... S X=$$SETFLD^VALM1($$FMTE^XLFDT($P(DGPDATA,U,5),"2D"),X,"LAST")
"RTN","DGPREP0",103,0)
 ... I $P(DGPDATA,U,6)="Y" D
"RTN","DGPREP0",104,0)
 .... ;S X=$$SETFLD^VALM1("*",X,"CALL")
"RTN","DGPREP0",105,0)
 ... S DGPDVN=$S(+$G(DGPN0)>0:$P(^DG(40.8,DGPN0,0),U),DGPN0<0:"",1:DGPN0)
"RTN","DGPREP0",106,0)
 ... S X=$$SETFLD^VALM1($E(DGPDVN,1,20),X,"DIVISION")
"RTN","DGPREP0",107,0)
 ... S ^TMP("DGPRERG",$J,DGPNR,0)=X
"RTN","DGPREP0",108,0)
 ... S ^TMP("DGPRERG",$J,"DA",DGPNR,DGPN1)=""
"RTN","DGPREP0",109,0)
 ... S ^TMP("DGPRERG",$J,"DFN",DGPNR,DGPDFN)=""
"RTN","DGPREP0",110,0)
 ... S ^TMP("DGPRERG",$J,"SSN",DGPNR,$P(DGPDATA1,U,2))=""
"RTN","DGPREP0",111,0)
 ... S ^TMP("DGPRERG",$J,"IDX",DGPNR,DGPNR)=""
"RTN","DGPREP0",112,0)
 ... S ^TMP("DGPRERG",$J,"DIV",DGPNR,DGPN0)=""
"RTN","DGPREP0",113,0)
 ... S DGPNR=DGPNR+1
"RTN","DGPREP0",114,0)
 ... W "."
"RTN","DGPREP0",115,0)
 S VALMCNT=DGPNR-1
"RTN","DGPREP0",116,0)
 I VALMCNT'>0 S VALMQUIT=1
"RTN","DGPREP0",117,0)
 Q
"RTN","DGPREP0",118,0)
 ;
"RTN","DGPREP0",119,0)
HELP ; -- help code
"RTN","DGPREP0",120,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","DGPREP0",121,0)
 Q
"RTN","DGPREP0",122,0)
 ;
"RTN","DGPREP0",123,0)
EXIT ; -- Exit code
"RTN","DGPREP0",124,0)
 K ^TMP("DGPRERG",$J)
"RTN","DGPREP0",125,0)
 K DGPAT,DGPCH,DGPCL,DGPDA,DGPDATA,DGPDATA1,DGPDFN,DGPEDIT,DGPENT,DGPFLG,DGPIFN
"RTN","DGPREP0",126,0)
 K DGPLOC,DGPN0,DGPN1,DGPN2,DGPN3,DGPNR,DGPP1,DGPP2,DGPP3,DGPPN
"RTN","DGPREP0",127,0)
 K DGPPSRT,DGPST,DGPSV,DGPTAT,DA,X,Y,DIR,DIC,DIE
"RTN","DGPREP0",128,0)
 D FULL^VALM1
"RTN","DGPREP0",129,0)
 D CLEAN^VALM10
"RTN","DGPREP0",130,0)
 Q
"RTN","DGPREP0",131,0)
 ;
"RTN","DGPREP0",132,0)
BLDHIST ;  Build history of call attempts from ^DGS(41.43, Call log
"RTN","DGPREP0",133,0)
 N DGPN2,DGPN3
"RTN","DGPREP0",134,0)
 ;
"RTN","DGPREP0",135,0)
 S DGPN2=0 F  S DGPN2=$O(^DGS(41.43,"C",DGPDFN,DGPN2)) Q:'DGPN2  D
"RTN","DGPREP0",136,0)
 . S:$P(^DGS(41.43,DGPN2,0),U,4)]"" ^TMP("STAT",$J,$P(^DGS(41.43,DGPN2,0),U,1))=$P(^DGS(41.43,DGPN2,0),U,4)
"RTN","DGPREP0",137,0)
 I $D(^TMP("STAT",$J)) D
"RTN","DGPREP0",138,0)
 . S DGPTAT=""
"RTN","DGPREP0",139,0)
 . S DGPN3=9999999.999999 F  S DGPN3=$O(^TMP("STAT",$J,DGPN3),-1) Q:'DGPN3  D
"RTN","DGPREP0",140,0)
 .. S DGPTAT=DGPTAT_^TMP("STAT",$J,DGPN3)
"RTN","DGPREP0",141,0)
 . S X=$$SETFLD^VALM1(DGPTAT,X,"HIST")
"RTN","DGPREP0",142,0)
 . K ^TMP("STAT",$J)
"RTN","DGPREP0",143,0)
 Q
"VER")
8.0^22.0
**END**
**END**
