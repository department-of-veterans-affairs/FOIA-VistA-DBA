Released PRCA*4.5*209 SEQ #179
Extracted from mail message
**KIDS**:PRCA*4.5*209^

**INSTALL NAME**
PRCA*4.5*209
"BLD",5134,0)
PRCA*4.5*209^ACCOUNTS RECEIVABLE^0^3031029^y
"BLD",5134,1,0)
^^1^1^3031020^
"BLD",5134,1,1,0)
MY HEALTH-E-VET ENHANCEMENT
"BLD",5134,4,0)
^9.64PA^^
"BLD",5134,"KRN",0)
^9.67PA^8989.52^19
"BLD",5134,"KRN",.4,0)
.4
"BLD",5134,"KRN",.401,0)
.401
"BLD",5134,"KRN",.402,0)
.402
"BLD",5134,"KRN",.403,0)
.403
"BLD",5134,"KRN",.5,0)
.5
"BLD",5134,"KRN",.84,0)
.84
"BLD",5134,"KRN",3.6,0)
3.6
"BLD",5134,"KRN",3.8,0)
3.8
"BLD",5134,"KRN",9.2,0)
9.2
"BLD",5134,"KRN",9.8,0)
9.8
"BLD",5134,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5134,"KRN",9.8,"NM",1,0)
PRCAHV^^0^B50008403
"BLD",5134,"KRN",9.8,"NM","B","PRCAHV",1)

"BLD",5134,"KRN",19,0)
19
"BLD",5134,"KRN",19.1,0)
19.1
"BLD",5134,"KRN",101,0)
101
"BLD",5134,"KRN",409.61,0)
409.61
"BLD",5134,"KRN",771,0)
771
"BLD",5134,"KRN",870,0)
870
"BLD",5134,"KRN",8989.51,0)
8989.51
"BLD",5134,"KRN",8989.52,0)
8989.52
"BLD",5134,"KRN",8994,0)
8994
"BLD",5134,"KRN","B",.4,.4)

"BLD",5134,"KRN","B",.401,.401)

"BLD",5134,"KRN","B",.402,.402)

"BLD",5134,"KRN","B",.403,.403)

"BLD",5134,"KRN","B",.5,.5)

"BLD",5134,"KRN","B",.84,.84)

"BLD",5134,"KRN","B",3.6,3.6)

"BLD",5134,"KRN","B",3.8,3.8)

"BLD",5134,"KRN","B",9.2,9.2)

"BLD",5134,"KRN","B",9.8,9.8)

"BLD",5134,"KRN","B",19,19)

"BLD",5134,"KRN","B",19.1,19.1)

"BLD",5134,"KRN","B",101,101)

"BLD",5134,"KRN","B",409.61,409.61)

"BLD",5134,"KRN","B",771,771)

"BLD",5134,"KRN","B",870,870)

"BLD",5134,"KRN","B",8989.51,8989.51)

"BLD",5134,"KRN","B",8989.52,8989.52)

"BLD",5134,"KRN","B",8994,8994)

"BLD",5134,"QUES",0)
^9.62^^
"BLD",5134,"REQB",0)
^9.611^1^1
"BLD",5134,"REQB",1,0)
PRCA*4.5*183^2
"BLD",5134,"REQB","B","PRCA*4.5*183",1)

"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^1^1
"PKG",142,20,1,0)
2^^PRCAMRG
"PKG",142,20,1,1)

"PKG",142,20,"B",2,1)

"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
209^3031029
"PKG",142,22,1,"PAH",1,1,0)
^^1^1^3031029
"PKG",142,22,1,"PAH",1,1,1,0)
MY HEALTH-E-VET ENHANCEMENT
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PRCAHV")
0^1^B50008403
"RTN","PRCAHV",1,0)
PRCAHV ;LL/ELZ-API for My HealtheVet ;06/17/02
"RTN","PRCAHV",2,0)
 ;;4.5;Accounts Receivable;**183,209**;Mar 20, 1995
"RTN","PRCAHV",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCAHV",4,0)
 ;Based on ALSIBAL, LL/ELZ, Version 3.0, 10/30/01 (Ed Zeigler)
"RTN","PRCAHV",5,0)
 ;
"RTN","PRCAHV",6,0)
 ;
"RTN","PRCAHV",7,0)
 ;Balance calculation (External entry point)
"RTN","PRCAHV",8,0)
 ;Input:
"RTN","PRCAHV",9,0)
 ;  PRCAICN - Patient's ICN (required)
"RTN","PRCAHV",10,0)
 ;  PRCATY - Account Receivable Transaction Types, possible values (case insensitive):
"RTN","PRCAHV",11,0)
 ;    "OPEN" (default) the same as "113,112,102,107" - open/active Trans. Types
"RTN","PRCAHV",12,0)
 ;    "ALL", all Transaction Types
"RTN","PRCAHV",13,0)
 ;    <list of Trans.Type numbers, comma delimited>
"RTN","PRCAHV",14,0)
 ;Output:
"RTN","PRCAHV",15,0)
 ;  1-success, 0-no data, '-1'-error, '-2'-patient doesn't exist, '-3'-program error
"RTN","PRCAHV",16,0)
 ;  RESULT (by reference)=<balance value> or zero if error/no data
"RTN","PRCAHV",17,0)
BALANCE(RESULT,PRCAICN,PRCATY) N DFN,RCST
"RTN","PRCAHV",18,0)
 S RESULT=0 ;Initial value
"RTN","PRCAHV",19,0)
 I $G(PRCAICN)="" S RCST=-1 G BALQ ;Bad parameter
"RTN","PRCAHV",20,0)
 S DFN=$$DFN($G(PRCAICN)) I 'DFN S RCST=-2 G BALQ ;No such patient
"RTN","PRCAHV",21,0)
 S RCST=$$INTBAL(.RESULT,DFN,.PRCATY)
"RTN","PRCAHV",22,0)
BALQ Q RCST
"RTN","PRCAHV",23,0)
 ;
"RTN","PRCAHV",24,0)
 ;
"RTN","PRCAHV",25,0)
 ;This function will look up a patient's detail to their copay balance
"RTN","PRCAHV",26,0)
 ;Input:
"RTN","PRCAHV",27,0)
 ;  PRCAICN - Patient's ICN
"RTN","PRCAHV",28,0)
 ;  PRCATY - Account Receivable Transaction Types, possible values (case insensitive):
"RTN","PRCAHV",29,0)
 ;    "OPEN" (default) the same as "113,112,102,107" - open/active Trans. Types
"RTN","PRCAHV",30,0)
 ;    "ALL", all Transaction Types,
"RTN","PRCAHV",31,0)
 ;    <list of Trans.Type numbers, comma delimited>
"RTN","PRCAHV",32,0)
 ;Output: 1-success, 0-no data, '-1'-error, '-2'-patient doesn't exist, '-3'-program error
"RTN","PRCAHV",33,0)
 ;        RESULT(1..n)=<Bill No>^<Date Bill Prepared(FM)>^<Description>^<Balance>^<Status Number>
"RTN","PRCAHV",34,0)
 ;        RESULT may be undefined if error or no data
"RTN","PRCAHV",35,0)
DETAIL(RESULT,PRCAICN,PRCATY) N DFN,RCST
"RTN","PRCAHV",36,0)
 K RESULT ;Initial value
"RTN","PRCAHV",37,0)
 I $G(PRCAICN)="" S RCST=-1 G DETQ ;Bad parameter
"RTN","PRCAHV",38,0)
 S DFN=$$DFN($G(PRCAICN)) I 'DFN S RCST=-2 G DETQ ;No such patient
"RTN","PRCAHV",39,0)
 S RCST=$$INTDTL(.RESULT,DFN,.PRCATY)
"RTN","PRCAHV",40,0)
DETQ Q RCST
"RTN","PRCAHV",41,0)
 ;
"RTN","PRCAHV",42,0)
 ;
"RTN","PRCAHV",43,0)
 ;This function will look up for transaction details for the given bill
"RTN","PRCAHV",44,0)
 ;Input:
"RTN","PRCAHV",45,0)
 ;  PRCABILL - Bill name (External number)
"RTN","PRCAHV",46,0)
 ;Output:
"RTN","PRCAHV",47,0)
 ; 1-success, 0-no data, '-1'-no parameter, '-2'-the bill doesn't exist, '-3'-program error
"RTN","PRCAHV",48,0)
 ; RESULT(i)=<Trans.No>^<Date(FM)>^<Trans.Type>^<reserved>^<Trans. amount>^<Descr1>^<Descr2>^<Descr3>^<Descr4>^<Descr5>
"RTN","PRCAHV",49,0)
 ; RESULT may be undefined if error or no data
"RTN","PRCAHV",50,0)
 ; RESULT(1..n) may not be longer that 255 char - the Description may be truncated.
"RTN","PRCAHV",51,0)
TRANS(RESULT,PRCABILL) N PRCAIEN,RCST
"RTN","PRCAHV",52,0)
 K RESULT ;Initial value
"RTN","PRCAHV",53,0)
 I $G(PRCABILL)="" S RCST=-1 G TRANSQ ;Bad parameter
"RTN","PRCAHV",54,0)
 S PRCAIEN=$$BILIEN($G(PRCABILL)) I 'PRCAIEN S RCST=-2 G TRANSQ ;No such bill
"RTN","PRCAHV",55,0)
 S RCST=$$INTTRANS(.RESULT,PRCAIEN)
"RTN","PRCAHV",56,0)
TRANSQ Q RCST
"RTN","PRCAHV",57,0)
 ;
"RTN","PRCAHV",58,0)
 ;Conversions
"RTN","PRCAHV",59,0)
 ;~~~~~~~~~~~
"RTN","PRCAHV",60,0)
 ;Input: Paient's ICN
"RTN","PRCAHV",61,0)
 ;Output: Patient's IEN (or 0 in not found)
"RTN","PRCAHV",62,0)
DFN(PRCAICN) ;Receive patient's IEN by ICN
"RTN","PRCAHV",63,0)
 N DFN
"RTN","PRCAHV",64,0)
 I $G(PRCAICN)="" Q 0  ;No parameter
"RTN","PRCAHV",65,0)
 S DFN=$O(^DPT("AICN",PRCAICN,0)) I 'DFN Q 0  ;Not found in x-ref
"RTN","PRCAHV",66,0)
 I '$D(^DPT(DFN)) Q 0  ;Invalid cross-reference
"RTN","PRCAHV",67,0)
 Q DFN
"RTN","PRCAHV",68,0)
 ;
"RTN","PRCAHV",69,0)
 ;Input: bill name ('external' number)
"RTN","PRCAHV",70,0)
 ;Output: bill IEN (internal record number) or 0 if not found
"RTN","PRCAHV",71,0)
BILIEN(PRCABN) ;Receive bill's IEN by name
"RTN","PRCAHV",72,0)
 N PRCAIEN
"RTN","PRCAHV",73,0)
 I $G(PRCABN)="" Q 0  ;No parameter
"RTN","PRCAHV",74,0)
 S PRCAIEN=$O(^PRCA(430,"B",PRCABN,0)) I 'PRCAIEN Q 0  ;Not found in x-ref
"RTN","PRCAHV",75,0)
 I '$D(^PRCA(430,PRCAIEN)) Q 0  ;Invalid cross-reference 
"RTN","PRCAHV",76,0)
 Q PRCAIEN
"RTN","PRCAHV",77,0)
 ;
"RTN","PRCAHV",78,0)
 ;
"RTN","PRCAHV",79,0)
 ;Internal functions
"RTN","PRCAHV",80,0)
 ;~~~~~~~~~~~~~~~~~~
"RTN","PRCAHV",81,0)
 ; These functions accept internal codes (IEN),
"RTN","PRCAHV",82,0)
 ; return success code, 
"RTN","PRCAHV",83,0)
 ; return requested data in parameter by reference (no data murging)
"RTN","PRCAHV",84,0)
 ;
"RTN","PRCAHV",85,0)
 ;
"RTN","PRCAHV",86,0)
 ;Balance calculation (internal entry point)
"RTN","PRCAHV",87,0)
 ;Input: DFN - Patient's IEN
"RTN","PRCAHV",88,0)
 ;  PRCATY - Account Receivable Transaction Types, possible values:
"RTN","PRCAHV",89,0)
 ;    "OPEN" (default) the same as "113,112,102,107" - open/active Trans. Types 
"RTN","PRCAHV",90,0)
 ;    "ALL", all Transaction Types
"RTN","PRCAHV",91,0)
 ;    <list of Trans.Type numbers, comma delimited>
"RTN","PRCAHV",92,0)
 ;Output: 1-success, 0-no data, '-1'-error '-2'-patient doesn't exist
"RTN","PRCAHV",93,0)
 ;        RESULT=<balance value> or zero if error/no data
"RTN","PRCAHV",94,0)
INTBAL(RESULT,DFN,PRCATY) ; this will look up a patient's copay balance
"RTN","PRCAHV",95,0)
 N X,Y,C,PRCADB,DEBT,TRAN,BILL,BAT
"RTN","PRCAHV",96,0)
 S RESULT=0
"RTN","PRCAHV",97,0)
 S X="ERROR^PRCAHV",@^%ZOSF("TRAP")
"RTN","PRCAHV",98,0)
 S:'$D(U) U="^"
"RTN","PRCAHV",99,0)
 ;
"RTN","PRCAHV",100,0)
 I '$G(DFN) Q -1 ;No/bad parameter
"RTN","PRCAHV",101,0)
 I '$D(^DPT(DFN)) Q -2 ;The patient does not exist
"RTN","PRCAHV",102,0)
 S PRCADB=DFN_";DPT(",DEBT=$O(^RCD(340,"B",PRCADB,0)) I 'DEBT Q 0 ;No such debtor
"RTN","PRCAHV",103,0)
 D ADJTYPE(.PRCATY) ; Adjust type (or set default)
"RTN","PRCAHV",104,0)
 ;Standard call. Parameters: PRCATY - types list, DEBT - debtor
"RTN","PRCAHV",105,0)
 K ^TMP("PRCAAPR",$J)
"RTN","PRCAHV",106,0)
 D COMP^PRCAAPR S RESULT=+$G(^TMP("PRCAAPR",$J,"C"))
"RTN","PRCAHV",107,0)
 K ^TMP("PRCAAPR",$J)
"RTN","PRCAHV",108,0)
 Q 1
"RTN","PRCAHV",109,0)
 ;
"RTN","PRCAHV",110,0)
 ;Function: Details of patient's balance
"RTN","PRCAHV",111,0)
 ;Input: DFN - Patient's IEN
"RTN","PRCAHV",112,0)
 ;  PRCATY - Account Receivable Transaction Types, possible values:
"RTN","PRCAHV",113,0)
 ;    "OPEN" (default) the same as "113,112,102,107" - open/active Trans. Types 
"RTN","PRCAHV",114,0)
 ;    "ALL", all Transaction Types
"RTN","PRCAHV",115,0)
 ;    <list of Trans.Type numbers, comma delimited>
"RTN","PRCAHV",116,0)
 ;Output: 1-success, 0-no data, '-1'-error '-2'-patient doesn't exist
"RTN","PRCAHV",117,0)
 ;        RESULT(1..n)=<Bill No>^<Date Bill Prepared(FM)>^<Description>^<Balance>^<Status Number>
"RTN","PRCAHV",118,0)
 ;        RESULT may be undefined if error or no data
"RTN","PRCAHV",119,0)
INTDTL(RESULT,DFN,PRCATY) ;
"RTN","PRCAHV",120,0)
 N X,Y,C,PRCADB,DEBT,TRAN,BILL,BAT,RCS,RCX,RCC,RCZ,RCY,RCB,RCDT,RCP
"RTN","PRCAHV",121,0)
 K RESULT
"RTN","PRCAHV",122,0)
 S X="ERROR^PRCAHV",@^%ZOSF("TRAP")
"RTN","PRCAHV",123,0)
 S:'$D(U) U="^"
"RTN","PRCAHV",124,0)
 ;
"RTN","PRCAHV",125,0)
 I '$G(DFN) Q -1  ;No/bad parameter
"RTN","PRCAHV",126,0)
 I '$D(^DPT(DFN)) Q -2  ;No such patient
"RTN","PRCAHV",127,0)
 S PRCADB=DFN_";DPT(",DEBT=$O(^RCD(340,"B",PRCADB,0)) I 'DEBT Q 0  ;No information for the patient
"RTN","PRCAHV",128,0)
 ;
"RTN","PRCAHV",129,0)
 D ADJTYPE(.PRCATY) ; Adjust type (or set default)
"RTN","PRCAHV",130,0)
 ;Standard call. Parameters: PRCATY - types list, DEBT - debtor
"RTN","PRCAHV",131,0)
 K ^TMP("PRCAAPR",$J),^TMP("PRCAHV",$J)
"RTN","PRCAHV",132,0)
 D COMP^PRCAAPR
"RTN","PRCAHV",133,0)
 ;
"RTN","PRCAHV",134,0)
 ; Sort the bills by date, ignore 3rd party bills
"RTN","PRCAHV",135,0)
 S (RCC,RCS)=0 F  S RCS=$O(^TMP("PRCAAPR",$J,"C",RCS)) Q:RCS<1  D
"RTN","PRCAHV",136,0)
 . S RCX=0 F  S RCX=$O(^TMP("PRCAAPR",$J,"C",RCS,RCX))  Q:RCX<1  D
"RTN","PRCAHV",137,0)
 .. ; No support for unprocessed payments
"RTN","PRCAHV",138,0)
 .. I RCS=99 Q  ;S RCC=RCC+1,RESULT(RCC)="^^UNPROCESSED PAYMENT^"_$G(^TMP("PRCAAPR",$J,"C",RCS,RCX)) Q
"RTN","PRCAHV",139,0)
 .. S RCY=$G(^PRCA(430,RCX,0))  Q:RCY=""
"RTN","PRCAHV",140,0)
 .. S PRCADB=$P(RCY,"^",9) ; bill debtor
"RTN","PRCAHV",141,0)
 .. I $P($G(^RCD(340,PRCADB,0)),U)'[";DPT(" Q  ;not a 1st party bill
"RTN","PRCAHV",142,0)
 .. S RCDT=+$P(RCY,"^",10)
"RTN","PRCAHV",143,0)
 .. S ^TMP("PRCAHV",$J,RCDT,RCS,RCX)=$G(^TMP("PRCAAPR",$J,"C",RCS,RCX))
"RTN","PRCAHV",144,0)
 K ^TMP("PRCAAPR",$J)
"RTN","PRCAHV",145,0)
 ;
"RTN","PRCAHV",146,0)
 S (RCC,RCDT)=0 F  S RCDT=$O(^TMP("PRCAHV",$J,RCDT)) Q:'RCDT  D
"RTN","PRCAHV",147,0)
 . S RCS=0 F  S RCS=$O(^TMP("PRCAHV",$J,RCDT,RCS))  Q:'RCS  D
"RTN","PRCAHV",148,0)
 .. S RCX=0 F  S RCX=$O(^TMP("PRCAHV",$J,RCDT,RCS,RCX))  Q:'RCX  D
"RTN","PRCAHV",149,0)
 ... N RCDESC
"RTN","PRCAHV",150,0)
 ... D BILLDESC^RCCPCPS1(RCX)
"RTN","PRCAHV",151,0)
 ... S RCB=0,RCZ=$G(^TMP("PRCAHV",$J,RCDT,RCS,RCX))
"RTN","PRCAHV",152,0)
 ... F RCP=1:1:5 S RCB=RCB+$P(RCZ,U,RCP)
"RTN","PRCAHV",153,0)
 ... S RCY=^PRCA(430,RCX,0)
"RTN","PRCAHV",154,0)
 ... S RCC=RCC+1,RESULT(RCC)=$P(RCY,U)_U_$P(RCY,U,10)_U_RCDESC(1)_U_RCB_U_RCS
"RTN","PRCAHV",155,0)
 ;
"RTN","PRCAHV",156,0)
 K ^TMP("PRCAHV",$J)
"RTN","PRCAHV",157,0)
 Q 1 ;Success, data not guaranteed
"RTN","PRCAHV",158,0)
 ;
"RTN","PRCAHV",159,0)
 ;Function: Transaction details
"RTN","PRCAHV",160,0)
 ;Input: RCBILL - Bill IEN
"RTN","PRCAHV",161,0)
 ;Output: 1-success, 0-no data, '-1'-no parameter '-2'-the bill doesn't exist, '-3'-program error
"RTN","PRCAHV",162,0)
 ; RESULT(i)=<Trans.No>^<Date(FM)>^<Trans.Type>^<reserved>^<Trans. amount>^<Descr1>^<Descr2>^<Descr3>^<Descr4>^<Descr5>
"RTN","PRCAHV",163,0)
 ; RESULT may be undefined if error or no data
"RTN","PRCAHV",164,0)
INTTRANS(RESULT,RCBILL) ; returns transaction details for the given bill IEN
"RTN","PRCAHV",165,0)
 N RCTRAN,RCNUM,X,Y,C
"RTN","PRCAHV",166,0)
 K RESULT
"RTN","PRCAHV",167,0)
 S X="ERROR^PRCAHV",@^%ZOSF("TRAP")
"RTN","PRCAHV",168,0)
 S:'$D(U) U="^"
"RTN","PRCAHV",169,0)
 I $G(RCBILL)="" Q -1 ;Bad parameter
"RTN","PRCAHV",170,0)
 I '$D(^PRCA(430,RCBILL,0)) Q -2 ;The bill doesn't exist
"RTN","PRCAHV",171,0)
 I '$D(^PRCA(433,"C",RCBILL)) Q 0 ;No data
"RTN","PRCAHV",172,0)
 S (RCNUM,RCTRAN)=0 F  S RCTRAN=$O(^PRCA(433,"C",RCBILL,RCTRAN))  Q:'RCTRAN  D
"RTN","PRCAHV",173,0)
 . Q:'$D(^PRCA(433,RCTRAN,0))  ;Corrupted cross-reference
"RTN","PRCAHV",174,0)
 . N RCDESC,RCTOTAL,RCY,RCI,RCTXT,RCD,RCTTY,RCAMT
"RTN","PRCAHV",175,0)
 . D TRANDESC^RCCPCPS1(RCTRAN)
"RTN","PRCAHV",176,0)
 . S RCY=$G(^PRCA(433,RCTRAN,1))
"RTN","PRCAHV",177,0)
 . S RCTTY=$P(RCY,U,2) ; Transaction Type
"RTN","PRCAHV",178,0)
 . S RCAMT=$P(RCY,U,5) ; Transaction Amount
"RTN","PRCAHV",179,0)
 . I ",2,8,9,10,11,14,19,47,34,35,29,"[(","_RCTTY_",") I RCAMT'<0 S RCAMT=-RCAMT
"RTN","PRCAHV",180,0)
 . I ",2,8,9,10,11,12,14,19,47,34,35,29,"'[(","_RCTTY_",") I RCAMT<0 S RCAMT=-RCAMT
"RTN","PRCAHV",181,0)
 . ;S RCTXT=RCTRAN_U_$P(RCY,U)_U_$G(RCTOTAL("INT"))_U_$G(RCTOTAL("ADM"))_U_$P(RCY,U,5)
"RTN","PRCAHV",182,0)
 . S RCTXT=RCTRAN_U_$P(RCY,U)_U_RCTTY_U_U_RCAMT
"RTN","PRCAHV",183,0)
 . S RCI=0 F  S RCI=$O(RCDESC(RCI)) Q:'RCI  S RCD=$$TRIM(RCDESC(RCI)) Q:($L(RCD)+$L(RCTXT))>254  S RCTXT=RCTXT_U_RCD
"RTN","PRCAHV",184,0)
 . S RCNUM=RCNUM+1
"RTN","PRCAHV",185,0)
 . S RESULT(RCNUM)=RCTXT
"RTN","PRCAHV",186,0)
 ;
"RTN","PRCAHV",187,0)
 Q 1 ;Success, data not guaranteed
"RTN","PRCAHV",188,0)
 ;
"RTN","PRCAHV",189,0)
TRIM(RCTXT) ;Remove starting and ending spaces
"RTN","PRCAHV",190,0)
 N RCI,RES
"RTN","PRCAHV",191,0)
 S RES=RCTXT
"RTN","PRCAHV",192,0)
 F RCI=1:1:$L(RES) Q:$E(RES,RCI)'=" "
"RTN","PRCAHV",193,0)
 I RCI>1 S $E(RES,1,RCI-1)=""
"RTN","PRCAHV",194,0)
 F RCI=$L(RES):-1:1 Q:$E(RES,RCI)'=" "
"RTN","PRCAHV",195,0)
 I RCI<$L(RES) S $E(RES,RCI+1,$L(RES))=""
"RTN","PRCAHV",196,0)
 Q RES
"RTN","PRCAHV",197,0)
 ;
"RTN","PRCAHV",198,0)
 ;Adjust Account Receivable Transaction Type:
"RTN","PRCAHV",199,0)
 ;1) Convert to upper case
"RTN","PRCAHV",200,0)
 ;2) Undefined will became "OPEN"
"RTN","PRCAHV",201,0)
 ;3) OPEN will became "113,112,102,107"
"RTN","PRCAHV",202,0)
ADJTYPE(RCTYPE) ;
"RTN","PRCAHV",203,0)
 S RCTYPE=$TR($G(RCTYPE,"OPEN"),"openal ","OPENAL") ; Convert tp upper case
"RTN","PRCAHV",204,0)
 I RCTYPE="OPEN" S RCTYPE="113,112,102,107"
"RTN","PRCAHV",205,0)
 Q
"RTN","PRCAHV",206,0)
 ;
"RTN","PRCAHV",207,0)
 ;Program error trap
"RTN","PRCAHV",208,0)
ERROR Q -3
"RTN","PRCAHV",209,0)
 ;
"RTN","PRCAHV",210,0)
 ;Temporary entry points - test only! Will be removed after testing
"RTN","PRCAHV",211,0)
TEST N C,R,P,A,O
"RTN","PRCAHV",212,0)
 S (P,C)=0 F  S P=$O(^DPT("AICN",P)) Q:'P  S R=$$DETAIL(.O,P,"ALL") I R>0 I $D(O) W !,P,?20,R,! D TESTZW(.O) S C=C+1 Q:C>500
"RTN","PRCAHV",213,0)
 Q
"RTN","PRCAHV",214,0)
 ;
"RTN","PRCAHV",215,0)
TEST2 N C,R,P,A
"RTN","PRCAHV",216,0)
 S (P,C)=0 F  S P=$O(^PRCA(430,"B",P)) Q:'P  S R=$$TRANS(.A,P) I R W !,P,?20,R,! I $D(A) D TESTZW(.A) S C=C+1 Q:C>500
"RTN","PRCAHV",217,0)
 Q
"RTN","PRCAHV",218,0)
TESTZW(PRA) N RCI
"RTN","PRCAHV",219,0)
 S RCI="" F  S RCI=$O(PRA(RCI)) Q:'RCI  W !,RCI,?10,PRA(RCI)
"RTN","PRCAHV",220,0)
 Q
"VER")
8.0^22
**END**
**END**
