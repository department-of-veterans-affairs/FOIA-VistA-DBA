$TXT Created by DIMICELI,RON at NXT.KERNEL.ISC-SF.VA.GOV  (KIDS) on TUESDAY, 02/01/00 at 10:33
=============================================================================
Run Date: FEB 08, 2000                     Designation: HL*1.6*57
Package : HL - HEALTH LEVEL SEVEN            Priority: Mandatory
Version : 1.6        SEQ #48                    Status: Released
=============================================================================

Associated patches: (v)HL*1.6*15       install with patch       `HL*1.6*57'
                    (v)HL*1.6*19       install with patch       `HL*1.6*57'
                    (v)HL*1.6*26       install with patch       `HL*1.6*57'
                    (v)HL*1.6*34       install with patch       `HL*1.6*57'
                    (v)HL*1.6*39       install with patch       `HL*1.6*57'
                    (v)HL*1.6*43       install with patch       `HL*1.6*57'
                    (v)HL*1.6*14   <<= must be installed BEFORE `HL*1.6*57'
                    (v)HL*1.6*35   <<= must be installed BEFORE `HL*1.6*57'
                    (v)XU*8*98     <<= must be installed BEFORE `HL*1.6*57'
                    (v)XU*8*118    <<= must be installed BEFORE `HL*1.6*57'
                    (v)HL*1.6*49   <<= must be installed BEFORE `HL*1.6*57'
                    (v)HL*1.6*50   <<= must be installed BEFORE `HL*1.6*57'
                    (v)XU*8*120    <<= must be installed BEFORE `HL*1.6*57'

Subject: Tools,Security,Backwards Compatibility,Fixes

Category: 
  - Routine
  - Data Dictionary
  - Enhancement (Mandatory)
  - Input Template

Description: 
============

  
  Y2K Waiver Request ID#:  Y2KW0001      Y2K Waiver Status: Approved
      This patch may be installed during the Y2K Moratorium, but it 
        should be installed BEFORE 12/15/99 or AFTER 1/15/2000.
      This patch MAY NOT be installed during the 12/15/1999 thru 
        1/15/2000 Y2K lockdown.
  
  
  
 VISTA HL7 patch HL*1.6*57 addresses most of the outstanding HL7 1.6
 deficiencies cited by the HL7 Joint Application Development (JAD) Focus
 Group and Part 2 of the OpenVISTA Tactical Plan.
  
 **CAUTION**
  
 If you have logical links namespaced "LA7V" that are currently in use
 (LEDI), you must install Laboratory patch LA*5.2*51 immediatly AFTER
 installing this patch. This Laboratory patch resolves a previously unknown
 issue with the LA7V protocol setups. Please note that your LA7V interface
 will not function correctly without LA*5.2*51 installed.
  
  
 1.     Exportable Interface Definitions. Class I Interface definitions are
 now exportable to all VISTA systems with little or no modification at the
 site. 
  
 2.     Reduction in Interface Development, Testing and Activation Time.
 Interfaces are now more intuitive, consistent and simpler regardless of
 the role of the VISTA system as sender or receiver or the mode of
 communication (Mailman, TCP, serial, local app-to-app). The number of
 protocol definitions that are required to support a simple interface has
 been reduced in most cases to just two.
  
 3.     Redesigned Menu. The HL7 MAIN MENU option has been completely
 reorganized to reflect user preferences both from the field and the JAD
 Focus Group.
  
 4.     Event types for version 2.1 messages are no longer required. HL7
 1.6 is now backward compatible to HL7 Standard, version 2.1 transactions.
 VISTA HL7 version 1.5 interfaces should be upgraded to 1.6 as soon as
 possible. Version 1.5 fields have been marked for removal from the system.
 Once this occurs, version 1.5 interfaces will no longer function. There
 should be no new development using the 1.5 interface method.
  
 5.     Merger of Split Logical Link and Lower Level Protocol Parameter
 Files. File 870 (Logical Link) and file 869.2 (HL LOWER LEVEL PROTOCOL
 PARAMETER) have been merged into a single file.
  
 6.     Response message type and event type can now be different from the
 initial message's message type/event type pair. The Transaction Message
 type and Event type are no longer defined on the subscriber protocol for a
 message to be successfully delivered. This information is now derived from
 the Event Point Protocol only. The Response Message Type and Event Type
 fields are now used for defining the message type and event type of the
 subscriber response. 
  
 7.     "Report" Option Fixed. The HL7 option, "Report" has been fixed to
 properly display non-TCP status codes and errors. The option has been
 renamed to, "Link Error/Status Report (non-TCP)."
  
 8.     Same-System Batch Messages. It has not been possible to exchange
 batch messages between applications running on the same system. This has
 been corrected.
  
 9.     Message Header Enhancements to Improve Security. Message headers
 have been enhanced to improve security. It is now possible to identify the
 source of a message and route (deferred) acknowledgements based entirely
 on header information. When enabled, the facility id field contains the
 source domain and destination domain as well as the Institution Number.
 Facility ID follows the HL7 Version 2.3 format, INSTITUTION
 NUMBER_cs_DOMAIN_NAME_cs_"DNS." For improved security, it is now possible
 to validate a source domain against entries in the logical link file. When
 valid domain information is present in the message header, the HL7 package
  
 (1) attempts to resolve the domain to the corresponding logical link and
  
 (2) uses this information as the return path for responses in place of
 what may be defined in the Protocol file, Logical Link field.
  
 10.    Message Header Enhancements Facilitate Message Broker Integration.
 Enhancements to message header also facilitate the integration of Message
 Brokers into our Enterprise Application Integration strategy. In a future
 enhancement, it will be possible to query a DNS for current IP
 information. Note that any data that currently exists in the HL7
 Application Parameter file (771), Facility ID field, overrides this
 enhancement. Data for the 'default' Sending Facility ID (if required and
 no Application Parameter is defined) is derived from the HL7 Communication
 Server Parameter file and edited using the option, Edit Site Parameters.
 Data for the Receiving Facility ID field is derived from the HL7 Logical
 Link File (870).
  
 11.    Processing ID Field Checking. Another improved security feature
 includes a check of the processing id field against the protocol
 definition or the site parameter file. On the receiving system, a mismatch
 between the message and the local definition results in an error. This can
 prevent test or debug messages from being processed in production
 accounts, and vice versa. 
  
 12.    Startup and Shutdown Enhancements. A new option has been created,
 "Stop All Logical Links And Filers". The "Restart All Links And Filers"
 option has also been fixed; it was shutting down all links, and then
 restarting only those links with AUTOSTART ENABLED. Now only AUTOSTART
 links are shut down and restarted.
  
 13.    Interface Workbench Replacement. The former HL7 option, "Interface
 Workbench," has been replaced. Due to the HL7 package's underlying
 architecture, it is relatively unintuitive to use and has been a problem
 to maintain. The new user interface also eliminates 21 routines and 62
 protocols.
  
 14.    Message Synchronization Over TCP. When a connection is broken it is
 possible for subsequent transactions to get out of synch. A fix is
 provided to assist with re-synchronizing the two systems. The following
 changes were added:
  
 (1) A new field has been added to the HL LOGICAL LINK file, #870.  When a
 TCP
  client exceeds the parameter value for the maximum number of
  re-transmissions, the action below will be performed.
  
  
  200.21 EXCEED RE-TRANSMIT ACTION 200;10 SET
    'I' FOR ignore; 
    'R' FOR restart; 
    'S' FOR shutdown;
  
   DESCRIPTION:      This field determines what to do when a message
 exceeds
  the number of retry attempts for this Logical Link.
  Actions are: Ignore  = send alert once and keep trying to resend
               Restart = send alert once and shutdown link then start link
              Shutdown = send alert once and shutdown link
  
 (2)     There is a new entry in HL7 ERROR MESSAGE file, #771.7.
  
   CODE: 109                               SHORT TEXT: Duplicate Message
  DESCRIPTION:   Message has already been received and processed.  This is
                 a duplicate. 
  
 15. The DATE/TIME field of the HL7 Message Header has been enhanced to
 include the timezone offset.
  
 16. New public functions:
  
       MSGSTAT^HLUTIL(X)      ;message status
         input value:   X = message id
         return value: status^status updated^error msg.^error type pointer^
               status:
                        0 = message doesn't exist
                        1 = pending transmission
                      1.5 = being transmitted
                        2 = awaiting application acknowledgement
                        3 = successfully completed
                        4 = error
                        8 = being generated
                        9 = awaiting processing
  
       MSGACT^HLUTIL(X,HLIENACT)      ;outgoing message action
         input value:   X = message id
                        HLIENACT = 1-cancel; 2-requeue
         return value:  1 = action sucessfull
                        0 = action failed
  
       CHKLL^HLUTIL(X)        ;check setup of Logical Link
         input value:   X = institution name or number
         return value:  1 = setup OK
                        0 = LL setup incorrect
  
 17. New Option: "Validate Interfaces"
  
 Use this option to check your interface setups for potential problems.
 Starting with an Event Driver Protocol, the event driver, subscriber(s)
 and application definitions will be scanned and a report generated.
  
 After patch 57 is installed, your pre-57 interfaces will continue to work.
 However, you may be interested in upgrading your existing interfaces to
 the post-57 style to take advantage of the new features. If you run this
 option on a pre-57 setup, you can use the report as a guide for making
 modifications. If your post-57 setup results in fewer protocols, be sure
 to remove the unneeded protocols. Remember-if the report on a pre-57
 interface reports errors, it does NOT mean the interface has been broken
 or will stop working because of patch 57. Use the report as a guide only
 for upgrading or for troubleshooting an existing POST-57 interface.
  
 No conversion of existing interfaces that have been properly defined will
 be necessary.
  
 Additional details regarding changes to the Application Parameter File,
 Event Point Protocols, Subscriber Protocols and key related fields are
 defined below. 
  
  The following NOIS's are addressed by this patch:
        ISF-0499-61219
        ISF-0499-61021
        BRX-0499-11335
        MIA-0499-31927
        SAG-0599-42045
        ISH-0696-40781
        BAY-1099-32639
        SLC-1099-51078
        BAY-0499-31357
        SDC-1099-62397
        ISB-1099-31173
        BAC-0699-40281
        BIG-0999-72027
  
  
  The following routines are included in this patch.  The second line of
 each
  of these routines now looks like:
   ;;1.6;HEALTH LEVEL SEVEN;<patchlist>;Oct 13, 1995
  
  CHECK^XTSUMBLD results: 
    
  Routine Name   Before Patch    After Patch     Patch List 
  ============   ============    ===========     ==========
  HLCS             5743323         5745388       2,9,14,19,43,57
  HLCS2            8763479        10072062       14,40,43,49,57
  HLCSAS1          1742491         1743950       43,57
  HLCSDL           4174780         4111820       2,44,49,57
  HLCSDR           3936049         3904673       2,14,49,57
  HLCSFMN0         5857525         5857070       15,57
  HLCSFMN2         NEW             1942573       57
  HLCSHDR          5939243         7364841       37,19,57
  HLCSHDR1         6658466         7750238       19,57
  HLCSHDR2         NEW             1077600       57
  HLCSLM           6276510         6371649       49,57
  HLCSLNCH        12855635        12643769       6,19,43,49,57
  HLCSLSM           154819          191876       49,57
  HLCSMM           2776063         2836421       17,35,57
  HLCSORAT         5245857         5441831       57
  HLCSRPT3        10792707        10830740       50,57
  HLCSTCP          4550642         5152314       19,43,49,57
  HLCSTCP1         4899040         4965932       19,43,57
  HLCSTCP2         7773433        10328595       19,43,49,57
  HLERCHK          NEW            12063792       57
  HLFNC2           5393929         5397412       2,26,57
  HLMA2            7300625         7268935       19,43,57
  HLPAT57          NEW             1630585       57
  HLSUB            4535863         5277110       14,57
  HLTP01           5245980         5262489       2,25,34,47,57
  HLTP3           12440103        14050232       19,43,57
  HLTP31           NEW             1680845       57
  HLTP4            7754632         7805100       19,57
  HLTPCK1A         7334335        14402537       2,25,34,57
  HLTPCK2A        11350701        15262342       19,57
  HLUOPT          11331726        11707096       57
  HLUTIL           1343106         2643574       36,19,57
  HLUTIL2          5380198         5387464       19,43,57
  
 List of preceding patches: 14, 15, 26, 34, 35, 43, 49, 50
 Sites should use CHECK^XTSUMBLD to verify checksums.
  
 HLPAT57 is a post-install routine.  After the installation, HLPAT57 is
 deleted from your system.
  
 Installation Instructions: 
 ==========================
   1.  Users are allowed to be on the system during the installation.  
  
   2.  DSM SITES: Review your mapped set.  If any of the routines listed in
  
       the Routine Summary section are mapped, they should be removed from 
       the mapped set at this time.  
  
   3.  Shutdown all Logical Links and incoming and outgoing filers, and
       the Link Manager. Use the opitons:
  
        Shut Down All Logical Links
        Stop all incoming filers
        Stop all outgoing filers
        TCP/IP Link Manager Start/Stop
  
       For DSM sites ONLY, if you have an HL7 UCX Service associated
       with the account(uci/directory) where you are installing this patch,
       please disable this service.
  
   4.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This 
       option will load the KIDS package onto your system.  
  
   5.  The patch has now been loaded into a Transport global on your 
       system. You now need to use KIDS to install the Transport global.  
       On the KIDS menu, under the 'Installation' menu, use the following 
       options: 
  
          2 Verify Checksums in Transport Global 
          3 Print Transport Global 
          4 Compare Transport Global to Current System 
          5 Backup a Transport Global 
          6 Install Package(s) 
              INSTALL NAME: HL*1.6*57
                            =========
  
         Answer 'YES' to 'Want KIDS to Rebuild Menu Trees upon Completion
         of Install?'.
  
         Answer 'NO' to 'Want KIDS to INHIBIT LOGONS during the install?'.
   
         Answer 'NO' to 'Want to DISABLE Scheduled Options, Menu Options, 
         and Protocols?'.  
  
   6.  Startup all Logical Links and incoming and outgoing filers. Use the 
       'Restart/Start All Links and Filers' option.  
  
       For DSM sites ONLY, if you previously disabled an HL7 UCX Service
       for this installation, you may now enable it.
  
   7.  DSM Sites: Rebuild your mapped set if necessary.
  
   8.  Start Link Manager using the option: "TCP/IP
         Link Manager Start/Stop."
  
  
  =========================================================================
  
     
 There is additional information contained in the Build description of
 this patch and online. It contains details of how patch 57 changes the way
 interfaces are set up. 
  
 For a complete and up-to-date set of documents, tutorials and
 presentations (and access to the HL7 Standard) please visit the OpenVista
 Website (frequently) at:
   
  http://vista2.med.va.gov/openvista/
   
  At this site, you'll be able to find the new DEVELOPER MANUAL, released in
  patch HL*1.6*56, as well as supplemental information on DYNAMIC ADDRESSING
  and TCP/IP SUPPORT.
  
  =========================================================================

Routine Information:
====================

Routine Name:
  - HLCSHDR


Routine Checksum:

Routine Name:
  - HLCS


Routine Checksum:

Routine Name:
  - HLCS2


Routine Checksum:

Routine Name:
  - HLCSAS1


Routine Checksum:

Routine Name:
  - HLCSDL


Routine Checksum:

Routine Name:
  - HLCSDR


Routine Checksum:

Routine Name:
  - HLCSHDR2


Routine Checksum:

Routine Name:
  - HLCSLM


Routine Checksum:

Routine Name:
  - HLCSLNCH


Routine Checksum:

Routine Name:
  - HLCSORAT


Routine Checksum:

Routine Name:
  - HLCSRPT3


Routine Checksum:

Routine Name:
  - HLCSTCP


Routine Checksum:

Routine Name:
  - HLCSTCP1


Routine Checksum:

Routine Name:
  - HLCSTCP2


Routine Checksum:

Routine Name:
  - HLFNC2


Routine Checksum:

Routine Name:
  - HLMA2


Routine Checksum:

Routine Name:
  - HLPAT57


Routine Checksum:

Routine Name:
  - HLTP3


Routine Checksum:

Routine Name:
  - HLTP4


Routine Checksum:

Routine Name:
  - HLTPCK1A


Routine Checksum:

Routine Name:
  - HLTPCK2A


Routine Checksum:

Routine Name:
  - HLUOPT


Routine Checksum:

Routine Name:
  - HLCSHDR1


Routine Checksum:

Routine Name:
  - HLERCHK


Routine Checksum:

Routine Name:
  - HLUTIL


Routine Checksum:

Routine Name:
  - HLCSFMN0


Routine Checksum:

Routine Name:
  - HLCSFMN2


Routine Checksum:

Routine Name:
  - HLCSMM


Routine Checksum:

Routine Name:
  - HLTP31


Routine Checksum:

Routine Name:
  - HLUTIL2


Routine Checksum:

Routine Name:
  - HLCSLSM


Routine Checksum:

Routine Name:
  - HLSUB


Routine Checksum:

=============================================================================
User Information:                               
Entered By  : CLEMENS,JOHN                   Date Entered : JUL 01, 1999
Completed By: CHAN,ALAN                     Date Completed: FEB 08, 2000
Released By : SINGH,GURBIR                  Date Released : FEB 08, 2000
=============================================================================


Packman Mail Message:
=====================

$END TXT
