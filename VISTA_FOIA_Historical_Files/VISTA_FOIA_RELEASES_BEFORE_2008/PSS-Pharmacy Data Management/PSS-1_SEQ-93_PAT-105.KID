Released PSS*1*105 SEQ #93
Extracted from mail message
**KIDS**:PSS*1.0*105^

**INSTALL NAME**
PSS*1.0*105
"BLD",5955,0)
PSS*1.0*105^PHARMACY DATA MANAGEMENT^0^3051215^y
"BLD",5955,1,0)
^^3^3^3051215^
"BLD",5955,1,1,0)
This patch fixes an error that could occur when invoking the VAC^PSS50 or
"BLD",5955,1,2,0)
ASP^PSS50 Application Program Interface, which are both supported by
"BLD",5955,1,3,0)
Integration Agreement 4533.
"BLD",5955,4,0)
^9.64PA^^
"BLD",5955,6)
1^
"BLD",5955,"KRN",0)
^9.67PA^8989.52^19
"BLD",5955,"KRN",.4,0)
.4
"BLD",5955,"KRN",.401,0)
.401
"BLD",5955,"KRN",.402,0)
.402
"BLD",5955,"KRN",.403,0)
.403
"BLD",5955,"KRN",.5,0)
.5
"BLD",5955,"KRN",.84,0)
.84
"BLD",5955,"KRN",3.6,0)
3.6
"BLD",5955,"KRN",3.8,0)
3.8
"BLD",5955,"KRN",9.2,0)
9.2
"BLD",5955,"KRN",9.8,0)
9.8
"BLD",5955,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5955,"KRN",9.8,"NM",1,0)
PSS50D^^0^B36352691
"BLD",5955,"KRN",9.8,"NM","B","PSS50D",1)

"BLD",5955,"KRN",19,0)
19
"BLD",5955,"KRN",19.1,0)
19.1
"BLD",5955,"KRN",101,0)
101
"BLD",5955,"KRN",409.61,0)
409.61
"BLD",5955,"KRN",771,0)
771
"BLD",5955,"KRN",870,0)
870
"BLD",5955,"KRN",8989.51,0)
8989.51
"BLD",5955,"KRN",8989.52,0)
8989.52
"BLD",5955,"KRN",8994,0)
8994
"BLD",5955,"KRN","B",.4,.4)

"BLD",5955,"KRN","B",.401,.401)

"BLD",5955,"KRN","B",.402,.402)

"BLD",5955,"KRN","B",.403,.403)

"BLD",5955,"KRN","B",.5,.5)

"BLD",5955,"KRN","B",.84,.84)

"BLD",5955,"KRN","B",3.6,3.6)

"BLD",5955,"KRN","B",3.8,3.8)

"BLD",5955,"KRN","B",9.2,9.2)

"BLD",5955,"KRN","B",9.8,9.8)

"BLD",5955,"KRN","B",19,19)

"BLD",5955,"KRN","B",19.1,19.1)

"BLD",5955,"KRN","B",101,101)

"BLD",5955,"KRN","B",409.61,409.61)

"BLD",5955,"KRN","B",771,771)

"BLD",5955,"KRN","B",870,870)

"BLD",5955,"KRN","B",8989.51,8989.51)

"BLD",5955,"KRN","B",8989.52,8989.52)

"BLD",5955,"KRN","B",8994,8994)

"BLD",5955,"QUES",0)
^9.62^^
"BLD",5955,"REQB",0)
^9.611^1^1
"BLD",5955,"REQB",1,0)
PSS*1.0*85^2
"BLD",5955,"REQB","B","PSS*1.0*85",1)

"MBREQ")
0
"PKG",517,-1)
1^1
"PKG",517,0)
PHARMACY DATA MANAGEMENT^PSS^Maintenance of Pharmacy files.
"PKG",517,20,0)
^9.402P^^
"PKG",517,22,0)
^9.49I^1^1
"PKG",517,22,1,0)
1.0^2970930^2971014^11595
"PKG",517,22,1,"PAH",1,0)
105^3051215^11859
"PKG",517,22,1,"PAH",1,1,0)
^^3^3^3051215
"PKG",517,22,1,"PAH",1,1,1,0)
This patch fixes an error that could occur when invoking the VAC^PSS50 or
"PKG",517,22,1,"PAH",1,1,2,0)
ASP^PSS50 Application Program Interface, which are both supported by
"PKG",517,22,1,"PAH",1,1,3,0)
Integration Agreement 4533.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSS50D")
0^1^B36352691
"RTN","PSS50D",1,0)
PSS50D ;BIR/LDT - API FOR INFORMATION FROM FILE 50; 5 Sep 03
"RTN","PSS50D",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,105**;9/30/97
"RTN","PSS50D",3,0)
 ;
"RTN","PSS50D",4,0)
B ;
"RTN","PSS50D",5,0)
 ;PSSFT - Free Text name in 50
"RTN","PSS50D",6,0)
 ;PSSFL - Inactive flag - "" - All entries
"RTN","PSS50D",7,0)
 ;                        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50D",8,0)
 ;PSSPK - Application Package's Use - "" - All entries
"RTN","PSS50D",9,0)
 ;                                         Alphabetic codes that represent the DHCP packages that consider this drug to be
"RTN","PSS50D",10,0)
 ;                                         part of their formulary.
"RTN","PSS50D",11,0)
 ;PSSRTOI - Orderable Item - return only entries matched to a Pharmacy Orderable Item
"RTN","PSS50D",12,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the Field Number of the data
"RTN","PSS50D",13,0)
 ;       piece being returned.
"RTN","PSS50D",14,0)
 ;Returns list of drugs meeting input criteria
"RTN","PSS50D",15,0)
 N DIERR,ZZERR,PSSP50,SCR,PSSIEN
"RTN","PSS50D",16,0)
 I $G(LIST)']"" Q
"RTN","PSS50D",17,0)
 K ^TMP($J,LIST)
"RTN","PSS50D",18,0)
 I $G(PSSFT)']"" S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",19,0)
 S SCR("S")=""
"RTN","PSS50D",20,0)
 I +$G(PSSFL)>0!($G(PSSPK)]"")!($G(PSSRTOI)=1) N PSS5ND,PSSZ3,PSSZ4 D SETSCRN^PSS50A
"RTN","PSS50D",21,0)
 I $G(PSSFT)]"" D
"RTN","PSS50D",22,0)
 .I PSSFT["??" D LOOPB^PSS50C1 Q
"RTN","PSS50D",23,0)
 .K ^TMP("DILIST",$J)
"RTN","PSS50D",24,0)
 .D FIND^DIC(50,,"@;.01","QP",PSSFT,,"B",SCR("S"),,"")
"RTN","PSS50D",25,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",26,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS50D",27,0)
 ..S PSSIEN=+$G(^TMP("DILIST",$J,PSSXX,0)) I PSSIEN,$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",2)'="" D
"RTN","PSS50D",28,0)
 ...S ^TMP($J,LIST,PSSIEN,.01)=$P(^TMP("DILIST",$J,PSSXX,0),"^",2)
"RTN","PSS50D",29,0)
 ...S ^TMP($J,LIST,"B",$P(^TMP("DILIST",$J,PSSXX,0),"^",2),PSSIEN)=""
"RTN","PSS50D",30,0)
 K ^TMP("DILIST",$J)
"RTN","PSS50D",31,0)
 Q
"RTN","PSS50D",32,0)
 ;
"RTN","PSS50D",33,0)
VAC ;
"RTN","PSS50D",34,0)
 ;PSSVAL - NATIONAL DRUG CLASS field (#25) of the DRUG file (#50)
"RTN","PSS50D",35,0)
 ;PSSFL - Inactive flag - "" - All entries
"RTN","PSS50D",36,0)
 ;                        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50D",37,0)
 ;PSSPK - Application Package's Use - "" - All entries
"RTN","PSS50D",38,0)
 ;                                         Alphabetic codes that represent the DHCP packages that consider this drug to be
"RTN","PSS50D",39,0)
 ;                                         part of their formulary.
"RTN","PSS50D",40,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the Field Number of the data
"RTN","PSS50D",41,0)
 ;       piece being returned.
"RTN","PSS50D",42,0)
 ;Returns list of drugs meeting input criteria
"RTN","PSS50D",43,0)
 N DIERR,ZZERR,PSSP50,SCR,PSSIEN
"RTN","PSS50D",44,0)
 I $G(LIST)']"" Q
"RTN","PSS50D",45,0)
 K ^TMP($J,LIST)
"RTN","PSS50D",46,0)
 I ($G(PSSVAL)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",47,0)
 S SCR("S")="I $P($G(^PSDRUG(+Y,""ND"")),""^"",6)=PSSVAL"
"RTN","PSS50D",48,0)
 I +$G(PSSFL)>0!($G(PSSPK)]"") N PSS5ND,PSSZ3,PSSZ4 D SETSCRN^PSS50C1
"RTN","PSS50D",49,0)
 I $G(PSSVAL)]"" D
"RTN","PSS50D",50,0)
 .K ^TMP("DILIST",$J)
"RTN","PSS50D",51,0)
 .D FIND^DIC(50,,"@;.01","QP",PSSVAL,,"VAC",SCR("S"),,"")
"RTN","PSS50D",52,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",53,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS50D",54,0)
 ..S PSSIEN=+$G(^TMP("DILIST",$J,PSSXX,0)) I PSSIEN,$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",2)'="" D
"RTN","PSS50D",55,0)
 ...S ^TMP($J,LIST,PSSIEN,.01)=$P(^TMP("DILIST",$J,PSSXX,0),"^",2)
"RTN","PSS50D",56,0)
 ...S ^TMP($J,LIST,"VAC",$P(^TMP("DILIST",$J,PSSXX,0),"^",2),PSSIEN)=""
"RTN","PSS50D",57,0)
 K ^TMP("DILIST",$J)
"RTN","PSS50D",58,0)
 Q
"RTN","PSS50D",59,0)
 ;
"RTN","PSS50D",60,0)
NDC ;
"RTN","PSS50D",61,0)
 ;PSSVAL - NDC field (#31) of the DRUG file (#50)
"RTN","PSS50D",62,0)
 ;PSSFL - Inactive flag - "" - All entries
"RTN","PSS50D",63,0)
 ;                        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50D",64,0)
 ;PSSPK - Application Package's Use - "" - All entries
"RTN","PSS50D",65,0)
 ;                                         Alphabetic codes that represent the DHCP packages that consider this drug to be
"RTN","PSS50D",66,0)
 ;                                         part of their formulary.
"RTN","PSS50D",67,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the Field Number of the data
"RTN","PSS50D",68,0)
 ;       piece being returned.
"RTN","PSS50D",69,0)
 ;Returns list of drugs meeting input criteria
"RTN","PSS50D",70,0)
 ; 
"RTN","PSS50D",71,0)
 ; Must change to look directly at the NDC cross reference
"RTN","PSS50D",72,0)
 N PSSNDC,PSSNDC1,PSSNDC2
"RTN","PSS50D",73,0)
 I $G(LIST)']"" Q
"RTN","PSS50D",74,0)
 K ^TMP($J,LIST)
"RTN","PSS50D",75,0)
 I ($G(PSSVAL)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",76,0)
 S PSSNDC=0 F PSSNDC1=0:0 S PSSNDC1=$O(^PSDRUG("NDC",PSSVAL,PSSNDC1)) Q:'PSSNDC1  D
"RTN","PSS50D",77,0)
 .S PSSNDC2=$P($G(^PSDRUG(PSSNDC1,0)),"^")
"RTN","PSS50D",78,0)
 .I PSSNDC2="" Q
"RTN","PSS50D",79,0)
 .I $G(PSSFL),$P($G(^PSDRUG(PSSNDC1,"I")),"^"),$P($G(^("I")),"^")'>PSSFL Q
"RTN","PSS50D",80,0)
 .;Naked reference below refers to ^PSDRUG(PSSNDC1,"I"), or ^PSDRUG(PSSNDC1,0)
"RTN","PSS50D",81,0)
 .I $G(PSSPK)]"" N PSSZ5,PSSZ6 S PSSZ5=0 F PSSZ6=1:1:$L(PSSPK) Q:PSSZ5  I $P($G(^(2)),"^",3)[$E(PSSPK,PSSZ6) S PSSZ5=1
"RTN","PSS50D",82,0)
 .I $G(PSSPK)]"",'PSSZ5 Q
"RTN","PSS50D",83,0)
 .S ^TMP($J,LIST,PSSNDC1,.01)=PSSNDC2
"RTN","PSS50D",84,0)
 .S ^TMP($J,LIST,"NDC",PSSNDC2,PSSNDC1)=""
"RTN","PSS50D",85,0)
 .S PSSNDC=PSSNDC+1
"RTN","PSS50D",86,0)
 S ^TMP($J,LIST,0)=$S($G(PSSNDC):$G(PSSNDC),1:"-1^NO DATA FOUND")
"RTN","PSS50D",87,0)
 Q
"RTN","PSS50D",88,0)
 ;
"RTN","PSS50D",89,0)
ASP ;
"RTN","PSS50D",90,0)
 ;PSSVAL - PHARMACY ORDERABLE ITEM field (#2.1) of the DRUG file (#50)
"RTN","PSS50D",91,0)
 ;PSSFL - Inactive flag - "" - All entries
"RTN","PSS50D",92,0)
 ;                        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50D",93,0)
 ;PSSPK - Application Package's Use - "" - All entries
"RTN","PSS50D",94,0)
 ;                                         Alphabetic codes that represent the DHCP packages that consider this drug to be
"RTN","PSS50D",95,0)
 ;                                         part of their formulary.
"RTN","PSS50D",96,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the Field Number of the data
"RTN","PSS50D",97,0)
 ;       piece being returned.
"RTN","PSS50D",98,0)
 ;Returns list of drugs meeting input criteria
"RTN","PSS50D",99,0)
 N DIERR,ZZERR,PSSP50,SCR,PSSIEN
"RTN","PSS50D",100,0)
 I $G(LIST)']"" Q
"RTN","PSS50D",101,0)
 K ^TMP($J,LIST)
"RTN","PSS50D",102,0)
 I ($G(PSSVAL)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",103,0)
 S SCR("S")=""
"RTN","PSS50D",104,0)
 I +$G(PSSFL)>0!($G(PSSPK)]"") N PSS5ND,PSSZ3,PSSZ4 D SETSCRN^PSS50A
"RTN","PSS50D",105,0)
 S SCR("S")=SCR("S")_" I +$G(^PSDRUG(+Y,2))=PSSVAL"
"RTN","PSS50D",106,0)
 I $G(PSSVAL)]"" D
"RTN","PSS50D",107,0)
 .D FIND^DIC(50,,"@;.01","QP",PSSVAL,,"ASP",SCR("S"),,"")
"RTN","PSS50D",108,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",109,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N XX S XX=0 F  S XX=$O(^TMP("DILIST",$J,XX)) Q:'XX  D
"RTN","PSS50D",110,0)
 ..S PSSIEN=+^TMP("DILIST",$J,XX,0),^TMP($J,LIST,PSSIEN,.01)=$P(^TMP("DILIST",$J,XX,0),"^",2)
"RTN","PSS50D",111,0)
 ..S ^TMP($J,LIST,"ASP",$P(^TMP("DILIST",$J,XX,0),"^",2),PSSIEN)=""
"RTN","PSS50D",112,0)
 K ^TMP("DILIST",$J)
"RTN","PSS50D",113,0)
 Q
"RTN","PSS50D",114,0)
 ;
"RTN","PSS50D",115,0)
AND ;
"RTN","PSS50D",116,0)
 ;PSSVAL -NATIONAL DRUG FILE ENTRY field (#20) of the DRUG file (#50)
"RTN","PSS50D",117,0)
 ;PSSFL - Inactive flag - "" - All entries
"RTN","PSS50D",118,0)
 ;                        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50D",119,0)
 ;PSSPK - Application Package's Use - "" - All entries
"RTN","PSS50D",120,0)
 ;                                         Alphabetic codes that represent the DHCP packages that consider this drug to be
"RTN","PSS50D",121,0)
 ;                                         part of their formulary.
"RTN","PSS50D",122,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the Field Number of the data
"RTN","PSS50D",123,0)
 ;       piece being returned.
"RTN","PSS50D",124,0)
 ;Returns list of drugs meeting input criteria
"RTN","PSS50D",125,0)
 N DIERR,ZZERR,PSSP50,SCR,PSSIEN,CNT
"RTN","PSS50D",126,0)
 I $G(LIST)']"" Q
"RTN","PSS50D",127,0)
 K ^TMP($J,LIST)
"RTN","PSS50D",128,0)
 I ($G(PSSVAL)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",129,0)
 S SCR("S")=""
"RTN","PSS50D",130,0)
 I +$G(PSSFL)>0!($G(PSSPK)]"") N PSS5ND,PSSZ3,PSSZ4 D SETSCRN^PSS50A
"RTN","PSS50D",131,0)
 I $G(PSSVAL)]"" D
"RTN","PSS50D",132,0)
 .S CNT=0
"RTN","PSS50D",133,0)
 .D FIND^DIC(50,,"@;.01","QP",PSSVAL,,"AND",SCR("S"),,"")
"RTN","PSS50D",134,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",135,0)
 .I +^TMP("DILIST",$J,0)>0 N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS50D",136,0)
 ..S PSSIEN=+^TMP("DILIST",$J,PSSXX,0) K PSS50 D GETS^DIQ(50,+PSSIEN,".01;20","IE","PSS50") S PSS(1)=0
"RTN","PSS50D",137,0)
 ..F  S PSS(1)=$O(PSS50(50,PSS(1))) Q:'PSS(1)  D
"RTN","PSS50D",138,0)
 ...Q:PSS50(50,PSS(1),20,"I")'=PSSVAL
"RTN","PSS50D",139,0)
 ...S ^TMP($J,LIST,PSSIEN,.01)=$G(PSS50(50,PSS(1),.01,"E")),CNT=CNT+1
"RTN","PSS50D",140,0)
 ...S ^TMP($J,LIST,"AND",$G(PSS50(50,PSS(1),.01,"E")),PSSIEN)=""
"RTN","PSS50D",141,0)
 ..S ^TMP($J,LIST,0)=$S(CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS50D",142,0)
 K ^TMP("DILIST",$J),PSS50
"RTN","PSS50D",143,0)
 Q
"RTN","PSS50D",144,0)
 ;
"RTN","PSS50D",145,0)
AP ;
"RTN","PSS50D",146,0)
 ;PSSVAL - PRIMARY DRUG field (#64) of the DRUG file (#50)
"RTN","PSS50D",147,0)
 ;PSSFL - Inactive flag - "" - All entries
"RTN","PSS50D",148,0)
 ;                        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50D",149,0)
 ;PSSPK - Application Package's Use - "" - All entries
"RTN","PSS50D",150,0)
 ;                                         Alphabetic codes that represent the DHCP packages that consider this drug to be
"RTN","PSS50D",151,0)
 ;                                         part of their formulary.
"RTN","PSS50D",152,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the Field Number of the data
"RTN","PSS50D",153,0)
 ;       piece being returned.
"RTN","PSS50D",154,0)
 ;Returns list of drugs meeting input criteria
"RTN","PSS50D",155,0)
 N DIERR,ZZERR,PSSP50,SCR,PSSIEN
"RTN","PSS50D",156,0)
 I $G(LIST)']"" Q
"RTN","PSS50D",157,0)
 K ^TMP($J,LIST)
"RTN","PSS50D",158,0)
 I ($G(PSSVAL)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",159,0)
 S SCR("S")=""
"RTN","PSS50D",160,0)
 I +$G(PSSFL)>0!($G(PSSPK)]"") N PSS5ND,PSSZ3,PSSZ4 D SETSCRN^PSS50A
"RTN","PSS50D",161,0)
 S SCR("S")=SCR("S")_" I +$P($G(^PSDRUG(+Y,2)),""^"",6)=PSSVAL"
"RTN","PSS50D",162,0)
 I $G(PSSVAL)]"" D
"RTN","PSS50D",163,0)
 .D FIND^DIC(50,,"@;.01","QP",PSSVAL,,"AP",SCR("S"),,"")
"RTN","PSS50D",164,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50D",165,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N XX S XX=0 F  S XX=$O(^TMP("DILIST",$J,XX)) Q:'XX  D
"RTN","PSS50D",166,0)
 ..S PSSIEN=+^TMP("DILIST",$J,XX,0),^TMP($J,LIST,PSSIEN,.01)=$P(^TMP("DILIST",$J,XX,0),"^",2)
"RTN","PSS50D",167,0)
 ..S ^TMP($J,LIST,"AP",$P(^TMP("DILIST",$J,XX,0),"^",2),PSSIEN)=""
"RTN","PSS50D",168,0)
 K ^TMP("DILIST",$J)
"RTN","PSS50D",169,0)
 Q
"VER")
8.0^22.0
"BLD",5955,6)
^93
**END**
**END**
