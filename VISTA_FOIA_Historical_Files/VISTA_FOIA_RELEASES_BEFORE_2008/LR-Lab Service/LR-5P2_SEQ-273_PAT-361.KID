Released LR*5.2*361 SEQ #273
Extracted from mail message
**KIDS**:LR*5.2*361^

**INSTALL NAME**
LR*5.2*361
"BLD",6857,0)
LR*5.2*361^LAB SERVICE^0^3060601^y
"BLD",6857,1,0)
^^1^1^3060601^
"BLD",6857,1,1,0)
ADDING NEW LAB TEST WITH DOUBLE QUOTES
"BLD",6857,4,0)
^9.64PA^^
"BLD",6857,"ABPKG")
n
"BLD",6857,"KRN",0)
^9.67PA^8989.52^19
"BLD",6857,"KRN",.4,0)
.4
"BLD",6857,"KRN",.401,0)
.401
"BLD",6857,"KRN",.402,0)
.402
"BLD",6857,"KRN",.403,0)
.403
"BLD",6857,"KRN",.5,0)
.5
"BLD",6857,"KRN",.84,0)
.84
"BLD",6857,"KRN",3.6,0)
3.6
"BLD",6857,"KRN",3.8,0)
3.8
"BLD",6857,"KRN",9.2,0)
9.2
"BLD",6857,"KRN",9.8,0)
9.8
"BLD",6857,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6857,"KRN",9.8,"NM",1,0)
LR7OV0^^0^28253396
"BLD",6857,"KRN",9.8,"NM","B","LR7OV0",1)

"BLD",6857,"KRN",19,0)
19
"BLD",6857,"KRN",19.1,0)
19.1
"BLD",6857,"KRN",101,0)
101
"BLD",6857,"KRN",409.61,0)
409.61
"BLD",6857,"KRN",771,0)
771
"BLD",6857,"KRN",870,0)
870
"BLD",6857,"KRN",8989.51,0)
8989.51
"BLD",6857,"KRN",8989.52,0)
8989.52
"BLD",6857,"KRN",8994,0)
8994
"BLD",6857,"KRN","B",.4,.4)

"BLD",6857,"KRN","B",.401,.401)

"BLD",6857,"KRN","B",.402,.402)

"BLD",6857,"KRN","B",.403,.403)

"BLD",6857,"KRN","B",.5,.5)

"BLD",6857,"KRN","B",.84,.84)

"BLD",6857,"KRN","B",3.6,3.6)

"BLD",6857,"KRN","B",3.8,3.8)

"BLD",6857,"KRN","B",9.2,9.2)

"BLD",6857,"KRN","B",9.8,9.8)

"BLD",6857,"KRN","B",19,19)

"BLD",6857,"KRN","B",19.1,19.1)

"BLD",6857,"KRN","B",101,101)

"BLD",6857,"KRN","B",409.61,409.61)

"BLD",6857,"KRN","B",771,771)

"BLD",6857,"KRN","B",870,870)

"BLD",6857,"KRN","B",8989.51,8989.51)

"BLD",6857,"KRN","B",8989.52,8989.52)

"BLD",6857,"KRN","B",8994,8994)

"BLD",6857,"QUES",0)
^9.62^^
"BLD",6857,"REQB",0)
^9.611^1^1
"BLD",6857,"REQB",1,0)
LR*5.2*357^2
"BLD",6857,"REQB","B","LR*5.2*357",1)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
361^3060601
"PKG",26,22,1,"PAH",1,1,0)
^^1^1^3060601
"PKG",26,22,1,"PAH",1,1,1,0)
ADDING NEW LAB TEST WITH DOUBLE QUOTES
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","LR7OV0")
0^1^B28253396^B23457676
"RTN","LR7OV0",1,0)
LR7OV0 ;slc/dcm - Update orderable items ;8/11/97
"RTN","LR7OV0",2,0)
 ;;5.2;LAB SERVICE;**121,187,357,361**;Sep 27, 1994
"RTN","LR7OV0",3,0)
 ;
"RTN","LR7OV0",4,0)
TEST(TEST,ICNT) ;Process single test
"RTN","LR7OV0",5,0)
 ;TEST=test ptr to file 60
"RTN","LR7OV0",6,0)
 ;ICNT=Current counter in ORUPDMSG(ICNT)
"RTN","LR7OV0",7,0)
 N TYPE,TESTID,IFN,IFN1,CTR,CTR1,GENW,X0,S0,SAMP,MAX,DMAX,COLLECT,SAMPLE,SPEC,SYN,COST,Y9,Y10,Y11
"RTN","LR7OV0",8,0)
 Q:'$D(^LAB(60,TEST,0))  S X0=^(0),COST=$P(X0,"^",11),SUB=$P(X0,"^",4),TYPE=$P(X0,"^",3),CTR1=0
"RTN","LR7OV0",9,0)
 I $D(^LAB(60,TEST,6)) S (CTR,IFN)=0 F  S IFN=$O(^LAB(60,TEST,6,IFN)) Q:IFN<1  S CTR=CTR+1,GENW(CTR)=^(IFN,0)
"RTN","LR7OV0",10,0)
 S (CTR,IFN)=0 F  S IFN=$O(^LAB(60,TEST,5,IFN)) Q:IFN<1  S CTR=CTR+1,SYN(CTR)=^(IFN,0)
"RTN","LR7OV0",11,0)
 S (Y9,Y10,Y11)="" I $P($G(^LAB(60,TEST,64)),"^") S Y9=$P(^(64),"^"),Y10=$P(^LAM(Y9,0),"^"),Y9=$P(^(0),"^",2),Y11="99NLT"
"RTN","LR7OV0",12,0)
 D
"RTN","LR7OV0",13,0)
 . S (COLLECT,SAMP,SPEC)=0,TESTID=$$UVID^LR7OU0(TEST,+SPEC,Y9,Y11,Y10,"ORUPDMSG"),ICNT=ICNT+1,ORUPDMSG(ICNT)=$$MFE(MFECODE,TESTID)
"RTN","LR7OV0",14,0)
 . S ICNT=ICNT+1,ORUPDMSG(ICNT)=$$ZLR("","",CTR1,SUB,"","",COST,TYPE)
"RTN","LR7OV0",15,0)
 . S IFN1=0 F  S IFN1=$O(^LAB(60,TEST,2,IFN1)) Q:IFN1<1  S X=^(IFN1,0) I $D(^LAB(60,+X,0)) D
"RTN","LR7OV0",16,0)
 .. N Y9,Y10,Y11 S (Y9,Y10,Y11)="" I $P($G(^LAB(60,+X,64)),"^") S Y9=$P(^(64),"^"),Y10=$P(^LAM(Y9,0),"^"),Y9=$P(^(0),"^",2),Y11="99NLT"
"RTN","LR7OV0",17,0)
 .. S SUBID=$$UVID^LR7OU0($P(X,"^"),"",Y9,Y11,Y10,"ORUPDMSG"),ICNT=ICNT+1,ORUPDMSG(ICNT)="ZLC||||"_SUBID
"RTN","LR7OV0",18,0)
 . D ZSY(.SYN),NTE(.GENW,.WCOM)
"RTN","LR7OV0",19,0)
 Q
"RTN","LR7OV0",20,0)
MFE(EVENT,KEY) ;MFE component
"RTN","LR7OV0",21,0)
 ;EVENT=MAD-Add Record, MDL-Delete Record, MUP-Update Record
"RTN","LR7OV0",22,0)
 ;      MDC-Deactivate, MAC-Reactivate
"RTN","LR7OV0",23,0)
 S MFE="MFE|"_EVENT_"|||"_KEY
"RTN","LR7OV0",24,0)
 Q MFE
"RTN","LR7OV0",25,0)
ZLR(SPEC,COLLECT,SEQ,SUB,MAXORD,DMAXORD,COST,TYPE) ;ZLR component
"RTN","LR7OV0",26,0)
 S ZLR="ZLR|"_SPEC_"|"_COLLECT_"|"_SEQ_"|"_SUB_"|"_MAXORD_"|"_DMAXORD_"|"_COST_"|"_TYPE
"RTN","LR7OV0",27,0)
 Q ZLR
"RTN","LR7OV0",28,0)
ZSY(SYN) ;ZSY component
"RTN","LR7OV0",29,0)
 N IFN
"RTN","LR7OV0",30,0)
 S IFN=0 F  S IFN=$O(SYN(IFN)) Q:IFN<1  S ICNT=ICNT+1,ORUPDMSG(ICNT)="ZSY|"_IFN_"|"_SYN(IFN)
"RTN","LR7OV0",31,0)
 Q
"RTN","LR7OV0",32,0)
NTE(GEN,COM) ;NTE component
"RTN","LR7OV0",33,0)
 N IFN,CTR S CTR=0
"RTN","LR7OV0",34,0)
 S ICNT=ICNT+1 D NTE^LR7OU01(CTR,"P","GEN(",ICNT)
"RTN","LR7OV0",35,0)
 S ICNT=ICNT+1 D NTE^LR7OU01(CTR,"P","COM(",ICNT)
"RTN","LR7OV0",36,0)
 Q
"RTN","LR7OV0",37,0)
MFI(EVENT) ;MFI component
"RTN","LR7OV0",38,0)
 ;EVENT=REP for initial population of orderables
"RTN","LR7OV0",39,0)
 ;     =UPD for subsequent updates
"RTN","LR7OV0",40,0)
 S MFI="MFI|60^Lab Test^99DD||"_EVENT_"|||NE"
"RTN","LR7OV0",41,0)
 Q MFI
"RTN","LR7OV0",42,0)
SINGLE(TEST,MFICODE,MFECODE) ;Message for a single test
"RTN","LR7OV0",43,0)
 ;TEST= ptr to test in file 60
"RTN","LR7OV0",44,0)
 ;MFICODE=File Level Event Code
"RTN","LR7OV0",45,0)
 ;MFECODE=Record Level Event Code
"RTN","LR7OV0",46,0)
 ;N X,ORUPDMSG,MSG
"RTN","LR7OV0",47,0)
 S MSG="ORUPDMSG",X=$$MSH^LR7OU0("MFN"),ORUPDMSG(1)=X
"RTN","LR7OV0",48,0)
 S X=$$MFI(MFICODE),ORUPDMSG(2)=X
"RTN","LR7OV0",49,0)
 D TEST(TEST,2)
"RTN","LR7OV0",50,0)
 ;W !!,$P(^LAB(60,TEST,0),"^"),! I $D(ORUPDMSG(3)) ZW ORUPDMSG
"RTN","LR7OV0",51,0)
 I $D(ORUPDMSG(3)) S ORUPDMSG="ORUPDMSG" D MSG^XQOR("LR7O ORDERABLE OR",.ORUPDMSG) ;Send update message
"RTN","LR7OV0",52,0)
 Q
"RTN","LR7OV0",53,0)
ADD(TEST) ;Add single record to Master file
"RTN","LR7OV0",54,0)
 N MFICODE,MFECODE S MFECODE="MAD",MFICODE="REP" D SINGLE(TEST,MFICODE,MFECODE)
"RTN","LR7OV0",55,0)
 Q
"RTN","LR7OV0",56,0)
DEL(TEST) ;Delete single record from Master file
"RTN","LR7OV0",57,0)
 N MFICODE,MFECODE S MFECODE="MDL",MFICODE="UPD" D SINGLE(TEST,MFICODE,MFECODE)
"RTN","LR7OV0",58,0)
 Q
"RTN","LR7OV0",59,0)
UPD(TEST) ;Update record in Master file
"RTN","LR7OV0",60,0)
 ;Modified for patch LR*5.2*361
"RTN","LR7OV0",61,0)
 N ZTSAVE,ZTRTN,ZTDESC,ZTDTH,ZTIO
"RTN","LR7OV0",62,0)
 S ZTSAVE("TEST")=TEST
"RTN","LR7OV0",63,0)
 S ZTRTN="TUPD^LR7OV0"
"RTN","LR7OV0",64,0)
 S ZTDESC="LABORATORY TEST FILE HL7 update message"
"RTN","LR7OV0",65,0)
 S ZTDTH=$H
"RTN","LR7OV0",66,0)
 S ZTIO=""
"RTN","LR7OV0",67,0)
 D ^%ZTLOAD
"RTN","LR7OV0",68,0)
 Q
"RTN","LR7OV0",69,0)
TUPD ;Tasked update of record in Master file
"RTN","LR7OV0",70,0)
 ;Added for patch LR*5.2*361
"RTN","LR7OV0",71,0)
 N MFICODE,MFECODE S MFECODE="MUP",MFICODE="UPD" D SINGLE(TEST,MFICODE,MFECODE)
"RTN","LR7OV0",72,0)
 Q
"RTN","LR7OV0",73,0)
DEACT(TEST) ;Deactivate record in Master file
"RTN","LR7OV0",74,0)
 N MFICODE,MFECODE S MFECODE="MDC",MFICODE="UPD" D SINGLE(TEST,MFICODE,MFECODE)
"RTN","LR7OV0",75,0)
 Q
"RTN","LR7OV0",76,0)
REACT(TEST) ;Reactivate record in Master file
"RTN","LR7OV0",77,0)
 N MFICODE,MFECODE S MFECODE="MAC",MFICODE="UPD" D SINGLE(TEST,MFICODE,MFECODE)
"RTN","LR7OV0",78,0)
 Q
"RTN","LR7OV0",79,0)
 ;Following code added to support LR*5.2*357
"RTN","LR7OV0",80,0)
 ;Following code modified to support LR*5.2*361
"RTN","LR7OV0",81,0)
 ;Designed to help update the ORDERABLE ITEMS FILE (file 101.43) after the deletion
"RTN","LR7OV0",82,0)
 ;of a SYNONYM from the LABORATORY TEST file (file 60).
"RTN","LR7OV0",83,0)
UPD2(TEST,KSYN) ;Update record in Master file - Modified for LR*5.2*361
"RTN","LR7OV0",84,0)
 ;TEST = IEN of lab test in file 60
"RTN","LR7OV0",85,0)
 ;KSYN = IEN of synonym to be deleted from lab test in file 60
"RTN","LR7OV0",86,0)
 ;Modified for LR*5.2*361
"RTN","LR7OV0",87,0)
 N ZTSAVE,ZTRTN,ZTDESC,ZTDTH,ZTIO
"RTN","LR7OV0",88,0)
 S ZTSAVE("TEST")=TEST
"RTN","LR7OV0",89,0)
 S ZTSAVE("KSYN")=KSYN
"RTN","LR7OV0",90,0)
 S ZTRTN="TUPD2^LR7OV0"
"RTN","LR7OV0",91,0)
 S ZTDESC="LABORATORY TEST FILE HL7 update message"
"RTN","LR7OV0",92,0)
 S ZTDTH=$H
"RTN","LR7OV0",93,0)
 S ZTIO=""
"RTN","LR7OV0",94,0)
 D ^%ZTLOAD
"RTN","LR7OV0",95,0)
 Q
"RTN","LR7OV0",96,0)
TUPD2 ;Update record in Master file
"RTN","LR7OV0",97,0)
 ;TEST = IEN of lab test in file 60
"RTN","LR7OV0",98,0)
 ;KSYN = IEN of synonym to be deleted from lab test in file 60
"RTN","LR7OV0",99,0)
 N MFICODE,MFECODE S MFECODE="MUP",MFICODE="UPD" D SINGLE2(TEST,KSYN,MFICODE,MFECODE)
"RTN","LR7OV0",100,0)
 Q
"RTN","LR7OV0",101,0)
SINGLE2(TEST,KSYN,MFICODE,MFECODE) ;Message for a single test
"RTN","LR7OV0",102,0)
 ;TEST = IEN of lab test in file 60
"RTN","LR7OV0",103,0)
 ;KSYN = IEN of synonym to be deleted from lab test in file 60
"RTN","LR7OV0",104,0)
 ;MFICODE = File Level Event Code
"RTN","LR7OV0",105,0)
 ;MFECODE = Record Level Event Code
"RTN","LR7OV0",106,0)
 N X,ORUPDMSG,MSG
"RTN","LR7OV0",107,0)
 S MSG="ORUPDMSG",X=$$MSH^LR7OU0("MFN"),ORUPDMSG(1)=X
"RTN","LR7OV0",108,0)
 S X=$$MFI(MFICODE),ORUPDMSG(2)=X
"RTN","LR7OV0",109,0)
 D TEST2(TEST,KSYN,2)
"RTN","LR7OV0",110,0)
 I $D(ORUPDMSG(3)) S ORUPDMSG="ORUPDMSG" D MSG^XQOR("LR7O ORDERABLE OR",.ORUPDMSG) ;Send update message
"RTN","LR7OV0",111,0)
 Q
"RTN","LR7OV0",112,0)
TEST2(TEST,KSYN,ICNT) ;Process single test
"RTN","LR7OV0",113,0)
 ;TEST = IEN of lab test in file 60
"RTN","LR7OV0",114,0)
 ;KSYN = IEN of synonym to be deleted from lab test in file 60
"RTN","LR7OV0",115,0)
 ;ICNT = Current counter in ORUPDMSG(ICNT)
"RTN","LR7OV0",116,0)
 N TYPE,TESTID,IFN,IFN1,CTR,CTR1,GENW,X0,S0,SAMP,MAX,DMAX,COLLECT,SAMPLE,SPEC,SYN,COST,Y9,Y10,Y11
"RTN","LR7OV0",117,0)
 Q:'$D(^LAB(60,TEST,0))  S X0=^(0),COST=$P(X0,"^",11),SUB=$P(X0,"^",4),TYPE=$P(X0,"^",3),CTR1=0
"RTN","LR7OV0",118,0)
 I $D(^LAB(60,TEST,6)) S (CTR,IFN)=0 F  S IFN=$O(^LAB(60,TEST,6,IFN)) Q:IFN<1  S CTR=CTR+1,GENW(CTR)=^(IFN,0)
"RTN","LR7OV0",119,0)
 S (CTR,IFN)=0 F  S IFN=$O(^LAB(60,TEST,5,IFN)) Q:IFN<1  D
"RTN","LR7OV0",120,0)
 . S:KSYN'=IFN CTR=CTR+1,SYN(CTR)=^LAB(60,TEST,5,IFN,0)
"RTN","LR7OV0",121,0)
 S (Y9,Y10,Y11)="" I $P($G(^LAB(60,TEST,64)),"^") S Y9=$P(^(64),"^"),Y10=$P(^LAM(Y9,0),"^"),Y9=$P(^(0),"^",2),Y11="99NLT"
"RTN","LR7OV0",122,0)
 D
"RTN","LR7OV0",123,0)
 . S (COLLECT,SAMP,SPEC)=0,TESTID=$$UVID^LR7OU0(TEST,+SPEC,Y9,Y11,Y10,"ORUPDMSG"),ICNT=ICNT+1,ORUPDMSG(ICNT)=$$MFE(MFECODE,TESTID)
"RTN","LR7OV0",124,0)
 . S ICNT=ICNT+1,ORUPDMSG(ICNT)=$$ZLR("","",CTR1,SUB,"","",COST,TYPE)
"RTN","LR7OV0",125,0)
 . S IFN1=0 F  S IFN1=$O(^LAB(60,TEST,2,IFN1)) Q:IFN1<1  S X=^(IFN1,0) I $D(^LAB(60,+X,0)) D
"RTN","LR7OV0",126,0)
 .. N Y9,Y10,Y11 S (Y9,Y10,Y11)="" I $P($G(^LAB(60,+X,64)),"^") S Y9=$P(^(64),"^"),Y10=$P(^LAM(Y9,0),"^"),Y9=$P(^(0),"^",2),Y11="99NLT"
"RTN","LR7OV0",127,0)
 .. S SUBID=$$UVID^LR7OU0($P(X,"^"),"",Y9,Y11,Y10,"ORUPDMSG"),ICNT=ICNT+1,ORUPDMSG(ICNT)="ZLC||||"_SUBID
"RTN","LR7OV0",128,0)
 . D ZSY(.SYN),NTE(.GENW,.WCOM)
"RTN","LR7OV0",129,0)
 Q
"VER")
8.0^22.0
"BLD",6857,6)
^273
**END**
**END**
