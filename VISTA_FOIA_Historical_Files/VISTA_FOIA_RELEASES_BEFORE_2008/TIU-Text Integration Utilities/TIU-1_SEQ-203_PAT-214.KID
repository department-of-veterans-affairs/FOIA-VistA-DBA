Released TIU*1*214 SEQ #203
Extracted from mail message
**KIDS**:TIU*1.0*214^

**INSTALL NAME**
TIU*1.0*214
"BLD",6821,0)
TIU*1.0*214^TEXT INTEGRATION UTILITIES^0^3060706^y
"BLD",6821,1,0)
^^2^2^3060706^
"BLD",6821,1,1,0)
Report on and optionally fix mismatched ID notes. Report on parent notes 
"BLD",6821,1,2,0)
that may not be an id note.
"BLD",6821,4,0)
^9.64PA^^
"BLD",6821,6)
1^
"BLD",6821,"ABPKG")
n
"BLD",6821,"KRN",0)
^9.67PA^8989.52^19
"BLD",6821,"KRN",.4,0)
.4
"BLD",6821,"KRN",.401,0)
.401
"BLD",6821,"KRN",.402,0)
.402
"BLD",6821,"KRN",.403,0)
.403
"BLD",6821,"KRN",.5,0)
.5
"BLD",6821,"KRN",.84,0)
.84
"BLD",6821,"KRN",3.6,0)
3.6
"BLD",6821,"KRN",3.8,0)
3.8
"BLD",6821,"KRN",9.2,0)
9.2
"BLD",6821,"KRN",9.8,0)
9.8
"BLD",6821,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6821,"KRN",9.8,"NM",1,0)
TIU214^^0^B79884250
"BLD",6821,"KRN",9.8,"NM","B","TIU214",1)

"BLD",6821,"KRN",19,0)
19
"BLD",6821,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",6821,"KRN",19,"NM",1,0)
TIU MAIN MENU MGR^^3
"BLD",6821,"KRN",19,"NM",2,0)
TIU MISMATCHED ID NOTES^^0
"BLD",6821,"KRN",19,"NM","B","TIU MAIN MENU MGR",1)

"BLD",6821,"KRN",19,"NM","B","TIU MISMATCHED ID NOTES",2)

"BLD",6821,"KRN",19.1,0)
19.1
"BLD",6821,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",6821,"KRN",101,0)
101
"BLD",6821,"KRN",409.61,0)
409.61
"BLD",6821,"KRN",771,0)
771
"BLD",6821,"KRN",870,0)
870
"BLD",6821,"KRN",8989.51,0)
8989.51
"BLD",6821,"KRN",8989.52,0)
8989.52
"BLD",6821,"KRN",8994,0)
8994
"BLD",6821,"KRN","B",.4,.4)

"BLD",6821,"KRN","B",.401,.401)

"BLD",6821,"KRN","B",.402,.402)

"BLD",6821,"KRN","B",.403,.403)

"BLD",6821,"KRN","B",.5,.5)

"BLD",6821,"KRN","B",.84,.84)

"BLD",6821,"KRN","B",3.6,3.6)

"BLD",6821,"KRN","B",3.8,3.8)

"BLD",6821,"KRN","B",9.2,9.2)

"BLD",6821,"KRN","B",9.8,9.8)

"BLD",6821,"KRN","B",19,19)

"BLD",6821,"KRN","B",19.1,19.1)

"BLD",6821,"KRN","B",101,101)

"BLD",6821,"KRN","B",409.61,409.61)

"BLD",6821,"KRN","B",771,771)

"BLD",6821,"KRN","B",870,870)

"BLD",6821,"KRN","B",8989.51,8989.51)

"BLD",6821,"KRN","B",8989.52,8989.52)

"BLD",6821,"KRN","B",8994,8994)

"BLD",6821,"QUES",0)
^9.62^^
"BLD",6821,"REQB",0)
^9.611^^
"KRN",19,10823,-1)
3^1
"KRN",19,10823,0)
TIU MAIN MENU MGR^Text Integration Utilities (MIS Manager)^^M^^^^^^^y^TEXT INTEGRATION UTILITIES^^1^^^1
"KRN",19,10823,1,0)
^19.06^1^1^3060331^^^^
"KRN",19,10823,1,1,0)
Main Text Integration Utilities menu for MIS Managers.
"KRN",19,10823,10,0)
^19.01IP^20^20
"KRN",19,10823,10,20,0)
12911^13^13
"KRN",19,10823,10,20,"^")
TIU MISMATCHED ID NOTES
"KRN",19,10823,15)

"KRN",19,10823,20)
S GMRPEN=1 D EDITSAVE^TIUEDI2(.DUZ)
"KRN",19,10823,26)
W !!,$$CENTER^TIULS("--- MIS Managers Menu ---")
"KRN",19,10823,99)
60452,31499
"KRN",19,10823,99.1)
60332,59035
"KRN",19,10823,"U")
TEXT INTEGRATION UTILITIES (MI
"KRN",19,12911,-1)
0^2
"KRN",19,12911,0)
TIU MISMATCHED ID NOTES^Mismatched ID Notes^^R^^^^^^^y^TEXT INTEGRATION UTILITIES
"KRN",19,12911,10.1)
Mismatched ID Notes
"KRN",19,12911,25)
EN^TIU214
"KRN",19,12911,"U")
MISMATCHED ID NOTES
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",470,-1)
1^1
"PKG",470,0)
TEXT INTEGRATION UTILITIES^TIU^Text Integration Utilities 
"PKG",470,20,0)
^9.402P^^
"PKG",470,22,0)
^9.49I^1^1
"PKG",470,22,1,0)
1.0^3010801^3010806^66481
"PKG",470,22,1,"PAH",1,0)
214^3060706^101036
"PKG",470,22,1,"PAH",1,1,0)
^^2^2^3060706
"PKG",470,22,1,"PAH",1,1,1,0)
Report on and optionally fix mismatched ID notes. Report on parent notes 
"PKG",470,22,1,"PAH",1,1,2,0)
that may not be an id note.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","TIU214")
0^1^B79884250^n/a
"RTN","TIU214",1,0)
TIU214 ; VMP/JML -  ID NOTES with Mismatched Patients ;3/31/06  ; Compiled March 13, 2006 15:21:26
"RTN","TIU214",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**214**;Jun 20, 1997
"RTN","TIU214",3,0)
 ; Report/Fix ID Documents where the child note points to a parent note for a different patient.
"RTN","TIU214",4,0)
 ; Report only  Documents where the child note points to a parent that may not be an id note. 
"RTN","TIU214",5,0)
 Q
"RTN","TIU214",6,0)
EN ; Build array of mismatched ID documents
"RTN","TIU214",7,0)
 N TIUPRNT,TIUCHILD,TIUPDFN,TIUCDFN,TIUPNAME,TIUCNAME,TIUP0,TIUC0,TIUCAUTH,TIUCTITL,TIUDATA,TIUBAD
"RTN","TIU214",8,0)
 N TIUC12,TIUCEDT,TIUPAUTH,TIUPTITL,TIUP12,TIUPEDT,TIUFIX,Y,DFN,%ZIS,POP,DIR,DIRUT,TIULEN,TIUDUZ
"RTN","TIU214",9,0)
 S DIR(0)="SO^1:REPORT;2:FIX"
"RTN","TIU214",10,0)
 S DIR("L",1)="Report only or Report AND fix the bad pointers?"
"RTN","TIU214",11,0)
 S DIR("L",2)=""
"RTN","TIU214",12,0)
 S DIR("L",3)="1 - Report Only"
"RTN","TIU214",13,0)
 S DIR("L")="2 - Report and Fix"
"RTN","TIU214",14,0)
 S DIR("B")=1
"RTN","TIU214",15,0)
 D ^DIR K DIR
"RTN","TIU214",16,0)
 Q:$G(DIRUT)
"RTN","TIU214",17,0)
 S TIUFIX=$S(Y=2:1,1:0),TIUDUZ=$G(DUZ)
"RTN","TIU214",18,0)
 S %ZIS="Q" D ^%ZIS
"RTN","TIU214",19,0)
 Q:$G(POP)>0
"RTN","TIU214",20,0)
 I $G(IO("Q"))=1 D  Q
"RTN","TIU214",21,0)
 .N ZTRTN,ZTDESC,ZTSAVE
"RTN","TIU214",22,0)
 .S ZTRTN="SEARCH^TIU214",ZTDESC="Mismatched ID Note Report",ZTSAVE("TIU*")=""
"RTN","TIU214",23,0)
 .D ^%ZTLOAD K IO("Q")
"RTN","TIU214",24,0)
SEARCH ;
"RTN","TIU214",25,0)
 K ^TMP("TIU214",$J)
"RTN","TIU214",26,0)
 S ^TMP("TIU214",$J)=0,^TMP("TIU214",$J,"MISMATCH")=0,^TMP("TIU214",$J,"MISSING")=0,^TMP("TIU214",$J,"NONPRNT")=0
"RTN","TIU214",27,0)
 I $E(IOST,1,2)="C-" W @IOF,!!?5,"Searching for Parent/Child ID Notes with mismatched patients...",!!
"RTN","TIU214",28,0)
 S TIUPRNT=0
"RTN","TIU214",29,0)
 F  S TIUPRNT=$O(^TIU(8925,"GDAD",TIUPRNT)) Q:TIUPRNT=""  D
"RTN","TIU214",30,0)
 . S ^TMP("TIU214",$J)=^TMP("TIU214",$J)+1
"RTN","TIU214",31,0)
 . S TIUCHILD=0
"RTN","TIU214",32,0)
 . F  S TIUCHILD=+$O(^TIU(8925,"GDAD",TIUPRNT,TIUCHILD)) Q:'TIUCHILD  D
"RTN","TIU214",33,0)
 . . S TIUC0=$G(^TIU(8925,TIUCHILD,0)),TIUCDFN=$P(TIUC0,U,2)
"RTN","TIU214",34,0)
 . . S TIUCNAME=$$PNAME(TIUCDFN)
"RTN","TIU214",35,0)
 . . S TIUCAUTH=$$GET1^DIQ(8925,TIUCHILD_",",1202)
"RTN","TIU214",36,0)
 . . S TIUCTITL=$$GET1^DIQ(8925,TIUCHILD_",",.01)
"RTN","TIU214",37,0)
 . . S TIUC12=$G(^TIU(8925,TIUCHILD,12))
"RTN","TIU214",38,0)
 . . S Y=$P(TIUC12,"^") D DD^%DT S TIUCEDT=Y
"RTN","TIU214",39,0)
 . . S TIUP0=$G(^TIU(8925,TIUPRNT,0)),TIUPDFN=$P(TIUP0,U,2)
"RTN","TIU214",40,0)
 . . I TIUP0="" D  Q
"RTN","TIU214",41,0)
 . . . S ^TMP("TIU214",$J,"MISSING")=^TMP("TIU214",$J,"MISSING")+1
"RTN","TIU214",42,0)
 . . . S ^TMP("TIU214",$J,"MISSING",TIUPRNT,TIUCHILD)=TIUCNAME_"^"_TIUCTITL_"^"_TIUCEDT_"^"_TIUCAUTH
"RTN","TIU214",43,0)
 . . I TIUPDFN'=TIUCDFN  D  Q
"RTN","TIU214",44,0)
 . . . S TIUPNAME=$$PNAME(TIUPDFN)
"RTN","TIU214",45,0)
 . . . S ^TMP("TIU214",$J,"MISMATCH")=^TMP("TIU214",$J,"MISMATCH")+1
"RTN","TIU214",46,0)
 . . . I '$D(^TMP("TIU214",$J,"MISMATCH",TIUPRNT)) D
"RTN","TIU214",47,0)
 . . . . S TIUPAUTH=$$GET1^DIQ(8925,TIUPRNT_",",1202)
"RTN","TIU214",48,0)
 . . . . S TIUPTITL=$$GET1^DIQ(8925,TIUPRNT_",",.01)
"RTN","TIU214",49,0)
 . . . . S TIUP12=$G(^TIU(8925,TIUPRNT,12))
"RTN","TIU214",50,0)
 . . . . S Y=$P(TIUP12,"^") D DD^%DT S TIUPEDT=Y
"RTN","TIU214",51,0)
 . . . . S ^TMP("TIU214",$J,"MISMATCH",TIUPRNT)=TIUPNAME_"^"_TIUPTITL_"^"_TIUPEDT_"^"_TIUPAUTH_"^"_TIUPRNT
"RTN","TIU214",52,0)
 . . . S ^TMP("TIU214",$J,"MISMATCH",TIUPRNT,TIUCHILD)=TIUCNAME_"^"_TIUCTITL_"^"_TIUCEDT_"^"_TIUCAUTH_"^"_TIUCHILD
"RTN","TIU214",53,0)
 . . S TIUBAD="" S TIUBAD=$$POSSPRNT^TIULP(+TIUP0) I '+TIUBAD D  Q
"RTN","TIU214",54,0)
 . . . S ^TMP("TIU214",$J,"NONPRNT")=^TMP("TIU214",$J,"NONPRNT")+1
"RTN","TIU214",55,0)
 . . . S TIUPAUTH=$$GET1^DIQ(8925,TIUPRNT_",",1202)
"RTN","TIU214",56,0)
 . . . S TIUPTITL=$$GET1^DIQ(8925,TIUPRNT_",",.01)
"RTN","TIU214",57,0)
 . . . S TIUP12=$G(^TIU(8925,TIUPRNT,12))
"RTN","TIU214",58,0)
 . . . S Y=$P(TIUP12,"^") D DD^%DT S TIUPEDT=Y
"RTN","TIU214",59,0)
 . . . S ^TMP("TIU214",$J,"NONPRNT",TIUPRNT,TIUCHILD)=TIUCNAME_"^"_TIUPTITL_"^"_TIUPEDT_"^"_TIUPAUTH_"^"_TIUPRNT_"^"_TIUCTITL
"RTN","TIU214",60,0)
 D REPORT
"RTN","TIU214",61,0)
 D MAIL
"RTN","TIU214",62,0)
 K ^TMP("TIU214",$J)
"RTN","TIU214",63,0)
 D ^%ZISC
"RTN","TIU214",64,0)
 Q
"RTN","TIU214",65,0)
REPORT ;
"RTN","TIU214",66,0)
 U IO
"RTN","TIU214",67,0)
 N TIUQUIT,TIUHIDE,TIUCINFO,TIUPINFO,TIUSHOW
"RTN","TIU214",68,0)
 S TIUQUIT=0,TIUSHOW=$S(IOST["P-":0,1:1)
"RTN","TIU214",69,0)
 S ^TMP("TIU214",$J,"FIX_MISMATCH_PTR")=0,^TMP("TIU214",$J,"FIX_MISMATCH_XREF")=0
"RTN","TIU214",70,0)
 S ^TMP("TIU214",$J,"FIX_MISSING_PTR")=0,^TMP("TIU214",$J,"FIX_MISSING_XREF")=0
"RTN","TIU214",71,0)
 I IOST["C-" D CLEAR^VALM1
"RTN","TIU214",72,0)
 S TIUDATA=0,TIULEN=$S(IOST["C-":8,1:6)
"RTN","TIU214",73,0)
 I TIUFIX S TIULEN=TIULEN+1
"RTN","TIU214",74,0)
 D HDR1(0)
"RTN","TIU214",75,0)
 S TIUPRNT=""
"RTN","TIU214",76,0)
 F  S TIUPRNT=$O(^TMP("TIU214",$J,"MISMATCH",TIUPRNT)) Q:TIUPRNT=""!(TIUQUIT)  D
"RTN","TIU214",77,0)
 .S TIUPINFO=$G(^TMP("TIU214",$J,"MISMATCH",TIUPRNT))
"RTN","TIU214",78,0)
 .S TIUCHILD=""
"RTN","TIU214",79,0)
 .F  S TIUCHILD=$O(^TMP("TIU214",$J,"MISMATCH",TIUPRNT,TIUCHILD)) Q:TIUCHILD=""!(TIUQUIT)  D
"RTN","TIU214",80,0)
 ..S TIUCINFO=$G(^TMP("TIU214",$J,"MISMATCH",TIUPRNT,TIUCHILD))
"RTN","TIU214",81,0)
 ..I $Y>(IOSL-TIULEN) D PAUSE Q:TIUQUIT  D HDR1(1)
"RTN","TIU214",82,0)
 ..I TIUSHOW D
"RTN","TIU214",83,0)
 ...W !!," Patient: ",$E($P(TIUCINFO,"^",1),1,26)," (",$P(TIUCINFO,"^",2),")"
"RTN","TIU214",84,0)
 ...W ?45,$E($P(TIUPINFO,"^",1),1,26)," (",$P(TIUPINFO,"^",2),")"
"RTN","TIU214",85,0)
 ..I 'TIUSHOW D
"RTN","TIU214",86,0)
 ...W !!," Patient: ",$P(TIUCINFO,"^",2)
"RTN","TIU214",87,0)
 ...W ?45,$P(TIUPINFO,"^",2)
"RTN","TIU214",88,0)
 ..W !,"   Title: ",$E($P(TIUCINFO,"^",3),1,33),?45,$E($P(TIUPINFO,"^",3),1,33)
"RTN","TIU214",89,0)
 ..W !,"Entry DT: ",$E($P(TIUCINFO,"^",4),1,33),?45,$E($P(TIUPINFO,"^",4),1,33)
"RTN","TIU214",90,0)
 ..W !,"  Author: ",$E($P(TIUCINFO,"^",5),1,33),?45,$E($P(TIUPINFO,"^",5),1,33)
"RTN","TIU214",91,0)
 ..W !,"Note IEN: ",$E($P(TIUCINFO,"^",6),1,33),?45,$E($P(TIUPINFO,"^",6),1,33)
"RTN","TIU214",92,0)
 ..I TIUFIX D
"RTN","TIU214",93,0)
 ...I $G(^TIU(8925,TIUCHILD,21))=TIUPRNT D  Q
"RTN","TIU214",94,0)
 ....N DIE,DA,DR
"RTN","TIU214",95,0)
 ....S DIE=8925,DA=TIUCHILD,DR="2101///@" D ^DIE
"RTN","TIU214",96,0)
 ....W !?5,"..... Removed pointer from child to parent."
"RTN","TIU214",97,0)
 ....S ^TMP("TIU214",$J,"FIX_MISMATCH_PTR")=^TMP("TIU214",$J,"FIX_MISMATCH_PTR")+1
"RTN","TIU214",98,0)
 ...I $G(^TIU(8925,TIUCHILD,21))'=TIUPRNT D
"RTN","TIU214",99,0)
 ....K ^TIU(8925,"GDAD",TIUPRNT,TIUCHILD)
"RTN","TIU214",100,0)
 ....W !?5,"..... Child note did not point to parent. GDAD cross reference removed."
"RTN","TIU214",101,0)
 ....S ^TMP("TIU214",$J,"FIX_MISMATCH_XREF")=^TMP("TIU214",$J,"FIX_MISMATCH_XREF")+1
"RTN","TIU214",102,0)
 Q:TIUQUIT
"RTN","TIU214",103,0)
 I TIUDATA D PAUSE Q:TIUQUIT
"RTN","TIU214",104,0)
 S TIUDATA=0,TIULEN=$S(IOST["C-":9,1:7)
"RTN","TIU214",105,0)
 I TIUFIX S TIULEN=TIULEN+1
"RTN","TIU214",106,0)
 D HDR2(1)
"RTN","TIU214",107,0)
 S TIUPRNT=""
"RTN","TIU214",108,0)
 F  S TIUPRNT=$O(^TMP("TIU214",$J,"MISSING",TIUPRNT)) Q:TIUPRNT=""!(TIUQUIT)  D
"RTN","TIU214",109,0)
 .S TIUCHILD=""
"RTN","TIU214",110,0)
 .F  S TIUCHILD=$O(^TMP("TIU214",$J,"MISSING",TIUPRNT,TIUCHILD)) Q:TIUCHILD=""!(TIUQUIT)  D
"RTN","TIU214",111,0)
 ..S TIUCINFO=^TMP("TIU214",$J,"MISSING",TIUPRNT,TIUCHILD)
"RTN","TIU214",112,0)
 ..I $Y>(IOSL-TIULEN) D PAUSE Q:TIUQUIT  D HDR2(1)
"RTN","TIU214",113,0)
 ..W !!,"   Patient: " W:TIUSHOW $P(TIUCINFO,"^",1)," (" W $P(TIUCINFO,"^",2) W:TIUSHOW ")"
"RTN","TIU214",114,0)
 ..W !,"     Title: ",$P(TIUCINFO,"^",3)
"RTN","TIU214",115,0)
 ..W !,"  Entry DT: ",$P(TIUCINFO,"^",4)
"RTN","TIU214",116,0)
 ..W !,"    Author: ",$P(TIUCINFO,"^",5)
"RTN","TIU214",117,0)
 ..W !," Child IEN: ",TIUCHILD
"RTN","TIU214",118,0)
 ..W !,"Parent IEN: ",TIUPRNT
"RTN","TIU214",119,0)
 ..I TIUFIX D
"RTN","TIU214",120,0)
 ...I $G(^TIU(8925,TIUCHILD,21))=TIUPRNT D  Q
"RTN","TIU214",121,0)
 ....N DIE,DA,DR
"RTN","TIU214",122,0)
 ....S DIE=8925,DA=TIUCHILD,DR="2101///@" D ^DIE
"RTN","TIU214",123,0)
 ....W !?5,"..... Removed pointer from child to parent."
"RTN","TIU214",124,0)
 ....S ^TMP("TIU214",$J,"FIX_MISSING_PTR")=^TMP("TIU214",$J,"FIX_MISSING_PTR")+1
"RTN","TIU214",125,0)
 ...I $G(^TIU(8925,TIUCHILD,21))'=TIUPRNT D
"RTN","TIU214",126,0)
 ....K ^TIU(8925,"GDAD",TIUPRNT,TIUCHILD)
"RTN","TIU214",127,0)
 ....W !?5,"..... Child note did not point to parent. GDAD cross reference removed."
"RTN","TIU214",128,0)
 ....S ^TMP("TIU214",$J,"FIX_MISSING_XREF")=^TMP("TIU214",$J,"FIX_MISSING_XREF")+1
"RTN","TIU214",129,0)
 Q:TIUQUIT
"RTN","TIU214",130,0)
 I TIUDATA D PAUSE Q:TIUQUIT
"RTN","TIU214",131,0)
 S TIUDATA=0,TIULEN=$S(IOST["C-":9,1:7)
"RTN","TIU214",132,0)
 D HDR3(1)
"RTN","TIU214",133,0)
 S TIUPRNT=""
"RTN","TIU214",134,0)
 F  S TIUPRNT=$O(^TMP("TIU214",$J,"NONPRNT",TIUPRNT)) Q:TIUPRNT=""!(TIUQUIT)  D
"RTN","TIU214",135,0)
 .S TIUCHILD=""
"RTN","TIU214",136,0)
 .F  S TIUCHILD=$O(^TMP("TIU214",$J,"NONPRNT",TIUPRNT,TIUCHILD)) Q:TIUCHILD=""!(TIUQUIT)  D
"RTN","TIU214",137,0)
 ..S TIUCINFO=^TMP("TIU214",$J,"NONPRNT",TIUPRNT,TIUCHILD)
"RTN","TIU214",138,0)
 ..I $Y>(IOSL-TIULEN) D PAUSE Q:TIUQUIT  D HDR3(1)
"RTN","TIU214",139,0)
 ..W !!,"        Patient: " W:TIUSHOW $P(TIUCINFO,"^",1)," (" W $P(TIUCINFO,"^",2) W:TIUSHOW ")"
"RTN","TIU214",140,0)
 ..W !,"   Parent Title: ",$P(TIUCINFO,"^",3),"-IEN: ",TIUPRNT
"RTN","TIU214",141,0)
 ..W !,"Parent Entry DT: ",$P(TIUCINFO,"^",4)
"RTN","TIU214",142,0)
 ..W !,"  Parent Author: ",$P(TIUCINFO,"^",5)
"RTN","TIU214",143,0)
 ..W !,"    Child Title: ",$P(TIUCINFO,"^",7),"-IEN: ",TIUCHILD
"RTN","TIU214",144,0)
 Q:TIUQUIT
"RTN","TIU214",145,0)
 I TIUDATA D PAUSE Q:TIUQUIT
"RTN","TIU214",146,0)
 W !,@IOF
"RTN","TIU214",147,0)
 W !!?15,"TOTAL COUNTS FOR MISMATCHED ID NOTES"
"RTN","TIU214",148,0)
 W !?15,"------------------------------------",!
"RTN","TIU214",149,0)
 W !?15,+^TMP("TIU214",$J)_" CROSS REFERENCES CHECKED"
"RTN","TIU214",150,0)
 W !?15,+^TMP("TIU214",$J,"MISMATCH")_" MISSMATCHED NOTE(S) FOUND"
"RTN","TIU214",151,0)
 W !?15,+^TMP("TIU214",$J,"MISSING")_" NON EXISTENT PARENT NOTE(S)"
"RTN","TIU214",152,0)
 W !?15,+^TMP("TIU214",$J,"NONPRNT")_" PARENT MAY NOT BE AN ID NOTE"
"RTN","TIU214",153,0)
 I TIUFIX D
"RTN","TIU214",154,0)
 .W !!?15,+^TMP("TIU214",$J,"FIX_MISMATCH_PTR")_" POINTER(S) FIXED FOR MISMATCHED NOTES"
"RTN","TIU214",155,0)
 .W !?15,+^TMP("TIU214",$J,"FIX_MISMATCH_XREF")_" XREF(S) FIXED FOR MISMATCHED NOTES"
"RTN","TIU214",156,0)
 .W !?15,+^TMP("TIU214",$J,"FIX_MISSING_PTR")_" POINTER(S) FIXED FOR MISSING NOTES"
"RTN","TIU214",157,0)
 .W !?15,+^TMP("TIU214",$J,"FIX_MISSING_XREF")_" XREF(S) FIXED FOR MISSING NOTES"
"RTN","TIU214",158,0)
 Q
"RTN","TIU214",159,0)
MAIL ; EMAIL TOTALS TO B.PSI-06-030 TO TRACK COMPLIANCE
"RTN","TIU214",160,0)
 N XMDUZ,XMSUBJ,XMTO,TIUMAIL,%H,Y
"RTN","TIU214",161,0)
 S XMDUZ="",XMSUBJ="MISMATCHED ID NOTES"
"RTN","TIU214",162,0)
 S TIUMAIL(1,0)=$P($$SITE^VASITE(),"^",1,2)
"RTN","TIU214",163,0)
 S %H=$H D YX^%DTC
"RTN","TIU214",164,0)
 S TIUMAIL(2,0)=Y
"RTN","TIU214",165,0)
 S TIUMAIL(3,0)=""
"RTN","TIU214",166,0)
 S TIUMAIL(4,0)=+^TMP("TIU214",$J)_"  CROSS REFERENCES CHECKED"
"RTN","TIU214",167,0)
 S TIUMAIL(5,0)=+^TMP("TIU214",$J,"MISMATCH")_" MISS MATCHED NOTE(S) FOUND"
"RTN","TIU214",168,0)
 S TIUMAIL(6,0)=+^TMP("TIU214",$J,"MISSING")_" NON EXISTENT PARENT NOTE(S)"
"RTN","TIU214",169,0)
 I 'TIUFIX D
"RTN","TIU214",170,0)
 .S TIUMAIL(7,0)=""
"RTN","TIU214",171,0)
 .S TIUMAIL(8,0)="MODE - REPORT ONLY"
"RTN","TIU214",172,0)
 I TIUFIX D
"RTN","TIU214",173,0)
 .S TIUMAIL(7,0)=""
"RTN","TIU214",174,0)
 .S TIUMAIL(8,0)="MODE - REPORT AND FIX"
"RTN","TIU214",175,0)
 .S TIUMAIL(9,0)=+^TMP("TIU214",$J,"FIX_MISMATCH_PTR")_" POINTER(S) FIXED FOR MISMATCHED NOTES"
"RTN","TIU214",176,0)
 .S TIUMAIL(10,0)=+^TMP("TIU214",$J,"FIX_MISMATCH_XREF")_" XREF(S) FIXED FOR MISMATCHED NOTES"
"RTN","TIU214",177,0)
 .S TIUMAIL(11,0)=+^TMP("TIU214",$J,"FIX_MISSING_PTR")_" POINTER(S) FIXED FOR MISSING NOTES"
"RTN","TIU214",178,0)
 .S TIUMAIL(12,0)=+^TMP("TIU214",$J,"FIX_MISSING_XREF")_" XREF(S) FIXED FOR MISSING NOTES"
"RTN","TIU214",179,0)
 S XMTO("G.PSI-06-030@FORUM.VA.GOV")=""
"RTN","TIU214",180,0)
 D SENDMSG^XMXAPI(XMDUZ,XMSUBJ,"TIUMAIL",.XMTO)
"RTN","TIU214",181,0)
 Q
"RTN","TIU214",182,0)
PNAME(PTDFN) ; Return Patient Name & last 4 of SSN
"RTN","TIU214",183,0)
 N TIUSSN,TIUSSN4,TIUNAME,TIUPN,VADM
"RTN","TIU214",184,0)
 I $G(PTDFN)="" Q "UNKNOWN^UNKNOWN"
"RTN","TIU214",185,0)
 ;
"RTN","TIU214",186,0)
 S DFN=PTDFN D DEM^VADPT
"RTN","TIU214",187,0)
 S TIUSSN=$P(VADM(2),"^",2)
"RTN","TIU214",188,0)
 S TIUSSN4=$P(TIUSSN,"-",3)
"RTN","TIU214",189,0)
 S TIUPN=VADM(1)
"RTN","TIU214",190,0)
 I TIUPN'="" S TIUPN=TIUPN_"^"_$E(TIUPN)_TIUSSN4
"RTN","TIU214",191,0)
 I TIUPN="" S TIUPN="UNKNOWN^UNKNOWN"
"RTN","TIU214",192,0)
 Q TIUPN
"RTN","TIU214",193,0)
HDR1(TIUFF) ;
"RTN","TIU214",194,0)
 Q:^TMP("TIU214",$J,"MISMATCH")=0
"RTN","TIU214",195,0)
 S TIUDATA=1
"RTN","TIU214",196,0)
 I TIUFF W @IOF
"RTN","TIU214",197,0)
 W ?18,"MISMATCHED INTERDISCIPLINARY NOTES"
"RTN","TIU214",198,0)
 W !!?10,"CHILD DOCUMENT",?45,"PARENT DOCUMENT"
"RTN","TIU214",199,0)
 W !?10,"---------------",?45,"--------------" Q
"RTN","TIU214",200,0)
HDR2(TIUFF) ;
"RTN","TIU214",201,0)
 Q:^TMP("TIU214",$J,"MISSING")=0
"RTN","TIU214",202,0)
 S TIUDATA=1
"RTN","TIU214",203,0)
 I TIUFF W @IOF
"RTN","TIU214",204,0)
 W !?11,"CHILD ID NOTES POINTING TO A NON-EXISTENT PARENT ID NOTE" Q
"RTN","TIU214",205,0)
HDR3(TIUFF) ;
"RTN","TIU214",206,0)
 Q:^TMP("TIU214",$J,"NONPRNT")=0
"RTN","TIU214",207,0)
 S TIUDATA=1
"RTN","TIU214",208,0)
 I TIUFF W @IOF
"RTN","TIU214",209,0)
 W !?11,"CHILD ID NOTES POINTING TO A PARENT THAT MAY NOT BE AN ID NOTE"
"RTN","TIU214",210,0)
 W !!?11,"** NOTE: THIS IS AN INFORMATIONAL LIST FOR INVESTIGATION.",!?11,"  NOTHING WILL BE FIXED **" Q
"RTN","TIU214",211,0)
PAUSE ;
"RTN","TIU214",212,0)
 I IOST["C-" D
"RTN","TIU214",213,0)
 .N DIRUT,DIR
"RTN","TIU214",214,0)
 .W ! S DIR(0)="E" D ^DIR K DIR
"RTN","TIU214",215,0)
 .I $G(DIRUT)=1 S TIUQUIT=1
"RTN","TIU214",216,0)
 Q
"VER")
8.0^22.0
"BLD",6821,6)
^203
**END**
**END**
