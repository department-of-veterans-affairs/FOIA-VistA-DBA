KIDS Distribution saved on Mar 23, 2006@11:19:39
HINQ
**KIDS**:DVB*4.0*57^DG*5.3*709^

**INSTALL NAME**
DVB*4.0*57
"BLD",6097,0)
DVB*4.0*57^HINQ^0^3060323^y
"BLD",6097,4,0)
^9.64PA^2^1
"BLD",6097,4,2,0)
2
"BLD",6097,4,2,2,0)
^9.641^2.04^1
"BLD",6097,4,2,2,2.04,0)
RATED DISABILITIES (VA)  (sub-file)
"BLD",6097,4,2,2,2.04,1,0)
^9.6411^6^3
"BLD",6097,4,2,2,2.04,1,4,0)
EXTREMITY AFFECTED
"BLD",6097,4,2,2,2.04,1,5,0)
ORIGINAL EFFECTIVE DATE
"BLD",6097,4,2,2,2.04,1,6,0)
CURRENT EFFECTIVE DATE
"BLD",6097,4,2,222)
y^n^p^^^^n^^n
"BLD",6097,4,2,224)

"BLD",6097,4,"APDD",2,2.04)

"BLD",6097,4,"APDD",2,2.04,4)

"BLD",6097,4,"APDD",2,2.04,5)

"BLD",6097,4,"APDD",2,2.04,6)

"BLD",6097,4,"B",2,2)

"BLD",6097,"KRN",0)
^9.67PA^8989.52^19
"BLD",6097,"KRN",.4,0)
.4
"BLD",6097,"KRN",.401,0)
.401
"BLD",6097,"KRN",.402,0)
.402
"BLD",6097,"KRN",.403,0)
.403
"BLD",6097,"KRN",.5,0)
.5
"BLD",6097,"KRN",.84,0)
.84
"BLD",6097,"KRN",3.6,0)
3.6
"BLD",6097,"KRN",3.8,0)
3.8
"BLD",6097,"KRN",9.2,0)
9.2
"BLD",6097,"KRN",9.8,0)
9.8
"BLD",6097,"KRN",9.8,"NM",0)
^9.68A^7^7
"BLD",6097,"KRN",9.8,"NM",1,0)
DVBHIQM^^0^B24918606
"BLD",6097,"KRN",9.8,"NM",2,0)
DVBHIQR^^0^B12418631
"BLD",6097,"KRN",9.8,"NM",3,0)
DVBHQD1^^0^B24138320
"BLD",6097,"KRN",9.8,"NM",4,0)
DVBHQDX^^0^B11282698
"BLD",6097,"KRN",9.8,"NM",5,0)
DVBHQST^^0^B25726752
"BLD",6097,"KRN",9.8,"NM",6,0)
DVBHQZ6^^0^B24643397
"BLD",6097,"KRN",9.8,"NM",7,0)
DVBHT1^^0^B23023356
"BLD",6097,"KRN",9.8,"NM","B","DVBHIQM",1)

"BLD",6097,"KRN",9.8,"NM","B","DVBHIQR",2)

"BLD",6097,"KRN",9.8,"NM","B","DVBHQD1",3)

"BLD",6097,"KRN",9.8,"NM","B","DVBHQDX",4)

"BLD",6097,"KRN",9.8,"NM","B","DVBHQST",5)

"BLD",6097,"KRN",9.8,"NM","B","DVBHQZ6",6)

"BLD",6097,"KRN",9.8,"NM","B","DVBHT1",7)

"BLD",6097,"KRN",19,0)
19
"BLD",6097,"KRN",19.1,0)
19.1
"BLD",6097,"KRN",101,0)
101
"BLD",6097,"KRN",409.61,0)
409.61
"BLD",6097,"KRN",771,0)
771
"BLD",6097,"KRN",870,0)
870
"BLD",6097,"KRN",8989.51,0)
8989.51
"BLD",6097,"KRN",8989.52,0)
8989.52
"BLD",6097,"KRN",8994,0)
8994
"BLD",6097,"KRN","B",.4,.4)

"BLD",6097,"KRN","B",.401,.401)

"BLD",6097,"KRN","B",.402,.402)

"BLD",6097,"KRN","B",.403,.403)

"BLD",6097,"KRN","B",.5,.5)

"BLD",6097,"KRN","B",.84,.84)

"BLD",6097,"KRN","B",3.6,3.6)

"BLD",6097,"KRN","B",3.8,3.8)

"BLD",6097,"KRN","B",9.2,9.2)

"BLD",6097,"KRN","B",9.8,9.8)

"BLD",6097,"KRN","B",19,19)

"BLD",6097,"KRN","B",19.1,19.1)

"BLD",6097,"KRN","B",101,101)

"BLD",6097,"KRN","B",409.61,409.61)

"BLD",6097,"KRN","B",771,771)

"BLD",6097,"KRN","B",870,870)

"BLD",6097,"KRN","B",8989.51,8989.51)

"BLD",6097,"KRN","B",8989.52,8989.52)

"BLD",6097,"KRN","B",8994,8994)

"BLD",6097,"QUES",0)
^9.62^^
"BLD",6097,"REQB",0)
^9.611^2^2
"BLD",6097,"REQB",1,0)
DVB*4.0*32^2
"BLD",6097,"REQB",2,0)
DVB*4.0*49^2
"BLD",6097,"REQB","B","DVB*4.0*32",1)

"BLD",6097,"REQB","B","DVB*4.0*49",2)

"FIA",2)
PATIENT
"FIA",2,0)
^DPT(
"FIA",2,0,0)
2I
"FIA",2,0,1)
y^n^p^^^^n^^n
"FIA",2,0,10)

"FIA",2,0,11)

"FIA",2,0,"RLRO")

"FIA",2,0,"VR")
4.0^DVB
"FIA",2,2)
1
"FIA",2,2.04)
1
"FIA",2,2.04,4)

"FIA",2,2.04,5)

"FIA",2,2.04,6)

"MBREQ")
0
"PKG",119,-1)
1^1
"PKG",119,0)
HINQ^DVB^HINQ(Hospital Inquiry)
"PKG",119,20,0)
^9.402P^^
"PKG",119,22,0)
^9.49I^1^1
"PKG",119,22,1,0)
4.0^2930615^2920421
"PKG",119,22,1,"PAH",1,0)
57^3060323
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","DVBHIQM")
0^1^B24918606
"RTN","DVBHIQM",1,0)
DVBHIQM ;ISC-ALBANY/PKE,DLM,PHH/WASH-MAIL DELIVERY PROGRAM ; 3/23/06 7:41am
"RTN","DVBHIQM",2,0)
 ;;4.0;HINQ;**49,57**;03/25/92
"RTN","DVBHIQM",3,0)
 G EN
"RTN","DVBHIQM",4,0)
LIN Q:CT>50  S CT=CT+1,A1=A_CT_",0)",@A1=T1 Q
"RTN","DVBHIQM",5,0)
DD S:Y Y=$S($E(Y,4,5):$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC","^",+$E(Y,4,5))_" ",1:"")_$S($E(Y,6,7):+$E(Y,6,7)_",",1:"")_($E(Y,1,3)+1700)_$P("@"_$E(Y_0,9,10)_":"_$E(Y_"000",11,12),"^",Y[".") Q
"RTN","DVBHIQM",6,0)
 ;
"RTN","DVBHIQM",7,0)
EN I $D(X(1)),$E(X(1),1,5)'="ERROR" S DFN=$E(X(1),8,21),XMDUZ=.5,XMSUB="HINQ response for " I DFN?14"0" S DFN=0,XMSUB="HINQ Transaction Test "
"RTN","DVBHIQM",8,0)
 I DFN'?14" " K DVBREQST
"RTN","DVBHIQM",9,0)
 S DFN=+DFN I $D(DUZ) S XMORIG=DUZ
"RTN","DVBHIQM",10,0)
 E  QUIT
"RTN","DVBHIQM",11,0)
 I '+XMORIG QUIT
"RTN","DVBHIQM",12,0)
 ;
"RTN","DVBHIQM",13,0)
 S (DVBASK,DVBASKER)=0
"RTN","DVBHIQM",14,0)
 I DFN=0 G SUBJ
"RTN","DVBHIQM",15,0)
 ;
"RTN","DVBHIQM",16,0)
MAILGP K XMY,DVBXMY
"RTN","DVBHIQM",17,0)
 I $D(^XMB(3.8,"B","DVBHINQ")) S N=0,N=$O(^("DVBHINQ",N)) Q:'N  F DVBU=0:0 S DVBU=$O(^XMB(3.8,N,1,"B",DVBU)) Q:'DVBU  S XMY(DVBU)=""
"RTN","DVBHIQM",18,0)
REQ ;
"RTN","DVBHIQM",19,0)
 ;replace direct global lookup of div with GETS^DIQ - DVB*4*49
"RTN","DVBHIQM",20,0)
 I $D(^DVB(395.5,DFN,0)) D
"RTN","DVBHIQM",21,0)
 . N DVBARR,DVBERR
"RTN","DVBHIQM",22,0)
 . D GETS^DIQ(395.5,DFN_",",9,"E","DVBARR","DVBERR")
"RTN","DVBHIQM",23,0)
 . S DVBDIV=$G(DVBARR(395.5,DFN_",",9,"E"))
"RTN","DVBHIQM",24,0)
 F DVBU=0:0 S DVBU=$O(^DVB(395.5,DFN,1,DVBU)) Q:'DVBU  S:$D(^(DVBU,0)) DVBXMY(DVBU)=$P(^(0),U,2) ;for latest requestor dvbasker
"RTN","DVBHIQM",25,0)
 I '$D(DVBDIV) K DVBDIV
"RTN","DVBHIQM",26,0)
 ;
"RTN","DVBHIQM",27,0)
 F DVBU=0:0 S DVBU=$O(DVBXMY(DVBU)) Q:'DVBU  I $D(^XUSEC("DVBHINQ",DVBU)) S XMY(DVBU)="" I DVBXMY(DVBU)>DVBASK S DVBASK=DVBXMY(DVBU),DVBASKER=DVBU
"RTN","DVBHIQM",28,0)
 ;
"RTN","DVBHIQM",29,0)
SUBJ S U="^",XMY(XMORIG)="",XMSUB=XMSUB_$S($D(^DPT(DFN,0)):$P(^(0),"^",1),1:" ")_" /requested by "_$S(DVBASKER:$S($D(^VA(200,DVBASKER,0)):$P(^(0),U),1:""),1:"")_$S('DVBASKER:$S($D(^VA(200,DUZ,0)):$P(^(0),U),1:""),1:"")
"RTN","DVBHIQM",30,0)
 ;
"RTN","DVBHIQM",31,0)
 K ^TMP($J) S CT=0,(A,XMTEXT)="^TMP($J,",BL="",$P(BL," ",36)=" "
"RTN","DVBHIQM",32,0)
 ;
"RTN","DVBHIQM",33,0)
 I $D(DVBREQST) S Y=DVBREQST D DATA,LIN,SEGM S T1="" D LIN
"RTN","DVBHIQM",34,0)
 ;
"RTN","DVBHIQM",35,0)
 I $D(^DPT(DFN,0)) D DPT,LIN,WARN,SEGM
"RTN","DVBHIQM",36,0)
 ;
"RTN","DVBHIQM",37,0)
 K DVBDIV,DVBREQST,DVBASK,DVBASKER,T9,L1,F1,F2,F3,F3,F4,F5,Y,S,S1,C,DVBXMY,DVBU,N
"RTN","DVBHIQM",38,0)
 ;exit point for errors
"RTN","DVBHIQM",39,0)
 I $D(DVBERR) S T1="       HINQ Error = "_DVBERR D LIN
"RTN","DVBHIQM",40,0)
 I $D(DVBERR) D ERR1
"RTN","DVBHIQM",41,0)
 I $D(DVBERR1) S T1="       Inquiry Data Submitted = "_DVBERR1 D LIN G ERR^DVBHQM3
"RTN","DVBHIQM",42,0)
 I $D(DVBOTM),$D(DVBNETER) S Y=DVBOTM D DD S T1=" Message out Time => "_Y D LIN
"RTN","DVBHIQM",43,0)
 I $D(DVBNETER) S T1=" IDCU Network Error" D LIN S T1=" "_DVBNETER D LIN I $D(DVBREQUE) S Y=DVBREQUE D DD S T1=" "_"Request has been retransmitted"_$S($L(DVBREQUE):" at "_Y,1:"") D LIN G ERR^DVBHQM3
"RTN","DVBHIQM",44,0)
 I $D(DVBNETER),'$D(DVBREQUE) S T1=" Request NOT retransmitted" D LIN G ERR^DVBHQM3
"RTN","DVBHIQM",45,0)
 S:X(1)["HINQ" X(1)=$E(X(1),1,6) S:$D(X(2)) X(2)=$E(X(2),1,6)
"RTN","DVBHIQM",46,0)
 ;
"RTN","DVBHIQM",47,0)
 G:$D(DVBABREV) EN^DVBHQM4
"RTN","DVBHIQM",48,0)
 G EN^DVBHQM1
"RTN","DVBHIQM",49,0)
 ;
"RTN","DVBHIQM",50,0)
DPT S (S,C,T9)=""
"RTN","DVBHIQM",51,0)
 S T1=$P(^DPT(DFN,0),U),Y=$P(^(0),U,3),T9=$P(^(0),U,9) D DD S T1=T1_" "_Y_" SSN:"_T9 S:$D(^(.31)) C=$P(^(.31),U,3) S:$D(^(.32)) S=$P(^(.32),U,8) S T1=T1_$S($L(C):" C-#:"_C,1:"")_$S($L(S):" S-#:"_S,1:"")_$S($D(DVBDIV):" Div:"_DVBDIV,1:"") Q
"RTN","DVBHIQM",52,0)
 ;
"RTN","DVBHIQM",53,0)
WARN Q:$D(DVBABREV)  ;don't compare multiple values for abrev return
"RTN","DVBHIQM",54,0)
 I $L(T9),$D(DVBSSN),DVBSSN?9N,+DVBSSN'=+T9 S T1="***  SSN from patient file does not match SSN from VBA  ***" D LIN
"RTN","DVBHIQM",55,0)
 I $L(C),$D(DVBCN),+DVBCN'=+C S T1="***  C-# from patient file does not match C-# from VBA  ***" D LIN
"RTN","DVBHIQM",56,0)
 I $L(S),$D(DVBSN)>9 S S1=1 F N=0:0 S N=$O(DVBSN(N)) Q:'N  I +DVBSN(N)=+S K S1 Q
"RTN","DVBHIQM",57,0)
 I $D(S1) S T1="***  S-# from Patient file does not match a S-# from VBA  ***" D LIN
"RTN","DVBHIQM",58,0)
 Q
"RTN","DVBHIQM",59,0)
 ;
"RTN","DVBHIQM",60,0)
SEGM Q:'$D(DVBBAS(2))
"RTN","DVBHIQM",61,0)
 I '$P(DVBBAS(2),U,35),'$P(DVBBAS(2),U,36),'$P(DVBBAS(2),U,37),'$P(DVBBAS(2),U,38) Q
"RTN","DVBHIQM",62,0)
 S T1="   WARNING: Error Indicators for " F N=38:-1:35 I $P(DVBBAS(2),U,N) S T1=T1_" "_$S(N=38:"BASIC",N=37:"STATISTICAL",N=36:"DIAGNOSTIC",N=35:"FUTURE",1:"")_","
"RTN","DVBHIQM",63,0)
 S T1=$E(T1,1,$L(T1)-1) D LIN
"RTN","DVBHIQM",64,0)
 Q
"RTN","DVBHIQM",65,0)
 ;
"RTN","DVBHIQM",66,0)
DATA S F1=$F(Y,"NM"),F2=$F(Y,"/",F1),F3=$F(Y,"SS",F2),F4=$F(Y,"CN",F2),F5=$F(Y,"SN",F2),T1=" Data Requested:"_$S(F1:" "_$E(Y,3,F2-2),1:"")_$S(F3:"  SS# "_$E(Y,F3,F3+8),1:"")_$S(F4:"  C# "_$E(Y,F4,F4+8),1:"")_$S(F5:"  S# "_$E(Y,F5,F5+8),1:"") Q
"RTN","DVBHIQM",67,0)
ERR1 ;set inquiry info into error text
"RTN","DVBHIQM",68,0)
 N DVBZZ,DVBZZZ
"RTN","DVBHIQM",69,0)
 S DVBZZZ=""
"RTN","DVBHIQM",70,0)
 S DVBZZ=$S($G(DVBZ)]"":DVBZ,$G(DVBZ0)]"":DVBZ0,$G(DVBZ1)]"":DVBZ1,1:"")
"RTN","DVBHIQM",71,0)
 ;DVB*4*54 - strip password from string before creating err msg- ERC
"RTN","DVBHIQM",72,0)
 I $G(DVBZZ)]"",$E(DVBZZ,$L(DVBZZ)-3,$L(DVBZZ))?4U S DVBZZ=$E(DVBZZ,1,$L(DVBZZ)-4)
"RTN","DVBHIQM",73,0)
 I DVBZZ["SS" S DVBZZZ="SS"_$E($P(DVBZZ,"SS",2),1,9)
"RTN","DVBHIQM",74,0)
 I DVBZZ["CN" S DVBZZZ=DVBZZZ_"  CN"_$E($P(DVBZZ,"CN",2),1,9)
"RTN","DVBHIQM",75,0)
 I DVBZZ["SN" S DVBZZZ=DVBZZZ_"  SN"_$E($P(DVBZZ,"SN",2),1,9)
"RTN","DVBHIQM",76,0)
 I $G(DVBZZZ)]"" S DVBERR1=DVBZZZ
"RTN","DVBHIQM",77,0)
 Q
"RTN","DVBHIQR")
0^2^B12418631
"RTN","DVBHIQR",1,0)
DVBHIQR ;ISC-ALBANY/PKE/PHH-Process HINQ response ; 3/23/06 7:48am
"RTN","DVBHIQR",2,0)
 ;;4.0;HINQ;**32,49,57**;03/25/92 
"RTN","DVBHIQR",3,0)
TEM ;ENTER FROM PRINT TEMPLATE.
"RTN","DVBHIQR",4,0)
 S DVBCS=0,DVBECS=1 K DVBERCS
"RTN","DVBHIQR",5,0)
 F DVBSZ=0:0 S DVBSZ=$O(^DVB(395.5,DFN,"RS",DVBSZ)) S:DVBSZ X(DVBSZ)=^(DVBSZ,0) D SC^DVBHQST Q:$G(DVBERCS)  Q:'DVBSZ!$D(DVBCSE)
"RTN","DVBHIQR",6,0)
 K M,DVBCS,DVBSZ,DVBECS Q:'$D(X(1))!($D(DVBERCS))
"RTN","DVBHIQR",7,0)
A D:'$D(DT) DT^DICRW I $D(X(1)),$E(X(1),1,4)'="HINQ" G NETERR
"RTN","DVBHIQR",8,0)
 ;
"RTN","DVBHIQR",9,0)
 I $D(X)#2,$E(X,1,4)="HINQ" S DVBREQST=$E(X,24,$L(X)-8) K:'$L(DVBREQST) DVBREQST
"RTN","DVBHIQR",10,0)
 ;
"RTN","DVBHIQR",11,0)
 D CHK ;if 5th char is 2 but no name, claim #, change 5th char to "C"
"RTN","DVBHIQR",12,0)
 ;I $A($E(X(1),26,34))'>$A(" "),($A($E(X(1),44,50))'>$A(" ")) D CHK
"RTN","DVBHIQR",13,0)
 ;
"RTN","DVBHIQR",14,0)
 G Q:'$D(X(1)) I "456789ABCDNUVWZ"'[$E(X(1),5) G ^DVBHQR1:$E(X(1),5)=2,EN^DVBHQR3:$E(X(1),5)="N",EN^DVBHQR3:$E(X(1),5)="M",Q:$E(X(1),1,4)'="HINQ"
"RTN","DVBHIQR",15,0)
 ;
"RTN","DVBHIQR",16,0)
 S Y=$E(X(1),5) D ERR S DVBERR=Y,Y=$F(X(1),"NNNN"),DVBERR1=$S(Y:$E(X(1),1,Y-2),1:X(1))
"RTN","DVBHIQR",17,0)
 ;
"RTN","DVBHIQR",18,0)
HINQ S DFN=+$E(X(1),8,21) I $D(DUZ) S XMDUZ=DUZ
"RTN","DVBHIQR",19,0)
 E  S XMDUZ=0
"RTN","DVBHIQR",20,0)
 G Q
"RTN","DVBHIQR",21,0)
ERR ;
"RTN","DVBHIQR",22,0)
 I Y=" " S Y="No VBA response available - please try again later."
"RTN","DVBHIQR",23,0)
 I "B"[Y S Y="Network/Database Problem" Q
"RTN","DVBHIQR",24,0)
 I "C"[Y D RETRY Q
"RTN","DVBHIQR",25,0)
 I Y=6 S Y="Invalid Employee number Not AUTHORIZED" Q
"RTN","DVBHIQR",26,0)
 I Y=9 S Y="PASSWORD missing or invalid" Q
"RTN","DVBHIQR",27,0)
 I Y="X" S Y="Station # does not match Station # of password " Q
"RTN","DVBHIQR",28,0)
 I Y="Y" S Y="Employee Number in New Person file doesn't match the # in VBA security record" Q
"RTN","DVBHIQR",29,0)
 I Y="Z" S Y="User not assigned to the HINQ application." Q
"RTN","DVBHIQR",30,0)
 ;
"RTN","DVBHIQR",31,0)
 S Y=$S(Y=4:"File in alert, NOT available",Y=5:"NO C&P record found ",Y=7:"SS # missing or invalid.",Y=8:"NAME missing or invalid.",1:Y) Q:Y'?1U
"RTN","DVBHIQR",32,0)
 ;
"RTN","DVBHIQR",33,0)
 S Y=$S(Y="A":"File NOT available",Y="D":"SENSITIVE File no access authorized",Y="U":"Unsuccessful read of password or sensitive file",Y="V":"Invalid CLAIM NUMBER",Y="W":"Invalid SERVICE NUMBER",1:Y)
"RTN","DVBHIQR",34,0)
 Q
"RTN","DVBHIQR",35,0)
Q K DVBOTM,DVBV,DVBOXMZ,DVBIXMZ,XMORIG QUIT
"RTN","DVBHIQR",36,0)
 ;
"RTN","DVBHIQR",37,0)
NETERR ;
"RTN","DVBHIQR",38,0)
 S:'$D(DVBZ) DVBZ=^DVB(395.5,DFN,"HQ") S XMORIG=DUZ,XMDUZ=.5,XMSUB="IDCU Response for ",DVBREQUE="",DFN=+$E(DVBZ,10,21),DVBNETER=X(1) Q
"RTN","DVBHIQR",39,0)
 G Q
"RTN","DVBHIQR",40,0)
RETRY S Y="                                 "
"RTN","DVBHIQR",41,0)
 I $P(X(1),"[TRY]",2) Q
"RTN","DVBHIQR",42,0)
 N DVBZZ
"RTN","DVBHIQR",43,0)
 S DVBZZ=$S($G(DVBZ0)]"":DVBZ0,$G(DVBZ1)]"":DVBZ1,1:"")
"RTN","DVBHIQR",44,0)
 I DVBZZ["SS",(DVBZZ["CN") S Y="No record matches input.  Check data and try again                       via 'Individual HINQ'." Q
"RTN","DVBHIQR",45,0)
 I DVBZZ'["SS" S Y="SSN."
"RTN","DVBHIQR",46,0)
 I DVBZZ'["CN" S Y="CN."
"RTN","DVBHIQR",47,0)
 I DVBZZ["SN" S Y="CN OR SSN."
"RTN","DVBHIQR",48,0)
 S X(1)=$P(X(1),"[TRY]")
"RTN","DVBHIQR",49,0)
 I $E(X(1),5)="C" S Y="No Record matches data requested, Retry using                      "_Y
"RTN","DVBHIQR",50,0)
 E  S Y="Can NOT identify with this data,  Retry using "_Y
"RTN","DVBHIQR",51,0)
 S Y=Y_" via 'Individual HINQ'." Q
"RTN","DVBHIQR",52,0)
 ;
"RTN","DVBHIQR",53,0)
CHK ;if a response has 2 for the 5th char but no name or CN, change
"RTN","DVBHIQR",54,0)
 ;the 5th char to "C"
"RTN","DVBHIQR",55,0)
 I $E(X(1),5)=2,($A($E(X(1),26,34))'>$A(" ")),($A($E(X(1),44,50))'>$A(" ")) S $E(X(1),5)="C"
"RTN","DVBHIQR",56,0)
 Q
"RTN","DVBHQD1")
0^3^B24138320
"RTN","DVBHQD1",1,0)
DVBHQD1 ;ISC-ALBANY/PKE/PHH- HINQ receiver ; 3/23/06 7:52am
"RTN","DVBHQD1",2,0)
 ;;4.0;HINQ;**3,12,16,22,23,32,34,40,46,49,57**; 03/25/92 
"RTN","DVBHQD1",3,0)
 ;
"RTN","DVBHQD1",4,0)
 S:'$D(DTIME) DTIME=300 S DVBTIME=DTIME
"RTN","DVBHQD1",5,0)
EN S:$G(IO(0))="" IO(0)=$I S (C,DVBTSK,DVBABORT)=0,DVBXM=1,DTIME=30 U IO(0)
"RTN","DVBHQD1",6,0)
 ;
"RTN","DVBHQD1",7,0)
SEL S (DVBRTC,DVBTRY)=1,DVBNRT="Y"
"RTN","DVBHQD1",8,0)
 R !!," Select Input: (P)atient File, or (D)irect  P//",X:DTIME I '$T!(X["^") G HINQ
"RTN","DVBHQD1",9,0)
 I "Pp"[$E(X) S DVBPRGM="TM^DVBHIQD" G ASK
"RTN","DVBHQD1",10,0)
 I "Dd"[$E(X_1) S DVBPRGM="EN^DVBHQDE" G ASK
"RTN","DVBHQD1",11,0)
 I X["?" D HP^DVBHQAT G SEL
"RTN","DVBHQD1",12,0)
 G SEL
"RTN","DVBHQD1",13,0)
ASK S:$G(IO(0))="" IO(0)=$I W ! S Y=0,DVBIO=IO D @DVBPRGM
"RTN","DVBHQD1",14,0)
ASK1 I Y'<0,$D(DVBP),$L(DVBP)=4 S IO=DVBIO D STUFF^DVBHQAT:$D(DFN),MES
"RTN","DVBHQD1",15,0)
 I $D(DVBMISS) K DVBMISS D:DVBTRY>3 RETRY^DVBHQD2 G:DVBNRT="N" LOAD2^DVBHQD2 I DVBTRY<4&(DVBRTC<4) S DVBTRY=DVBTRY+1 U IO(0) W ?35,"Retrying Request." G ASK1
"RTN","DVBHQD1",16,0)
 S IO=DVBIO U IO(0) K DVBP S DVBABORT=0
"RTN","DVBHQD1",17,0)
 I '$D(Y) G ASK
"RTN","DVBHQD1",18,0)
 I Y>0 G ASK
"RTN","DVBHQD1",19,0)
 ;
"RTN","DVBHQD1",20,0)
HINQ U IO(0) W !!,"Do you wish to continue" S %=2 D YN^DICN G:'% HINQ I %=1 W ! G EN
"RTN","DVBHQD1",21,0)
EX S DTIME=$S($D(DVBTIME):DVBTIME,1:300)
"RTN","DVBHQD1",22,0)
 Q
"RTN","DVBHQD1",23,0)
MES ;
"RTN","DVBHQD1",24,0)
 S:$G(IO(0))="" IO(0)=$I S E=$L(DVBZ) I '$D(DVBDXX),($E(DVBZ,E-7,E-4)'=DVBNUM) S DVBZ=$E(DVBZ,1,E-4)_DVBNUM_$E(DVBZ,E-3,999)
"RTN","DVBHQD1",25,0)
 K E H 1 S DVBEND="NNNN" S:'$D(DVBXM) DVBXM=0 S:'$D(C) C=0
"RTN","DVBHQD1",26,0)
 ;
"RTN","DVBHQD1",27,0)
TOTIMS S TRY=0,CN=$F(DVBZ,"/CN",24),DVBZ0=DVBZ
"RTN","DVBHQD1",28,0)
 I $S('$D(DFN):1,DFN:0,1:1) S CN=0 D SEND^DVBHQD2,KTO^DVBHQD2 Q
"RTN","DVBHQD1",29,0)
 I 'CN D CNLKUP^DVBHQAT
"RTN","DVBHQD1",30,0)
 DO  D SEND^DVBHQD2 I TRY DO  I TRY H 1 D SEND^DVBHQD2
"RTN","DVBHQD1",31,0)
 .I CN,'TRY S DVBZ0=$E(DVBZ,1,23)_$E(DVBZ,24,CN-3)_$E(DVBZ,CN+9,999) Q
"RTN","DVBHQD1",32,0)
 .I CN,TRY S DVBZ1=$E(DVBZ,1,23)_$E(DVBZ,CN-2,999) Q
"RTN","DVBHQD1",33,0)
 .I 'CN S DVBZ0=DVBZ,TRY=0 Q
"RTN","DVBHQD1",34,0)
 I $D(DVBMISS)&($D(DVBPRGM)) I (DVBPRGM["TM") K DVBMISS D:DVBTRY>3 RETRY^DVBHQD2 G:DVBNRT="N" LOAD^DVBHQD2 I DVBTRY<4&(DVBRTC<4) S DVBTRY=DVBTRY+1 U IO(0) W ?35,"Retrying Request." G MES
"RTN","DVBHQD1",35,0)
 G KTO^DVBHQD2
"RTN","DVBHQD1",36,0)
 ;
"RTN","DVBHQD1",37,0)
 ;z1 is first x(),z9 is last x()
"RTN","DVBHQD1",38,0)
OK ;I 'DVBTSK DO
"RTN","DVBHQD1",39,0)
 ;. U IO(0) W !!?3 S Z1=0 F  S Z1=$O(X(Z1)) Q:'Z1  S LX=$G(LX)+$L(X(Z1)) W Z1," ",$L(X(Z1)),"   "
"RTN","DVBHQD1",40,0)
 ;. W !?9,LX,! K LX H 3 U IO
"RTN","DVBHQD1",41,0)
 S:$G(IO(0))="" IO(0)=$I S Z1=$O(X(0)) F  Q:$E(X(Z1))'=$C(10)  S X(Z1)=$E(X(Z1),2,999)
"RTN","DVBHQD1",42,0)
 I $G(X(Z1))["HINQ" S X(Z1)="HINQ"_$P(X(Z1),"HINQ",2)
"RTN","DVBHQD1",43,0)
 E  K X(Z1) DO
"RTN","DVBHQD1",44,0)
 . S Z1=$O(X(0)) I Z1="" S Z1=0,X(0)=""
"RTN","DVBHQD1",45,0)
 . I $G(X(Z1))["HINQ" S X(Z1)="HINQ"_$P(X(Z1),"HINQ",2)
"RTN","DVBHQD1",46,0)
 I $L(X(Z1))>25 S DVBLEN=+$E(X(Z1),22,25)
"RTN","DVBHQD1",47,0)
 I $L(X(Z1))'>25 D
"RTN","DVBHQD1",48,0)
 . I $D(X(Z1+1)) DO
"RTN","DVBHQD1",49,0)
 . . S DVBLEN=+$E($E(X(Z1),1,99)_$E(X(Z1+1),1,30),22,25)
"RTN","DVBHQD1",50,0)
 . I '$D(X(Z1+1)) D
"RTN","DVBHQD1",51,0)
 . . S DVBLEN=$L(X(Z1)) ;DVB*4*49 - error response may be < 25 chars
"RTN","DVBHQD1",52,0)
 I '$D(DVBLEN) S DVBABORT=DVBABORT+1 U IO(0) W:'DVBTSK !,"Missing string" U IO Q
"RTN","DVBHQD1",53,0)
 ;
"RTN","DVBHQD1",54,0)
 I $D(F3) S DVBLEN=DVBLEN-F3 K F3
"RTN","DVBHQD1",55,0)
 I "456789ABCDUVWNMXYZ"'[$E(X(Z1),5) S DVBLEN=DVBLEN-2
"RTN","DVBHQD1",56,0)
 ;
"RTN","DVBHQD1",57,0)
 S (Z,Z9,F2)=0 F  S Z=$O(X(Z)) Q:'Z  S Z9=Z,F2=F2+$L(X(Z))
"RTN","DVBHQD1",58,0)
 ;
"RTN","DVBHQD1",59,0)
 I DVBLEN'=F2,X(Z9)[$C(10) S DVBABORT=DVBABORT+1 U IO(0) W:'DVBTSK !,"Missing character" S DVBMISS="" Q
"RTN","DVBHQD1",60,0)
 I $E(X(Z1),5)'=2 S F2=F2+1
"RTN","DVBHQD1",61,0)
 ;
"RTN","DVBHQD1",62,0)
 I DVBLEN'=F2-1,X(Z9)'[$C(10),$S('$D(X(Z9-1)):1,1:$S(X(Z9-1)'[$C(10):1,1:0)) S DVBABORT=DVBABORT+1 U IO(0) W:'DVBTSK !,"Missing character" S DVBMISS="" Q
"RTN","DVBHQD1",63,0)
 ;trim,e will pack back to x(1)
"RTN","DVBHQD1",64,0)
 I Z9 S:$D(X) DVBSOX=X D TRIM,E^DVBHQAT S:$D(DVBSOX) X=DVBSOX K DVBSOX I $E(X(1),1,4)["HINQ","AXY69"'[$E($E(X(1),5)_1) D ALLM Q
"RTN","DVBHQD1",65,0)
 ;
"RTN","DVBHQD1",66,0)
 S DVBABORT=DVBABORT+1 Q:$E(X(1),1,4)'="HINQ"
"RTN","DVBHQD1",67,0)
 I $E(X(1),5)="A" U IO(0) W:'DVBTSK !,"VBA File not Available" U IO H 2 D ALL QUIT
"RTN","DVBHQD1",68,0)
 ;
"RTN","DVBHQD1",69,0)
 I DVBTSK,"69XY"[$E($E(X(1),5)_1) S DVBBADP="" D ALL QUIT
"RTN","DVBHQD1",70,0)
 I 'Z9 Q
"RTN","DVBHQD1",71,0)
 ;
"RTN","DVBHQD1",72,0)
ALL I 'DVBXM,$D(DFN),+DFN K:C ^TMP("DVBHINQ",$J,DFN) S Z=0 F  S Z=$O(X(Z)) Q:'Z  S ^TMP("DVBHINQ",$J,DFN,Z)=X(Z)
"RTN","DVBHQD1",73,0)
 E  I DVBXM D RS,RECMAL^DVBHQD2,A^DVBHIQR,IALERT^DVBHT2,EN^DVBHIQM H 1 D WRT K DVBTX Q
"RTN","DVBHQD1",74,0)
 I DVBABORT=3!($D(DVBBADP)) S DFN=0
"RTN","DVBHQD1",75,0)
 Q
"RTN","DVBHQD1",76,0)
 ; do all if no error or retrying
"RTN","DVBHQD1",77,0)
ALLM I "BC"'[$E($E(X(1),5)_1) D ALL Q
"RTN","DVBHQD1",78,0)
 I CN,'TRY S TRY=1 D:DVBXM DCN Q
"RTN","DVBHQD1",79,0)
 I 'CN D ALL Q
"RTN","DVBHQD1",80,0)
 S X(1)=X(1)_"[TRY]1" D ALL Q
"RTN","DVBHQD1",81,0)
 ;
"RTN","DVBHQD1",82,0)
DCN S:$G(IO(0))="" IO(0)=$I U IO(0) W !,"..Name, SSN didn't work ....retrying using Claim Number",! U IO Q
"RTN","DVBHQD1",83,0)
 ;
"RTN","DVBHQD1",84,0)
RS Q:'$D(DFN)  Q:'DFN  Q:'$D(^DVB(395.5,DFN,0))  S DVBDFN=DFN,DVBCS=0
"RTN","DVBHQD1",85,0)
 F DVBSZ=0:0 S DVBSZ=$O(X(DVBSZ)) D SC^DVBHQST Q:'DVBSZ  D ST^DVBHQDB
"RTN","DVBHQD1",86,0)
 K DVBSZ,DVBDFN Q
"RTN","DVBHQD1",87,0)
 ;
"RTN","DVBHQD1",88,0)
TRIM Q:F1=999
"RTN","DVBHQD1",89,0)
 I '$D(F1) S F1=$F(X(Z9),DVBEND)
"RTN","DVBHQD1",90,0)
 I $E(X(Z9),F1-F4)=$C(10) S F1=F1-1
"RTN","DVBHQD1",91,0)
 S X(Z9)=$E(X(Z9),1,F1-F4)
"RTN","DVBHQD1",92,0)
 K F1 Q
"RTN","DVBHQD1",93,0)
 ;
"RTN","DVBHQD1",94,0)
WRT S:$G(IO(0))="" IO(0)=$I S DVBJIO=IO(0)
"RTN","DVBHQD1",95,0)
WRT1 S:$G(DVBJIO)="" DVBJIO=$I S:'$D(DVBIOSL) DVBIOSL=IOSL S:'$D(DVBIOST) DVBIOST=IOST S:'$D(DVBIOF) DVBIOF=IOF
"RTN","DVBHQD1",96,0)
 S X="" U DVBJIO W !!! D CODE^DVBHQUS W !! S Y0=$Y F Z=0:0 S Z=$O(^TMP($J,Z)) Q:'Z  I $D(^(Z,0)) W ^(0),! D:$Y-Y0>(DVBIOSL-4) SROLL^DVBHQD2 Q:X="^"  D:$Y<Y0 ABS^DVBHQD2
"RTN","DVBHQD1",97,0)
 Q:X="^"  K DVBJIO D SROLL^DVBHQD2 Q
"RTN","DVBHQD1",98,0)
 ;
"RTN","DVBHQD1",99,0)
CH S F1=0
"RTN","DVBHQD1",100,0)
 I X(W)=$C(10)_"NNNN" K X(W) S F1=999 Q
"RTN","DVBHQD1",101,0)
 I $L(X(W))>4!($L(X(W))<1) Q
"RTN","DVBHQD1",102,0)
 F A=$L(X(W)):-1:1 Q:$E(X(W),A)'="N"
"RTN","DVBHQD1",103,0)
 I A=1,$E(X(W),A)="N" S F1=$L(X(W-1))+1,F3=$L(X(W)),F4=5-$L(X(W)) K X(W)
"RTN","DVBHQD1",104,0)
 Q
"RTN","DVBHQDX")
0^4^B11282698
"RTN","DVBHQDX",1,0)
DVBHQDX ;ISC-ALBANY/PKE/PHH-HINQ IDCU,VBA diagnostic ; 3/23/06 7:56am
"RTN","DVBHQDX",2,0)
 ;;4.0;HINQ;**9,12,33,34,49,57**;03/25/92
"RTN","DVBHQDX",3,0)
EN S X="A" X ^%ZOSF("LPC") K X S U="^",DVBTSK=0 S:'$D(DTIME) DTIME=300 I $D(IO)<11 S IOP="HOME" D ^%ZIS K IOP
"RTN","DVBHQDX",4,0)
 S:'$D(DVBSTN) DVBSTN=$P(^DVB(395,1,0),U,2) I 'DVBSTN W !!,"Station number not defined in HINQ Parameters file. " D EX1 Q
"RTN","DVBHQDX",5,0)
 S DVBDXX=""
"RTN","DVBHQDX",6,0)
 S DVBZ="HINQ"_DVBSTN_" "_"E00000000000000SS12345678NMTEST,HINQ/ABCD1234"
"RTN","DVBHQDX",7,0)
 W !,"This test will take 30 seconds.  No input is required or allowed.",!,"Responses are from the Frame Relay Network, or remote VBA computer."
"RTN","DVBHQDX",8,0)
 W !,"Success in this test will return a message to the user"
"RTN","DVBHQDX",9,0)
AGN U IO(0) W !!,"Do you wish to continue" S %=1 D YN^DICN
"RTN","DVBHQDX",10,0)
 I %Y["?" G AGN
"RTN","DVBHQDX",11,0)
 I %'=1 D EX1 Q
"RTN","DVBHQDX",12,0)
 W !!
"RTN","DVBHQDX",13,0)
 S DVBIDCU=^DVB(395,1,"HQVD")_"^"_$P(^("HQ"),"^",11)
"RTN","DVBHQDX",14,0)
 S DVBLOG=$P(DVBIDCU,U),(DVBDEV,ION)=$P(DVBIDCU,U,4),DVBPU=$P(DVBIDCU,U,2),DVBID=$P(DVBPU,"-"),DVBPW=$P(DVBPU,"-",2)
"RTN","DVBHQDX",15,0)
 I DVBLOG'?3U1"."4U W !,"IDCU ADDRESS not correct in HINQ Parameter file #395" H 2 G END
"RTN","DVBHQDX",16,0)
 ;I '$L(DVBDEV) W !!,"DEVICE NAME not defined in HINQ DEVICE NAME of DVB #395" H 2 G END
"RTN","DVBHQDX",17,0)
 ;I '$L(DVBID) W !,"HINQ IDCU User ID not defined in IDCU USERNAME-PASSWORD parameter." H 2 G END
"RTN","DVBHQDX",18,0)
 ;I '$L(DVBPW) W !,"HINQ IDCU Password not defined in IDCU USERNAME-PASSWORD parameter." H 2 G END
"RTN","DVBHQDX",19,0)
 I $P(DVBIDCU,"^",6) S DVBLOG="VHA"_$P(DVBLOG,"DMS",2)
"RTN","DVBHQDX",20,0)
 ;U IO(0) W !,"HINQ device defined as ",DVBDEV,!!
"RTN","DVBHQDX",21,0)
 ;with DVB*4*49 there will be only one server - message will be 
"RTN","DVBHQDX",22,0)
 ;"Connecting to VBA"
"RTN","DVBHQDX",23,0)
 U IO(0) W !,"Connecting to VBA"
"RTN","DVBHQDX",24,0)
 ;
"RTN","DVBHQDX",25,0)
 S DVBIP=$P($G(^DVB(395,1,"HQIP")),"^")
"RTN","DVBHQDX",26,0)
 I DVBIP,DVBIP?1.3N1P1.3N1P1.3N1P1.3N
"RTN","DVBHQDX",27,0)
 E  W:'DVBTSK !?3,"RDPC IP Address not defined or invalid in DVB parameter file #395" H 3 G EX
"RTN","DVBHQDX",28,0)
 ;
"RTN","DVBHQDX",29,0)
 N DVBPORT,DVBSTN
"RTN","DVBHQDX",30,0)
 S DVBSTN=$P(^DVB(395,1,0),U,2)
"RTN","DVBHQDX",31,0)
 S DVBPORT=$$PORT^DVBHQDL(DVBSTN)
"RTN","DVBHQDX",32,0)
 D CALL^%ZISTCP(DVBIP,DVBPORT,"33")
"RTN","DVBHQDX",33,0)
 I POP G BUSY
"RTN","DVBHQDX",34,0)
 ; 
"RTN","DVBHQDX",35,0)
 S X=0 U IO X ^%ZOSF("EOFF"),^%ZOSF("TYPE-AHEAD"),^%ZOSF("RM") H 1 ;;;F Z=0:0 R *X:1 Q:'$T  U IO(0) W $C(X) U IO
"RTN","DVBHQDX",36,0)
 S C=0
"RTN","DVBHQDX",37,0)
NAM ;;;U IO W $C(13)
"RTN","DVBHQDX",38,0)
 ;
"RTN","DVBHQDX",39,0)
HEL F Z2=1:1:50 U IO R X(Z2):1 U IO(0) W "." U IO H 1 I X(Z2)["**HELLO**" S DVBXM=1,DVBTSK=0,DVBABORT=0 U IO S DVBIO=IO,DVBJDX=1 D MES^DVBHQD1 S IO=DVBIO Q
"RTN","DVBHQDX",40,0)
 I DVBLOG'["VHA" U IO W "$$$BYEF",$C(13) D DISP G EX
"RTN","DVBHQDX",41,0)
 I DVBLOG["VHA" U IO W "$%$DIS",$C(13),! D DISP G EX
"RTN","DVBHQDX",42,0)
 D DISP
"RTN","DVBHQDX",43,0)
END F Z=1:1:30 I $D(X(Z)),X(Z)["???" U IO I DVBLOG'["VHA" W "BYEF",$C(13) Q
"RTN","DVBHQDX",44,0)
 F Z=1:1:30 I $D(X(Z)),X(Z)["$%$" U IO I DVBLOG["VHA" W "DIS",$C(13) Q
"RTN","DVBHQDX",45,0)
 ;
"RTN","DVBHQDX",46,0)
EX ;U IO F Z=1:1 R *X:4 Q:'$T  U IO(0) W $C(X) U IO
"RTN","DVBHQDX",47,0)
EX1 K R,DVBJDX,%Y,%,I,K,Y0,Z2,DVBDXX,DVBLEN,D,DVBIO,X,Z,H,DVBSTN,DVBABORT
"RTN","DVBHQDX",48,0)
 K DVBLOG,DVBDEV,DVBECHO,DVBEND,DVBTMX,DVBTSK,DVBTX,DVBXM,DVBZ,Y,C,G
"RTN","DVBHQDX",49,0)
 K DVBID,DVBIDCU,DVBPU,DVBPW,^TMP($J),DVBIP
"RTN","DVBHQDX",50,0)
 D CLOSE^%ZISTCP
"RTN","DVBHQDX",51,0)
 Q
"RTN","DVBHQDX",52,0)
XXX U IO(0) W:$D(X(Z)) !,X(Z) U IO
"RTN","DVBHQDX",53,0)
 S C=C+1 I C>2 G END
"RTN","DVBHQDX",54,0)
 H 5 G NAM
"RTN","DVBHQDX",55,0)
BUSY U IO(0) W !," ",IO,"   Device is busy" H 1 K DVBLOG,DVBDEV,DVBSTN,DVBDXX,DVBTSK,DVBZ Q
"RTN","DVBHQDX",56,0)
YYY U IO(0) W !,"Bad Network Password notify Site Manager" D EX Q
"RTN","DVBHQDX",57,0)
DISP U IO(0) F G=1:1:Z2 I $D(X(G)) D TRIM W:$L(X(G)) !,X(G) I X(G)["0900 BYE" Q
"RTN","DVBHQDX",58,0)
 U IO Q
"RTN","DVBHQDX",59,0)
TRIM F H=0:0 Q:$E(X(G))'=$C(10)  S X(G)=$E(X(G),2,999)
"RTN","DVBHQDX",60,0)
 F I=$L(X(G)),-1,1 Q:$E(X(G),I)'=$C(10)  S X(G)=$E(X(G),1,I-1)
"RTN","DVBHQDX",61,0)
 Q
"RTN","DVBHQST")
0^5^B25726752
"RTN","DVBHQST",1,0)
DVBHQST ;ISC-ALBANY/PKE/PHH-Process HINQ response ; 3/23/06 7:59am
"RTN","DVBHQST",2,0)
 ;;4.0;HINQ;**32,57**;03/25/92 
"RTN","DVBHQST",3,0)
A S DFN=DVBDFN D:'$D(DT) DT^DICRW I $D(X(1)),$E(X(1),1,4)'="HINQ" G NETERR
"RTN","DVBHQST",4,0)
 ;
"RTN","DVBHQST",5,0)
 I $D(X)#2,$E(X,1,4)="HINQ" S DVBREQST=$E(X,24,$L(X)-8) K:'$L(DVBREQST) DVBREQST
"RTN","DVBHQST",6,0)
 ;
"RTN","DVBHQST",7,0)
 G Q:'$D(X(1)) I "456789ABCDUVWZ"'[$E(X(1),5) G N:$E(X(1),6)=2,N:$E(X(1),5)=2,AB:$E(X(1),5)="N",AB:$E(X(1),5)="M",Q:$E(X(1),1,4)'="HINQ"
"RTN","DVBHQST",8,0)
 ;
"RTN","DVBHQST",9,0)
 S $P(DVBSP," ",35)="",DVBNM=$P(^DPT(DFN,0),U)_DVBSP,DVBNB=" "_DFN_DVBSP,Y=$E(X(1),5),DVBECT=DVBECT+1,DVBSTATS="E" D ERR S DVBTXT(DVBPCT,0)="   "_$E(DVBNM,1,20)_$E(DVBNB,1,11)_Y,DVBPCT=DVBPCT+1 D SET^DVBHQUT Q
"RTN","DVBHQST",10,0)
 ;
"RTN","DVBHQST",11,0)
ERR I "BC"[Y D RETRY^DVBHIQR Q
"RTN","DVBHQST",12,0)
 ;I Y="C" S Y="No Record matches data requested, Retry using CN. or SN. via 'Individual HINQ'." Q
"RTN","DVBHQST",13,0)
 I Y=6 S Y="Invalid Employee number Not AUTHORIZED" Q
"RTN","DVBHQST",14,0)
 I Y=9 S Y="PASSWORD missing or invalid" Q
"RTN","DVBHQST",15,0)
 I Y="X" S Y="Station # does not match Station # of password " Q
"RTN","DVBHQST",16,0)
 I Y="Y" S Y="Employee Number in New Person file doesn't match the # in VBA security record" Q
"RTN","DVBHQST",17,0)
 ;
"RTN","DVBHQST",18,0)
 S Y=$S(Y=4:"File in alert, NOT available",Y=5:"NO C&P record found ",Y=7:"SS # missing or invalid.",Y=8:"NAME missing or invalid.",1:Y) Q:Y'?1U
"RTN","DVBHQST",19,0)
 ;
"RTN","DVBHQST",20,0)
 S Y=$S(Y="A":"File NOT available",Y="D":"SENSITIVE File no access authorized",Y="U":"Unsuccessful read of password or sensitive file",Y="V":"Invalid CLAIM NUMBER",Y="W":"Invalid SERVICE NUMBER",1:Y)
"RTN","DVBHQST",21,0)
 Q
"RTN","DVBHQST",22,0)
Q K DVBOTM,DVBV,DVBOXMZ,DVBIXMZ,XMORIG QUIT
"RTN","DVBHQST",23,0)
 ;
"RTN","DVBHQST",24,0)
NETERR ;
"RTN","DVBHQST",25,0)
 S:'$D(DVBZ) DVBZ=^DVB(395.5,DFN,"HQ") S DVBSTATS="V",XMORIG=DUZ,XMDUZ=.5,XMSUB="IDCU Response for ",DVBREQUE="",DFN=+$E(DVBZ,10,21),DVBNETER=X(1) D SET^DVBHQUT Q
"RTN","DVBHQST",26,0)
 G Q
"RTN","DVBHQST",27,0)
AB S DVBACT=DVBACT+1 D EN^DVBHQR3,EN^DVBHIQM Q
"RTN","DVBHQST",28,0)
N S DVBSTATS="N" D SET^DVBHQUT Q
"RTN","DVBHQST",29,0)
 ;
"RTN","DVBHQST",30,0)
SC ;CHECK SUM need to set DVBCS=0,X(n),DVBSZ
"RTN","DVBHQST",31,0)
 N DA
"RTN","DVBHQST",32,0)
 I $D(X)#2 S DVBSX=X
"RTN","DVBHQST",33,0)
 I DVBSZ=1 S X=$E(X(DVBSZ),1,21)_$E(X(DVBSZ),26,999),DVBXLN=$E(X(DVBSZ),22,25) D O D  Q
"RTN","DVBHQST",34,0)
 .;compare ien of file #395.5 (i.e., dfn) and $e(x(1),8,21)
"RTN","DVBHQST",35,0)
 .;quit if entering from hinq processor either foreground or background
"RTN","DVBHQST",36,0)
 .;only want to do this deletion during print/display of hinq response data
"RTN","DVBHQST",37,0)
 .Q:+$G(DVBTSK)  Q:+$G(DFN)=0
"RTN","DVBHQST",38,0)
 .Q:'$D(^DVB(395.5,DFN,"RS",1))
"RTN","DVBHQST",39,0)
 .S DVBQDFN=+$E(X(1),8,21)  I DVBQDFN'=DFN D
"RTN","DVBHQST",40,0)
 ..;if not a match, then delete entry from file #395.5 and send error message
"RTN","DVBHQST",41,0)
 ..S JJ=$O(^DVB(395,1,"HQMG",0)),DVBQMG=$P($G(^DVB(395,1,"HQMG",JJ,0)),U,1),DVBQMG=$P($G(^XMB(3.8,DVBQMG,0)),U,1)
"RTN","DVBHQST",42,0)
 ..S DA=DFN,DIK="^DVB(395.5," D ^DIK
"RTN","DVBHQST",43,0)
 ..S JJ=1
"RTN","DVBHQST",44,0)
 ..S ^TMP($J,"DVBQERR",JJ)="Record #"_DFN_" in the HINQ SUSPENSE file (#395.5)" S JJ=JJ+1
"RTN","DVBHQST",45,0)
 ..S ^TMP($J,"DVBQERR",JJ)="has been deleted." S JJ=JJ+1
"RTN","DVBHQST",46,0)
 ..S ^TMP($J,"DVBQERR",JJ)="  " S JJ=JJ+1
"RTN","DVBHQST",47,0)
 ..S ^TMP($J,"DVBQERR",JJ)="This record should have contained HINQ response data on:" S JJ=JJ+1
"RTN","DVBHQST",48,0)
 ..S ^TMP($J,"DVBQERR",JJ)="  " S JJ=JJ+1
"RTN","DVBHQST",49,0)
 ..S DVBQIENS=DFN_"," D GETS^DIQ(2,DVBQIENS,".01;.03;.09","E","DVBQA","DVBQE")
"RTN","DVBHQST",50,0)
 ..S ^TMP($J,"DVBQERR",JJ)="Name: "_$G(DVBQA(2,DVBQIENS,.01,"E")) S JJ=JJ+1
"RTN","DVBHQST",51,0)
 ..S ^TMP($J,"DVBQERR",JJ)=" DOB: "_$G(DVBQA(2,DVBQIENS,.03,"E")) S JJ=JJ+1
"RTN","DVBHQST",52,0)
 ..S ^TMP($J,"DVBQERR",JJ)=" SSN: "_$G(DVBQA(2,DVBQIENS,.09,"E")) S JJ=JJ+1
"RTN","DVBHQST",53,0)
 ..S ^TMP($J,"DVBQERR",JJ)="  " S JJ=JJ+1
"RTN","DVBHQST",54,0)
 ..K DVBQA,DVBQE
"RTN","DVBHQST",55,0)
 ..S ^TMP($J,"DVBQERR",JJ)="Instead it held HINQ response data for:" S JJ=JJ+1
"RTN","DVBHQST",56,0)
 ..S ^TMP($J,"DVBQERR",JJ)="  " S JJ=JJ+1
"RTN","DVBHQST",57,0)
 ..S DVBQIENS=DVBQDFN_"," D GETS^DIQ(2,DVBQIENS,".01;.03;.09","E","DVBQA","DVBQE")
"RTN","DVBHQST",58,0)
 ..S ^TMP($J,"DVBQERR",JJ)="Name: "_$G(DVBQA(2,DVBQIENS,.01,"E")) S JJ=JJ+1
"RTN","DVBHQST",59,0)
 ..S ^TMP($J,"DVBQERR",JJ)=" DOB: "_$G(DVBQA(2,DVBQIENS,.03,"E")) S JJ=JJ+1
"RTN","DVBHQST",60,0)
 ..S ^TMP($J,"DVBQERR",JJ)=" SSN: "_$G(DVBQA(2,DVBQIENS,.09,"E")) S JJ=JJ+1
"RTN","DVBHQST",61,0)
 ..S ^TMP($J,"DVBQERR",JJ)="  " S JJ=JJ+1
"RTN","DVBHQST",62,0)
 ..S ^TMP($J,"DVBQERR",JJ)="Please request new HINQ data on the appropriate veteran" S JJ=JJ+1
"RTN","DVBHQST",63,0)
 ..S ^TMP($J,"DVBQERR",JJ)="at your earliest convenience." S JJ=JJ+1
"RTN","DVBHQST",64,0)
 ..S XMDUZ=DUZ,XMSUB="HINQ Suspense File IEN#"_DFN_" Deleted",XMTEXT="^TMP($J,""DVBQERR"","
"RTN","DVBHQST",65,0)
 ..S XMY(DUZ)="" S:DVBQMG'="" XMY("G."_DVBQMG)=""
"RTN","DVBHQST",66,0)
 ..D ^XMD K XMZ
"RTN","DVBHQST",67,0)
 ..S DVBERCS=1 K DVBQDFN,DVBQIENS,DVBQA,DVBQE,DVBQMG,DIK,JJ
"RTN","DVBHQST",68,0)
 I DVBSZ>1 S X=$E(X(DVBSZ),1,999) D O Q
"RTN","DVBHQST",69,0)
 I 'DVBSZ S DVBCS="0000"_DVBCS,DVBCS=$E(DVBCS,($L(DVBCS)-3),$L(DVBCS)) I '$D(DVBECS) S ^(0)=$E(^DVB(395.5,DVBDFN,"RS",1,0),1,21)_DVBCS_$E(^(0),26,999)
"RTN","DVBHQST",70,0)
 I DVBXLN'=DVBCS,$D(DVBECS) S:'$D(DVBON) (DVBON,DVBOFF)="""""" D W1
"RTN","DVBHQST",71,0)
 I $D(DVBSX) S X=DVBSX
"RTN","DVBHQST",72,0)
 D EX
"RTN","DVBHQST",73,0)
 Q
"RTN","DVBHQST",74,0)
 ;
"RTN","DVBHQST",75,0)
EX K DVBXLN,DVBSX Q
"RTN","DVBHQST",76,0)
 ;
"RTN","DVBHQST",77,0)
O X ^%ZOSF("LPC") S DVBCS=(DVBCS+Y+$L(X))*DVBSZ
"RTN","DVBHQST",78,0)
 Q
"RTN","DVBHQST",79,0)
 ;
"RTN","DVBHQST",80,0)
W1 U IO W !!!!,*7,?15,"HINQ data does NOT seem right",!,?15,"Re-HINQ and/or Notify system manager. ",!,?15,"HINQ check sum failure for ",DVBON,$S($D(^DPT(DFN,0)):$P(^(0),U),1:DFN),DVBOFF,! H 3 S DVBERCS=1
"RTN","DVBHQST",81,0)
 Q
"RTN","DVBHQZ6")
0^6^B24643397
"RTN","DVBHQZ6",1,0)
DVBHQZ6 ;ISC-ALBANY/JLU/PHH-print message ; 3/23/06 8:01am
"RTN","DVBHQZ6",2,0)
 ;;4.0;HINQ;**28,49,57**;03/25/92 
"RTN","DVBHQZ6",3,0)
1 W @$S('$D(IOF):"#",IOF="":"#",1:IOF),!!!
"RTN","DVBHQZ6",4,0)
2 D 2^DVBHUTIL
"RTN","DVBHQZ6",5,0)
3 W !!!,?5,"Printout by (M)ultiple patients, (R)equestor, (D)ate/time?   Multiple//"
"RTN","DVBHQZ6",6,0)
 R DVBA:DTIME G:DVBA="^"!('$T) K S:DVBA="" DVBA="M"
"RTN","DVBHQZ6",7,0)
 S (DVBMM2,DVBMM)=1 D M:"Mm"[DVBA,R:"Rr"[DVBA,D:"Dd"[DVBA
"RTN","DVBHQZ6",8,0)
 I "MRDmrd"'[DVBA W !!,*7,?10,"Answer with an 'M', 'R', 'D', <RET> for 'M', or '^' to quit." G 3
"RTN","DVBHQZ6",9,0)
K K DVBI,R1,DVBLEN,DVBMM2,X,POP,DVBMM1,DVBA,DVBLP,DVB,DVBMM,DVBLP1,DIC,%,DFN,ZTRTN,ZTSAVE,ZTDESC,ZTIO,DVBJIO,POP,Y,ZTSK,DVBDXSC,DVBIXMZ,DVBUSER,R,DVBCS,%DT,DVBTO,DVBFR
"RTN","DVBHQZ6",10,0)
K1 K DVBAL,DVBLP2,DVBIO,DVBLP1,DVBLP1,DVB,DVBMM,DVBJIO I '$D(ZTSK) X ^%ZIS("C")
"RTN","DVBHQZ6",11,0)
 Q
"RTN","DVBHQZ6",12,0)
M S DVB="",DIC="^DVB(395.5,",DIC(0)="AEMZQ"
"RTN","DVBHQZ6",13,0)
 S DIC("S")="I $D(^(""RS"",0))",DIC("A")="Select patient from ""HINQ Suspense file"":"
"RTN","DVBHQZ6",14,0)
 F DVBLP=1:1 D ^DIC Q:Y'>0  S DVB=DVB_+Y_"^"
"RTN","DVBHQZ6",15,0)
 K DIC I Y'>0,DVB="" Q
"RTN","DVBHQZ6",16,0)
 W ! S ZTRTN="M1^DVBHQZ6",ZTSAVE("DVB")=DVB,ZTSAVE("DVBLP")=DVBLP S:$D(DVBMM2) ZTSAVE("DVBMM2")=DVBMM2 S:$D(DVBMM) ZTSAVE("DVBMM")=DVBMM D LD:'$D(DVBMM1) Q:$D(IO("Q"))!(POP)
"RTN","DVBHQZ6",17,0)
M1 F DVBLP1=1:1:DVBLP-1 S DFN=$P(DVB,U,DVBLP1),DVBJIO=$S(IO'=IO(0):IO,1:IO(0)) I $D(^DVB(395.5,DFN,0)),($D(^("RS"))) D TEM^DVBHIQR D:'$D(DVBERCS) EN^DVBHIQM,WRT1^DVBHQD1:'$D(DVBMM1) W:$D(DVBMM1) "." Q:X="^"
"RTN","DVBHQZ6",18,0)
 Q
"RTN","DVBHQZ6",19,0)
 ;
"RTN","DVBHQZ6",20,0)
DT S %DT="TAEP",%DT("A")="From:" D ^%DT Q:Y<0  S DVBFR=Y,%DT("A")="To:" D ^%DT Q:Y<0  I DVBFR>Y W !,*7,*7,"TO date cannot be earlier than FROM date." G DT
"RTN","DVBHQZ6",21,0)
 S DVBTO=9999999-(Y+.2400),DVBFR=9999999-(DVBFR-.000001) K %DT Q
"RTN","DVBHQZ6",22,0)
 ;
"RTN","DVBHQZ6",23,0)
R S DIC(0)="AQME",DIC=200 D ^DIC Q:Y<0  S DVBAL=+Y
"RTN","DVBHQZ6",24,0)
 D DT Q:'$D(DVBFR)!('$D(DVBTO))
"RTN","DVBHQZ6",25,0)
 S ZTSAVE("DVBMM2")=DVBMM2,ZTSAVE("DVBMM")=DVBMM,ZTSAVE("DVBAL")=DVBAL,ZTSAVE("DVBFR")=DVBFR,ZTSAVE("DVBTO")=DVBTO,ZTRTN="R1^DVBHQZ6" D LD Q:$D(IO("Q"))!(POP)
"RTN","DVBHQZ6",26,0)
R1 S X="" F DVBLP=DVBTO:0:9999999 S DVBLP=$O(^DVB(395.5,"C",DVBLP)) Q:DVBLP>DVBFR!(X="^")!('DVBLP)  F DFN=0:0 S DFN=$O(^DVB(395.5,"C",DVBLP,DFN)) Q:'DFN!(X="^")  I $D(^DVB(395.5,"D",DVBAL,DFN,DVBAL)),$D(^DVB(395.5,DFN,0)),$D(^("RS")) D R3
"RTN","DVBHQZ6",27,0)
 Q
"RTN","DVBHQZ6",28,0)
 ;
"RTN","DVBHQZ6",29,0)
R3 S DVBJIO=$S(IO'=IO(0):IO,1:IO(0)) D TEM^DVBHIQR D:'$D(DVBERCS) EN^DVBHIQM,WRT1^DVBHQD1 Q
"RTN","DVBHQZ6",30,0)
 ;
"RTN","DVBHQZ6",31,0)
D D DT Q:'$D(DVBFR)!('$D(DVBTO))
"RTN","DVBHQZ6",32,0)
 S ZTSAVE("DVBMM2")=DVBMM2,ZTSAVE("DVBMM")=DVBMM,ZTSAVE("DVBFR")=DVBFR,ZTSAVE("DVBTO")=DVBTO,ZTRTN="D1^DVBHQZ6" D LD Q:$D(IO("Q"))!(POP)
"RTN","DVBHQZ6",33,0)
D1 S X="" F DVBLP=DVBTO:0:9999999 S DVBLP=$O(^DVB(395.5,"C",DVBLP)) Q:DVBLP>DVBFR!(X="^")!('DVBLP)  F DFN=0:0 S DFN=$O(^DVB(395.5,"C",DVBLP,DFN)) Q:'DFN!(X="^")  I $D(^DVB(395.5,DFN,0)),$D(^("RS")) D R3
"RTN","DVBHQZ6",34,0)
 Q
"RTN","DVBHQZ6",35,0)
 ;
"RTN","DVBHQZ6",36,0)
EM W !!,"Do you wish to create a mail message, to be sent to the requestors" S %=2 D YN^DICN I %=0 W *7,!,"'YES' to create a mail message  'NO' will not" G EM
"RTN","DVBHQZ6",37,0)
 I %=1 S DVBMM1=1,POP=0 D M W:$D(DVBLP1) !,"Mail Sent."
"RTN","DVBHQZ6",38,0)
 D K Q
"RTN","DVBHQZ6",39,0)
 ;
"RTN","DVBHQZ6",40,0)
LD S %IS="MQ" D ^%ZIS Q:POP  I $D(IO("Q")) S ZTDESC="This is the HINQ Print/Mail option.",ZTIO=ION D ^%ZTLOAD X ^%ZIS("C")
"RTN","DVBHQZ6",41,0)
 Q
"RTN","DVBHQZ6",42,0)
 ;
"RTN","DVBHQZ6",43,0)
S1 ;
"RTN","DVBHQZ6",44,0)
 I $D(DVBDX) D LABELS^DVBHS3
"RTN","DVBHQZ6",45,0)
 F JU=0:0 S JU=$O(DVBDX(JU)) Q:'JU  I +DVBDX(JU),DVBDX(JU)'["-" D S2
"RTN","DVBHQZ6",46,0)
 Q
"RTN","DVBHQZ6",47,0)
S2 I ($Y+5)>IOSL,$E(IOST,1,2)="C-" D PAUSE^DVBHS3
"RTN","DVBHQZ6",48,0)
 I $G(QUIT)=1 Q
"RTN","DVBHQZ6",49,0)
 W !,$S($P(DVBDX(JU),U,2)="":$P(DVBDX(JU),U),$D(^DIC(31,$P(DVBDX(JU),U,2),0)):$E($P(^(0),U),1,40),1:"")
"RTN","DVBHQZ6",50,0)
 W ?42,$S($P(DVBDX(JU),U,3)="X0":100,1:+$P(DVBDX(JU),U,3))
"RTN","DVBHQZ6",51,0)
 W ?50,$P($G(DVBDX(JU)),U,4)
"RTN","DVBHQZ6",52,0)
 ;DVB*4*54 - format date fields
"RTN","DVBHQZ6",53,0)
 N DVBF,DVBFF
"RTN","DVBHQZ6",54,0)
 F DVBF=5,6 S DVBFF=$P($G(DVBDX(JU)),U,DVBF) D
"RTN","DVBHQZ6",55,0)
 . I $G(DVBFF)?8N D
"RTN","DVBHQZ6",56,0)
 . . S M=$E(DVBFF,1,2)
"RTN","DVBHQZ6",57,0)
 . . D MM^DVBHQM11
"RTN","DVBHQZ6",58,0)
 . . S DVBF(DVBF)=M_" "_$S($E(DVBFF,3,4)]"":$E(DVBFF,3,4),1:"  ")_","_$E(DVBFF,5,8)
"RTN","DVBHQZ6",59,0)
 W ?55,$G(DVBF(5)),?68,$G(DVBF(6))
"RTN","DVBHQZ6",60,0)
 K QUIT
"RTN","DVBHQZ6",61,0)
 Q
"RTN","DVBHQZ6",62,0)
 ;
"RTN","DVBHQZ6",63,0)
QB S %=2 W !!,"Would you like a HINQ message printed out " D YN^DICN I %<0!(%=2) Q
"RTN","DVBHQZ6",64,0)
 I '% W !!,"A YES will result in a HINQ printout queued to the device you select." G QB
"RTN","DVBHQZ6",65,0)
 W !,"I will queue all messages!"
"RTN","DVBHQZ6",66,0)
 K IOP S %IS="NMQ",%IS("B")="" D ^%ZIS K %IS I POP W !,"No printout queued!" G EX
"RTN","DVBHQZ6",67,0)
 S IOP=ION_";"_IOST_$S($D(IO("DOC")):";"_IO("DOC"),1:";"_IOM_";"_IOSL)
"RTN","DVBHQZ6",68,0)
 I IO=IO(0) W !,"Can not queue to your HOME device." G QB
"RTN","DVBHQZ6",69,0)
 I IO'=IO(0),'$D(IO("Q")) W !,"I am QUEUEING this report to run now." S IO("Q")=1,ZTDTH=$H
"RTN","DVBHQZ6",70,0)
 S DVBMM2=1,ZTRTN="M1^DVBHQZ6",ZTIO=IOP,ZTSAVE("DVB")=DVB,ZTSAVE("DVBLP")=DVBLP,ZTSAVE("DVBMM")=DVBMM,ZTSAVE("DVBMM2")=DVBMM2,ZTDESC="This is the HINQ report." K IO("Q") D ^%ZTLOAD
"RTN","DVBHQZ6",71,0)
EX S IOP="HOME" D ^%ZIS K DVB,DVBLP,DVBMM,DVBMM2,ZTRTN,ZTIO,ZTSAVE,ZTDESC,IOP Q
"RTN","DVBHT1")
0^7^B23023356
"RTN","DVBHT1",1,0)
DVBHT1 ;ISC-ALBANY/PKE/PHH - HINQ alert parser ; 3/23/06 8:04am
"RTN","DVBHT1",2,0)
 ;;4.0;HINQ;**12,15,20,43,49,57**;03/25/92
"RTN","DVBHT1",3,0)
 ;
"RTN","DVBHT1",4,0)
 ;  cn  foldloc   sc diag   comb%   chk   a&a     hb  pension disablity
"RTN","DVBHT1",5,0)
 ; .313,.312/.314,.3731/2.05,.302,.36295,.36205,.36215,.36235,.3025
"RTN","DVBHT1",6,0)
 Q
"RTN","DVBHT1",7,0)
 ;S DVBDATAT(+Y)="",DVBDATA=DVBDATA_"^"_Y
"RTN","DVBHT1",8,0)
MSG S DVBDATA(+Y)="",DVBDATA=$S($L(DVBDATA)>100:DVBDATA,$P(DVBDATA,"^",16):DVBDATA,1:DVBDATA_"^"_Y) Q
"RTN","DVBHT1",9,0)
 ;
"RTN","DVBHT1",10,0)
 ;check on return from HINQUP processing
"RTN","DVBHT1",11,0)
ACHK S DVBNOALR=""
"RTN","DVBHT1",12,0)
 ;called from batch or direct
"RTN","DVBHT1",13,0)
EN Q:'$D(DFN)  Q:'DFN
"RTN","DVBHT1",14,0)
 N X,Y,I,M,N,P
"RTN","DVBHT1",15,0)
 S DVBDATA="^^^^^^^^^"
"RTN","DVBHT1",16,0)
EDT ; DX,DIQ,AA,ENTIT,COMB,CN,FOLD,CHECK
"RTN","DVBHT1",17,0)
 ;
"RTN","DVBHT1",18,0)
 D DX,DIQ,AA,ENTIT,COMB,CN,FOLD,CHECK
"RTN","DVBHT1",19,0)
 I DVBDATA'="^^^^^^^^^" DO
"RTN","DVBHT1",20,0)
 .I '$D(DVBNOALR) D ALERT^DVBHT Q
"RTN","DVBHT1",21,0)
 .S (I,Y)=0 F  S Y=$O(DVBDATA(Y)) Q:'Y  DO
"RTN","DVBHT1",22,0)
 ..S $P(DVBDATA,"^",I+1)=Y,I=I+1
"RTN","DVBHT1",23,0)
 .K DVBNOALR
"RTN","DVBHT1",24,0)
 K DVBENT,DVBSCONN
"RTN","DVBHT1",25,0)
 Q
"RTN","DVBHT1",26,0)
 ;
"RTN","DVBHT1",27,0)
DX Q:'$D(DVBDX)  Q:'$D(DVBDXNO)
"RTN","DVBHT1",28,0)
 S (DVBDXNO,I)=0 F  S I=$O(DVBDX(I)) Q:I=""  S DVBDXNO=DVBDXNO+1
"RTN","DVBHT1",29,0)
 K M F I=1:1:DVBDXNO D
"RTN","DVBHT1",30,0)
 .S M(I)=$P(DVBDX(I),U,2,3)
"RTN","DVBHT1",31,0)
 .I M(I)["X0" S $P(M(I),U,2)="100"
"RTN","DVBHT1",32,0)
 .S $P(M(I),U,2)=+$P(M(I),U,2)
"RTN","DVBHT1",33,0)
 .S $P(M(I),U,3)=1
"RTN","DVBHT1",34,0)
 .I $P(DVBDX(I),U,4)]"" S $P(M(I),U,4)=$P(DVBDX(I),U,4)
"RTN","DVBHT1",35,0)
 .I $P(DVBDX(I),U,5)]"" S $P(M(I),U,5)=$$HL7TFM^XLFDT($E($P(DVBDX(I),U,5),5,8)_$E($P(DVBDX(I),U,5),1,4))
"RTN","DVBHT1",36,0)
 .I $P(DVBDX(I),U,6)]"" S $P(M(I),U,6)=$$HL7TFM^XLFDT($E($P(DVBDX(I),U,6),5,8)_$E($P(DVBDX(I),U,6),1,4))
"RTN","DVBHT1",37,0)
 .I '$D(DVBSCONN) S DVBSCONN=$P(M(I),"^",2) Q
"RTN","DVBHT1",38,0)
 .I DVBSCONN<$P(M(I),U,2) S DVBSCONN=$P(M(I),U,2)
"RTN","DVBHT1",39,0)
 S (N,P)=0
"RTN","DVBHT1",40,0)
 F  S N=$O(^DPT(DFN,.372,N)) Q:'N  I $D(^(N,0)) DO
"RTN","DVBHT1",41,0)
 .S M=0
"RTN","DVBHT1",42,0)
 .F  S M=$O(M(M)) Q:'M  I M(M)=^(0) K M(M) Q  ;tag dx+6
"RTN","DVBHT1",43,0)
 .I M Q  ;sc match
"RTN","DVBHT1",44,0)
 .I $P(^(0),U,3) S P=P+1 ;  tag dx+6,naked ref to ^dpt(dfn,.372,n,0)
"RTN","DVBHT1",45,0)
 I P S Y="3-SC Disabilities" D VER
"RTN","DVBHT1",46,0)
 I $D(M)>9 S Y="3+SC Disabilities" D VER
"RTN","DVBHT1",47,0)
 K I,M,N,P Q
"RTN","DVBHT1",48,0)
 ;
"RTN","DVBHT1",49,0)
VER ;with DVB*4*49 no BIRLS only records & Dx, Verified not sent
"RTN","DVBHT1",50,0)
 D MSG Q
"RTN","DVBHT1",51,0)
 ;
"RTN","DVBHT1",52,0)
DIQ ;K DVBDIQ(2)
"RTN","DVBHT1",53,0)
 F LP2=.361,.302,.3025,.312,.313,.314,.36205,.36215,.36235,.36295 S X="DVBDIQ(2,"_DFN_","_LP2_")" K @X
"RTN","DVBHT1",54,0)
 S DR=".302;.3025;.312;.313;.314;.361;.36205;.36215;.36235;.36295"
"RTN","DVBHT1",55,0)
DIQDR S DIC="^DPT(",DA=DFN,DIQ(0)="E",DIQ="DVBDIQ(" D EN^DIQ1 Q
"RTN","DVBHT1",56,0)
 ;
"RTN","DVBHT1",57,0)
 ; I V=0 HBa/oA&A term    V=1 Hospitlize pay HB, A&A entitled
"RTN","DVBHT1",58,0)
 ; I V=2 A&A    V=3 HB    V=" " HB a/o A&A not granted
"RTN","DVBHT1",59,0)
AA I $D(DVBAAHB) S V1=DVBAAHB S V=V1 S:V1>3&(V1<8) V=V1-4
"RTN","DVBHT1",60,0)
 I '$D(DVBAAHB) S V=9
"RTN","DVBHT1",61,0)
 I $D(DVBBAS(1)),$P(DVBBAS(1),"^",6)="E" S V=0 ;terminated pending purge
"RTN","DVBHT1",62,0)
 I DVBDIQ(2,DFN,.36205,"E")="YES","0 9"[V S Y="5-A&A" D MSG
"RTN","DVBHT1",63,0)
 I DVBDIQ(2,DFN,.36205,"E")'="YES","12"[V S Y="5+A&A" D MSG
"RTN","DVBHT1",64,0)
 ;
"RTN","DVBHT1",65,0)
 I DVBDIQ(2,DFN,.36215,"E")="YES","0 9"[V S Y="5-HB" D MSG
"RTN","DVBHT1",66,0)
 I DVBDIQ(2,DFN,.36215,"E")'="YES","13"[V S Y="5+HB" D MSG
"RTN","DVBHT1",67,0)
 Q
"RTN","DVBHT1",68,0)
 ;
"RTN","DVBHT1",69,0)
 ;compensation, pension
"RTN","DVBHT1",70,0)
ENTIT S DVBENT=" " I $D(DVBP(1)) S T1=$P(DVBP(1),U,4) D
"RTN","DVBHT1",71,0)
 . I T1'="" S DVBENT=$S(T1="01":"Compensation",T1="0L":"Pension",1:" ")
"RTN","DVBHT1",72,0)
 S Y=0
"RTN","DVBHT1",73,0)
 I DVBDIQ(2,DFN,.36235,"E")="YES" DO
"RTN","DVBHT1",74,0)
 .;terminated pending purge
"RTN","DVBHT1",75,0)
 .I $G(DVBCHECK)'>0,$G(DVBDXNO)>0 S DVBENT=" "
"RTN","DVBHT1",76,0)
 .;all record types now "A", so had to check if no VA Check and has 
"RTN","DVBHT1",77,0)
 .;SC disabilities instead of checking for type "E" record - DVB*4*49
"RTN","DVBHT1",78,0)
 .I DVBENT["Pension" Q
"RTN","DVBHT1",79,0)
 .S Y="5-Pension"
"RTN","DVBHT1",80,0)
 E  I DVBENT["Pension" S Y="5+Pension"
"RTN","DVBHT1",81,0)
 I Y D MSG
"RTN","DVBHT1",82,0)
 ;
"RTN","DVBHT1",83,0)
 S Y=0
"RTN","DVBHT1",84,0)
 I DVBDIQ(2,DFN,.3025,"E")="YES" DO
"RTN","DVBHT1",85,0)
 .I DVBENT["ompensation" Q
"RTN","DVBHT1",86,0)
 .I DVBENT["Disability" Q
"RTN","DVBHT1",87,0)
 .S Y="5-Compensation"
"RTN","DVBHT1",88,0)
 E  I DVBENT'=" " DO
"RTN","DVBHT1",89,0)
 .I DVBENT["ompensation"!(DVBENT["Disability") S Y="5+Compensation"
"RTN","DVBHT1",90,0)
 I Y D MSG
"RTN","DVBHT1",91,0)
 Q
"RTN","DVBHT1",92,0)
 ;DVBSCONN is biggest SC disability
"RTN","DVBHT1",93,0)
COMB I '$D(DVBSCONN) S Y=""
"RTN","DVBHT1",94,0)
 E  DO
"RTN","DVBHT1",95,0)
 .S Y=DVBSCONN
"RTN","DVBHT1",96,0)
 .I $D(DVBCAP) Q  ;birls
"RTN","DVBHT1",97,0)
 .I DVBENT["Pension" Q
"RTN","DVBHT1",98,0)
 .S Y=$S($D(DVBDXPCT):$S(+DVBDXPCT?1N.N:+DVBDXPCT,1:DVBSCONN))
"RTN","DVBHT1",99,0)
 .S DVBSCONN=Y
"RTN","DVBHT1",100,0)
 I +DVBDIQ(2,DFN,.302,"E")=+Y S Y=0
"RTN","DVBHT1",101,0)
 E  DO
"RTN","DVBHT1",102,0)
 .S Y=0
"RTN","DVBHT1",103,0)
 .;c&p
"RTN","DVBHT1",104,0)
 .I '$D(DVBSCONN)!(DVBENT["ompensation")!(DVBENT["Disability") DO  Q
"RTN","DVBHT1",105,0)
 . .S Y="5?SC Combined %"
"RTN","DVBHT1",106,0)
 .;birls,pension
"RTN","DVBHT1",107,0)
 .I DVBDIQ(2,DFN,.361,"E")["SERVICE CONNECTED",DVBSCONN>49 Q
"RTN","DVBHT1",108,0)
 .I DVBDIQ(2,DFN,.361,"E")["SC LESS THAN",DVBSCONN<50 Q
"RTN","DVBHT1",109,0)
 .S Y="5?SC Combined %"
"RTN","DVBHT1",110,0)
 I Y D MSG
"RTN","DVBHT1",111,0)
 K DVBALERT,DVBSCONN
"RTN","DVBHT1",112,0)
 Q
"RTN","DVBHT1",113,0)
 ;
"RTN","DVBHT1",114,0)
CN I +DVBDIQ(2,DFN,.313,"E")=$S($D(DVBCN):+DVBCN,1:0)
"RTN","DVBHT1",115,0)
 E  S Y="2?Claim #" D MSG
"RTN","DVBHT1",116,0)
 Q
"RTN","DVBHT1",117,0)
 ;  --check in xman
"RTN","DVBHT1",118,0)
FOLD Q:'$D(DVBFL)  S Y=0
"RTN","DVBHT1",119,0)
 I $G(DVBFL)="  " S DVBFL=""
"RTN","DVBHT1",120,0)
 I '$D(DVBDIQ(2,DFN,.314,"E")) DO
"RTN","DVBHT1",121,0)
 .I +DVBDIQ(2,DFN,.312,"E")=$S($D(DVBFL):+DVBFL,1:0) Q
"RTN","DVBHT1",122,0)
 .S Y="2?Folder Location"
"RTN","DVBHT1",123,0)
 E  DO  ;pims v5.3  y => abc_ro, 323, or ""
"RTN","DVBHT1",124,0)
 .S Y=$S($D(DVBFL):$S($P(DVBFL,"- ",2)]"":$P(DVBFL,"- ",2),1:DVBFL),1:"")
"RTN","DVBHT1",125,0)
 .I DVBDIQ(2,DFN,.314,"E")=Y Q
"RTN","DVBHT1",126,0)
 .S Y="2?Folder Location"
"RTN","DVBHT1",127,0)
 I Y D MSG
"RTN","DVBHT1",128,0)
 Q
"RTN","DVBHT1",129,0)
 ;
"RTN","DVBHT1",130,0)
CHECK S Y=0
"RTN","DVBHT1",131,0)
 I $D(DVBDIQ(2,DFN,.36295,"E")) DO  ;pims v5.3
"RTN","DVBHT1",132,0)
 .I $D(DVBBAS(1)),$L($P(DVBBAS(1),"^",20)) S Y=$P(DVBBAS(1),"^",20)
"RTN","DVBHT1",133,0)
 .I +DVBDIQ(2,DFN,.36295,"E")=+$S(Y:Y*12,$D(DVBCHECK):DVBCHECK*12,1:"") S Y=0 Q
"RTN","DVBHT1",134,0)
 .S Y="5?VA Check/Net Award"
"RTN","DVBHT1",135,0)
 I Y D MSG
"RTN","DVBHT1",136,0)
 Q
"UP",2,2.04,-1)
2^.372
"UP",2,2.04,0)
2.04
"VER")
8.0^22.0
"^DD",2,2.04,4,0)
EXTREMITY AFFECTED^S^BL:BOTH LOWER;BU:BOTH UPPER;RL:RIGHT LOWER;RU:RIGHT UPPER;LL:LEFT LOWER;LU:LEFT UPPER;^0;4^Q
"^DD",2,2.04,4,"DT")
3051129
"^DD",2,2.04,5,0)
ORIGINAL EFFECTIVE DATE^DX^^0;5^S %DT="E" D ^%DT S X=Y K:Y<1!(Y>DT) X
"^DD",2,2.04,5,21,0)
^^2^2^3050712^
"^DD",2,2.04,5,21,1,0)
Data will be stuffed from messages from the HEC.  This field indicates 
"^DD",2,2.04,5,21,2,0)
the first date that this disability was evaluated.
"^DD",2,2.04,5,"DT")
3050714
"^DD",2,2.04,6,0)
CURRENT EFFECTIVE DATE^DX^^0;6^S %DT="E" D ^%DT S X=Y K:Y<1!(Y>DT) X
"^DD",2,2.04,6,21,0)
^.001^2^2^3050727^^^^
"^DD",2,2.04,6,21,1,0)
Data will be stuffed from messages from the HEC.  This field indicates 
"^DD",2,2.04,6,21,2,0)
the most recent date that this disability was evaluated.
"^DD",2,2.04,6,"DT")
3050728
**INSTALL NAME**
DG*5.3*709
"BLD",6098,0)
DG*5.3*709^REGISTRATION^0^3060323^y
"BLD",6098,4,0)
^9.64PA^^
"BLD",6098,"KRN",0)
^9.67PA^8989.52^19
"BLD",6098,"KRN",.4,0)
.4
"BLD",6098,"KRN",.401,0)
.401
"BLD",6098,"KRN",.402,0)
.402
"BLD",6098,"KRN",.403,0)
.403
"BLD",6098,"KRN",.5,0)
.5
"BLD",6098,"KRN",.84,0)
.84
"BLD",6098,"KRN",3.6,0)
3.6
"BLD",6098,"KRN",3.8,0)
3.8
"BLD",6098,"KRN",9.2,0)
9.2
"BLD",6098,"KRN",9.8,0)
9.8
"BLD",6098,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",6098,"KRN",9.8,"NM",1,0)
DGRP11^^0^B11509829
"BLD",6098,"KRN",9.8,"NM",2,0)
DGRPDB^^0^B20476702
"BLD",6098,"KRN",9.8,"NM","B","DGRP11",1)

"BLD",6098,"KRN",9.8,"NM","B","DGRPDB",2)

"BLD",6098,"KRN",19,0)
19
"BLD",6098,"KRN",19.1,0)
19.1
"BLD",6098,"KRN",101,0)
101
"BLD",6098,"KRN",409.61,0)
409.61
"BLD",6098,"KRN",771,0)
771
"BLD",6098,"KRN",870,0)
870
"BLD",6098,"KRN",8989.51,0)
8989.51
"BLD",6098,"KRN",8989.52,0)
8989.52
"BLD",6098,"KRN",8994,0)
8994
"BLD",6098,"KRN","B",.4,.4)

"BLD",6098,"KRN","B",.401,.401)

"BLD",6098,"KRN","B",.402,.402)

"BLD",6098,"KRN","B",.403,.403)

"BLD",6098,"KRN","B",.5,.5)

"BLD",6098,"KRN","B",.84,.84)

"BLD",6098,"KRN","B",3.6,3.6)

"BLD",6098,"KRN","B",3.8,3.8)

"BLD",6098,"KRN","B",9.2,9.2)

"BLD",6098,"KRN","B",9.8,9.8)

"BLD",6098,"KRN","B",19,19)

"BLD",6098,"KRN","B",19.1,19.1)

"BLD",6098,"KRN","B",101,101)

"BLD",6098,"KRN","B",409.61,409.61)

"BLD",6098,"KRN","B",771,771)

"BLD",6098,"KRN","B",870,870)

"BLD",6098,"KRN","B",8989.51,8989.51)

"BLD",6098,"KRN","B",8989.52,8989.52)

"BLD",6098,"KRN","B",8994,8994)

"BLD",6098,"QUES",0)
^9.62^^
"BLD",6098,"REQB",0)
^9.611^1^1
"BLD",6098,"REQB",1,0)
DG*5.3*631^2
"BLD",6098,"REQB","B","DG*5.3*631",1)

"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813
"PKG",5,22,1,"PAH",1,0)
709^3060323
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","DGRP11")
0^1^B11509829
"RTN","DGRP11",1,0)
DGRP11 ;ALB/MRL,RTK,PHH - REGISTRATION SCREEN 11/VERIFICATION INFORMATION ; 3/23/06 8:10am
"RTN","DGRP11",2,0)
 ;;5.3;Registration;**327,631,709**;Aug 13, 1993
"RTN","DGRP11",3,0)
 S DGRPS=11 D H^DGRPU F I=.3,.32,.36,.361,"TYPE","VET" S DGRP(I)=$S($D(^DPT(DFN,I)):^(I),1:"")
"RTN","DGRP11",4,0)
 S (DGRPW,Z)=1 D WW^DGRPV W " Eligibility Status: " S DGRPX=DGRP(.361),X=$P(DGRPX,"^",1),Z=$S(X']"":"NOT VERIFIED",X="V":"VERIFIED",X="R":"PENDING RE-VERIFICATION",1:"PENDING VERIFICATION"),Z1=28 D WW1^DGRPV S DGRPVR=$S(X]"":1,1:0)
"RTN","DGRP11",5,0)
 W "Status Date: " S Y=$P(DGRPX,"^",2) X:Y]"" ^DD("DD") W $S(Y]"":Y,DGRPVR:DGRPU,1:DGRPNA),!?5,"Status Entered By: ",$S($D(^VA(200,+$P(DGRPX,"^",6),0)):$P(^(0),"^",1)_" (#"_+$P(DGRPX,"^",6)_")",DGRPVR:DGRPU,1:DGRPNA)
"RTN","DGRP11",6,0)
 W !?6,"Interim Response: " S Y=$P(DGRPX,"^",4) X:Y]"" ^DD("DD") W $S(Y]"":Y,1:DGRPU_" (NOT REQUIRED)"),!?9,"Verif. Method: ",$S($P(DGRPX,"^",5)]"":$P(DGRPX,"^",5),DGRPVR:DGRPU,1:DGRPNA)
"RTN","DGRP11",7,0)
 ;Added display of ELIGIBILITY VERIF. SOURCE for Ineligible Project:
"RTN","DGRP11",8,0)
 W !?9,"Verif. Source: ",$S($P(DGRPX,"^",3)="H":"HEC",$P(DGRPX,"^",3)="V":"VISTA",1:"NOT AVAILABLE")
"RTN","DGRP11",9,0)
 S Z=2 D WW^DGRPV W "     Money Verified: " S Y=$P(DGRP(.3),"^",6) X:Y]"" ^DD("DD") W $S(Y]"":Y,1:"NOT VERIFIED") S Z=3 D WW^DGRPV W "   Service Verified: " S Y=$P(DGRP(.32),"^",2) X:Y]"" ^DD("DD") W $S(Y]"":Y,1:"NOT VERIFIED")
"RTN","DGRP11",10,0)
 S Z=4 D WW^DGRPV W " Rated Disabilities: " I $P(DGRP("VET"),"^",1)'="Y",$S('$D(^DG(391,+DGRP("TYPE"),0)):1,$P(^(0),"^",2):0,1:1) W DGRPNA," - NOT A VETERAN" G Q
"RTN","DGRP11",11,0)
 N DGEC,DGEFF
"RTN","DGRP11",12,0)
 S DGEC=$P($G(DGRP(.36)),U)
"RTN","DGRP11",13,0)
 I $G(DGEC) I $D(^DIC(8,DGEC)) S DGEC=$P(^DIC(8,DGEC,0),U)
"RTN","DGRP11",14,0)
 W " SC%: ",$S($G(DGEC)="NSC":"",$P($G(DGRP(.3)),U,2)="":"",1:$P($G(DGRP(.3)),U,2))
"RTN","DGRP11",15,0)
 S DGEFF=$P($G(DGRP(.3)),U,14)
"RTN","DGRP11",16,0)
 I $G(DGEFF)]"" S Y=DGEFF X ^DD("DD") S DGEFF=Y
"RTN","DGRP11",17,0)
 W "    EFF. DATE OF COMBINED SC%: "_$G(DGEFF),!
"RTN","DGRP11",18,0)
 N DGQUIT
"RTN","DGRP11",19,0)
 W ?55,"Orig",?70,"Curr"
"RTN","DGRP11",20,0)
 W !?3,"Rated Disability",?46,"Extr",?55,"Eff Dt",?70,"Eff Dt"
"RTN","DGRP11",21,0)
 S I3=0
"RTN","DGRP11",22,0)
 I '$$RDIS^DGRPDB(DFN,.DGARR) W !,"NONE STATED" G Q
"RTN","DGRP11",23,0)
 F DGC=0:0 S DGC=$O(DGARR(DGC)) Q:'DGC  D
"RTN","DGRP11",24,0)
 . S I3=I3+1
"RTN","DGRP11",25,0)
 . N DGCURR,DGORIG,DG0,DG1,DG2,DG4,DG5
"RTN","DGRP11",26,0)
 . I $G(DGARR(DGC))']"" Q
"RTN","DGRP11",27,0)
 . S DGZERO=+DGARR(DGC)
"RTN","DGRP11",28,0)
 . I '$D(^DIC(31,DGZERO,0)) Q
"RTN","DGRP11",29,0)
 . S DG0=$P(^DIC(31,DGZERO,0),U,3)
"RTN","DGRP11",30,0)
 . S DG1=$P(^DIC(31,DGZERO,0),U)
"RTN","DGRP11",31,0)
 . S DG2="("_$S($P(DGARR(DGC),U,3)=1:$P(DGARR(DGC),U,2)_"% SC",$P(DGARR(DGC),U,3)]"":$P(DGARR(DGC),U,2)_"% NSC",1:"unspec")_")"
"RTN","DGRP11",32,0)
 . S DG4=$P(DGARR(DGC),U,4),DG5=$P(DGARR(DGC),U,5),DG6=$P(DGARR(DGC),U,6)
"RTN","DGRP11",33,0)
 . I DG5]"" S Y=DG5 X ^DD("DD") S DGORIG=Y
"RTN","DGRP11",34,0)
 . I DG6]"" S Y=DG6 X ^DD("DD") S DGCURR=Y
"RTN","DGRP11",35,0)
 . I $Y>(IOSL-3) D PAUSE^DGRPDB I $G(DGQUIT)=0 W @IOF
"RTN","DGRP11",36,0)
 . I $G(DGQUIT)=1 Q
"RTN","DGRP11",37,0)
 . W !,$G(DG0)_"-",DG1,DG2,?47,$G(DG4),?50," - ",?53,$G(DGORIG),?64," - ",?68,$G(DGCURR)
"RTN","DGRP11",38,0)
 W:'I3 !,"NONE STATED"
"RTN","DGRP11",39,0)
Q G ^DGRPP
"RTN","DGRPDB")
0^2^B20476702
"RTN","DGRPDB",1,0)
DGRPDB ;ALB/AAS,JAN,ERC,PHH - VIEW ONLY SCREEN TO DETERMINE BILLING ELIGIBILITY ; 3/23/06 8:16am
"RTN","DGRPDB",2,0)
 ;;5.3;Registration;**26,50,358,570,631,709**;Aug 13, 1993
"RTN","DGRPDB",3,0)
 ;
"RTN","DGRPDB",4,0)
% S:'$D(DGQUIT) DGQUIT=0
"RTN","DGRPDB",5,0)
 G:DGQUIT END S DIC="^DPT(",DIC(0)="AEQMN" D ^DIC G:+Y<1 END S DFN=+Y D EN
"RTN","DGRPDB",6,0)
 G %
"RTN","DGRPDB",7,0)
 ;
"RTN","DGRPDB",8,0)
EN ;entry with DFN defined.
"RTN","DGRPDB",9,0)
 Q:'$D(DFN)  D HOME^%ZIS,2^VADPT,HDR
"RTN","DGRPDB",10,0)
 D MT,AOIR,ELIG,DIS
"RTN","DGRPDB",11,0)
 N DGINS
"RTN","DGRPDB",12,0)
 I $$INSUR^IBBAPI(DFN,"","AR",.DGINS,1)
"RTN","DGRPDB",13,0)
 S C="",C=$O(DGINS("IBBAPI","INSUR",C),-1),C=+C+6
"RTN","DGRPDB",14,0)
 D:($Y>(IOSL-C)) PAUSE,HDR:'DGQUIT Q:DGQUIT  D INS,PAUSE
"RTN","DGRPDB",15,0)
 Q
"RTN","DGRPDB",16,0)
 ;
"RTN","DGRPDB",17,0)
ELIG ;eligibility code(s)
"RTN","DGRPDB",18,0)
 W !!," Primary Elig. Code: ",$P(VAEL(1),"^",2),"  --  ",$S(VAEL(8)']"":"NOT VERIFIED",1:$P(VAEL(8),"^",2))
"RTN","DGRPDB",19,0)
 I VAEL(8)]"" S Y=$S($D(^DPT(DFN,.361)):$P(^(.361),"^",2),1:"") W "  " D DT^DIQ
"RTN","DGRPDB",20,0)
 W !,"Other Elig. Code(s): " I $D(VAEL(1))>9 S I1=0 F I=0:0 S I=$O(VAEL(1,I)) Q:'I  S I1=I1+1 W:I1>1 !?21 W $P(VAEL(1,I),"^",2)
"RTN","DGRPDB",21,0)
 E  W "NO ADDITIONAL ELIGIBILITIES IDENTIFIED"
"RTN","DGRPDB",22,0)
 Q
"RTN","DGRPDB",23,0)
 ;
"RTN","DGRPDB",24,0)
DIS ;rated disabilities - Integration Agreement #700
"RTN","DGRPDB",25,0)
 ;
"RTN","DGRPDB",26,0)
 ;  This is called from the FEE and MCCR package!!!
"RTN","DGRPDB",27,0)
 ;
"RTN","DGRPDB",28,0)
 ;  Input:  DFN as IEN of PATIENT file
"RTN","DGRPDB",29,0)
 ;          VAEL array (if no passed, it is set) of eligibility info
"RTN","DGRPDB",30,0)
 ;
"RTN","DGRPDB",31,0)
 I '$D(VAEL) D ELIG^VADPT S DGKVAR=1
"RTN","DGRPDB",32,0)
 W:'+VAEL(3) !!,"  Service Connected: NO" W:+VAEL(3) !!,"         SC Percent: ",$P(VAEL(3),"^",2)_"%"
"RTN","DGRPDB",33,0)
 N DGQUIT
"RTN","DGRPDB",34,0)
 W !," Rated Disabilities: " I 'VAEL(4),$S('$D(^DG(391,+VAEL(6),0)):1,$P(^(0),"^",2):0,1:1) W "NOT A VETERAN" G DISQ
"RTN","DGRPDB",35,0)
 S I3=0 F I=0:0 S I=$O(^DPT(DFN,.372,I)) Q:'I!($G(DGQUIT)=1)  D
"RTN","DGRPDB",36,0)
 . S I1=^(I,0),I2=$S($D(^DIC(31,+I1,0)):$P(^(0),"^",1)_" ("_+$P(I1,"^",2)_"%-"_$S($P(I1,"^",3):"SC",$P(I1,"^",3)']"":"not specified",1:"NSC")_")",1:""),I3=I3+1
"RTN","DGRPDB",37,0)
 . I $Y>(IOSL-3) D PAUSE I $G(DGQUIT)=0 W @IOF
"RTN","DGRPDB",38,0)
 . I $G(DGQUIT)=1 Q
"RTN","DGRPDB",39,0)
 . W:I3>1 !?21 W I2
"RTN","DGRPDB",40,0)
 W:'I3 "NONE STATED"
"RTN","DGRPDB",41,0)
DISQ I $D(DGKVAR) D KVAR^VADPT K DGKVAR
"RTN","DGRPDB",42,0)
 K I,I1,I2,I3
"RTN","DGRPDB",43,0)
 Q
"RTN","DGRPDB",44,0)
 ;
"RTN","DGRPDB",45,0)
INS ;insurance information
"RTN","DGRPDB",46,0)
 ;
"RTN","DGRPDB",47,0)
 ;  This is called form the FEE package!!!
"RTN","DGRPDB",48,0)
 ;
"RTN","DGRPDB",49,0)
 ;  Input:  DFN as IEN of PATIENT file
"RTN","DGRPDB",50,0)
 ;          DGINSDT as date to compute insurance flag as of (default DT)
"RTN","DGRPDB",51,0)
 ;
"RTN","DGRPDB",52,0)
 Q:'$D(DFN)
"RTN","DGRPDB",53,0)
 W !!,"    Health Insurance: "
"RTN","DGRPDB",54,0)
 S Z=$$INSUR^IBBAPI(DFN,$S($D(DGINSDT):DGINSDT,1:DT))
"RTN","DGRPDB",55,0)
 W $S(Z:"YES",1:"NO")
"RTN","DGRPDB",56,0)
 D DISP^DGIBDSP
"RTN","DGRPDB",57,0)
INSQ K I,I1,DGX,Z
"RTN","DGRPDB",58,0)
 Q
"RTN","DGRPDB",59,0)
 ;
"RTN","DGRPDB",60,0)
IN ; Old code
"RTN","DGRPDB",61,0)
 Q
"RTN","DGRPDB",62,0)
 ;
"RTN","DGRPDB",63,0)
AOIR ;Agent Orange/ionizing radiation
"RTN","DGRPDB",64,0)
 S DGX=$S($D(^DPT(DFN,.321)):^(.321),1:"")
"RTN","DGRPDB",65,0)
 F I=2,3 S X=$P(DGX,"^",I) W:I=2 !,"           A/O Exp.: " W:I=3 "ION Rad.: " W $S(X="Y":"YES",X="N":"NO",X="U":"UNKNOWN",1:"NOT ANSWERED"),"   "
"RTN","DGRPDB",66,0)
 S X=$G(^DPT(DFN,.38)),X1=$P(X,"^",1) W "Medicaid Elig: ",$S(X1="":"NOT ANSWERED",'X1:"NO",1:"YES") I ($X+15)'>IOM W " - " S Y=$P(X,"^",2) D D^DIQ W $P(Y,"@")
"RTN","DGRPDB",67,0)
 Q
"RTN","DGRPDB",68,0)
 ;
"RTN","DGRPDB",69,0)
PAUSE F J=1:1 Q:($Y>(IOSL-3))  W !
"RTN","DGRPDB",70,0)
 S DGX1="" I $E(IOST,1,2)["C-" N DIR S DIR(0)="E" D ^DIR S DGQUIT='Y
"RTN","DGRPDB",71,0)
 Q
"RTN","DGRPDB",72,0)
 ;
"RTN","DGRPDB",73,0)
HDR ;Screen Header
"RTN","DGRPDB",74,0)
 W @IOF I $P(VAEL(6),"^",2)]"" S DGTYPE=$P(VAEL(6),"^",2)
"RTN","DGRPDB",75,0)
 W $P(VADM(1),"^",1),?32,VA("PID"),?47,$P(VADM(3),"^",2) S X=$S($D(DGTYPE):$P(DGTYPE,"^",1),1:"PATIENT TYPE UNKNOWN"),X1=79-$L(X) W ?X1,X
"RTN","DGRPDB",76,0)
 S X="",$P(X,"=",80)="" W !,X Q
"RTN","DGRPDB",77,0)
 Q
"RTN","DGRPDB",78,0)
 ;
"RTN","DGRPDB",79,0)
MT I '$O(^DGMT(408.31,"AD",1,DFN,0)) W !,"  Means Test Status:  NOT IN MEANS TEST FILE" Q
"RTN","DGRPDB",80,0)
 ;if patient is on a DOM ward, don't display Means Test required message
"RTN","DGRPDB",81,0)
 D DOM^DGMTR D:'$G(DGDOM) DIS^DGMTU(DFN) K DGDOM
"RTN","DGRPDB",82,0)
 Q
"RTN","DGRPDB",83,0)
 ;
"RTN","DGRPDB",84,0)
END D KVAR^VADPT
"RTN","DGRPDB",85,0)
 K A,C,I,I1,I2,I3,J,DIC,DIR,DFN,DGA1,DGMT,DGMTL,DGMTLA,DGX,DGX1,DGT,DGTYPE,DGQUIT,DGMTLL,X,X1,VAROOT,VA,Y,Z
"RTN","DGRPDB",86,0)
 Q
"RTN","DGRPDB",87,0)
 ;
"RTN","DGRPDB",88,0)
RDIS(DGDFN,DGARR) ;API will reutrn all Rated Disabilities from the 
"RTN","DGRPDB",89,0)
 ;
"RTN","DGRPDB",90,0)
 ;Integration Agreement - #????
"RTN","DGRPDB",91,0)
 ;
"RTN","DGRPDB",92,0)
 ;Patient file for a patient and put them into the array sent in.
"RTN","DGRPDB",93,0)
 ;Input  DGDFN - IEN of patient file (required)
"RTN","DGRPDB",94,0)
 ;       DGARR - name of array for returned disability info (required)
"RTN","DGRPDB",95,0)
 ;               piece 1 - Disability IEN (in file 31)
"RTN","DGRPDB",96,0)
 ;               piece 2 - SC%
"RTN","DGRPDB",97,0)
 ;               piece 3 - SC? (1,0)
"RTN","DGRPDB",98,0)
 ;               piece 4 - extremity
"RTN","DGRPDB",99,0)
 ;               piece 5 - original award date
"RTN","DGRPDB",100,0)
 ;               piece 6 - current award date
"RTN","DGRPDB",101,0)
 ;Output  DGOK - success or failure, 1=success, 0=failure
"RTN","DGRPDB",102,0)
 N DGARR1,DGC,DGCC,DGERR,DGNODE
"RTN","DGRPDB",103,0)
 K DGARR,DGOK
"RTN","DGRPDB",104,0)
 I $G(DGDFN)']"" S DGOK=0 Q DGOK
"RTN","DGRPDB",105,0)
 I '$D(^DPT(DGDFN,0)) S DGOK=0 Q DGOK
"RTN","DGRPDB",106,0)
 D GETS^DIQ(2,DGDFN,".3721*","I","DGARR1","DGERR")
"RTN","DGRPDB",107,0)
 I $D(DGERR) S DGOK=0 Q DGOK
"RTN","DGRPDB",108,0)
 S DGOK=1
"RTN","DGRPDB",109,0)
 S DGC=""
"RTN","DGRPDB",110,0)
 S DGCC=$P($G(^DPT(DGDFN,.372,0)),U,3)
"RTN","DGRPDB",111,0)
 I $G(DGCC)'>0 S DGOK=0 Q DGOK
"RTN","DGRPDB",112,0)
 F  S DGC=$O(DGARR1(2.04,DGC)) Q:DGC']""  D
"RTN","DGRPDB",113,0)
 . S DGNODE=DGC
"RTN","DGRPDB",114,0)
 . S DGARR(DGC)=DGARR1(2.04,DGNODE,.01,"I")_"^"_DGARR1(2.04,DGNODE,2,"I")_"^"_DGARR1(2.04,DGNODE,3,"I")_"^"_DGARR1(2.04,DGNODE,4,"I")_"^"_DGARR1(2.04,DGNODE,5,"I")_"^"_DGARR1(2.04,DGNODE,6,"I")
"RTN","DGRPDB",115,0)
 K DGW
"RTN","DGRPDB",116,0)
 N DGCT,DGE,DGEE
"RTN","DGRPDB",117,0)
 S DGE=""
"RTN","DGRPDB",118,0)
 F  S DGE=$O(DGARR(DGE)) Q:'DGE  S DGW($P(DGARR(DGE),U,2),$P(DGE,",",1))=DGARR(DGE)
"RTN","DGRPDB",119,0)
 S DGE="",DGCT=1
"RTN","DGRPDB",120,0)
 K DGARR
"RTN","DGRPDB",121,0)
 F  S DGE=$O(DGW(DGE),-1) Q:DGE']""  D
"RTN","DGRPDB",122,0)
 . F DGEE=0:0 S DGEE=$O(DGW(DGE,DGEE)) Q:DGEE'>0  D
"RTN","DGRPDB",123,0)
 . . S DGARR(DGCT)=DGW(DGE,DGEE) S DGCT=DGCT+1
"RTN","DGRPDB",124,0)
 K DGW
"RTN","DGRPDB",125,0)
 Q DGOK
"VER")
8.0^22.0
**END**
**END**
