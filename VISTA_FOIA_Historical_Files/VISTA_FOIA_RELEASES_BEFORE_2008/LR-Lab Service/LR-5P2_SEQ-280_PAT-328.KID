Released LR*5.2*328 SEQ #280
Extracted from mail message
**KIDS**:LR*5.2*328^

**INSTALL NAME**
LR*5.2*328
"BLD",6302,0)
LR*5.2*328^LAB SERVICE^0^3060525^y
"BLD",6302,1,0)
^9.61A^209^209^3060525^^^^
"BLD",6302,1,1,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*328 does not
"BLD",6302,1,2,0)
contain any changes to the VISTA BLOOD BANK Software as defined by VHA
"BLD",6302,1,3,0)
DIRECTIVE 2004-053 titled VISTA BLOOD BANK SOFTWARE VERSION 5.2.
"BLD",6302,1,4,0)
 
"BLD",6302,1,5,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*328 does not
"BLD",6302,1,6,0)
alter or modify any software design safeguards or safety critical elements
"BLD",6302,1,7,0)
functions.
"BLD",6302,1,8,0)
 
"BLD",6302,1,9,0)
RISK ANALYSIS: Changes made by patch LR*5.2*328 have no effect on Blood
"BLD",6302,1,10,0)
Bank software functionality, therefore RISK is none.
"BLD",6302,1,11,0)
 
"BLD",6302,1,12,0)
VALIDATION REQUIREMENTS BY OPTION: Because of the nature of the changes
"BLD",6302,1,13,0)
made, no specific validation requirements exist as a result of installation
"BLD",6302,1,14,0)
of this patch.
"BLD",6302,1,15,0)
 
"BLD",6302,1,16,0)
 
"BLD",6302,1,17,0)
Nature of Problem:
"BLD",6302,1,18,0)
 PSI-04-059 identified a patient safety issue identified during the
"BLD",6302,1,19,0)
 testing phase of the Laboratory Electronic Data Interchange (LEDI III)
"BLD",6302,1,20,0)
 software patches LA*5.2*64 and LR*5.2*286.
"BLD",6302,1,21,0)
 
"BLD",6302,1,22,0)
 Two test sites reported an undefined error related to the variable SEX
"BLD",6302,1,23,0)
 which contains the patient's sex. During analysis of the reported error,
"BLD",6302,1,24,0)
 it was determined, by the laboratory development team, that the variable
"BLD",6302,1,25,0)
 that referenced the patient's sex was being killed between accessions when
"BLD",6302,1,26,0)
 a laboratory order created two or more accessions.
"BLD",6302,1,27,0)
 
"BLD",6302,1,28,0)
 The problem occurs when laboratory users enter laboratory test results
"BLD",6302,1,29,0)
 using the VistA Laboratory option "Accession order then immediately enter
"BLD",6302,1,30,0)
 data [LR ACC THEN DATA]".  If the laboratory order being processed
"BLD",6302,1,31,0)
 creates two or more accessions, the second and any subsequent accessions,
"BLD",6302,1,32,0)
 may calculate age and/or sex based normals and abnormals incorrectly.
"BLD",6302,1,33,0)
 
"BLD",6302,1,34,0)
 We believe this to be a pre-existing problem; however, we cannot
"BLD",6302,1,35,0)
 determine how long the problem has been occurring. It is unknown as to
"BLD",6302,1,36,0)
 whether any specific incidents have occurred if any.  Also, but most
"BLD",6302,1,37,0)
 importantly, no patients were harmed.
"BLD",6302,1,38,0)
 
"BLD",6302,1,39,0)
Solution:
"BLD",6302,1,40,0)
 The LR*5.2*328 patch was developed which will set patient's demographics
"BLD",6302,1,41,0)
 between processing of accessions when using the "Accession order then
"BLD",6302,1,42,0)
 immediately enter data [LR ACC THEN DATA]" option.  This will ensure that
"BLD",6302,1,43,0)
 the patient's age/sex is defined before calculating any age/sex based
"BLD",6302,1,44,0)
 normals and determining abnormality flags.
"BLD",6302,1,45,0)
 
"BLD",6302,1,46,0)
 The routine LRFAST is modified to define the applicable patient 
"BLD",6302,1,47,0)
 demographic values for sex, date of birth, and age when processing each
"BLD",6302,1,48,0)
 accession associated with the order.
"BLD",6302,1,49,0)
 
"BLD",6302,1,50,0)
 
"BLD",6302,1,51,0)
 ASSOCIATED E3R
"BLD",6302,1,52,0)
 --------------
"BLD",6302,1,53,0)
 None
"BLD",6302,1,54,0)
 
"BLD",6302,1,55,0)
 ASSOCIATED REMEDY
"BLD",6302,1,56,0)
 ---------------
"BLD",6302,1,57,0)
 None
"BLD",6302,1,58,0)
 
"BLD",6302,1,59,0)
 ASSOCIATED PSI
"BLD",6302,1,60,0)
 ---------------
"BLD",6302,1,61,0)
 PSI-04-059 PATIENT SAFETY ISSUE: Laboratory, 11/3/2004 5:20:06 PM
"BLD",6302,1,62,0)
 
"BLD",6302,1,63,0)
  
"BLD",6302,1,64,0)
 TEST SITES
"BLD",6302,1,65,0)
 ----------
"BLD",6302,1,66,0)
 Durham VAMC 
"BLD",6302,1,67,0)
 Manchester VAMC
"BLD",6302,1,68,0)
 Milwaukee VAMC
"BLD",6302,1,69,0)
 North Chicago VAMC
"BLD",6302,1,70,0)
 
"BLD",6302,1,71,0)
 
"BLD",6302,1,72,0)
ROUTINE SUMMARY
"BLD",6302,1,73,0)
===============
"BLD",6302,1,74,0)
  The following routines are included in this patch.  The second line
"BLD",6302,1,75,0)
  of each of these routines now looks like:
"BLD",6302,1,76,0)
  <tab> ;;5.2;LAB SERVICE;<patchlist>;Sep 27, 1994
"BLD",6302,1,77,0)
 
"BLD",6302,1,78,0)
                    Checksum       Checksum
"BLD",6302,1,79,0)
   Routine Name     Before Patch   After Patch    Patch List
"BLD",6302,1,80,0)
   ------------     ------------   -----------    ------------
"BLD",6302,1,81,0)
   LR328            N/A            4831454        **328** (Deleted by KIDS)
"BLD",6302,1,82,0)
   LRFAST           19472230       19464995       **100,121,201,286,291,328**
"BLD",6302,1,83,0)
 
"BLD",6302,1,84,0)
 List of preceding patches: 291
"BLD",6302,1,85,0)
 Sites should use CHECK^XTSUMBLD to verify checksums.
"BLD",6302,1,86,0)
 
"BLD",6302,1,87,0)
 
"BLD",6302,1,88,0)
INSTALLATION INSTRUCTIONS
"BLD",6302,1,89,0)
-------------------------
"BLD",6302,1,90,0)
  The install time for this patch is less than 5 minute. This patch
"BLD",6302,1,91,0)
  can be installed when Laboratory users are on the system.
"BLD",6302,1,92,0)
  Suggested time to install: non-peak requirement hours.
"BLD",6302,1,93,0)
 
"BLD",6302,1,94,0)
 
"BLD",6302,1,95,0)
NOTE: Kernel patches must be current on the target system to avoid
"BLD",6302,1,96,0)
      problems loading and/or installing this patch.
"BLD",6302,1,97,0)
 
"BLD",6302,1,98,0)
      Patch installation needs to be coordinated with the Laboratory
"BLD",6302,1,99,0)
      Information Manager (LIM/ADPAC).
"BLD",6302,1,100,0)
 
"BLD",6302,1,101,0)
 
"BLD",6302,1,102,0)
  1.  If any of the above routines are mapped, disable mapping for them.
"BLD",6302,1,103,0)
 
"BLD",6302,1,104,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"BLD",6302,1,105,0)
        option will load the KIDS package onto your system.
"BLD",6302,1,106,0)
 
"BLD",6302,1,107,0)
  3.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"BLD",6302,1,108,0)
      select the 'Installation' menu.
"BLD",6302,1,109,0)
 
"BLD",6302,1,110,0)
  4.  From this menu, you may then elect to use the following options
"BLD",6302,1,111,0)
      (when prompted for the INSTALL NAME, enter LR*5.2*328):
"BLD",6302,1,112,0)
        a. Print Transport Global
"BLD",6302,1,113,0)
        b. Backup a Transport Global
"BLD",6302,1,114,0)
        c. Compare Transport Global to Current System
"BLD",6302,1,115,0)
        d. Verify Checksums in Transport Global
"BLD",6302,1,116,0)
 
"BLD",6302,1,117,0)
      Use the 'Verify Checksum in Transport Global' option and verify that
"BLD",6302,1,118,0)
      all routines have the correct checksums.
"BLD",6302,1,119,0)
 
"BLD",6302,1,120,0)
  5.  Use the 'Install Package(s)' option under the 'Installation' menu
"BLD",6302,1,121,0)
      and select the package 'LR*5.2*328'.  When prompted 'Want KIDS to
"BLD",6302,1,122,0)
      INHIBIT LOGONs during the install? YES// choose 'NO'.  When prompted
"BLD",6302,1,123,0)
      'Want to DISABLE Scheduled Options, Menu Options, and Protocols?
"BLD",6302,1,124,0)
      YES//', choose 'NO'.
"BLD",6302,1,125,0)
 
"BLD",6302,1,126,0)
      During install KIDS will place the "Accession order then immediately
"BLD",6302,1,127,0)
      enter data option [LR ACC THEN DATA] out of order.
"BLD",6302,1,128,0)
 
"BLD",6302,1,129,0)
  6.  On a mapped system, rebuild your map set.
"BLD",6302,1,130,0)
 
"BLD",6302,1,131,0)
 Note: Routine LR328 will be deleted after successful patch installation.
"BLD",6302,1,132,0)
 
"BLD",6302,1,133,0)
 
"BLD",6302,1,134,0)
INSTALLATION EXAMPLE
"BLD",6302,1,135,0)
==================== 
"BLD",6302,1,136,0)
 
"BLD",6302,1,137,0)
Select Installation Option: 6  Install Package(s)
"BLD",6302,1,138,0)
Select INSTALL NAME: LR*5.2*328 Loaded from Distribution Loaded from
"BLD",6302,1,139,0)
Distribution  4/21/05@16:56:33
"BLD",6302,1,140,0)
     => LR*5.2*328
"BLD",6302,1,141,0)
 
"BLD",6302,1,142,0)
This Distribution was loaded on Apr 21, 2005@16:56:33 with header of
"BLD",6302,1,143,0)
   LR*5.2*328
"BLD",6302,1,144,0)
   It consisted of the following Install(s):
"BLD",6302,1,145,0)
     LR*5.2*328
"BLD",6302,1,146,0)
Checking Install for Package LR*5.2*328
"BLD",6302,1,147,0)
Will first run the Environment Check Routine, LR328
"BLD",6302,1,148,0)
 
"BLD",6302,1,149,0)
 
"BLD",6302,1,150,0)
               Sending install started alert to mail group G.LMI
"BLD",6302,1,151,0)
 
"BLD",6302,1,152,0)
                        --- Environment Check is Ok ---
"BLD",6302,1,153,0)
 
"BLD",6302,1,154,0)
Install Questions for LR*5.2*328
"BLD",6302,1,155,0)
 
"BLD",6302,1,156,0)
 
"BLD",6302,1,157,0)
Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// NO
"BLD",6302,1,158,0)
 
"BLD",6302,1,159,0)
 
"BLD",6302,1,160,0)
Want KIDS to INHIBIT LOGONs during the install? YES// NO
"BLD",6302,1,161,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"BLD",6302,1,162,0)
 
"BLD",6302,1,163,0)
 Install Started for LR*5.2*328 :
"BLD",6302,1,164,0)
               Apr 21, 2005@16:58:02
"BLD",6302,1,165,0)
 
"BLD",6302,1,166,0)
Build Distribution Date: Apr 21, 2005
"BLD",6302,1,167,0)
 
"BLD",6302,1,168,0)
 Installing Routines:
"BLD",6302,1,169,0)
               Apr 21, 2005@16:58:02
"BLD",6302,1,170,0)
 
"BLD",6302,1,171,0)
 Running Pre-Install Routine: PRE^LR328
"BLD",6302,1,172,0)
 
"BLD",6302,1,173,0)
                          *** Pre install started ***
"BLD",6302,1,174,0)
 
"BLD",6302,1,175,0)
                           *** No action required ***
"BLD",6302,1,176,0)
 
"BLD",6302,1,177,0)
                         *** Pre install completed ***
"BLD",6302,1,178,0)
 
"BLD",6302,1,179,0)
 Installing PACKAGE COMPONENTS:
"BLD",6302,1,180,0)
 
"BLD",6302,1,181,0)
 Installing OPTION
"BLD",6302,1,182,0)
               Apr 21, 2005@16:58:02
"BLD",6302,1,183,0)
 
"BLD",6302,1,184,0)
 Running Post-Install Routine: POST^LR328
"BLD",6302,1,185,0)
 
"BLD",6302,1,186,0)
                          *** Post install started ***
"BLD",6302,1,187,0)
 
"BLD",6302,1,188,0)
                           *** No action required ***
"BLD",6302,1,189,0)
 
"BLD",6302,1,190,0)
                         *** Post install completed ***
"BLD",6302,1,191,0)
 
"BLD",6302,1,192,0)
              Sending install completion alert to mail group G.LMI
"BLD",6302,1,193,0)
 
"BLD",6302,1,194,0)
 Updating Routine file...
"BLD",6302,1,195,0)
 
"BLD",6302,1,196,0)
 Updating KIDS files...
"BLD",6302,1,197,0)
 
"BLD",6302,1,198,0)
 LR*5.2*328 Installed.
"BLD",6302,1,199,0)
               Apr 21, 2005@16:58:03
"BLD",6302,1,200,0)
 
"BLD",6302,1,201,0)
 Install Message sent #XXXX
"BLD",6302,1,202,0)
 
"BLD",6302,1,203,0)
Install Completed
"BLD",6302,1,204,0)

"BLD",6302,1,205,0)

"BLD",6302,1,206,0)

"BLD",6302,1,207,0)

"BLD",6302,1,208,0)

"BLD",6302,1,209,0)

"BLD",6302,4,0)
^9.64PA^^
"BLD",6302,6.3)
1
"BLD",6302,"ABPKG")
n
"BLD",6302,"INI")
PRE^LR328
"BLD",6302,"INID")
y
"BLD",6302,"INIT")
POST^LR328
"BLD",6302,"KRN",0)
^9.67PA^8989.52^19
"BLD",6302,"KRN",.4,0)
.4
"BLD",6302,"KRN",.401,0)
.401
"BLD",6302,"KRN",.402,0)
.402
"BLD",6302,"KRN",.403,0)
.403
"BLD",6302,"KRN",.5,0)
.5
"BLD",6302,"KRN",.84,0)
.84
"BLD",6302,"KRN",3.6,0)
3.6
"BLD",6302,"KRN",3.8,0)
3.8
"BLD",6302,"KRN",9.2,0)
9.2
"BLD",6302,"KRN",9.8,0)
9.8
"BLD",6302,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6302,"KRN",9.8,"NM",1,0)
LRFAST^^0^B29752400
"BLD",6302,"KRN",9.8,"NM","B","LRFAST",1)

"BLD",6302,"KRN",19,0)
19
"BLD",6302,"KRN",19,"NM",0)
^9.68A^2^1
"BLD",6302,"KRN",19,"NM",2,0)
LR ACC THEN DATA^^5^
"BLD",6302,"KRN",19,"NM","B","LR ACC THEN DATA",2)

"BLD",6302,"KRN",19.1,0)
19.1
"BLD",6302,"KRN",101,0)
101
"BLD",6302,"KRN",409.61,0)
409.61
"BLD",6302,"KRN",771,0)
771
"BLD",6302,"KRN",870,0)
870
"BLD",6302,"KRN",8989.51,0)
8989.51
"BLD",6302,"KRN",8989.52,0)
8989.52
"BLD",6302,"KRN",8994,0)
8994
"BLD",6302,"KRN","B",.4,.4)

"BLD",6302,"KRN","B",.401,.401)

"BLD",6302,"KRN","B",.402,.402)

"BLD",6302,"KRN","B",.403,.403)

"BLD",6302,"KRN","B",.5,.5)

"BLD",6302,"KRN","B",.84,.84)

"BLD",6302,"KRN","B",3.6,3.6)

"BLD",6302,"KRN","B",3.8,3.8)

"BLD",6302,"KRN","B",9.2,9.2)

"BLD",6302,"KRN","B",9.8,9.8)

"BLD",6302,"KRN","B",19,19)

"BLD",6302,"KRN","B",19.1,19.1)

"BLD",6302,"KRN","B",101,101)

"BLD",6302,"KRN","B",409.61,409.61)

"BLD",6302,"KRN","B",771,771)

"BLD",6302,"KRN","B",870,870)

"BLD",6302,"KRN","B",8989.51,8989.51)

"BLD",6302,"KRN","B",8989.52,8989.52)

"BLD",6302,"KRN","B",8994,8994)

"BLD",6302,"PRE")
LR328
"BLD",6302,"QUES",0)
^9.62^^
"BLD",6302,"REQB",0)
^9.611^1^1
"BLD",6302,"REQB",1,0)
LR*5.2*291^2
"BLD",6302,"REQB","B","LR*5.2*291",1)

"INI")
PRE^LR328
"INIT")
POST^LR328
"KRN",19,8622,-1)
5^2
"KRN",19,8622,0)
LR ACC THEN DATA
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2981028^66481
"PKG",26,22,1,"PAH",1,0)
328^3060525^235
"PKG",26,22,1,"PAH",1,1,0)
^^209^209^3060525
"PKG",26,22,1,"PAH",1,1,1,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*328 does not
"PKG",26,22,1,"PAH",1,1,2,0)
contain any changes to the VISTA BLOOD BANK Software as defined by VHA
"PKG",26,22,1,"PAH",1,1,3,0)
DIRECTIVE 2004-053 titled VISTA BLOOD BANK SOFTWARE VERSION 5.2.
"PKG",26,22,1,"PAH",1,1,4,0)
 
"PKG",26,22,1,"PAH",1,1,5,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*328 does not
"PKG",26,22,1,"PAH",1,1,6,0)
alter or modify any software design safeguards or safety critical elements
"PKG",26,22,1,"PAH",1,1,7,0)
functions.
"PKG",26,22,1,"PAH",1,1,8,0)
 
"PKG",26,22,1,"PAH",1,1,9,0)
RISK ANALYSIS: Changes made by patch LR*5.2*328 have no effect on Blood
"PKG",26,22,1,"PAH",1,1,10,0)
Bank software functionality, therefore RISK is none.
"PKG",26,22,1,"PAH",1,1,11,0)
 
"PKG",26,22,1,"PAH",1,1,12,0)
VALIDATION REQUIREMENTS BY OPTION: Because of the nature of the changes
"PKG",26,22,1,"PAH",1,1,13,0)
made, no specific validation requirements exist as a result of installation
"PKG",26,22,1,"PAH",1,1,14,0)
of this patch.
"PKG",26,22,1,"PAH",1,1,15,0)
 
"PKG",26,22,1,"PAH",1,1,16,0)
 
"PKG",26,22,1,"PAH",1,1,17,0)
Nature of Problem:
"PKG",26,22,1,"PAH",1,1,18,0)
 PSI-04-059 identified a patient safety issue identified during the
"PKG",26,22,1,"PAH",1,1,19,0)
 testing phase of the Laboratory Electronic Data Interchange (LEDI III)
"PKG",26,22,1,"PAH",1,1,20,0)
 software patches LA*5.2*64 and LR*5.2*286.
"PKG",26,22,1,"PAH",1,1,21,0)
 
"PKG",26,22,1,"PAH",1,1,22,0)
 Two test sites reported an undefined error related to the variable SEX
"PKG",26,22,1,"PAH",1,1,23,0)
 which contains the patient's sex. During analysis of the reported error,
"PKG",26,22,1,"PAH",1,1,24,0)
 it was determined, by the laboratory development team, that the variable
"PKG",26,22,1,"PAH",1,1,25,0)
 that referenced the patient's sex was being killed between accessions when
"PKG",26,22,1,"PAH",1,1,26,0)
 a laboratory order created two or more accessions.
"PKG",26,22,1,"PAH",1,1,27,0)
 
"PKG",26,22,1,"PAH",1,1,28,0)
 The problem occurs when laboratory users enter laboratory test results
"PKG",26,22,1,"PAH",1,1,29,0)
 using the VistA Laboratory option "Accession order then immediately enter
"PKG",26,22,1,"PAH",1,1,30,0)
 data [LR ACC THEN DATA]".  If the laboratory order being processed
"PKG",26,22,1,"PAH",1,1,31,0)
 creates two or more accessions, the second and any subsequent accessions,
"PKG",26,22,1,"PAH",1,1,32,0)
 may calculate age and/or sex based normals and abnormals incorrectly.
"PKG",26,22,1,"PAH",1,1,33,0)
 
"PKG",26,22,1,"PAH",1,1,34,0)
 We believe this to be a pre-existing problem; however, we cannot
"PKG",26,22,1,"PAH",1,1,35,0)
 determine how long the problem has been occurring. It is unknown as to
"PKG",26,22,1,"PAH",1,1,36,0)
 whether any specific incidents have occurred if any.  Also, but most
"PKG",26,22,1,"PAH",1,1,37,0)
 importantly, no patients were harmed.
"PKG",26,22,1,"PAH",1,1,38,0)
 
"PKG",26,22,1,"PAH",1,1,39,0)
Solution:
"PKG",26,22,1,"PAH",1,1,40,0)
 The LR*5.2*328 patch was developed which will set patient's demographics
"PKG",26,22,1,"PAH",1,1,41,0)
 between processing of accessions when using the "Accession order then
"PKG",26,22,1,"PAH",1,1,42,0)
 immediately enter data [LR ACC THEN DATA]" option.  This will ensure that
"PKG",26,22,1,"PAH",1,1,43,0)
 the patient's age/sex is defined before calculating any age/sex based
"PKG",26,22,1,"PAH",1,1,44,0)
 normals and determining abnormality flags.
"PKG",26,22,1,"PAH",1,1,45,0)
 
"PKG",26,22,1,"PAH",1,1,46,0)
 The routine LRFAST is modified to define the applicable patient 
"PKG",26,22,1,"PAH",1,1,47,0)
 demographic values for sex, date of birth, and age when processing each
"PKG",26,22,1,"PAH",1,1,48,0)
 accession associated with the order.
"PKG",26,22,1,"PAH",1,1,49,0)
 
"PKG",26,22,1,"PAH",1,1,50,0)
 
"PKG",26,22,1,"PAH",1,1,51,0)
 ASSOCIATED E3R
"PKG",26,22,1,"PAH",1,1,52,0)
 --------------
"PKG",26,22,1,"PAH",1,1,53,0)
 None
"PKG",26,22,1,"PAH",1,1,54,0)
 
"PKG",26,22,1,"PAH",1,1,55,0)
 ASSOCIATED REMEDY
"PKG",26,22,1,"PAH",1,1,56,0)
 ---------------
"PKG",26,22,1,"PAH",1,1,57,0)
 None
"PKG",26,22,1,"PAH",1,1,58,0)
 
"PKG",26,22,1,"PAH",1,1,59,0)
 ASSOCIATED PSI
"PKG",26,22,1,"PAH",1,1,60,0)
 ---------------
"PKG",26,22,1,"PAH",1,1,61,0)
 PSI-04-059 PATIENT SAFETY ISSUE: Laboratory, 11/3/2004 5:20:06 PM
"PKG",26,22,1,"PAH",1,1,62,0)
 
"PKG",26,22,1,"PAH",1,1,63,0)
  
"PKG",26,22,1,"PAH",1,1,64,0)
 TEST SITES
"PKG",26,22,1,"PAH",1,1,65,0)
 ----------
"PKG",26,22,1,"PAH",1,1,66,0)
 Durham VAMC 
"PKG",26,22,1,"PAH",1,1,67,0)
 Manchester VAMC
"PKG",26,22,1,"PAH",1,1,68,0)
 Milwaukee VAMC
"PKG",26,22,1,"PAH",1,1,69,0)
 North Chicago VAMC
"PKG",26,22,1,"PAH",1,1,70,0)
 
"PKG",26,22,1,"PAH",1,1,71,0)
 
"PKG",26,22,1,"PAH",1,1,72,0)
ROUTINE SUMMARY
"PKG",26,22,1,"PAH",1,1,73,0)
===============
"PKG",26,22,1,"PAH",1,1,74,0)
  The following routines are included in this patch.  The second line
"PKG",26,22,1,"PAH",1,1,75,0)
  of each of these routines now looks like:
"PKG",26,22,1,"PAH",1,1,76,0)
  <tab> ;;5.2;LAB SERVICE;<patchlist>;Sep 27, 1994
"PKG",26,22,1,"PAH",1,1,77,0)
 
"PKG",26,22,1,"PAH",1,1,78,0)
                    Checksum       Checksum
"PKG",26,22,1,"PAH",1,1,79,0)
   Routine Name     Before Patch   After Patch    Patch List
"PKG",26,22,1,"PAH",1,1,80,0)
   ------------     ------------   -----------    ------------
"PKG",26,22,1,"PAH",1,1,81,0)
   LR328            N/A            4831454        **328** (Deleted by KIDS)
"PKG",26,22,1,"PAH",1,1,82,0)
   LRFAST           19472230       19464995       **100,121,201,286,291,328**
"PKG",26,22,1,"PAH",1,1,83,0)
 
"PKG",26,22,1,"PAH",1,1,84,0)
 List of preceding patches: 291
"PKG",26,22,1,"PAH",1,1,85,0)
 Sites should use CHECK^XTSUMBLD to verify checksums.
"PKG",26,22,1,"PAH",1,1,86,0)
 
"PKG",26,22,1,"PAH",1,1,87,0)
 
"PKG",26,22,1,"PAH",1,1,88,0)
INSTALLATION INSTRUCTIONS
"PKG",26,22,1,"PAH",1,1,89,0)
-------------------------
"PKG",26,22,1,"PAH",1,1,90,0)
  The install time for this patch is less than 5 minute. This patch
"PKG",26,22,1,"PAH",1,1,91,0)
  can be installed when Laboratory users are on the system.
"PKG",26,22,1,"PAH",1,1,92,0)
  Suggested time to install: non-peak requirement hours.
"PKG",26,22,1,"PAH",1,1,93,0)
 
"PKG",26,22,1,"PAH",1,1,94,0)
 
"PKG",26,22,1,"PAH",1,1,95,0)
NOTE: Kernel patches must be current on the target system to avoid
"PKG",26,22,1,"PAH",1,1,96,0)
      problems loading and/or installing this patch.
"PKG",26,22,1,"PAH",1,1,97,0)
 
"PKG",26,22,1,"PAH",1,1,98,0)
      Patch installation needs to be coordinated with the Laboratory
"PKG",26,22,1,"PAH",1,1,99,0)
      Information Manager (LIM/ADPAC).
"PKG",26,22,1,"PAH",1,1,100,0)
 
"PKG",26,22,1,"PAH",1,1,101,0)
 
"PKG",26,22,1,"PAH",1,1,102,0)
  1.  If any of the above routines are mapped, disable mapping for them.
"PKG",26,22,1,"PAH",1,1,103,0)
 
"PKG",26,22,1,"PAH",1,1,104,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"PKG",26,22,1,"PAH",1,1,105,0)
        option will load the KIDS package onto your system.
"PKG",26,22,1,"PAH",1,1,106,0)
 
"PKG",26,22,1,"PAH",1,1,107,0)
  3.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"PKG",26,22,1,"PAH",1,1,108,0)
      select the 'Installation' menu.
"PKG",26,22,1,"PAH",1,1,109,0)
 
"PKG",26,22,1,"PAH",1,1,110,0)
  4.  From this menu, you may then elect to use the following options
"PKG",26,22,1,"PAH",1,1,111,0)
      (when prompted for the INSTALL NAME, enter LR*5.2*328):
"PKG",26,22,1,"PAH",1,1,112,0)
        a. Print Transport Global
"PKG",26,22,1,"PAH",1,1,113,0)
        b. Backup a Transport Global
"PKG",26,22,1,"PAH",1,1,114,0)
        c. Compare Transport Global to Current System
"PKG",26,22,1,"PAH",1,1,115,0)
        d. Verify Checksums in Transport Global
"PKG",26,22,1,"PAH",1,1,116,0)
 
"PKG",26,22,1,"PAH",1,1,117,0)
      Use the 'Verify Checksum in Transport Global' option and verify that
"PKG",26,22,1,"PAH",1,1,118,0)
      all routines have the correct checksums.
"PKG",26,22,1,"PAH",1,1,119,0)
 
"PKG",26,22,1,"PAH",1,1,120,0)
  5.  Use the 'Install Package(s)' option under the 'Installation' menu
"PKG",26,22,1,"PAH",1,1,121,0)
      and select the package 'LR*5.2*328'.  When prompted 'Want KIDS to
"PKG",26,22,1,"PAH",1,1,122,0)
      INHIBIT LOGONs during the install? YES// choose 'NO'.  When prompted
"PKG",26,22,1,"PAH",1,1,123,0)
      'Want to DISABLE Scheduled Options, Menu Options, and Protocols?
"PKG",26,22,1,"PAH",1,1,124,0)
      YES//', choose 'NO'.
"PKG",26,22,1,"PAH",1,1,125,0)
 
"PKG",26,22,1,"PAH",1,1,126,0)
      During install KIDS will place the "Accession order then immediately
"PKG",26,22,1,"PAH",1,1,127,0)
      enter data option [LR ACC THEN DATA] out of order.
"PKG",26,22,1,"PAH",1,1,128,0)
 
"PKG",26,22,1,"PAH",1,1,129,0)
  6.  On a mapped system, rebuild your map set.
"PKG",26,22,1,"PAH",1,1,130,0)
 
"PKG",26,22,1,"PAH",1,1,131,0)
 Note: Routine LR328 will be deleted after successful patch installation.
"PKG",26,22,1,"PAH",1,1,132,0)
 
"PKG",26,22,1,"PAH",1,1,133,0)
 
"PKG",26,22,1,"PAH",1,1,134,0)
INSTALLATION EXAMPLE
"PKG",26,22,1,"PAH",1,1,135,0)
==================== 
"PKG",26,22,1,"PAH",1,1,136,0)
 
"PKG",26,22,1,"PAH",1,1,137,0)
Select Installation Option: 6  Install Package(s)
"PKG",26,22,1,"PAH",1,1,138,0)
Select INSTALL NAME: LR*5.2*328 Loaded from Distribution Loaded from
"PKG",26,22,1,"PAH",1,1,139,0)
Distribution  4/21/05@16:56:33
"PKG",26,22,1,"PAH",1,1,140,0)
     => LR*5.2*328
"PKG",26,22,1,"PAH",1,1,141,0)
 
"PKG",26,22,1,"PAH",1,1,142,0)
This Distribution was loaded on Apr 21, 2005@16:56:33 with header of
"PKG",26,22,1,"PAH",1,1,143,0)
   LR*5.2*328
"PKG",26,22,1,"PAH",1,1,144,0)
   It consisted of the following Install(s):
"PKG",26,22,1,"PAH",1,1,145,0)
     LR*5.2*328
"PKG",26,22,1,"PAH",1,1,146,0)
Checking Install for Package LR*5.2*328
"PKG",26,22,1,"PAH",1,1,147,0)
Will first run the Environment Check Routine, LR328
"PKG",26,22,1,"PAH",1,1,148,0)
 
"PKG",26,22,1,"PAH",1,1,149,0)
 
"PKG",26,22,1,"PAH",1,1,150,0)
               Sending install started alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,151,0)
 
"PKG",26,22,1,"PAH",1,1,152,0)
                        --- Environment Check is Ok ---
"PKG",26,22,1,"PAH",1,1,153,0)
 
"PKG",26,22,1,"PAH",1,1,154,0)
Install Questions for LR*5.2*328
"PKG",26,22,1,"PAH",1,1,155,0)
 
"PKG",26,22,1,"PAH",1,1,156,0)
 
"PKG",26,22,1,"PAH",1,1,157,0)
Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// NO
"PKG",26,22,1,"PAH",1,1,158,0)
 
"PKG",26,22,1,"PAH",1,1,159,0)
 
"PKG",26,22,1,"PAH",1,1,160,0)
Want KIDS to INHIBIT LOGONs during the install? YES// NO
"PKG",26,22,1,"PAH",1,1,161,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"PKG",26,22,1,"PAH",1,1,162,0)
 
"PKG",26,22,1,"PAH",1,1,163,0)
 Install Started for LR*5.2*328 :
"PKG",26,22,1,"PAH",1,1,164,0)
               Apr 21, 2005@16:58:02
"PKG",26,22,1,"PAH",1,1,165,0)
 
"PKG",26,22,1,"PAH",1,1,166,0)
Build Distribution Date: Apr 21, 2005
"PKG",26,22,1,"PAH",1,1,167,0)
 
"PKG",26,22,1,"PAH",1,1,168,0)
 Installing Routines:
"PKG",26,22,1,"PAH",1,1,169,0)
               Apr 21, 2005@16:58:02
"PKG",26,22,1,"PAH",1,1,170,0)
 
"PKG",26,22,1,"PAH",1,1,171,0)
 Running Pre-Install Routine: PRE^LR328
"PKG",26,22,1,"PAH",1,1,172,0)
 
"PKG",26,22,1,"PAH",1,1,173,0)
                          *** Pre install started ***
"PKG",26,22,1,"PAH",1,1,174,0)
 
"PKG",26,22,1,"PAH",1,1,175,0)
                           *** No action required ***
"PKG",26,22,1,"PAH",1,1,176,0)
 
"PKG",26,22,1,"PAH",1,1,177,0)
                         *** Pre install completed ***
"PKG",26,22,1,"PAH",1,1,178,0)
 
"PKG",26,22,1,"PAH",1,1,179,0)
 Installing PACKAGE COMPONENTS:
"PKG",26,22,1,"PAH",1,1,180,0)
 
"PKG",26,22,1,"PAH",1,1,181,0)
 Installing OPTION
"PKG",26,22,1,"PAH",1,1,182,0)
               Apr 21, 2005@16:58:02
"PKG",26,22,1,"PAH",1,1,183,0)
 
"PKG",26,22,1,"PAH",1,1,184,0)
 Running Post-Install Routine: POST^LR328
"PKG",26,22,1,"PAH",1,1,185,0)
 
"PKG",26,22,1,"PAH",1,1,186,0)
                          *** Post install started ***
"PKG",26,22,1,"PAH",1,1,187,0)
 
"PKG",26,22,1,"PAH",1,1,188,0)
                           *** No action required ***
"PKG",26,22,1,"PAH",1,1,189,0)
 
"PKG",26,22,1,"PAH",1,1,190,0)
                         *** Post install completed ***
"PKG",26,22,1,"PAH",1,1,191,0)
 
"PKG",26,22,1,"PAH",1,1,192,0)
              Sending install completion alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,193,0)
 
"PKG",26,22,1,"PAH",1,1,194,0)
 Updating Routine file...
"PKG",26,22,1,"PAH",1,1,195,0)
 
"PKG",26,22,1,"PAH",1,1,196,0)
 Updating KIDS files...
"PKG",26,22,1,"PAH",1,1,197,0)
 
"PKG",26,22,1,"PAH",1,1,198,0)
 LR*5.2*328 Installed.
"PKG",26,22,1,"PAH",1,1,199,0)
               Apr 21, 2005@16:58:03
"PKG",26,22,1,"PAH",1,1,200,0)
 
"PKG",26,22,1,"PAH",1,1,201,0)
 Install Message sent #XXXX
"PKG",26,22,1,"PAH",1,1,202,0)
 
"PKG",26,22,1,"PAH",1,1,203,0)
Install Completed
"PKG",26,22,1,"PAH",1,1,204,0)

"PKG",26,22,1,"PAH",1,1,205,0)

"PKG",26,22,1,"PAH",1,1,206,0)

"PKG",26,22,1,"PAH",1,1,207,0)

"PKG",26,22,1,"PAH",1,1,208,0)

"PKG",26,22,1,"PAH",1,1,209,0)

"PRE")
LR328
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","LR328")
0^^B9400481^n/a
"RTN","LR328",1,0)
LR328 ;DALOI/JMC - LR*5.2*328 PATCH ENVIRONMENT CHECK ROUTINE ;3 AUG 2004
"RTN","LR328",2,0)
 ;;5.2;LAB SERVICE;**328**;Sep 27, 1994;Build 1
"RTN","LR328",3,0)
EN ; Does not prevent loading of the transport global.
"RTN","LR328",4,0)
 ; Environment check is done only during the install.
"RTN","LR328",5,0)
 ;
"RTN","LR328",6,0)
 N XQA,XQAMSG
"RTN","LR328",7,0)
 ;
"RTN","LR328",8,0)
 I '$G(XPDENV) D  Q
"RTN","LR328",9,0)
 . S XQAMSG="Transport global for patch "_$G(XPDNM,"Unknown patch")_" loaded on "_$$HTE^XLFDT($H)
"RTN","LR328",10,0)
 . S XQA("G.LMI")=""
"RTN","LR328",11,0)
 . D SETUP^XQALERT
"RTN","LR328",12,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Sending transport global loaded alert to mail group G.LMI",80))
"RTN","LR328",13,0)
 ;
"RTN","LR328",14,0)
 S XQAMSG="Installation of patch "_$G(XPDNM,"Unknown patch")_" started on "_$$HTE^XLFDT($H)
"RTN","LR328",15,0)
 S XQA("G.LMI")=""
"RTN","LR328",16,0)
 D SETUP^XQALERT
"RTN","LR328",17,0)
 D BMES^XPDUTL($$CJ^XLFSTR("Sending install started alert to mail group G.LMI",80))
"RTN","LR328",18,0)
 ;
"RTN","LR328",19,0)
 D CHECK
"RTN","LR328",20,0)
 D EXIT
"RTN","LR328",21,0)
 Q
"RTN","LR328",22,0)
 ;
"RTN","LR328",23,0)
CHECK ; Perform environment check
"RTN","LR328",24,0)
 I $S('$G(IOM):1,'$G(IOSL):1,$G(U)'="^":1,1:0) D  Q
"RTN","LR328",25,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Terminal Device is not defined",80))
"RTN","LR328",26,0)
 . S XPDQUIT=2
"RTN","LR328",27,0)
 I $S('$G(DUZ):1,$D(DUZ)[0:1,$D(DUZ(0))[0:1,1:0) D  Q
"RTN","LR328",28,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Please log in to set local DUZ... variables",80))
"RTN","LR328",29,0)
 . S XPDQUIT=2
"RTN","LR328",30,0)
 I $P($$ACTIVE^XUSER(DUZ),"^")'=1 D  Q
"RTN","LR328",31,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("You are not a valid user on this system",80))
"RTN","LR328",32,0)
 . S XPDQUIT=2
"RTN","LR328",33,0)
 S XPDIQ("XPZ1","B")="NO"
"RTN","LR328",34,0)
 Q
"RTN","LR328",35,0)
 ;
"RTN","LR328",36,0)
EXIT ;
"RTN","LR328",37,0)
 I $G(XPDQUIT) D BMES^XPDUTL($$CJ^XLFSTR("--- Install Environment Check FAILED ---",80))
"RTN","LR328",38,0)
 I '$G(XPDQUIT) D BMES^XPDUTL($$CJ^XLFSTR("--- Environment Check is Ok ---",80))
"RTN","LR328",39,0)
 Q
"RTN","LR328",40,0)
 ;
"RTN","LR328",41,0)
PRE ; KIDS Pre install
"RTN","LR328",42,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Pre install started ***",80))
"RTN","LR328",43,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** No action required ***",80))
"RTN","LR328",44,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Pre install completed ***",80))
"RTN","LR328",45,0)
 Q
"RTN","LR328",46,0)
 ;
"RTN","LR328",47,0)
POST ; KIDS Post install
"RTN","LR328",48,0)
 N XQA,XQAMSG
"RTN","LR328",49,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Post install started ***",80))
"RTN","LR328",50,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** No action required ***",80))
"RTN","LR328",51,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Post install completed ***",80))
"RTN","LR328",52,0)
 D BMES^XPDUTL($$CJ^XLFSTR("Sending install completion alert to mail group G.LMI",80))
"RTN","LR328",53,0)
 S XQAMSG="Installation of patch "_$G(XPDNM,"Unknown patch")_" completed on "_$$HTE^XLFDT($H)
"RTN","LR328",54,0)
 S XQA("G.LMI")=""
"RTN","LR328",55,0)
 D SETUP^XQALERT
"RTN","LR328",56,0)
 S XQAMSG="LIM: Review description for "_$G(XPDNM,"Unknown patch")_" use KIDS:Utilities:Build File Print"
"RTN","LR328",57,0)
 S XQA("G.LMI")=""
"RTN","LR328",58,0)
 D SETUP^XQALERT
"RTN","LR328",59,0)
 Q
"RTN","LRFAST")
0^1^B29752400^B29732413
"RTN","LRFAST",1,0)
LRFAST ;DALOI/JMC - FAST ENTRY ;May 23, 2006
"RTN","LRFAST",2,0)
 ;;5.2;LAB SERVICE;**100,121,201,286,291,328**;Sep 27, 1994;Build 1
"RTN","LRFAST",3,0)
 N LRBEQT,LRBEVT,LRBETS,LRBEX,LRBEY,LRBEZ,LRBETYP
"RTN","LRFAST",4,0)
 K LRLONG,LRNATURE
"RTN","LRFAST",5,0)
 S LRLONG=""
"RTN","LRFAST",6,0)
 D ^LRPARAM
"RTN","LRFAST",7,0)
SHORT S LRPANEL=0,LROUTINE=$P(^LAB(69.9,1,3),U,2),LRPTP=-1 I '$D(LRLONG) W !,"BYPASSING ORDER ENTRY!!",$C(7)
"RTN","LRFAST",8,0)
 I $D(^LAB(69.9,1,"RO")),+$H'=^("RO") W $C(7),!,"ROLLOVER ",$S($P(^("RO"),U,2):"IS RUNNING.",1:"HAS NOT RUN.")," ACCESSIONING SHOULDN'T BE DONE NOW.",$C(7),!,"  Are you sure you want to continue"
"RTN","LRFAST",9,0)
 I $T S %=2 D YN^DICN W:%=0 !,"Not sure?" I %'=1 W !,"OK, try later." Q
"RTN","LRFAST",10,0)
 S X=$$SELPL^LRVERA(DUZ(2))
"RTN","LRFAST",11,0)
 I X<1 D QUIT Q
"RTN","LRFAST",12,0)
 I X'=DUZ(2) N LRPL S LRPL=X
"RTN","LRFAST",13,0)
 ;
"RTN","LRFAST",14,0)
SH W !,"Do you want to enter draw times" S %=2 D YN^DICN S LRADT=(%=1) Q:%=-1
"RTN","LRFAST",15,0)
 I %=0 W !,"If you answer 'yes', you will be asked for the approximate time the specimen",!,"was taken from the patient.  Otherwise, the current time will be assumed." G SH
"RTN","LRFAST",16,0)
AMIS ;
"RTN","LRFAST",17,0)
 S U="^",(Y,LRNT)=$$NOW^XLFDT,LRODT=DT,LRAD=DT,LRIDT=9999999-Y,LRCDT=Y_"^1",LRSAMP="" K DFN,DIC S DIC(0)="EMQ"_$S($P(LRPARAM,U,6):"L",1:"") D ^LRDPA G:(LRDFN=-1)!$D(DUOUT)!$D(DTOUT) QUIT
"RTN","LRFAST",18,0)
 S:'$D(^LRO(69,LRODT,0)) ^(0)=$P(^LRO(69,0),U,1,2)_U_LRODT_U_(1+$P(^(0),U,4)),^LRO(69,LRODT,0)=LRODT,^LRO(69,"B",LRODT,LRODT)="" S %H=$H-60 D YMD^LRX S LRTM60=9999999-X
"RTN","LRFAST",19,0)
QSN1 D PT^LRX G:$G(LREND) QUIT K DR S LRLLOC=$S($L(LRWRD):LRWRD,$D(^LR(LRDFN,.1)):^(.1),1:"UNKNOWN") D:$L(LRWRD) DPT^LRWU
"RTN","LRFAST",20,0)
Q12 I $D(LRLONG) D LOC^LRWU G QUIT:LREND
"RTN","LRFAST",21,0)
Q11 D COLTY^LRWU G QUIT:LREND S LRPRAC="" I $D(LRLONG) D PRAC^LRWU1 I LREND W !!,$C(7),"ORDER CANCELED",!! G QUIT
"RTN","LRFAST",22,0)
URG ;
"RTN","LRFAST",23,0)
 S DIC="^LAB(62.05,",DIC(0)="AQE",DIC("S")="I '$P(^(0),U,3)",DIC("B")=$P($G(^LAB(62.05,LROUTINE,0)),U) D ^DIC S LRURG=$S(+Y<1:LROUTINE,1:+Y)
"RTN","LRFAST",24,0)
 S LRNN=1 D ^LROW1 G QUIT:'$D(X3) S S9=LRSPEC
"RTN","LRFAST",25,0)
QSN2 IF LRADT S %DT("A")="DRAW DATE/TIME: ",%DT(0)="-N",%DT="EATPX" D ^%DT K %DT G:Y<0 QUIT S LRCDT=Y_U,LRIDT=9999999-Y G QSN2:Y<1
"RTN","LRFAST",26,0)
 D NEW^LROR6() I $G(LRNATURE)=-1 W !!,$C(7),"...process aborted" S %="^" K LRNATURE Q
"RTN","LRFAST",27,0)
 S LRSNO=LRDFN_U_DUZ_U_LRSAMP_U_LRLWC_U_+LRCDT_U_LRPRAC_U_LRLLOC
"RTN","LRFAST",28,0)
 S LRBEY=1 I +LRDPF=2&($G(LRSS)'="BB")&('$$CHKINP^LRBEBA4(LRDFN,LRODT)) D  G QUIT:'LRBEY
"RTN","LRFAST",29,0)
 .D SLROT^LRBEBA2(.LRXST,.LRTEST,.LROT) ;Define LROT array
"RTN","LRFAST",30,0)
 .D AQ1^LRBEBA3  ; CIDC
"RTN","LRFAST",31,0)
 I ($D(LRBEY)<1)!$D(DUOUT)!$D(DTOUT) Q
"RTN","LRFAST",32,0)
 S LRNCWL=1 D REST^LROW2 K LRNCWL S ^LRO(69,LRODT,1,LRSN,1)=+LRCDT_"^^"_DUZ_"^C^^^^"_DUZ(2),^LRO(69,"AA",+$G(^(.1)),LRODT_"|"_LRSN)=""
"RTN","LRFAST",33,0)
 S LRSPEC=S9,LRTSTS=0,LRNOLABL=1 D ^LRWLST K LRNOLABL Q:'$D(LRAN)
"RTN","LRFAST",34,0)
LROE ;from LROE1
"RTN","LRFAST",35,0)
 S LRLLOC=$P(^LRO(69,LRODT,1,LRSN,0),U,7) S:'$L(LRLLOC) LRLLOC=0 K LROE
"RTN","LRFAST",36,0)
 S I1=0 F  S I1=$O(^LRO(69,LRODT,1,LRSN,2,I1)) Q:I1<1!($G(LREND))  S X=^(I1,0) I $P(X,U,4) S LRAA=$P(X,U,4),LRAN=$P(X,U,5),LRAD=$P(X,U,3) I '$D(LROE(LRAD_LRAA_LRAN)) S LROE(LRAD_LRAA_LRAN)="" D LROE1
"RTN","LRFAST",37,0)
 G QUIT
"RTN","LRFAST",38,0)
 ;
"RTN","LRFAST",39,0)
 ;
"RTN","LRFAST",40,0)
LROE1 S LRX=$G(^LRO(68,LRAA,0))
"RTN","LRFAST",41,0)
 S LRIDIV=$S($L($P(LRX,U,19)):$P(LRX,U,19),1:"CP")
"RTN","LRFAST",42,0)
 D:$P(LRPARAM,U,14)&($P($G(^LRO(68,LRAA,0)),U,16)) ^LRCAPV
"RTN","LRFAST",43,0)
 I $G(LREND) Q
"RTN","LRFAST",44,0)
 ; Check for different performing lab.
"RTN","LRFAST",45,0)
 I $G(LRPL) N LRDUZ S LRDUZ(2)=LRPL
"RTN","LRFAST",46,0)
 ;
"RTN","LRFAST",47,0)
 S LRUID=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,.3),"^")
"RTN","LRFAST",48,0)
 I $P(LRX,U,2)="CH" D DEM^LRX,^LRVER1
"RTN","LRFAST",49,0)
 I $P(LRX,U,2)="MI" D
"RTN","LRFAST",50,0)
 . S LRPTP=-1,LRMIDEF=$P(^LAB(69.9,1,1),U,10),LRMIOTH=$P(^(0),U,11)
"RTN","LRFAST",51,0)
 . D PAT1^LRMIEDZ2
"RTN","LRFAST",52,0)
 . K LRMIDEF,LRMIOTH
"RTN","LRFAST",53,0)
 K LRX
"RTN","LRFAST",54,0)
 Q
"RTN","LRFAST",55,0)
 ;
"RTN","LRFAST",56,0)
 ;
"RTN","LRFAST",57,0)
QUIT K ^TMP("LR",$J,"TMP"),%,A,AGE,D1,D2,DFN,DIE,DL,DLAYGO,DOB,DQ,DR,DX,H8,I,J,K,LRAA,LRACC,LRAD,LRADT,LRAN,LRAP,LRCDT,LRCW,LRNATURE,I1
"RTN","LRFAST",58,0)
 K LRCWDT,LRD,LRDAT,LRDEL,LRDFN,LRDPF,LRDV,LRDVF,LREAL,LREDIT,LREND,LRFFLG,LRFP,LRIDT,LRIN,LRINI,LRIX,DIC,LRORD,LRSB
"RTN","LRFAST",59,0)
 K LRLBLBP,LRLCT,LRLDT,LRLLOC,LRLONG,LRMETH,LRNAME,LRNG,LRNG2,LRNG3,LRNG4,LRNG5,LRNP,LRNT,LRNTN,LRNX,LRODT,LROUT,LROUTINE,LROWDT,LROWLE,LRPR,LRPRAC,LRRB,LRPTP,LRSAMP,LRSN,LRSPEC,LRSS,LRSSP,LRST,LRSUB,LRSUM,LRTB,LRTD,LRTEST
"RTN","LRFAST",60,0)
 K LRTN,LRTS,LRTX,LRUNQ,LRURG,LRUSI,LRUSNM,^TMP("LR",$J,"VTO"),LRWL0,LRWLC,LRWRD,LRXD,LRXDH,LRXDP,LRYR,PNM,S,S9,SEX,SSN,T,X,X1,Y,Z,LRACD,LRADDTST,LRAOD,LRBED,LRCSS,LRDTO,LREXEC,LRFLOG,LRGCOM,LRGVP,LRIOZERO,LRNIDT,LROCN,LROID,LROLRDFN
"RTN","LRFAST",61,0)
 K LRCCOM,LRCFL,LRCS,LRCSN,LRCSP,LRCSX,LREXP,LRLWC,LRM,LRMAX,LRNN,LRSNO,LRTSTN,LRTY,LRVF,LRVRM,LRXS,I5,S2,S5,T1,POP,X2,X3,X9,LRORDER,LRORDR,LRORDTIM,LRORIFN,LROSN,LRPER,LRPHSET,LRPLOC,LRSPCDSC,LRSSQ,LRSSX,LRSVSN,LRTEC,LRTJ,LRTP,LRTSTNM
"RTN","LRFAST",62,0)
 K LRTCOM,LRALERT,LROE,LRUR,LRVOL,LRWPC,PNM,LROLLOC,LRTREA,LRMAX2,LRMX,LRCAPLOC,LRCOM,LRXST,LRY,LRJ,LRMA,LRMAX1,LRNOW,LRODTSV,LRPANEL,LRSNSV,LRTNSV,LRCDEF0X,LRDAX,LRNOCODE
"RTN","LRFAST",63,0)
 K LRSUF0,LRBEQT,LRBEVT,LRBETS,LRBEX,LRBEY,LRBEZ,LRBETYP
"RTN","LRFAST",64,0)
 D END^LRMIEDZ,^LRORDK ;LROEND^LRORDK
"RTN","LRFAST",65,0)
 D ^LRPARAM Q
"RTN","LRFAST",66,0)
EN D QUIT,^LRORDK,LROEND^LRORDK D ^LRPARAM S LRLONG="" G SHORT
"RTN","LRFAST",67,0)
% R %:DTIME Q:%=""!(%["N")!(%["Y")  W !,"Answer 'Y' or 'N': " G %
"VER")
8.0^22.0
"BLD",6302,6)
^280
**END**
**END**
