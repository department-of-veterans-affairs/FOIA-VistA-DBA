Released HL*1.6*99 SEQ #82
Extracted from mail message
**KIDS**:HL*1.6*99^

**INSTALL NAME**
HL*1.6*99
"BLD",602,0)
HL*1.6*99^HEALTH LEVEL SEVEN^0^3020902^y
"BLD",602,1,0)
^^2^2^3020902^
"BLD",602,1,1,0)
See patch HL*1.6*99 in the National Patch Module for complete information 
"BLD",602,1,2,0)
on this patch.
"BLD",602,4,0)
^9.64PA^^
"BLD",602,"ABPKG")
n
"BLD",602,"INIT")
CLEAN^HLCSUTL1
"BLD",602,"KRN",0)
^9.67PA^8989.52^20
"BLD",602,"KRN",.4,0)
.4
"BLD",602,"KRN",.401,0)
.401
"BLD",602,"KRN",.402,0)
.402
"BLD",602,"KRN",.403,0)
.403
"BLD",602,"KRN",.5,0)
.5
"BLD",602,"KRN",.84,0)
.84
"BLD",602,"KRN",3.6,0)
3.6
"BLD",602,"KRN",3.8,0)
3.8
"BLD",602,"KRN",9.2,0)
9.2
"BLD",602,"KRN",9.8,0)
9.8
"BLD",602,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",602,"KRN",9.8,"NM",1,0)
HLCSUTL1^^0^B15055576
"BLD",602,"KRN",9.8,"NM","B","HLCSUTL1",1)

"BLD",602,"KRN",19,0)
19
"BLD",602,"KRN",19,"NM",0)
^9.68A^^
"BLD",602,"KRN",19.1,0)
19.1
"BLD",602,"KRN",101,0)
101
"BLD",602,"KRN",409.61,0)
409.61
"BLD",602,"KRN",771,0)
771
"BLD",602,"KRN",870,0)
870
"BLD",602,"KRN",8989.51,0)
8989.51
"BLD",602,"KRN",8989.52,0)
8989.52
"BLD",602,"KRN",8994,0)
8994
"BLD",602,"KRN",8994.2,0)
8994.2
"BLD",602,"KRN","B",.4,.4)

"BLD",602,"KRN","B",.401,.401)

"BLD",602,"KRN","B",.402,.402)

"BLD",602,"KRN","B",.403,.403)

"BLD",602,"KRN","B",.5,.5)

"BLD",602,"KRN","B",.84,.84)

"BLD",602,"KRN","B",3.6,3.6)

"BLD",602,"KRN","B",3.8,3.8)

"BLD",602,"KRN","B",9.2,9.2)

"BLD",602,"KRN","B",9.8,9.8)

"BLD",602,"KRN","B",19,19)

"BLD",602,"KRN","B",19.1,19.1)

"BLD",602,"KRN","B",101,101)

"BLD",602,"KRN","B",409.61,409.61)

"BLD",602,"KRN","B",771,771)

"BLD",602,"KRN","B",870,870)

"BLD",602,"KRN","B",8989.51,8989.51)

"BLD",602,"KRN","B",8989.52,8989.52)

"BLD",602,"KRN","B",8994,8994)

"BLD",602,"KRN","B",8994.2,8994.2)

"BLD",602,"QUES",0)
^9.62^^
"BLD",602,"REQB",0)
^9.611^^
"INIT")
CLEAN^HLCSUTL1
"MBREQ")
0
"PKG",9,-1)
1^1
"PKG",9,0)
HEALTH LEVEL SEVEN^HL^DHCP IMPLEMENTATION OF HEALTH LEVEL SEVEN^
"PKG",9,20,0)
^9.402P^^
"PKG",9,22,0)
^9.49I^1^1
"PKG",9,22,1,0)
1.6^2980130^2980130^6
"PKG",9,22,1,"PAH",1,0)
99^3020902
"PKG",9,22,1,"PAH",1,1,0)
^^2^2^3020902
"PKG",9,22,1,"PAH",1,1,1,0)
See patch HL*1.6*99 in the National Patch Module for complete information 
"PKG",9,22,1,"PAH",1,1,2,0)
on this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","HLCSUTL1")
0^1^B15055576
"RTN","HLCSUTL1",1,0)
HLCSUTL1 ;ALB/JRP - COMMUNICATION SERVER UTILITIES;15-MAY-95
"RTN","HLCSUTL1",2,0)
 ;;1.6;HEALTH LEVEL SEVEN;**99**;Oct 13, 1995
"RTN","HLCSUTL1",3,0)
 ;
"RTN","HLCSUTL1",4,0)
CRTFLR(TASKNUM,FLRTYPE) ;CREATE/FIND ENTRY IN FILER MULT OF FILE 869.3
"RTN","HLCSUTL1",5,0)
 ;INPUT  : TASKNUM - Task number of filer
"RTN","HLCSUTL1",6,0)
 ;         FLRTYPE - Indicates type of filer
"RTN","HLCSUTL1",7,0)
 ;                   IN = Incoming (default)
"RTN","HLCSUTL1",8,0)
 ;                   OUT = Outgoing
"RTN","HLCSUTL1",9,0)
 ;OUTPUT : X - Entry number in INCOMING FILER TASK NUMBER multiple
"RTN","HLCSUTL1",10,0)
 ;             (field #20) or OUTGOING FILER TASK NUMBER multiple
"RTN","HLCSUTL1",11,0)
 ;             (field #30) of the HL COMMUNICATION SERVER PARAMETER
"RTN","HLCSUTL1",12,0)
 ;             file (#869.3)
"RTN","HLCSUTL1",13,0)
 ;         -1^ErrorText - Entry not created/found
"RTN","HLCSUTL1",14,0)
 ;NOTES  : Entries in multiple will be DINUMed to their task number
"RTN","HLCSUTL1",15,0)
 ;
"RTN","HLCSUTL1",16,0)
 ;Check input
"RTN","HLCSUTL1",17,0)
 S TASKNUM=+$G(TASKNUM)
"RTN","HLCSUTL1",18,0)
 Q:('TASKNUM) "-1^Did not pass task number of filer"
"RTN","HLCSUTL1",19,0)
 S FLRTYPE=$G(FLRTYPE)
"RTN","HLCSUTL1",20,0)
 ;Declare variables
"RTN","HLCSUTL1",21,0)
 N DA,DG,DIC,DINUM,DLAYGO,FLDNUM,NODE,PTRMAIN,PTRSUB,X,Y
"RTN","HLCSUTL1",22,0)
 S NODE=$S(FLRTYPE="OUT":3,1:2)
"RTN","HLCSUTL1",23,0)
 S FLDNUM=$S(FLRTYPE="OUT":30,1:20)
"RTN","HLCSUTL1",24,0)
 ;Get entry in parameter file
"RTN","HLCSUTL1",25,0)
 S PTRMAIN=+$O(^HLCS(869.3,0))
"RTN","HLCSUTL1",26,0)
 Q:('PTRMAIN) "-1^Entry in file #869.3 does not exist"
"RTN","HLCSUTL1",27,0)
 ;Set up call to FileMan
"RTN","HLCSUTL1",28,0)
 S DIC="^HLCS(869.3,"_PTRMAIN_","_NODE_","
"RTN","HLCSUTL1",29,0)
 S DIC(0)="LOX"
"RTN","HLCSUTL1",30,0)
 S (X,DINUM)=TASKNUM
"RTN","HLCSUTL1",31,0)
 S DLAYGO=869.3
"RTN","HLCSUTL1",32,0)
 S DIC("DR")=".02///NO"
"RTN","HLCSUTL1",33,0)
 ;These extra variables are needed since it's a multiple
"RTN","HLCSUTL1",34,0)
 S DA(1)=PTRMAIN
"RTN","HLCSUTL1",35,0)
 S DIC("P")=$P(^DD(869.3,FLDNUM,0),"^",2)
"RTN","HLCSUTL1",36,0)
 ;Create/find entry
"RTN","HLCSUTL1",37,0)
 D ^DIC
"RTN","HLCSUTL1",38,0)
 S PTRSUB=+Y
"RTN","HLCSUTL1",39,0)
 Q:(PTRSUB<1) "-1^Unable to create entry in filer multiple"
"RTN","HLCSUTL1",40,0)
 Q PTRSUB
"RTN","HLCSUTL1",41,0)
DELFLR(PTRSUB,FLRTYPE) ;DELETE ENTRY IN FILER MULT OF FILE 869.3
"RTN","HLCSUTL1",42,0)
 ;INPUT  : PTRSUB - Pointer to incoming or outgoing filer subentry
"RTN","HLCSUTL1",43,0)
 ;         FLRTYPE - Indicates type of filer
"RTN","HLCSUTL1",44,0)
 ;                   IN = Incoming (default)
"RTN","HLCSUTL1",45,0)
 ;                   OUT = Outgoing
"RTN","HLCSUTL1",46,0)
 ;OUTPUT : None
"RTN","HLCSUTL1",47,0)
 ;NOTES  : This will delete the entry in the INCOMING FILER TASK NUMBER
"RTN","HLCSUTL1",48,0)
 ;         multiple (field #20) or OUTGOING FILER TASK NUMBER multiple
"RTN","HLCSUTL1",49,0)
 ;         (field #30) of the HL COMMUNICATION SERVER PARAMETER
"RTN","HLCSUTL1",50,0)
 ;         file (#869.3) without prompting for confirmation
"RTN","HLCSUTL1",51,0)
 ;
"RTN","HLCSUTL1",52,0)
 ;Check input
"RTN","HLCSUTL1",53,0)
 Q:('$G(PTRSUB))
"RTN","HLCSUTL1",54,0)
 S FLRTYPE=$G(FLRTYPE)
"RTN","HLCSUTL1",55,0)
 ;Declare variables
"RTN","HLCSUTL1",56,0)
 N DA,DG,DIK,NODE,PTRMAIN
"RTN","HLCSUTL1",57,0)
 S NODE=$S(FLRTYPE="OUT":3,1:2)
"RTN","HLCSUTL1",58,0)
 ;Get entry in parameter file
"RTN","HLCSUTL1",59,0)
 S PTRMAIN=+$O(^HLCS(869.3,0))
"RTN","HLCSUTL1",60,0)
 Q:('PTRMAIN)
"RTN","HLCSUTL1",61,0)
 ;Nothing to delete
"RTN","HLCSUTL1",62,0)
 Q:('$D(^HLCS(869.3,PTRMAIN,NODE,PTRSUB)))
"RTN","HLCSUTL1",63,0)
 ;Set up call to FileMan
"RTN","HLCSUTL1",64,0)
 S DIK="^HLCS(869.3,"_PTRMAIN_","_NODE_","
"RTN","HLCSUTL1",65,0)
 S DA=PTRSUB
"RTN","HLCSUTL1",66,0)
 S DA(1)=PTRMAIN
"RTN","HLCSUTL1",67,0)
 ;Delete subentry
"RTN","HLCSUTL1",68,0)
 D ^DIK
"RTN","HLCSUTL1",69,0)
 Q
"RTN","HLCSUTL1",70,0)
SETFLRDH(PTRSUB,FLRTYPE) ;UPDATE $H FIELD FOR FILER MULT IN FILE 869.3
"RTN","HLCSUTL1",71,0)
 ;INPUT  : PTRSUB - Pointer to incoming or outgoing filer subentry
"RTN","HLCSUTL1",72,0)
 ;         FLRTYPE - Indicates type of filer
"RTN","HLCSUTL1",73,0)
 ;                   IN = Incoming (default)
"RTN","HLCSUTL1",74,0)
 ;                   OUT = Outgoing
"RTN","HLCSUTL1",75,0)
 ;OUTPUT : None
"RTN","HLCSUTL1",76,0)
 ;NOTES  : This updates the LAST KNOW $H field (.03) of the INCOMING
"RTN","HLCSUTL1",77,0)
 ;         FILER TASK NUMBER and OUTGOING FILER TASK NUMBER multiples
"RTN","HLCSUTL1",78,0)
 ;         (fields 20 & 30) of the HL COMMUNICATION SERVER PARAMETER
"RTN","HLCSUTL1",79,0)
 ;         file (#869.3)
"RTN","HLCSUTL1",80,0)
 ;
"RTN","HLCSUTL1",81,0)
 ;Check input
"RTN","HLCSUTL1",82,0)
 Q:('$G(PTRSUB))
"RTN","HLCSUTL1",83,0)
 S FLRTYPE=$G(FLRTYPE)
"RTN","HLCSUTL1",84,0)
 ;Declare variables
"RTN","HLCSUTL1",85,0)
 N DA,DG,DIE,DR,LOCKTRY,NODE,PTRMAIN
"RTN","HLCSUTL1",86,0)
 S NODE=$S(FLRTYPE="OUT":3,1:2)
"RTN","HLCSUTL1",87,0)
 ;Get entry in parameter file
"RTN","HLCSUTL1",88,0)
 S PTRMAIN=+$O(^HLCS(869.3,0))
"RTN","HLCSUTL1",89,0)
 Q:('PTRMAIN)
"RTN","HLCSUTL1",90,0)
 ;Subentry doesn't exist
"RTN","HLCSUTL1",91,0)
 Q:('$D(^HLCS(869.3,PTRMAIN,NODE,PTRSUB)))
"RTN","HLCSUTL1",92,0)
 ;Lock subentry
"RTN","HLCSUTL1",93,0)
 F LOCKTRY=0:1:20 L +^HLCS(869.3,PTRMAIN,NODE,PTRSUB):1 I ($T) S LOCKTRY=0 Q
"RTN","HLCSUTL1",94,0)
 ;Couldn't lock subentry
"RTN","HLCSUTL1",95,0)
 Q:(LOCKTRY)
"RTN","HLCSUTL1",96,0)
 ;Set up call to FileMan
"RTN","HLCSUTL1",97,0)
 S DIE="^HLCS(869.3,"_PTRMAIN_","_NODE_","
"RTN","HLCSUTL1",98,0)
 S DA(1)=PTRMAIN
"RTN","HLCSUTL1",99,0)
 S DA=PTRSUB
"RTN","HLCSUTL1",100,0)
 S DR=".03///"_$H
"RTN","HLCSUTL1",101,0)
 ;Update value
"RTN","HLCSUTL1",102,0)
 D ^DIE
"RTN","HLCSUTL1",103,0)
 ;Unlock subentry
"RTN","HLCSUTL1",104,0)
 L -^HLCS(869.3,PTRMAIN,NODE,PTRSUB)
"RTN","HLCSUTL1",105,0)
 Q
"RTN","HLCSUTL1",106,0)
STOPFLR(PTRSUB,FLRTYPE) ;UPDATE STOP FIELD FOR FILER MULT IN FILE 869.3
"RTN","HLCSUTL1",107,0)
 ;INPUT  : PTRSUB - Pointer to incoming or outgoing filer subentry
"RTN","HLCSUTL1",108,0)
 ;         FLRTYPE - Indicates type of filer
"RTN","HLCSUTL1",109,0)
 ;                   IN = Incoming (default)
"RTN","HLCSUTL1",110,0)
 ;                   OUT = Outgoing
"RTN","HLCSUTL1",111,0)
 ;OUTPUT : None
"RTN","HLCSUTL1",112,0)
 ;NOTES  : This sets the STOP FILER field (#.02) of the INCOMING
"RTN","HLCSUTL1",113,0)
 ;         FILER TASK NUMBER and OUTGOING FILER TASK NUMBER multiples
"RTN","HLCSUTL1",114,0)
 ;         (fields 20 & 30) of the HL COMMUNICATION SERVER PARAMETER
"RTN","HLCSUTL1",115,0)
 ;         file (#869.3).  Setting this field to YES will ask the
"RTN","HLCSUTL1",116,0)
 ;         filer to stop.
"RTN","HLCSUTL1",117,0)
 ;
"RTN","HLCSUTL1",118,0)
 ;Check input
"RTN","HLCSUTL1",119,0)
 Q:('$G(PTRSUB))
"RTN","HLCSUTL1",120,0)
 S FLRTYPE=$G(FLRTYPE)
"RTN","HLCSUTL1",121,0)
 ;Declare variables
"RTN","HLCSUTL1",122,0)
 N PTRMAIN,NODE,DIE,DA,DR,LOCKTRY
"RTN","HLCSUTL1",123,0)
 S NODE=$S(FLRTYPE="OUT":3,1:2)
"RTN","HLCSUTL1",124,0)
 ;Get entry in parameter file
"RTN","HLCSUTL1",125,0)
 S PTRMAIN=+$O(^HLCS(869.3,0))
"RTN","HLCSUTL1",126,0)
 Q:('PTRMAIN)
"RTN","HLCSUTL1",127,0)
 ;Subentry doesn't exist
"RTN","HLCSUTL1",128,0)
 Q:('$D(^HLCS(869.3,PTRMAIN,NODE,PTRSUB)))
"RTN","HLCSUTL1",129,0)
 ;Lock subentry
"RTN","HLCSUTL1",130,0)
 F LOCKTRY=0:1:20 L +^HLCS(869.3,PTRMAIN,NODE,PTRSUB):1 I ($T) S LOCKTRY=0 Q
"RTN","HLCSUTL1",131,0)
 ;Couldn't lock subentry
"RTN","HLCSUTL1",132,0)
 Q:(LOCKTRY)
"RTN","HLCSUTL1",133,0)
 ;Set up call to FileMan
"RTN","HLCSUTL1",134,0)
 S DIE="^HLCS(869.3,"_PTRMAIN_","_NODE_","
"RTN","HLCSUTL1",135,0)
 S DA(1)=PTRMAIN
"RTN","HLCSUTL1",136,0)
 S DA=PTRSUB
"RTN","HLCSUTL1",137,0)
 S DR=".02///YES"
"RTN","HLCSUTL1",138,0)
 ;Update value
"RTN","HLCSUTL1",139,0)
 D ^DIE
"RTN","HLCSUTL1",140,0)
 ;Unlock subentry
"RTN","HLCSUTL1",141,0)
 L -^HLCS(869.3,PTRMAIN,NODE,PTRSUB)
"RTN","HLCSUTL1",142,0)
 Q
"RTN","HLCSUTL1",143,0)
 ;
"RTN","HLCSUTL1",144,0)
CLEAN ; Clean out invalid 869.3 data.  (HL*1.6*99 Post-init routine)
"RTN","HLCSUTL1",145,0)
 N IEN,KILLSUB,MIEN,SUB
"RTN","HLCSUTL1",146,0)
 S IEN=0
"RTN","HLCSUTL1",147,0)
 F  S IEN=$O(^HLCS(869.3,IEN)) Q:IEN'>0  D
"RTN","HLCSUTL1",148,0)
 .  F SUB=2,3 D  ; Errors only in 2, but adding 3 just in case...
"RTN","HLCSUTL1",149,0)
 .  .  S MIEN=0
"RTN","HLCSUTL1",150,0)
 .  .  S MIEN=$O(^HLCS(869.3,IEN,SUB,MIEN)) Q:MIEN'>0  D
"RTN","HLCSUTL1",151,0)
 .  .  .  S KILLSUB=0  ; Leave the zero node, but all above go!
"RTN","HLCSUTL1",152,0)
 .  .  .  F  S KILLSUB=$O(^HLCS(869.3,IEN,SUB,MIEN,KILLSUB)) Q:KILLSUB'>0  D
"RTN","HLCSUTL1",153,0)
 .  .  .  .  KILL ^HLCS(869.3,IEN,SUB,MIEN,KILLSUB)
"RTN","HLCSUTL1",154,0)
 QUIT
"RTN","HLCSUTL1",155,0)
 ;
"VER")
8.0^22.0
**END**
**END**
