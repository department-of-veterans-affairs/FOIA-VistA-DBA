EMERGENCY Released SD*5.3*273 SEQ #252
Extracted from mail message
**KIDS**:SD*5.3*273^

**INSTALL NAME**
SD*5.3*273
"BLD",4290,0)
SD*5.3*273^SCHEDULING^0^3030225^y
"BLD",4290,4,0)
^9.64PA^^
"BLD",4290,"ABPKG")
n
"BLD",4290,"KRN",0)
^9.67PA^8989.52^19
"BLD",4290,"KRN",.4,0)
.4
"BLD",4290,"KRN",.401,0)
.401
"BLD",4290,"KRN",.402,0)
.402
"BLD",4290,"KRN",.403,0)
.403
"BLD",4290,"KRN",.5,0)
.5
"BLD",4290,"KRN",.84,0)
.84
"BLD",4290,"KRN",3.6,0)
3.6
"BLD",4290,"KRN",3.8,0)
3.8
"BLD",4290,"KRN",9.2,0)
9.2
"BLD",4290,"KRN",9.8,0)
9.8
"BLD",4290,"KRN",9.8,"NM",0)
^9.68A^10^10
"BLD",4290,"KRN",9.8,"NM",1,0)
SDWLE110^^0^B21792281
"BLD",4290,"KRN",9.8,"NM",2,0)
SDWLE112^^0^B5315154
"BLD",4290,"KRN",9.8,"NM",3,0)
SDWLE113^^0^B6888384
"BLD",4290,"KRN",9.8,"NM",4,0)
SDWLDISP^^0^B31093418
"BLD",4290,"KRN",9.8,"NM",5,0)
SDM1^^0^B33241245
"BLD",4290,"KRN",9.8,"NM",6,0)
SDWLE111^^0^B21497452
"BLD",4290,"KRN",9.8,"NM",7,0)
SDM4^^0^B8958431
"BLD",4290,"KRN",9.8,"NM",8,0)
SDWLRSR^^0^B79296638
"BLD",4290,"KRN",9.8,"NM",9,0)
SDWLRP1^^0^B52288379
"BLD",4290,"KRN",9.8,"NM",10,0)
SDWLPE^^0^B15991511
"BLD",4290,"KRN",9.8,"NM","B","SDM1",5)

"BLD",4290,"KRN",9.8,"NM","B","SDM4",7)

"BLD",4290,"KRN",9.8,"NM","B","SDWLDISP",4)

"BLD",4290,"KRN",9.8,"NM","B","SDWLE110",1)

"BLD",4290,"KRN",9.8,"NM","B","SDWLE111",6)

"BLD",4290,"KRN",9.8,"NM","B","SDWLE112",2)

"BLD",4290,"KRN",9.8,"NM","B","SDWLE113",3)

"BLD",4290,"KRN",9.8,"NM","B","SDWLPE",10)

"BLD",4290,"KRN",9.8,"NM","B","SDWLRP1",9)

"BLD",4290,"KRN",9.8,"NM","B","SDWLRSR",8)

"BLD",4290,"KRN",19,0)
19
"BLD",4290,"KRN",19,"NM",0)
^9.68A^^
"BLD",4290,"KRN",19.1,0)
19.1
"BLD",4290,"KRN",101,0)
101
"BLD",4290,"KRN",409.61,0)
409.61
"BLD",4290,"KRN",771,0)
771
"BLD",4290,"KRN",870,0)
870
"BLD",4290,"KRN",8989.51,0)
8989.51
"BLD",4290,"KRN",8989.52,0)
8989.52
"BLD",4290,"KRN",8994,0)
8994
"BLD",4290,"KRN","B",.4,.4)

"BLD",4290,"KRN","B",.401,.401)

"BLD",4290,"KRN","B",.402,.402)

"BLD",4290,"KRN","B",.403,.403)

"BLD",4290,"KRN","B",.5,.5)

"BLD",4290,"KRN","B",.84,.84)

"BLD",4290,"KRN","B",3.6,3.6)

"BLD",4290,"KRN","B",3.8,3.8)

"BLD",4290,"KRN","B",9.2,9.2)

"BLD",4290,"KRN","B",9.8,9.8)

"BLD",4290,"KRN","B",19,19)

"BLD",4290,"KRN","B",19.1,19.1)

"BLD",4290,"KRN","B",101,101)

"BLD",4290,"KRN","B",409.61,409.61)

"BLD",4290,"KRN","B",771,771)

"BLD",4290,"KRN","B",870,870)

"BLD",4290,"KRN","B",8989.51,8989.51)

"BLD",4290,"KRN","B",8989.52,8989.52)

"BLD",4290,"KRN","B",8994,8994)

"BLD",4290,"QUES",0)
^9.62^^
"BLD",4290,"REQB",0)
^9.611^1^1
"BLD",4290,"REQB",1,0)
SD*5.3*263^1
"BLD",4290,"REQB","B","SD*5.3*263",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813^2930930
"PKG",16,22,1,"PAH",1,0)
273^3030225
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
10
"RTN","SDM1")
0^5^B33241245
"RTN","SDM1",1,0)
SDM1 ;SF/GFT - MAKE APPOINTMENT ; 27 Nov 2000 11:15 AM
"RTN","SDM1",2,0)
 ;;5.3;Scheduling;**32,167,168,80,223,263,273**;Aug 13, 1993
"RTN","SDM1",3,0)
1 L  Q:$D(SDXXX)  S CCXN=0 K MXOK,COV,SDPROT Q:DFN<0  S SC=+SC
"RTN","SDM1",4,0)
 S X1=DT,SDEDT=365 S:$D(^SC(SC,"SDP")) SDEDT=$P(^SC(SC,"SDP"),"^",2)
"RTN","SDM1",5,0)
 S X2=SDEDT D C^%DTC S SDEDT=X D WRT
"RTN","SDM1",6,0)
 I $D(^SC(SC,"SI")),$O(^("SI",0))>0 W !,*7,?8,"**** SPECIAL INSTRUCTIONS ****",! S %I=0 F %=0:1 S %I=$O(^SC(SC,"SI",%I)) Q:%I'>0  W ^(%I,0) W:% ! I '%,$O(^SC(SC,"SI",%I))>0 S POP=0 D SPIN Q:POP
"RTN","SDM1",7,0)
 I $D(SDINA),SDINA>DT D IN W !,?8,@SDMSG K SDMSG
"RTN","SDM1",8,0)
 G:SDMM RDTY^SDMM
"RTN","SDM1",9,0)
 ;
"RTN","SDM1",10,0)
ADT S:'$D(SDW) SDW=""
"RTN","SDM1",11,0)
 S SDSOH=$S('$D(^SC(SC,"SL")):0,$P(^("SL"),"^",8)']"":0,1:1),CCX=""
"RTN","SDM1",12,0)
 S SDONCE=$G(SDONCE)+1  ;Prevent repetitive iteration
"RTN","SDM1",13,0)
 S X=$S(SDONCE<2:$G(SDSDATE),1:"")  ;Use default date/time if specified as 'desired date'  
"RTN","SDM1",14,0)
 I 'X R !,"DATE/TIME: ",X:DTIME G:X="M"!(X="m") MORDIS^SDM0 I "^"[X D  Q
"RTN","SDM1",15,0)
 .;
"RTN","SDM1",16,0)
 .;Wait List Hook/teh patch 263
"RTN","SDM1",17,0)
 .;
"RTN","SDM1",18,0)
WL .I $D(SC) S SDWLFLG=0 D
"RTN","SDM1",19,0)
 ..I $D(^SDWL(409.32,"B",+SC)) S SDWLFLG=1
"RTN","SDM1",20,0)
 ..I 'SDWLFLG S SDWLDSS=$P($G(^SC(+SC,0)),U,7) I $D(^SDWL(409.31,"B",SDWLDSS)) S SDWLFLG=2
"RTN","SDM1",21,0)
 ..I SDWLFLG=1 S SDWLSC=$O(^SDWL(409.32,"B",+SC,0)) I $P(^SDWL(409.32,SDWLSC,0),U,4) S SDWLFLG=0
"RTN","SDM1",22,0)
 ..I SDWLFLG=2 S SDWLDS=$O(^SDWL(409.31,"E",DUZ(2),0)) I $D(^SDWL(409.31,SDWLDSS,"I",+SDWLDS,0)),$P(^(0),U,4) S SDWLFLG=0
"RTN","SDM1",23,0)
 ..I SDWLFLG D
"RTN","SDM1",24,0)
 ...K SDWLSC,SDWLDSS,SDWLDS,SDWLFLG
"RTN","SDM1",25,0)
 ...S SDWLOPT=1,SDWLERR=0 D OPT^SDWLE D EN^SDWLKIL
"RTN","SDM1",26,0)
 .Q
"RTN","SDM1",27,0)
 .;
"RTN","SDM1",28,0)
 I X="D"!(X="d") S X=$$REDDT() G:X>0 MORD2^SDM0 S X="" W "  ??",! G ADT
"RTN","SDM1",29,0)
 I X?1"?".E D  G ADT
"RTN","SDM1",30,0)
 .W !,"Enter a date/time for the appointment"
"RTN","SDM1",31,0)
 .W:$D(SD) " or a space to choose the same date/time as the patient you have just previously scheduled into this clinic"
"RTN","SDM1",32,0)
 .W ".",!,"You may also select 'M' to display the next month's availability or"
"RTN","SDM1",33,0)
 .W !,"'D' to specify an earlier or later date to begin the availability display."
"RTN","SDM1",34,0)
 I X=" ",$D(SD),SD S Y=SD D AT^SDUTL W Y S Y=SD G OVR
"RTN","SDM1",35,0)
 I $E($P(X,"@",2),1,4)?1.4"0" K %DT S X=$P(X,"@"),X=$S($L(X):X,1:"T"),%DT="XF" D ^%DT G ADT:Y'>0 S X1=Y,X2=-1 D C^%DTC S X=X_.24
"RTN","SDM1",36,0)
 K %DT S %DT="TXEF" D ^%DT
"RTN","SDM1",37,0)
 I $P(Y,".",2)=24 S X1=$P(Y,"."),X2=1 D C^%DTC S Y=X_".000001"
"RTN","SDM1",38,0)
OVR I $D(^HOLIDAY($P(Y,"."),0)),'SDSOH W *7,?50,$P(^(0),U,2),"??" K SDSDATE G ADT
"RTN","SDM1",39,0)
 I $D(SDINA),$P(Y,".")'<SDINA,$S('$D(SDRE):1,SDRE>$P(Y,".")!('SDRE):1,1:0) D IN W !,*7,@SDMSG K SDMSG K SDSDATE G ADT
"RTN","SDM1",40,0)
 I Y#1=0 K SDSDATE G 1
"RTN","SDM1",41,0)
 I $P(Y,".")'<SDEDT W !,*7,"EXCEEDS MAXIMUM DAYS FOR FUTURE APPOINTMENT!!",*7 K SDSDATE G ADT
"RTN","SDM1",42,0)
 ;
"RTN","SDM1",43,0)
EN1 S (X,SD)=Y,SM=0 D DOW
"RTN","SDM1",44,0)
 F S=$P(SD,"."):0 S S=+$O(^DPT(DFN,"S",S)) Q:$P(S,".")-($P(SD,"."))  S I=+^(S,0) G ^SDM2:$P(^(0),U,2)'["C"
"RTN","SDM1",45,0)
 ;
"RTN","SDM1",46,0)
PRECAN I $D(^DPT(DFN,"S",SD,0)),$P(^(0),U,2)["P" S %=1 W !,"THIS TIME WAS PREVIOUSLY CANCELLED BY THE PATIENT",!,"ARE YOU SURE THAT YOU WANT TO PROCEED" D YN^DICN W:'% !,"ANSWER WITH (Y)ES OR (N)O" I (%-1) K SDSDATE G ADT
"RTN","SDM1",47,0)
 W !
"RTN","SDM1",48,0)
 ;
"RTN","SDM1",49,0)
S I '$D(^SC(SC,"ST",$P(SD,"."),1)) S SS=+$O(^SC(+SC,"T"_Y,SD)) G XW:SS'>0,XW:^(SS,1)="" S ^SC(+SC,"ST",$P(SD,"."),1)=$E($P($T(DAY),U,Y+2),1,2)_" "_$E(SD,6,7)_$J("",SI+SI-6)_^(1),^(0)=$P(SD,".")
"RTN","SDM1",50,0)
LEN I $P(SL,U,2)]"" W !,"LENGTH OF APPOINTMENT (IN MINUTES): ",+SL,"// " R S:DTIME I S]"" G:$L(S)>3 LEN Q:U[S  S POP=0 D L G LEN:POP,S:S\5*5'=S,S:S>360,S:S<5 S SL=S_U_$P(SL,U,2,99)
"RTN","SDM1",51,0)
 ;
"RTN","SDM1",52,0)
SC S SDLOCK=$S('$D(SDLOCK):1,1:SDLOCK+1) G:SDLOCK>9 LOCK
"RTN","SDM1",53,0)
 L ^SC(SC,"ST",$P(SD,"."),1):5 G:'$T SC
"RTN","SDM1",54,0)
 S SDLOCK=0,S=^SC(SC,"ST",$P(SD,"."),1)
"RTN","SDM1",55,0)
 S I=SD#1-SB*100,ST=I#1*SI\.6+($P(I,".")*SI),SS=SL*HSI/60*SDDIF+ST+ST
"RTN","SDM1",56,0)
 G X:(I<1!'$F(S,"["))&(S'["CAN")
"RTN","SDM1",57,0)
 I SM<7 S %=$F(S,"[",SS-1) S:'%!($P(SL,"^",6)<3) %=999 I $F(S,"]",SS)'<%!(SDDIF=2&$E(S,ST+ST+1,SS-1)["[") S SM=7
"RTN","SDM1",58,0)
 ;
"RTN","SDM1",59,0)
SP I ST+ST>$L(S),$L(S)<80 S S=S_" " G SP
"RTN","SDM1",60,0)
 S SDNOT=1
"RTN","SDM1",61,0)
 F I=ST+ST:SDDIF:SS-SDDIF S ST=$E(S,I+1) S:ST="" ST=" " S Y=$E(STR,$F(STR,ST)-2) G C:S["CAN"!(ST="X"&($D(^SC(+SC,"ST",$P(SD,"."),"CAN")))),X:Y="" S:Y'?1NL&(SM<6) SM=6 S ST=$E(S,I+2,999) S:ST="" ST=" " S S=$E(S,1,I)_Y_ST
"RTN","SDM1",62,0)
 Q:SDMM  G OK^SDM1A:SM#9=0,^SDM3:$P(SL,U,7)]""&('$D(MXOK))
"RTN","SDM1",63,0)
 ;
"RTN","SDM1",64,0)
E G:'$D(^XUSEC("SDOB",DUZ)) NOOB
"RTN","SDM1",65,0)
 S %=2 W *7,!,$E($T(@SM),5,99),"...OK" D YN^DICN
"RTN","SDM1",66,0)
 I '% W !,"RESPOND YES OR NO" G E
"RTN","SDM1",67,0)
 S SM=9 G SC:'(%-1) K SDSDATE G 1
"RTN","SDM1",68,0)
 ;
"RTN","SDM1",69,0)
LOCK Q:SDMM  W !,*7,"ANOTHER USER HAS LOCKED THIS DATE - TRY AGAIN LATER" Q
"RTN","SDM1",70,0)
 ;
"RTN","SDM1",71,0)
6 ;;OVERBOOK!
"RTN","SDM1",72,0)
7 ;;THAT TIME IS NOT WITHIN SCHEDULED PERIOD!
"RTN","SDM1",73,0)
C S POP=1 W !,*7,"CAN'T BOOK WITHIN A CANCELLED TIME PERIOD!",!
"RTN","SDM1",74,0)
 Q:SDMM  K SDSDATE G 1
"RTN","SDM1",75,0)
 ;
"RTN","SDM1",76,0)
DAY ;;^SUN^MON^TUES^WEDNES^THURS^FRI^SATUR
"RTN","SDM1",77,0)
 ;
"RTN","SDM1",78,0)
DOW S %=$E(X,1,3),Y=$E(X,4,5),Y=Y>2&'(%#4)+$E("144025036146",Y)
"RTN","SDM1",79,0)
 F %=%:-1:281 S Y=%#4=1+1+Y
"RTN","SDM1",80,0)
 S Y=$E(X,6,7)+Y#7 Q
"RTN","SDM1",81,0)
 ;
"RTN","SDM1",82,0)
X I SDMM S POP=1 Q
"RTN","SDM1",83,0)
 G:I<1 XW
"RTN","SDM1",84,0)
 S:Y'?1NL&(SM<6) SM=6
"RTN","SDM1",85,0)
 G OK^SDM1A:SM#9=0,^SDM3:$P(SL,U,7)]""&('$D(MXOK))
"RTN","SDM1",86,0)
XW W *7,"  WHEN??" K SDSDATE G 1
"RTN","SDM1",87,0)
 ;
"RTN","SDM1",88,0)
NOOB W !,"NO OPEN SLOTS THEN",*7 K SDSDATE G 1
"RTN","SDM1",89,0)
 ;
"RTN","SDM1",90,0)
WRT W !,+SL," MINUTE APPOINTMENTS "
"RTN","SDM1",91,0)
 W $S($P(SL,U,2)["V":"(VARIABLE LENGTH)",1:"") Q
"RTN","SDM1",92,0)
 ;
"RTN","SDM1",93,0)
L S SDSL=$S($P(SL,"^",6)]"":60/$P(SL,"^",6),1:"") Q:'SDSL
"RTN","SDM1",94,0)
 I S\(SDSL)*(SDSL)'=S W *7,!,"Appt. length must = or be a multiple of the increment minutes per hour (",SDSL,")",! S POP=1
"RTN","SDM1",95,0)
 Q
"RTN","SDM1",96,0)
 ;
"RTN","SDM1",97,0)
IN S SDHY=$S($D(Y):Y,1:""),Y=SDINA D DTS^SDUTL S Y1=Y,Y=SDRE
"RTN","SDM1",98,0)
 D:Y DTS^SDUTL
"RTN","SDM1",99,0)
 S SDMSG="""*** Note: Clinic is scheduled to be inactivated on "","_""""_Y1_""""_$S(SDRE:",!,?10,"_""" and reactivated on "","_""""_Y_"""",1:""),Y=SDHY K Y1,SDHY
"RTN","SDM1",100,0)
 Q
"RTN","SDM1",101,0)
 ;
"RTN","SDM1",102,0)
SPIN W !,"There are more special instructions. Do you want to display them"
"RTN","SDM1",103,0)
 S %=2 D YN^DICN
"RTN","SDM1",104,0)
 I '% W !,"Enter Y to see the remaining special instructions, or N if you don't wish to see them" G SPIN
"RTN","SDM1",105,0)
 I (%-1) S POP=1 Q
"RTN","SDM1",106,0)
 W !,^SC(SC,"SI",%I,0),! Q
"RTN","SDM1",107,0)
 ;
"RTN","SDM1",108,0)
REDDT() ;Prompt for availability redisplay date
"RTN","SDM1",109,0)
 N %DT,X,Y
"RTN","SDM1",110,0)
 S %DT="AEX"
"RTN","SDM1",111,0)
 S %DT("A")="DATE TO BEGIN THE RE-DISPLAY OF CLINIC AVAILABILITY: "
"RTN","SDM1",112,0)
 W ! D ^%DT
"RTN","SDM1",113,0)
 Q Y
"RTN","SDM4")
0^7^B8958431
"RTN","SDM4",1,0)
SDM4 ;ALB/BOK - MAKE APPOINTMENT ; 12 APR 1988 1100
"RTN","SDM4",2,0)
 ;;5.3;Scheduling;**263,273**;Aug 13, 1993
"RTN","SDM4",3,0)
 ;
"RTN","SDM4",4,0)
 ;09/15/2002 $N FUNCTION REMOVED AND REPLACED WITH $O - IOFO - BAY PINES - TEH
"RTN","SDM4",5,0)
 ;
"RTN","SDM4",6,0)
TYPE ;
"RTN","SDM4",7,0)
 D SC
"RTN","SDM4",8,0)
 D 2^VADPT S SDATD=$S($D(SDAPTYP):SDAPTYP,$D(^SC(+SC,"AT")):$S($D(^SD(409.1,+^("AT"),0)):$P(^(0),U),1:"REGULAR"),1:"REGULAR") W !,"APPOINTMENT TYPE: "_SDATD_"//" R X:DTIME I X']"" S X=SDATD
"RTN","SDM4",9,0)
 I X["^" W !,"APPOINTMENT TYPE IS REQUIRED" G TYPE
"RTN","SDM4",10,0)
 S SDEC=$S($D(^DIC(8,+VAEL(1),0)):$P(^(0),U,5),1:"")
"RTN","SDM4",11,0)
 S DIC("S")="I '$P(^(0),U,3),$S(SDEC[""Y"":1,1:$P(^(0),U,5)),$S('$P(^(0),U,6):1,$D(VAEL(1,+$P(^(0),U,6))):1,+VAEL(1)=$P(^(0),U,6):1,1:0)",DIC="^SD(409.1,",DIC(0)="EQMZ" D ^DIC K DIC
"RTN","SDM4",12,0)
 I X["^"!(Y'>0) W !,"Appointment type is required",!,"Patient must have the eligibility code EMPLOYEE, COLLATERAL or SHARING AGREEMENT",!,"to choose those types of appointments." G TYPE
"RTN","SDM4",13,0)
 S COLLAT=$S(+Y=1:1,+Y=7:7,1:0),SDAPTYP=+Y,SDDECOD=$P(^SD(409.1,+Y,0),U,6) I COLLAT W !!,"** Note - You are making a ",$P(^SD(409.1,+COLLAT,0),U)," appt.",!
"RTN","SDM4",14,0)
 Q:$D(SDAMBAE)
"RTN","SDM4",15,0)
 I COLLAT=7 S SDCOL=$P(^SD(409.1,SDAPTYP,0),U,6) I '$D(SDMLT)&'$D(SDD) D ^SDM0,END^SDM
"RTN","SDM4",16,0)
 Q
"RTN","SDM4",17,0)
ELIG S SDALLE="",SDEMP=$P(VAEL(1),U,2) W !,"THIS PATIENT HAS OTHER ENTITLED ELIGIBILITIES:" F SDOEL=0:0 S SDOEL=$O(VAEL(1,SDOEL)) Q:SDOEL=""  W !?5,$P(VAEL(1,SDOEL),U,2) S SDALLE=SDALLE_"^"_$P(VAEL(1,SDOEL),U,2)
"RTN","SDM4",18,0)
1 W !,"ENTER THE ELIGIBILITY FOR THIS APPOINTMENT: "_SDEMP_"// " R X:DTIME Q:"^"[X  S X=$$UPPER^VALM1(X) G ELIG:X["?",1:SDALLE'[("^"_X)
"RTN","SDM4",19,0)
 S SDEMP=X_$P($P(SDALLE,"^"_X,2),"^") W $P($P(SDALLE,"^"_X,2),"^")
"RTN","SDM4",20,0)
 F SDOEL=0:0 S SDOEL=$O(VAEL(1,SDOEL)) Q:SDOEL=""  I $P(VAEL(1,SDOEL),U,2)=SDEMP S SDEMP=SDOEL_"^"_SDEMP Q
"RTN","SDM4",21,0)
 Q
"RTN","SDM4",22,0)
SC ;SERVICE CONNECTED MESSAGE/IOFO - BAY PINES/TEH
"RTN","SDM4",23,0)
 I $D(^DPT(DFN,.3)) S SDAMSCN=+$P(^(.3),U,2) I SDAMSCN>49 D
"RTN","SDM4",24,0)
 .W !,?7,"********** THIS PATIENT IS 50% OR GREATER SERVICE-CONNECTED **********",!
"RTN","SDM4",25,0)
 I $D(SDWLLIST),SDWLLIST D ^SDWLR
"RTN","SDM4",26,0)
 Q
"RTN","SDWLDISP")
0^4^B31093418
"RTN","SDWLDISP",1,0)
SDWLDISP ;;IOFO BAY PINES/TEH - WAIT LIST - DISPOSITION WAIT LIST ENTRY;06/12/2002 ; 20 Aug 2002  2:10 PM
"RTN","SDWLDISP",2,0)
 ;;5.3;scheduling;**263,273**;AUG 13 1993
"RTN","SDWLDISP",3,0)
 ;
"RTN","SDWLDISP",4,0)
 ;
"RTN","SDWLDISP",5,0)
 ;******************************************************************
"RTN","SDWLDISP",6,0)
 ;                             CHANGE LOG
"RTN","SDWLDISP",7,0)
 ;                                               
"RTN","SDWLDISP",8,0)
 ;   DATE                        PATCH                   DESCRIPTION
"RTN","SDWLDISP",9,0)
 ;   ----                        -----                   -----------
"RTN","SDWLDISP",10,0)
 ;  11/19/2002                 SD*5.3*273              EN1+4 CHECK FOR "^"
"RTN","SDWLDISP",11,0)
 ;  11/19/2002                 SD*5.3*273              REMOVED DIC("S") SCREEN FROM PAT
"RTN","SDWLDISP",12,0)
 ;
"RTN","SDWLDISP",13,0)
 ;
"RTN","SDWLDISP",14,0)
 ;
"RTN","SDWLDISP",15,0)
 ;
"RTN","SDWLDISP",16,0)
EN ;
"RTN","SDWLDISP",17,0)
 S SDWLERR=0 I $D(SDWLLIST),SDWLLIST D
"RTN","SDWLDISP",18,0)
 .I '$D(DFN) S SDWLERR=1 Q
"RTN","SDWLDISP",19,0)
 .I $D(DFN),'$D(^SDWL(409.3,"B",DFN)) D HD,1^VADPT,DEM^VADPT W !,VADM(1),?40,VA("PID"),*7,!,"This Patient has NO entries on the Electronic Wait List." S DIR(0)="E" D ^DIR S DUOUT=1 Q
"RTN","SDWLDISP",20,0)
 I $D(DUOUT) Q
"RTN","SDWLDISP",21,0)
 I 'SDWLERR,$D(SDWLLIST),SDWLLIST D HD S SDWLDFN=DFN K DIR,DIC,DR,DIE,VADM D 1^VADPT,DEM^VADPT W !,VADM(1),?40,VA("PID") S (SDWLBDT,SDWLEDT)="" D DIS G EN1
"RTN","SDWLDISP",22,0)
 K DIR,DIC,DR,DIE
"RTN","SDWLDISP",23,0)
 ;OPTION HEADER
"RTN","SDWLDISP",24,0)
 ;
"RTN","SDWLDISP",25,0)
 S SDWLOP=" - Disposition Patient" D HD
"RTN","SDWLDISP",26,0)
 ;
"RTN","SDWLDISP",27,0)
 ;PATIENT LOOK-UP FROM WAIT LIST PATIENT FILE (^SDWL(409.3,IEN,0).
"RTN","SDWLDISP",28,0)
 ;
"RTN","SDWLDISP",29,0)
 D PAT G END:'$D(SDWLDFN),END:SDWLDFN<0,END:SDWLDFN=""
"RTN","SDWLDISP",30,0)
 ;
"RTN","SDWLDISP",31,0)
 ;DISPLAY PATIENT DATA FROM ^SDWL(409.3,IEN,0).
"RTN","SDWLDISP",32,0)
 ;
"RTN","SDWLDISP",33,0)
 D DIS
"RTN","SDWLDISP",34,0)
 ;PROMPT USER FOR RECORD FOR DISPOSITIONING.
"RTN","SDWLDISP",35,0)
 ;
"RTN","SDWLDISP",36,0)
EN1 K DIR,DIC,DIE,DR,X,Y,SDWLERR S SDWLPS=$S(SDWLCN>1:1,SDWLCN=1:2,1:0),SDWLERR=0
"RTN","SDWLDISP",37,0)
 I SDWLPS=0 W !!,"Patient has no Wait List Entries to Disposition." S DIR(0)="E" D ^DIR G END
"RTN","SDWLDISP",38,0)
 I SDWLPS=1 S DIR(0)="FOA^^" S DIR("A")="Select Wait List (1-"_SDWLCN_") or '^' to Quit? "
"RTN","SDWLDISP",39,0)
 I SDWLPS=2 S DIR(0)="FOA^^" S DIR("A")="Disposition This 'ENTRY' or '^' to Quit? Yes // "
"RTN","SDWLDISP",40,0)
 W ! D ^DIR G END:X["^" S SDWLY=Y W !
"RTN","SDWLDISP",41,0)
 I SDWLPS=1 D
"RTN","SDWLDISP",42,0)
 .S SDWLERR=$S(X?1N.N:0,X?1"N".E:1,X?1"n".E:1,X="":1,X?1"Y".E:0,X?1"y".E:0,$D(DUOUT):1,X["^":1,1:2)
"RTN","SDWLDISP",43,0)
 I $D(SDWLERR),SDWLERR=2 W *7," Invalid Entry" G EN1
"RTN","SDWLDISP",44,0)
 I SDWLPS=2 D
"RTN","SDWLDISP",45,0)
 .S SDWLERR=$S(X="":0,X?1"Y".E:0,X?1"y":0,X?1"N".E:1,X?1"n".E:1,X["^":1,1:2)
"RTN","SDWLDISP",46,0)
 I SDWLERR=2 W *7," Invalid Entry" G EN1
"RTN","SDWLDISP",47,0)
 G END:SDWLERR
"RTN","SDWLDISP",48,0)
 I SDWLPS=2,'SDWLY S SDWLY=1
"RTN","SDWLDISP",49,0)
 S SDWLERR=0 I SDWLY?1N.N D  G EN1:SDWLERR
"RTN","SDWLDISP",50,0)
 .K DIR,DIC,DR
"RTN","SDWLDISP",51,0)
 .;
"RTN","SDWLDISP",52,0)
 .;CHECK FOR VALID ENTRY
"RTN","SDWLDISP",53,0)
 .;
"RTN","SDWLDISP",54,0)
 .I '$D(^TMP("SDWLD",$J,SDWLDFN,+SDWLY)) W " Invalid Entry " S SDWLERR=1 Q
"RTN","SDWLDISP",55,0)
 .S SDWLDA=$P($G(^TMP("SDWLD",$J,SDWLDFN,+SDWLY)),"~",2)
"RTN","SDWLDISP",56,0)
 .;
"RTN","SDWLDISP",57,0)
 .;LOCK DATA FILE
"RTN","SDWLDISP",58,0)
 .;
"RTN","SDWLDISP",59,0)
 .L ^SDWL(409.3,SDWLDA):5 I '$T W !,"Another User is Editing this Entry. Try Later." S DUOUT=1
"RTN","SDWLDISP",60,0)
 I $D(DUOUT) G END
"RTN","SDWLDISP",61,0)
 ;
"RTN","SDWLDISP",62,0)
 ;GET PATIENT DATA FROM ^SDWL(409.3,IEN,0).
"RTN","SDWLDISP",63,0)
 ;
"RTN","SDWLDISP",64,0)
 D GETDATA
"RTN","SDWLDISP",65,0)
 ;
"RTN","SDWLDISP",66,0)
 ;ENTER DISPOSITION
"RTN","SDWLDISP",67,0)
 ;  
"RTN","SDWLDISP",68,0)
 D EDIT G END:$D(DUOUT) I $D(SDWLERR) G END:SDWLERR
"RTN","SDWLDISP",69,0)
 W !,"*** Patient has been removed from Wait List. ***"
"RTN","SDWLDISP",70,0)
 K DIR,DIE,DR,DIC
"RTN","SDWLDISP",71,0)
 S DIR(0)="E" D ^DIR I $D(DUOUT) G END
"RTN","SDWLDISP",72,0)
 D END G EN
"RTN","SDWLDISP",73,0)
 ;
"RTN","SDWLDISP",74,0)
 Q
"RTN","SDWLDISP",75,0)
PAT ;PATIENT LOOK-UP
"RTN","SDWLDISP",76,0)
 ;
"RTN","SDWLDISP",77,0)
 S DIC(0)="EMNAQ",DIC=409.3 D ^DIC S (SDWLDFN,DFN)=$P(Y,U,2) G PAT1:DFN<0
"RTN","SDWLDISP",78,0)
 G PAT1:DFN=""
"RTN","SDWLDISP",79,0)
 S SDWLNAM=$$GET1^DIQ(2,DFN_",",.01)
"RTN","SDWLDISP",80,0)
 S X=$$GET1^DIQ(2,DFN_",",".351") I X'="" W !,*7,"PATIENT'S DATE OF DEATH HAS BEEN RECORDED" G PAT
"RTN","SDWLDISP",81,0)
 D 1^VADPT
"RTN","SDWLDISP",82,0)
PAT1 Q
"RTN","SDWLDISP",83,0)
 ;
"RTN","SDWLDISP",84,0)
DIS ;DISPLAY DATA FOR PATIENT
"RTN","SDWLDISP",85,0)
 ;
"RTN","SDWLDISP",86,0)
 S SDWLDISC="",SDWLCN=0,SDWLHDR="Wait List Disposition"
"RTN","SDWLDISP",87,0)
 D EN^SDWLD(SDWLDFN,VA("PID"),VADM(1))
"RTN","SDWLDISP",88,0)
 K VADM,VAIN,VA,SDWLDISC
"RTN","SDWLDISP",89,0)
 Q
"RTN","SDWLDISP",90,0)
GETDATA ;PATIENT DATA RETRIEVAL
"RTN","SDWLDISP",91,0)
 ;
"RTN","SDWLDISP",92,0)
 S SDWLDATA=$G(^SDWL(409.3,SDWLDA,0))
"RTN","SDWLDISP",93,0)
 S SDWLIN=$P(SDWLDATA,U,3),SDWLCL=+$P(SDWLDATA,U,4),SDWLTY=$P(SDWLDATA,U,5),SDWLST=$P(SDWLDATA,U,6)
"RTN","SDWLDISP",94,0)
 S SDWLSP=$P(SDWLDATA,U,7),SDWLSS=$P(SDWLDATA,U,8),SDWLSC=$P(SDWLDATA,U,9),SDWLPRI=$P(SDWLDATA,U,10),SDWLRB=$P(SDWLDATA,U,11)
"RTN","SDWLDISP",95,0)
 S SDWLPROV=$P(SDWLDATA,U,12),SDWLDAPT=$P(SDWLDATA,U,16),SDWLST=$P(SDWLDATA,U,17),SDWLDUZ=DUZ,SDWLEDT=DT
"RTN","SDWLDISP",96,0)
 I $D(^SDWL(409.3,SDWLDA,"DIS")) S SDWLDISP=$P(^SDWL(409.3,SDWLDA,"DIS"),U,3)
"RTN","SDWLDISP",97,0)
 Q
"RTN","SDWLDISP",98,0)
EDIT ;ENTER/EDIT DISPOSITION
"RTN","SDWLDISP",99,0)
 ;
"RTN","SDWLDISP",100,0)
 S SDWLDUZ=DUZ,SDWLERR=0 K DIR,DR,DIE,DIC
"RTN","SDWLDISP",101,0)
 I $D(SDWLDISP) S DIR("B")=$$EXTERNAL^DILFD(409.3,21,,SDWLDISP)
"RTN","SDWLDISP",102,0)
 S DIR(0)="SO^D:DEATH;NC:REMOVED/NON-VA CARE;SA:REMOVED/SCHEDULED-ASSIGNED;CC:REMOVED/VA CONTRACT CARE;NN:REMOVED/NO LONGER NECESSARY;ER:ENTERED IN ERROR^"
"RTN","SDWLDISP",103,0)
 S DIR("L",1)="Disposition Reason:",DIR("L",2)="",DIR("L",3)="D DEATH",DIR("L",4)="NC REMOVED/NON-VA CARE",DIR("L",5)="SA REMOVED/SCHEDULED-ASSIGNED"
"RTN","SDWLDISP",104,0)
 S DIR("L",6)="CC REMOVED/VA CONTRACT CARE",DIR("L",7)="NN REMOVED/NO LONGER NECESSARY",DIR("L")="ER ENTERED IN ERROR"
"RTN","SDWLDISP",105,0)
 D ^DIR
"RTN","SDWLDISP",106,0)
 I X="" S DUOUT=1 Q
"RTN","SDWLDISP",107,0)
 I X="^" S DUOUT=1 Q
"RTN","SDWLDISP",108,0)
 S SDWLDISP=$S(X["D":"D",X["d":"D",X["NC":"NC",X["nc":"NC",X["SA":"SA",X["sa":"SA",X["CC":"CC",X["cc":"CC",X["NN":"NN",X["nn":"NN",X["ER":"ER",X["er":"ER",1:0)
"RTN","SDWLDISP",109,0)
 I SDWLDISP=0 S SDWLERR=1
"RTN","SDWLDISP",110,0)
 I SDWLERR W *7,"Invalid Entry" G EDIT
"RTN","SDWLDISP",111,0)
 S DIE("NO^")="NO EDITING"
"RTN","SDWLDISP",112,0)
 S DIE="^SDWL(409.3,",DA=SDWLDA,DR="21////^S X=SDWLDISP" D ^DIE
"RTN","SDWLDISP",113,0)
 S DR="19////^S X=DT" D ^DIE
"RTN","SDWLDISP",114,0)
 S DR="20////^S X=SDWLDUZ" D ^DIE
"RTN","SDWLDISP",115,0)
 S DR="23////^S X=""C""" D ^DIE
"RTN","SDWLDISP",116,0)
 Q
"RTN","SDWLDISP",117,0)
HD ;HEADER
"RTN","SDWLDISP",118,0)
 ;
"RTN","SDWLDISP",119,0)
 W:$D(IOF) @IOF W !!,?80-$L("Wait List - Disposition Patient")\2,"Wait List - Disposition Patient",!!
"RTN","SDWLDISP",120,0)
 ;
"RTN","SDWLDISP",121,0)
END ;QUIT OPTION
"RTN","SDWLDISP",122,0)
 K DIC,DIR,DR,DIE,SDWLDFN,DUOUT
"RTN","SDWLDISP",123,0)
 K SDWLCL,SDWSLCN,SDWLDA,SDWLDAPT,SDWLDATA,SDWLDFN,SDWLDISP,SDWLDUZ,SDWLEDT,SDWLERR,SDWLIN,SDWLNAM,SDWLOP,SDWLPRI
"RTN","SDWLDISP",124,0)
 K SDWLPROV,SDWLPS,SDWLRB,SDWLSC,SDWLSP,SDWLSS,SDWLST,SDWLTY,SDWLY,X,Y,SDWLHDR
"RTN","SDWLDISP",125,0)
 Q
"RTN","SDWLE110")
0^1^B21792281
"RTN","SDWLE110",1,0)
SDWLE110 ;;IOFO BAY PINES/TEH - WAITING LIST-ENTER/EDIT;06/12/2002 ; 29 Aug 2002  2:54 PM
"RTN","SDWLE110",2,0)
 ;;5.3;scheduling;**263,273**;AUG 13 1993
"RTN","SDWLE110",3,0)
 ;
"RTN","SDWLE110",4,0)
 ;
"RTN","SDWLE110",5,0)
 ;******************************************************************
"RTN","SDWLE110",6,0)
 ;                             CHANGE LOG
"RTN","SDWLE110",7,0)
 ;                                               
"RTN","SDWLE110",8,0)
 ;   DATE                        PATCH                   DESCRIPTION
"RTN","SDWLE110",9,0)
 ;   ----                        -----                   -----------
"RTN","SDWLE110",10,0)
 ;   11/27/02                  SD*5.3*273            Add "/", line SA1+11,+13,FA2+13
"RTN","SDWLE110",11,0)
 ;   
"RTN","SDWLE110",12,0)
 ;   
"RTN","SDWLE110",13,0)
EN K DIR
"RTN","SDWLE110",14,0)
 I $D(^SDWL(409.3,SDWLDA,0)) S DIR("B")=$$EXTERNAL^DILFD(409.3,10,,$P(^(0),U,11))
"RTN","SDWLE110",15,0)
 I DIR("B")="" K DIR("B")
"RTN","SDWLE110",16,0)
 S DIR(0)="SO^1:Future;2:ASAP"
"RTN","SDWLE110",17,0)
 S DIR("L",1)="Priority",DIR("L",2)=""
"RTN","SDWLE110",18,0)
 S DIR("L",3)="1. Future",DIR("L")="2. ASAP"
"RTN","SDWLE110",19,0)
 D ^DIR I X["^" S DUOUT=1 Q  ;-'^' here will remove patient from wait list
"RTN","SDWLE110",20,0)
 I X="@" W *7," ??" G EN
"RTN","SDWLE110",21,0)
 I X="" W *7,"Required or '^' to quit." G EN
"RTN","SDWLE110",22,0)
 I $D(DTOUT) S DUOUT=1 Q
"RTN","SDWLE110",23,0)
 S SDWLPRIE=$S(X["A":"A",X["F":"F",X[1:"F",X[2:"A",X["a":"A",X["f":"F",1:"F")
"RTN","SDWLE110",24,0)
 S DIE="^SDWL(409.3,",DA=SDWLDA,DR="10////^S X=SDWLPRIE" D ^DIE
"RTN","SDWLE110",25,0)
 ;
"RTN","SDWLE110",26,0)
 ;If priority is ASAP ask requesting provider
"RTN","SDWLE110",27,0)
 ;
"RTN","SDWLE110",28,0)
 I SDWLPRIE="A" S Y=DT D DD^%DT W " ",Y D SA,DUP G END:$D(DUOUT) Q
"RTN","SDWLE110",29,0)
 I SDWLPRIE="F" D FA G END:$D(DUOUT) Q
"RTN","SDWLE110",30,0)
 Q
"RTN","SDWLE110",31,0)
SA K DIR,DR,DIE S SDWLERR=0,SDWLX=$S($D(SDWLPROV):$$EXTERNAL^DILFD(409.3,12,,SDWLPROV),1:"")
"RTN","SDWLE110",32,0)
 I $D(SDWLPROV),SDWLPROV,SDWLX'="" S DIR("B")=SDWLX
"RTN","SDWLE110",33,0)
 I $D(^SDWL(409.3,SDWLDA,0)) S DIR("B")=$$EXTERNAL^DILFD(409.3,11,,$P(^(0),U,12))
"RTN","SDWLE110",34,0)
 I DIR("B")="" K DIR("B")
"RTN","SDWLE110",35,0)
 K %DT,DR S DIR(0)="SO^1:Provider;2:Patient"
"RTN","SDWLE110",36,0)
 S DIR("L",1)="Request By",DIR("L",2)=""
"RTN","SDWLE110",37,0)
 S DIR("L",3)="1. Provider",DIR("L")="2. Patient"
"RTN","SDWLE110",38,0)
 D ^DIR I X["^" S DUOUT=1,DIR("A")="ASAP" Q
"RTN","SDWLE110",39,0)
 S X=Y
"RTN","SDWLE110",40,0)
 I $D(DTOUT) S DUOUT=1,DIR("A")="ASAP" Q
"RTN","SDWLE110",41,0)
 S SDWLRBE=$S(X=1:1,X["PR":1,X["pr":1,X["Pr":1,X=2:2,X["PA":2,X["pa":2,X["Pa":2,1:0) I 'SDWLRBE W *7," ??" G SA
"RTN","SDWLE110",42,0)
 S DR="11////^S X=SDWLRBE",DA=SDWLDA,DIE="^SDWL(409.3," D ^DIE
"RTN","SDWLE110",43,0)
SA1 I SDWLRBE=1 D
"RTN","SDWLE110",44,0)
 .S DIC("S")="I $$SCREEN^SDUTL2(Y,DT)"
"RTN","SDWLE110",45,0)
 .S SDWLX=$S($D(SDWLPROV):$$EXTERNAL^DILFD(409.3,12,,SDWLPROV),1:"") I SDWLX'="" S DIC("B")=SDWLPROV
"RTN","SDWLE110",46,0)
 .I $D(^SDWL(409.3,SDWLDA,0)) S DIR("B")=$$EXTERNAL^DILFD(409.3,11,,$P(^(0),U,12))
"RTN","SDWLE110",47,0)
 .S SDWLERR=0,DIC(0)="AEQ",DIC=200,DIC("A")="Provider Requesting Appointment: " D ^DIC
"RTN","SDWLE110",48,0)
 .I X["^" S DUOUT=1 Q
"RTN","SDWLE110",49,0)
 .I Y<1 S SDWLERR=1 Q
"RTN","SDWLE110",50,0)
 .I $D(DUOUT) Q
"RTN","SDWLE110",51,0)
 .I $D(DTOUT) S DUOUT=1 Q
"RTN","SDWLE110",52,0)
 .K DIC,DIC("S"),DIC("A"),DIC(0),DIC("B")
"RTN","SDWLE110",53,0)
 .S SDWLPROV=+Y,SDWLPRON=$P(Y,U,2),DIE="^SDWL(409.3,",DA=SDWLDA
"RTN","SDWLE110",54,0)
 .S DR="12////^S X=SDWLPROV" D ^DIE S SDWLPRVE=SDWLPROV
"RTN","SDWLE110",55,0)
 I SDWLERR W *7," Required" G SA1
"RTN","SDWLE110",56,0)
 S DR="11////^S X=SDWLRBE" D ^DIE
"RTN","SDWLE110",57,0)
 S DR="22///TODAY" D ^DIE K DIE,DR,DIC,DIR,SDWLPRVE,SDWLPROV,SDWLPRON
"RTN","SDWLE110",58,0)
 Q
"RTN","SDWLE110",59,0)
 ;
"RTN","SDWLE110",60,0)
 ;If Priority is 'FUTURE' ask Desired Date of Appointment and Requesting by Provider or Patient
"RTN","SDWLE110",61,0)
 ;
"RTN","SDWLE110",62,0)
FA S SDWLERR=0 K DIR,DUOUT,DR,DIE I $D(SDWLDAPE) S Y=SDWLDAPE D DD^%DT S DIR("B")=Y
"RTN","SDWLE110",63,0)
 I $D(^SDWL(409.3,SDWLDA,0)),$P(^(0),U,16) S DIR("B")=$$EXTERNAL^DILFD(409.3,22,,$P(^(0),U,16))
"RTN","SDWLE110",64,0)
 S DIR(0)="DA0^^",DIR("A")="Desired Date of Appointment: " D ^DIR
"RTN","SDWLE110",65,0)
 I X["^" K X,Y,DIR S DUOUT=1,DIR("B")="Future" Q
"RTN","SDWLE110",66,0)
 I $D(DTOUT) S DUOUT=1,DIR("B")="Future" Q
"RTN","SDWLE110",67,0)
 S %DT="E" D ^%DT
"RTN","SDWLE110",68,0)
 S SDWLDAPE=Y,DR="22////^S X=SDWLDAPE",DIE="^SDWL(409.3,",DA=SDWLDA D ^DIE
"RTN","SDWLE110",69,0)
 K SDWLDAPE
"RTN","SDWLE110",70,0)
FA1 K DIR,%DT,DR S DIR(0)="SO^1:Provider;2:Patient"
"RTN","SDWLE110",71,0)
 S SDWLX=$S($D(SDWLPROV):$$EXTERNAL^DILFD(409.3,12,,SDWLPROV),1:"") I SDWLX'="" S DIR("B")=SDWLPROV
"RTN","SDWLE110",72,0)
 I $D(^SDWL(409.3,SDWLDA,0)) S DIR("B")=$$EXTERNAL^DILFD(409.3,11,,$P(^(0),U,12))
"RTN","SDWLE110",73,0)
 I DIR("B")="" K DIR("B")
"RTN","SDWLE110",74,0)
 S DIR("L",1)="Request By",DIR("L",2)=""
"RTN","SDWLE110",75,0)
 S DIR("L",3)="1. Provider",DIR("L")="2. Patient"
"RTN","SDWLE110",76,0)
 D ^DIR I X["^" S DIR("B")=$S($D(SDWLDAPE):SDWLDAPE,1:"") G FA
"RTN","SDWLE110",77,0)
 S X=Y
"RTN","SDWLE110",78,0)
 I $D(DTOUT) S DUOUT=1 S DIR("B")=SDWLDAPE G FA
"RTN","SDWLE110",79,0)
 S SDWLRBE=$S(X=1:1,X["PR":1,X["pr":1,X["Pr":1,X=2:2,X["PA":2,X["pa":2,X["Pa":2,1:0) I 'SDWLRBE W *7," ??" G FA1
"RTN","SDWLE110",80,0)
 S DR="11////^S X=SDWLRBE",DA=SDWLDA,DIE="^SDWL(409.3," D ^DIE
"RTN","SDWLE110",81,0)
FA2 I SDWLRBE=1 D
"RTN","SDWLE110",82,0)
 .;
"RTN","SDWLE110",83,0)
 .;if provider is selected look-up valid provider from new person (File 200)
"RTN","SDWLE110",84,0)
 .;
"RTN","SDWLE110",85,0)
 .S DIC("S")="I $$SCREEN^SDUTL2(Y,DT)"
"RTN","SDWLE110",86,0)
 .S SDWLX=$S($D(SDWLPROV):$$EXTERNAL^DILFD(409.3,12,,SDWLPROV),1:""),DIC("B")=$S($D(SDWLPROV):SDWLX,1:"")
"RTN","SDWLE110",87,0)
 .S SDWLERR=0,DIC(0)="AEQ",DIC=200,DIC("A")="Provider Requesting Appointment: " D ^DIC
"RTN","SDWLE110",88,0)
 .I X["^" S DUOUT=1 Q
"RTN","SDWLE110",89,0)
 .I Y<1 S SDWLERR=1 Q
"RTN","SDWLE110",90,0)
 .I $D(DTOUT) S DUOUT=1 Q
"RTN","SDWLE110",91,0)
 .Q:$D(DUOUT)  D
"RTN","SDWLE110",92,0)
 ..K DIC,DIC("S"),DIC("A"),DIC(0),DIC("B")
"RTN","SDWLE110",93,0)
 ..S SDWLPROV=+Y,SDWLPRON=$P(Y,U,2),DIE="^SDWL(409.3,",DA=SDWLDA
"RTN","SDWLE110",94,0)
 ..S DR="12////^S X=SDWLPROV" D ^DIE S SDWLPRVE=SDWLPROV K DIE
"RTN","SDWLE110",95,0)
 I SDWLERR W *7," Required" G FA2
"RTN","SDWLE110",96,0)
END K DIC,DIE,DIR I $D(DUOUT) S DIR("B")=$S(SDWLPRIE="F":"Future",1:"ASAP")
"RTN","SDWLE110",97,0)
 K SDWLPRVE,SDWLPROV,SDWLPRON
"RTN","SDWLE110",98,0)
 Q
"RTN","SDWLE110",99,0)
DUP ;
"RTN","SDWLE110",100,0)
 Q
"RTN","SDWLE111")
0^6^B21497452
"RTN","SDWLE111",1,0)
SDWLE111 ;;IOFO BAY PINES/TEH - WAITING LIST-ENTER/EDIT - WAIT LIST TYPE/INSTUTITION;06/12/2002 ; 20 Aug 2002  2:10 PM
"RTN","SDWLE111",2,0)
 ;;5.3;scheduling;**263,273**;AUG 13 1993
"RTN","SDWLE111",3,0)
 ;
"RTN","SDWLE111",4,0)
 ;
"RTN","SDWLE111",5,0)
 ;******************************************************************
"RTN","SDWLE111",6,0)
 ;                             CHANGE LOG
"RTN","SDWLE111",7,0)
 ;                                               
"RTN","SDWLE111",8,0)
 ;   DATE                        PATCH                   DESCRIPTION
"RTN","SDWLE111",9,0)
 ;   ----                        -----                   -----------
"RTN","SDWLE111",10,0)
 ;10/01/2002                      263              Logical Order Change
"RTN","SDWLE111",11,0)
 ;2/25/2003                                               273                  ADD "/" to line EN2+19
"RTN","SDWLE111",12,0)
 ;
"RTN","SDWLE111",13,0)
 ;
"RTN","SDWLE111",14,0)
 ;
"RTN","SDWLE111",15,0)
 ;ASK WAIT LIST TYPE
"RTN","SDWLE111",16,0)
 ;
"RTN","SDWLE111",17,0)
EN ;
"RTN","SDWLE111",18,0)
 S SDWLFLG=0
"RTN","SDWLE111",19,0)
 I $D(SDWLTY) W !,"Wait List Type: ",$$EXTERNAL^DILFD(409.3,4,,SDWLTY) W "//  (No Editing)" S SDWLTYE=SDWLTY G EN2
"RTN","SDWLE111",20,0)
 ;10/01/2002 - TEH
"RTN","SDWLE111",21,0)
 G ENS:$D(SDWLOPT)
"RTN","SDWLE111",22,0)
 G EN0:SDWLTEM
"RTN","SDWLE111",23,0)
 S DIR(0)="SO^1:PCMM TEAM ASSIGMENT;2:PCMM POSITION ASSIGNMENT;3:SERVICE/SPECIALTY;4:SPECIFIC CLINIC"
"RTN","SDWLE111",24,0)
 I SDWLCP5'="" S DIR(0)="SO^1:PCMM TEAM ASSIGMENT;2:SERVICE/SPECIALTY;3:SPECIFIC CLINIC" D 
"RTN","SDWLE111",25,0)
 .S DIR("L",1)="      Select Wait List Type: ",DIR("L",2)="",DIR("L",3)="          1. PCMM TEAM ASSIGMENT"
"RTN","SDWLE111",26,0)
 .S DIR("L",4)="             2. SERVICE/SPECIALTY",DIR("L",5)="             3. SPECIFIC CLINIC",SDWLFLG=1
"RTN","SDWLE111",27,0)
 G EN0:SDWLFLG
"RTN","SDWLE111",28,0)
ENS I $D(SDWLOPT),SDWLOPT S DIR(0)="SO^;1:SERVICE/SPECIALTY;2:SPECIFIC CLINIC" D 
"RTN","SDWLE111",29,0)
 .S DIR("L",1)="      Select Wait List Type: ",DIR("L",2)=""
"RTN","SDWLE111",30,0)
 .S DIR("L",3)="             1. SERVICE/SPECIALTY",DIR("L")="             2. SPECIFIC CLINIC",SDWLFLG=1
"RTN","SDWLE111",31,0)
 G EN1:SDWLFLG
"RTN","SDWLE111",32,0)
EN0 I SDWLTEM,SDWLPOS D 
"RTN","SDWLE111",33,0)
 .S DIR(0)="SO^;1:SERVICE/SPECIALTY;2:SPECIFIC CLINIC" D 
"RTN","SDWLE111",34,0)
 .S DIR("L",1)="      Select Wait List Type: ",DIR("L",2)=""
"RTN","SDWLE111",35,0)
 .S DIR("L",3)="             1. SERVICE/SPECIALTY",DIR("L")="             2. SPECIFIC CLINIC",SDWLFLG=1
"RTN","SDWLE111",36,0)
 G EN1:SDWLFLG
"RTN","SDWLE111",37,0)
 I SDWLWTE D 
"RTN","SDWLE111",38,0)
 .S DIR(0)="SO^;1:SERVICE/SPECIALTY;2:SPECIFIC CLINIC" D 
"RTN","SDWLE111",39,0)
 .S DIR("L",1)="      Select Wait List Type: ",DIR("L",2)=""
"RTN","SDWLE111",40,0)
 .S DIR("L",3)="             1. SERVICE/SPECIALTY",DIR("L")="             2. SPECIFIC CLINIC",SDWLFLG=1
"RTN","SDWLE111",41,0)
 G EN1:SDWLFLG
"RTN","SDWLE111",42,0)
 I 'SDWLTEM D 
"RTN","SDWLE111",43,0)
 .S DIR(0)="SO^1:PCMM TEAM ASSIGNMENT;2:SERVICE/SPECIALTY;3:SPECIFIC CLINIC" D 
"RTN","SDWLE111",44,0)
 .S DIR("L",1)="      Select Wait List Type: ",DIR("L",2)=""
"RTN","SDWLE111",45,0)
 .S DIR("L",2)=""
"RTN","SDWLE111",46,0)
 .S DIR("L",3)="             1. PCMM TEAM ASSIGNMENT"
"RTN","SDWLE111",47,0)
 .S DIR("L",4)="             2. SERVICE/SPECIALTY"
"RTN","SDWLE111",48,0)
 .S DIR("L")="             3. SPECIFIC CLINIC",SDWLFLG=1
"RTN","SDWLE111",49,0)
 G EN1:SDWLFLG
"RTN","SDWLE111",50,0)
 I SDWLTEM D
"RTN","SDWLE111",51,0)
 .S DIR(0)="SO^1:PCMM POSITION ASSIGNMENT;2:SERVICE/SPECIALTY;3:SPECIFIC CLINIC"
"RTN","SDWLE111",52,0)
 .S DIR("L",1)="     Select Wait List Type: "
"RTN","SDWLE111",53,0)
 .S DIR("L",2)=""
"RTN","SDWLE111",54,0)
 .S DIR("L",3)="           1. PCMM POSITION ASSIGNMENT"
"RTN","SDWLE111",55,0)
 .S DIR("L",4)="           2. SERVICE/SPECIALTY"
"RTN","SDWLE111",56,0)
 .S DIR("L")="           3. SPECIFIC CLINIC",SDWLFLG=1
"RTN","SDWLE111",57,0)
 G EN1:SDWLFLG
"RTN","SDWLE111",58,0)
 S DIR("L",1)="     Select Wait List Type: "
"RTN","SDWLE111",59,0)
 S DIR("L",2)=""
"RTN","SDWLE111",60,0)
 S DIR("L",3)="           1. PCMM TEAM ASSIGMENT"
"RTN","SDWLE111",61,0)
 S DIR("L",4)="           2. PCMM POSITION ASSIGNMENT"
"RTN","SDWLE111",62,0)
 S DIR("L",5)="           3. SERVICE/SPECIALTY"
"RTN","SDWLE111",63,0)
 S DIR("L")="           4. SPECIFIC CLINIC"
"RTN","SDWLE111",64,0)
EN1 D ^DIR I X="" W " Required or '^' to Quit" G EN
"RTN","SDWLE111",65,0)
 I $D(DUOUT) S SDWLERR=1 G END
"RTN","SDWLE111",66,0)
 I 'SDWLTEM,'SDWLWTE S SDWLTYE=$S(Y=1:1,Y=2:3,Y=3:4)
"RTN","SDWLE111",67,0)
 I SDWLPOS S SDWLTYE=$S(Y=1:1,Y=2:3,Y=3:4)
"RTN","SDWLE111",68,0)
 I SDWLTEM S SDWLTYE=$S(Y=1:2,Y=2:3,Y=3:4)
"RTN","SDWLE111",69,0)
 I SDWLPOS,SDWLTEM S SDWLTYE=$S(Y=1:3,Y=2:4)
"RTN","SDWLE111",70,0)
 I SDWLWTE S SDWLTYE=$S(Y=1:3,Y=2:4)
"RTN","SDWLE111",71,0)
 I $D(SDWLOPT),SDWLOPT S SDWLTYE=$S(Y=1:3,Y=2:4)
"RTN","SDWLE111",72,0)
 S DIE="^SDWL(409.3,",DR="4///^S X=SDWLTYE" D ^DIE
"RTN","SDWLE111",73,0)
 ;
"RTN","SDWLE111",74,0)
EN2 ;ASK INSTITUTION (FILE 4)
"RTN","SDWLE111",75,0)
 ;
"RTN","SDWLE111",76,0)
 I SDWLTYE=2,$D(SDWLCPT),SDWLCPT S (SDWLINE,SDWLIN)=$P($G(^SCTM(404.51,+SDWLCPT,0)),U,7) G END
"RTN","SDWLE111",77,0)
 I SDWLTYE=2,'SDWLCP3 S SDWLI=0 F  S SDWLI=$O(^SCTM(404.57,SDWLI)) Q:SDWLI<1  D
"RTN","SDWLE111",78,0)
 .S SDWLL=+$P($G(^SCTM(404.57,SDWLI,0)),U,2),SDWLINL=+$P($G(^SCTM(404.51,+SDWLL,0)),U,7),SDWLINL(+SDWLINL)=""
"RTN","SDWLE111",79,0)
 K DUOUT S SDWLERR=0 W !
"RTN","SDWLE111",80,0)
 I $D(SDWLIN) D
"RTN","SDWLE111",81,0)
 .S X=$S($D(SDWLIN):$$EXTERNAL^DILFD(409.32,.02,,SDWLIN),1:""),DIC(0)="Q",DIC=4,SDWLINE=SDWLIN D ^DIC D
"RTN","SDWLE111",82,0)
 ..W !,"Select Institution: ",$P(Y,U,2)," //  (No Editing)" S SDWLERR=1
"RTN","SDWLE111",83,0)
 I SDWLERR S SDWLERR=0 G END
"RTN","SDWLE111",84,0)
 I SDWLTYE=1 S DIC("S")="I $D(^SCTM(404.51,""AINST"",+Y))"
"RTN","SDWLE111",85,0)
 I SDWLTYE=2 S DIC("S")="I $D(SDWLINL(+Y))"
"RTN","SDWLE111",86,0)
 I SDWLTYE=4 S DIC("S")="I $D(^SDWL(409.32,""ACT"",+Y))"
"RTN","SDWLE111",87,0)
 I SDWLTYE=3 S DIC("S")="I $D(^SDWL(409.31,""E"",+Y))"
"RTN","SDWLE111",88,0)
 S DIC(0)="AEQNM",DIC="4",DIC("A")="Select Institution: " D ^DIC I Y<0,'$D(DUOUT) S SDWLERR=1 W "Required or '^' to Quit."
"RTN","SDWLE111",89,0)
 I $D(DUOUT) S SDWLERR=1 Q
"RTN","SDWLE111",90,0)
 G EN2:SDWLERR
"RTN","SDWLE111",91,0)
 I Y>0 D 
"RTN","SDWLE111",92,0)
 .K DIC,DIC("A"),DIC("S"),DIC(0),DIC("B") S (SDWLIN,SDWLINE)=+Y,DIE="^SDWL(409.3,"
"RTN","SDWLE111",93,0)
 .I '$D(DUOUT),Y>0 S DR="2////^S X=SDWLIN",DIE="^SDWL(409.3,",DA=SDWLDA D ^DIE
"RTN","SDWLE111",94,0)
 I $D(DUOUT) S SDWLERR=1
"RTN","SDWLE111",95,0)
END Q
"RTN","SDWLE112")
0^2^B5315154
"RTN","SDWLE112",1,0)
SDWLE112 ;;IOFO BAY PINES/TEH - WAITING LIST-ENTER/EDIT;06/12/2002 ; 20 Aug 2002  2:10 PM
"RTN","SDWLE112",2,0)
 ;;5.3;scheduling;**263,273**;AUG 13 1993
"RTN","SDWLE112",3,0)
 ;
"RTN","SDWLE112",4,0)
 ;
"RTN","SDWLE112",5,0)
 ;******************************************************************
"RTN","SDWLE112",6,0)
 ;                             CHANGE LOG
"RTN","SDWLE112",7,0)
 ;                                               
"RTN","SDWLE112",8,0)
 ;   DATE                        PATCH                   DESCRIPTION
"RTN","SDWLE112",9,0)
 ;   ----                        -----                   -----------
"RTN","SDWLE112",10,0)
 ;  11/27/02                                     SD*5.3*273                              Add "/" to line EN+14 
"RTN","SDWLE112",11,0)
 ;   
"RTN","SDWLE112",12,0)
 ;   
"RTN","SDWLE112",13,0)
 ;
"RTN","SDWLE112",14,0)
EN ;
"RTN","SDWLE112",15,0)
 ;Set record status to 'OPEN'
"RTN","SDWLE112",16,0)
 ;
"RTN","SDWLE112",17,0)
 S DR="23///^S X=""O""",DIE="^SDWL(409.3," D ^DIE
"RTN","SDWLE112",18,0)
 ;
"RTN","SDWLE112",19,0)
 ;Ask comments
"RTN","SDWLE112",20,0)
 ;
"RTN","SDWLE112",21,0)
 S DIR(0)="FAOU^^",DIR("A")="Comments: " D ^DIR
"RTN","SDWLE112",22,0)
 I Y["^" S SDWLERR=2 Q
"RTN","SDWLE112",23,0)
 S DR="25////^S X=SDWLCOME " D ^DIE
"RTN","SDWLE112",24,0)
 ;
"RTN","SDWLE112",25,0)
 ;
"RTN","SDWLE112",26,0)
 ;Set Editing User
"RTN","SDWLE112",27,0)
 ;
"RTN","SDWLE112",28,0)
 S DR="28////^S X=DUZ",DIE="^SDWL(409.3," D ^DIE
"RTN","SDWLE112",29,0)
 ;
"RTN","SDWLE112",30,0)
 S SDWLERR=0 Q
"RTN","SDWLE112",31,0)
 Q
"RTN","SDWLE112",32,0)
END K SDWLCN,SDWLCN,SDWLPS,SDWLY,SDWLNEW,SDWLSSN,SDWLNAM,SDWLDATA,SDWLIN,SDWLCL,SDWLTY,SDWLST,SDWLSP,SDWLSS
"RTN","SDWLE112",33,0)
 K SDWLSC,SDWLPRI,SDWLRB,SDWLPROV,SDWLDAPT,SDWLST,SDWLCOM,SDWLDUZ,SDWLEDT,SDCL,SDWLTYE,SDWLINE,SDWLS,SDWLX,SDWLPRIE,SDWLPRVE
"RTN","SDWLE112",34,0)
 K SDWLDAPE,SDWLRBE,SDWL,VA,VADM,VAIN,D0,DA,DI,DIC,DIE,DQ,DR,SDWLCLN,SDWLCNT,SDWLDIS,SDWLDISN,SDWLDT,SDWLDTP,SDWLINN,SDWLPRIN,SDWLTYN
"RTN","SDWLE112",35,0)
 K SDWLWR,VAERR,YY,MM,DD,SDWLSCP,SDWLVAR,SDWLF,SDWLSX,SDWLCP1,SCWLCP2,SDWLCP2,SDWLCP3,SDWLCP4,SDWLCP5,SDWLCP6,E,SDWLCOME,SDWLDFN,SDWLPCMM
"RTN","SDWLE112",36,0)
 K DIR
"RTN","SDWLE112",37,0)
 I $D(SDWLDA),$D(^SDWL(409.3,SDWLDA,0)),$P(^SDWL(409.3,SDWLDA,0),U,17)'["O" D
"RTN","SDWLE112",38,0)
 .W !!,?15,"***  Patient being Removed from Wait List  ***" S DIK="^SDWL(409.3,",DA=SDWLDA D ^DIK
"RTN","SDWLE112",39,0)
 K SDWLDA
"RTN","SDWLE112",40,0)
 Q
"RTN","SDWLE113")
0^3^B6888384
"RTN","SDWLE113",1,0)
SDWLE113 ;;IOFO BAY PINES/TEH - WAITING LIST-ENTER/EDIT;06/12/2002 ; 20 Aug 2002  2:10 PM
"RTN","SDWLE113",2,0)
 ;;5.3;scheduling;**263,273**;AUG 13 1993
"RTN","SDWLE113",3,0)
 ;
"RTN","SDWLE113",4,0)
 ;
"RTN","SDWLE113",5,0)
 ;******************************************************************
"RTN","SDWLE113",6,0)
 ;                             CHANGE LOG
"RTN","SDWLE113",7,0)
 ;                                               
"RTN","SDWLE113",8,0)
 ;   DATE                        PATCH                   DESCRIPTION
"RTN","SDWLE113",9,0)
 ;   ----                        -----                   -----------
"RTN","SDWLE113",10,0)
 ; 11/27/02                                      SD*5.3*273                              Add "/" to line EN1+2  
"RTN","SDWLE113",11,0)
 ;   
"RTN","SDWLE113",12,0)
 ;   
"RTN","SDWLE113",13,0)
 ;
"RTN","SDWLE113",14,0)
EN ;Set record status to 'OPEN'
"RTN","SDWLE113",15,0)
 ;
"RTN","SDWLE113",16,0)
 S DR="23////^S X=""O""",DIE="^SDWL(409.3," D ^DIE
"RTN","SDWLE113",17,0)
 ;
"RTN","SDWLE113",18,0)
 ;Ask comments
"RTN","SDWLE113",19,0)
 ;
"RTN","SDWLE113",20,0)
 I $D(^SDWL(409.3,SDWLDA,0)) I $P(^(0),U,18)'="" S DIR("B")=$P(^(0),U,18)
"RTN","SDWLE113",21,0)
 S DIR(0)="FAOU^^",DIR("A")="Comments: " D ^DIR
"RTN","SDWLE113",22,0)
 I Y["^" S SDWLERR=2 Q
"RTN","SDWLE113",23,0)
 I X="@" S DR="25///@",DIE="^SDWL(409.3,",DA=SDWLDA D ^DIE G EN1
"RTN","SDWLE113",24,0)
 S SDWLCOM=Y
"RTN","SDWLE113",25,0)
 S DR="25////^S X=SDWLCOM",DIE="^SDWL(409.3,",DA=SDWLDA D ^DIE
"RTN","SDWLE113",26,0)
 ;
"RTN","SDWLE113",27,0)
EN1 ;Set Editing User
"RTN","SDWLE113",28,0)
 ;
"RTN","SDWLE113",29,0)
 S DR="28////^S X=DUZ",DIE="^SDWL(409.3," D ^DIE
"RTN","SDWLE113",30,0)
 ;
"RTN","SDWLE113",31,0)
 S SDWLERR=0 Q
"RTN","SDWLE113",32,0)
 Q
"RTN","SDWLE113",33,0)
 ;
"RTN","SDWLE113",34,0)
END K SDWLCN,SDWLCN,SDWLY,SDWLNEW,SDWLSSN,SDWLNAM,SDWLDATA,SDWLIN,SDWLCL,SDWLTY,SDWLST,SDWLSP,SDWLSS
"RTN","SDWLE113",35,0)
 K SDWLSC,SDWLPRI,SDWLRB,SDWLPROV,SDWLDAPT,SDWLST,SDWLCOM,SDWLDUZ,SDWLEDT,SDCL,SDWLTYE,SDWLINE,SDWLS,SDWLX,SDWLPRIE,SDWLPRVE
"RTN","SDWLE113",36,0)
 K SDWLDAPE,SDWLRBE,SDWL,VA,VADM,VAIN,D0,DA,DI,DIC,DIE,DQ,DR,SDWLCLN,SDWLCNT,SDWLDIS,SDWLDISN,SDWLDT
"RTN","SDWLE113",37,0)
 K SDWLDTP,SDWLINN,SDWLPRIN,SDWLTYN,SDWLB,SDWLCPT,SDWLFLG,SDWLPS,SDWLRNE,SDWLSCO,SDWLSCR,SDWLSPO,SDWLSCR,SDWLSPO,SDWLSSO
"RTN","SDWLE113",38,0)
 K SDWLWR,VAERR,YY,MM,DD,SDWLSCP,SDWLVAR,SDWLF,SDWLSX,SDWLCP1,SCWLCP2,SDSWLTAG,SDWLTT,SDWLVBR,SDWLYN,X,Y
"RTN","SDWLE113",39,0)
 K SDWLCP2,SDWLCP3,SDWLCP4,SDWLCP5,SDWLCP6,E,SDWLCOME,SDWLDFN,SDWLPCMM
"RTN","SDWLE113",40,0)
 K DIR,SDWLSTO,SDWLINA,SDWLPOS,SDWLTEM,SDWLOPT,DUOUT
"RTN","SDWLE113",41,0)
 I $D(SDWLDA),SDWLDA'="",$D(^SDWL(409.3,SDWLDA,0)),$P(^SDWL(409.3,SDWLDA,0),U,17)'["O" D
"RTN","SDWLE113",42,0)
 .W !!,?15,"***  Patient being Removed from Wait List  ***" S DIK="^SDWL(409.3,",DA=SDWLDA D ^DIK S DUOUT=1
"RTN","SDWLE113",43,0)
 K SDWLDA
"RTN","SDWLE113",44,0)
 Q
"RTN","SDWLPE")
0^10^B15991511
"RTN","SDWLPE",1,0)
SDWLPE ;;IOFO BAY PINES/TEH - WAIT LIST - PARAMETER WAIT LIST ENTER/EDIT;06/12/2002 ; 20 Aug 2002  2:10 PM
"RTN","SDWLPE",2,0)
 ;;5.3;scheduling;**263,273**;AUG 13 1993
"RTN","SDWLPE",3,0)
 ;
"RTN","SDWLPE",4,0)
 ;
"RTN","SDWLPE",5,0)
EN ;
"RTN","SDWLPE",6,0)
 ;OPTION HEADER
"RTN","SDWLPE",7,0)
 ;
"RTN","SDWLPE",8,0)
 D HD
"RTN","SDWLPE",9,0)
 ;
"RTN","SDWLPE",10,0)
 ;SELECT FILE TO EDIT
"RTN","SDWLPE",11,0)
 ;
"RTN","SDWLPE",12,0)
EN1 D SEL G END:X["^",END:X=""
"RTN","SDWLPE",13,0)
 ;
"RTN","SDWLPE",14,0)
 ;EDIT PARAMETER FILE
"RTN","SDWLPE",15,0)
 ;
"RTN","SDWLPE",16,0)
 D EDIT G EN:'$D(Y)
"RTN","SDWLPE",17,0)
 G END
"RTN","SDWLPE",18,0)
 Q
"RTN","SDWLPE",19,0)
 ;
"RTN","SDWLPE",20,0)
SEL ;SELECT PARAMETER FILE
"RTN","SDWLPE",21,0)
 S DIR(0)="SO^1:Wait List Service/Specialty File;2:Wait List Clinic Location"
"RTN","SDWLPE",22,0)
 S DIR("L",1)="Select one of the following:"
"RTN","SDWLPE",23,0)
 S DIR("L",2)=""
"RTN","SDWLPE",24,0)
 S DIR("L",3)="    1. Wait List Service/Specialty (409.31)"
"RTN","SDWLPE",25,0)
 S DIR("L")="    2. Wait List Clinic Location (409.32)"
"RTN","SDWLPE",26,0)
 D ^DIR S SDWLF=X
"RTN","SDWLPE",27,0)
 K DIR,DILN,DINDEX
"RTN","SDWLPE",28,0)
 Q
"RTN","SDWLPE",29,0)
EDIT ;EDIT FILE PARAMETERS
"RTN","SDWLPE",30,0)
 I SDWLF=1 D SB1 Q:$D(DUOUT)
"RTN","SDWLPE",31,0)
 I SDWLF=2 D SB2 Q:$D(DUOUT)
"RTN","SDWLPE",32,0)
 Q
"RTN","SDWLPE",33,0)
SB1 S DIC(0)="AEQMZ",DIC("A")="Select DSS ID: ",DIC="^DIC(40.7,",DIC("S")="I '$P(^DIC(40.7,+Y,0),U,3)"
"RTN","SDWLPE",34,0)
 D ^DIC
"RTN","SDWLPE",35,0)
 I X["^" I $D(DA),'$D(^SDWL(409.31,DA,"I")) S DIK="^SDWL(409.31," D ^DIK S DUOUT=1 Q
"RTN","SDWLPE",36,0)
 Q:Y<0  Q:$D(DUOUT)  S SDWLDSS=+Y
"RTN","SDWLPE",37,0)
 I '$D(^SDWL(409.31,"B",SDWLDSS)) D
"RTN","SDWLPE",38,0)
 .S DIC(0)="LX",X=SDWLDSS,DIC="^SDWL(409.31," K DO D FILE^DICN
"RTN","SDWLPE",39,0)
 S DA=$O(^SDWL(409.31,"B",SDWLDSS,""))
"RTN","SDWLPE",40,0)
 S DIR(0)="PAO^4:EMZ" D ^DIR
"RTN","SDWLPE",41,0)
 I X["^" S DIK="^SDWL(409.31," D ^DIK S DUOUT=1 Q
"RTN","SDWLPE",42,0)
 I X="" D  W *7," Required" G SB1
"RTN","SDWLPE",43,0)
 .I '$D(^SDWL(409.31,DA,"I")) S DIK="^SDWL(409.31," D ^DIK
"RTN","SDWLPE",44,0)
 I '$D(^SDWL(409.31,DA,"I","B",+Y)) D
"RTN","SDWLPE",45,0)
 .S DA(1)=DA,DIC="^SDWL(409.31,"_DA(1)_","_"""I"""_",",DIC("P")=409.311,X=+Y K D0 D FILE^DICN I +Y S DA=+Y
"RTN","SDWLPE",46,0)
 I $D(^SDWL(409.31,DA,"I","B",+Y)) S DA(1)=DA,DA=$O(^(+Y,0))
"RTN","SDWLPE",47,0)
 K DIC,DIE,DIR,DR
"RTN","SDWLPE",48,0)
 W ! S DR="1;3",DIE="^SDWL(409.31,"_DA(1)_","_"""I"""_"," D ^DIE
"RTN","SDWLPE",49,0)
 I $P(^SDWL(409.31,DA(1),"I",DA,0),U,2)="" D
"RTN","SDWLPE",50,0)
 .W *7," This ENTRY requires an ACTIVATION DATE. ENTRY deleted."
"RTN","SDWLPE",51,0)
 .S DIK="^SDWL(409.31,"_DA(1)_","_"""I"""_"," D ^DIK I '$P(^SDWL(409.31,DA(1),"I",0),U,3) D
"RTN","SDWLPE",52,0)
 ..S DIK="^SDWL(409.31,",DA=DA(1) D ^DIK
"RTN","SDWLPE",53,0)
 K DA,DA(1),SDWLDSS,DIC,DR,DIE,DI,DIEDA,DIG,DIH,DIIENS,DIR,DIU,DIV
"RTN","SDWLPE",54,0)
 Q
"RTN","SDWLPE",55,0)
SB2 S SDWLSTOP=0
"RTN","SDWLPE",56,0)
 W ! S DIC(0)="AEQMNZ",DIC("A")="Select Clinic: ",DIC=44
"RTN","SDWLPE",57,0)
 S DIC("S")="S SDWLX=$G(^SC(+Y,0)),SDWLY=$G(^(""I"")) I $P(SDWLX,U,3)=""C"",$P(SDWLY,U,1)'>$P(SDWLY,U,2) I $P(^SC(+Y,0),U,4)"
"RTN","SDWLPE",58,0)
 S DIC("W")="I $P(^SC(+Y,0),U,4) W ?50,""- "",$E($P(^DIC(4,$P(^SC(+Y,0),U,4),0),U,1),1,25)"
"RTN","SDWLPE",59,0)
 D ^DIC Q:Y<1  Q:$D(DUOUT)  S SDWLSC=+Y
"RTN","SDWLPE",60,0)
 I '$D(^SDWL(409.32,"B",SDWLSC)) D
"RTN","SDWLPE",61,0)
 .S DIC(0)="LX",X=SDWLSC,DIC="^SDWL(409.32," D FILE^DICN
"RTN","SDWLPE",62,0)
 S DA=$O(^SDWL(409.32,"B",SDWLSC,""))
"RTN","SDWLPE",63,0)
 K DIC,DIC(0)
"RTN","SDWLPE",64,0)
 S SDWLSCN=$P($G(^SDWL(409.32,DA,0)),U,1) D
"RTN","SDWLPE",65,0)
 .I $D(^SDWL(409.3,"C",SDWLSCN)) D
"RTN","SDWLPE",66,0)
 ..S SDWLN="",SDWLCNT=0 F  S SDWLN=$O(^SDWL(409.3,"C",SDWLSCN,SDWLN)) Q:SDWLN=""  D
"RTN","SDWLPE",67,0)
 ...S X=$G(^SDWL(409.3,SDWLN,0)) I '$D(^SDWL(409.3,SDWLN,"DIS")) S SDWLCNT=SDWLCNT+1,^TMP("SDWLPE",$J,"DIS",SDWLN,SDWLCNT)=X,SDWLSTOP=1
"RTN","SDWLPE",68,0)
 W ! I SDWLSTOP W "This Clinic has Patients on the Wait List and can not be inactivated." Q
"RTN","SDWLPE",69,0)
 S DR="1",DIE="^SDWL(409.32," D ^DIE I X S DR="2////^S X=DUZ" D ^DIE
"RTN","SDWLPE",70,0)
 S DR="3",DIE="^SDWL(409.32," D ^DIE I X S DR="4////^S X=DUZ" D ^DIE
"RTN","SDWLPE",71,0)
 K DR,DIE,DIC,Y,X,SDWLY,DIC(0),DO,DA,DI,DIW,SDWLX,SDWLSCN,SDWLF
"RTN","SDWLPE",72,0)
 Q
"RTN","SDWLPE",73,0)
SWT ;SWITCH FOR INACTIVIATION OF PARAMETER FILE
"RTN","SDWLPE",74,0)
 Q
"RTN","SDWLPE",75,0)
HD ;HEADER
"RTN","SDWLPE",76,0)
 W:$D(IOF) @IOF W !!,?80-$L("Wait List Parameter Enter/Edit")\2,"Wait List Parameter Enter/Edit",!
"RTN","SDWLPE",77,0)
 W !,?80-$L("------------------------------")\2,"------------------------------",!
"RTN","SDWLPE",78,0)
END K SDWLSTOP,DIR,DIC,DR,DIK,SDWLX,SDWLSCN,SDWLF,SDWLY,SDWLSC,SDWLN,SDWLCNT,SDWLDSS,DUOUT,X,Y
"RTN","SDWLPE",79,0)
 Q
"RTN","SDWLRP1")
0^9^B52288379
"RTN","SDWLRP1",1,0)
SDWLRP1 ;;IOFO BAY PINES/TEH - WAITING LIST - RPC;06/28/2002 ; 26 Aug 2002  1:25 PM
"RTN","SDWLRP1",2,0)
 ;;5.3;scheduling;**263,273**;AUG 13 1993
"RTN","SDWLRP1",3,0)
 ;
"RTN","SDWLRP1",4,0)
 ;
"RTN","SDWLRP1",5,0)
 ;******************************************************************
"RTN","SDWLRP1",6,0)
 ;                             CHANGE LOG
"RTN","SDWLRP1",7,0)
 ;                                               
"RTN","SDWLRP1",8,0)
 ;   DATE                        PATCH                   DESCRIPTION
"RTN","SDWLRP1",9,0)
 ;   ----                        -----                   -----------
"RTN","SDWLRP1",10,0)
 ;       2/21/03                                   SD*5.3*273                    Line new+12 added "/"
"RTN","SDWLRP1",11,0)
OUTPUT(SDWLOUT,SDWLDFN) ;-FULL
"RTN","SDWLRP1",12,0)
 ; input:
"RTN","SDWLRP1",13,0)
 ;   DFN = Patient
"RTN","SDWLRP1",14,0)
 ;     Lookup uses Wait List data file (409.3) and returns the following data.
"RTN","SDWLRP1",15,0)
 ;     
"RTN","SDWLRP1",16,0)
 ; output:
"RTN","SDWLRP1",17,0)
 ;   SCOUT = location of data = ^TMP("SDWLG",$J,i,0)
"RTN","SDWLRP1",18,0)
 ;   for i=1:number of records returned: 
"RTN","SDWLRP1",19,0)
 ;
"RTN","SDWLRP1",20,0)
 ;         Field  Location               Description
"RTN","SDWLRP1",21,0)
 ;
"RTN","SDWLRP1",22,0)
 ;               1               2                       ORIGINATION DATE
"RTN","SDWLRP1",23,0)
 ;               2               3                       INSTITUTION
"RTN","SDWLRP1",24,0)
 ;               3               4                       CLINIC
"RTN","SDWLRP1",25,0)
 ;               4               5                       WAIT LIST TYPE
"RTN","SDWLRP1",26,0)
 ;               5               6                       SPECIFIC TEAM
"RTN","SDWLRP1",27,0)
 ;               5.1             22                      MARKED OPEN (SPECIFIC TEAM)
"RTN","SDWLRP1",28,0)
 ;               6               7                       SPECIFIC POSITION
"RTN","SDWLRP1",29,0)
 ;               6.1             23                      MARKED OPEN (SPEICIFIC POSITION)
"RTN","SDWLRP1",30,0)
 ;               7               8                       SERVICE /SPECIALTY
"RTN","SDWLRP1",31,0)
 ;               8               9                       SPECIFIC CLINIC
"RTN","SDWLRP1",32,0)
 ;               9               10                      ORIGINATING USER
"RTN","SDWLRP1",33,0)
 ;               10              11                      PRIORITY
"RTN","SDWLRP1",34,0)
 ;               11              12                      REQUESTED BY
"RTN","SDWLRP1",35,0)
 ;               12              13                      PROVIDER
"RTN","SDWLRP1",36,0)
 ;               22              16                      DESIRED DATE OF APPT
"RTN","SDWLRP1",37,0)
 ;               23              17                      CURRENT STATUS
"RTN","SDWLRP1",38,0)
 ;               25              18                      COMMENTS
"RTN","SDWLRP1",39,0)
 ;               27              20                      NEW ENROLLE
"RTN","SDWLRP1",40,0)
 ;
"RTN","SDWLRP1",41,0)
 ;
"RTN","SDWLRP1",42,0)
 N DIERR
"RTN","SDWLRP1",43,0)
 I '$D(^SDWL(409.3,"B",SDWLDFN)) S SDWLRES=-1 Q  ;- No Entry in Wait List file.
"RTN","SDWLRP1",44,0)
 S SDWLDA="" F  S SDWLDA=$O(^SDWL(409.3,"B",SDWLDFN,SDWLDA)) Q:SDWLDA<1  D
"RTN","SDWLRP1",45,0)
 .S SDWLDAX="`"_SDWLDA
"RTN","SDWLRP1",46,0)
 .D FIND^DIC(409.3,,".01;1;2;3;4;5;5.1;6;6.1;7;8;9;10;11;12;15;22;23;25","PS",.SDWLDAX)
"RTN","SDWLRP1",47,0)
 I $G(DIERR) D CLEAN^DILF S SDWLRES=-1 Q
"RTN","SDWLRP1",48,0)
 K SDWLOUT S SDWLOUT=$NA(^TMP("DILIST",$J))
"RTN","SDWLRP1",49,0)
 Q
"RTN","SDWLRP1",50,0)
OUTPUT1(SDWLOUT,SDWLDFN) ;
"RTN","SDWLRP1",51,0)
 ;Brief Output - for Wait List.
"RTN","SDWLRP1",52,0)
 ; input:
"RTN","SDWLRP1",53,0)
 ;   DFN = Patient
"RTN","SDWLRP1",54,0)
 ;     Lookup uses Wait List data file (409.3) and returns the following data.
"RTN","SDWLRP1",55,0)
 ;     
"RTN","SDWLRP1",56,0)
 ; output:
"RTN","SDWLRP1",57,0)
 ;   SWDLRES = On/Not on Wait list^Number of IENs^IEN;IEN;IEN;IEN.....
"RTN","SDWLRP1",58,0)
 ;            1     0            ^      2       ^1;2
"RTN","SDWLRP1",59,0)
 ;     
"RTN","SDWLRP1",60,0)
 ;
"RTN","SDWLRP1",61,0)
 S SDWLCNT=0,SDWLIEN=""
"RTN","SDWLRP1",62,0)
 I '$D(^SDWL(409.3,"B",SDWLDFN)) S SDWLRES=$NA(^TMP("SDWLRP1",$J)),^TMP("SDWLRP1",$J,1)=-1
"RTN","SDWLRP1",63,0)
 S SDWLDA=""  F  S SDWLDA=$O(^SDWL(409.3,"B",SDWLDFN,SDWLDA)) Q:SDWLDA<1  D
"RTN","SDWLRP1",64,0)
 .I $P(^SDWL(409.3,SDWLDA,0),U,17)["C" Q
"RTN","SDWLRP1",65,0)
 .S SDWLCNT=SDWLCNT+1
"RTN","SDWLRP1",66,0)
 .S ^TMP("SDWLRP1",$J,SDWLCNT)=SDWLDA_"^"_$G(^SDWL(409.3,SDWLDA,0))
"RTN","SDWLRP1",67,0)
 S SDWLOUT=$NA(^TMP("SDWLRP1",$J))
"RTN","SDWLRP1",68,0)
 K SDWLDFN,SDWLDA,SDWLCNT,SDWLIEN
"RTN","SDWLRP1",69,0)
 Q
"RTN","SDWLRP1",70,0)
OUTPUT3(SDWLOUT,SDWLDFN) ;Disposition Data
"RTN","SDWLRP1",71,0)
 ; 
"RTN","SDWLRP1",72,0)
 ;  input:
"RTN","SDWLRP1",73,0)
 ;    DFN = Patient Internal ID
"RTN","SDWLRP1",74,0)
 ;    
"RTN","SDWLRP1",75,0)
 ;  output: Subscript 'DIS'
"RTN","SDWLRP1",76,0)
 ;    Date Dsipositioned^Disposition by^Disposition  
"RTN","SDWLRP1",77,0)
 ;
"RTN","SDWLRP1",78,0)
 N SDWLRES,SDWLDFN,SDWLDA,DIERR
"RTN","SDWLRP1",79,0)
 I '$D(^SDWL(409.3,"B",SDWLDFN)) S SDWLRES=-1 Q  ;- No Entry in Wait List file.
"RTN","SDWLRP1",80,0)
 S SDWLDA="" F  S SDWLDA=$O(^SDWL(409.3,"B",SDWLDFN,SDWLDA)) Q:SDWLDA<1  D
"RTN","SDWLRP1",81,0)
 .S SDWLDAX="`"_SDWLDA
"RTN","SDWLRP1",82,0)
 .D FIND^DIC(409.3,,"19;20;21","PS",.SDWLDAX)
"RTN","SDWLRP1",83,0)
 I $G(DIERR) D CLEAN^DILF S SDWLRES=-1 Q
"RTN","SDWLRP1",84,0)
 K SDWLOUT S SDWLOUT="^TMP(""DILIST"","_$J_")",SDWLRES=1
"RTN","SDWLRP1",85,0)
 Q
"RTN","SDWLRP1",86,0)
INPUT(SDWLRES,SDWLSTR) ;
"RTN","SDWLRP1",87,0)
 ;
"RTN","SDWLRP1",88,0)
 ;     
"RTN","SDWLRP1",89,0)
 ; Input:
"RTN","SDWLRP1",90,0)
 ;   SDWLSTR = location of data = ^TMP("SDWLG",$J,i,0)
"RTN","SDWLRP1",91,0)
 ;   (R) = Required Field
"RTN","SDWLRP1",92,0)
 ;   (O) = Optional
"RTN","SDWLRP1",93,0)
 ;   
"RTN","SDWLRP1",94,0)
 ;    .01    2           3                     5                  6                    
"RTN","SDWLRP1",95,0)
 ;  DFN (R)^TYPE (R)^SPECIFIC TEAM (O)^SPECIFIC POSITION (O)^ORGINATING USER (R)
"RTN","SDWLRP1",96,0)
 ;     1     2           3                     4                  5
"RTN","SDWLRP1",97,0)
 ;
"RTN","SDWLRP1",98,0)
 ;  Output:
"RTN","SDWLRP1",99,0)
 ;               SDWLRES  =  0      Failed
"RTN","SDWLRP1",100,0)
 ;               SDWLRES  =  1^IEN  Saved to ^SDWL(409.3,IEN,0)            
"RTN","SDWLRP1",101,0)
 ;
"RTN","SDWLRP1",102,0)
 ;
"RTN","SDWLRP1",103,0)
 N DIERR,%H
"RTN","SDWLRP1",104,0)
 K ^TMP("SDWLIN",$J),^TMP("SDWLOUT",$J),^TMP("DIERR",$J)
"RTN","SDWLRP1",105,0)
 I '$G(SDWLSTR) S SDWLRES="-1^Data String Missing" Q
"RTN","SDWLRP1",106,0)
 D NEW
"RTN","SDWLRP1",107,0)
 D FDA I SDWLRES<0 D DEL Q
"RTN","SDWLRP1",108,0)
 ;D VAL I SDWLRES<0 D DEL Q
"RTN","SDWLRP1",109,0)
 D SET I SDWLRES<0 D DEL Q
"RTN","SDWLRP1",110,0)
 D CLEAN^DILF K ^TMP("SDWLIN",$J),^TMP("SDWLOUT",$J)
"RTN","SDWLRP1",111,0)
 Q
"RTN","SDWLRP1",112,0)
NEW ;Get IEN from ^SDWL(409.3,IEN,0).
"RTN","SDWLRP1",113,0)
 ;
"RTN","SDWLRP1",114,0)
 I $P(SDWLSTR,U,4) D
"RTN","SDWLRP1",115,0)
 .S SDWLTP=+$P(SDWLSTR,U,4)
"RTN","SDWLRP1",116,0)
 .S SDWLIN=$P($G(^SCTM(404.51,+$P(^SCTM(404.57,SDWLTP,0),U,2),0)),U,7)
"RTN","SDWLRP1",117,0)
 I $P(SDWLSTR,U,3) D
"RTN","SDWLRP1",118,0)
 .S SDWLIN=$P($G(^SCTM(404.51,+$P(SDWLSTR,U,3),0)),U,7)
"RTN","SDWLRP1",119,0)
 S SDWLDFN=+$P(SDWLSTR,U,1)
"RTN","SDWLRP1",120,0)
 S DIC(0)="LX",X=$P(SDWLSTR,U,1),DIC="^SDWL(409.3," D FILE^DICN I Y<0 S SDWLRES="-1^IEN failed" Q
"RTN","SDWLRP1",121,0)
 S SDWLDFN=$P(Y,U,2),SDWLDA=+Y,SDWLDUZ=$P(SDWLSTR,U,9)
"RTN","SDWLRP1",122,0)
 S DIE="^SDWL(409.3,",DA=SDWLDA
"RTN","SDWLRP1",123,0)
 S DR="1///^S X=DT" D ^DIE
"RTN","SDWLRP1",124,0)
 S DR="2////^S X=SDWLIN" D ^DIE
"RTN","SDWLRP1",125,0)
 S DR="23///^S X=""O""",DIE="^SDWL(409.3," D ^DIE
"RTN","SDWLRP1",126,0)
 ;
"RTN","SDWLRP1",127,0)
 ;DETERMINE ENROLLEE STATUS
"RTN","SDWLRP1",128,0)
 ;
"RTN","SDWLRP1",129,0)
 ;SDWLE=1 = NEW ENROLLEE
"RTN","SDWLRP1",130,0)
 ;SDWLE=2 = ESTABLISHED
"RTN","SDWLRP1",131,0)
 ;SDWLE=3 = PRIOR ENROLLEE
"RTN","SDWLRP1",132,0)
 ;SDWLE=4 = UNDETERMINED
"RTN","SDWLRP1",133,0)
 ;
"RTN","SDWLRP1",134,0)
 S SDWLDE=+$H,SDWLE=1,SDWLEE=0 D SB1
"RTN","SDWLRP1",135,0)
 G SB0:SDWLE=2
"RTN","SDWLRP1",136,0)
 S SDWLRNE=$$ENROLL^EASWTAPI(SDWLDFN) S SDWLRNED=$P(SDWLRNE,U,3)
"RTN","SDWLRP1",137,0)
 I SDWLRNED S X=SDWLRNED D H^%DTC S SDWLDS=%H S SDWLDE=+$H,SDWLDET=SDWLDE-SDWLDS I SDWLDET<366 S SDWLE=1
"RTN","SDWLRP1",138,0)
 I $D(SDWLDET),SDWLDET>365 S SDWLE=3
"RTN","SDWLRP1",139,0)
 I 'SDWLRNE S SDWLE=4
"RTN","SDWLRP1",140,0)
SB0 S SDWLRNE=$S(SDWLE=1:"N",SDWLE=2:"E",SDWLE=3:"P",SDWLE=4:"U")
"RTN","SDWLRP1",141,0)
 ;-Code here for filling in 409.3
"RTN","SDWLRP1",142,0)
 S DR="27////^S X=SDWLRNE",DIE="^SDWL(409.3,",DA=SDWLDA D ^DIE
"RTN","SDWLRP1",143,0)
 S DR="9////^S X=DUZ" D ^DIE
"RTN","SDWLRP1",144,0)
 Q
"RTN","SDWLRP1",145,0)
SB1 I '$D(^DGCN(391.91,"B",SDWLDFN)) S SDWLE=3 Q
"RTN","SDWLRP1",146,0)
 S SDWLX="" F  S SDWLX=$O(^DGCN(391.91,"B",SDWLDFN,SDWLX)) Q:SDWLX=""  D
"RTN","SDWLRP1",147,0)
 .S SDWLY=$G(^DGCN(391.91,SDWLX,0)),SDWLD=$P(^(0),U,3) I SDWLD S X=SDWLD D H^%DTC S SDWLEE=SDWLDE-%H I SDWLEE<730 S SDWLE=2
"RTN","SDWLRP1",148,0)
 .I $D(SDWLEE),SDWLEE>730 S SDWLE=3
"RTN","SDWLRP1",149,0)
 Q
"RTN","SDWLRP1",150,0)
FDA ;Get data from SDWLSTR string and set FDA.
"RTN","SDWLRP1",151,0)
 S SDWLF=409.3
"RTN","SDWLRP1",152,0)
 S SDWLVAL="" F SDWLI=2:1:7 S SDWLVAL=$P(SDWLSTR,"^",SDWLI) D
"RTN","SDWLRP1",153,0)
 .S SDWLFLD=SDWLI D
"RTN","SDWLRP1",154,0)
 ..S SDWLFLD=$S(SDWLFLD=2:4,SDWLFLD=3:5,SDWLFLD=4:6,SDWLFLD=5:9,SDWLFLD=7:15,1:25)
"RTN","SDWLRP1",155,0)
 .S SDWLFLG="F",SDWLIEN=$$IENS^DILF(SDWLDA) ;,SDWLVAL=$$EXTERNAL^DILFD(SDWLF,SDWLFLD,,SDWLVAL,"SDWLMSG")
"RTN","SDWLRP1",156,0)
 .I $D(SDWLMSG) M SDWLRES=SDWLMSG S SDWLRES=-1 Q
"RTN","SDWLRP1",157,0)
 .D FDA^DILF(SDWLF,SDWLIEN,SDWLFLD,"",SDWLVAL,"^TMP(""SDWLIN"",$J)")
"RTN","SDWLRP1",158,0)
 .S SDWLRES=1 M SDWLRES("SDWLIN")=^TMP("SDWLIN",$J)
"RTN","SDWLRP1",159,0)
 Q
"RTN","SDWLRP1",160,0)
VAL ;Validate fields
"RTN","SDWLRP1",161,0)
 ;
"RTN","SDWLRP1",162,0)
 N DIERR
"RTN","SDWLRP1",163,0)
 D VALS^DIE(,"^TMP(""SDWLIN"",$J)","^TMP(""SDWLOUT"",$J)","SDWLMSG")
"RTN","SDWLRP1",164,0)
 I $G(SDWLMSG("DIERR")) S SDWLRES=-1 Q
"RTN","SDWLRP1",165,0)
 M SDWLRES("SDWLOUT")=^TMP("SDWLOUT",$J)
"RTN","SDWLRP1",166,0)
 Q
"RTN","SDWLRP1",167,0)
 ;
"RTN","SDWLRP1",168,0)
SET ;Input data to file ^SDWL(409.3,IEN,0).
"RTN","SDWLRP1",169,0)
 D UPDATE^DIE(,"^TMP(""SDWLIN"",$J)","SDWLMSG")
"RTN","SDWLRP1",170,0)
 I $G(SDWLMSG("DIERR")) S SDWLRES=-1 Q
"RTN","SDWLRP1",171,0)
 S SDWLRES=1_"^"_$G(SDWLDA)
"RTN","SDWLRP1",172,0)
 Q
"RTN","SDWLRP1",173,0)
DEL S DA=SDWLDA,DIK="^SDWL(409.3," D ^DIK
"RTN","SDWLRP1",174,0)
 S SDWLRES="-1^Entry "_SDWLDA_" Deleted"
"RTN","SDWLRP1",175,0)
 Q
"RTN","SDWLRP1",176,0)
INPUTDP(SDWLRES,SDWLSTR) ;Set disposition in Wait List Patient file
"RTN","SDWLRP1",177,0)
 ;
"RTN","SDWLRP1",178,0)
 ;
"RTN","SDWLRP1",179,0)
 ;
"RTN","SDWLRP1",180,0)
 ;       Input:
"RTN","SDWLRP1",181,0)
 ;       
"RTN","SDWLRP1",182,0)
 ;               SDWLSTR=Patient DFN^Disposition^User DUZ^Wait List IEN
"RTN","SDWLRP1",183,0)
 ;               
"RTN","SDWLRP1",184,0)
 ;       Ouput:
"RTN","SDWLRP1",185,0)
 ;       
"RTN","SDWLRP1",186,0)
 ;           SDWLRES=-1 Failed
"RTN","SDWLRP1",187,0)
 ;           SDWKRES=1^IEN for Wait List File (409.3)
"RTN","SDWLRP1",188,0)
 ;
"RTN","SDWLRP1",189,0)
 N SDWLDFN,SDWLDISP,SDWLDUZ,SDWLDA,SDWLDDT
"RTN","SDWLRP1",190,0)
 I '$G(SDWLSTR) S SDWLRES="-1^Data String Missing" Q
"RTN","SDWLRP1",191,0)
 I '$G(^SDWL(409.3,SDWLDA,0)) S SDWLRES="-1^Missing Patient IEN" Q
"RTN","SDWLRP1",192,0)
 I '$D(^SDWL(409.3,"B",SDWLDFN)) S SDWLRES="-1^Missing Wait List data file" Q
"RTN","SDWLRP1",193,0)
 D FDA1 I SDWLRES<0 D DEL1 Q
"RTN","SDWLRP1",194,0)
 D VAL1 I SDWLRES<0 D DEL1 Q
"RTN","SDWLRP1",195,0)
 D SET1 I SDWLRES<0 D DEL1 Q
"RTN","SDWLRP1",196,0)
 D CLEAN^DILF K ^TMP("SDWLIN",$J),^TMP("SDWLOUT",$J)
"RTN","SDWLRP1",197,0)
 Q
"RTN","SDWLRP1",198,0)
FDA1 ;
"RTN","SDWLRP1",199,0)
 S SDWLDFN=$P(SDWLSTR,U,1),SDWLDISP=$P(SDWLSTR,U,2),SDWLDUZ=$P(SDWLSTR,U,3),SDWLDA=$P(SDWLSTR,U,4),SDWLDDT=DT
"RTN","SDWLRP1",200,0)
 S SDWLIEN=$$IENS^DILF(SDWLDA)
"RTN","SDWLRP1",201,0)
 F SDWLI=1:1:4 S SDWLVAL=$S(SDWLI=1:SDWLDISP,SDWLI=2:SDWLDUZ,SDWLI=3:SDWLDDT,SDWLI=4:"C"),SDWLFLD=$S(SDWLI=1:21,SDWLI=2:20,SDWLI=3:19,SDWLI=4:23) D
"RTN","SDWLRP1",202,0)
 .S SDWLVAL=$$EXTERNAL^DILFD(SDWLF,SDWLFLD,,SDWLVAL,"SDWLMSG")
"RTN","SDWLRP1",203,0)
 .I $D(SDWLMSG) M SDWLRES=SDWLMSG S SDWLRES=-1 Q
"RTN","SDWLRP1",204,0)
 .D FDA^DILF(SDWLF,SDWLIEN,SDWLFLD,"",SDWLVAL,"^TMP(""SDWLIN"",$J)")
"RTN","SDWLRP1",205,0)
 .S SDWLRES=1 M SDWLRES("SDWLIN")=^TMP("SDWLIN",$J)
"RTN","SDWLRP1",206,0)
 Q
"RTN","SDWLRP1",207,0)
VAL1 ;
"RTN","SDWLRP1",208,0)
 N DIERR
"RTN","SDWLRP1",209,0)
 D VALS^DIE(,"^TMP(""SDWLIN"",$J)","^TMP(""SDWLOUT"",$J)","SDWLMSG")
"RTN","SDWLRP1",210,0)
 I $G(SDWLMSG("DIERR")) S SDWLRES=-1 Q
"RTN","SDWLRP1",211,0)
 M SDWLRES("SDWLOUT")=^TMP("SDWLOUT",$J)
"RTN","SDWLRP1",212,0)
 Q
"RTN","SDWLRP1",213,0)
SET1 ;
"RTN","SDWLRP1",214,0)
 D UPDATE^DIE(,"^TMP(""SDWLOUT"",$J)","SDWLMSG")
"RTN","SDWLRP1",215,0)
 I $G(SDWLMSG("DIERR")) S SDWLRES=-1 Q
"RTN","SDWLRP1",216,0)
 S SDWLRES=1
"RTN","SDWLRP1",217,0)
 Q
"RTN","SDWLRP1",218,0)
DEL1 ;
"RTN","SDWLRP1",219,0)
 S DA(1)=SDWLDA,DIK="^SDWL("_DA(1)_",""DIS""," F DA=19,20,21,23 D ^DIK
"RTN","SDWLRP1",220,0)
 S SDWLRES="-1^"_"Disposition Nodes Deleted."
"RTN","SDWLRP1",221,0)
 Q
"RTN","SDWLRSR")
0^8^B79296638
"RTN","SDWLRSR",1,0)
SDWLRSR ;;IOFO BAY PINES/TEH/WAIT LIST STAT REPORT ; 01 Oct 2002  4:42 PM
"RTN","SDWLRSR",2,0)
 ;;5.3;scheduling;**263,273**;AUG 13 1993
"RTN","SDWLRSR",3,0)
 ;
"RTN","SDWLRSR",4,0)
 ;
"RTN","SDWLRSR",5,0)
 ;
"RTN","SDWLRSR",6,0)
 ;
"RTN","SDWLRSR",7,0)
EN ;
"RTN","SDWLRSR",8,0)
 ;
"RTN","SDWLRSR",9,0)
 D INIT
"RTN","SDWLRSR",10,0)
 I $$S^ZTLOAD Q
"RTN","SDWLRSR",11,0)
 D SORT
"RTN","SDWLRSR",12,0)
 I $$S^ZTLOAD Q
"RTN","SDWLRSR",13,0)
 D PRT
"RTN","SDWLRSR",14,0)
 I $$S^ZTLOAD Q
"RTN","SDWLRSR",15,0)
 G END
"RTN","SDWLRSR",16,0)
INIT ;
"RTN","SDWLRSR",17,0)
 I $D(CT) S SDWLCT2=CT
"RTN","SDWLRSR",18,0)
 I $D(DATE) S SDWLDATE=DATE
"RTN","SDWLRSR",19,0)
 I $D(INS) S SDWLINS=INS
"RTN","SDWLRSR",20,0)
 I $D(ZTSAVE) D
"RTN","SDWLRSR",21,0)
 .S SDWLCT=$G(ZTSAVE("CT")),SDWLDATE=$G(ZTSAVE("DATE")),SDWLINS=$G(ZTSAVE("INS"))
"RTN","SDWLRSR",22,0)
 I SDWLINS'="ALL" F I=1:1 S SDWL=$P(SDWLINS,";",I) Q:SDWL=""  S SDWL("INS",+SDWL)=""
"RTN","SDWLRSR",23,0)
 S SDWLBD=$P(SDWLDATE,U,1),SDWLED=$P(SDWLDATE,U,2),SDWLPG=0
"RTN","SDWLRSR",24,0)
 D NOW^%DTC S Y=% D DD^%DT S SDWLDTP=Y
"RTN","SDWLRSR",25,0)
 Q
"RTN","SDWLRSR",26,0)
SORT ;SORT AND CALCULATE STAT REPORT
"RTN","SDWLRSR",27,0)
 K ^TMP("SDWLRSR1",$J),^TMP("SDWLRSR2",$J) S (SDWLERR,SDWLPR,SDWLC,SDWLD,SDWLNC,SDWLSA,SDWLCC,SDWLNN,SDWLER,SDWLAD,SDWLRE,SDWLNR)=0
"RTN","SDWLRSR",28,0)
 S SDWLDA=0 F  S SDWLDA=$O(^SDWL(409.3,SDWLDA)) Q:SDWLDA=""  D
"RTN","SDWLRSR",29,0)
 .I $D(DUOUT) Q
"RTN","SDWLRSR",30,0)
 .S SDWLX=$G(^SDWL(409.3,SDWLDA,0)) Q:SDWLX=""  S SDWLINSN=+$P(SDWLX,U,3) I 'SDWLINSN Q
"RTN","SDWLRSR",31,0)
 .S SDWLPRI=$P(SDWLX,U,11) I SDWLPRI="" S SDWLPRI="U"
"RTN","SDWLRSR",32,0)
 .S SDWLDFN=+SDWLX I 'SDWLDFN Q
"RTN","SDWLRSR",33,0)
 .S SDWLTYP=$P(SDWLX,U,5),SDWLTYPN=$S(SDWLTYP=1:$P(SDWLX,U,6),SDWLTYP=2:$P(SDWLX,U,7),SDWLTYP=3:$P(SDWLX,U,8),SDWLTYP=4:$P(SDWLX,U,9))
"RTN","SDWLRSR",34,0)
 .I SDWLTYPN="" Q
"RTN","SDWLRSR",35,0)
 .S SDWLFLD=$S(SDWLTYP=1:5,SDWLTYP=2:6,SDWLTYP=3:7,SDWLTYP=4:8)
"RTN","SDWLRSR",36,0)
 .S SDWLTYNM=$$EXTERNAL^DILFD(409.3,SDWLFLD,,SDWLTYPN) I SDWLTYNM="" S SDWLTYNM="UNKNOWN"
"RTN","SDWLRSR",37,0)
 .I 'SDWLINSN Q
"RTN","SDWLRSR",38,0)
 .I $D(SDWL("INS")) D
"RTN","SDWLRSR",39,0)
 ..;CHECK FOR SPECIFIC INSTITUTIONAL SORT
"RTN","SDWLRSR",40,0)
 ..S SDWLINS=$P(SDWLX,U,3),SDWLERR=0 I SDWLINS'="ALL",'$D(SDWL("INS",SDWLINS)) S SDWLERR=1 Q
"RTN","SDWLRSR",41,0)
 ..S SDWLPRI=$P(SDWLX,U,11) I SDWLPRI="" S SDWLPRI="N"
"RTN","SDWLRSR",42,0)
 .I SDWLERR Q
"RTN","SDWLRSR",43,0)
 .;CHECK DATE RANGE
"RTN","SDWLRSR",44,0)
 .S SDWLOFDT=$P(SDWLX,U,2),SDWLOK1=1 I SDWLOFDT>SDWLBD!(SDWLOFDT=SDWLBD) D
"RTN","SDWLRSR",45,0)
 ..I SDWLOFDT<SDWLED!(SDWLOFDT=SDWLED) S SDWLOK1=0
"RTN","SDWLRSR",46,0)
 .S SDWLX1=$P(^DIC(4,+$P(SDWLX,U,3),0),U,1),SDWLY1=SDWLTYP
"RTN","SDWLRSR",47,0)
 .S:'$D(^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"AD")) ^("AD")=0
"RTN","SDWLRSR",48,0)
 .S:'$D(^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"AD")) ^("AD")=0
"RTN","SDWLRSR",49,0)
 .I 'SDWLOK1 D S1
"RTN","SDWLRSR",50,0)
 .S:'$D(^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"NR")) ^("NR")=0
"RTN","SDWLRSR",51,0)
 .S:'$D(^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"NR")) ^("NR")=0
"RTN","SDWLRSR",52,0)
 .S SDWLDFDT=0,SDWLOK3=1 I $D(^SDWL(409.3,SDWLDA,"DIS")) S SDWLDFDT=$P(^("DIS"),U,1),SDWLOK3=0 I SDWLDFDT<SDWLBD!(SDWLDFDT>SDWLED) S SDWLOK3=1
"RTN","SDWLRSR",53,0)
 .S:'$D(^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"CL")) ^("CL")=0
"RTN","SDWLRSR",54,0)
 .S:'$D(^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"CL")) ^("CL")=0
"RTN","SDWLRSR",55,0)
 .I 'SDWLOK3 D S3
"RTN","SDWLRSR",56,0)
 .S SDWLTYP=$P(SDWLX,U,5)
"RTN","SDWLRSR",57,0)
 .S:'$D(^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"PR")) ^("PR")=0
"RTN","SDWLRSR",58,0)
 .S:'$D(^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"PR")) ^("PR")=0
"RTN","SDWLRSR",59,0)
 .S SDWLFLG=0
"RTN","SDWLRSR",60,0)
 .I SDWLOFDT'>SDWLBD D
"RTN","SDWLRSR",61,0)
 ..I SDWLOFDT=SDWLBD Q
"RTN","SDWLRSR",62,0)
 ..I $P(SDWLX,U,17)["O" S SDWLFLG=1
"RTN","SDWLRSR",63,0)
 ..I $D(^SDWL(409.3,SDWLDA,"DIS")) D
"RTN","SDWLRSR",64,0)
 ...I 'SDWLFLG,($P($G(^SDWL(409.3,SDWLDA,"DIS")),U,1)>SDWLBD)!($P($G(^SDWL(409.3,SDWLDA,"DIS")),U,1)=SDWLBD) S SDWLFLG=1
"RTN","SDWLRSR",65,0)
 ..I SDWLFLG D
"RTN","SDWLRSR",66,0)
 ...S ^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"PR")=^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"PR")+1
"RTN","SDWLRSR",67,0)
 ...S ^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"PR")=^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"PR")+1
"RTN","SDWLRSR",68,0)
 .I $P(SDWLX,U,14) D
"RTN","SDWLRSR",69,0)
 ..S SDWLRDT=$P(SDWLX,U,14)
"RTN","SDWLRSR",70,0)
 ..I SDWLRDT>SDWLBD!(SDWLRDT=SDWLBD)!(SDWLRDT<SDWLED)!(SDWLRDT=SDWLED) D
"RTN","SDWLRSR",71,0)
 ...S:'$D(^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"NR")) ^("NR")=0
"RTN","SDWLRSR",72,0)
 ...S ^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"NR")=^("NR")+1
"RTN","SDWLRSR",73,0)
 ...S:'$D(^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"NR")) ^("NR")=0
"RTN","SDWLRSR",74,0)
 ...S ^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"NR")=^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"NR")+1
"RTN","SDWLRSR",75,0)
 .D S2
"RTN","SDWLRSR",76,0)
 .I $$S^ZTLOAD S DUOUT=""
"RTN","SDWLRSR",77,0)
 Q
"RTN","SDWLRSR",78,0)
S1 ;ORIGINATING DATE MEETS CRITERIA
"RTN","SDWLRSR",79,0)
 ;
"RTN","SDWLRSR",80,0)
 S ^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"AD")=^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"AD")+1
"RTN","SDWLRSR",81,0)
 S ^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"AD")=^("AD")+1
"RTN","SDWLRSR",82,0)
 Q
"RTN","SDWLRSR",83,0)
S2 ;DO NOT REMOVE DATE MEETS CRITERIA
"RTN","SDWLRSR",84,0)
 ;
"RTN","SDWLRSR",85,0)
 S X1=^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"PR"),X2=$G(^("AD")),X3=$G(^("CL")) S X4=X1+X2-X3
"RTN","SDWLRSR",86,0)
 S ^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"RR")=($G(^("PR"))+($G(^("AD"))))-$G(^("CL"))
"RTN","SDWLRSR",87,0)
 S ^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"NR")=^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"NR")+1
"RTN","SDWLRSR",88,0)
 Q
"RTN","SDWLRSR",89,0)
S3 S SDWLDIS=^SDWL(409.3,SDWLDA,"DIS")  D
"RTN","SDWLRSR",90,0)
 .S ^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"CL")=^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,"CL")+1
"RTN","SDWLRSR",91,0)
 .S ^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"CL")=^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,"CL")+1
"RTN","SDWLRSR",92,0)
 .S SDWLDP=$P(SDWLDIS,U,3),X="SDWL"_SDWLDP,@X=@X+1 S:'$D(^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,X)) ^(X)=0
"RTN","SDWLRSR",93,0)
 .S ^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,X)=^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,X)+1
"RTN","SDWLRSR",94,0)
 .S:'$D(^TMP("SDWLRSR2",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,X)) ^(X)=0
"RTN","SDWLRSR",95,0)
 .S ^TMP("SDWLRSR1",$J,SDWLX1,SDWLY1,SDWLTYPN,SDWLTYNM,SDWLPRI,SDWLDFN,X)=^(X)+1
"RTN","SDWLRSR",96,0)
 Q
"RTN","SDWLRSR",97,0)
PRT ;PRINT REPORT
"RTN","SDWLRSR",98,0)
 S (TT1,TT2,TT3,TT4,TT5,TT6,TT7,TT8,TT9,TT10,TT11,SDWLPG)=0 D HD,HD1
"RTN","SDWLRSR",99,0)
 I '$D(^TMP("SDWLRSR1")) W !!,"No Wait List Data to Report" Q
"RTN","SDWLRSR",100,0)
 S SDWLINS="" F  S SDWLINS=$O(^TMP("SDWLRSR1",$J,SDWLINS)) Q:SDWLINS=""  D  D T2  Q:$D(DUOUT)  W !,"________________" I $Y>(IOSL-5) D:$D(SDWLSPT) SCR D HD,HD1
"RTN","SDWLRSR",101,0)
 .I $$S^ZTLOAD S DUOUT="" Q 
"RTN","SDWLRSR",102,0)
 .W !!,"INSTITUTION: ",SDWLINS,!
"RTN","SDWLRSR",103,0)
 .S SDWLTY="" F  S SDWLTY=$O(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY)) Q:SDWLTY=""  D
"RTN","SDWLRSR",104,0)
 ..S SDWLTNM=$$EXTERNAL^DILFD(409.3,4,,SDWLTY) W !,$E(SDWLTNM,1,15)
"RTN","SDWLRSR",105,0)
 ..S SDWLSCN="" F  S SDWLSCN=$O(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN)) Q:SDWLSCN=""  D
"RTN","SDWLRSR",106,0)
 ...S (T1,T2,T3,T4,T5,T6,T7,T8,T9,T10,T11)=0
"RTN","SDWLRSR",107,0)
 ...S SDWLSCNM="" F  S SDWLSCNM=$O(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM)) Q:SDWLSCNM=""  D  D T1
"RTN","SDWLRSR",108,0)
 ....S SDWLPRI="" F  S SDWLPRI=$O(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI)) Q:SDWLPRI=""  D
"RTN","SDWLRSR",109,0)
 .....W !,?2,$E(SDWLSCNM,1,10)," ",$S(SDWLPRI="A":"ASAP",SDWLPRI="F":"FUTURE",1:"")
"RTN","SDWLRSR",110,0)
 .....S SDWLPR=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"PR")) W ?20,SDWLPR
"RTN","SDWLRSR",111,0)
 .....S SDWLCL=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"CL")) W ?27,SDWLCL
"RTN","SDWLRSR",112,0)
 .....S SDWLD=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLD")) W ?35,SDWLD
"RTN","SDWLRSR",113,0)
 .....S SDWLNC=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLNC")) W ?38,SDWLNC
"RTN","SDWLRSR",114,0)
 .....S SDWLSA=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLSA")) W ?42,SDWLSA
"RTN","SDWLRSR",115,0)
 .....S SDWLCC=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLCC")) W ?46,SDWLCC
"RTN","SDWLRSR",116,0)
 .....S SDWLNN=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLNN")) W ?50,SDWLNN
"RTN","SDWLRSR",117,0)
 .....S SDWLER=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"SDWLER")) W ?54,SDWLER
"RTN","SDWLRSR",118,0)
 .....S SDWLAD=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"AD")) W ?60,SDWLAD
"RTN","SDWLRSR",119,0)
 .....S SDWLRR=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"RR")) W ?66,SDWLRR
"RTN","SDWLRSR",120,0)
 .....S SDWLNR=+$G(^TMP("SDWLRSR1",$J,SDWLINS,SDWLTY,SDWLSCN,SDWLSCNM,SDWLPRI,"NR")) W ?75,SDWLNR
"RTN","SDWLRSR",121,0)
 .....S T1=T1+SDWLPR,TT1=TT1+SDWLPR
"RTN","SDWLRSR",122,0)
 .....S T2=T2+SDWLCL,TT2=TT2+SDWLCL
"RTN","SDWLRSR",123,0)
 .....S T3=T3+SDWLD,TT3=TT3+SDWLD
"RTN","SDWLRSR",124,0)
 .....S T4=T4+SDWLNC,TT4=TT4+SDWLNC
"RTN","SDWLRSR",125,0)
 .....S T5=T5+SDWLSA,TT5=TT5+SDWLSA
"RTN","SDWLRSR",126,0)
 .....S T6=T6+SDWLCC,TT6=TT6+SDWLCC
"RTN","SDWLRSR",127,0)
 .....S T7=T7+SDWLNN,TT7=TT7+SDWLNN
"RTN","SDWLRSR",128,0)
 .....S T8=T8+SDWLER,TT8=TT8+SDWLER
"RTN","SDWLRSR",129,0)
 .....S T9=T9+SDWLAD,TT9=TT9+SDWLAD
"RTN","SDWLRSR",130,0)
 .....S T10=T10+SDWLRR,TT10=TT10+SDWLRR
"RTN","SDWLRSR",131,0)
 .....S T11=T11+SDWLNR,TT11=TT11+SDWLNR
"RTN","SDWLRSR",132,0)
 .....I $Y>(IOSL-5) D:$D(SDWLSPT) SCR D HD,HD1
"RTN","SDWLRSR",133,0)
 Q
"RTN","SDWLRSR",134,0)
SCR S DIR(0)="E" D ^DIR
"RTN","SDWLRSR",135,0)
 Q
"RTN","SDWLRSR",136,0)
T1 ;
"RTN","SDWLRSR",137,0)
 W !,?18,"------",?25,"------",?32,"-----",?38,"--",?42,"--",?46,"--",?50,"--",?54,"--",?57,"-----",?63,"------",?71,"-------"
"RTN","SDWLRSR",138,0)
 W !,"Sub-Totals:"
"RTN","SDWLRSR",139,0)
 ;write sub-totals
"RTN","SDWLRSR",140,0)
 W ?20,T1,?27,T2,?35,T3,?38,T4,?42,T5,?46,T6,?50,T7,?54,T8,?60,T9,?66,T10,?75,T11,!
"RTN","SDWLRSR",141,0)
 S (T1,T2,T3,T4,T5,T6,T7,T8,T9,T10,T11)=0
"RTN","SDWLRSR",142,0)
 I $Y>(IOSL-5) D:$D(SDWLSPT) SCR D HD,HD1
"RTN","SDWLRSR",143,0)
 Q
"RTN","SDWLRSR",144,0)
T2 W !,"Institution Totals:"
"RTN","SDWLRSR",145,0)
 W ?20,TT1,?27,TT2,?35,TT3,?38,TT4,?42,TT5,?46,TT6,?50,TT7,?54,TT8,?60,TT9,?66,TT10,?75,TT11,!
"RTN","SDWLRSR",146,0)
 S (TT1,TT2,TT3,TT4,TT5,TT6,TT7,TT8,TT9,TT10,TT11)=0
"RTN","SDWLRSR",147,0)
 I $Y>(IOSL-5) D:$D(SDWLSPT) SCR D HD,HD1
"RTN","SDWLRSR",148,0)
 Q
"RTN","SDWLRSR",149,0)
HD W:$D(IOF) @IOF S SDWLPG=SDWLPG+1 W !!,SDWLDTP,?80-$L("Wait List (Sch/PCMM) Stat Report")\2,"Wait List (Sch/PCMM) Stat Report",?65,"Page: ",SDWLPG
"RTN","SDWLRSR",150,0)
 W !,?80-$L("STARTED Date: ")\2,"STARTED Date: " S Y=$P(SDWLDATE,U,1) D DD^%DT W Y
"RTN","SDWLRSR",151,0)
 W !,?80-$L("FINISHED Date: ")\2,"FINISHED Date: " S Y=$P(SDWLDATE,U,2) D DD^%DT W Y
"RTN","SDWLRSR",152,0)
 Q
"RTN","SDWLRSR",153,0)
HD1 ;
"RTN","SDWLRSR",154,0)
 W !,?19,"PREV",?59,"#",?65,"#",?72,"# NOT"
"RTN","SDWLRSR",155,0)
 W !,"WAIT LIST TYPE",?18,"REMAIN",?25,"CLOSED",?32,"DEATH",?38,"NC",?42,"SA"
"RTN","SDWLRSR",156,0)
 W ?46,"CC",?50,"NN",?54,"ER",?57,"ADDED",?63,"REMAIN",?71,"REMOVED",!
"RTN","SDWLRSR",157,0)
 Q
"RTN","SDWLRSR",158,0)
END D EN^SDWLKIL
"RTN","SDWLRSR",159,0)
 K ^TMP("SDWLRSR1",$J),^TMP("SDWLRSR2",$J),SDWLY1,SDWLX1,SDWLRDT,CT,I
"RTN","SDWLRSR",160,0)
 K T1,T2,T3,T4,T5,T6,T7,T8,T9,T10,T11,SDWLAD,SDWLBD,SDWLCC,SDWLCT,SDWLDFDT,SDWLDP,SDWLED,SDWLER,SDWLERR,SDWLFLD,X1,X2,DATE
"RTN","SDWLRSR",161,0)
 K TT1,TT2,TT3,TT4,TT5,TT6,TT7,TT8,TT9,TT10,TT11,SDWLINSN,SDWLINST,SDWLNC,SDWLNN,SDWLNR,SDWLOFDT,SDWLOK1,SDWLOK2,SDWLTYPN
"RTN","SDWLRSR",162,0)
 K SDWLOK3,SDWLPR,SDWLPR,SDWLPROM,SDWLRE,SDWLRFDT,SDWLRR,SDWLSA,SDWLSCN,SDWLSCNM,SDWLTASK,SDWLTK,SDWLTNM,SDWLTYNM,SDWLTYP,X4
"RTN","SDWLRSR",163,0)
 Q
"VER")
8.0^22.0
**END**
**END**
