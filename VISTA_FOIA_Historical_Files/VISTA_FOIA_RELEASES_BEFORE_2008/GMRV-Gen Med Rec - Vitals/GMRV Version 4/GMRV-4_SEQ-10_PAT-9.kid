Released GMRV*4*9 SEQ #10
Extracted from mail message
**KIDS**:GMRV*4.0*9^

**INSTALL NAME**
GMRV*4.0*9
"BLD",1761,0)
GMRV*4.0*9^GEN. MED. REC. - VITALS^0^2990505^y
"BLD",1761,1,0)
^^1^1^2990429^^^
"BLD",1761,1,1,0)
Refer to the patch description.
"BLD",1761,4,0)
^9.64PA^^0
"BLD",1761,"ABPKG")
n
"BLD",1761,"INI")

"BLD",1761,"INIT")

"BLD",1761,"KRN",0)
^9.67PA^19^18
"BLD",1761,"KRN",.4,0)
.4
"BLD",1761,"KRN",.4,"NM",0)
^9.68A^^
"BLD",1761,"KRN",.401,0)
.401
"BLD",1761,"KRN",.402,0)
.402
"BLD",1761,"KRN",.403,0)
.403
"BLD",1761,"KRN",.5,0)
.5
"BLD",1761,"KRN",.84,0)
.84
"BLD",1761,"KRN",3.6,0)
3.6
"BLD",1761,"KRN",3.8,0)
3.8
"BLD",1761,"KRN",9.2,0)
9.2
"BLD",1761,"KRN",9.8,0)
9.8
"BLD",1761,"KRN",9.8,"NM",0)
^9.68A^30^11
"BLD",1761,"KRN",9.8,"NM",4,0)
GMRVED0^^0^B23078212
"BLD",1761,"KRN",9.8,"NM",18,0)
GMRVKPN0^^0^B9120983
"BLD",1761,"KRN",9.8,"NM",19,0)
GMRVKPN1^^0^B8663675
"BLD",1761,"KRN",9.8,"NM",20,0)
GMRVKPN2^^0^B4130317
"BLD",1761,"KRN",9.8,"NM",24,0)
GMRVSR0^^0^B33698939
"BLD",1761,"KRN",9.8,"NM",25,0)
GMRVSR1^^0^B26289693
"BLD",1761,"KRN",9.8,"NM",26,0)
GMRVSR2^^0^B6329687
"BLD",1761,"KRN",9.8,"NM",27,0)
GMRVVS1^^0^B25108394
"BLD",1761,"KRN",9.8,"NM",28,0)
GMRVGR1^^0^B33776207
"BLD",1761,"KRN",9.8,"NM",29,0)
GMRVGR2^^0^B14596208
"BLD",1761,"KRN",9.8,"NM",30,0)
GMRVGR6^^0^B6973665
"BLD",1761,"KRN",9.8,"NM","B","GMRVED0",4)

"BLD",1761,"KRN",9.8,"NM","B","GMRVGR1",28)

"BLD",1761,"KRN",9.8,"NM","B","GMRVGR2",29)

"BLD",1761,"KRN",9.8,"NM","B","GMRVGR6",30)

"BLD",1761,"KRN",9.8,"NM","B","GMRVKPN0",18)

"BLD",1761,"KRN",9.8,"NM","B","GMRVKPN1",19)

"BLD",1761,"KRN",9.8,"NM","B","GMRVKPN2",20)

"BLD",1761,"KRN",9.8,"NM","B","GMRVSR0",24)

"BLD",1761,"KRN",9.8,"NM","B","GMRVSR1",25)

"BLD",1761,"KRN",9.8,"NM","B","GMRVSR2",26)

"BLD",1761,"KRN",9.8,"NM","B","GMRVVS1",27)

"BLD",1761,"KRN",19,0)
19
"BLD",1761,"KRN",19,"NM",0)
^9.68A^4^4
"BLD",1761,"KRN",19,"NM",1,0)
GMRV TPR ROUTINE^^0
"BLD",1761,"KRN",19,"NM",2,0)
GMRV TPR B/P ROUTINE^^0
"BLD",1761,"KRN",19,"NM",3,0)
GMRV ADMISSION V/M^^0
"BLD",1761,"KRN",19,"NM",4,0)
GMRV TPRBW^^0
"BLD",1761,"KRN",19,"NM","B","GMRV ADMISSION V/M",3)

"BLD",1761,"KRN",19,"NM","B","GMRV TPR B/P ROUTINE",2)

"BLD",1761,"KRN",19,"NM","B","GMRV TPR ROUTINE",1)

"BLD",1761,"KRN",19,"NM","B","GMRV TPRBW",4)

"BLD",1761,"KRN",19.1,0)
19.1
"BLD",1761,"KRN",101,0)
101
"BLD",1761,"KRN",409.61,0)
409.61
"BLD",1761,"KRN",771,0)
771
"BLD",1761,"KRN",869.2,0)
869.2
"BLD",1761,"KRN",870,0)
870
"BLD",1761,"KRN",8994,0)
8994
"BLD",1761,"KRN","B",.4,.4)

"BLD",1761,"KRN","B",.401,.401)

"BLD",1761,"KRN","B",.402,.402)

"BLD",1761,"KRN","B",.403,.403)

"BLD",1761,"KRN","B",.5,.5)

"BLD",1761,"KRN","B",.84,.84)

"BLD",1761,"KRN","B",3.6,3.6)

"BLD",1761,"KRN","B",3.8,3.8)

"BLD",1761,"KRN","B",9.2,9.2)

"BLD",1761,"KRN","B",9.8,9.8)

"BLD",1761,"KRN","B",19,19)

"BLD",1761,"KRN","B",19.1,19.1)

"BLD",1761,"KRN","B",101,101)

"BLD",1761,"KRN","B",409.61,409.61)

"BLD",1761,"KRN","B",771,771)

"BLD",1761,"KRN","B",869.2,869.2)

"BLD",1761,"KRN","B",870,870)

"BLD",1761,"KRN","B",8994,8994)

"BLD",1761,"PRE")

"BLD",1761,"QUES",0)
^9.62^^
"BLD",1761,"REQB",0)
^9.611^1^1
"BLD",1761,"REQB",1,0)
GMRV*4.0*10^2
"BLD",1761,"REQB","B","GMRV*4.0*10",1)

"KRN",19,2971,-1)
0^1
"KRN",19,2971,0)
GMRV TPR ROUTINE^TPR Pain^^A^^^^^^^^^^1^1
"KRN",19,2971,1,0)
^^2^2^2990317^
"KRN",19,2971,1,1,0)
This option allows users to enter temperature, pulse, respirations and
"KRN",19,2971,1,2,0)
pain.
"KRN",19,2971,15)
D EXITACT^GMRVED4
"KRN",19,2971,20)
D ENTACT^GMRVED4 I $D(GMRVDBA) S GMRENTY=1 D EN2^GMRVED0
"KRN",19,2971,99)
55335,39135
"KRN",19,2971,"U")
TPR PAIN
"KRN",19,2972,-1)
0^2
"KRN",19,2972,0)
GMRV TPR B/P ROUTINE^TPR B/P Pain^^A^^^^^^^^^^1^1
"KRN",19,2972,1,0)
^^2^2^2990317^^^^
"KRN",19,2972,1,1,0)
This option allows data entry of temperature, pulse, respiration and blood
"KRN",19,2972,1,2,0)
pressure.
"KRN",19,2972,15)
D EXITACT^GMRVED4
"KRN",19,2972,20)
D ENTACT^GMRVED4 I $D(GMRVDBA) S GMRENTY=2 D EN2^GMRVED0
"KRN",19,2972,99)
55359,54655
"KRN",19,2972,"U")
TPR B/P PAIN
"KRN",19,2975,-1)
0^3
"KRN",19,2975,0)
GMRV ADMISSION V/M^TPR B/P Ht. Wt. and Pain^^A^^^^^^^^GEN. MED. REC. - VITALS^^1^1
"KRN",19,2975,1,0)
^^3^3^2990317^
"KRN",19,2975,1,1,0)
This option allows users to enter the following vital/measurements through
"KRN",19,2975,1,2,0)
a single option: temperature, pulse, respirations, blood pressure, height,
"KRN",19,2975,1,3,0)
weight and pain.
"KRN",19,2975,15)
D EXITACT^GMRVED4
"KRN",19,2975,20)
D ENTACT^GMRVED4 I $D(GMRVDBA) S GMRENTY=3 D EN2^GMRVED0
"KRN",19,2975,99)
55194,44424
"KRN",19,2975,99.1)
57831,48900
"KRN",19,2975,"U")
TPR B/P HT. WT. AND PAIN
"KRN",19,9876,-1)
0^4
"KRN",19,9876,0)
GMRV TPRBW^TPR B/P Wt. and Pain^^A^^^^^^^^GEN. MED. REC. - VITALS^^1^1
"KRN",19,9876,1,0)
^^2^2^2990317^
"KRN",19,9876,1,1,0)
This option allows data to be entered for temperature, pulse, respiration,
"KRN",19,9876,1,2,0)
blood pressure, weight and pain.
"KRN",19,9876,15)
D EXITACT^GMRVED4
"KRN",19,9876,20)
D ENTACT^GMRVED4 I $D(GMRVDBA) S GMRENTY=4 D EN2^GMRVED0
"KRN",19,9876,"U")
TPR B/P WT. AND PAIN
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",44,-1)
1^1
"PKG",44,0)
GEN. MED. REC. - VITALS^GMRV^Vitals/Measurements Module of General Medical Record.
"PKG",44,20,0)
^9.402P^^
"PKG",44,22,0)
^9.49I^1^1
"PKG",44,22,1,0)
4.0^2970425^2970702^64
"PKG",44,22,1,"PAH",1,0)
9^2990505
"PKG",44,22,1,"PAH",1,1,0)
^^1^1^2990506
"PKG",44,22,1,"PAH",1,1,1,0)
Refer to the patch description.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
11
"RTN","GMRVED0")
0^4^B23078212
"RTN","GMRVED0",1,0)
GMRVED0 ;HIRMFO/RM,YH-VITAL SIGNS EDIT SHORT FORM ;3/17/99
"RTN","GMRVED0",2,0)
 ;;4.0;Vitals/Measurements;**7,9**;Apr 25, 1997
"RTN","GMRVED0",3,0)
EN2 ; DETERMINE VITALS SITE
"RTN","GMRVED0",4,0)
 Q:GMRENTY<1!(GMRENTY>21)  K GMRTMP S GMROUT=0,GMRVIDT(0)=0 I $D(GMRVDBA) S GMRVIDT=$P(GMRVDBA,U,2),GMROUT=$P(GMRVDBA,U)
"RTN","GMRVED0",5,0)
 I '($D(GMRVIDT)#2) S GMRVIDT(0)=1 D DATE^GMRVED0 I GMROUT K GMROUT Q
"RTN","GMRVED0",6,0)
 S GMROUT=0,GMRVWLOC=1,GDT(1)=GMRVIDT D WARDPAT G:GMROUT Q
"RTN","GMRVED0",7,0)
A2 ;
"RTN","GMRVED0",8,0)
 I $G(GMRSTR)="" D
"RTN","GMRVED0",9,0)
 . S GMRSTR=$S(GMRENTY=1:"T;P;R;PN;",GMRENTY=2:"T;P;R;BP;PN;",GMRENTY=3:"T;P;R;BP;HT;WT;PN;",1:"")
"RTN","GMRVED0",10,0)
 . I GMRSTR="" S GMRSTR=$S(GMRENTY=4:"T;P;R;BP;WT;PN;",GMRENTY=5:"T;P;R;BP;",GMRENTY=6:"BP;P;",GMRENTY=7:"P;",GMRENTY=8:"WT;",GMRENTY=19:"CG;",GMRENTY=20:"PO2;",GMRENTY=21:"CVP;",1:"")
"RTN","GMRVED0",11,0)
 I GMRENTY=18 S GMRSTR="PN"
"RTN","GMRVED0",12,0)
 Q:GMRSTR=""
"RTN","GMRVED0",13,0)
A3 ;
"RTN","GMRVED0",14,0)
 I "P1p"[GMREDB S GDT=GMRVIDT D EN1^GMRVADM G:GMROUT Q S GMRDT0=GMRVIDT D EN2^GMRVED3 G:GMROUT!(GMREDB="P1") Q D MULTIVM W !! S GMRVIDT=GDT(1) D PATDAT G Q:GMROUT,A3
"RTN","GMRVED0",15,0)
 I "Aa"[GMREDB D EN1^GMRVED2,EN2^GMRVED2 G Q
"RTN","GMRVED0",16,0)
 I "Ss"[GMREDB D EN3^GMRVED6,EN1^GMRVED2,EN2^GMRVED2 G Q
"RTN","GMRVED0",17,0)
 Q
"RTN","GMRVED0",18,0)
EN3 ; CALL IF DFN TO EDIT SINGLE PATIENT VITALS WHERE
"RTN","GMRVED0",19,0)
 ; INPUT : DFN= PT FILE PTR.
"RTN","GMRVED0",20,0)
 ;                  GMRSTR=STRING OF VITALS TO EDIT
"RTN","GMRVED0",21,0)
 ;                  where T=Temp, P=Pulse, R=Resp, B=BP,H=Ht., W=Wt.
"RTN","GMRVED0",22,0)
 ;                  GMRVHLOC=HOSP. LOCATION (PTR TO FILE 44)
"RTN","GMRVED0",23,0)
 ;                  GMRVIDT=DATE/TIME VITALS TAKEN
"RTN","GMRVED0",24,0)
 ; OUPTUT : GMRVIEN(GMRVTY)=120.5 ENTRY^GMRVREAD^GMRVSITE
"RTN","GMRVED0",25,0)
 ;                   where GMRVTY is the vital type see codes above
"RTN","GMRVED0",26,0)
 ;                   GMRVREAD = READING FOR THIS VITAL TYPE
"RTN","GMRVED0",27,0)
 ;                   GMRVSITE = PTR TO GMR VITALS SITE FILE
"RTN","GMRVED0",28,0)
 ;                   GMROUT WILL BE 1 IF ABNORMAL EXIT, ELSE 0
"RTN","GMRVED0",29,0)
 Q:'$D(DFN)!'$D(GMRSTR)!'$D(GMRVIDT)
"RTN","GMRVED0",30,0)
 S GMROUT=0,GMRTMP=1 I GMROUT S GMROUT=$S(GMROUT=2:0,1:1) G Q3
"RTN","GMRVED0",31,0)
 S GMREDB="P1" D A3
"RTN","GMRVED0",32,0)
 Q:$D(GNUROP)
"RTN","GMRVED0",33,0)
Q3 D Q1 K GMREDB,GMRENTY,GMRTMP Q
"RTN","GMRVED0",34,0)
DATE ; CALL TO SET GMRVIDT (WHEN THE VITALS WERE TAKEN)
"RTN","GMRVED0",35,0)
 ; ALSO RETURNS GMROUT=1 IF TIMEOUT OR UPARROW OUT.
"RTN","GMRVED0",36,0)
 S X=U,%DT("A")="ENTER DATE (TIME Required) VITALS WERE TAKEN: ",%DT="XAPETR" D ^%DT K %DT
"RTN","GMRVED0",37,0)
 I Y<0!(X=U) S GMROUT=$S(X=U:1,1:2) Q
"RTN","GMRVED0",38,0)
 D NOW^%DTC I Y>% W !,?3,$C(7),"Cannot enter future dates" G DATE
"RTN","GMRVED0",39,0)
 S GMRVIDT=Y K POP
"RTN","GMRVED0",40,0)
 Q
"RTN","GMRVED0",41,0)
Q ;
"RTN","GMRVED0",42,0)
 G:$D(GMRTMP) Q1
"RTN","GMRVED0",43,0)
 K GMRVIDT
"RTN","GMRVED0",44,0)
 K ^TMP($J),DFN,GMREDB,GMRENTY,GMROUT,GMRSTR,GMRVHLOC
"RTN","GMRVED0",45,0)
Q1 ;
"RTN","GMRVED0",46,0)
 K %,%T,%DT,%H,DA,DIE,DIC,DQ,DR,GMRDAT,GMRDATE,GMRHELP,GMRI,GMRINPTR,GMRLEN,GMRMSL,GMRNAM,GMRPRMT,GMRRET,GMRRMBD,GMRRMST,GMRROOM,GMRS,GMRSCR,GMRSITE,GMRTO,GMRTY,GMRVIT,GMRVITY,GMRVWLOC,GMRWARD,GMRX,GMRVX,GMRY,POP,GDT,GENTR,GMROK,GMRTMP
"RTN","GMRVED0",47,0)
 D KVAR^VADPT K VA,DIPGM,GMROV,GMRP,GMRTYPE,GMRQUAL,GCT,GDA,GDATA,GLAST,GTYPE,GMRDT0
"RTN","GMRVED0",48,0)
 Q
"RTN","GMRVED0",49,0)
WARDPAT ; SELECT EDIT BY 1. UNIT, 2. SELECTED ROOMS ON UNIT, 3. PATIENT
"RTN","GMRVED0",50,0)
 W !,"Vitals by (A)ll patients on a unit, (S)elected Rooms on unit, or (P)atient? " R GMREDB:DTIME S:'$T GMREDB=U I U[GMREDB S GMROUT=1 Q
"RTN","GMRVED0",51,0)
 I "Aa"[GMREDB!("Ss"[GMREDB)!("P1p"[GMREDB) G WP1
"RTN","GMRVED0",52,0)
 I GMREDB?1"?".E S XQH="GMRV WARD/PAT SEL" D EN^XQH K XQH G WARDPAT
"RTN","GMRVED0",53,0)
 W !,$C(7),?5,"INVALID ENTRY ??" G WARDPAT
"RTN","GMRVED0",54,0)
WP1 ;
"RTN","GMRVED0",55,0)
 I "Aa"[GMREDB!("Ss"[GMREDB) D WARDSEL Q:GMROUT  Q:"Ss"'[GMREDB!("Ss"[GMREDB&$D(^DG(405.4,"W",GMRWARD)))  S XQH="GMRV NO ROOM" D EN^XQH K XQH G WARDPAT
"RTN","GMRVED0",56,0)
 D PATDAT
"RTN","GMRVED0",57,0)
 Q
"RTN","GMRVED0",58,0)
WARDSEL ; SELECT SEARCH WARD
"RTN","GMRVED0",59,0)
 S DIC="^DIC(42,",DIC(0)="AEQMZ",DIC("S")="I '$$INACT42^GMRVUT2(+Y)"
"RTN","GMRVED0",60,0)
 D ^DIC K DIC I X=U!(+Y'>0) S GMROUT=1 Q
"RTN","GMRVED0",61,0)
 S GMRWARD=+Y,GMRWARD(1)=$P(Y(0),U),DFN=$O(^DPT("CN",GMRWARD(1),0))
"RTN","GMRVED0",62,0)
 I DFN="" W !,*7,"**** NO PATIENTS REGISTERED ON UNIT ",$P(^DIC(42,GMRWARD,0),U)," ****" S GMROUT=1 Q
"RTN","GMRVED0",63,0)
 S GMRVHLOC=$S($D(^DIC(42,GMRWARD,44)):$P(^(44),U),1:"")
"RTN","GMRVED0",64,0)
 Q
"RTN","GMRVED0",65,0)
PATDAT ;
"RTN","GMRVED0",66,0)
 S DIC(0)="AEQMZ",DIC="^DPT(" D ^DIC K DIC S DFN=+Y
"RTN","GMRVED0",67,0)
 I DFN'>0 S GMROUT=1 Q
"RTN","GMRVED0",68,0)
 D INP^VADPT S GMRWARD(1)=$P(VAIN(4),U,2),GMRWARD=$P(VAIN(4),U) D KVAR^VADPT K VA
"RTN","GMRVED0",69,0)
 I ('$D(GMRWARD)!(GMRWARD'>0)),"P1p"[GMREDB,$D(GMRVIDT) S GENTR=2,GDT=GMRVIDT D ADM^GMRVADM Q:GMROUT  S:GMRWARD=0 GMROUT=1 Q:GMROUT
"RTN","GMRVED0",70,0)
 Q:'GMRVWLOC
"RTN","GMRVED0",71,0)
 S DIC("A")="Select Hospital Location: ",DIC("B")=$S('$D(^DIC(42,+GMRWARD,44)):"",$D(^SC(+$P(^DIC(42,+GMRWARD,44),U),0)):$P(^(0),U),1:""),DIC=44,DIC(0)="AEMQ",DIC("S")="I $P(^(0),U,3)'=""Z""" D ^DIC K DIC
"RTN","GMRVED0",72,0)
 I +Y'>0 W !,"Hospital location is required",! S GMROUT=1 Q
"RTN","GMRVED0",73,0)
 S GMRVHLOC=+Y Q
"RTN","GMRVED0",74,0)
MULTIVM Q:GMROUT  W !!,"Do you want to enter other V/M data for this patient" S %=2 D YN^DICN W:%=0 !!,"Select YES if you want to enter another V/M record at a different",!,"date/time for the same patient.",! G:%=0 MULTIVM Q:%'=1
"RTN","GMRVED0",75,0)
 D DATE I 'GMROUT S GMRDT0=GMRVIDT D EN2^GMRVED3 G MULTIVM
"RTN","GMRVED0",76,0)
 S GMROUT=0 Q
"RTN","GMRVGR1")
0^28^B33776207
"RTN","GMRVGR1",1,0)
GMRVGR1 ;HIRMFO/YH-SET ^TMP($J) GLOBAL ;5/5/99  11:33
"RTN","GMRVGR1",2,0)
 ;;4.0;Vitals/Measurements;**1,9**;Apr 25, 1997
"RTN","GMRVGR1",3,0)
 ;CONTINUTATION OF GMRVGR0
"RTN","GMRVGR1",4,0)
GRAPH S (GCNT,GCNTD,GPG)=0 D DEM^VADPT,INP^VADPT,SETV
"RTN","GMRVGR1",5,0)
 F GK="H","W","T","P","R","B","I","O","PO2","CVP","CG","PN" D
"RTN","GMRVGR1",6,0)
 . S ^TMP($J,"GTNM",GK)=0 F GI=0:0 S GI=$O(^TMP($J,"GMRVG",GK,GI)) Q:GI'>0  S GJ="" F X=0:0 S GJ=$O(^TMP($J,"GMRVG",GK,GI,GJ)) Q:GJ=""  S ^TMP($J,"GTNM",GK)=^TMP($J,"GTNM",GK)+1,^TMP($J,"GDT",GI)=""
"RTN","GMRVGR1",7,0)
 S GTNM=0 F X=0:0 S X=$O(^TMP($J,"GDT",X)) Q:X'>0  S GTNM=GTNM+1
"RTN","GMRVGR1",8,0)
 S GPG=$S(GTNM=0:1,1:GTNM\10+''(GTNM#10)),GDT1=0
"RTN","GMRVGR1",9,0)
 F GPGS=1:1:GPG D
"RTN","GMRVGR1",10,0)
 . F GI=1:1:200 S ^TMP($J,"GMRK","G"_GI)=""
"RTN","GMRVGR1",11,0)
 . K GMRQUAL S ^TMP($J,"GMRK","G199")="Page "_GPGS D SETP,DATE S ^TMP($J,"GMRK","G200")=GMRRMBD
"RTN","GMRVGR1",12,0)
 . D PAGE,EN1^GMRVGR2,EN2^GMRVGR3,EN3^GMRVGR4,EN4^GMRVGR6 S ^TMP($J,"GMRK","G50M")=0.2,^TMP($J,"GMRK","G82M")=0.6
"RTN","GMRVGR1",13,0)
 D KVAR^VADPT K VA Q
"RTN","GMRVGR1",14,0)
PAGE ;Set temp. and pulse starting point in the graph
"RTN","GMRVGR1",15,0)
 D SETV
"RTN","GMRVGR1",16,0)
 I ^TMP($J,"GMRK","G50")="" F GI=51:1:59 S ^TMP($J,"GMRK","G50")=^TMP($J,"GMRK","G"_GI),^TMP($J,"GMRK","G50M")=0.2+(1.6*(GI-50)) Q:^TMP($J,"GMRK","G50")'=""
"RTN","GMRVGR1",17,0)
 I ^TMP($J,"GMRK","G82")="" F GI=83:1:91 S ^TMP($J,"GMRK","G82")=^TMP($J,"GMRK","G"_GI),^TMP($J,"GMRK","G82M")=0.6+(1.6*(GI-82)) Q:^TMP($J,"GMRK","G82")'=""
"RTN","GMRVGR1",18,0)
 I $D(GMRQUAL) D LEGEND^GMRVLGQU
"RTN","GMRVGR1",19,0)
 K GG,GI,GMRVJ,GSYNO Q
"RTN","GMRVGR1",20,0)
SETV ;Set patient data in ^TMP($J,"GMRK" global
"RTN","GMRVGR1",21,0)
 S ^TMP($J,"GMRK","G194")=$S(VADM(1)'="":VADM(1),1:"         ")_"  "_$S(VADM(2)'="":$P(VADM(2),"^",2),1:" "),GDOB=$S($D(VADM(3)):$P(VADM(3),"^",2),1:" "),GAGE=$S($D(VADM(4)):VADM(4),1:" ")
"RTN","GMRVGR1",22,0)
 S ^TMP($J,"GMRK","G197")=$S($D(VADM(5)):$P(VADM(5),"^",2),1:" "),^TMP($J,"GMRK","G198")=$S($D(GMRWARD(1)):"Unit: "_GMRWARD(1),1:"Unit:  ")
"RTN","GMRVGR1",23,0)
 S GMRRMBD=$S('(VAIN(5)=""):"Room: "_$P(VAIN(5),"-",1,2),1:"Room:  "),^TMP($J,"GMRK","G196")=$S($D(GDOB)&($D(GAGE)):GDOB_" ("_GAGE_")",1:" ")
"RTN","GMRVGR1",24,0)
 I '$D(GMRVHLOC) S GMRVHLOC=$P($G(^DIC(42,+$G(VAIN(4)),44)),"^")
"RTN","GMRVGR1",25,0)
 S GMRDIV="Division: "_$S(GMRVHLOC>0:$$GET1^DIQ(4,+$$GET1^DIQ(44,+GMRVHLOC,3,"I"),.01,"I"),1:"")
"RTN","GMRVGR1",26,0)
 Q
"RTN","GMRVGR1",27,0)
DATE F GCNTD=1:1:10 S:$L(GDT1) GDT1=$O(^TMP($J,"GDT",GDT1)) S ^TMP($J,"GMRK","G"_GCNTD)=$S($L(GDT1):$E(GDT1,4,5)_"-"_$E(GDT1,6,7)_"-"_$E(GDT1,2,3),1:"") D DATE1
"RTN","GMRVGR1",28,0)
 Q
"RTN","GMRVGR1",29,0)
DATE1 S Y=$E($P(GDT1,".",2)_"0000",1,4),^TMP($J,"GMRK","G"_(GCNTD+16))=$S($L(GDT1):$E(Y,1,2)_":"_$E(Y,3,4),1:"") D SETD
"RTN","GMRVGR1",30,0)
 Q
"RTN","GMRVGR1",31,0)
SETD F GI="H","W","T","P","R","B","I","O","C","PN" S GJ=$F("WTXPXRBIOCH",GI),GK=$S($L(GDT1):$O(^TMP($J,"GMRVG",GI,GDT1,"")),1:"") D SETA
"RTN","GMRVGR1",32,0)
 F GI="PO2","CVP","CG" S GJ=0,GK=$S($L(GDT1):$O(^TMP($J,"GMRVG",GI,GDT1,"")),1:"") D SETA
"RTN","GMRVGR1",33,0)
 Q
"RTN","GMRVGR1",34,0)
SETA ;Store measurements in ^TMP($J,"GMRK" global
"RTN","GMRVGR1",35,0)
 I GK="Unavailable" S GK="Unavail"
"RTN","GMRVGR1",36,0)
 I GI="PN" S ^TMP($J,"GMRK","G"_(1660+GCNTD))=GK Q
"RTN","GMRVGR1",37,0)
 S (GMRSITE,GMRSITE(1),GMRINF,GMRVJ)=""
"RTN","GMRVGR1",38,0)
 I GK'="" D
"RTN","GMRVGR1",39,0)
 . S GMRSITE(1)=$P($G(^TMP($J,"GMRVG",GI,GDT1,GK)),"^"),GMRVJ=$P($G(^(GK)),"^",2),GMRINF=$P($G(^(GK)),"^",4)
"RTN","GMRVGR1",40,0)
 . I GMRSITE(1)'="" D SYNOARY^GMRVLGQU
"RTN","GMRVGR1",41,0)
 I GI="H" D  Q
"RTN","GMRVGR1",42,0)
 . S ^TMP($J,"GMRK","G"_(270+GCNTD))=GK_" "_GMRSITE,^TMP($J,"GMRK","G"_(290+GCNTD))=$S(GK>0:$J(GK*2.54,0,2),1:"") S:GK>0 GMRHT=(GK*2.54)/100
"RTN","GMRVGR1",43,0)
 I GI="C" S ^TMP($J,"GMRK","G"_(1640+GCNTD))=GK_"  "_^TMP($J,"GMRK","G"_(1640+GCNTD)) Q
"RTN","GMRVGR1",44,0)
 I GI="PO2"!(GI="CVP")!(GI="CG") D  Q
"RTN","GMRVGR1",45,0)
 . I GI="PO2" D
"RTN","GMRVGR1",46,0)
 . . S (GMRINF(1),GMRINF(2))="" I GMRINF'="" D PO2^GMRVLGQU(.GMRINF)
"RTN","GMRVGR1",47,0)
 . . S ^TMP($J,"GMRK","G"_(1100+GCNTD))=GK_$S(GMRVJ=1:"*",1:" ")
"RTN","GMRVGR1",48,0)
 . . S ^TMP($J,"GMRK","G"_(1130+GCNTD))=GMRINF(1)
"RTN","GMRVGR1",49,0)
 . . S ^TMP($J,"GMRK","G"_(1150+GCNTD))=GMRINF(2)
"RTN","GMRVGR1",50,0)
 . . S ^TMP($J,"GMRK","G"_(1170+GCNTD))=GMRSITE
"RTN","GMRVGR1",51,0)
 . . Q
"RTN","GMRVGR1",52,0)
 . I GI="CVP" D
"RTN","GMRVGR1",53,0)
 . . S ^TMP($J,"GMRK","G"_(1200+GCNTD))=$S(GK>0!(GK<0):$J(GK,0,1),1:GK)_$S(GMRVJ=1:"*",1:" ")
"RTN","GMRVGR1",54,0)
 . . S ^TMP($J,"GMRK","G"_(1230+GCNTD))=$S(GK>0!(GK<0)!($E(GK)="0"):$J(GK/1.36,0,1),1:"")_$S(GMRVJ=1:"*",1:" ")
"RTN","GMRVGR1",55,0)
 . . Q
"RTN","GMRVGR1",56,0)
 . I GI="CG" D
"RTN","GMRVGR1",57,0)
 . . S ^TMP($J,"GMRK","G"_(1250+GCNTD))=GK_" "_GMRSITE,^TMP($J,"GMRK","G"_(1320+GCNTD))=$S(GK>0:$J(GK/.3937,0,2),1:"")
"RTN","GMRVGR1",58,0)
 . . Q
"RTN","GMRVGR1",59,0)
 I GI="B",GK'="" S ^TMP($J,"GMRK","G"_(250+GCNTD))=$S($L(GMRSITE," ")>3:$P(GMRSITE," ",2,4),1:GMRSITE) S:$L(GMRSITE," ")>3 ^TMP($J,"GMRK","G"_(1640+GCNTD))=$P(GMRSITE," ")
"RTN","GMRVGR1",60,0)
 I '(GI="T"!(GI="P")) D  Q
"RTN","GMRVGR1",61,0)
 . I GI="C" S GMRSITE=$S($L(GMRSITE," ")>3:"  "_$P(GMRSITE," "),1:"")
"RTN","GMRVGR1",62,0)
 . S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=GK_$S(GMRVJ=1&(GI'="C"):"*",1:" ")_$S(GI="B":"",1:GMRSITE) S:GI="W" ^TMP($J,"GMRK","G"_(310+GCNTD))=$S(GK>0:$J(GK/2.2,0,2),1:"")
"RTN","GMRVGR1",63,0)
 . I GK>0,GI="W" D
"RTN","GMRVGR1",64,0)
 . . S GMRBMI="",GMRBMI(1)=GDT1,GMRBMI(2)=GK D CALBMI^GMRVBMI(.GMRBMI)
"RTN","GMRVGR1",65,0)
 . . S ^TMP($J,"GMRK","G"_(330+GCNTD))=GMRBMI K GMRBMI
"RTN","GMRVGR1",66,0)
 ;Apical and Radial Enhancement
"RTN","GMRVGR1",67,0)
 ;I GI="T",GK>0 S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=106-GK
"RTN","GMRVGR1",68,0)
 ;I GK'="",GI="P","UNAVAILABLEPASSREFUSED"'[$$UP^XLFSTR(GK) D
"RTN","GMRVGR1",69,0)
 ;. I GMRSITE(1)["RADIAL"!(GMRSITE(1)["APICAL") D
"RTN","GMRVGR1",70,0)
 ;. . S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=170-GK/10
"RTN","GMRVGR1",71,0)
 ;S ^TMP($J,"GMRK","G"_(GJ+1*16+GCNTD+1))=GK_$S(GMRVJ=1:"*",1:" ")_$S(GI="T":GMRSITE,GI="P"&($L(GMRSITE," ")>3):"  "_$P(GMRSITE," "),1:"")
"RTN","GMRVGR1",72,0)
 S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=$S(GK>0:$S(GI="T":106-GK,GI="P":170-GK/10,1:""),1:"") S ^TMP($J,"GMRK","G"_(GJ+1*16+GCNTD+1))=GK_$S(GMRVJ=1:"*",1:" ")_$S(GI="T":GMRSITE,GI="P"&($L(GMRSITE," ")>3):"  "_$P(GMRSITE," "),1:"")
"RTN","GMRVGR1",73,0)
 I GI="T",GK>0 S ^TMP($J,"GMRK","G"_(210+GCNTD))=$S(GMRVJ=1:"T*",1:"T")
"RTN","GMRVGR1",74,0)
 I GI="P",GK>0 S ^TMP($J,"GMRK","G"_(230+GCNTD))=$S(GMRVJ=1:"P*",1:"P"),^TMP($J,"GMRK","G"_(1300+GCNTD))=$S($L(GMRSITE," ")>3:$P(GMRSITE," ",2,4),1:GMRSITE)
"RTN","GMRVGR1",75,0)
 ;I GI="P",GK'="","UNAVAILABLEPASSREFUSED"'[$$UP^XLFSTR(GK) D
"RTN","GMRVGR1",76,0)
 ;. I GMRSITE(1)["RADIAL"!(GMRSITE(1)["APICAL") S ^TMP($J,"GMRK","G"_(230+GCNTD))=$S(GMRVJ=1:"P*",1:"P")
"RTN","GMRVGR1",77,0)
 ;. S ^TMP($J,"GMRK","G"_(1300+GCNTD))=$S($L(GMRSITE," ")>3:$P(GMRSITE," ",2,4),1:GMRSITE)
"RTN","GMRVGR1",78,0)
 I GK>0,GI="T" S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=$S(^("G"_(GJ*16+GCNTD+1))<1.5:1.5,^("G"_(GJ*16+GCNTD+1))>12.7:12.7,1:^("G"_(GJ*16+GCNTD+1))) S:^("G"_(GJ*16+GCNTD+1))<1.6!(^("G"_(GJ*16+GCNTD+1))>12.6) ^TMP($J,"GMRK","G"_(210+GCNTD))="T**"
"RTN","GMRVGR1",79,0)
 I GK>0,GI="P" S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=$S(^("G"_(GJ*16+GCNTD+1))<1.5:1.5,^("G"_(GJ*16+GCNTD+1))>12.7:12.7,1:^("G"_(GJ*16+GCNTD+1))) S:^("G"_(GJ*16+GCNTD+1))<1.6!(^("G"_(GJ*16+GCNTD+1))>12.6) ^TMP($J,"GMRK","G"_(230+GCNTD))="P**"
"RTN","GMRVGR1",80,0)
 ;I GK'="",GI="P","UNAVAILABLEPASSREFUSED"'[$$UP^XLFSTR(GK) D
"RTN","GMRVGR1",81,0)
 ;. I GMRSITE(1)["RADIAL"!(GMRSITE(1)["APICAL") D
"RTN","GMRVGR1",82,0)
 ;. . S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=$S(^("G"_(GJ*16+GCNTD+1))<1.5:1.5,^("G"_(GJ*16+GCNTD+1))>12.7:12.7,1:^("G"_(GJ*16+GCNTD+1)))
"RTN","GMRVGR1",83,0)
 ;. . S:^("G"_(GJ*16+GCNTD+1))<1.6!(^("G"_(GJ*16+GCNTD+1))>12.6) ^TMP($J,"GMRK","G"_(230+GCNTD))="P**"
"RTN","GMRVGR1",84,0)
 Q
"RTN","GMRVGR1",85,0)
SETP ;INITIALIZE ^TMP FOR HEIGHT, WEIGHT AND V/M QUALIFIERS
"RTN","GMRVGR1",86,0)
 ;250+I: BP QUALIFIER  270+I: HEIGHT IN INCH  290+I: HEIGHT IN CM
"RTN","GMRVGR1",87,0)
 ;310+I:WEIGHT IN KG  330+I: BMI
"RTN","GMRVGR1",88,0)
 ;1100+I: PULSE OXIMETRY DATA  1130+I: PULSE OX. L/MIN
"RTN","GMRVGR1",89,0)
 ;1150+I: PULSE OX. %  1170+I: PULSE OX. METHOD
"RTN","GMRVGR1",90,0)
 ;1200+I: CVP DATA IN CM H2O  1230+I: CVP DATA IN MMHG
"RTN","GMRVGR1",91,0)
 ;1250+I: C/G DATA IN INCH  1270+I: C/G QUALIFIER  1300+I: PULSE QUALIFIER
"RTN","GMRVGR1",92,0)
 ;1320+I: C/G DATA IN CM 1640+I: THIRD PIECE OF BP 1660+I: PAIN
"RTN","GMRVGR1",93,0)
 F I=1:1:10 D
"RTN","GMRVGR1",94,0)
 . S (^TMP($J,"GMRK","G"_(210+I)),^("G"_(230+I)),^("G"_(250+I)),^("G"_(270+I)),^("G"_(290+I)),^("G"_(310+I)),^("G"_(330+I)),^("G"_(1300+I)))=""
"RTN","GMRVGR1",95,0)
 . S (^TMP($J,"GMRK","G"_(1100+I)),^("G"_(1130+I)),^("G"_(1150+I)),^("G"_(1170+I)),^("G"_(1200+I)),^("G"_(1230+I)),^("G"_(1250+I)),^("G"_(1270+I)))=""
"RTN","GMRVGR1",96,0)
 . S (^TMP($J,"GMRK","G"_(1320+I)),^("G"_(1640+I)),^("G"_(1660+I)))=""
"RTN","GMRVGR1",97,0)
 Q
"RTN","GMRVGR2")
0^29^B14596208
"RTN","GMRVGR2",1,0)
GMRVGR2 ;HIRMFO/YH-VITALS GRAPH KYOCERA DEFINE MACRO (PART 1) ;3/15/99
"RTN","GMRVGR2",2,0)
 ;;4.0;Vitals/Measurements;**1,9**;Apr 25, 1997
"RTN","GMRVGR2",3,0)
EN1 W !,"!R! RES; DAM;"
"RTN","GMRVGR2",4,0)
BOX W !,"MCRO BOX;"
"RTN","GMRVGR2",5,0)
 W !,"UNIT C; SLM 3; STM 1; MAP 0,0; SPD 0.05; BOX 16,22.2; MAP -2.5,13; BOX 18.5,9.2;"
"RTN","GMRVGR2",6,0)
 W !,"FONT 40; MAP -2,0.5; TEXT 'Date/Time'; MAP -2.7,1; TEXT 'Pulse'; MAP -1.7,1; TEXT 'Temp/F/C';"
"RTN","GMRVGR2",7,0)
 W !,"SPD 0.01; MAP -2.7,2; TEXT '150'; MAP -1.5,2; TEXT '104/40.0'; MAP 0,1; DAP 16,1;"
"RTN","GMRVGR2",8,0)
 W !,"MAP -2.7,3; TEXT '140'; MAP -1.5,3; TEXT '103/39.4'; MAP 0,2; DAP 16,2;"
"RTN","GMRVGR2",9,0)
 W !,"MAP -2.7,4; TEXT '130'; MAP -1.5,4; TEXT '102/38.9'; MAP 0,3; DAP 16,3;"
"RTN","GMRVGR2",10,0)
 W:GTNM=0 "MAP 2,5; TEXT 'THERE  IS  NO  DATA  FOR  THIS  REPORT';"
"RTN","GMRVGR2",11,0)
 W !,"MAP -2.7,5; TEXT '120'; MAP -1.5,5; TEXT '101/38.3'; MAP 0,4; DAP 16,4;"
"RTN","GMRVGR2",12,0)
 W !,"MAP -2.7,6; TEXT '110'; MAP -1.5,6; TEXT '100/37.8'; MAP 0,5; DAP 16,5;"
"RTN","GMRVGR2",13,0)
 W !,"MAP -2.7,7; TEXT '100'; MAP -1.5,7; TEXT '99/37.2'; MAP 0,6; DAP 16,6;"
"RTN","GMRVGR2",14,0)
 W !,"SPD 0.05; MAP -1.5,7.4; TEXT '98.6'; MAP 0,7.4; DAP 16,7.4;"
"RTN","GMRVGR2",15,0)
 W !,"SPD 0.01; MAP -2.7,8; TEXT '90'; MAP -1.5,8; TEXT '98/36.7'; MAP 0,7; DAP 16,7; MAP 0,8; DAP 16,8;"
"RTN","GMRVGR2",16,0)
 W !,"MAP -2.7,9; TEXT '80'; MAP -1.5,9; TEXT '97/36.1'; MAP 0,9; DAP 16,9;"
"RTN","GMRVGR2",17,0)
 W !,"MAP -2.7,10; TEXT '70'; MAP -1.5,10; TEXT '96/35.6'; MAP 0,9; DAP 16,9;"
"RTN","GMRVGR2",18,0)
 W !,"MAP -2.7,11; TEXT '60'; MAP -1.5,11; TEXT '95/35.0'; MAP 0,10; DAP 16,10;"
"RTN","GMRVGR2",19,0)
 W !,"MAP -2.7,12; TEXT '50'; MAP -1.5,12; TEXT '94'; MAP 0,11; DAP 16,11; MAP 16,12; DAP0,12;"
"RTN","GMRVGR2",20,0)
BOX2 W !,"MAP -2.5,13.4; DAP 16,13.4; MAP -2.5,14.2; DAP 16,14.2; MAP -2.5,14.6; DAP 16,14.6; MAP -2.5,15; DAP 16,15; MAP -2.5,15.4; DAP 16,15.4;"
"RTN","GMRVGR2",21,0)
 W !,"MAP -2.5,15.8; DAP 16,15.8; MAP -2.5,16.2; DAP 16,16.2; MAP -2.5,17.4; DAP 16,17.4; MAP -2.5,17.8; DAP 16,17.8;"
"RTN","GMRVGR2",22,0)
 W !,"MAP -2.5,18.2; DAP 16,18.2; MAP -2.5,18.6; DAP 16,18.6; MAP -2.5,19; DAP 16,19; MAP -2.5,19.4; DAP 16,19.4; MAP -2.5,19.8; DAP 16,19.8;"
"RTN","GMRVGR2",23,0)
 W !,"MAP -2.5,20.2; DAP 16,20.2; MAP -2.5,20.6; DAP 16,20.6; MAP -2.5,21; DAP 16,21; MAP -2.5,21.4; DAP 16,21.4;"
"RTN","GMRVGR2",24,0)
 W !,"MAP -2.5,21.8; DAP 16,21.8;MAP -2.5,22.2; DAP 16,22.2;"
"RTN","GMRVGR2",25,0)
 W !,"FONT 57; MAP -2.4,13.3; TEXT 'Temperature'; MAP -2.4,13.7; TEXT 'Pulse'; MAP -2.4,14.5; TEXT 'Respiration';"
"RTN","GMRVGR2",26,0)
 W !,"MAP -2.4,14.9; TEXT 'Pulse Ox.'; MAP -2.2,15.3; TEXT 'L/Min'; MAP -2.2,15.7; TEXT %1; MAP -2.2,16.1; TEXT 'Method';"
"RTN","GMRVGR2",27,0)
 W !,"MAP -2.4,16.6; TEXT 'Blood Pressure';"
"RTN","GMRVGR2",28,0)
 W !,"MAP -2.4,17.7; TEXT 'Weight (lb)'; MAP -1.5,18.1; TEXT '(kg)'; MAP -2.4,18.5; TEXT 'Body Mass Index'; MAP -2.4,18.9; TEXT 'Height (in)'; MAP -1.5,19.3; TEXT '(cm)';"
"RTN","GMRVGR2",29,0)
 W !,"MAP -2.4,19.7; TEXT 'C/G (in)'; MAP -1.9,20.1; TEXT '(cm)'; MAP -2.4,20.5; TEXT 'CVP'; MAP -1.5,20.5; TEXT '(cm H2O)'; MAP -1.5,20.9; TEXT '(mm Hg)';"
"RTN","GMRVGR2",30,0)
 W !,"MAP -2.4,21.3; TEXT 'Intake (24hr)(cc)'; MAP -2.4,21.7; TEXT 'Output (24hr)(cc)';" W !," MAP -2.4,22.1; TEXT 'Pain';"
"RTN","GMRVGR2",31,0)
VERT W !,"SPD 0.03;" S I(1)="" F I=1:1:9 S I(1)=I(1)_"MAP "_(1.6*I)_",0; DAP "_(1.6*I)_",22.2;"
"RTN","GMRVGR2",32,0)
 W !,I(1)
"RTN","GMRVGR2",33,0)
 W !,"MAP -2.4,22.6; TEXT 'T: Temperature     P: Pulse     C/G: Circumference/Girth     * - Abnormal value     ** - Abnormal value off of graph';"
"RTN","GMRVGR2",34,0)
 W !,"MAP -2.4,22.9; TEXT 'Pain:  99 - Unable to respond   0 - No pain   10 - Worst imaginable pain';"
"RTN","GMRVGR2",35,0)
FORM W !,"MAP 12,25.3; TEXT 'MEDICAL RECORD'; MAP 12,25.6; TEXT 'VITAL FLOW SHEET'; MAP 12,25.9; TEXT 'VAF 10-7987 VICE SF 511';"
"RTN","GMRVGR2",36,0)
 W !,"ENDM;"
"RTN","GMRVGR2",37,0)
DATE W !,"MCRO DATE; FONT 56;" S J=0.4 D WRTEXT^GMRVBP2
"RTN","GMRVGR2",38,0)
 W !,"ENDM;"
"RTN","GMRVGR2",39,0)
TIME W !,"MCRO TIME;" S J=0.8 D WRTEXT^GMRVBP2
"RTN","GMRVGR2",40,0)
 W !,"ENDM;"
"RTN","GMRVGR2",41,0)
WT W !,"MCRO WT;" S J=17.7 D WRTEXT^GMRVBP2
"RTN","GMRVGR2",42,0)
 W !,"ENDM;"
"RTN","GMRVGR2",43,0)
WTKG W !,"MCRO WTKG;" S J=18.1 D WRTEXT^GMRVBP2
"RTN","GMRVGR2",44,0)
 W !,"ENDM;"
"RTN","GMRVGR2",45,0)
HT ;
"RTN","GMRVGR2",46,0)
 D HT^GMRVGR7
"RTN","GMRVGR2",47,0)
 Q
"RTN","GMRVGR6")
0^30^B6973665
"RTN","GMRVGR6",1,0)
GMRVGR6 ;HIRMFO/YH-VITALS GRAPH KYOCERA PRINT COMMANDS (PART 2) ;3/15/99
"RTN","GMRVGR6",2,0)
 ;;4.0;Vitals/Measurements;**1,9**;Apr 25, 1997
"RTN","GMRVGR6",3,0)
EN4 ;CONTINUATION OF GMRVGR4
"RTN","GMRVGR6",4,0)
 W !,"CALL PULQ" S J(1)=1301,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",5,0)
RESP W !,"CALL RESP" S J(1)=114,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",6,0)
POX ;
"RTN","GMRVGR6",7,0)
 W !,"CALL POXD" S J(1)=1101,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",8,0)
 W !,"CALL POXL" S J(1)=1131,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",9,0)
 W !,"CALL POXP" S J(1)=1151,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",10,0)
 W !,"CALL POXM" S J(1)=1171,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",11,0)
BP W !,"CALL BP" S J(1)=130,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",12,0)
 W !,"CALL BP3" S J(1)=1641,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",13,0)
 W !,"CALL BPQUA" S J(1)=251,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",14,0)
CG ;
"RTN","GMRVGR6",15,0)
 W !,"CALL CG" S J(1)=1251,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",16,0)
 W !,"CALL CG2" S J(1)=1321,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",17,0)
CVP ;
"RTN","GMRVGR6",18,0)
 W !,"CALL H2O" S J(1)=1201,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",19,0)
 W !,"CALL HG" S J(1)=1231,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",20,0)
 W !,"DAM;" D INTK1 W !,"RES; EXIT;"
"RTN","GMRVGR6",21,0)
 Q
"RTN","GMRVGR6",22,0)
INTK1 W !,"MCRO INTK;" S J=21.3 D WRTEXT^GMRVBP2
"RTN","GMRVGR6",23,0)
 W !,"ENDM;"
"RTN","GMRVGR6",24,0)
OUTP W !,"MCRO OUTP;" S J=21.7 D WRTEXT^GMRVBP2
"RTN","GMRVGR6",25,0)
 W !,"ENDM;"
"RTN","GMRVGR6",26,0)
 W !,"MCRO PAIN;" S J=22.1 D WRTEXT^GMRVBP2
"RTN","GMRVGR6",27,0)
 W !,"ENDM;"
"RTN","GMRVGR6",28,0)
 W !,"MCRO QU1; FONT 57; MAP -2.4,23.2; TEXT %1; ENDM;"
"RTN","GMRVGR6",29,0)
 W !,"MCRO QU2; MAP -2.4,23.5; TEXT %1; ENDM;"
"RTN","GMRVGR6",30,0)
 W !,"MCRO QU3; MAP -2.4,23.8; TEXT %1; ENDM;"
"RTN","GMRVGR6",31,0)
 W !,"MCRO QU4; MAP -2.4,24.1; TEXT %1; ENDM;"
"RTN","GMRVGR6",32,0)
 W !,"MCRO QU5; MAP -2.4,24.4; TEXT %1; ENDM;"
"RTN","GMRVGR6",33,0)
PID W !,"MCRO PID; FONT 56; MAP -1,24.7; TEXT %1; MAP -1,25; TEXT %2; MAP 3.5,25; TEXT %3; MAP -1,25.3; TEXT %4; MAP 7,25.9; TEXT %5; MAP 7,25.6; TEXT %6; MAP -1,25.6; TEXT %7; MAP -1,25.9; TEXT %8;"
"RTN","GMRVGR6",34,0)
 W !,"ENDM;"
"RTN","GMRVGR6",35,0)
INTK W !,"CALL INTK" S J(1)=146,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",36,0)
 W !,"CALL OUTP" S J(1)=162,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",37,0)
 W !,"CALL PAIN" S J(1)=1661,J(2)=J(1)+9 D WRTCALL^GMRVBP4
"RTN","GMRVGR6",38,0)
 W !,"CALL QU1, '"_$G(GLINE(1))_"';"
"RTN","GMRVGR6",39,0)
 W !,"CALL QU2, '"_$G(GLINE(2))_"';"
"RTN","GMRVGR6",40,0)
 W !,"CALL QU3, '"_$G(GLINE(3))_"';"
"RTN","GMRVGR6",41,0)
 W !,"CALL QU4, '"_$G(GLINE(4))_"';"
"RTN","GMRVGR6",42,0)
 ;W !,"CALL QU5, '"_$G(GLINE(5))_"';"
"RTN","GMRVGR6",43,0)
 W !,"CALL PID, '"_^TMP($J,"GMRK","G194")_"', '"_^("G196")_"', '"_^("G197")_"', '"_^("G198")_"', '"_^("G199")_"', '"_^("G200")_"', '"_GMRDIV_"', '"_GSTRFIN_"';"
"RTN","GMRVGR6",44,0)
 Q
"RTN","GMRVKPN0")
0^18^B9120983
"RTN","GMRVKPN0",1,0)
GMRVKPN0 ;HCIOFO/YH-KYOCERA PAIN CHART - DATA ARRAY ;2/12/99
"RTN","GMRVKPN0",2,0)
 ;;4.0;Vitals/Measurements;**9**;Apr 25, 1997
"RTN","GMRVKPN0",3,0)
EN1 ;ENTRY POINT TO PRINT KYOCERA PAIN CHART 
"RTN","GMRVKPN0",4,0)
 ;S DFN=72,GMRSTRT=2990201,GMRFIN=2990215
"RTN","GMRVKPN0",5,0)
 S GMROUT=0 K ^TMP($J,"GMR"),^TMP($J,"GMRK"),^TMP($J,"GDT"),^TMP($J,"GMRVG"),^TMP($J,"GTNM") F GI=1:1:200 S ^TMP($J,"GMRK","G"_GI)=""
"RTN","GMRVKPN0",6,0)
 S GSTART1=(9999999-GMRFIN)-.0001,GEND1=9999999-GMRSTRT,^TMP($J,"GMRK","G50M")=0.4
"RTN","GMRVKPN0",7,0)
 F GTYPE="PN" D SETT^GMRVHPN0
"RTN","GMRVKPN0",8,0)
 U IO D GRAPH
"RTN","GMRVKPN0",9,0)
Q1 K GSOL,GIVDT,GMRHLOC,GMRVJ,GDATA,GDT,GEN,GEND1,GI,GJ,GK,GMRVX,GSTART1,GTNM,GTYP,GTYPE,GX,I D KVAR^VADPT K VA,VAROOT
"RTN","GMRVKPN0",10,0)
 K GMRRMBD,GAGE,GCNT,GDOB,GCNTB,GCNTD,GCNTP,GCNTR,GCNTT,GCNTT1,GCNTI,GCNTO,GDT1,GCNTPD,GCNTTD,GCNTW,GPG,GPGS,GTYPE1,GCNTB3,GDTA,XDT,XIO,XX,^TMP($J,"GMRK"),^TMP($J,"GMR"),^TMP($J,"GDT"),^TMP($J,"GMRVG")
"RTN","GMRVKPN0",11,0)
 K ^TMP($J,"GTNM") Q
"RTN","GMRVKPN0",12,0)
GRAPH D DEM^VADPT,INP^VADPT,SETV^GMRVGR1
"RTN","GMRVKPN0",13,0)
 S GK="PN",^TMP($J,"GTNM",GK)=0 F GI=0:0 S GI=$O(^TMP($J,"GMRVG",GK,GI)) Q:GI'>0  S GJ="" F X=0:0 S GJ=$O(^TMP($J,"GMRVG",GK,GI,GJ)) Q:GJ=""  S ^TMP($J,"GTNM",GK)=^TMP($J,"GTNM",GK)+1,^TMP($J,"GDT",GI)=""
"RTN","GMRVKPN0",14,0)
 S GTNM=0 F X=0:0 S X=$O(^TMP($J,"GDT",X)) Q:X'>0  S GTNM=GTNM+1
"RTN","GMRVKPN0",15,0)
 S GPG=$S(GTNM=0:1,1:GTNM\10+''(GTNM#10)),GDT1=0
"RTN","GMRVKPN0",16,0)
 F GPGS=1:1:GPG S ^TMP($J,"GMRK","G199")="Page "_GPGS D SETP,DATE S ^TMP($J,"GMRK","G200")=GMRRMBD D PAGE,^GMRVKPN1,^GMRVKPN2
"RTN","GMRVKPN0",17,0)
 D KVAR^VADPT K VA,GRAPHR,GRAPHP,GRAPHS,GRAPHD,GPA Q
"RTN","GMRVKPN0",18,0)
PAGE ;SET GRAPH DATA
"RTN","GMRVKPN0",19,0)
 ;DATA FOR PAIN CHART
"RTN","GMRVKPN0",20,0)
 F GI=50:1:59 S ^TMP($J,"GMRK","G50")=^TMP($J,"GMRK","G"_GI),^TMP($J,"GMRK","G50M")=0.4+(1.6*(GI-50)) Q:^TMP($J,"GMRK","G50")'=""
"RTN","GMRVKPN0",21,0)
 Q
"RTN","GMRVKPN0",22,0)
DATE F GCNTD=1:1:10 S:$L(GDT1) GDT1=$O(^TMP($J,"GDT",GDT1)) S ^TMP($J,"GMRK","G"_GCNTD)=$S($L(GDT1):$E(GDT1,4,5)_"-"_$E(GDT1,6,7)_"-"_$E(GDT1,2,3),1:"") D DATE1
"RTN","GMRVKPN0",23,0)
 Q
"RTN","GMRVKPN0",24,0)
DATE1 S Y=$E($P(GDT1,".",2)_"0000",1,4),^TMP($J,"GMRK","G"_(GCNTD+16))=$S($L(GDT1):$E(Y,1,2)_":"_$E(Y,3,4),1:"") D SETD
"RTN","GMRVKPN0",25,0)
 Q
"RTN","GMRVKPN0",26,0)
SETD S GI="PN" S GJ=48,GK=$S($L(GDT1):$O(^TMP($J,"GMRVG",GI,GDT1,"")),1:"") D SETA
"RTN","GMRVKPN0",27,0)
 Q
"RTN","GMRVKPN0",28,0)
SETP ;INITIALIZE ^TMP FOR QUALIFIERS
"RTN","GMRVKPN0",29,0)
 ; 410 - STORE P
"RTN","GMRVKPN0",30,0)
 ; 250+I - DATA
"RTN","GMRVKPN0",31,0)
 F I=1:1:10 S (^TMP($J,"GMRK","G"_(410+I)),^("G"_(250+I)))=""
"RTN","GMRVKPN0",32,0)
 Q
"RTN","GMRVKPN0",33,0)
SETA ;
"RTN","GMRVKPN0",34,0)
 I GK="Unavailable" S GK="Unavail"
"RTN","GMRVKPN0",35,0)
 S ^TMP($J,"GMRK","G"_(GJ+200+GCNTD+1))=GK
"RTN","GMRVKPN0",36,0)
 I (GK=99)!("PASSREFUSEDUNAVAIL"[$$UP^XLFSTR(GK)) S ^TMP($J,"GMRK","G"_(49+GCNTD))="" Q
"RTN","GMRVKPN0",37,0)
 S ^TMP($J,"GMRK","G"_(49+GCNTD))=12-GK
"RTN","GMRVKPN0",38,0)
 S ^TMP($J,"GMRK","G"_(410+GCNTD))="P"
"RTN","GMRVKPN0",39,0)
 Q
"RTN","GMRVKPN1")
0^19^B8663675
"RTN","GMRVKPN1",1,0)
GMRVKPN1 ;HCIOFO/YH-KYOCERA PAIN CHART MACRO-1 ;2/12/99
"RTN","GMRVKPN1",2,0)
 ;;4.0;Vitals/Measurements;**9**;Apr 25, 1997
"RTN","GMRVKPN1",3,0)
EN1 W !,"!R! RES; DAM;"
"RTN","GMRVKPN1",4,0)
BOX W !,"MCRO BOX;"
"RTN","GMRVKPN1",5,0)
 W !,"UNIT C; SLM 3; STM 1; MAP 0,0; SPD 0.05; BOX 16,13;"
"RTN","GMRVKPN1",6,0)
 W !,"FONT 40; MAP -2,0.5; TEXT 'Date/Time';"
"RTN","GMRVKPN1",7,0)
 W !,"SPD 0.01; MAP -0.5,2; TEXT '10'; MAP 0,1; DAP 16,1;MAP 16,1; DAP 0,1;"
"RTN","GMRVKPN1",8,0)
 W !,"MAP -0.5,3; TEXT '9'; MAP 0,2; DAP 16.2,2;"
"RTN","GMRVKPN1",9,0)
 W !,"MAP -0.5,4; TEXT '8'; MAP 0,3; DAP 16,3;"
"RTN","GMRVKPN1",10,0)
 W:GTNM=0 "MAP 2,5; TEXT 'THERE  IS  NO  DATA  FOR  THIS  PERIOD';"
"RTN","GMRVKPN1",11,0)
 W !,"MAP -0.5,5; TEXT '7'; MAP 0,4; DAP 16,4;"
"RTN","GMRVKPN1",12,0)
 W !,"MAP -0.5,6; TEXT '6';MAP 0,5; DAP 16,5;"
"RTN","GMRVKPN1",13,0)
 W !,"MAP -0.5,7; TEXT '5'; MAP 0,6; DAP 16,6;"
"RTN","GMRVKPN1",14,0)
 W !,"MAP -0.5,8; TEXT '4'; MAP 0,7; DAP 16,7;"
"RTN","GMRVKPN1",15,0)
 W !,"MAP -0.5,9; TEXT '3'; MAP 0,8; DAP 16,8;"
"RTN","GMRVKPN1",16,0)
 W !,"MAP -0.5,10; TEXT '2'; MAP -0.5,11; TEXT '1'; MAP 0,9; DAP 16,9;"
"RTN","GMRVKPN1",17,0)
 W !,"MAP 0,10; DAP 16,10;"
"RTN","GMRVKPN1",18,0)
 W !,"MAP 0,11; DAP 16,11;"
"RTN","GMRVKPN1",19,0)
 W !,"MAP -1,12.7; TEXT 'Pain';"
"RTN","GMRVKPN1",20,0)
VERT W !,"SPD 0.05;" S I(1)="" F I=1:1:9 S I(1)=I(1)_"MAP "_(1.6*I)_",0; DAP "_(1.6*I)_",13;"
"RTN","GMRVKPN1",21,0)
 W !,I(1) W !,"MAP 16,12; DAP 0,12;"
"RTN","GMRVKPN1",22,0)
 W !,"MAP 0,13.5; TEXT '0 - No pain   10 - Worst imaginable pain   99 - Unable to respond';"
"RTN","GMRVKPN1",23,0)
FORM W !,"MAP 12,22.4; TEXT 'Medical Record'; MAP 12,22.8; TEXT 'Pain Chart'; MAP 12,23.2; TEXT 'SF 512';"
"RTN","GMRVKPN1",24,0)
 W !,"ENDM;"
"RTN","GMRVKPN1",25,0)
DATE W !,"MCRO DATE; FONT 56;" S J=0.4 D WRTEXT^GMRVBP2
"RTN","GMRVKPN1",26,0)
 W !,"ENDM;"
"RTN","GMRVKPN1",27,0)
TIME W !,"MCRO TIME;" S J=0.8 D WRTEXT^GMRVBP2
"RTN","GMRVKPN1",28,0)
 W !,"ENDM;"
"RTN","GMRVKPN1",29,0)
RPG W !,"MCRO RPG; SPD 0.03; MAP %1, %2; DAP 2, %3; DAP 3.6, %4; DAP 5.2, %5; DAP 6.8, %6; DAP 8.4, %7; DAP 10, %8; DAP 11.6, %9;"
"RTN","GMRVKPN1",30,0)
 W !,"DAP 13.2, %10; DAP 14.8, %11;"
"RTN","GMRVKPN1",31,0)
 W !,"ENDM;"
"RTN","GMRVKPN1",32,0)
RESP W !,"MCRO RSP;" S J=12.7 D
"RTN","GMRVKPN1",33,0)
 . S I(1)="" F I=1:1:5 S I(1)=I(1)_$S(I(1)="":"",1:" ")_"MAP "_(1.6*(I-1)+0.2)_","_J_"; TEXT %"_I_";"
"RTN","GMRVKPN1",34,0)
 . W !,I(1)
"RTN","GMRVKPN1",35,0)
 . S I(1)="" F I=6:1:10 S I(1)=I(1)_$S(I(1)="":"",1:" ")_"MAP "_(1.6*(I-1)+0.2)_","_J_"; TEXT %"_I_";"
"RTN","GMRVKPN1",36,0)
 . W !,I(1)
"RTN","GMRVKPN1",37,0)
 W !,"ENDM;"
"RTN","GMRVKPN1",38,0)
PID W !,"MCRO PID; MAP -2,21.6; TEXT %1; MAP -2,22; TEXT %2; MAP 2.5,22; TEXT %3; MAP -2,22.4; TEXT %4; MAP 6,23.2; TEXT %5; MAP 6,22.8; TEXT %6; MAP -2,22.8; TEXT %7; MAP -2,23.2; TEXT %8;"
"RTN","GMRVKPN1",39,0)
 W !,"ENDM;"
"RTN","GMRVKPN1",40,0)
RS1 W !,"MCRO RS1; MAP %1,%2; TEXT %3; MAP 2.0,%4; TEXT %5; MAP 3.6,%6; TEXT %7; MAP 5.2,%8; TEXT %9; MAP 6.8,%10; TEXT %11; MAP 8.4,%12; TEXT %13; MAP 10,%14; TEXT %15; MAP 11.6,%16; TEXT %17; MAP 13.2,%18; TEXT %19;"
"RTN","GMRVKPN1",41,0)
 W !,"ENDM;"
"RTN","GMRVKPN1",42,0)
RS2 W !,"MCRO RS2; MAP 14.8,%1; TEXT %2;"
"RTN","GMRVKPN1",43,0)
 W !,"ENDM;"
"RTN","GMRVKPN1",44,0)
 Q
"RTN","GMRVKPN2")
0^20^B4130317
"RTN","GMRVKPN2",1,0)
GMRVKPN2 ;HCIOFO/YH-KYOCERA KYOCERA PAIN CHART PRINT COMMANDS (PART 1) ;2/12/99
"RTN","GMRVKPN2",2,0)
 ;;4.0;Vitals/Measurements;**9**;Apr 25, 1997
"RTN","GMRVKPN2",3,0)
EN3 ;CONTINUATION OF GMRVKPO3
"RTN","GMRVKPN2",4,0)
CALL W !,"CALL BOX, '%';"
"RTN","GMRVKPN2",5,0)
 W !,"CALL DATE" S J(1)=1,J(2)=J(1)+9 D WRTCALL
"RTN","GMRVKPN2",6,0)
 W !,"CALL TIME" S J(1)=17,J(2)=J(1)+9 D WRTCALL
"RTN","GMRVKPN2",7,0)
 W !,"CALL RPG, "_^TMP($J,"GMRK","G50M")_", "_^("G50")_", "_^("G51")_", "_^("G52")_", "_^("G53")_", "_^("G54")_", "_^("G55")_", "_^("G56")
"RTN","GMRVKPN2",8,0)
 W ", "_^TMP($J,"GMRK","G57")_", "_^("G58")_", "_^("G59")_";"
"RTN","GMRVKPN2",9,0)
 W !,"CALL RS1, "_^TMP($J,"GMRK","G50M")_", "_^("G50")_", '"_^("G411")_"', "_^("G51")_", '"_^("G412")_"', "_^("G52")_", '"_^("G413")_"', "_^("G53")_", '"_^("G414")_"', "_^("G54")_", '"_^("G415")_"', "_^("G55")_", '"_^("G416")_"', "
"RTN","GMRVKPN2",10,0)
 W ^TMP($J,"GMRK","G56")_", '"_^("G417")_"', "_^("G57")_", '"_^("G418")_"', "_^("G58")_", '"_^("G419")_"';"
"RTN","GMRVKPN2",11,0)
 W !,"CALL RS2, "_^TMP($J,"GMRK","G59")_", '"_^("G420")_"';"
"RTN","GMRVKPN2",12,0)
 W !,"CALL RSP" S J(1)=250,J(2)=J(1)+9 D WRTCALL
"RTN","GMRVKPN2",13,0)
 W !,"CALL PID, """_^TMP($J,"GMRK","G194")_""", '"_^("G196")_"', '"_^("G197")_"', '"_^("G198")_"', '"_^("G199")_"', '"_^("G200")_"', '"_GMRDIV_"', '"_GSTRFIN_"';"
"RTN","GMRVKPN2",14,0)
 W !,"RES; EXIT;"
"RTN","GMRVKPN2",15,0)
 Q
"RTN","GMRVKPN2",16,0)
WRTCALL S I(1)="" F I=J(1):1:J(2) S I(1)=I(1)_", '"_^TMP($J,"GMRK","G"_I)_"'"
"RTN","GMRVKPN2",17,0)
 W I(1)_";"
"RTN","GMRVKPN2",18,0)
 Q
"RTN","GMRVSR0")
0^24^B33698939
"RTN","GMRVSR0",1,0)
GMRVSR0 ;HIRMFO/RM,YH-VITAL SIGNS RECORD SF 511 ;2/12/99  12:25
"RTN","GMRVSR0",2,0)
 ;;4.0;Vitals/Measurements;**1,3,7,9**;Apr 25, 1997
"RTN","GMRVSR0",3,0)
EN1 ; ENTRY POINT FROM OPTION GMRV SF511, SELECT TYPE OF GRAPH FOR THE REPORT
"RTN","GMRVSR0",4,0)
 S (GMRVWLOC,GMROUT,GFLAG,GRAPH)=0 D SELECT^GMRVSR1(.GRAPH) I GRAPH'>0 K GFLAG,GMROUT,GRAPH,GMRVWLOC Q
"RTN","GMRVSR0",5,0)
 D WARDPAT^GMRVED0 I GMROUT D Q1 K GFLAG,GMREDB,GMROUT,GMRWARD,DFN,GRAPH Q
"RTN","GMRVSR0",6,0)
PAT I "Pp"[GMREDB D DEM^VADPT S GMRNAM=$P(VADM(1),"^"),SSN=$P(VADM(2),"^",2)
"RTN","GMRVSR0",7,0)
 I "Ss"[GMREDB D EN3^GMRVED6
"RTN","GMRVSR0",8,0)
 I GMROUT D Q1 K GMREDB,GFLAG,GMROUT,GMRWARD,GRAPH Q
"RTN","GMRVSR0",9,0)
DATE S %DT("A")="Start DATE (TIME optional): ",%DT("B")="T-7",%DT="AETX" D ^%DT K %DT G:+Y'>0 Q1 S GMRSTRT=+Y
"RTN","GMRVSR0",10,0)
 S %DT("A")="go to DATE (TIME optional): ",%DT="AETX",%DT("B")="NOW" D ^%DT K %DT G:+Y'>0 Q1 I $P(Y,".",2)'>0,Y=DT D NOW^%DTC S Y=%
"RTN","GMRVSR0",11,0)
 I $P(Y,".",2)'>0 S Y=Y_$S(Y[".":"2400",1:".2400")
"RTN","GMRVSR0",12,0)
 S (X1,GMRFIN)=+Y,X2=GMRSTRT D ^%DTC
"RTN","GMRVSR0",13,0)
 I X<0!(X=0&(((+("."_$P(GMRFIN,".",2))*10000)-((+("."_$P(GMRSTRT,".",2))*10000)))'>0)) W !?5,"Ending date of range needs to be greater that starting date.",!?5,$C(7),"PLEASE REENTER!!" G DATE
"RTN","GMRVSR0",14,0)
 D DATELN
"RTN","GMRVSR0",15,0)
DEV S %ZIS="NQ",%ZIS("B")=""
"RTN","GMRVSR0",16,0)
 W ! D ^%ZIS G:POP Q1
"RTN","GMRVSR0",17,0)
 N GMRVDEV S GMRVDEV=ION_";"_IOST_";"_IOM_";"_IOSL
"RTN","GMRVSR0",18,0)
 I IOM'>131 W !!,"Sorry, you must select a DEVICE that can print 132 columns. Try again." G DEV ;device must be 132 columns
"RTN","GMRVSR0",19,0)
 I '$D(IO("Q")) S IOP=GMRVDEV K %ZIS D ^%ZIS G Q1:POP,EN2:"Pp"[GMREDB,EN3
"RTN","GMRVSR0",20,0)
 I $D(IO("Q")) S ZTDESC="V/M GRAPHIC REPORTS",ZTIO=GMRVDEV,ZTRTN=$S("Pp"[GMREDB:"EN2^GMRVSR0",1:"EN3^GMRVSR0") F G="GRAPH","GMROUT","DFN","GMRROOM(","GMREDB","GMRNAM","SSN","GMRWARD","GMRSTRT","GMRFIN","GMRWARD(","GFLAG","GSTRFIN" S ZTSAVE(G)=""
"RTN","GMRVSR0",21,0)
 I $D(IO("Q")) D ^%ZTLOAD,HOME^%ZIS K ZTSK,ZTIO,DFN,GMRLEN,GMRRMST,GMRIFN,GMROUT,GMRSTRT,GMRVLOC,GMRWARD D Q1,Q2 Q
"RTN","GMRVSR0",22,0)
 G:'("Pp"[GMREDB) EN3
"RTN","GMRVSR0",23,0)
EN2 ; ENTRY TO PRINT THIS REPORT AFTER IT HAS BEEN QUEUED
"RTN","GMRVSR0",24,0)
 ;  NOTE:  THIS REPORT MUST BE QUEUED TO A PRINTER.
"RTN","GMRVSR0",25,0)
 N GAPICAL,GRADIAL S GAPICAL=$O(^GMRD(120.52,"B","APICAL",0)),GRADIAL=$O(^GMRD(120.52,"B","RADIAL",0))
"RTN","GMRVSR0",26,0)
 I IOST["KYOCERA"!(IOST["Kyocera") S GROUTN=$S(GRAPH=1:"EN1^GMRVGR0",GRAPH=2:"EN1^GMRVBP0",GRAPH=3:"EN1^GMRVWT0",GRAPH=4:"EN1^GMRVKPO0",GRAPH=5:"^GMRVKPN0",1:"") D:GROUTN'="" @GROUTN G:"Pp"[GMREDB Q1 Q
"RTN","GMRVSR0",27,0)
 I $$UP^XLFSTR(IOST)["HPLASER" S GROUTN=$S(GRAPH=1:"EN1^GMRVHG0",GRAPH=2:"EN1^GMRVHB0",GRAPH=3:"EN1^GMRVHW0",GRAPH=4:"EN1^GMRVHPO0",GRAPH=5:"EN1^GMRVHPN0",1:"") D:GROUTN'="" @GROUTN G:"Pp"[GMREDB Q1 Q
"RTN","GMRVSR0",28,0)
 I GRAPH=2 D ^GMRVLBP0 G:"Pp"[GMREDB Q1 Q
"RTN","GMRVSR0",29,0)
 I GRAPH=3 D ^GMRVLWT0 G:"Pp"[GMREDB Q1 Q
"RTN","GMRVSR0",30,0)
 I GRAPH=4 D ^GMRVLPO0 G:"Pp"[GMREDB Q1 Q
"RTN","GMRVSR0",31,0)
 I GRAPH=5 W !!,"Sorry, you must select a Kyocera or HP Laser printer for the Pain Chart." S:'$G(GMRPERR) GMRPERR=1 G:"Pp"[GMREDB Q1 Q
"RTN","GMRVSR0",32,0)
 S GMRS=(9999999-GMRFIN)-.0001,GMRQ=9999999-GMRSTRT
"RTN","GMRVSR0",33,0)
 F GMRTY="B","P","R","T","H","W","PO2","CVP","CG","PN" D SETT^GMRVSR1
"RTN","GMRVSR0",34,0)
 U IO D SF511^GMRVSR1
"RTN","GMRVSR0",35,0)
Q1 K J,G,GMR,GMR3,GMRDAT,GMRDT,GMREN,GMRHDR1,GMRHDR10,GMRHDR11,GMRHDR2,GMRHT,GMRI,GMRJ,GMRK,GMRLINE,GMRMSL,GMRNM,GMROLD,GMRP,GMRPDIF,GMRT,GMRX,GMRTY,GMRPG,GMRPGC,GMRPGS,GMRPHI,GMRPLO,GMRTDIF,GMRTHI,GMRTLO,GMRTNM,GMRX1,GMRX2 D KVAR^VADPT K VA,%T
"RTN","GMRVSR0",36,0)
 K GVAR,GMRDIV,GMRHT,GMRQUAL,GMRS,GMRQ,GMRPOFF,GMRTOFF,GMRVWLOC,GMRVX,DIK,%ZIS,%DT,DIPGM,GMRLEN,GMRRMST,GMRVHLOC,GDA,GMRINF,GLINE,GMRVARY,GMRPERR
"RTN","GMRVSR0",37,0)
 W:$E(IOST)="P"!$D(IO("S"))&($$UP^XLFSTR(IOST)'["HPLASER") ! Q:'("Pp"[GMREDB)
"RTN","GMRVSR0",38,0)
Q2 S:$D(ZTQUEUED) ZTREQ="@" K ^TMP($J),GMRII,GMRQUAL,GMREDB,GMROUT,GMRROOM,GMRSTRT,GMRFIN,GMRNAM,GMRRMBD,GMRSITE,GMRVHLOC,GMRWARD,POP,SSN,DFN,ZTIO,ZTSK,GDT,GDTA,GFOUND,GMRAGE,GMRBED,GMRBTH,GMRCOL,GMRHLOC,GMROP,GMRSEX,GMRVADM,GRPT,GSUB,GTYPE1
"RTN","GMRVSR0",39,0)
 K GSTRFIN,GMRVFLAG,SNN,GMVRMBD,GMVWRD,GRAPH,GROUTN,GIVDT,GSTAR,GSOL,GN,GNDATE,GNSHFT,GFLAG,ZTSAVE,ZTRTN W:$E(IOST)'="C"&(IOST'["KYOC"!(IOST'["Kyoc")!(IOST'["kyoc")!($$UP^XLFSTR(IOST)'["HPLASER")) @IOF D ^%ZISC Q
"RTN","GMRVSR0",40,0)
EN3 ; ENTRY TO PRINT REPORT FOR ALL OR SELECTED GROUP OF PATIENTS, FOR WARD STORED IN GMRWARD
"RTN","GMRVSR0",41,0)
 S GMRPERR=0
"RTN","GMRVSR0",42,0)
 D EN1^GMRVED2 S GMRROOM="" F GMRII=0:0 S GMRROOM=$O(^TMP($J,GMRROOM)) Q:GMRROOM=""  S GMRNAM="" F GMRII=0:0 S GMRNAM=$O(^TMP($J,GMRROOM,GMRNAM)) Q:GMRNAM=""  F DFN=0:0 S DFN=$O(^TMP($J,GMRROOM,GMRNAM,DFN)) Q:DFN'>0  D:DFN>0 PRT
"RTN","GMRVSR0",43,0)
 D Q1 G Q2
"RTN","GMRVSR0",44,0)
PRT ;
"RTN","GMRVSR0",45,0)
 D DEM^VADPT S SSN=$P(VADM(2),"^",2) Q:$G(GMRPERR)&('$D(IO("Q")))  D EN2
"RTN","GMRVSR0",46,0)
 Q
"RTN","GMRVSR0",47,0)
EN4 ; ENTRY POINT IF DFN IS KNOWN TO PRINT THIS REPORT
"RTN","GMRVSR0",48,0)
 Q:'$D(DFN)  S GRAPH=1,GMREDB="P",GMROUT=0,GMRVHLOC=+ORL D INP^VADPT S GMRWARD(1)=$P(VAIN(4),"^",2),GMRWARD=$P(VAIN(4),"^") G PAT
"RTN","GMRVSR0",49,0)
 Q
"RTN","GMRVSR0",50,0)
EN5 ; ENTRY POINT FOR APPLICATION TO GET REPORT. INPUT VARIABLES:
"RTN","GMRVSR0",51,0)
 ;    DFN=PATIENT NUMBER
"RTN","GMRVSR0",52,0)
 ;    GMRDATE=START DATE^FINISH DATE OF REPORT^TYPE OF GRAPH
"RTN","GMRVSR0",53,0)
 ;    (OPTIONAL) GMRVWLO=LOCATION GROUPING OF PATIENT IF DIFFERENT HAN 42 FILE
"RTN","GMRVSR0",54,0)
 Q:'$D(DFN)!'$D(GMRDATE)!(DFN'>0)  Q:'$P(GMRDATE,"^")!'$P(GMRDATE,"^",2)  S GMREDB="A",GMROUT=0,GMRSTRT=$P(GMRDATE,"^"),GMRFIN=$P(GMRDATE,"^",2) D INP^VADPT S GMRWARD(1)=$S($D(GMRVWLO):GMRVWLO,1:$P(VAIN(4),"^",2)),GMRWARD=$P(VAIN(4),"^")
"RTN","GMRVSR0",55,0)
 D DATELN S GRAPH=$S($P(GMRDATE,"^",3)>0:+$P(GMRDATE,"^",3),1:1) D EN2 Q
"RTN","GMRVSR0",56,0)
EN6(DFN,GMRDATE) ; APPLICATION PROGRAM INTERFACE FOR SINGLE PATIENT REPORT. INPUT VARIABLES:    DFN=PATIENT NUMBER
"RTN","GMRVSR0",57,0)
 ;               GMRDATE=START DATE^FINISH DATE OF REPORT
"RTN","GMRVSR0",58,0)
 Q:'$D(DFN)!'$D(GMRDATE)  Q:'$P(GMRDATE,U)!'$P(GMRDATE,U,2)  S GMREDB="P",GMROUT=0,GMRSTRT=$P(GMRDATE,U),GMRFIN=$P(GMRDATE,U,2) D DEM^VADPT,INP^VADPT S SSN=VA("PID"),GMRWARD=$P(VAIN(4),U),GMRWARD(1)=$P(VAIN(4),U,2)
"RTN","GMRVSR0",59,0)
 I IOM'>130 D  Q
"RTN","GMRVSR0",60,0)
 .S GMRVDVIC=$E(IOST) ;device type chosen by user (e.g., 'C')
"RTN","GMRVSR0",61,0)
 .D ^%ZISC
"RTN","GMRVSR0",62,0)
 .W !,"THIS REPORT NEEDS 132 COLUMNS",!
"RTN","GMRVSR0",63,0)
 .I GMRVDVIC'="C" H 3 ;if device is not a terminal hang 3 seconds
"RTN","GMRVSR0",64,0)
 .K GMRVDVIC
"RTN","GMRVSR0",65,0)
 .Q
"RTN","GMRVSR0",66,0)
 D DATELN S GRAPH=$S($P(GMRDATE,"^",3)>0:+$P(GMRDATE,"^",3),1:1) D EN2 Q
"RTN","GMRVSR0",67,0)
DATELN ;
"RTN","GMRVSR0",68,0)
 S Y=GMRSTRT X ^DD("DD") S GSTRFIN=Y S Y=GMRFIN X ^DD("DD") S GSTRFIN=GSTRFIN_" - "_Y Q
"RTN","GMRVSR1")
0^25^B26289693
"RTN","GMRVSR1",1,0)
GMRVSR1 ;HIRMFO/RM,YH-PATIENT VITAL SIGNS-I/O SF 511 GRAPH - 1 ;2/7/99
"RTN","GMRVSR1",2,0)
 ;;4.0;Vitals/Measurements;**1,7,9**;Apr 25, 1997
"RTN","GMRVSR1",3,0)
SF511 ;PRODUCE PATIENT VITAL SIGNS-I/O GRAPH
"RTN","GMRVSR1",4,0)
 S GRPT=5,GMRHT=0 D SETIO^GMRVGR0 D DEM^VADPT,INP^VADPT S GMRBTH=$P(VADM(3),"^",2),GMRNAM=VADM(1)
"RTN","GMRVSR1",5,0)
 F GMRK="P","T","B","H","W","R","PO2","CVP","CG","XI1","PN" D GMRDT^GMRVVS3
"RTN","GMRVSR1",6,0)
 I $D(^TMP($J,"GMRVG","I")) F GMRI=0:0 S GMRI=$O(^TMP($J,"GMRVG","I",GMRI)) Q:GMRI'>0  S GFOUND=0 D CKDT^GMRVVS3 S:GFOUND=0 ^TMP($J,"GMRDT",GMRI)=""
"RTN","GMRVSR1",7,0)
 I $D(^TMP($J,"GMRVG","O")) F GMRI=0:0 S GMRI=$O(^TMP($J,"GMRVG","O",GMRI)) Q:GMRI'>0  S GFOUND=0 D CKDT^GMRVVS3 S:GFOUND=0 ^TMP($J,"GMRDT",GMRI)=""
"RTN","GMRVSR1",8,0)
 S (GMRTNM,GMRI)=0 I $D(^TMP($J,"GMRDT")) F  S GMRI=$O(^TMP($J,"GMRDT",GMRI)) Q:GMRI'>0  S GMRTNM=GMRTNM+1
"RTN","GMRVSR1",9,0)
 D GRAPH K GMR3,GMRDAT,GMREN,GMRHDR1,GMRHDR11,GMRHDR10,GMRHDR2,GMRHT,GMRI,GMRJ,GMRK,GMRLINE,GDATA,GMROLD,GMRP,GMRPDIF,GMRPG,GMRPGC,GMRPGS,GMRPHI,GMRPLO,GMRPOFF,GMRSITE,GMRT,GMRTDIF,GMRTHI,GMRTLO,GMRTNM
"RTN","GMRVSR1",10,0)
 K GLPRNTR,GMRTOFF,GMRTY,GMRNM,GMRVX,GMRVX1,GMRVX2,^TMP($J,"GMRDT"),^TMP($J,"GMRG"),^TMP($J,"GMR")
"RTN","GMRVSR1",11,0)
 Q
"RTN","GMRVSR1",12,0)
GRAPH ;
"RTN","GMRVSR1",13,0)
 S:'$D(GFLAG) GFLAG=0 S GMRPGC=0,GMRX1="" F X=1:1:10 S GMRX1=GMRX1_"          "_"|"
"RTN","GMRVSR1",14,0)
 S (GMRX,GMRX2)=GMRX1 F X=1:1:10 S $P(GMRX,"|",X)="__________",$P(GMRX2,"|",X)="----------"
"RTN","GMRVSR1",15,0)
 S GMRPG=$S(GMRTNM=0:1,1:GMRTNM\10+$S(GMRTNM#10>0:1,1:0)) F GMRPGS=1:1:GMRPG S GMRTLO=105.8335,GMRPLO=168.335 D PAGE Q:GMROUT
"RTN","GMRVSR1",16,0)
 K GDIP,GDOP,GRNDIP,GRNDOP,GSIP,GSOP Q
"RTN","GMRVSR1",17,0)
PAGE ;
"RTN","GMRVSR1",18,0)
 K GMRQUAL,GLINE W:'($E(IOST)'="C"&'GFLAG) @IOF S GFLAG=1,GMRPGC=GMRPGC+1 W !
"RTN","GMRVSR1",19,0)
 I '$D(^TMP($J,"GMR")) W !!!!!!!!,?5,"THERE  IS  NO  DATA  FOR  THIS  REPORT" X "F Y=$Y:1:(IOSL-6) W !" D FOOTER^GMRVVS2 Q
"RTN","GMRVSR1",20,0)
 W ! D DATES^GMRVVS2 W !,?3,"Pulse Temp/F/C",?17,"|",?18,GMRX
"RTN","GMRVSR1",21,0)
 F GMRI=0:0 Q:$Y>43  W ! D SETHD^GMRVVS4 W ?2,$S(GMRHDR1'["41.1":GMRHDR1,1:""),?16,$S(GMR3!($Y=28):"-",1:""),?17,"|" D DATAPRT^GMRVVS4
"RTN","GMRVSR1",22,0)
 W !,?17,"|",GMRX2 F GMRI="T","P","R","B","B1","B2","W","H","PO2","CVP","CG","PN" S GMRLINE(GMRI)=GMRX1
"RTN","GMRVSR1",23,0)
 S (GMRLINE("H1"),GMRLINE("W1"),GMRLINE("BMI"),GMRLINE("P1"),GMRLINE("OX1"),GMRLINE("OX2"),GMRLINE("OX3"),GMRLINE("CVP1"),GMRLINE("CG1"),GMRLINE("CG2"))=GMRX1
"RTN","GMRVSR1",24,0)
 S GMRNM=0 F GMRDT=0:0 S GMRDT=$O(^TMP($J,"GMRDT",GMRDT)) Q:GMRDT'>0  S GMRNM=GMRNM+1 Q:GMRNM>10  F GMRI="T","P","R","H","W","PO2","CVP","CG","PN" D:$D(^TMP($J,"GMR",GMRI,GMRDT)) STLNP^GMRVVS1
"RTN","GMRVSR1",25,0)
 S GMRNM=0 F GMRDT=0:0 S GMRDT=$O(^TMP($J,"GMRDT",GMRDT)) Q:GMRDT'>0  S GMRNM=GMRNM+1 Q:GMRNM>10  D BP^GMRVVS2
"RTN","GMRVSR1",26,0)
 F GMRI="T","P","P1","R","PO2","OX1","OX2","OX3","B","B1","B2","W","W1","BMI","H","H1","CG","CG2","CVP","CVP1" D
"RTN","GMRVSR1",27,0)
 .S G=$S(GMRI="T":"Temperature",GMRI="P":"Pulse",GMRI="R":"Respiration",GMRI="W":"Weight (lb)",GMRI="H":"Height (in)",GMRI="B":"BLOOD",GMRI="B1":"  PRESSURE",GMRI="W1":"       (kg)",GMRI="H1":"       (cm)",GMRI="BMI":"Body Mass Index",1:"")
"RTN","GMRVSR1",28,0)
 . I G="" S G=$S(GMRI="PO2":"Pulse Ox.",GMRI="OX1":"  L/Min",GMRI="OX2":"  %",GMRI="OX3":"  Method",GMRI="CG":"C/G (in)",GMRI="CVP":"CVP (cm H2O)",GMRI="CVP1":"    (mm Hg)",GMRI="CG2":"    (cm)",1:"")
"RTN","GMRVSR1",29,0)
 . W !,G,?17,"|",GMRLINE(GMRI)
"RTN","GMRVSR1",30,0)
 D IO
"RTN","GMRVSR1",31,0)
 S G="Pain" W !,G,?17,"|",GMRLINE("PN")
"RTN","GMRVSR1",32,0)
 I 'GMROUT W !,?17,$$REPEAT^XLFSTR("-",111)
"RTN","GMRVSR1",33,0)
 W !,"T: Temperature     P: Pulse     C/G: Circumference/Girth     * - Abnormal value     ** - Abnormal value off of graph"
"RTN","GMRVSR1",34,0)
 W !,"Pain:  99 - Unable to respond  0 - No pain  10 - Worst imaginable pain"
"RTN","GMRVSR1",35,0)
 W ! I $D(GMRQUAL) S GLPRNTR=1 D LEGEND^GMRVLGQU F I=1:1:5 W !,GLINE(I)
"RTN","GMRVSR1",36,0)
 I IOSL'<($Y+10) F X=1:1 W ! Q:IOSL<($Y+10)
"RTN","GMRVSR1",37,0)
 D FOOTER^GMRVVS2 S GMRDT="" F GMRNM=1:1:10 S GMRDT=$O(^TMP($J,"GMRDT",GMRDT)) Q:GMRDT'>0  K ^TMP($J,"GMRDT",GMRDT)
"RTN","GMRVSR1",38,0)
 K GG,GI,GMRVJ,GSYNO Q
"RTN","GMRVSR1",39,0)
IO ;PRINT INTAKE/OUTPUT SECTION OF VITAL SIGNS-I/O SHEET
"RTN","GMRVSR1",40,0)
 S (GMRLINE("I"),GMRLINE("O"))=GMRX1
"RTN","GMRVSR1",41,0)
 S GMRNM=0 F GMRDT=0:0 S GMRDT=$O(^TMP($J,"GMRDT",GMRDT)) Q:GMRDT'>0  S GMRNM=GMRNM+1 Q:GMRNM>10  S GDT=+$E(GMRDT,1,7) I $D(^TMP($J,"GMRVG","I",GDT))!($D(^TMP($J,"GMRVG","O",GDT))) D SETDATA
"RTN","GMRVSR1",42,0)
 W !,"Intake(24 Hr)(cc)",?17,"|",GMRLINE("I")
"RTN","GMRVSR1",43,0)
 W !,"Output(24 Hr)(cc)",?17,"|",GMRLINE("O")
"RTN","GMRVSR1",44,0)
 Q
"RTN","GMRVSR1",45,0)
SETDATA ; FILL GMRLINE WITH I/O DATA AND WRITE GMRLINE
"RTN","GMRVSR1",46,0)
 I $D(^TMP($J,"GMRVG","I",GDT)) S GDATA=$O(^(GDT,0)) S:GDATA>0 $P(GMRLINE("I"),"|",GMRNM)=$E(GDATA_"          ",1,10) K ^TMP($J,"GMRVG","I",GDT)
"RTN","GMRVSR1",47,0)
 I $D(^TMP($J,"GMRVG","O",GDT)) S GDATA=$O(^(GDT,0)) S:GDATA>0 $P(GMRLINE("O"),"|",GMRNM)=$E(GDATA_"          ",1,10) K ^TMP($J,"GMRVG","O",GDT)
"RTN","GMRVSR1",48,0)
 Q
"RTN","GMRVSR1",49,0)
SELECT(J) ;TYPE OF GRAPH FOR REPORT
"RTN","GMRVSR1",50,0)
 N X,I W !
"RTN","GMRVSR1",51,0)
TRYAGN F I=1:1:5 W !,?2,I_"  "_$P($T(GCHART+I),";;",2)
"RTN","GMRVSR1",52,0)
 W !!,?2,"Select a number between 1 and 5: 1  Vital Signs Record// " S X="" R X:DTIME I '$T!(X["^") S J=0 Q
"RTN","GMRVSR1",53,0)
 I X="" S J=1 Q
"RTN","GMRVSR1",54,0)
 I $L(X)>2 G TRYAGN
"RTN","GMRVSR1",55,0)
 I '(X?1N&(X>0&(X<6)))!(X["?") W !!,"Enter the number for the graph you wish to print.",!,"The default is Vital Signs Record.",! G TRYAGN
"RTN","GMRVSR1",56,0)
 W "  ",$P($T(GCHART+X),";;",2) S J=X Q
"RTN","GMRVSR1",57,0)
 Q
"RTN","GMRVSR1",58,0)
WRT1 W !!,?5,$C(7),"This report must be queued to a 132 column printer.",!!
"RTN","GMRVSR1",59,0)
 Q
"RTN","GMRVSR1",60,0)
SETT ; SET GMRT
"RTN","GMRVSR1",61,0)
 D SETT^GMRVSR2 Q
"RTN","GMRVSR1",62,0)
GCHART ;
"RTN","GMRVSR1",63,0)
 ;;Vital Signs Record
"RTN","GMRVSR1",64,0)
 ;;B/P Plotting Chart
"RTN","GMRVSR1",65,0)
 ;;Weight Chart
"RTN","GMRVSR1",66,0)
 ;;Pulse Oximetry/Respiratory Graph
"RTN","GMRVSR1",67,0)
 ;;Pain Chart
"RTN","GMRVSR2")
0^26^B6329687
"RTN","GMRVSR2",1,0)
GMRVSR2 ;HIRMFO/YH-PATIENT VITAL SIGNS-I/O SF 511 GRAPH - 2 ;5/8/97
"RTN","GMRVSR2",2,0)
 ;;4.0;Vitals/Measurements;**1,9**;Apr 25, 1997
"RTN","GMRVSR2",3,0)
SETT ; SET GMRT
"RTN","GMRVSR2",4,0)
 S GMRT(1)=$S(GMRTY="B":"BLOOD PRESSURE",GMRTY="P":"PULSE",GMRTY="R":"RESPIRATION",GMRTY="T":"TEMPERATURE",GMRTY="H":"HEIGHT",GMRTY="W":"WEIGHT",GMRTY="CG":"CIRCUMFERENCE/GIRTH",GMRTY="PO2":"PULSE OXIMETRY",1:"")
"RTN","GMRVSR2",5,0)
 I GMRT(1)="" S GMRT(1)=$S(GMRTY="CVP":"CENTRAL VENOUS PRESSURE",1:"")
"RTN","GMRVSR2",6,0)
 I GMRT(1)="" S GMRT(1)=$S(GMRTY="PN":"PAIN",1:"")
"RTN","GMRVSR2",7,0)
 Q:GMRT(1)=""
"RTN","GMRVSR2",8,0)
 S GMRT=$O(^GMRD(120.51,"B",GMRT(1),""))
"RTN","GMRVSR2",9,0)
 I GMRT>0 F GMRX=GMRS:0 S GMRX=$O(^GMR(120.5,"AA",DFN,GMRT,GMRX)) Q:GMRX>GMRQ!(GMRX'>0)  F GMREN=0:0 S GMREN=$O(^GMR(120.5,"AA",DFN,GMRT,GMRX,GMREN)) Q:GMREN'>0  I '$D(^GMR(120.5,GMREN,2)) D BLDARR
"RTN","GMRVSR2",10,0)
 Q
"RTN","GMRVSR2",11,0)
BLDARR ; BUILD DATA ARRAY
"RTN","GMRVSR2",12,0)
 S GMRDAT=$S($D(^GMR(120.5,GMREN,0)):^(0),1:""),GMRVX=GMRTY,GMRVX(0)=$P(GMRDAT,"^",8) D:GMRVX(0)>0!(GMRVX(0)<0)!($E(GMRVX(0))="0") EN1^GMRVSAS0
"RTN","GMRVSR2",13,0)
 K GMRVARY S GMRVARY="" I $P($G(^GMR(120.5,GMREN,5,0)),"^",4)>0 D CHAR^GMRVCHAR(GMREN,.GMRVARY,GMRT)
"RTN","GMRVSR2",14,0)
 K GG S GG="" I $O(GMRVARY(0)) D
"RTN","GMRVSR2",15,0)
 . S GG(1)=0 F  S GG(1)=$O(GMRVARY(GG(1))) Q:GG(1)'>0  S GG(2)=0 F  S GG(2)=$O(GMRVARY(GG(1),GG(2))) Q:GG(2)'>0  S GG(3)="" F  S GG(3)=$O(GMRVARY(GG(1),GG(2),GG(3))) Q:GG(3)=""  S GG=GG_$S(GG="":"",1:";")_GG(3)
"RTN","GMRVSR2",16,0)
 S ^TMP($J,"GMR",GMRTY,9999999-GMRX,$P(GMRDAT,"^",8))=GG_"^"_$S('$D(GMRVX(1)):"",'GMRVX(1):"",1:1)_"^^"_$P(GMRDAT,"^",10)
"RTN","GMRVSR2",17,0)
 K GG Q
"RTN","GMRVVS1")
0^27^B25108394
"RTN","GMRVVS1",1,0)
GMRVVS1 ;HIRMFO/YH-PATIENT VITAL SIGNS-I/O SF 511 GRAPH - 1 ;3/17/97
"RTN","GMRVVS1",2,0)
 ;;4.0;Vitals/Measurements;**1,9**;Apr 25, 1997
"RTN","GMRVVS1",3,0)
GRAPH ;
"RTN","GMRVVS1",4,0)
 S GMRPGC=0,GMRX1="" F X=1:1:111 S GMRX1=GMRX1_$S(X#11:" ",1:"|")
"RTN","GMRVVS1",5,0)
 S (GMRX,GMRX2)=GMRX1 F X=1:1:10 S $P(GMRX,"|",X)="__________",$P(GMRX2,"|",X)="----------"
"RTN","GMRVVS1",6,0)
 S GMRPG=GMRTNM\10+$S(GMRTNM#10>0:1,1:0) I GMRPG=0 D HEADER^GMRVVS2 W !,"THERE IS NO DATA FOR THIS REPORT" X "F Y=$Y:1:(IOSL-6) W !" D FOOTER^GMRVVS2 Q
"RTN","GMRVVS1",7,0)
 F GMRPGS=1:1:GMRPG S GMRTLO=105.8335,GMRPLO=198.335 D PAGE Q:GMROUT
"RTN","GMRVVS1",8,0)
 Q
"RTN","GMRVVS1",9,0)
PAGE ;
"RTN","GMRVVS1",10,0)
 K GMRQUAL,GLINE,GVAR D HEADER^GMRVVS2 W "T: Temperature   P: Pulse   BMI: Body Mass Index   C/G: Circumference/Girth   * - Abnormal value   ** - Abnormal value off of graph",! D DATES^GMRVVS2 W !,?10,"|",?11,GMRX
"RTN","GMRVVS1",11,0)
 F GMRI=0:0 Q:$Y>51  W ! D SETHD^GMRVVS4 W GMRHDR1,?9,$S(GMR3!($Y=28):"-",1:""),?10,"|" D DATAPRT^GMRVVS4 W $S(GMR3!($Y=28):"-",1:""),?106,GMRHDR2
"RTN","GMRVVS1",12,0)
 W !,?10,"|",GMRX2 F GMRI="T","P","R","B","B1","B2","W","H","P1","BMI" S GMRLINE(GMRI)=GMRX1,GVAR(GMRI)=""
"RTN","GMRVVS1",13,0)
 F GMRI="PO2","OX1","OX2","OX3","CVP","CVP1","CG","CG1","CG2" K GVAR(GMRI)
"RTN","GMRVVS1",14,0)
 S GMRNM=0 F GMRDT=0:0 S GMRDT=$O(^TMP($J,"GMRDT",GMRDT)) Q:GMRDT'>0  S GMRNM=GMRNM+1 Q:GMRNM>12  F GMRI="T","P","R","H","W" D STLNP
"RTN","GMRVVS1",15,0)
 S GMRNM=0 F GMRDT=0:0 S GMRDT=$O(^TMP($J,"GMRDT",GMRDT)) Q:GMRDT'>0  S GMRNM=GMRNM+1 Q:GMRNM>12  D BP^GMRVVS2
"RTN","GMRVVS1",16,0)
 F GMRI="T","P","P1","R","B","B1","B2","W","BMI","H" I $D(GVAR(GMRI)) D
"RTN","GMRVVS1",17,0)
 .I IOSL<($Y+6) S GMRI(1)=GMRI D FOOTER^GMRVVS2,HEADER^GMRVVS2,DATES^GMRVVS2 S GMRI=GMRI(1) W !,?10,"|",?11,GMRX
"RTN","GMRVVS1",18,0)
 . S G=$S(GMRI="T":"TEMP.",GMRI="P":"PULSE",GMRI="R":"RESP.",GMRI="W":"WEIGHT(LB)",GMRI="H":"HEIGHT(IN)",GMRI="B":"BLOOD",GMRI="B1":"  PRESSURE",GMRI="BMI":"BMI",1:"")
"RTN","GMRVVS1",19,0)
 . I G="" S G=$S(GMRI="PO2":"PULSE OX.",GMRI="OX1":"  L/MIN",GMRI="OX2":"  %",GMRI="OX3":"  METHOD",GMRI="CG":"C/G (IN)",GMRI="CVP":"CVP cm H2O",GMRI="CVP1":"    mmHg",GMRI="CG1":"          ",GMRI="CG2":"    (CM)",1:"")
"RTN","GMRVVS1",20,0)
 . W !,G,?10,"|",GMRLINE(GMRI)
"RTN","GMRVVS1",21,0)
 D IO^GMRVVS2 I 'GMROUT W !,?10,"|",GMRX,!
"RTN","GMRVVS1",22,0)
 I IOSL<($Y+6) D FOOTER^GMRVVS2,HEADER^GMRVVS2
"RTN","GMRVVS1",23,0)
 I $D(GMRQUAL),'GMROUT W ! S GLINE="Qualifier: " S G="" F  S G=$O(GMRQUAL(G)) Q:G=""  D LEGEND^GMRVLGQU
"RTN","GMRVVS1",24,0)
 I 'GMROUT W GLINE F X=0:0 W ! Q:IOSL<($Y+6)
"RTN","GMRVVS1",25,0)
 D FOOTER^GMRVVS2 S GMRDT="" F GMRNM=1:1:12 S GMRDT=$O(^TMP($J,"GMRDT",GMRDT)) Q:GMRDT'>0  K ^TMP($J,"GMRDT",GMRDT)
"RTN","GMRVVS1",26,0)
 Q
"RTN","GMRVVS1",27,0)
STLNP ;
"RTN","GMRVVS1",28,0)
 S GMR(GMRI)=$O(^TMP($J,"GMR",GMRI,GMRDT,"")) Q:GMR(GMRI)=""
"RTN","GMRVVS1",29,0)
 S (GMRSITE,GMRSITE(1),GMRINF,GMRVJ)=""
"RTN","GMRVVS1",30,0)
 S GMRSITE(1)=$P($G(^TMP($J,"GMR",GMRI,GMRDT,GMR(GMRI))),"^"),GMRSITE(2)=$P($G(^(GMR(GMRI))),"^",3),GMRINF=$P($G(^(GMR(GMRI))),"^",4) I GMRSITE(1)'="" S GI=GMRI D SYNOARY^GMRVLGQU
"RTN","GMRVVS1",31,0)
 I GMRI'="CVP" S GI=$S(GMR(GMRI)>0:$J(GMR(GMRI),0,$S(GMRI="W"!(GMRI="H")!(GMRI="CG"):2,GMRI'="T":0,1:1)),1:GMR(GMRI))
"RTN","GMRVVS1",32,0)
 E  S GI=$S(GMR(GMRI)>0!(GMR(GMRI)<0)!($E(GMR(GMRI))="0"):$J(GMR(GMRI),0,1),1:GMR(GMRI))
"RTN","GMRVVS1",33,0)
 I "UNAVAILABLEPASSREFUSED"'[$$UP^XLFSTR(GI) S GI=GI_$S($P(^TMP($J,"GMR",GMRI,GMRDT,GMR(GMRI)),"^",2)'=1:" ",1:"*")
"RTN","GMRVVS1",34,0)
 S $P(GMRLINE(GMRI),"|",GMRNM)=GI_$S(GMRI="P"&($L(GMRSITE," ")>3):""_$P(GMRSITE," "),GMRI="R"!(GMRI="T")!(GMRI="H")!(GMRI="W")!(GMRI="CG"):""_GMRSITE,1:"")
"RTN","GMRVVS1",35,0)
 S $P(GMRLINE(GMRI),"|",GMRNM)=$E($P(GMRLINE(GMRI),"|",GMRNM)_"          ",1,10)
"RTN","GMRVVS1",36,0)
 D SETLN
"RTN","GMRVVS1",37,0)
 I GMRI="CG",$D(GMRLINE("CG2")) S $P(GMRLINE("CG2"),"|",GMRNM)=$E($S(GMR(GMRI)>0:$J(GMR(GMRI)/.3937,0,2),1:"")_"          ",1,10)
"RTN","GMRVVS1",38,0)
 I GMRI="P" S $P(GMRLINE("P1"),"|",GMRNM)=$E($S($L(GMRSITE," ")>3:$P(GMRSITE," ",2,4),1:GMRSITE)_"          ",1,10)
"RTN","GMRVVS1",39,0)
 I GMRI="H",$D(GMRLINE("H1")) S:GMR(GMRI)>0 $P(GMRLINE("H1"),"|",GMRNM)=$E($S(GMR(GMRI)>0:$J(GMR(GMRI)*2.54,0,2),1:GMR(GMRI))_"          ",1,10)
"RTN","GMRVVS1",40,0)
 I GMRI="W",$D(GMRLINE("W1")) S:GMR(GMRI)>0 $P(GMRLINE("W1"),"|",GMRNM)=$E($S(GMR(GMRI)>0:$J(GMR(GMRI)/2.2,0,2),1:GMR(GMRI))_"          ",1,10)
"RTN","GMRVVS1",41,0)
 I GMRI="W",$D(GMRLINE("BMI")),GMR(GMRI)>0 D
"RTN","GMRVVS1",42,0)
 . S GMRBMI="",GMRBMI(1)=GMRDT,GMRBMI(2)=GMR(GMRI) D CALBMI^GMRVBMI(.GMRBMI)
"RTN","GMRVVS1",43,0)
 . S $P(GMRLINE("BMI"),"|",GMRNM)=$E(GMRBMI_"          ",1,10) K GMRBMI
"RTN","GMRVVS1",44,0)
 I GMRI="PO2",$D(GMRLINE("OX1")) D
"RTN","GMRVVS1",45,0)
 . S $P(GMRLINE("OX3"),"|",GMRNM)=$E(GMRSITE_"          ",1,10)
"RTN","GMRVVS1",46,0)
 . S GMRINF=$P(^TMP($J,"GMR",GMRI,GMRDT,GMR(GMRI)),"^",4),(GMRINF(1),GMRINF(2))="" D
"RTN","GMRVVS1",47,0)
 . . I GMRINF="" S $P(GMRLINE("OX1"),"|",GMRNM)="          ",$P(GMRLINE("OX2"),"|",GMRNM)="          "
"RTN","GMRVVS1",48,0)
 . . E  D PO2^GMRVLGQU(.GMRINF) S $P(GMRLINE("OX1"),"|",GMRNM)=$E(GMRINF(1)_"          ",1,10),$P(GMRLINE("OX2"),"|",GMRNM)=$E(GMRINF(2)_"          ",1,10)
"RTN","GMRVVS1",49,0)
 I GMRI="CVP",$D(GMRLINE("CVP1")) S $P(GMRLINE("CVP1"),"|",GMRNM)=$E($S(GMR(GMRI)>0!(GMR(GMRI)<0)!($E(GMR(GMRI))="0"):$J(GMR(GMRI)/1.36,0,1),1:"")_$S(GI["*":"*",1:"")_"          ",1,10)
"RTN","GMRVVS1",50,0)
 I GMRI="PN",$D(GMRLINE("PN")) S $P(GMRLINE("PN"),"|",GMRNM)=$E($S(GMR(GMRI)?1.2N&(GMR(GMRI)'>10):GMR(GMRI),GMR(GMRI)=99:GMR(GMRI),1:"")_"          ",1,10)
"RTN","GMRVVS1",51,0)
 K GI Q
"RTN","GMRVVS1",52,0)
SETLN ;
"RTN","GMRVVS1",53,0)
 S GVAR(GMRI)=""
"RTN","GMRVVS1",54,0)
 I GMRI="PO2" S (GVAR("PO2"),GVAR("OX1"),GVAR("OX2"),GVAR("OX3"))="" Q
"RTN","GMRVVS1",55,0)
 I GMRI="CVP" S (GVAR("CVP"),GVAR("CVP1"))="" Q
"RTN","GMRVVS1",56,0)
 I GMRI="CG" S (GVAR("CG"),GVAR("CG2"))="" Q
"RTN","GMRVVS1",57,0)
 Q
"VER")
8.0^21.0
**END**
**END**
