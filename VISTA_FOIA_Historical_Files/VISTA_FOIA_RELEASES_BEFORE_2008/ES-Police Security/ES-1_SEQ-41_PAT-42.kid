Released ES*1*42 SEQ #41
Extracted from mail message
**KIDS**:ES*1.0*42^

**INSTALL NAME**
ES*1.0*42
"BLD",5564,0)
ES*1.0*42^POLICE & SECURITY^0^3040831^y
"BLD",5564,1,0)
^^7^7^3040602^
"BLD",5564,1,1,0)
Modify software to include 1st letter of first name and middle name
"BLD",5564,1,2,0)
of officer of officer on the Daily Operations Journal, Case Assignment 
"BLD",5564,1,3,0)
Register and Offense Match Report.
"BLD",5564,1,4,0)
 
"BLD",5564,1,5,0)
Also, remove the on screen initial page feeds from FOLLOW-UP ENTRY 
"BLD",5564,1,6,0)
ADD/EDIT, PRINT ANY FOLLOW UP NOTE, PRINT ANY OFFENSE REPORT and REVIEW 
"BLD",5564,1,7,0)
COMPLETED OFFENSE REPORT.
"BLD",5564,4,0)
^9.64PA^^
"BLD",5564,"KRN",0)
^9.67PA^8989.52^19
"BLD",5564,"KRN",.4,0)
.4
"BLD",5564,"KRN",.4,"NM",0)
^9.68A^2^2
"BLD",5564,"KRN",.4,"NM",1,0)
ESP OFFENSE MATCH REPORT    FILE #912^912^0
"BLD",5564,"KRN",.4,"NM",2,0)
ESP CASE ASSIGNMENT REGISTER    FILE #912^912^0
"BLD",5564,"KRN",.4,"NM","B","ESP CASE ASSIGNMENT REGISTER    FILE #912",2)

"BLD",5564,"KRN",.4,"NM","B","ESP OFFENSE MATCH REPORT    FILE #912",1)

"BLD",5564,"KRN",.401,0)
.401
"BLD",5564,"KRN",.402,0)
.402
"BLD",5564,"KRN",.403,0)
.403
"BLD",5564,"KRN",.403,"NM",0)
^9.68A^^0
"BLD",5564,"KRN",.5,0)
.5
"BLD",5564,"KRN",.84,0)
.84
"BLD",5564,"KRN",3.6,0)
3.6
"BLD",5564,"KRN",3.8,0)
3.8
"BLD",5564,"KRN",9.2,0)
9.2
"BLD",5564,"KRN",9.8,0)
9.8
"BLD",5564,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",5564,"KRN",9.8,"NM",1,0)
ESPJOU^^0^B19069914
"BLD",5564,"KRN",9.8,"NM",2,0)
ESPORP^^0^B12786059
"BLD",5564,"KRN",9.8,"NM",3,0)
ESPOFP^^0^B8873907
"BLD",5564,"KRN",9.8,"NM","B","ESPJOU",1)

"BLD",5564,"KRN",9.8,"NM","B","ESPOFP",3)

"BLD",5564,"KRN",9.8,"NM","B","ESPORP",2)

"BLD",5564,"KRN",19,0)
19
"BLD",5564,"KRN",19,"NM",0)
^9.68A^^0
"BLD",5564,"KRN",19.1,0)
19.1
"BLD",5564,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",5564,"KRN",101,0)
101
"BLD",5564,"KRN",101,"NM",0)
^9.68A^^
"BLD",5564,"KRN",409.61,0)
409.61
"BLD",5564,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",5564,"KRN",771,0)
771
"BLD",5564,"KRN",870,0)
870
"BLD",5564,"KRN",8989.51,0)
8989.51
"BLD",5564,"KRN",8989.52,0)
8989.52
"BLD",5564,"KRN",8994,0)
8994
"BLD",5564,"KRN","B",.4,.4)

"BLD",5564,"KRN","B",.401,.401)

"BLD",5564,"KRN","B",.402,.402)

"BLD",5564,"KRN","B",.403,.403)

"BLD",5564,"KRN","B",.5,.5)

"BLD",5564,"KRN","B",.84,.84)

"BLD",5564,"KRN","B",3.6,3.6)

"BLD",5564,"KRN","B",3.8,3.8)

"BLD",5564,"KRN","B",9.2,9.2)

"BLD",5564,"KRN","B",9.8,9.8)

"BLD",5564,"KRN","B",19,19)

"BLD",5564,"KRN","B",19.1,19.1)

"BLD",5564,"KRN","B",101,101)

"BLD",5564,"KRN","B",409.61,409.61)

"BLD",5564,"KRN","B",771,771)

"BLD",5564,"KRN","B",870,870)

"BLD",5564,"KRN","B",8989.51,8989.51)

"BLD",5564,"KRN","B",8989.52,8989.52)

"BLD",5564,"KRN","B",8994,8994)

"BLD",5564,"QUES",0)
^9.62^^
"BLD",5564,"REQB",0)
^9.611^3^3
"BLD",5564,"REQB",1,0)
ES*1.0*39^2
"BLD",5564,"REQB",2,0)
ES*1.0*27^2
"BLD",5564,"REQB",3,0)
ES*1.0*41^2
"BLD",5564,"REQB","B","ES*1.0*27",2)

"BLD",5564,"REQB","B","ES*1.0*39",1)

"BLD",5564,"REQB","B","ES*1.0*41",3)

"KRN",.4,1332,-1)
0^2
"KRN",.4,1332,0)
ESP CASE ASSIGNMENT REGISTER^3040831.1506^^912^^^3040831
"KRN",.4,1332,"%D",0)
^.4001^3^3^3040315^^
"KRN",.4,1332,"%D",1,0)
This print template displays pertinent data that allows the Chief
"KRN",.4,1332,"%D",2,0)
of Police or designee to generate a Case Assignment Register from
"KRN",.4,1332,"%D",3,0)
data already contained within the Offense Report file.
"KRN",.4,1332,"DXS",1,9)
X DXS(1,9.5) S X=$P(DIP(15),DIP(16),X),X=$E(X) S Y=X,X=DIP(10),X=X_Y
"KRN",.4,1332,"DXS",1,9.2)
S DIP(1)=$S($D(^ESP(912,D0,0)):^(0),1:"") S X=$P($G(^VA(200,+$P(DIP(1),U,6),0)),U),DIP(2)=$G(X) S X=",",DIP(3)=$G(X) S X=1,X=$P(DIP(2),DIP(3),X),DIP(4)=$G(X) S X=1
"KRN",.4,1332,"DXS",1,9.3)
X DXS(1,9.2) S DIP(5)=$G(X) S X=5,X=$E(DIP(4),DIP(5),X)_",",DIP(6)=$G(X),DIP(7)=$G(X) S X=$P($G(^VA(200,+$P(DIP(1),U,6),0)),U),DIP(8)=$G(X) S X=","
"KRN",.4,1332,"DXS",1,9.4)
X DXS(1,9.3) S DIP(9)=$G(X) S X=2,X=$P(DIP(8),DIP(9),X),X=$E(X) S Y=X,X=DIP(6),X=X_Y_" ",DIP(10)=$G(X),DIP(11)=$G(X),DIP(12)=$G(X)
"KRN",.4,1332,"DXS",1,9.5)
X DXS(1,9.4) S X=$P($G(^VA(200,+$P(DIP(1),U,6),0)),U),DIP(13)=$G(X) S X=",",DIP(14)=$G(X) S X=2,X=$P(DIP(13),DIP(14),X),DIP(15)=$G(X) S X=" ",DIP(16)=$G(X) S X=2
"KRN",.4,1332,"DXS",2,9)
S DIP(1)=$S($D(^ESP(912,D0,40,D1,0)):^(0),1:"") S X=$P($G(^ESP(910,+$P(DIP(1),U,2),0)),U),DIP(2)=$G(X) S X=" ",DIP(3)=$G(X) S X=1,X=$P(DIP(2),DIP(3),X)
"KRN",.4,1332,"DXS",3,9)
S DIP(1)=$S($D(^ESP(912,D0,30,D1,0)):^(0),1:"") S X=$P($G(^ESP(910,+$P(DIP(1),U,2),0)),U),DIP(2)=$G(X) S X=" ",DIP(3)=$G(X) S X=1,X=$P(DIP(2),DIP(3),X)
"KRN",.4,1332,"DXS",4,9)
X DXS(4,9.5) S X=$P(DIP(15),DIP(16),X),X=$E(X) S Y=X,X=DIP(10),X=X_Y
"KRN",.4,1332,"DXS",4,9.2)
S DIP(1)=$S($D(^ESP(912,D0,130,D1,0)):^(0),1:"") S X=$P($G(^VA(200,+$P(DIP(1),U,1),0)),U),DIP(2)=$G(X) S X=",",DIP(3)=$G(X) S X=1,X=$P(DIP(2),DIP(3),X)
"KRN",.4,1332,"DXS",4,9.3)
X DXS(4,9.2) S DIP(4)=$G(X) S X=1,DIP(5)=$G(X) S X=5,X=$E(DIP(4),DIP(5),X)_",",DIP(6)=$G(X),DIP(7)=$G(X) S X=$P($G(^VA(200,+$P(DIP(1),U,1),0)),U)
"KRN",.4,1332,"DXS",4,9.4)
X DXS(4,9.3) S DIP(8)=$G(X) S X=",",DIP(9)=$G(X) S X=2,X=$P(DIP(8),DIP(9),X),X=$E(X) S Y=X,X=DIP(6),X=X_Y_" ",DIP(10)=$G(X),DIP(11)=$G(X),DIP(12)=$G(X)
"KRN",.4,1332,"DXS",4,9.5)
X DXS(4,9.4) S X=$P($G(^VA(200,+$P(DIP(1),U,1),0)),U),DIP(13)=$G(X) S X=",",DIP(14)=$G(X) S X=2,X=$P(DIP(13),DIP(14),X),DIP(15)=$G(X) S X=" ",DIP(16)=$G(X) S X=2
"KRN",.4,1332,"F",1)
.1;"UOR";L9~10,.01;"CLASSIFICATION";L17~
"KRN",.4,1332,"F",2)
X DXS(1,9) W X K DIP;"OFFICER ASSIGNED";L9;Z;"$E($P(INVESTIGATING OFFICER,",",1),1,5)_","_$E($P(INVESTIGATING OFFICER,",",2))_" "_$E($P($P(INVESTIGATING OFFICER,",",2)," ",2))"~
"KRN",.4,1332,"F",3)
40,X DXS(2,9) W X K DIP;"OFFENDER";L20;Z;"$P(NAME," ",1)"~30,X DXS(3,9) W X K DIP;"VICTIM";L19;Z;"$P(NAME," ",1)"~90,.03;L6~90,.04;L8~.08;L6~
"KRN",.4,1332,"F",4)
5.02;"REPORT STATUS";L10~
"KRN",.4,1332,"F",5)
130,X DXS(4,9) W X K DIP;"FOLLOW-UP OFFICER";L9;Z;"$E($P(INVESTIGATOR,",",1),1,5)_","_$E($P(INVESTIGATOR,",",2))_" "_$E($P($P(INVESTIGATOR,",",2)," ",2))"~
"KRN",.4,1332,"H")
CASE ASSIGNMENT REGISTER
"KRN",.4,1334,-1)
0^1
"KRN",.4,1334,0)
ESP OFFENSE MATCH REPORT^3040601.1528^@^912^^@^3040601
"KRN",.4,1334,"%D",0)
^.4001^3^3^3040526^^^^
"KRN",.4,1334,"%D",1,0)
This print template provides pertinent data on offense reports
"KRN",.4,1334,"%D",2,0)
contained within the ESP Offense file that match specific pieces
"KRN",.4,1334,"%D",3,0)
of sort data input by VA Police staff.
"KRN",.4,1334,"DXS",1,9)
X DXS(1,9.5) S X=$P(DIP(15),DIP(16),X),X=$E(X) S Y=X,X=DIP(10),X=X_Y
"KRN",.4,1334,"DXS",1,9.2)
S DIP(1)=$S($D(^ESP(912,D0,0)):^(0),1:"") S X=$P($G(^VA(200,+$P(DIP(1),U,6),0)),U),DIP(2)=$G(X) S X=",",DIP(3)=$G(X) S X=1,X=$P(DIP(2),DIP(3),X),DIP(4)=$G(X) S X=1
"KRN",.4,1334,"DXS",1,9.3)
X DXS(1,9.2) S DIP(5)=$G(X) S X=8,X=$E(DIP(4),DIP(5),X)_",",DIP(6)=$G(X),DIP(7)=$G(X) S X=$P($G(^VA(200,+$P(DIP(1),U,6),0)),U),DIP(8)=$G(X) S X=","
"KRN",.4,1334,"DXS",1,9.4)
X DXS(1,9.3) S DIP(9)=$G(X) S X=2,X=$P(DIP(8),DIP(9),X),X=$E(X) S Y=X,X=DIP(6),X=X_Y_" ",DIP(10)=$G(X),DIP(11)=$G(X),DIP(12)=$G(X)
"KRN",.4,1334,"DXS",1,9.5)
X DXS(1,9.4) S X=$P($G(^VA(200,+$P(DIP(1),U,6),0)),U),DIP(13)=$G(X) S X=",",DIP(14)=$G(X) S X=2,X=$P(DIP(13),DIP(14),X),DIP(15)=$G(X) S X=" ",DIP(16)=$G(X) S X=2
"KRN",.4,1334,"F",1)
.1;L11~10,.01;"CLASSIFICATION";L16~40,.02;"OFFENDER";L22~40,.11;L8~
"KRN",.4,1334,"F",2)
X DXS(1,9) W X K DIP;"INVESTIGATOR";L13;Z;"$E($P(INVESTIGATING OFFICER,",",1),1,8)_","_$E($P(INVESTIGATING OFFICER,",",2))_" "_$E($P($P(INVESTIGATING OFFICER,",",2)," ",2))"~
"KRN",.4,1334,"F",3)
.03;L20~.04;L30~
"KRN",.4,1334,"H")
OFFENSE REPORT MATCHES
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"PKG",368,-1)
1^1
"PKG",368,0)
POLICE & SECURITY^ES^POLICE & SECURITY PACKAGE
"PKG",368,20,0)
^9.402P^^
"PKG",368,22,0)
^9.49I^1^1
"PKG",368,22,1,0)
1.0^2930300^2960130
"PKG",368,22,1,"PAH",1,0)
42^3040831^123456954
"PKG",368,22,1,"PAH",1,1,0)
^^7^7^3040831
"PKG",368,22,1,"PAH",1,1,1,0)
Modify software to include 1st letter of first name and middle name
"PKG",368,22,1,"PAH",1,1,2,0)
of officer of officer on the Daily Operations Journal, Case Assignment 
"PKG",368,22,1,"PAH",1,1,3,0)
Register and Offense Match Report.
"PKG",368,22,1,"PAH",1,1,4,0)
 
"PKG",368,22,1,"PAH",1,1,5,0)
Also, remove the on screen initial page feeds from FOLLOW-UP ENTRY 
"PKG",368,22,1,"PAH",1,1,6,0)
ADD/EDIT, PRINT ANY FOLLOW UP NOTE, PRINT ANY OFFENSE REPORT and REVIEW 
"PKG",368,22,1,"PAH",1,1,7,0)
COMPLETED OFFENSE REPORT.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","ESPJOU")
0^1^B19069914
"RTN","ESPJOU",1,0)
ESPJOU ;DALISC/RWW - ENHANCED PRINT DAILY OPERATIONS JOURNAL;3/99
"RTN","ESPJOU",2,0)
 ;;1.0;POLICE & SECURITY;**1,7,12,14,17,26,27,39,42**;Mar 31, 1994
"RTN","ESPJOU",3,0)
EN ;
"RTN","ESPJOU",4,0)
 D DT^DICRW
"RTN","ESPJOU",5,0)
JOU S DIC(0)="QAEMZ",DIC("A")="DATE: ",DIC="^ESP(916,"
"RTN","ESPJOU",6,0)
 D ^DIC
"RTN","ESPJOU",7,0)
 G:$D(DTOUT)!($D(DUOUT))!(X="") EXIT
"RTN","ESPJOU",8,0)
 I Y<0 W !,$C(7),"DATE not found.  Please try again." G JOU
"RTN","ESPJOU",9,0)
 S ESPID=+Y
"RTN","ESPJOU",10,0)
Q S %ZIS="Q" D ^%ZIS G:POP EXIT I '$D(IO("Q")) U IO D START G EXIT
"RTN","ESPJOU",11,0)
 S ZTRTN="START^ESPJOU",ZTSAVE("ESP*")="",ZTDESC="DAILY JOURNAL" D ^%ZTLOAD,HOME^%ZIS G EXIT
"RTN","ESPJOU",12,0)
START ;BEGINS THE PRINT OF THE DAILY JOURNAL
"RTN","ESPJOU",13,0)
 N ESPFAC K ^UTILITY("DIQ1",$J)
"RTN","ESPJOU",14,0)
 S (END,PAGE)=0 D HDR G:END EXIT
"RTN","ESPJOU",15,0)
 S DIC="^ESP(916,",DA=ESPID,DR="1;2;3;4;5",DIQ(0)="E" D EN^DIQ1 I '$D(^UTILITY("DIQ1",$J,916,DA)) W !,"RECORD DOESN'T EXIST!" G EXIT
"RTN","ESPJOU",16,0)
SEC1 W !,?28,"SECTION I - PERIOD COVERED"
"RTN","ESPJOU",17,0)
 W !,?28 F I=1:1:26 W "="
"RTN","ESPJOU",18,0)
 S ESPF=$G(^UTILITY("DIQ1",$J,916,DA,1,"E")),ESPT=$G(^UTILITY("DIQ1",$J,916,DA,2,"E"))
"RTN","ESPJOU",19,0)
DFM W !!,?19,"FROM: ",ESPF
"RTN","ESPJOU",20,0)
DTO W ?43,"TO: ",ESPT
"RTN","ESPJOU",21,0)
SEC2 I $Y+5>IOSL D HDR1 G:END EXIT
"RTN","ESPJOU",22,0)
 W !!,?29,"SECTION II - ASSIGNMENTS"
"RTN","ESPJOU",23,0)
 W !,?29 F I=1:1:24 W "="
"RTN","ESPJOU",24,0)
 W !
"RTN","ESPJOU",25,0)
 F ESPN=0:0 S ESPN=$O(^ESP(916,ESPID,2,ESPN)) Q:END  Q:ESPN'>0  D
"RTN","ESPJOU",26,0)
 .  S DIC="^ESP(916,"_ESPID_",2,",DA=ESPN,DR=".01",DIQ(0)="E" D EN^DIQ1 Q:'$D(^UTILITY("DIQ1",$J,916.03,DA,.01,"E"))
"RTN","ESPJOU",27,0)
WATC .  S (NAME,PDUZ)=""
"RTN","ESPJOU",28,0)
 .  I $Y+5>IOSL D HDR1 Q:END
"RTN","ESPJOU",29,0)
 .  W !,?15,$G(^UTILITY("DIQ1",$J,916.03,DA,.01,"E"))
"RTN","ESPJOU",30,0)
 .  F ESPN1=0:0 S ESPN1=$O(^ESP(916,ESPID,2,ESPN,1,ESPN1)) Q:ESPN1'>0  D
"RTN","ESPJOU",31,0)
 ..  S DIC="^ESP(916,"_ESPID_",2,"_ESPN_",1,",DA=ESPN1,DR=".01;.03",DIQ(0)="EI" D EN^DIQ1 Q:'$D(^UTILITY("DIQ1",$J,916.31,DA,.01,"E"))
"RTN","ESPJOU",32,0)
 ..  W ?27,$G(^UTILITY("DIQ1",$J,916.31,DA,.01,"E")),?55,$G(^UTILITY("DIQ1",$J,916.31,DA,.03,"E")),!
"RTN","ESPJOU",33,0)
 G:END EXIT
"RTN","ESPJOU",34,0)
SEC3 K ^UTILITY($J,"W") S DIWL=7,DIWR=80,DIWF="W",IEN=0
"RTN","ESPJOU",35,0)
 I $Y+5>IOSL D HDR1 G:END EXIT
"RTN","ESPJOU",36,0)
 W !,?24,"SECTION III - SPECIAL INSTRUCTIONS"
"RTN","ESPJOU",37,0)
 W !,?24 F I=1:1:34 W "="
"RTN","ESPJOU",38,0)
 F ESPN=1:1 S IEN=$O(^ESP(916,ESPID,3,IEN)) Q:IEN'>0  S X=^(IEN,0) D  Q:END
"RTN","ESPJOU",39,0)
 .  I $Y+5>IOSL D HDR1 Q:END
"RTN","ESPJOU",40,0)
 .  D ^DIWP
"RTN","ESPJOU",41,0)
 G:END EXIT
"RTN","ESPJOU",42,0)
 D ^DIWW
"RTN","ESPJOU",43,0)
SEC4 D HDR4 G:END EXIT
"RTN","ESPJOU",44,0)
 I '$G(ESPJOU1) F ESPN=0:0 S ESPN=$O(^ESP(916,ESPID,4,ESPN)) Q:ESPN'>0  D TIME Q:END
"RTN","ESPJOU",45,0)
 I $G(ESPJOU1) D
"RTN","ESPJOU",46,0)
 .  D SORT^ESPJOU1
"RTN","ESPJOU",47,0)
 .  S ESPTI=""
"RTN","ESPJOU",48,0)
 .  F  S ESPTI=$O(^TMP($J,"ESP",ESPTI)) Q:ESPTI=""  S ESPN=^(ESPTI) D TIME Q:END
"RTN","ESPJOU",49,0)
 G:END EXIT
"RTN","ESPJOU",50,0)
 I $Y+5>IOSL D HDR1 G:END EXIT
"RTN","ESPJOU",51,0)
 W !!!!!,?7,"REVIEW (Chief, Police Service)",!!
"RTN","ESPJOU",52,0)
 W ?7,"______________________________"
"RTN","ESPJOU",53,0)
 W ?45,"Date: _________________________"
"RTN","ESPJOU",54,0)
 D ^%ZISC
"RTN","ESPJOU",55,0)
EXIT K CL,DA,DIC,DIQ,DIR,DIRUT,DIWF,DIWL,DIWR,DR,DTOUT,DUOUT,END,ESPID,ESPN,ESPN1,ESPF,ESPT,ESPTI,ESPTIME,IEN,NAME,PAGE,PDUZ,X,Y,ZTDESC,ZTRTN,ZTSAVE,%ZIS,%,I,POP
"RTN","ESPJOU",56,0)
 K ^UTILITY("DIQ1",$J),^TMP($J)
"RTN","ESPJOU",57,0)
 QUIT
"RTN","ESPJOU",58,0)
HDR ;PRINT HEADING
"RTN","ESPJOU",59,0)
 I PAGE S END=$$EOP^ESPUTIL Q:END  W @IOF
"RTN","ESPJOU",60,0)
 E  I $E(IOST,1,2)="C-" W @IOF
"RTN","ESPJOU",61,0)
 S PAGE=PAGE+1
"RTN","ESPJOU",62,0)
 W !!!?22,"VA POLICE DAILY OPERATIONS JOURNAL",?70,"Page ",$J(PAGE,3)
"RTN","ESPJOU",63,0)
 W !?26,"(Automated VA Form 10-1433)"
"RTN","ESPJOU",64,0)
 W !?4,"VA Facility" W ?61,"Date/Time Printed"
"RTN","ESPJOU",65,0)
 S ESPFAC=$P(^ESP(916,ESPID,0),U,2)
"RTN","ESPJOU",66,0)
 I +ESPFAC>0 W !?4,$P($G(^DG(40.8,ESPFAC,0)),U,1)
"RTN","ESPJOU",67,0)
 E  W !?4,$S($D(^DIC(4,DUZ(2),0)):$P(^(0),U),1:"")
"RTN","ESPJOU",68,0)
 W ?61,$$NOW^ESPUTIL()
"RTN","ESPJOU",69,0)
 QUIT
"RTN","ESPJOU",70,0)
HDR1 ;PRINT CONSECUTIVE HEADERS
"RTN","ESPJOU",71,0)
 S END=$$EOP^ESPUTIL Q:END
"RTN","ESPJOU",72,0)
 S PAGE=PAGE+1 W @IOF,!!!?22,"VA POLICE DAILY OPERATIONS JOURNAL",?70,"Page ",$J(PAGE,3)
"RTN","ESPJOU",73,0)
 W !?25,"(Automated VA Form 10-1433a)"
"RTN","ESPJOU",74,0)
 W ?61,$$NOW^ESPUTIL()
"RTN","ESPJOU",75,0)
 W !!?18,"FROM: ",ESPF
"RTN","ESPJOU",76,0)
 W ?43,"TO: ",ESPT,!
"RTN","ESPJOU",77,0)
 QUIT
"RTN","ESPJOU",78,0)
HDR4 ;SECTION 4 HEADING
"RTN","ESPJOU",79,0)
 I $Y+7>IOSL D HDR1 Q:END
"RTN","ESPJOU",80,0)
 W !,?28,"SECTION IV - ENTRY SUMMARY"
"RTN","ESPJOU",81,0)
 W !,?28 F I=1:1:26 W "="
"RTN","ESPJOU",82,0)
 W !!,?4,"TIME",?14,"OFFICER",?27,"ACTIVITY"
"RTN","ESPJOU",83,0)
 W !,?4 F I=1:1:76 W "="
"RTN","ESPJOU",84,0)
 QUIT
"RTN","ESPJOU",85,0)
HDR2 S X=""
"RTN","ESPJOU",86,0)
 W !,?4,"TIME",?14,"OFFICER",?27,"ACTIVITY"
"RTN","ESPJOU",87,0)
 W !,?4 F I=1:1:76 W "="
"RTN","ESPJOU",88,0)
 QUIT
"RTN","ESPJOU",89,0)
 ;
"RTN","ESPJOU",90,0)
TIME ; print from time multiple of file 916
"RTN","ESPJOU",91,0)
 N NM
"RTN","ESPJOU",92,0)
 S DIC="^ESP(916,"_ESPID_",4,",DA=ESPN,DR=".01;1;2",DIQ(0)="E" D EN^DIQ1 Q:'$D(^UTILITY("DIQ1",$J,916.05,DA,.01,"E"))
"RTN","ESPJOU",93,0)
 I $Y+5>IOSL D HDR1 Q:END  D HDR2
"RTN","ESPJOU",94,0)
 W !,?4,$G(^UTILITY("DIQ1",$J,916.05,DA,.01,"E"))
"RTN","ESPJOU",95,0)
 S NM=^UTILITY("DIQ1",$J,916.05,DA,1,"E")
"RTN","ESPJOU",96,0)
 W ?14,$E($P(NM,","),1,5),",",$E($P(NM,",",2)),$J($E($P($P(NM,",",2)," ",2)),2)
"RTN","ESPJOU",97,0)
 W ?27,$G(^UTILITY("DIQ1",$J,916.05,DA,2,"E"))
"RTN","ESPJOU",98,0)
 K ^UTILITY($J,"W") S DIWL=7,DIWR=79,DIWF="W",IEN=0
"RTN","ESPJOU",99,0)
 F ESPN1=1:1 S IEN=$O(^ESP(916,ESPID,4,ESPN,3,IEN)) Q:IEN'>0  S X=^(IEN,0) D  Q:END
"RTN","ESPJOU",100,0)
 .  I $Y+5>IOSL D HDR1 Q:END
"RTN","ESPJOU",101,0)
 .  D ^DIWP
"RTN","ESPJOU",102,0)
 Q:END
"RTN","ESPJOU",103,0)
 D ^DIWW
"RTN","ESPJOU",104,0)
 W ?4 F I=1:1:76 W "-"
"RTN","ESPJOU",105,0)
 Q
"RTN","ESPOFP")
0^3^B8873907
"RTN","ESPOFP",1,0)
ESPOFP ;DALISC/CKA - PRINT OFFENSE REPORT FOLLOW-UP NOTES ONLY;3/99
"RTN","ESPOFP",2,0)
 ;;1.0;POLICE & SECURITY;**14,27,42**;Mar 31, 1994
"RTN","ESPOFP",3,0)
EN ;Entry point to print follow-up notes of only completed and nonsensitive reports.
"RTN","ESPOFP",4,0)
 D DT^DICRW
"RTN","ESPOFP",5,0)
OR S DIC(0)="QAEMZ",DIC("A")="UOR#: ",DIC("S")="I $D(^(5)),$P(^(5),U,2),'$P(^(5),U,4),$P(^(5),U,5)",DIC="^ESP(912,"
"RTN","ESPOFP",6,0)
 D ^DIC
"RTN","ESPOFP",7,0)
 G:$D(DTOUT)!($D(DUOUT))!(X="") EXIT
"RTN","ESPOFP",8,0)
 I Y<0 W !,$C(7),"UOR# not found.  Please try again." G OR
"RTN","ESPOFP",9,0)
 S ESPDTR=$P(^ESP(912,+Y,0),U,2),ESPID=+Y
"RTN","ESPOFP",10,0)
Q S %ZIS="Q" D ^%ZIS G:POP EXIT I '$D(IO("Q")) U IO D START G EXIT
"RTN","ESPOFP",11,0)
 S ZTRTN="START^ESPOFP",ZTSAVE("ESP*")="",ZTDESC="FOLLOW-UP NOTES" D ^%ZTLOAD,HOME^%ZIS G EXIT
"RTN","ESPOFP",12,0)
START ; BEGINS THE PRINT OF THESE FOLLOW-UP NOTES
"RTN","ESPOFP",13,0)
 N ESPFACI
"RTN","ESPOFP",14,0)
 K ^UTILITY("DIQ1",$J) S (END,PAGE)=0 D HDR G:END EXIT
"RTN","ESPOFP",15,0)
FOL ;PRINT FOLLOW-UP NOTES
"RTN","ESPOFP",16,0)
 G:'$D(^ESP(912,ESPID,130)) EXIT
"RTN","ESPOFP",17,0)
 F ESPN=0:0 S ESPN=$O(^ESP(912,ESPID,130,ESPN))  Q:ESPN'>0  D
"RTN","ESPOFP",18,0)
 .  D HDR:$Y+5>IOSL&(ESPN'=1) Q:END
"RTN","ESPOFP",19,0)
 .  W !,"FOLLOW-UP NOTES:",!!
"RTN","ESPOFP",20,0)
 .  K ^UTILITY($J,"W") S DIWL=3,DIWR=78,DIWF="W",IEN=0
"RTN","ESPOFP",21,0)
 .  F ESPN1=1:1 S IEN=$O(^ESP(912,ESPID,130,ESPN,10,IEN)) Q:IEN'>0  S X=^(IEN,0) D  Q:END
"RTN","ESPOFP",22,0)
 .  .  D HDR:$Y+5>IOSL Q:END
"RTN","ESPOFP",23,0)
 .  .  D ^DIWP
"RTN","ESPOFP",24,0)
 .  Q:END
"RTN","ESPOFP",25,0)
 .  D ^DIWW
"RTN","ESPOFP",26,0)
 .  S DIC="^ESP(912,"_ESPID_",130,",DA=ESPN,DR=".01",DIQ(0)="I" D EN^DIQ1
"RTN","ESPOFP",27,0)
 .  S ESPOFF=$G(^UTILITY("DIQ1",$J,912.17,DA,.01,"I"))
"RTN","ESPOFP",28,0)
 .  S DIC="^VA(200,",DA=ESPOFF,DR="20.2;910.1",DIQ(0)="E" D EN^DIQ1
"RTN","ESPOFP",29,0)
 .  W !!!!
"RTN","ESPOFP",30,0)
 .  D HDR:$Y+10>IOSL Q:END
"RTN","ESPOFP",31,0)
 .  W !,$G(^UTILITY("DIQ1",$J,200,DA,20.2,"E")),"   # ",$G(^UTILITY("DIQ1",$J,200,DA,910.1,"E")),!,"FOLLOW-UP INVESTIGATOR",!!!!!
"RTN","ESPOFP",32,0)
EXIT D ^%ZISC
"RTN","ESPOFP",33,0)
 K %ZIS,CL,DA,DIC,DIQ,DIR,DIRUT,DIWF,DIWL,DIWR,DR,END,ESPDTR,ESPID,ESPN,ESPN1,IEN,PAGE,X,Y,ZTDESC,ZTRTN,ZTSAVE
"RTN","ESPOFP",34,0)
 K ^UTILITY("DIQ1",$J)
"RTN","ESPOFP",35,0)
 QUIT
"RTN","ESPOFP",36,0)
HDR ;PRINT HEADING
"RTN","ESPOFP",37,0)
 I PAGE>0,$E(IOST,1,2)="C-" S END=$$EOP^ESPUTIL() Q:END
"RTN","ESPOFP",38,0)
 S PAGE=PAGE+1 W @IOF,!?25,"DEPARTMENT OF VETERANS AFFAIRS",?(IOM-10),"PAGE:  ",$J(PAGE,3)
"RTN","ESPOFP",39,0)
 W !?35,"VA POLICE",!?28,"UNIFORM OFFENSE REPORT"
"RTN","ESPOFP",40,0)
 W !?30,"UOR# ",$E(ESPDTR,2,3),"-",$E(ESPDTR,4,5),"-",$E(ESPDTR,6,7),"-",$TR($E($P(ESPDTR,".",2)_"ZZZZ",1,4),"Z",0)
"RTN","ESPOFP",41,0)
 W !,"VA Facility" W ?61,"Date/Time Printed"
"RTN","ESPOFP",42,0)
 S ESPFACI=$P(^ESP(912,ESPID,0),U,7) S ESPFACI=$S(ESPFACI="":"",$D(^DG(40.8,ESPFACI,0)):$P(^(0),U),1:"")
"RTN","ESPOFP",43,0)
 I ESPFACI="",$D(^ESP(912,ESPID,5)),$P(^(5),U)'="" S ESPFACI=$S($D(^DIC(4,$P(^(5),U),0)):$P(^(0),U),1:"")
"RTN","ESPOFP",44,0)
 W !,ESPFACI
"RTN","ESPOFP",45,0)
 ;I $D(^ESP(912,ESPID,5)),$P(^(5),U)'="" W !,$S($D(^DIC(4,$P(^(5),U),0)):$P(^(0),U),1:"")
"RTN","ESPOFP",46,0)
 W ?61,$$NOW^ESPUTIL()
"RTN","ESPOFP",47,0)
 W !,"Automated VA Form 10-1393"
"RTN","ESPOFP",48,0)
 W !!
"RTN","ESPOFP",49,0)
 QUIT
"RTN","ESPOFP",50,0)
 ;
"RTN","ESPOFP",51,0)
 ;ENTRY POINT OR1 IS TO ALLOWS PRINT OF AN INCOMPLETE REPORT
"RTN","ESPOFP",52,0)
 ;THIS OPTION IS ONLY FOR PERSONS HOLDING THE CHIEF KEY
"RTN","ESPOFP",53,0)
OR1 S DIC(0)="QAEMZ",DIC("A")="UOR#: ",DIC("S")="I $D(^(5)),$P(^(5),U,5)",DIC="^ESP(912,"
"RTN","ESPOFP",54,0)
 D ^DIC G:$D(DTOUT)!($D(DUOUT))!(X="") EXIT G:Y<0 OR1 S ESPDTR=$P(^ESP(912,+Y,0),U,2),ESPID=+Y
"RTN","ESPOFP",55,0)
 D Q
"RTN","ESPOFP",56,0)
 QUIT
"RTN","ESPORP")
0^2^B12786059
"RTN","ESPORP",1,0)
ESPORP ;DALISC/CKA - PRINT OFFENSE REPORT;3/99
"RTN","ESPORP",2,0)
 ;;1.0;POLICE & SECURITY;**14,17,27,36,39,42**;Mar 31, 1994
"RTN","ESPORP",3,0)
EN ;Entry point to print only completed and nonsensitive reports.
"RTN","ESPORP",4,0)
 D DT^DICRW
"RTN","ESPORP",5,0)
OR S DIC(0)="AEMZ",DIC("A")="UOR#: ",DIC("S")="I $D(^(5)),$P(^(5),U,2),'$P(^(5),U,4),$P(^(5),U,5)",DIC="^ESP(912,"
"RTN","ESPORP",6,0)
 D ^DIC
"RTN","ESPORP",7,0)
 G:$D(DTOUT)!($D(DUOUT))!(X="") EXIT
"RTN","ESPORP",8,0)
 I Y<0 W !,$C(7),"UOR# not found.  Please try again." G OR
"RTN","ESPORP",9,0)
 S ESPDTR=$P(^ESP(912,+Y,0),U,2),ESPID=+Y
"RTN","ESPORP",10,0)
Q S %ZIS="Q" D ^%ZIS G:POP EXIT I '$D(IO("Q")) U IO D START G EXIT
"RTN","ESPORP",11,0)
 S ZTRTN="START^ESPORP",ZTSAVE("ESP*")="",ZTDESC="OFFENSE REPORT" D ^%ZTLOAD,HOME^%ZIS G EXIT
"RTN","ESPORP",12,0)
START ; BEGINS THE PRINT OF THIS OFFENSE REPORT
"RTN","ESPORP",13,0)
 N ESPFACI
"RTN","ESPORP",14,0)
 K ^UTILITY("DIQ1",$J) S (END,PAGE)=0 D HDR G:END EXIT
"RTN","ESPORP",15,0)
 S DIC="^ESP(912,",DA=ESPID,DR=".02;.03;.04;.05;.06;.09;.11;.12",DIQ(0)="E" D EN^DIQ1 I '$D(^UTILITY("DIQ1",$J,912,DA)) W !,"RECORD DOESN'T EXIST!" G EXIT
"RTN","ESPORP",16,0)
DTR W !,"DATE/TIME RECEIVED: ",$G(^UTILITY("DIQ1",$J,912,DA,.02,"E"))
"RTN","ESPORP",17,0)
DTO W !,"DATE/TIME OF OFFENSE: ",$G(^UTILITY("DIQ1",$J,912,DA,.03,"E"))
"RTN","ESPORP",18,0)
EDTO W !,"ENDING DATE/TIME OF OFFENSE: ",$G(^UTILITY("DIQ1",$J,912,DA,.09,"E"))
"RTN","ESPORP",19,0)
LOC W !,"LOCATION: ",$G(^UTILITY("DIQ1",$J,912,DA,.04,"E"))
"RTN","ESPORP",20,0)
WEAP W !,"WEAPON USED: ",$G(^UTILITY("DIQ1",$J,912,DA,.05,"E"))
"RTN","ESPORP",21,0)
PO W !,"INVESTIGATING OFFICER: ",$G(^UTILITY("DIQ1",$J,912,DA,.06,"E"))
"RTN","ESPORP",22,0)
 S BADGE=^UTILITY("DIQ1",$J,912,DA,.11,"E")
"RTN","ESPORP",23,0)
MO K ^UTILITY($J,"W") S DIWL=3,DIWR=78,DIWF="W",IEN=0
"RTN","ESPORP",24,0)
 W !,"METHOD OF OPERATION: ",!
"RTN","ESPORP",25,0)
 F ESPN=1:1 S IEN=$O(^ESP(912,ESPID,60,IEN)) Q:IEN'>0  S X=^(IEN,0) D  G EXIT:END
"RTN","ESPORP",26,0)
 .  D HDR:$Y+2>IOSL Q:END
"RTN","ESPORP",27,0)
 .  D ^DIWP
"RTN","ESPORP",28,0)
 D MIN(2) Q:END
"RTN","ESPORP",29,0)
 D ^DIWW
"RTN","ESPORP",30,0)
CL ;PRINT CLASSIFICATION CODES, TYPES, AND SUBTYPES
"RTN","ESPORP",31,0)
 F ESPN=0:0 S ESPN=$O(^ESP(912,ESPID,10,ESPN)) Q:ESPN'>0  D  G EXIT:END
"RTN","ESPORP",32,0)
 .  S DIC="^ESP(912,"_ESPID_",10,",DA=ESPN,DR=".01;.02;.03",DIQ(0)="E" D EN^DIQ1 Q:'$D(^UTILITY("DIQ1",$J,912.01,DA,.01,"E"))
"RTN","ESPORP",33,0)
 .  D LINES()
"RTN","ESPORP",34,0)
 .  W "CLASSIFICATION CODE: ",$G(^UTILITY("DIQ1",$J,912.01,DA,.01,"E"))
"RTN","ESPORP",35,0)
 .  I $G(^UTILITY("DIQ1",$J,912.01,DA,.02,"E"))]"" W "/",^("E")
"RTN","ESPORP",36,0)
 .  I $G(^UTILITY("DIQ1",$J,912.01,DA,.03,"E"))]"" W "/",^("E")
"RTN","ESPORP",37,0)
 G ^ESPORP1
"RTN","ESPORP",38,0)
EXIT K %ZIS,CL,DA,DIC,DIQ,DIR,DIRUT,DIWF,DIWL,DIWR,DR,END,ESPDTR,ESPID,ESPN,ESPN1,IEN,PAGE,X,Y,ZTDESC,ZTRTN,ZTSAVE,BADGE
"RTN","ESPORP",39,0)
 K ^UTILITY("DIQ1",$J)
"RTN","ESPORP",40,0)
 QUIT
"RTN","ESPORP",41,0)
HDR ;PRINT HEADING
"RTN","ESPORP",42,0)
 I PAGE>0,$E(IOST,1,2)="C-" S END=$$EOP^ESPUTIL() Q:END
"RTN","ESPORP",43,0)
 S PAGE=PAGE+1 W:PAGE'=1 @IOF W !?25,"DEPARTMENT OF VETERANS AFFAIRS",?(IOM-10),"Page ",$J(PAGE,3)
"RTN","ESPORP",44,0)
 W !?35,"VA POLICE",!?28,"UNIFORM OFFENSE REPORT"
"RTN","ESPORP",45,0)
 W !?30,"UOR# ",$E(ESPDTR,2,3),"-",$E(ESPDTR,4,5),"-",$E(ESPDTR,6,7),"-",$TR($E($P(ESPDTR,".",2)_"ZZZZ",1,4),"Z",0)
"RTN","ESPORP",46,0)
 W !!,"VA Facility" W ?61,"Date/Time Printed"
"RTN","ESPORP",47,0)
 S ESPFACI=$P(^ESP(912,ESPID,0),U,7) S ESPFACI=$S(ESPFACI="":"",$D(^DG(40.8,ESPFACI,0)):$P(^(0),U),1:"")
"RTN","ESPORP",48,0)
 I ESPFACI="",$D(^ESP(912,ESPID,5)),$P(^(5),U)'="" S ESPFACI=$S($D(^DIC(4,$P(^(5),U),0)):$P(^(0),U),1:"")
"RTN","ESPORP",49,0)
 W !,ESPFACI
"RTN","ESPORP",50,0)
 W ?61,$$NOW^ESPUTIL()
"RTN","ESPORP",51,0)
 W !,"Automated VA Form 10-1393"
"RTN","ESPORP",52,0)
 W !!
"RTN","ESPORP",53,0)
 QUIT
"RTN","ESPORP",54,0)
 ;
"RTN","ESPORP",55,0)
 ;ENTRY POINT OR1 IS TO ALLOWS PRINT OF AN INCOMPLETE REPORT
"RTN","ESPORP",56,0)
 ;THIS OPTION IS ONLY FOR PERSONS HOLDING THE CHIEF KEY
"RTN","ESPORP",57,0)
OR1 S DIC(0)="AEMZ",DIC("A")="UOR#: ",DIC("S")="I $D(^(5)),$P(^(5),U,5)",DIC="^ESP(912,"
"RTN","ESPORP",58,0)
 D ^DIC G:$D(DTOUT)!($D(DUOUT))!(X="") EXIT G:Y<0 OR1 S ESPDTR=$P(^ESP(912,+Y,0),U,2),ESPID=+Y
"RTN","ESPORP",59,0)
 D Q
"RTN","ESPORP",60,0)
 QUIT
"RTN","ESPORP",61,0)
 ;
"RTN","ESPORP",62,0)
LINES(COUNT) ;
"RTN","ESPORP",63,0)
 ;writes COUNT lines
"RTN","ESPORP",64,0)
 ;writes header if necessary
"RTN","ESPORP",65,0)
 ;
"RTN","ESPORP",66,0)
 N CRT,INDEX
"RTN","ESPORP",67,0)
 I '$D(COUNT) S COUNT=1
"RTN","ESPORP",68,0)
 S CRT=$S(($E(IOST,1,2)="C-"):1,1:0)
"RTN","ESPORP",69,0)
 F INDEX=1:1:COUNT D  Q:END
"RTN","ESPORP",70,0)
 .I $Y>(IOSL-(1+CRT)) D HDR Q:END
"RTN","ESPORP",71,0)
 .W !
"RTN","ESPORP",72,0)
 Q
"RTN","ESPORP",73,0)
 ;
"RTN","ESPORP",74,0)
MIN(COUNT) ;
"RTN","ESPORP",75,0)
 ;prints header if not minimum of COUNT pages left
"RTN","ESPORP",76,0)
 ;first gives end of page message if crt
"RTN","ESPORP",77,0)
 ;
"RTN","ESPORP",78,0)
 N CRT
"RTN","ESPORP",79,0)
 S CRT=$S(($E(IOST,1,2)="C-"):1,1:0)
"RTN","ESPORP",80,0)
 S COUNT=COUNT+CRT
"RTN","ESPORP",81,0)
 I ($Y>(IOSL-(COUNT))) D HDR
"RTN","ESPORP",82,0)
 Q
"VER")
8.0^22
**END**
**END**
