Released EAS*1*1 SEQ #1
Extracted from mail message
**KIDS**:EAS*1.0*1^

**INSTALL NAME**
EAS*1.0*1
"BLD",3320,0)
EAS*1.0*1^ENROLLMENT APPLICATION SYSTEM^0^3010530^y
"BLD",3320,4,0)
^9.64PA^712^1
"BLD",3320,4,712,0)
712
"BLD",3320,4,712,2,0)
^9.641^712^1
"BLD",3320,4,712,2,712,0)
1010EZ HOLDING  (File-top level)
"BLD",3320,4,712,2,712,1,0)
^9.6411^4.7^2
"BLD",3320,4,712,2,712,1,4.6,0)
SIG. REMOVAL DATE
"BLD",3320,4,712,2,712,1,4.7,0)
SIG. REMOVED BY
"BLD",3320,4,712,222)
y^n^p^^^^n
"BLD",3320,4,"APDD",712,712)

"BLD",3320,4,"APDD",712,712,4.6)

"BLD",3320,4,"APDD",712,712,4.7)

"BLD",3320,4,"B",712,712)

"BLD",3320,"INID")
^y
"BLD",3320,"INIT")
EAS1P
"BLD",3320,"KRN",0)
^9.67PA^19^17
"BLD",3320,"KRN",.4,0)
.4
"BLD",3320,"KRN",.401,0)
.401
"BLD",3320,"KRN",.402,0)
.402
"BLD",3320,"KRN",.403,0)
.403
"BLD",3320,"KRN",.5,0)
.5
"BLD",3320,"KRN",.84,0)
.84
"BLD",3320,"KRN",3.6,0)
3.6
"BLD",3320,"KRN",3.8,0)
3.8
"BLD",3320,"KRN",9.2,0)
9.2
"BLD",3320,"KRN",9.2,"NM",0)
^9.68A^28^28
"BLD",3320,"KRN",9.2,"NM",1,0)
EAS EZ ACTION AF^^0
"BLD",3320,"KRN",9.2,"NM",2,0)
EAS EZ ACTION AZ^^0
"BLD",3320,"KRN",9.2,"NM",3,0)
EAS EZ ACTION CZ^^0
"BLD",3320,"KRN",9.2,"NM",4,0)
EAS EZ ACTION FZ^^0
"BLD",3320,"KRN",9.2,"NM",5,0)
EAS EZ ACTION IZ^^0
"BLD",3320,"KRN",9.2,"NM",6,0)
EAS EZ ACTION LZ^^0
"BLD",3320,"KRN",9.2,"NM",7,0)
EAS EZ ACTION PZ^^0
"BLD",3320,"KRN",9.2,"NM",8,0)
EAS EZ ACTION RZ^^0
"BLD",3320,"KRN",9.2,"NM",9,0)
EAS EZ ACTION UF^^0
"BLD",3320,"KRN",9.2,"NM",10,0)
EAS EZ ACTION VZ^^0
"BLD",3320,"KRN",9.2,"NM",11,0)
EAS EZ DEFINE APP#^^0
"BLD",3320,"KRN",9.2,"NM",12,0)
EAS EZ DEFINE APPLICANT^^0
"BLD",3320,"KRN",9.2,"NM",13,0)
EAS EZ DEFINE LINE#^^0
"BLD",3320,"KRN",9.2,"NM",14,0)
EAS EZ DEFINE PRINT^^0
"BLD",3320,"KRN",9.2,"NM",15,0)
EAS EZ DEFINE REC'D^^0
"BLD",3320,"KRN",9.2,"NM",16,0)
EAS EZ DEFINE TO^^0
"BLD",3320,"KRN",9.2,"NM",17,0)
EAS EZ DEFINE VET TYPE^^0
"BLD",3320,"KRN",9.2,"NM",18,0)
EAS EZ OPTION LOOKUP^^0
"BLD",3320,"KRN",9.2,"NM",19,0)
EAS EZ OPTION PROCESS^^0
"BLD",3320,"KRN",9.2,"NM",20,0)
EAS EZ OPTION REMOVE SIG VERIF^^0
"BLD",3320,"KRN",9.2,"NM",21,0)
EAS EZ SCREEN INITIAL^^0
"BLD",3320,"KRN",9.2,"NM",22,0)
EAS EZ STATUS FILED^^0
"BLD",3320,"KRN",9.2,"NM",23,0)
EAS EZ STATUS IN REVIEW^^0
"BLD",3320,"KRN",9.2,"NM",24,0)
EAS EZ STATUS INACTIVE^^0
"BLD",3320,"KRN",9.2,"NM",25,0)
EAS EZ STATUS NEW^^0
"BLD",3320,"KRN",9.2,"NM",26,0)
EAS EZ STATUS PRINTED^^0
"BLD",3320,"KRN",9.2,"NM",27,0)
EAS EZ STATUS SIGNED^^0
"BLD",3320,"KRN",9.2,"NM",28,0)
EAS EZ DEFINE SSN^^0
"BLD",3320,"KRN",9.2,"NM","B","EAS EZ ACTION AF",1)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ ACTION AZ",2)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ ACTION CZ",3)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ ACTION FZ",4)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ ACTION IZ",5)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ ACTION LZ",6)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ ACTION PZ",7)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ ACTION RZ",8)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ ACTION UF",9)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ ACTION VZ",10)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ DEFINE APP#",11)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ DEFINE APPLICANT",12)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ DEFINE LINE#",13)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ DEFINE PRINT",14)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ DEFINE REC'D",15)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ DEFINE SSN",28)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ DEFINE TO",16)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ DEFINE VET TYPE",17)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ OPTION LOOKUP",18)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ OPTION PROCESS",19)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ OPTION REMOVE SIG VERIF",20)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ SCREEN INITIAL",21)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ STATUS FILED",22)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ STATUS IN REVIEW",23)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ STATUS INACTIVE",24)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ STATUS NEW",25)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ STATUS PRINTED",26)

"BLD",3320,"KRN",9.2,"NM","B","EAS EZ STATUS SIGNED",27)

"BLD",3320,"KRN",9.8,0)
9.8
"BLD",3320,"KRN",9.8,"NM",0)
^9.68A^15^15
"BLD",3320,"KRN",9.8,"NM",1,0)
EASEZC1^^0^B39744614
"BLD",3320,"KRN",9.8,"NM",2,0)
EASEZC2^^0^B34165501
"BLD",3320,"KRN",9.8,"NM",3,0)
EASEZF1^^0^B16102525
"BLD",3320,"KRN",9.8,"NM",4,0)
EASEZF2^^0^B57818396
"BLD",3320,"KRN",9.8,"NM",5,0)
EASEZF3^^0^B20061551
"BLD",3320,"KRN",9.8,"NM",6,0)
EASEZF4^^0^B13992070
"BLD",3320,"KRN",9.8,"NM",7,0)
EASEZFM^^0^B8303288
"BLD",3320,"KRN",9.8,"NM",8,0)
EASEZI^^0^B45048604
"BLD",3320,"KRN",9.8,"NM",9,0)
EASEZL1^^0^B32210596
"BLD",3320,"KRN",9.8,"NM",10,0)
EASEZL2^^0^B37367125
"BLD",3320,"KRN",9.8,"NM",11,0)
EASEZLM^^0^B45274136
"BLD",3320,"KRN",9.8,"NM",12,0)
EASEZQ^^0^B27971005
"BLD",3320,"KRN",9.8,"NM",13,0)
EASEZU3^^0^B62230482
"BLD",3320,"KRN",9.8,"NM",14,0)
EASEZU5^^0^B33343925
"BLD",3320,"KRN",9.8,"NM",15,0)
EAS1P^^0^B1106821
"BLD",3320,"KRN",9.8,"NM","B","EAS1P",15)

"BLD",3320,"KRN",9.8,"NM","B","EASEZC1",1)

"BLD",3320,"KRN",9.8,"NM","B","EASEZC2",2)

"BLD",3320,"KRN",9.8,"NM","B","EASEZF1",3)

"BLD",3320,"KRN",9.8,"NM","B","EASEZF2",4)

"BLD",3320,"KRN",9.8,"NM","B","EASEZF3",5)

"BLD",3320,"KRN",9.8,"NM","B","EASEZF4",6)

"BLD",3320,"KRN",9.8,"NM","B","EASEZFM",7)

"BLD",3320,"KRN",9.8,"NM","B","EASEZI",8)

"BLD",3320,"KRN",9.8,"NM","B","EASEZL1",9)

"BLD",3320,"KRN",9.8,"NM","B","EASEZL2",10)

"BLD",3320,"KRN",9.8,"NM","B","EASEZLM",11)

"BLD",3320,"KRN",9.8,"NM","B","EASEZQ",12)

"BLD",3320,"KRN",9.8,"NM","B","EASEZU3",13)

"BLD",3320,"KRN",9.8,"NM","B","EASEZU5",14)

"BLD",3320,"KRN",19,0)
19
"BLD",3320,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",3320,"KRN",19,"NM",1,0)
EAS EZ REMOVE SIGNATURE^^0
"BLD",3320,"KRN",19,"NM",2,0)
EAS EZ MENU^^2
"BLD",3320,"KRN",19,"NM","B","EAS EZ MENU",2)

"BLD",3320,"KRN",19,"NM","B","EAS EZ REMOVE SIGNATURE",1)

"BLD",3320,"KRN",19.1,0)
19.1
"BLD",3320,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",3320,"KRN",101,0)
101
"BLD",3320,"KRN",101,"NM",0)
^9.68A^^
"BLD",3320,"KRN",409.61,0)
409.61
"BLD",3320,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",3320,"KRN",771,0)
771
"BLD",3320,"KRN",870,0)
870
"BLD",3320,"KRN",8994,0)
8994
"BLD",3320,"KRN","B",.4,.4)

"BLD",3320,"KRN","B",.401,.401)

"BLD",3320,"KRN","B",.402,.402)

"BLD",3320,"KRN","B",.403,.403)

"BLD",3320,"KRN","B",.5,.5)

"BLD",3320,"KRN","B",.84,.84)

"BLD",3320,"KRN","B",3.6,3.6)

"BLD",3320,"KRN","B",3.8,3.8)

"BLD",3320,"KRN","B",9.2,9.2)

"BLD",3320,"KRN","B",9.8,9.8)

"BLD",3320,"KRN","B",19,19)

"BLD",3320,"KRN","B",19.1,19.1)

"BLD",3320,"KRN","B",101,101)

"BLD",3320,"KRN","B",409.61,409.61)

"BLD",3320,"KRN","B",771,771)

"BLD",3320,"KRN","B",870,870)

"BLD",3320,"KRN","B",8994,8994)

"BLD",3320,"QUES",0)
^9.62^^
"BLD",3320,"REQB",0)
^9.611^^
"FIA",712)
1010EZ HOLDING
"FIA",712,0)
^EAS(712,
"FIA",712,0,0)
712
"FIA",712,0,1)
y^n^p^^^^n
"FIA",712,0,10)

"FIA",712,0,11)

"FIA",712,0,"RLRO")

"FIA",712,0,"VR")
1.0^EAS
"FIA",712,712)
1
"FIA",712,712,4.6)

"FIA",712,712,4.7)

"INIT")
EAS1P
"KRN",9.2,1458,-1)
0^19
"KRN",9.2,1458,0)
EAS EZ OPTION PROCESS^10-10EZ PROCESSING^3010328.0956^^
"KRN",9.2,1458,1,0)
^9.21^16^16^3010328^^^^
"KRN",9.2,1458,1,1,0)
There are six Processing Status categories used to organize interaction 
"KRN",9.2,1458,1,2,0)
with the 10-10EZ module:
"KRN",9.2,1458,1,3,0)
  
"KRN",9.2,1458,1,4,0)
   [NEW]     [IN REVIEW]   [PRINTED, PENDING SIGNATURE]
"KRN",9.2,1458,1,5,0)
  
"KRN",9.2,1458,1,6,0)
   [SIGNED]  [FILED]       [INACTIVATED]
"KRN",9.2,1458,1,7,0)
   
"KRN",9.2,1458,1,8,0)
A given Application can be in only one Processing Status at any point 
"KRN",9.2,1458,1,9,0)
in time.    
"KRN",9.2,1458,1,10,0)
  
"KRN",9.2,1458,1,11,0)
Basic information about a 10-10EZ Application, including its
"KRN",9.2,1458,1,12,0)
current Processing Status, can be obtained by using the 1010EZ
"KRN",9.2,1458,1,13,0)
[Quick Lookup] option on the main 10-10EZ Menu.
"KRN",9.2,1458,1,14,0)
  
"KRN",9.2,1458,1,15,0)
Further information is also available on the initial List Manager
"KRN",9.2,1458,1,16,0)
display [screen].
"KRN",9.2,1458,2,0)
^9.22A^9^8
"KRN",9.2,1458,2,1,0)
NEW^EAS EZ STATUS NEW
"KRN",9.2,1458,2,2,0)
IN REVIEW^EAS EZ STATUS IN REVIEW
"KRN",9.2,1458,2,4,0)
SIGNED^EAS EZ STATUS SIGNED
"KRN",9.2,1458,2,5,0)
FILED^EAS EZ STATUS FILED
"KRN",9.2,1458,2,6,0)
INACTIVATED^EAS EZ STATUS INACTIVE
"KRN",9.2,1458,2,7,0)
SCREEN^EAS EZ SCREEN INITIAL
"KRN",9.2,1458,2,8,0)
QUICK LOOKUP^EAS EZ OPTION LOOKUP
"KRN",9.2,1458,2,9,0)
PRINTED, PENDING SIGNATURE^EAS EZ STATUS PRINTED
"KRN",9.2,1458,3,0)
^9.23A^^0
"KRN",9.2,1459,-1)
0^25
"KRN",9.2,1459,0)
EAS EZ STATUS NEW^NEW^3010328.100602^^
"KRN",9.2,1459,1,0)
^9.21^9^9^3010328^^^^
"KRN",9.2,1459,1,1,0)
A NEW Application is one that has been recently received by the VAMC via 
"KRN",9.2,1459,1,2,0)
MailMan after being submitted by the veteran from the On-Line 10-10EZ 
"KRN",9.2,1459,1,3,0)
website.  Its data has been filed into a 1010EZ HOLDING file (#712) record.
"KRN",9.2,1459,1,4,0)
  
"KRN",9.2,1459,1,5,0)
Actions that may be performed for NEW Applications are:
"KRN",9.2,1459,1,6,0)
  
"KRN",9.2,1459,1,7,0)
[LZ]  Link to Patient File
"KRN",9.2,1459,1,8,0)
[IZ]  Inactivate 1010EZ
"KRN",9.2,1459,1,9,0)
  
"KRN",9.2,1459,2,0)
^9.22A^2^2
"KRN",9.2,1459,2,1,0)
LZ^EAS EZ ACTION LZ
"KRN",9.2,1459,2,2,0)
IZ^EAS EZ ACTION IZ
"KRN",9.2,1460,-1)
0^23
"KRN",9.2,1460,0)
EAS EZ STATUS IN REVIEW^IN REVIEW^3010328.100733^^
"KRN",9.2,1460,1,0)
^9.21^20^20^3010328^^^^
"KRN",9.2,1460,1,1,0)
For an application IN REVIEW, the link to the VISTA database has been
"KRN",9.2,1460,1,2,0)
established.  If the applicant is linked to an existing patient, the data
"KRN",9.2,1460,1,3,0)
from that patient record is displayed on the screen along side the 10-10EZ
"KRN",9.2,1460,1,4,0)
data for comparison.  If the applicant cannot be matched to an existing 
"KRN",9.2,1460,1,5,0)
patient record, then a new patient record is created.  Of course, in that
"KRN",9.2,1460,1,6,0)
case, no comparison data can be displayed.
"KRN",9.2,1460,1,7,0)
  
"KRN",9.2,1460,1,8,0)
If the linkage is found to be incorrect, the enrollment clerk will need
"KRN",9.2,1460,1,9,0)
to reset the status of the application back to NEW and restart the process.
"KRN",9.2,1460,1,10,0)
  
"KRN",9.2,1460,1,11,0)
Actions that may be performed for IN REVIEW Applications are:
"KRN",9.2,1460,1,12,0)
  
"KRN",9.2,1460,1,13,0)
[AF]  Accept Field
"KRN",9.2,1460,1,14,0)
[AZ]  Accept All
"KRN",9.2,1460,1,15,0)
[CZ]  Clear All
"KRN",9.2,1460,1,16,0)
[RZ]  Reset to New
"KRN",9.2,1460,1,17,0)
[PZ]  Print 1010EZ
"KRN",9.2,1460,1,18,0)
[VZ]  Verify Signature
"KRN",9.2,1460,1,19,0)
[UF]  Update Field
"KRN",9.2,1460,1,20,0)
[IZ]  Inactivate 1010EZ
"KRN",9.2,1460,2,0)
^9.22A^8^8
"KRN",9.2,1460,2,1,0)
AF^EAS EZ ACTION AF
"KRN",9.2,1460,2,2,0)
AZ^EAS EZ ACTION AZ
"KRN",9.2,1460,2,3,0)
CZ^EAS EZ ACTION CZ
"KRN",9.2,1460,2,4,0)
IZ^EAS EZ ACTION IZ
"KRN",9.2,1460,2,5,0)
PZ^EAS EZ ACTION PZ
"KRN",9.2,1460,2,6,0)
RZ^EAS EZ ACTION RZ
"KRN",9.2,1460,2,7,0)
UF^EAS EZ ACTION UF
"KRN",9.2,1460,2,8,0)
VZ^EAS EZ ACTION VZ
"KRN",9.2,1461,-1)
0^26
"KRN",9.2,1461,0)
EAS EZ STATUS PRINTED^PRINTED, PENDING SIGNATURE^3010328.100809^^
"KRN",9.2,1461,1,0)
^9.21^14^14^3010328^^^
"KRN",9.2,1461,1,1,0)
Once an Application has been printed using the Print 1010EZ (PZ) action, 
"KRN",9.2,1461,1,2,0)
its status becomes PRINTED, PENDING SIGNATURE.  The printed form will 
"KRN",9.2,1461,1,3,0)
contain the accepted data elements from the 10-10EZ. Data elements which 
"KRN",9.2,1461,1,4,0)
were not accepted will not be used.  If the applicant was matched to an 
"KRN",9.2,1461,1,5,0)
existing VISTA patient, then data from that patient record will be used 
"KRN",9.2,1461,1,6,0)
on the printed form in place of non-accepted 10-10EZ data elements. 
"KRN",9.2,1461,1,7,0)
  
"KRN",9.2,1461,1,8,0)
Actions that may be performed for PRINTED, PENDING SIGNATURE Applications 
"KRN",9.2,1461,1,9,0)
are:
"KRN",9.2,1461,1,10,0)
  
"KRN",9.2,1461,1,11,0)
[RZ]  Reset to New
"KRN",9.2,1461,1,12,0)
[PZ]  Print 1010EZ
"KRN",9.2,1461,1,13,0)
[VZ]  Verify Signature
"KRN",9.2,1461,1,14,0)
[IZ]  Inactivate 1010EZ
"KRN",9.2,1461,2,0)
^9.22A^4^4
"KRN",9.2,1461,2,1,0)
IZ^EAS EZ ACTION IZ
"KRN",9.2,1461,2,2,0)
PZ^EAS EZ ACTION PZ
"KRN",9.2,1461,2,3,0)
RZ^EAS EZ ACTION RZ
"KRN",9.2,1461,2,4,0)
VZ^EAS EZ ACTION VZ
"KRN",9.2,1462,-1)
0^27
"KRN",9.2,1462,0)
EAS EZ STATUS SIGNED^SIGNED^3010328.100833^^
"KRN",9.2,1462,1,0)
^9.21^17^17^3010510^^^^
"KRN",9.2,1462,1,1,0)
After the enrollment clerk verifies that a 10-10EZ form has been received 
"KRN",9.2,1462,1,2,0)
with the Applicant's signature, its status is SIGNED.
"KRN",9.2,1462,1,3,0)
  
"KRN",9.2,1462,1,4,0)
It is not necessary to use Print 1010EZ before using Verify Signature.  If
"KRN",9.2,1462,1,5,0)
the enrollment clerk has not made any significant change to the original 
"KRN",9.2,1462,1,6,0)
10-10EZ data, and if the Applicant sent a signed 10-10EZ to the site, then 
"KRN",9.2,1462,1,7,0)
the enrollment clerk can issue the VZ command when the application is 
"KRN",9.2,1462,1,8,0)
IN REVIEW.
"KRN",9.2,1462,1,9,0)
  
"KRN",9.2,1462,1,10,0)
Actions that may be performed for SIGNED Applications are:
"KRN",9.2,1462,1,11,0)
  
"KRN",9.2,1462,1,12,0)
[PZ]  Print 1010EZ
"KRN",9.2,1462,1,13,0)
[UF]  Update Field
"KRN",9.2,1462,1,14,0)
[FZ]  File 1010EZ
"KRN",9.2,1462,1,15,0)
  
"KRN",9.2,1462,1,16,0)
It is possible to remove signature verification from a 10-10EZ
"KRN",9.2,1462,1,17,0)
by invoking the [Remove Signature Verification] menu option.
"KRN",9.2,1462,2,0)
^9.22A^4^4
"KRN",9.2,1462,2,1,0)
FZ^EAS EZ ACTION FZ
"KRN",9.2,1462,2,2,0)
PZ^EAS EZ ACTION PZ
"KRN",9.2,1462,2,3,0)
UF^EAS EZ ACTION UF
"KRN",9.2,1462,2,4,0)
REMOVE SIGNATURE VERIFICATION^EAS EZ OPTION REMOVE SIG VERIF
"KRN",9.2,1463,-1)
0^22
"KRN",9.2,1463,0)
EAS EZ STATUS FILED^FILED^3010328.100847^^
"KRN",9.2,1463,1,0)
^9.21^13^13^3010530^^^^
"KRN",9.2,1463,1,1,0)
Only data from a SIGNED form may be FILED to VISTA.  Only accepted data will
"KRN",9.2,1463,1,2,0)
be placed in the Patient record.
"KRN",9.2,1463,1,3,0)
  
"KRN",9.2,1463,1,4,0)
After filing, the Applicant's data can be viewed and modified through other 
"KRN",9.2,1463,1,5,0)
VISTA functions, such as Registration and Means Testing.
"KRN",9.2,1463,1,6,0)
  
"KRN",9.2,1463,1,7,0)
Applications will remain on the FILED screen list for only 30 days after
"KRN",9.2,1463,1,8,0)
the filing date.  Use the 1010EZ [Quick Lookup] option to view basic
"KRN",9.2,1463,1,9,0)
information for any Application.
"KRN",9.2,1463,1,10,0)
  
"KRN",9.2,1463,1,11,0)
The only Action that may be performed for FILED Applications is:
"KRN",9.2,1463,1,12,0)
  
"KRN",9.2,1463,1,13,0)
[PZ]  Print 1010EZ
"KRN",9.2,1463,2,0)
^9.22A^2^2
"KRN",9.2,1463,2,1,0)
PZ^EAS EZ ACTION PZ
"KRN",9.2,1463,2,2,0)
QUICK LOOKUP^EAS EZ OPTION LOOKUP
"KRN",9.2,1464,-1)
0^24
"KRN",9.2,1464,0)
EAS EZ STATUS INACTIVE^INACTIVATED^3010328.100905^^
"KRN",9.2,1464,1,0)
^9.21^13^13^3010514^^^^
"KRN",9.2,1464,1,1,0)
It may be determined that an Application is invalid, cancelled, or for
"KRN",9.2,1464,1,2,0)
some reason cannot be processed further.  The enrollment clerk may 
"KRN",9.2,1464,1,3,0)
inactivate (i.e., close) the application to prevent inadvertent filing of 
"KRN",9.2,1464,1,4,0)
the data.
"KRN",9.2,1464,1,5,0)
  
"KRN",9.2,1464,1,6,0)
A 10-10EZ Application may be INACTIVATED at any time before it has been 
"KRN",9.2,1464,1,7,0)
SIGNED.
"KRN",9.2,1464,1,8,0)
  
"KRN",9.2,1464,1,9,0)
Applications will remain on the INACTIVATED screen list for only 30 days 
"KRN",9.2,1464,1,10,0)
after the inactivation date.  Use the 1010EZ [Quick Lookup] option to
"KRN",9.2,1464,1,11,0)
view basic information for any Application.
"KRN",9.2,1464,1,12,0)
  
"KRN",9.2,1464,1,13,0)
There are no Actions that may be used for INACTIVATED Applications.
"KRN",9.2,1464,2,0)
^9.22A^1^1
"KRN",9.2,1464,2,1,0)
QUICK LOOKUP^EAS EZ OPTION LOOKUP
"KRN",9.2,1465,-1)
0^21
"KRN",9.2,1465,0)
EAS EZ SCREEN INITIAL^INITIAL LIST MANAGER DISPLAY^3010328.1945^^
"KRN",9.2,1465,1,0)
^9.21^15^15^3010514^^^^
"KRN",9.2,1465,1,1,0)
A listing will be displayed for the Processing Status selected which
"KRN",9.2,1465,1,2,0)
shows all Applications in that status.  The sort order of the list is by 
"KRN",9.2,1465,1,3,0)
Station Number, and within Station Number by Applicant Name.
"KRN",9.2,1465,1,4,0)
  
"KRN",9.2,1465,1,5,0)
The data displayed on each line of the listing is as follows:
"KRN",9.2,1465,1,6,0)
  
"KRN",9.2,1465,1,7,0)
[Line #]  [Applicant]      [SSN]          [Vet. Type] [Rec'd]     [Print]  [To]    [App.#]
"KRN",9.2,1465,1,8,0)
   1    JONES,RALPH R. ***********  NSC       11/12/00  VA     599GB 108
"KRN",9.2,1465,1,9,0)
   
"KRN",9.2,1465,1,10,0)
A specific Application is selected from the list by entering the 
"KRN",9.2,1465,1,11,0)
appropriate [Line #].  In this example the Application appearing on
"KRN",9.2,1465,1,12,0)
Line #1 is selected for processing:
"KRN",9.2,1465,1,13,0)
  
"KRN",9.2,1465,1,14,0)
   Select Action: Next Screen//EZ=1
"KRN",9.2,1465,1,15,0)
  
"KRN",9.2,1465,2,0)
^9.22A^8^8
"KRN",9.2,1465,2,1,0)
APP.#^EAS EZ DEFINE APP#
"KRN",9.2,1465,2,2,0)
APPLICANT^EAS EZ DEFINE APPLICANT
"KRN",9.2,1465,2,3,0)
PRINT^EAS EZ DEFINE PRINT
"KRN",9.2,1465,2,4,0)
REC'D^EAS EZ DEFINE REC'D
"KRN",9.2,1465,2,5,0)
SSN^ES EZ DEFINE SSN
"KRN",9.2,1465,2,6,0)
TO^EAS EZ DEFINE TO
"KRN",9.2,1465,2,7,0)
VET. TYPE^EAS EZ DEFINE VET TYPE
"KRN",9.2,1465,2,8,0)
LINE #^EAS EZ DEFINE LINE#
"KRN",9.2,1466,-1)
0^6
"KRN",9.2,1466,0)
EAS EZ ACTION LZ^LINK TO PATIENT FILE (LZ)^3010328.112959^
"KRN",9.2,1466,1,0)
^9.21^8^8^3010328^^
"KRN",9.2,1466,1,1,0)
The veteran associated with a NEW Application must be 'linked' to
"KRN",9.2,1466,1,2,0)
the VistA Patient database.
"KRN",9.2,1466,1,3,0)
  
"KRN",9.2,1466,1,4,0)
The VistA Patient Lookup function is employed to match the applicant
"KRN",9.2,1466,1,5,0)
to an existing Patient OR to establish a new Patient record.
"KRN",9.2,1466,1,6,0)
 
"KRN",9.2,1466,1,7,0)
After this linkage is performed, the Processing Status of the 
"KRN",9.2,1466,1,8,0)
Application is IN REVIEW.
"KRN",9.2,1466,10.1)

"KRN",9.2,1466,10.2)

"KRN",9.2,1467,-1)
0^18
"KRN",9.2,1467,0)
EAS EZ OPTION LOOKUP^10-10EZ QUICK LOOKUP^3010328.135028^
"KRN",9.2,1467,1,0)
^9.21^13^13^3010514^^^
"KRN",9.2,1467,1,1,0)
10-10EZ Quick Lookup is an option of the main 10-10EZ Menu.  It can be 
"KRN",9.2,1467,1,2,0)
used to obtain basic data for any 10-10EZ Application, including its 
"KRN",9.2,1467,1,3,0)
current Processing Status.
"KRN",9.2,1467,1,4,0)
  
"KRN",9.2,1467,1,5,0)
Lookup can be done using the Application #, Web Submission ID, Applicant 
"KRN",9.2,1467,1,6,0)
Name, or Applicant SSN.  
"KRN",9.2,1467,1,7,0)
  
"KRN",9.2,1467,1,8,0)
The Applicant Name method is the only one of the four lookup methods that 
"KRN",9.2,1467,1,9,0)
uses alphabetic characters.  If Web Submission ID or Applicant SSN 
"KRN",9.2,1467,1,10,0)
methods are used, the characters must be entered exactly as provided by 
"KRN",9.2,1467,1,11,0)
the veteran in the On-Line 10-10EZ application.  An Applicant SSN must be 
"KRN",9.2,1467,1,12,0)
entered as nnn-nn-nnnn.  Likewise, a Web Submission ID must be entered as
"KRN",9.2,1467,1,13,0)
all numerics with hyphens inserted as needed.  
"KRN",9.2,1468,-1)
0^5
"KRN",9.2,1468,0)
EAS EZ ACTION IZ^INACTIVATE 1010EZ (IZ)^3010328.141053^
"KRN",9.2,1468,1,0)
^9.21^5^5^3010328^^
"KRN",9.2,1468,1,1,0)
Once the Application is INACTIVATED, it will no longer be available
"KRN",9.2,1468,1,2,0)
for processing.  It cannot be re-activated.
"KRN",9.2,1468,1,3,0)
  
"KRN",9.2,1468,1,4,0)
Use this action only if the Application is deemed invalid or is being
"KRN",9.2,1468,1,5,0)
replaced by a new Application for the same veteran.
"KRN",9.2,1469,-1)
0^7
"KRN",9.2,1469,0)
EAS EZ ACTION PZ^PRINT 1010EZ (PZ)^3010328.141326^
"KRN",9.2,1469,1,0)
^9.21^13^13^3010328^^^^
"KRN",9.2,1469,1,1,0)
The 10-10EZ form is printed using all 'accepted' data.  VistA Patient 
"KRN",9.2,1469,1,2,0)
data is used, if available, for any field not 'accepted'.
"KRN",9.2,1469,1,3,0)
  
"KRN",9.2,1469,1,4,0)
Form printing done by Print 1010EZ (PZ) must be queued to a valid
"KRN",9.2,1469,1,5,0)
print device capable of accommodating 132 characters per line.
"KRN",9.2,1469,1,6,0)
  
"KRN",9.2,1469,1,7,0)
Once the 10-10EZ is printed, actions of Accept Field, Accept All,
"KRN",9.2,1469,1,8,0)
Clear All, and Update Field can no longer be used.  The Processing
"KRN",9.2,1469,1,9,0)
Status becomes PRINTED, PENDING SIGNATURE.
"KRN",9.2,1469,1,10,0)
  
"KRN",9.2,1469,1,11,0)
The PZ action prints the 10-10EZ form with data.  But a simple printout
"KRN",9.2,1469,1,12,0)
of all data shown on the List Manager screens can be obtained by
"KRN",9.2,1469,1,13,0)
using the hidden action Print Screen (PS).
"KRN",9.2,1470,-1)
0^4
"KRN",9.2,1470,0)
EAS EZ ACTION FZ^FILE 1010EZ (FZ)^3010328.142016^
"KRN",9.2,1470,1,0)
^9.21^18^18^3010514^^^
"KRN",9.2,1470,1,1,0)
All 'accepted' data elements on the 10-10EZ are filed to the VistA 
"KRN",9.2,1470,1,2,0)
Patient database through the File 1010EZ (FZ) action, and the Processing
"KRN",9.2,1470,1,3,0)
Status of the Application is FILED.
"KRN",9.2,1470,1,4,0)
  
"KRN",9.2,1470,1,5,0)
In most cases, 10-10EZ data elements will overwrite any existing data in
"KRN",9.2,1470,1,6,0)
VistA.  Exceptions are as follows:
"KRN",9.2,1470,1,7,0)
  
"KRN",9.2,1470,1,8,0)
(1) The Patient's Name, SSN, and Date of Birth cannot be overwritten.
"KRN",9.2,1470,1,9,0)
(2) Eligibility related data cannot be overwritten if the Patient's
"KRN",9.2,1470,1,10,0)
    Eligibility Status is "Verified" by HEC.
"KRN",9.2,1470,1,11,0)
(3) The Purple Heart indicator cannot be filed.
"KRN",9.2,1470,1,12,0)
(4) If the site holds an income test on the Patient for the current 
"KRN",9.2,1470,1,13,0)
    income year, then income data cannot be filed.  This includes 
"KRN",9.2,1470,1,14,0)
    Spouse and Dependent data.
"KRN",9.2,1470,1,15,0)
  
"KRN",9.2,1470,1,16,0)
Also note, health insurance and Medicare data are not directly filed
"KRN",9.2,1470,1,17,0)
to the Patient record.  Instead, this data is placed in the Insurance
"KRN",9.2,1470,1,18,0)
Buffer file for processing by Integrated Billing (MCCR).
"KRN",9.2,1471,-1)
0^1
"KRN",9.2,1471,0)
EAS EZ ACTION AF^ACCEPT FIELD (AF)^3010328.143251^
"KRN",9.2,1471,1,0)
^9.21^16^16^3010328^^^
"KRN",9.2,1471,1,1,0)
10-10EZ data can be 'accepted' on a field-by-field basis for later filing
"KRN",9.2,1471,1,2,0)
into the VistA Patient database by using the Accept Field (AF) action.
"KRN",9.2,1471,1,3,0)
An 'accepted' data element is indicated by display of the data in
"KRN",9.2,1471,1,4,0)
reverse video format.
"KRN",9.2,1471,1,5,0)
  
"KRN",9.2,1471,1,6,0)
Using this action on a previously 'accepted' data element, removes the
"KRN",9.2,1471,1,7,0)
'accepted' indicator.
"KRN",9.2,1471,1,8,0)
  
"KRN",9.2,1471,1,9,0)
Applications for persons who are new to the Patient database will appear on
"KRN",9.2,1471,1,10,0)
the List Manager screens with all data elements 'accepted'.  If necessary,
"KRN",9.2,1471,1,11,0)
use the ACCEPT FIELD action to remove the 'accepted' indicator.
"KRN",9.2,1471,1,12,0)
  
"KRN",9.2,1471,1,13,0)
Also note, financial data for all Applicants is automatically 'accepted', 
"KRN",9.2,1471,1,14,0)
and the 'accepted' indicator cannot be removed.  Financial data includes
"KRN",9.2,1471,1,15,0)
health insurance and Medicare information, Spouse and Dependent demographic
"KRN",9.2,1471,1,16,0)
data, as well as all income data.
"KRN",9.2,1472,-1)
0^2
"KRN",9.2,1472,0)
EAS EZ ACTION AZ^ACCEPT ALL (AZ)^3010328.150406^
"KRN",9.2,1472,1,0)
^9.21^12^12^3010510^^^
"KRN",9.2,1472,1,1,0)
All 10-10 EZ data elements can be 'accepted' for later filing into the 
"KRN",9.2,1472,1,2,0)
VistA Patient database by the Accept All (AZ) action.
"KRN",9.2,1472,1,3,0)
  
"KRN",9.2,1472,1,4,0)
Applications for persons who are new to the Patient database will always 
"KRN",9.2,1472,1,5,0)
appear on the List Manager screens with all data elements 'accepted'.  If 
"KRN",9.2,1472,1,6,0)
necessary, use the ACCEPT FIELD action to remove the 'accepted' indicator
"KRN",9.2,1472,1,7,0)
on individual fields.
"KRN",9.2,1472,1,8,0)
  
"KRN",9.2,1472,1,9,0)
Also note, financial data for all Applicants is automatically 'accepted', 
"KRN",9.2,1472,1,10,0)
and the 'accepted' indicator cannot be removed.  Financial data includes
"KRN",9.2,1472,1,11,0)
health insurance and Medicare information, Spouse and Dependent demographic
"KRN",9.2,1472,1,12,0)
data, as well as all income data.
"KRN",9.2,1473,-1)
0^3
"KRN",9.2,1473,0)
EAS EZ ACTION CZ^CLEAR ALL (CZ)^3010328.164129^
"KRN",9.2,1473,1,0)
^9.21^2^2^3010328^^
"KRN",9.2,1473,1,1,0)
The CLEAR ALL (CZ) action will remove the 'accepted' indicator from any 
"KRN",9.2,1473,1,2,0)
fields previously 'accepted' using ACCEPT FIELD (AF) or ACCEPT ALL (AZ).
"KRN",9.2,1474,-1)
0^8
"KRN",9.2,1474,0)
EAS EZ ACTION RZ^RESET TO NEW (RZ)^3010328.164613^
"KRN",9.2,1474,1,0)
^9.21^6^6^3010328^^
"KRN",9.2,1474,1,1,0)
The Reset to New (RZ) action returns the Application to the NEW 
"KRN",9.2,1474,1,2,0)
Processing Status.  All 'accepted' indicators are removed, any data
"KRN",9.2,1474,1,3,0)
entered through Update Field (UF) is deleted, and all processing
"KRN",9.2,1474,1,4,0)
history is cleared.
"KRN",9.2,1474,1,5,0)
  
"KRN",9.2,1474,1,6,0)
The Applicant can be re-linked to the VistA Patient database.
"KRN",9.2,1475,-1)
0^10
"KRN",9.2,1475,0)
EAS EZ ACTION VZ^VERIFY SIGNATURE (VZ)^3010328.165634^^
"KRN",9.2,1475,1,0)
^9.21^6^6^3010406^^^^
"KRN",9.2,1475,1,1,0)
Confirmation that the Applicant's signature appears on the printed
"KRN",9.2,1475,1,2,0)
10-10EZ is done through the Verify Signature (VZ) action.  The 
"KRN",9.2,1475,1,3,0)
Processing Status of the Application then becomes SIGNED.
"KRN",9.2,1475,1,4,0)
  
"KRN",9.2,1475,1,5,0)
It is possible to remove signature verification from a 10-10EZ
"KRN",9.2,1475,1,6,0)
by invoking the [Remove Signature Verification] menu option.
"KRN",9.2,1475,2,0)
^9.22A^1^1
"KRN",9.2,1475,2,1,0)
REMOVE SIGNATURE VERIFICATION^EAS EZ OPTION REMOVE SIG VERIF
"KRN",9.2,1476,-1)
0^9
"KRN",9.2,1476,0)
EAS EZ ACTION UF^UPDATE FIELD (UF)^3010328.165735^
"KRN",9.2,1476,1,0)
^9.21^8^8^3010328^^^
"KRN",9.2,1476,1,1,0)
The original value of a 10-10 EZ data element can be overwritten by the 
"KRN",9.2,1476,1,2,0)
user through the Update Field (UF) action.
"KRN",9.2,1476,1,3,0)
  
"KRN",9.2,1476,1,4,0)
This action should be used to enter any hand-written changes the Applicant
"KRN",9.2,1476,1,5,0)
makes to the signed 10-10EZ.
"KRN",9.2,1476,1,6,0)
  
"KRN",9.2,1476,1,7,0)
An 'updated' field is automatically 'accepted' for filing into the 
"KRN",9.2,1476,1,8,0)
VistA Patient record.  The 'accepted' indicator cannot be removed.
"KRN",9.2,1477,-1)
0^13
"KRN",9.2,1477,0)
EAS EZ DEFINE LINE#^Line # Column^3010328.184121^
"KRN",9.2,1477,1,0)
^^3^3^3010328^
"KRN",9.2,1477,1,1,0)
The Line # column is the first column of the initial List Manager
"KRN",9.2,1477,1,2,0)
screen display.  It is a simple, sequential number used to select
"KRN",9.2,1477,1,3,0)
an Application for further processing.
"KRN",9.2,1478,-1)
0^12
"KRN",9.2,1478,0)
EAS EZ DEFINE APPLICANT^Applicant Column^3010328.184229^
"KRN",9.2,1478,1,0)
^9.21^3^3^3010514^^^
"KRN",9.2,1478,1,1,0)
Applicant is the second column of the initial List Manager screen
"KRN",9.2,1478,1,2,0)
display.  The Applicant's Name as entered in the On-Line 10-10EZ
"KRN",9.2,1478,1,3,0)
appears in this column.
"KRN",9.2,1480,-1)
0^17
"KRN",9.2,1480,0)
EAS EZ DEFINE VET TYPE^Vet. Type Column^3010328.184348^
"KRN",9.2,1480,1,0)
^9.21^14^14^3010328^^
"KRN",9.2,1480,1,1,0)
Vet. Type is the fourth column of the initial List Manager screen
"KRN",9.2,1480,1,2,0)
display.  Veteran Type is derived from data that the Applicant has
"KRN",9.2,1480,1,3,0)
provided in the On-Line 10-10EZ.
"KRN",9.2,1480,1,4,0)
 
"KRN",9.2,1480,1,5,0)
There are six possible values that may appear in the Vet. Type
"KRN",9.2,1480,1,6,0)
column:
"KRN",9.2,1480,1,7,0)
  
"KRN",9.2,1480,1,8,0)
   NSC
"KRN",9.2,1480,1,9,0)
   SC 0%
"KRN",9.2,1480,1,10,0)
   SC <50%
"KRN",9.2,1480,1,11,0)
   SC 50-100%
"KRN",9.2,1480,1,12,0)
   MIL. RETIREE
"KRN",9.2,1480,1,13,0)
   POW
"KRN",9.2,1480,1,14,0)
   PURPLE HEART
"KRN",9.2,1481,-1)
0^15
"KRN",9.2,1481,0)
EAS EZ DEFINE REC'D^Rec'd Column^3010328.184426^
"KRN",9.2,1481,1,0)
^9.21^3^3^3010328^^
"KRN",9.2,1481,1,1,0)
The date appearing in the Rec'd column of the initial List Manager
"KRN",9.2,1481,1,2,0)
display screen indicates the date on which the Application was
"KRN",9.2,1481,1,3,0)
electronically received by the facility VistA system.
"KRN",9.2,1482,-1)
0^14
"KRN",9.2,1482,0)
EAS EZ DEFINE PRINT^Print Column^3010328.184458^
"KRN",9.2,1482,1,0)
^9.21^9^9^3010514^^^
"KRN",9.2,1482,1,1,0)
Print is the sixth column of the initial List Manager screen
"KRN",9.2,1482,1,2,0)
display.  One of two values will be displayed in this column:
"KRN",9.2,1482,1,3,0)
  
"KRN",9.2,1482,1,4,0)
   Vet ==> The veteran has indicated that he will print and
"KRN",9.2,1482,1,5,0)
           sign the 10-10EZ and mail it to the VA facility.
"KRN",9.2,1482,1,6,0)
 
"KRN",9.2,1482,1,7,0)
   VA  ==> The veteran has indicated that he will not print
"KRN",9.2,1482,1,8,0)
           the 10-10EZ form.  The VA facility should print
"KRN",9.2,1482,1,9,0)
           the form and send it to the veteran for signature.
"KRN",9.2,1483,-1)
0^16
"KRN",9.2,1483,0)
EAS EZ DEFINE TO^To Column^3010328.184527^
"KRN",9.2,1483,1,0)
^^7^7^3010328^
"KRN",9.2,1483,1,1,0)
The To column is the next-to-last column on the initial List Manager
"KRN",9.2,1483,1,2,0)
screen display.  This column shows the Station Number of the
"KRN",9.2,1483,1,3,0)
VHA facility which the Applicant has designated as his Preferred
"KRN",9.2,1483,1,4,0)
Facility.
"KRN",9.2,1483,1,5,0)
  
"KRN",9.2,1483,1,6,0)
The Applications appearing on the displayed list are sorted by
"KRN",9.2,1483,1,7,0)
Station Number, then within Station Number by Applicant Name.
"KRN",9.2,1484,-1)
0^11
"KRN",9.2,1484,0)
EAS EZ DEFINE APP#^App.# Column^3010328.184601^
"KRN",9.2,1484,1,0)
^^3^3^3010328^
"KRN",9.2,1484,1,1,0)
The App.# column is the last column on the initial List Manager
"KRN",9.2,1484,1,2,0)
screen display.  The number appearing in this column is the 
"KRN",9.2,1484,1,3,0)
unique number assigned by the 1010EZ module to the Application.
"KRN",9.2,1485,-1)
0^20
"KRN",9.2,1485,0)
EAS EZ OPTION REMOVE SIG VERIF^REMOVE SIGNATURE VERIFICATION^3010406.172404^
"KRN",9.2,1485,1,0)
^^5^5^3010406^
"KRN",9.2,1485,1,1,0)
This 1010EZ menu option allows the user to remove signature
"KRN",9.2,1485,1,2,0)
verification from a 10-10EZ Application.  The status of the
"KRN",9.2,1485,1,3,0)
Application will revert from 'Signed' to either 'In Review'
"KRN",9.2,1485,1,4,0)
or 'Printed, Pending Signature' as appropriate for the
"KRN",9.2,1485,1,5,0)
Application.
"KRN",9.2,1486,-1)
0^28
"KRN",9.2,1486,0)
EAS EZ DEFINE SSN^SSN Column^3010514.163412^^
"KRN",9.2,1486,1,0)
^9.21^3^3^3010514^^
"KRN",9.2,1486,1,1,0)
SSN is the third column of the initial List Manager screen display.
"KRN",9.2,1486,1,2,0)
This column shows the veteran's Social Security Number (SSN) as
"KRN",9.2,1486,1,3,0)
entered by the veteran in the On-Line 10-10EZ.
"KRN",19,10682,-1)
2^2
"KRN",19,10682,0)
EAS EZ MENU^10-10EZ Menu^^M^66471^^^^^^^552
"KRN",19,10682,10,0)
^19.01IP^5^5
"KRN",19,10682,10,3,0)
10692^RS^3
"KRN",19,10682,10,3,"^")
EAS EZ REMOVE SIGNATURE
"KRN",19,10682,"U")
10-10EZ MENU
"KRN",19,10692,-1)
0^1
"KRN",19,10692,0)
EAS EZ REMOVE SIGNATURE^Remove Signature Verification^^R^^^^^^^^ENROLLMENT APPLICATION SYSTEM
"KRN",19,10692,1,0)
^19.06^3^3^3010406^^
"KRN",19,10692,1,1,0)
Allows the user to remove Signature Verification from the 1010EZ
"KRN",19,10692,1,2,0)
Application.  The status of the Application reverts from 'Signed'
"KRN",19,10692,1,3,0)
to either 'Printed, Pending Signature' or 'In Review'.  
"KRN",19,10692,25)
REMSIG^EASEZU5
"KRN",19,10692,"U")
REMOVE SIGNATURE VERIFICATION
"MBREQ")
0
"ORD",1,9.2)
9.2;1;;;HELP^XPDTA1;HLPF1^XPDIA1;HLPE1^XPDIA1;HLPF2^XPDIA1;;HLPDEL^XPDIA1
"ORD",1,9.2,0)
HELP FRAME
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",552,-1)
1^1
"PKG",552,0)
ENROLLMENT APPLICATION SYSTEM^EAS^ENROLLMENT
"PKG",552,20,0)
^9.402P^^
"PKG",552,22,0)
^9.49I^1^1
"PKG",552,22,1,0)
1.0^3010315^3010419^66481
"PKG",552,22,1,"PAH",1,0)
1^3010530^66471
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
15
"RTN","EAS1P")
0^15^B1106821
"RTN","EAS1P",1,0)
EAS1P ;ALB/jap - Post-Installation for EAS*1*1 ;04/19/2001 
"RTN","EAS1P",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EAS1P",3,0)
 ;
"RTN","EAS1P",4,0)
 ;update all EAS options with correct Package name
"RTN","EAS1P",5,0)
 ;
"RTN","EAS1P",6,0)
 ;find EAS package
"RTN","EAS1P",7,0)
 N DIC,DIE,DA,DR,X,Y,OPT,OIEN,PACK
"RTN","EAS1P",8,0)
 W !
"RTN","EAS1P",9,0)
 S X="ENROLLMENT APPLICATION SYSTEM",DIC="^DIC(9.4,",DIC(0)="XZ"
"RTN","EAS1P",10,0)
 D ^DIC
"RTN","EAS1P",11,0)
 Q:+Y<1
"RTN","EAS1P",12,0)
 S PACK=+Y
"RTN","EAS1P",13,0)
 F A="1010EZ PROCESSING","MENU","QUICK LOOKUP","REMOVE SIGNATURE","SERVER" D
"RTN","EAS1P",14,0)
 .S (OPT,X)="EAS EZ "_A,DIC="^DIC(19,",DIC(0)="XZ"
"RTN","EAS1P",15,0)
 .D ^DIC
"RTN","EAS1P",16,0)
 .Q:+Y<1
"RTN","EAS1P",17,0)
 .S OIEN=+Y
"RTN","EAS1P",18,0)
 .S DIE=DIC,DA=OIEN,DR="12///^S X=PACK"
"RTN","EAS1P",19,0)
 .D ^DIE
"RTN","EAS1P",20,0)
 .W !,OPT
"RTN","EAS1P",21,0)
 W !,"Completed update of Package field in File #19 for EAS Options...",!
"RTN","EAS1P",22,0)
 Q
"RTN","EASEZC1")
0^1^B39744614
"RTN","EASEZC1",1,0)
EASEZC1 ;ALB/jap - Compare 1010EZ Data with VistA Database ;10/16/00  13:08
"RTN","EASEZC1",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZC1",3,0)
 ;
"RTN","EASEZC1",4,0)
EN(EASAPP,EASDFN) ;this entry point is called as soon as user has selected an Application
"RTN","EASEZC1",5,0)
 ;
"RTN","EASEZC1",6,0)
 ;input  
"RTN","EASEZC1",7,0)
 ;  EASAPP = application ien in file #712
"RTN","EASEZC1",8,0)
 ;  EASDFN = ien in file #2; if 0, then application not yet linked to file #2
"RTN","EASEZC1",9,0)
 ;output
"RTN","EASEZC1",10,0)
 ;  ^TMP("EZDATA"  where
"RTN","EASEZC1",11,0)
 ;  ^TMP("EZDATA",$J,ien_file711)=file#^subfile#^field#^data_id
"RTN","EASEZC1",12,0)
 ;  ^TMP("EZDATA",$J,ien_file711,multiple,1)=ezdata^accept_flag^subien_subfile712.01
"RTN","EASEZC1",13,0)
 ;  ^TMP("EZDATA",$J,ien_file711,multiple,2)=vista_data^link_ien
"RTN","EASEZC1",14,0)
 ;
"RTN","EASEZC1",15,0)
 N IEN,KEY,SUBIEN,ACCEPT,FFF,LINK,MULTIPLE,ORIG,UPD,X,Y,C2711KEY
"RTN","EASEZC1",16,0)
 ;don't continue if passed in dfn doesn't match link
"RTN","EASEZC1",17,0)
 I $G(EASDFN),$P($G(^EAS(712,EASAPP,0)),U,10)'=EASDFN S EASDFN="" Q
"RTN","EASEZC1",18,0)
 ;don't continue if link to file #2 not available
"RTN","EASEZC1",19,0)
 I '$G(EASDFN) S EASDFN=+$P($G(^EAS(712,EASAPP,0)),U,10)
"RTN","EASEZC1",20,0)
 ;if applicant is new to database, user accept/not accept of data elements is constrained 
"RTN","EASEZC1",21,0)
 S EASEZNEW=$P(^EAS(712,EASAPP,0),U,11)
"RTN","EASEZC1",22,0)
 ;
"RTN","EASEZC1",23,0)
 ; setup local mapping array
"RTN","EASEZC1",24,0)
 D LOCAL711^EASEZU2
"RTN","EASEZC1",25,0)
 ;need this for later
"RTN","EASEZC1",26,0)
 S C2711KEY=+$$KEY711^EASEZU1("TYPE OF BENEFIT-ENROLLMENT")
"RTN","EASEZC1",27,0)
 ;correlate #712 data with tmp mapping array
"RTN","EASEZC1",28,0)
 S SUBIEN=0 F  S SUBIEN=$O(^EAS(712,EASAPP,10,SUBIEN)) Q:'SUBIEN  D
"RTN","EASEZC1",29,0)
 .S X=^EAS(712,EASAPP,10,SUBIEN,0)
"RTN","EASEZC1",30,0)
 .S (IEN,KEY)=$P(X,U,1),MULTIPLE=$P(X,U,2),ACCEPT=$P(X,U,3),FFF=$P(^TMP("EZDATA",$J,IEN),U,1,3)
"RTN","EASEZC1",31,0)
 .S X=$G(^EAS(712,EASAPP,10,SUBIEN,1)),ORIG=$P(X,U,1),UPD=$P(X,U,2)
"RTN","EASEZC1",32,0)
 .;if link exists, it is pointer to Vista database record for an existing patient
"RTN","EASEZC1",33,0)
 .;  or possibly a 'new' patient (i.e., this applicant's data), if this is done post filing
"RTN","EASEZC1",34,0)
 .S LINK=$P($G(^EAS(712,EASAPP,10,SUBIEN,2)),U,2)
"RTN","EASEZC1",35,0)
 .;eliminate some garbage from web app
"RTN","EASEZC1",36,0)
 .I (ORIG="-")!(ORIG="--")!(ORIG="//") S ORIG=""
"RTN","EASEZC1",37,0)
 .Q:((ORIG="")&(UPD=""))
"RTN","EASEZC1",38,0)
 .I UPD="" S ^TMP("EZDATA",$J,IEN,MULTIPLE,1)=ORIG_U_ACCEPT_U_SUBIEN
"RTN","EASEZC1",39,0)
 .E  S ^TMP("EZDATA",$J,IEN,MULTIPLE,1)=UPD_U_ACCEPT_U_SUBIEN
"RTN","EASEZC1",40,0)
 .;if this applicant is new to VistA database, there is no existing patient data for comparison
"RTN","EASEZC1",41,0)
 .;just pickup name,ssn,dob anyway;
"RTN","EASEZC1",42,0)
 .I EASEZNEW,EASDFN D
"RTN","EASEZC1",43,0)
 ..S F=$P(FFF,U,1),SF=$P(FFF,U,2),FD=$P(FFF,U,3)
"RTN","EASEZC1",44,0)
 ..I F=2,SF=2 I (FD=.01)!(FD=.02)!(FD=.03)!(FD=.09) S LINK=EASDFN
"RTN","EASEZC1",45,0)
 ..K F,SF,FD
"RTN","EASEZC1",46,0)
 .;if link to database exists then get VistA data into tmp array
"RTN","EASEZC1",47,0)
 .I 'LINK,$P(FFF,U,1)=2 S LINK=EASDFN
"RTN","EASEZC1",48,0)
 .I LINK D
"RTN","EASEZC1",49,0)
 ..S X=$$GET(LINK,FFF) S:X=-1 X="" S ^TMP("EZDATA",$J,IEN,MULTIPLE,2)=X_U_LINK
"RTN","EASEZC1",50,0)
 ..;special for file #27.11 (Enrollment) data
"RTN","EASEZC1",51,0)
 ..I KEY=C2711KEY D 
"RTN","EASEZC1",52,0)
 ...S CUR=$P($G(^EAS(712,EASAPP,10,SUBIEN,2)),U,2)
"RTN","EASEZC1",53,0)
 ...D ENR(CUR,.VDATA) K CUR
"RTN","EASEZC1",54,0)
 ...S ^TMP("EZDATA",$J,IEN,MULTIPLE,2)=VDATA_U_LINK K VDATA
"RTN","EASEZC1",55,0)
 ..I $G(^TMP("EZDATA",$J,IEN,MULTIPLE,1))="" S ^TMP("EZDATA",$J,IEN,MULTIPLE,1)=U_ACCEPT_U_SUBIEN
"RTN","EASEZC1",56,0)
 ;set 'transformed' data into ^TMP("EZDISP" array
"RTN","EASEZC1",57,0)
 D SORT^EASEZC3(EASAPP)
"RTN","EASEZC1",58,0)
 Q
"RTN","EASEZC1",59,0)
 ;
"RTN","EASEZC1",60,0)
GET(EASLINK,EASFFF) ;get data from existing Patient database
"RTN","EASEZC1",61,0)
 ;input EASLINK  = IEN(s) needed
"RTN","EASEZC1",62,0)
 ;              format: file_ien;subfile_ien
"RTN","EASEZC1",63,0)
 ;       EASFFF = field # for file or subfile
"RTN","EASEZC1",64,0)
 ;              format: file#^subfile#^field#
"RTN","EASEZC1",65,0)
 ;output RTR = data obtained from Patient database; external format;
"RTN","EASEZC1",66,0)
 ;             OR -1 if invalid input
"RTN","EASEZC1",67,0)
 ;
"RTN","EASEZC1",68,0)
 N FILE,SUBFILE,FIELD,RTR,ARRAY,DA,DR,DIC,DIQ,X,Y
"RTN","EASEZC1",69,0)
 S FILE=$P(EASFFF,U,1),SUBFILE=$P(EASFFF,U,2),FIELD=$P(EASFFF,U,3)
"RTN","EASEZC1",70,0)
 I ('FILE)!('FIELD) Q -1
"RTN","EASEZC1",71,0)
 I SUBFILE,SUBFILE'=FILE,EASLINK'[";" Q -1
"RTN","EASEZC1",72,0)
 I EASLINK[";",SUBFILE="" Q -1
"RTN","EASEZC1",73,0)
 ;
"RTN","EASEZC1",74,0)
 I (SUBFILE="")!(SUBFILE=FILE) D
"RTN","EASEZC1",75,0)
 .;data in main file
"RTN","EASEZC1",76,0)
 .S DIQ="ARRAY",DIQ(0)="E",DA=EASLINK,DR=FIELD,DIC=FILE
"RTN","EASEZC1",77,0)
 .D EN^DIQ1
"RTN","EASEZC1",78,0)
 .S RTR=$G(ARRAY(FILE,EASLINK,FIELD,"E"))
"RTN","EASEZC1",79,0)
 I SUBFILE'="",SUBFILE'=FILE D
"RTN","EASEZC1",80,0)
 .;data in subfile
"RTN","EASEZC1",81,0)
 .;in this case EASLINK = file_ien;subfile_ien
"RTN","EASEZC1",82,0)
 .S DIQ="ARRAY",DIQ(0)="E",DA=$P(EASLINK,";",1),DIC=FILE
"RTN","EASEZC1",83,0)
 .;get field # for subfile
"RTN","EASEZC1",84,0)
 .S DR=$O(^DD(FILE,"SB",SUBFILE,0))
"RTN","EASEZC1",85,0)
 .S DR(SUBFILE)=FIELD,DA(SUBFILE)=$P(EASLINK,";",2)
"RTN","EASEZC1",86,0)
 .D EN^DIQ1
"RTN","EASEZC1",87,0)
 .S RTR=$G(ARRAY(SUBFILE,$P(EASLINK,";",2),FIELD,"E"))
"RTN","EASEZC1",88,0)
 Q RTR
"RTN","EASEZC1",89,0)
 ;
"RTN","EASEZC1",90,0)
 ;
"RTN","EASEZC1",91,0)
C2 ;get data from file #2 into local array L711
"RTN","EASEZC1",92,0)
 ;there are alot of fields; quickest just to order thru local mapping file
"RTN","EASEZC1",93,0)
 ;
"RTN","EASEZC1",94,0)
 N KEY,MAP,VDATA,EASAEL
"RTN","EASEZC1",95,0)
 ;2nd subscript for array is always 1 (no multiples)
"RTN","EASEZC1",96,0)
 S KEY=0 F  S KEY=$O(^TMP("EZDATA",$J,KEY)) Q:'KEY  S MAP=^TMP("EZDATA",$J,KEY) I ($P(MAP,U,1)=2)&($P(MAP,U,2)=2) D
"RTN","EASEZC1",97,0)
 .S EASAEL=$P($G(^TMP("EZDATA",$J,KEY,1,1)),U,3)
"RTN","EASEZC1",98,0)
 .S VDATA=$$GET(EASDFN,MAP)
"RTN","EASEZC1",99,0)
 .Q:VDATA=-1  Q:VDATA=""
"RTN","EASEZC1",100,0)
 .;ien to #711 is 1st subscript of local array is 
"RTN","EASEZC1",101,0)
 .S ^TMP("EZDATA",$J,KEY,1,2)=VDATA
"RTN","EASEZC1",102,0)
 .;if data exists in 1010EZ then insert link to file #2
"RTN","EASEZC1",103,0)
 .I EASAEL D LINKUP^EASEZU1(EASAPP,EASAEL,EASDFN)
"RTN","EASEZC1",104,0)
 .;if data does not exist in 1010EZ add subrecord to hold link
"RTN","EASEZC1",105,0)
 .I 'EASAEL D ADD71201^EASEZU1(EASAPP,KEY,EASDFN,1)
"RTN","EASEZC1",106,0)
 Q
"RTN","EASEZC1",107,0)
 ;
"RTN","EASEZC1",108,0)
C201 ;get data in Alias subfile #2.01 into local array L711
"RTN","EASEZC1",109,0)
 ;  using ien(s) local array ALIAS
"RTN","EASEZC1",110,0)
 ;
"RTN","EASEZC1",111,0)
 ;for Alias name(s) - if other name on 1010EZ doesn't match any on file
"RTN","EASEZC1",112,0)
 ;   then it will be auto-accepted; comparision only with matching name if any.
"RTN","EASEZC1",113,0)
 N X,M,B,ADATA,VDATA,KEY,EASAEL
"RTN","EASEZC1",114,0)
 S KEY=+$$KEY711^EASEZU1("APPLICANT OTHER NAME")
"RTN","EASEZC1",115,0)
 S M=0 F  S M=$O(^TMP("EZDATA",$J,KEY,M)) Q:'M  D
"RTN","EASEZC1",116,0)
 .S ADATA=$P(^TMP("EZDATA",$J,KEY,M,1),U,1)
"RTN","EASEZC1",117,0)
 .S B=0 F  S B=$O(ALIAS(B)) Q:'B  D
"RTN","EASEZC1",118,0)
 ..S VDATA=$$GET(ALIAS(B),^TMP("EZDATA",$J,KEY)) Q:VDATA=-1
"RTN","EASEZC1",119,0)
 ..I VDATA=ADATA D
"RTN","EASEZC1",120,0)
 ...S ^TMP("EZDATA",$J,KEY,M,2)=VDATA
"RTN","EASEZC1",121,0)
 ...S EASAEL=$P(^TMP("EZDATA",$J,KEY,M,1),U,3)
"RTN","EASEZC1",122,0)
 ...;only insert link if data exists in 1010EZ
"RTN","EASEZC1",123,0)
 ...I EASAEL D LINKUP^EASEZU1(EASAPP,EASAEL,ALIAS(B))
"RTN","EASEZC1",124,0)
 Q
"RTN","EASEZC1",125,0)
 ;
"RTN","EASEZC1",126,0)
C2101 ;get data in Disposition subfile #2.101 into local array L711
"RTN","EASEZC1",127,0)
 ;  using ien(s) local array DISPOS
"RTN","EASEZC1",128,0)
 ;
"RTN","EASEZC1",129,0)
 ;display data on most recent registration if any
"RTN","EASEZC1",130,0)
 ;2nd subscript of local array always 1 (no multiples)
"RTN","EASEZC1",131,0)
 N B,X,FLD,KEY,ADATA,VDATA,EASAEL
"RTN","EASEZC1",132,0)
 S FLD=0 F  S FLD=$O(^TMP("EZINDEX","A",2,2.101,FLD)) Q:FLD=""  D
"RTN","EASEZC1",133,0)
 .S KEY=$O(^TMP("EZINDEX","A",2,2.101,FLD,0))
"RTN","EASEZC1",134,0)
 .S ADATA=$G(^TMP("EZDATA",$J,KEY,1,1))
"RTN","EASEZC1",135,0)
 .S VDATA=$$GET(DISPOS(1),^TMP("EZDATA",$J,KEY))
"RTN","EASEZC1",136,0)
 .Q:VDATA=-1  Q:VDATA=""
"RTN","EASEZC1",137,0)
 .S ^TMP("EZDATA",$J,KEY,1,2)=VDATA
"RTN","EASEZC1",138,0)
 .S EASAEL=$P($G(^TMP("EZDATA",$J,KEY,1,1)),U,3)
"RTN","EASEZC1",139,0)
 .;if data exists in 1010EZ then insert link
"RTN","EASEZC1",140,0)
 .I EASAEL D LINKUP^EASEZU1(EASAPP,EASAEL,DISPOS(1)) Q
"RTN","EASEZC1",141,0)
 .;if data does not exist in 1010EZ add subrecord to hold link
"RTN","EASEZC1",142,0)
 .I 'EASAEL D ADD71201^EASEZU1(EASAPP,KEY,DISPOS(1),1)
"RTN","EASEZC1",143,0)
 Q
"RTN","EASEZC1",144,0)
 ;
"RTN","EASEZC1",145,0)
C2711 ;get data in Current Enrollment #27.11 into local array L711
"RTN","EASEZC1",146,0)
 ;  using ien(s) local array ENROLL
"RTN","EASEZC1",147,0)
 ;
"RTN","EASEZC1",148,0)
 ;2nd subscript of local array always 1 (no multiples)
"RTN","EASEZC1",149,0)
 N X,M,B,ADATA,CUR,DGENR,VDATA,KEY,EASAEL
"RTN","EASEZC1",150,0)
 S KEY=+$$KEY711^EASEZU1("TYPE OF BENEFIT-ENROLLMENT")
"RTN","EASEZC1",151,0)
 S CUR=$G(ENROLL(1)),VDATA=""
"RTN","EASEZC1",152,0)
 Q:CUR=-1
"RTN","EASEZC1",153,0)
 Q:CUR=""
"RTN","EASEZC1",154,0)
 D ENR(CUR,.VDATA)
"RTN","EASEZC1",155,0)
 S ^TMP("EZDATA",$J,KEY,1,2)=VDATA
"RTN","EASEZC1",156,0)
 S EASAEL=$P($G(^TMP("EZDATA",$J,KEY,1,1)),U,3)
"RTN","EASEZC1",157,0)
 ;if data exists in 1010EZ then insert link
"RTN","EASEZC1",158,0)
 I EASAEL D LINKUP^EASEZU1(EASAPP,EASAEL,CUR)
"RTN","EASEZC1",159,0)
 ;if data does not exist in 1010EZ add subrecord to hold link
"RTN","EASEZC1",160,0)
 I 'EASAEL D ADD71201^EASEZU1(EASAPP,KEY,CUR,1)
"RTN","EASEZC1",161,0)
 Q
"RTN","EASEZC1",162,0)
 ;
"RTN","EASEZC1",163,0)
ENR(CUR,VDATA) ;get data for current enrollment from VistA database
"RTN","EASEZC1",164,0)
 ;input CUR = pointer to file #27.11
"RTN","EASEZC1",165,0)
 N DGENCAT
"RTN","EASEZC1",166,0)
 S VDATA=""
"RTN","EASEZC1",167,0)
 I $$GET^DGENA(CUR,.DGENR) D
"RTN","EASEZC1",168,0)
 .I $G(DGENR("STATUS"))=10!($G(DGENR("STATUS"))=19)!($G(DGENR("STATUS"))=20) D  Q
"RTN","EASEZC1",169,0)
 ..S VDATA=$S($G(DGENR("STATUS")):$$EXT^DGENU("STATUS",DGENR("STATUS")),1:"")
"RTN","EASEZC1",170,0)
 .S DGENCAT=$$CATEGORY^DGENA4(+EASDFN)
"RTN","EASEZC1",171,0)
 .S DGENCAT=$$EXTERNAL^DILFD(27.15,.02,"",DGENCAT)
"RTN","EASEZC1",172,0)
 .S VDATA=$S($G(DGENR("PRIORITY")):$$EXT^DGENU("PRIORITY",DGENR("PRIORITY")),1:"")
"RTN","EASEZC1",173,0)
 .S VDATA=VDATA_$S($G(DGENR("SUBGRP"))="":"",1:$$EXT^DGENU("SUBGRP",$G(DGENR("SUBGRP"))))
"RTN","EASEZC1",174,0)
 .S VDATA=VDATA_" | "_DGENCAT
"RTN","EASEZC1",175,0)
 Q
"RTN","EASEZC1",176,0)
 ;
"RTN","EASEZC1",177,0)
C408 ;get data from financial files into tmp mapping array
"RTN","EASEZC1",178,0)
 ;  using ien(s) local array INCREL
"RTN","EASEZC1",179,0)
 ;if no iens for veteran then nothing at all; exit
"RTN","EASEZC1",180,0)
 I $G(INCREL(408,"V",1))="" Q
"RTN","EASEZC1",181,0)
 ;link EZ applicant to veteran data
"RTN","EASEZC1",182,0)
 D A408^EASEZC2
"RTN","EASEZC1",183,0)
 ;link EZ spouse to spouse data
"RTN","EASEZC1",184,0)
 D SP408^EASEZC2
"RTN","EASEZC1",185,0)
 ;link EZ child to child/dependent data
"RTN","EASEZC1",186,0)
 D C1N408^EASEZC2
"RTN","EASEZC1",187,0)
 Q
"RTN","EASEZC2")
0^2^B34165501
"RTN","EASEZC2",1,0)
EASEZC2 ;ALB/jap - Compare 1010EZ Data with VistA Database ;10/16/00  13:08
"RTN","EASEZC2",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZC2",3,0)
 ;
"RTN","EASEZC2",4,0)
A408 ;get applicant financial data from VistA
"RTN","EASEZC2",5,0)
 N IENS,IEN,B,FF,FILE,SUBF,FLD,MAP,VDATA,KEY,EASAEL
"RTN","EASEZC2",6,0)
 S IENS=$G(INCREL(408,"V",1))
"RTN","EASEZC2",7,0)
 Q:IENS=""
"RTN","EASEZC2",8,0)
 ;associate each ien with file/subfile
"RTN","EASEZC2",9,0)
 S B=0 F FF=408.12,2,408.21,408.22 D
"RTN","EASEZC2",10,0)
 .S B=B+1,IEN=+$P(IENS,U,B)
"RTN","EASEZC2",11,0)
 .Q:'IEN  Q:FF=2
"RTN","EASEZC2",12,0)
 .S (FILE,SUBF)=FF
"RTN","EASEZC2",13,0)
 .S FLD=0 F  S FLD=$O(^TMP("EZINDEX",$J,"A",FILE,SUBF,FLD)) Q:FLD=""  D
"RTN","EASEZC2",14,0)
 ..S MAP=FILE_U_SUBF_U_FLD
"RTN","EASEZC2",15,0)
 ..;get patient database data
"RTN","EASEZC2",16,0)
 ..S VDATA=$$GET^EASEZC1(IEN,MAP)
"RTN","EASEZC2",17,0)
 ..;store link in all 1010EZ elements associated with this file/subfile
"RTN","EASEZC2",18,0)
 ..;store patient data in tmp array and link in subfile #712.01; KEY is ien to file #711
"RTN","EASEZC2",19,0)
 ..S KEY=0 F  S KEY=$O(^TMP("EZINDEX",$J,"A",FILE,SUBF,FLD,KEY)) Q:'KEY  D
"RTN","EASEZC2",20,0)
 ...S ^TMP("EZDATA",$J,KEY,1,2)=VDATA
"RTN","EASEZC2",21,0)
 ...S EASAEL=$P($G(^TMP("EZDATA",$J,KEY,1,1)),U,3)
"RTN","EASEZC2",22,0)
 ...I EASAEL D LINKUP^EASEZU1(EASAPP,EASAEL,IEN)
"RTN","EASEZC2",23,0)
 ...I 'EASAEL,VDATA'="" D ADD71201^EASEZU1(EASAPP,KEY,IEN,1)
"RTN","EASEZC2",24,0)
 Q
"RTN","EASEZC2",25,0)
 ;
"RTN","EASEZC2",26,0)
SP408 ;get spouse financial data from VistA
"RTN","EASEZC2",27,0)
 ;
"RTN","EASEZC2",28,0)
 N B,TYPE,MAP,M,MM,NSD,OUT,X,IEN,IENS,KEY,FILE,FF,FFF,FLD,SUBF,SUBIEN,VDATA,WHERE
"RTN","EASEZC2",29,0)
 ;get identifying data for database spouse
"RTN","EASEZC2",30,0)
 S IENS=$G(INCREL(408,"S",1))
"RTN","EASEZC2",31,0)
 Q:IENS=""
"RTN","EASEZC2",32,0)
 ;associate each ien with file/subfile
"RTN","EASEZC2",33,0)
 S B=0 F FF=408.12,408.13,408.21,408.22 D
"RTN","EASEZC2",34,0)
 .S B=B+1,IEN=+$P(IENS,U,B)
"RTN","EASEZC2",35,0)
 .Q:'IEN
"RTN","EASEZC2",36,0)
 .S (FILE,SUBF)=FF
"RTN","EASEZC2",37,0)
 .S FLD=0 F  S FLD=$O(^TMP("EZINDEX",$J,"S",FILE,SUBF,FLD)) Q:FLD=""  D
"RTN","EASEZC2",38,0)
 ..S MAP=FILE_U_SUBF_U_FLD
"RTN","EASEZC2",39,0)
 ..;get patient database data
"RTN","EASEZC2",40,0)
 ..S VDATA=$$GET^EASEZC1(IEN,MAP)
"RTN","EASEZC2",41,0)
 ..;store link in all 1010EZ elements associated with this file/subfile
"RTN","EASEZC2",42,0)
 ..;store patient data in tmp array and link in subfile #712.01; KEY is ien to file #711
"RTN","EASEZC2",43,0)
 ..S KEY=0 F  S KEY=$O(^TMP("EZINDEX",$J,"S",FILE,SUBF,FLD,KEY)) Q:'KEY  D
"RTN","EASEZC2",44,0)
 ...S ^TMP("EZDATA",$J,KEY,1,2)=VDATA
"RTN","EASEZC2",45,0)
 ...S EASAEL=$P($G(^TMP("EZDATA",$J,KEY,1,1)),U,3)
"RTN","EASEZC2",46,0)
 ...I EASAEL D LINKUP^EASEZU1(EASAPP,EASAEL,IEN)
"RTN","EASEZC2",47,0)
 ...I 'EASAEL,VDATA'="" D ADD71201^EASEZU1(EASAPP,KEY,IEN,1)
"RTN","EASEZC2",48,0)
 .;get data in subfile #408.1275
"RTN","EASEZC2",49,0)
 .I FILE=408.12 S SUBF=408.1275 S FLD=0 F  S FLD=$O(^TMP("EZINDEX",$J,"S",FILE,SUBF,FLD)) Q:FLD=""  D
"RTN","EASEZC2",50,0)
 ..S SUBIEN=$$I1275^EASEZI(IEN)
"RTN","EASEZC2",51,0)
 ..S MAP=FILE_U_SUBF_U_FLD,WHERE=IEN_";"_SUBIEN
"RTN","EASEZC2",52,0)
 ..S VDATA=$$GET^EASEZC1(WHERE,MAP)
"RTN","EASEZC2",53,0)
 ..;store link in all 1010EZ elements associated with this file/subfile
"RTN","EASEZC2",54,0)
 ..;store patient data in tmp array and link in subfile #712.01; KEY is ien to file #711
"RTN","EASEZC2",55,0)
 ..S KEY=0 F  S KEY=$O(^TMP("EZINDEX",$J,"S",FILE,SUBF,FLD,KEY)) Q:'KEY  D
"RTN","EASEZC2",56,0)
 ...S ^TMP("EZDATA",$J,KEY,1,2)=VDATA
"RTN","EASEZC2",57,0)
 ...S EASAEL=$P($G(^TMP("EZDATA",$J,KEY,1,1)),U,3)
"RTN","EASEZC2",58,0)
 ...I EASAEL D LINKUP^EASEZU1(EASAPP,EASAEL,WHERE)
"RTN","EASEZC2",59,0)
 ...I 'EASAEL,VDATA'="" D ADD71201^EASEZU1(EASAPP,KEY,WHERE,1)
"RTN","EASEZC2",60,0)
 Q
"RTN","EASEZC2",61,0)
 ;
"RTN","EASEZC2",62,0)
C1N408 ;get child/dependent financial data from VistA
"RTN","EASEZC2",63,0)
 N B,PERS,EZ,PT,TYPE,GRP,MAP,M,MM,NSD,OUT,X,IEN,IENS,FLD,FF,FFF,FILE,SUBF,SUBIEN,VDATA,WHERE
"RTN","EASEZC2",64,0)
 ;
"RTN","EASEZC2",65,0)
 ;get identifying data for 1010EZ child dependents
"RTN","EASEZC2",66,0)
 K PERS("EZ")
"RTN","EASEZC2",67,0)
 S TYPE="CHILD1" S X=$$NSD^EASEZU3(EASAPP,TYPE,1) I X'="" S PERS("EZ",TYPE,1)=X
"RTN","EASEZC2",68,0)
 S TYPE="CHILD(N)",M=0,OUT=0 F  S M=M+1 D  Q:OUT
"RTN","EASEZC2",69,0)
 .S X=$$NSD^EASEZU3(EASAPP,TYPE,M)
"RTN","EASEZC2",70,0)
 .I X="" S OUT=1 Q
"RTN","EASEZC2",71,0)
 .S PERS("EZ",TYPE,M)=X
"RTN","EASEZC2",72,0)
 ;
"RTN","EASEZC2",73,0)
 ;get identifying data for all database dependents
"RTN","EASEZC2",74,0)
 K PERS("PT")
"RTN","EASEZC2",75,0)
 S M=0,MM=0 F  S M=$O(INCREL(408,"C",M)) Q:'M  D
"RTN","EASEZC2",76,0)
 .S IEN=+$P(INCREL(408,"C",M),U,2)
"RTN","EASEZC2",77,0)
 .S NSD="" F FLD=".01",".09",".03" D
"RTN","EASEZC2",78,0)
 ..S FFF="408.13^408.13^"_FLD S X=$$GET^EASEZC1(IEN,FFF)
"RTN","EASEZC2",79,0)
 ..I FLD=".09" S X=$$SSNOUT^EASEZT1(X)
"RTN","EASEZC2",80,0)
 ..S NSD=NSD_X_U
"RTN","EASEZC2",81,0)
 .S MM=MM+1,PERS("PT","CHILD",MM)=NSD,PERS("PT","CHILD",MM,"IENS")=INCREL(408,"C",M)
"RTN","EASEZC2",82,0)
 ;
"RTN","EASEZC2",83,0)
 ;match each EZ child dependent to database dependent if possible
"RTN","EASEZC2",84,0)
 F TYPE="CHILD1","CHILD(N)" S M=0 F  S M=$O(PERS("EZ",TYPE,M)) Q:'M  D
"RTN","EASEZC2",85,0)
 .S EZ=PERS("EZ",TYPE,M)
"RTN","EASEZC2",86,0)
 .S MM=0 F  S MM=$O(PERS("PT","CHILD",MM)) Q:'MM  S PT=PERS("PT","CHILD",MM) D
"RTN","EASEZC2",87,0)
 ..I ($P(EZ,U,2,3)=$P(PT,U,2,3))!($$CMORE(EZ,PT)) D
"RTN","EASEZC2",88,0)
 ...S PERS("EZ",TYPE,M,"IENS")=PERS("PT","CHILD",MM,"IENS")
"RTN","EASEZC2",89,0)
 ...K PERS("PT","CHILD",MM)
"RTN","EASEZC2",90,0)
 ;
"RTN","EASEZC2",91,0)
 ;get identifying data for child in database
"RTN","EASEZC2",92,0)
 F TYPE="CHILD1","CHILD(N)" S M=0 F  S M=$O(PERS("EZ",TYPE,M)) Q:'M  D
"RTN","EASEZC2",93,0)
 .S IENS=$G(PERS("EZ",TYPE,M,"IENS"))
"RTN","EASEZC2",94,0)
 .Q:IENS=""
"RTN","EASEZC2",95,0)
 .S GRP=$S(TYPE="CHILD1":"C1",1:"CN")
"RTN","EASEZC2",96,0)
 .;associate each ien with file/subfile
"RTN","EASEZC2",97,0)
 .S B=0 F FF=408.12,408.13,408.21,408.22 D
"RTN","EASEZC2",98,0)
 ..S B=B+1,IEN=+$P(IENS,U,B)
"RTN","EASEZC2",99,0)
 ..Q:'IEN
"RTN","EASEZC2",100,0)
 ..S (FILE,SUBF)=FF
"RTN","EASEZC2",101,0)
 ..S FLD=0 F  S FLD=$O(^TMP("EZINDEX",$J,GRP,FILE,SUBF,FLD)) Q:FLD=""  D
"RTN","EASEZC2",102,0)
 ...S MAP=FILE_U_SUBF_U_FLD
"RTN","EASEZC2",103,0)
 ...;get patient database data
"RTN","EASEZC2",104,0)
 ...S VDATA=$$GET^EASEZC1(IEN,MAP)
"RTN","EASEZC2",105,0)
 ...;store link in all 1010EZ elements associated with this file/subfile
"RTN","EASEZC2",106,0)
 ...;store patient data in tmp array and link in subfile #712.01; KEY is ien to file #711
"RTN","EASEZC2",107,0)
 ...S KEY=0 F  S KEY=$O(^TMP("EZINDEX",$J,GRP,FILE,SUBF,FLD,KEY)) Q:'KEY  D
"RTN","EASEZC2",108,0)
 ....S ^TMP("EZDATA",$J,KEY,M,2)=VDATA
"RTN","EASEZC2",109,0)
 ....S EASAEL=$P($G(^TMP("EZDATA",$J,KEY,M,1)),U,3)
"RTN","EASEZC2",110,0)
 ....I EASAEL D LINKUP^EASEZU1(EASAPP,EASAEL,IEN)
"RTN","EASEZC2",111,0)
 ....I 'EASAEL,VDATA'="" D ADD71201^EASEZU1(EASAPP,KEY,IEN,1)
"RTN","EASEZC2",112,0)
 ..;get data in subfile #408.1275
"RTN","EASEZC2",113,0)
 ..I FILE=408.12 S SUBF=408.1275 S FLD=0 F  S FLD=$O(^TMP("EZINDEX",$J,GRP,FILE,SUBF,FLD)) Q:FLD=""  D
"RTN","EASEZC2",114,0)
 ...S SUBIEN=$$I1275^EASEZI(IEN)
"RTN","EASEZC2",115,0)
 ...S MAP=FILE_U_SUBF_U_FLD,WHERE=IEN_";"_SUBIEN
"RTN","EASEZC2",116,0)
 ...S VDATA=$$GET^EASEZC1(WHERE,MAP)
"RTN","EASEZC2",117,0)
 ...;store link in all 1010EZ elements associated with this file/subfile
"RTN","EASEZC2",118,0)
 ...;store patient data in tmp array and link in subfile #712.01; KEY is ien to file #711
"RTN","EASEZC2",119,0)
 ...S KEY=0 F  S KEY=$O(^TMP("EZINDEX",$J,GRP,FILE,SUBF,FLD,KEY)) Q:'KEY  D
"RTN","EASEZC2",120,0)
 ....S ^TMP("EZDATA",$J,KEY,M,2)=VDATA
"RTN","EASEZC2",121,0)
 ....S EASAEL=$P($G(^TMP("EZDATA",$J,KEY,M,1)),U,3)
"RTN","EASEZC2",122,0)
 ....I EASAEL D LINKUP^EASEZU1(EASAPP,EASAEL,WHERE)
"RTN","EASEZC2",123,0)
 ....I 'EASAEL,VDATA'="" D ADD71201^EASEZU1(EASAPP,KEY,WHERE,1)
"RTN","EASEZC2",124,0)
 Q
"RTN","EASEZC2",125,0)
 ;
"RTN","EASEZC2",126,0)
CMORE(EZ,PT) ;
"RTN","EASEZC2",127,0)
 ;input EZ = name^ssn^dob of child on 1010EZ
"RTN","EASEZC2",128,0)
 ;      PT = name^ssn^dob of child in database
"RTN","EASEZC2",129,0)
 ;output MATCH = 0, if no match
"RTN","EASEZC2",130,0)
 N PSSN,PDOB,ESSN,EDOB,K,MATCH,MATCH1,MATCH2
"RTN","EASEZC2",131,0)
 S (MATCH,MATCH1,MATCH2)=0
"RTN","EASEZC2",132,0)
 S ESSN=$P(EZ,U,2),EDOB=$P(EZ,U,3),PSSN=$P(PT,U,2),PDOB=$P(PT,U,3)
"RTN","EASEZC2",133,0)
 S MATCH1=0 F K=1,2,3,5,6,8,9,10,11 I $P(ESSN,U,K)=$P(PSSN,U,K) S MATCH1=MATCH1+1
"RTN","EASEZC2",134,0)
 I $P(EDOB,"/",3)=$P(PDOB,"/",3) S MATCH2=1
"RTN","EASEZC2",135,0)
 I MATCH1>7,MATCH2 S MATCH=1
"RTN","EASEZC2",136,0)
 Q MATCH
"RTN","EASEZF1")
0^3^B16102525
"RTN","EASEZF1",1,0)
EASEZF1 ;ALB/jap - Filing 1010EZ Data to Patient Database ;10/12/00  13:07
"RTN","EASEZF1",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZF1",3,0)
 ;
"RTN","EASEZF1",4,0)
F2(EASAPP,EASDFN) ;file to Patient record in #2
"RTN","EASEZF1",5,0)
 ;input EASDFN = ien to #2
"RTN","EASEZF1",6,0)
 N KEYIEN,FILE,SUBFILE,FLD,DATAKEY,MULTIPLE,SECT,QUES,SUBIEN,ACCEPT,EZDATA,PTDATA,LINK,EROOT,EAS,ERR,IENS,ARRAY,ELIGVER
"RTN","EASEZF1",7,0)
 N DIC,DIQ,DA,DR,X,Y
"RTN","EASEZF1",8,0)
 Q:'$G(EASDFN)
"RTN","EASEZF1",9,0)
 L +^DPT(EASDFN)
"RTN","EASEZF1",10,0)
 S KEYIEN=0
"RTN","EASEZF1",11,0)
 F  S KEYIEN=$O(^TMP("EZDATA",$J,KEYIEN)) Q:'KEYIEN  D
"RTN","EASEZF1",12,0)
 .S LN=^TMP("EZDATA",$J,KEYIEN),FILE=$P(LN,U,1)
"RTN","EASEZF1",13,0)
 .Q:FILE'=2
"RTN","EASEZF1",14,0)
 .S SUBFILE=$P(LN,U,2),FLD=$P(LN,U,3),DATAKEY=$P(LN,U,4)
"RTN","EASEZF1",15,0)
 .S SECT=$P(DATAKEY,";",1),QUES=$P(DATAKEY,";",2)
"RTN","EASEZF1",16,0)
 .;in file #2, multiple is always 1
"RTN","EASEZF1",17,0)
 .S MULTIPLE=1
"RTN","EASEZF1",18,0)
 .Q:'$D(^TMP("EZDATA",$J,KEYIEN,MULTIPLE,1))
"RTN","EASEZF1",19,0)
 .S X=$G(^TMP("EZTEMP",$J,SECT,MULTIPLE,QUES))
"RTN","EASEZF1",20,0)
 .Q:$P(X,U,1)'=KEYIEN
"RTN","EASEZF1",21,0)
 .S EZDATA=$P(X,U,2),ACCEPT=$P(X,U,3),SUBIEN=$P(X,U,4),PTDATA=$P(X,U,5)
"RTN","EASEZF1",22,0)
 .Q:EZDATA=""
"RTN","EASEZF1",23,0)
 .;special handling for Designee
"RTN","EASEZF1",24,0)
 .I FLD=.3405 S EZDATA=$S(EZDATA="NEXT OF KIN":"YES",1:"NO")
"RTN","EASEZF1",25,0)
 .;strip off code display from county
"RTN","EASEZF1",26,0)
 .I SECT="I",QUES="9E." S EZDATA=$P(EZDATA," (",1)
"RTN","EASEZF1",27,0)
 .Q:EZDATA=PTDATA
"RTN","EASEZF1",28,0)
 .;can't continue w/o ien to subfile #712.01
"RTN","EASEZF1",29,0)
 .Q:'SUBIEN
"RTN","EASEZF1",30,0)
 .;get file #2 ien; always same as EASDFN
"RTN","EASEZF1",31,0)
 .S LINK=EASDFN
"RTN","EASEZF1",32,0)
 .;don't continue if data item not accepted
"RTN","EASEZF1",33,0)
 .Q:ACCEPT<1
"RTN","EASEZF1",34,0)
 .;process subfile data elsewhere
"RTN","EASEZF1",35,0)
 .I SUBFILE=2.01 Q
"RTN","EASEZF1",36,0)
 .I SUBFILE=2.101 Q
"RTN","EASEZF1",37,0)
 .;special conversion to file data to field #.328
"RTN","EASEZF1",38,0)
 .I FLD=.328 D
"RTN","EASEZF1",39,0)
 ..S X=$$UC^EASEZT1(EZDATA) I X="SSN" D
"RTN","EASEZF1",40,0)
 ...;allow SSN as Service Number only if field #.328 in patient record is null;
"RTN","EASEZF1",41,0)
 ...S PTSSN=$$GETANY^EASEZU1(EASAPP,EASDFN,SUBIEN)
"RTN","EASEZF1",42,0)
 ...I PTSSN="" S EZDATA="SS" Q
"RTN","EASEZF1",43,0)
 ...;otherwise Applicant SSN must match Patient SSN
"RTN","EASEZF1",44,0)
 ...S KK=$$KEY711^EASEZU1("APPLICANT SOCIAL SECURITY NUMBER")
"RTN","EASEZF1",45,0)
 ...S EZSSN=$P($G(^TMP("EZDATA",$J,KK,1,1)),U,1),EZSSN=$TR(EZSSN,"-","")
"RTN","EASEZF1",46,0)
 ...I EZSSN=PTSSN S EZDATA="SS" Q
"RTN","EASEZF1",47,0)
 ...S EZDATA="ssn"
"RTN","EASEZF1",48,0)
 ..K KK,PTSSN,EZSSN
"RTN","EASEZF1",49,0)
 .;repeat check for verified eligibility;
"RTN","EASEZF1",50,0)
 .;do not file certain fields if eligibility verified
"RTN","EASEZF1",51,0)
 .K ARRAY
"RTN","EASEZF1",52,0)
 .S DA=EASDFN,DIC="^DPT(",DR=".3611;.3613",DIQ(0)="I",DIQ="ARRAY"
"RTN","EASEZF1",53,0)
 .D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","EASEZF1",54,0)
 .I $G(ARRAY(2,EASDFN,.3611,"I"))="V",$G(ARRAY(2,EASDFN,.3613,"I"))="H" S ELIGVER=1
"RTN","EASEZF1",55,0)
 .I FLD=.313,$G(ARRAY(2,EASDFN,.3611,"I"))="V" Q
"RTN","EASEZF1",56,0)
 .I $G(ELIGVER),((FLD=.301)!(FLD=.302)!(FLD=.36235)) Q
"RTN","EASEZF1",57,0)
 .;setup to call FM database server using EASDFN as file #2 record
"RTN","EASEZF1",58,0)
 .K EAS,ERR
"RTN","EASEZF1",59,0)
 .S IENS=EASDFN_","
"RTN","EASEZF1",60,0)
 .S EROOT="EAS("_EASAPP_")"
"RTN","EASEZF1",61,0)
 .D VAL^DIE(2,IENS,FLD,"F",EZDATA,,EROOT,"ERR")
"RTN","EASEZF1",62,0)
 .;try to resolve possible invalid input for free text fields due to length
"RTN","EASEZF1",63,0)
 .I $D(ERR) D RESOLVE
"RTN","EASEZF1",64,0)
 .I $D(ERR) D ERROR^EASEZF2("AP",MULTIPLE,.ERR,"LINK")
"RTN","EASEZF1",65,0)
 .;file to database if input is valid
"RTN","EASEZF1",66,0)
 .I '$D(ERR) D
"RTN","EASEZF1",67,0)
 ..;2/1/2001 - don't attempt to file Name, SSN, DOB; too many complications;
"RTN","EASEZF1",68,0)
 ..;  example: if system assigns pseudo-SSN to new patient, user could overwrite;
"RTN","EASEZF1",69,0)
 ..;  example: if applicant matched to existing patient, all critical identifying
"RTN","EASEZF1",70,0)
 ..;           data could be overwritten; could impact HEC as well
"RTN","EASEZF1",71,0)
 ..D FILE^DIE("S",EROOT,"ERR")
"RTN","EASEZF1",72,0)
 ..;set any replaced data into subfile #712.01 for audit
"RTN","EASEZF1",73,0)
 ..S ^EAS(712,EASAPP,10,SUBIEN,2)=PTDATA_U_LINK
"RTN","EASEZF1",74,0)
 ;
"RTN","EASEZF1",75,0)
 L -^DPT(EASDFN)
"RTN","EASEZF1",76,0)
 Q
"RTN","EASEZF1",77,0)
 ;
"RTN","EASEZF1",78,0)
RESOLVE ;try to resolve invalid input for free text fields only
"RTN","EASEZF1",79,0)
 ;see if mapped to free text field
"RTN","EASEZF1",80,0)
 N FDEF,FTYPE,MAX
"RTN","EASEZF1",81,0)
 I (SUBFILE=FILE)!(SUBFILE="") S FDEF=FILE
"RTN","EASEZF1",82,0)
 E  S FDEF=SUBFILE
"RTN","EASEZF1",83,0)
 S FTYPE=$$GET1^DID(FDEF,FLD,"","TYPE")
"RTN","EASEZF1",84,0)
 Q:FTYPE'="FREE TEXT"
"RTN","EASEZF1",85,0)
 S MAX=$$GET1^DID(FDEF,FLD,"","FIELD LENGTH")
"RTN","EASEZF1",86,0)
 S EZDATA=$E(EZDATA,1,MAX)
"RTN","EASEZF1",87,0)
 K ERR
"RTN","EASEZF1",88,0)
 D VAL^DIE(2,IENS,FLD,"F",EZDATA,,EROOT,"ERR")
"RTN","EASEZF1",89,0)
 ;if still sets ERR array then won't be filed to database
"RTN","EASEZF1",90,0)
 Q
"RTN","EASEZF2")
0^4^B57818396
"RTN","EASEZF2",1,0)
EASEZF2 ;ALB/jap - Filing 1010EZ Data to Patient Database ;10/31/00  13:07
"RTN","EASEZF2",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZF2",3,0)
 ;
"RTN","EASEZF2",4,0)
F408(EASAPP,EASDFN) ;
"RTN","EASEZF2",5,0)
 N KEYIEN,FILE,SUBFILE,FLD,DATAKEY,MULTIPLE,MM,SECT,QUES,SUBIEN,ACCEPT,EZDATA,PTDATA,LINK
"RTN","EASEZF2",6,0)
 N DGPR12,INCYR,TESTYR,LASTINC,XLINK,EROOT,EAS,ERR,IENS,MSG,X,Y
"RTN","EASEZF2",7,0)
 Q:'$G(EASDFN)
"RTN","EASEZF2",8,0)
 ;determine income year for financial data
"RTN","EASEZF2",9,0)
 S Y=DT,%F=5,X=$$FMTE^XLFDT(Y,%F),X=+$P(X,"/",3)-1,%DT="P" D ^%DT S INCYR=Y
"RTN","EASEZF2",10,0)
 S YREND=$E(DT,1,3)_"1231"
"RTN","EASEZF2",11,0)
 ;don't file any 408 data if applicant has income test for current year at this site
"RTN","EASEZF2",12,0)
 S LASTINC=$$LST^DGMTU(EASDFN,YREND,1) I LASTINC="" S LASTINC=$$LST^DGMTU(EASDFN,YREND,2)
"RTN","EASEZF2",13,0)
 S TESTYR=$P(LASTINC,U,2)
"RTN","EASEZF2",14,0)
 Q:($E(TESTYR,1,3)=$E(DT,1,3))
"RTN","EASEZF2",15,0)
 ;
"RTN","EASEZF2",16,0)
 ;DGPR12("AP") is the Applicant's (veteran's) IEN in file #408.12
"RTN","EASEZF2",17,0)
 S DGPR12("AP")=""
"RTN","EASEZF2",18,0)
 ;add Applicant to file #408.12 if not there already;
"RTN","EASEZF2",19,0)
 ;make this addition even if no other financial data is available;
"RTN","EASEZF2",20,0)
 I '$D(^DGPR(408.12,"B",EASDFN)) D
"RTN","EASEZF2",21,0)
 .;create the file #408.12 record
"RTN","EASEZF2",22,0)
 .K EAS,ERR,EZIENS
"RTN","EASEZF2",23,0)
 .S EAS(EASAPP,408.12,"+1,",".01")=EASDFN
"RTN","EASEZF2",24,0)
 .S EAS(EASAPP,408.12,"+1,",".02")=1
"RTN","EASEZF2",25,0)
 .S EAS(EASAPP,408.12,"+1,",".03")=EASDFN_";DPT("
"RTN","EASEZF2",26,0)
 .S EROOT="EAS("_EASAPP_")"
"RTN","EASEZF2",27,0)
 .D UPDATE^DIE("S",EROOT,"EZIENS","ERR")
"RTN","EASEZF2",28,0)
 .S DGPR12("AP")=$G(EZIENS(1))
"RTN","EASEZF2",29,0)
 .Q:DGPR12("AP")=""
"RTN","EASEZF2",30,0)
 .;create the subfile #408.1275 record
"RTN","EASEZF2",31,0)
 .K EAS,ERR,EZIENS
"RTN","EASEZF2",32,0)
 .S KEY=+$$KEY711^EASEZU1("APPLICANT DATE OF BIRTH")
"RTN","EASEZF2",33,0)
 .S DOB=$P($$DATA712^EASEZU1(EASAPP,KEY,1),U,1)
"RTN","EASEZF2",34,0)
 .S EAS(EASAPP,408.1275,"+1,"_DGPR12("AP")_",",".01")=DOB
"RTN","EASEZF2",35,0)
 .S EAS(EASAPP,408.1275,"+1,"_DGPR12("AP")_",",".02")="YES"
"RTN","EASEZF2",36,0)
 .D UPDATE^DIE("ES",EROOT,"EZIENS","ERR")
"RTN","EASEZF2",37,0)
 .;link 1010EZ data with new record in #408.12
"RTN","EASEZF2",38,0)
 I DGPR12("AP")="" S DGPR12("AP")=$O(^DGPR(408.12,"B",EASDFN,0))
"RTN","EASEZF2",39,0)
 ;if no record for Applicant in file #408.12 exists, then don't continue
"RTN","EASEZF2",40,0)
 Q:DGPR12("AP")=""
"RTN","EASEZF2",41,0)
 ;
"RTN","EASEZF2",42,0)
 ;kill local holding arrays
"RTN","EASEZF2",43,0)
 K AP,SP,CN,FLINK
"RTN","EASEZF2",44,0)
 ;get data for file #408.12,#408.13,#408.21,#408.22 into local arrays 
"RTN","EASEZF2",45,0)
 S SECT=""
"RTN","EASEZF2",46,0)
 F  S SECT=$O(^TMP("EZTEMP",$J,SECT)) Q:SECT=""  S MULTIPLE=0 D
"RTN","EASEZF2",47,0)
 .F  S MULTIPLE=$O(^TMP("EZTEMP",$J,SECT,MULTIPLE)) Q:MULTIPLE=""  S QUES="" D
"RTN","EASEZF2",48,0)
 ..F  S QUES=$O(^TMP("EZTEMP",$J,SECT,MULTIPLE,QUES)) Q:QUES=""  D
"RTN","EASEZF2",49,0)
 ...S X=^TMP("EZTEMP",$J,SECT,MULTIPLE,QUES)
"RTN","EASEZF2",50,0)
 ...S KEYIEN=$P(X,U,1),EZDATA=$P(X,U,2),ACCEPT=$P(X,U,3),SUBIEN=$P(X,U,4),PTDATA=$P(X,U,5)
"RTN","EASEZF2",51,0)
 ...S LN=^TMP("EZDATA",$J,KEYIEN),FILE=$P(LN,U,1),SUBFILE=$P(LN,U,2),FLD=$P(LN,U,3)
"RTN","EASEZF2",52,0)
 ...Q:($P(FILE,".",1)'=408)
"RTN","EASEZF2",53,0)
 ...S LINK=$P($G(^EAS(712,EASAPP,10,SUBIEN,2)),U,2)
"RTN","EASEZF2",54,0)
 ...S DATANM=$P($G(^EAS(711,KEYIEN,0)),U,1)
"RTN","EASEZF2",55,0)
 ...S MM=MULTIPLE S:DATANM["CHILD(N)" MM=MULTIPLE+1
"RTN","EASEZF2",56,0)
 ...S ARR=$S(DATANM["SPOUSE":"SP",DATANM["CHILD":"CN",1:"AP")
"RTN","EASEZF2",57,0)
 ...S @ARR@(MM,FILE,SUBFILE,FLD)=EZDATA_U_ACCEPT_U_SUBIEN_U_PTDATA_U_LINK
"RTN","EASEZF2",58,0)
 ;delete any Spouse or Dependent data if #.01 field for file #408.13 does not exist
"RTN","EASEZF2",59,0)
 I $D(SP(1,408.13,408.13,.01))'=1 K SP
"RTN","EASEZF2",60,0)
 S MM=0 F  S MM=$O(CN(MM)) Q:'MM  I $D(CN(MM,408.13,408.13,.01))'=1 K CN(MM)
"RTN","EASEZF2",61,0)
 ;
"RTN","EASEZF2",62,0)
 ;gather links to VistA for Applicant
"RTN","EASEZF2",63,0)
 S FLINK("AP",1,408.12)=DGPR12("AP")
"RTN","EASEZF2",64,0)
 F FILE=408.21,408.22 D
"RTN","EASEZF2",65,0)
 .S XLINK="",MULTIPLE=1,SUBFILE=FILE,FLD=""
"RTN","EASEZF2",66,0)
 .F  S FLD=$O(AP(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF2",67,0)
 ..S FLINK("AP",1,FILE)=+$P(AP(MULTIPLE,FILE,SUBFILE,FLD),U,5)
"RTN","EASEZF2",68,0)
 ;gather links to VistA for Spouse
"RTN","EASEZF2",69,0)
 F FILE=408.12,408.13,408.21,408.22 D
"RTN","EASEZF2",70,0)
 .S XLINK="",MULTIPLE=1,SUBFILE=FILE,FLD=""
"RTN","EASEZF2",71,0)
 .F  S FLD=$O(SP(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF2",72,0)
 ..S FLINK("SP",MULTIPLE,FILE)=+$P(SP(MULTIPLE,FILE,SUBFILE,FLD),U,5)
"RTN","EASEZF2",73,0)
 .I FILE=408.12 S SUBFILE=408.1275 F  S FLD=$O(SP(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF2",74,0)
 ..S FLINK("SP",MULTIPLE,SUBFILE)=$P($P(SP(MULTIPLE,FILE,SUBFILE,FLD),U,5),";",2)
"RTN","EASEZF2",75,0)
 ..S FLINK("SP",MULTIPLE,FILE)=$P($P(SP(MULTIPLE,FILE,SUBFILE,FLD),U,5),";",1)
"RTN","EASEZF2",76,0)
 ;gather links to VistA for Dependents
"RTN","EASEZF2",77,0)
 S MULTIPLE=0 F  S MULTIPLE=$O(CN(MULTIPLE)) Q:'MULTIPLE  D
"RTN","EASEZF2",78,0)
 .F FILE=408.13,408.12,408.21,408.22 D
"RTN","EASEZF2",79,0)
 ..S XLINK="",SUBFILE=FILE,FLD=""
"RTN","EASEZF2",80,0)
 ..F  S FLD=$O(CN(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF2",81,0)
 ...S FLINK("CN",MULTIPLE,FILE)=+$P(CN(MULTIPLE,FILE,SUBFILE,FLD),U,5)
"RTN","EASEZF2",82,0)
 ..I FILE=408.12 S SUBFILE=408.1275 F  S FLD=$O(CN(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF2",83,0)
 ...S FLINK("CN",MULTIPLE,SUBFILE)=$P($P(CN(MULTIPLE,FILE,SUBFILE,FLD),U,5),";",2)
"RTN","EASEZF2",84,0)
 ...S FLINK("CN",MULTIPLE,FILE)=$P($P(CN(MULTIPLE,FILE,SUBFILE,FLD),U,5),";",1)
"RTN","EASEZF2",85,0)
 ;
"RTN","EASEZF2",86,0)
 ;file data
"RTN","EASEZF2",87,0)
 Q:DGPR12("AP")=""
"RTN","EASEZF2",88,0)
 D AP
"RTN","EASEZF2",89,0)
 I $D(FLINK("SP")) D SP^EASEZF3
"RTN","EASEZF2",90,0)
 I $D(FLINK("CN")) D CN^EASEZF4
"RTN","EASEZF2",91,0)
 D LINKUP^EASEZF4
"RTN","EASEZF2",92,0)
 ;
"RTN","EASEZF2",93,0)
 Q
"RTN","EASEZF2",94,0)
 ;
"RTN","EASEZF2",95,0)
AP ;file Applicant data
"RTN","EASEZF2",96,0)
 N MT,P22,MULTIPLE,FILE,SUBFILE,FLD,XDATA,ACCEPT,SUBIEN,EZDATA,EAS,ERR,KEY
"RTN","EASEZF2",97,0)
 F FILE=408.21,408.22 D
"RTN","EASEZF2",98,0)
 .S MULTIPLE=1,SUBFILE=FILE,FLD=""
"RTN","EASEZF2",99,0)
 .S XLINK=$G(FLINK("AP",1,FILE))
"RTN","EASEZF2",100,0)
 .;record in file #408.21 needed for all further data filing
"RTN","EASEZF2",101,0)
 .Q:(FILE'=408.21)&('$G(FLINK("AP",1,408.21)))
"RTN","EASEZF2",102,0)
 .;for data elements with link to database, 
"RTN","EASEZF2",103,0)
 .;only file 1010EZ data if accepted by user;
"RTN","EASEZF2",104,0)
 .;data in external format
"RTN","EASEZF2",105,0)
 .I XLINK D
"RTN","EASEZF2",106,0)
 ..S FLD="" F  S FLD=$O(AP(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF2",107,0)
 ...S XDATA=AP(MULTIPLE,FILE,SUBFILE,FLD),ACCEPT=$P(XDATA,U,2)
"RTN","EASEZF2",108,0)
 ...I ACCEPT D LINK(XDATA,FILE,FLD,"AP",MULTIPLE)
"RTN","EASEZF2",109,0)
 .;for data elements with no link to database, 
"RTN","EASEZF2",110,0)
 .;always create new record(s) to store 1010EZ data;
"RTN","EASEZF2",111,0)
 .;use internal data format
"RTN","EASEZF2",112,0)
 .I 'XLINK D
"RTN","EASEZF2",113,0)
 ..K EAS,ERR
"RTN","EASEZF2",114,0)
 ..S FLD="" F  S FLD=$O(AP(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF2",115,0)
 ...S EZDATA=$P(AP(MULTIPLE,FILE,SUBFILE,FLD),U,1)
"RTN","EASEZF2",116,0)
 ...S EAS(EASAPP,FILE,"+1,",FLD)=EZDATA
"RTN","EASEZF2",117,0)
 ..I FILE=408.21 D
"RTN","EASEZF2",118,0)
 ...S EAS(EASAPP,FILE,"+1,",".01")=INCYR
"RTN","EASEZF2",119,0)
 ...S EAS(EASAPP,FILE,"+1,",".02")=FLINK("AP",1,408.12)
"RTN","EASEZF2",120,0)
 ...S EAS(EASAPP,FILE,"+1,","101")=DUZ
"RTN","EASEZF2",121,0)
 ...S EAS(EASAPP,FILE,"+1,","102")=DT
"RTN","EASEZF2",122,0)
 ...S EAS(EASAPP,FILE,"+1,","103")=DUZ
"RTN","EASEZF2",123,0)
 ...S EAS(EASAPP,FILE,"+1,","104")=DT
"RTN","EASEZF2",124,0)
 ..I FILE=408.22,$G(FLINK("AP",1,408.21)) D
"RTN","EASEZF2",125,0)
 ...S EAS(EASAPP,FILE,"+1,",".01")=EASDFN
"RTN","EASEZF2",126,0)
 ...S EAS(EASAPP,FILE,"+1,",".02")=FLINK("AP",1,408.21)
"RTN","EASEZF2",127,0)
 ..S FLINK("AP",MULTIPLE,FILE)=$$NOLINK(.EAS,"AP",MULTIPLE)
"RTN","EASEZF2",128,0)
 ..S FLD="" F  S FLD=$O(AP(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF2",129,0)
 ...S SUBIEN=$P(AP(MULTIPLE,FILE,SUBFILE,FLD),U,3)
"RTN","EASEZF2",130,0)
 ...;store link to new record in subfile #712.01
"RTN","EASEZF2",131,0)
 ...S $P(AP(MULTIPLE,FILE,SUBFILE,FLD),U,5)=FLINK("AP",1,FILE)
"RTN","EASEZF2",132,0)
 ;
"RTN","EASEZF2",133,0)
 Q
"RTN","EASEZF2",134,0)
 ;
"RTN","EASEZF2",135,0)
LINK(XDATA,FILE,FLD,GRP,MULTIPLE) ;setup to call FM database server if link to file exists & data accepted
"RTN","EASEZF2",136,0)
 N MSG,EZDATA,SUBIEN,PTDATA,XLINK
"RTN","EASEZF2",137,0)
 K EAS,ERR
"RTN","EASEZF2",138,0)
 S EZDATA=$P(XDATA,U,1),SUBIEN=$P(XDATA,U,3),PTDATA=$P(XDATA,U,4),XLINK=$P(XDATA,U,5)
"RTN","EASEZF2",139,0)
 S IENS=XLINK_","
"RTN","EASEZF2",140,0)
 S EROOT="EAS("_EASAPP_")"
"RTN","EASEZF2",141,0)
 D VAL^DIE(FILE,IENS,FLD,"F",EZDATA,,EROOT,"ERR")
"RTN","EASEZF2",142,0)
 I $D(ERR) D ERROR(GRP,MULTIPLE,.ERR,"LINK") Q
"RTN","EASEZF2",143,0)
 ;file to database if input is valid
"RTN","EASEZF2",144,0)
 I '$D(ERR) D
"RTN","EASEZF2",145,0)
 .I FILE=408.21 D
"RTN","EASEZF2",146,0)
 ..S EAS(EASAPP,FILE,IENS,103)=DUZ
"RTN","EASEZF2",147,0)
 ..S EAS(EASAPP,FILE,IENS,104)=DT
"RTN","EASEZF2",148,0)
 .D FILE^DIE("S",EROOT,"ERR")
"RTN","EASEZF2",149,0)
 .;set any replaced data into subfile #712.01 for audit
"RTN","EASEZF2",150,0)
 .I SUBIEN S $P(^EAS(712,EASAPP,10,SUBIEN,2),U,1)=PTDATA
"RTN","EASEZF2",151,0)
 Q
"RTN","EASEZF2",152,0)
 ;
"RTN","EASEZF2",153,0)
NOLINK(EAS,GRP,MULTIPLE) ;add new record with accepted data if no link exists;
"RTN","EASEZF2",154,0)
 ;
"RTN","EASEZF2",155,0)
 K EZIENS,ERR,LINK
"RTN","EASEZF2",156,0)
 S EROOT="EAS("_EASAPP_")"
"RTN","EASEZF2",157,0)
 D UPDATE^DIE("S",EROOT,"EZIENS","ERR")
"RTN","EASEZF2",158,0)
 ;call to UPDATE should not return ERR since internal data formats are used, but just in case;
"RTN","EASEZF2",159,0)
 I $D(ERR) D ERROR(GRP,MULTIPLE,.ERR,"NOLINK")
"RTN","EASEZF2",160,0)
 ;return ien to new record
"RTN","EASEZF2",161,0)
 S LINK=$G(EZIENS(1))
"RTN","EASEZF2",162,0)
 Q LINK
"RTN","EASEZF2",163,0)
 ;
"RTN","EASEZF2",164,0)
ERROR(GRP,MULTIPLE,ERR,FROM) ;add FM error text to error msg
"RTN","EASEZF2",165,0)
 N L,LSTLN,ECODE,ENUMBER
"RTN","EASEZF2",166,0)
 S ECODE="" F  S ECODE=$O(ERR("DIERR","E",ECODE)) Q:ECODE=""  S ENUMBER=0 F  S ENUMBER=$O(ERR("DIERR","E",ECODE,ENUMBER)) Q:'ENUMBER  D
"RTN","EASEZF2",167,0)
 .S LSTLN=+$O(^TMP("1010EZERROR",$J,""),-1) I 'LSTLN S LSTLN=6
"RTN","EASEZF2",168,0)
 .S WHO=$S(GRP="SP":"SPOUSE",GRP="CN":"CHILD",1:"APPLICANT")
"RTN","EASEZF2",169,0)
 .I WHO="CHILD" S WHO=WHO_" #"_MULTIPLE
"RTN","EASEZF2",170,0)
 .S FIELD=$G(ERR("DIERR",ENUMBER,"PARAM","FIELD")),FILE=$G(ERR("DIERR",ENUMBER,"PARAM","FILE"))
"RTN","EASEZF2",171,0)
 .I FROM="LINK" D
"RTN","EASEZF2",172,0)
 ..S LSTLN=LSTLN+1,^TMP("1010EZERROR",$J,LSTLN,0)="1010EZ data for "_WHO_" was not filed to"
"RTN","EASEZF2",173,0)
 ..S LSTLN=LSTLN+1,^TMP("1010EZERROR",$J,LSTLN,0)="Field #"_FIELD_" of File #"_FILE_" because:"
"RTN","EASEZF2",174,0)
 .I FROM="NOLINK" D
"RTN","EASEZF2",175,0)
 ..S LSTLN=LSTLN+1,^TMP("1010EZERROR",$J,LSTLN,0)="A new record for "_WHO_" could not be created in"
"RTN","EASEZF2",176,0)
 ..S LSTLN=LSTLN+1,^TMP("1010EZERROR",$J,LSTLN,0)="File #"_FILE_" because Field #"_FIELD_" produced an error:"
"RTN","EASEZF2",177,0)
 .S L=0 F  S L=$O(ERR("DIERR",ENUMBER,"TEXT",L)) Q:'L  D
"RTN","EASEZF2",178,0)
 ..S LN=ERR("DIERR",ENUMBER,"TEXT",L)
"RTN","EASEZF2",179,0)
 ..I $L(LN)<50 S LSTLN=LSTLN+1,^TMP("1010EZERROR",$J,LSTLN,0)=LN Q
"RTN","EASEZF2",180,0)
 ..D WRAP(LN,.LSTLN)
"RTN","EASEZF2",181,0)
 .S LSTLN=LSTLN+1,^TMP("1010EZERROR",$J,LSTLN,0)=" "
"RTN","EASEZF2",182,0)
 Q
"RTN","EASEZF2",183,0)
 ;
"RTN","EASEZF2",184,0)
WRAP(LN,LSTLN) ;parse a long error text line into several message lines
"RTN","EASEZF2",185,0)
 N PART,BB
"RTN","EASEZF2",186,0)
 F  D  Q:$L(LN)<41
"RTN","EASEZF2",187,0)
 .S PART=""
"RTN","EASEZF2",188,0)
 .F BB=1:1:99 S PART=PART_$P(LN," ",BB)_" " I $L(PART)>40 D  Q
"RTN","EASEZF2",189,0)
 ..S LSTLN=LSTLN+1,^TMP("1010EZERROR",$J,LSTLN,0)=PART
"RTN","EASEZF2",190,0)
 ..S LN=$P(LN," ",BB+1,99)
"RTN","EASEZF2",191,0)
 S LSTLN=LSTLN+1,^TMP("1010EZERROR",$J,LSTLN,0)=LN
"RTN","EASEZF2",192,0)
 Q
"RTN","EASEZF3")
0^5^B20061551
"RTN","EASEZF3",1,0)
EASEZF3 ;ALB/jap - Filing 1010EZ Data to Patient Database ;10/31/00  13:07
"RTN","EASEZF3",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZF3",3,0)
 ;
"RTN","EASEZF3",4,0)
SP ;file Spouse data
"RTN","EASEZF3",5,0)
 N C,MULTIPLE,FILE,SUBFILE,FLD,XDATA,ACCEPT,SUBIEN,SEX,EZDATA,EAS,ERR,KEY,X,Y,XLINK
"RTN","EASEZF3",6,0)
 ;process sequence must be 408.13 - 408.12 - 408.21 - 408.22
"RTN","EASEZF3",7,0)
 ;set sex of spouse
"RTN","EASEZF3",8,0)
 S KEY=+$$KEY711^EASEZU1("APPLICANT SEX")
"RTN","EASEZF3",9,0)
 S X=$$DATA712^EASEZU1(EASAPP,KEY,1),APSEX=$P(X,U,1),SEX=$S(APSEX="M":"FEMALE",1:"MALE")
"RTN","EASEZF3",10,0)
 S XLINK=$G(FLINK("SP",1,408.13)),PTDATA="" I XLINK D
"RTN","EASEZF3",11,0)
 .S FFF="408.13^408.13^.02" S PTDATA=$$GET^EASEZC1(XLINK,FFF)
"RTN","EASEZF3",12,0)
 .S SP(1,408.13,408.13,.02)=SEX_U_2_U_U_PTDATA_U_XLINK
"RTN","EASEZF3",13,0)
 ;
"RTN","EASEZF3",14,0)
 F FILE=408.13,408.12,408.21,408.22 D
"RTN","EASEZF3",15,0)
 .S MULTIPLE=1,SUBFILE=FILE,FLD=""
"RTN","EASEZF3",16,0)
 .S XLINK=$G(FLINK("SP",MULTIPLE,FILE))
"RTN","EASEZF3",17,0)
 .;record in file #408.13 is needed for all further data filng
"RTN","EASEZF3",18,0)
 .Q:(FILE'=408.13)&('$G(FLINK("SP",MULTIPLE,408.13)))
"RTN","EASEZF3",19,0)
 .;for data elements with link to database, 
"RTN","EASEZF3",20,0)
 .;only file 1010EZ data if accepted by user;
"RTN","EASEZF3",21,0)
 .;data in external format
"RTN","EASEZF3",22,0)
 .I XLINK D
"RTN","EASEZF3",23,0)
 ..;when #408.12 record exists, don't try to update subfile #408.1275
"RTN","EASEZF3",24,0)
 ..S FLD="" F  S FLD=$O(SP(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF3",25,0)
 ...S XDATA=SP(MULTIPLE,FILE,SUBFILE,FLD),ACCEPT=$P(XDATA,U,2)
"RTN","EASEZF3",26,0)
 ...I FILE=408.13,FLD=.09 S XDATA=$TR(XDATA,"-","")
"RTN","EASEZF3",27,0)
 ...I ACCEPT D LINK^EASEZF2(XDATA,FILE,FLD,"SP",MULTIPLE)
"RTN","EASEZF3",28,0)
 .;for data elements with no link to database, 
"RTN","EASEZF3",29,0)
 .;always create new record(s) to store 1010EZ data;
"RTN","EASEZF3",30,0)
 .;put data in internal format
"RTN","EASEZF3",31,0)
 .I 'XLINK D
"RTN","EASEZF3",32,0)
 ..K EAS,ERR
"RTN","EASEZF3",33,0)
 ..;supplement data and convert to internal format
"RTN","EASEZF3",34,0)
 ..S FLD="" F  S FLD=$O(SP(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF3",35,0)
 ...S EZDATA=$P(SP(MULTIPLE,FILE,SUBFILE,FLD),U,1)
"RTN","EASEZF3",36,0)
 ...S EAS(EASAPP,FILE,"+1,",FLD)=EZDATA
"RTN","EASEZF3",37,0)
 ..I FILE=408.13 D
"RTN","EASEZF3",38,0)
 ...S X=$G(EAS(EASAPP,FILE,"+1,",".03")) I X'="" D ^%DT S EAS(EASAPP,FILE,"+1,",".03")=Y
"RTN","EASEZF3",39,0)
 ...S X=$G(EAS(EASAPP,FILE,"+1,",".09")) I X'="" D
"RTN","EASEZF3",40,0)
 ....S SSN=$TR(X,"-","") S EAS(EASAPP,FILE,"+1,",".09")=SSN
"RTN","EASEZF3",41,0)
 ....I $D(^DGPR(408.13,"SSN",SSN)) S EAS(EASAPP,FILE,"+1,",".09")=""
"RTN","EASEZF3",42,0)
 ...S KEY=+$$KEY711^EASEZU1("APPLICANT SEX")
"RTN","EASEZF3",43,0)
 ...S X=$P($$DATA712^EASEZU1(EASAPP,KEY,1),U,1),SEX=$S(X="M":"F",1:"M")
"RTN","EASEZF3",44,0)
 ...S EAS(EASAPP,FILE,"+1,",".02")=SEX
"RTN","EASEZF3",45,0)
 ..I FILE=408.12,$G(FLINK("SP",MULTIPLE,408.13)) D F40812("SP",1)
"RTN","EASEZF3",46,0)
 ..I FILE=408.21,$G(FLINK("SP",MULTIPLE,408.12)) D
"RTN","EASEZF3",47,0)
 ...S EAS(EASAPP,FILE,"+1,",".01")=INCYR
"RTN","EASEZF3",48,0)
 ...S EAS(EASAPP,FILE,"+1,",".02")=FLINK("SP",MULTIPLE,408.12)
"RTN","EASEZF3",49,0)
 ...S EAS(EASAPP,FILE,"+1,","101")=DUZ
"RTN","EASEZF3",50,0)
 ...S EAS(EASAPP,FILE,"+1,","102")=DT
"RTN","EASEZF3",51,0)
 ...S EAS(EASAPP,FILE,"+1,","103")=DUZ
"RTN","EASEZF3",52,0)
 ...S EAS(EASAPP,FILE,"+1,","104")=DT
"RTN","EASEZF3",53,0)
 ..I FILE=408.22,$G(FLINK("SP",MULTIPLE,408.21)) D
"RTN","EASEZF3",54,0)
 ...S EAS(EASAPP,FILE,"+1,",".01")=EASDFN
"RTN","EASEZF3",55,0)
 ...S EAS(EASAPP,FILE,"+1,",".02")=FLINK("SP",MULTIPLE,408.21)
"RTN","EASEZF3",56,0)
 ..I FILE'=408.12 D
"RTN","EASEZF3",57,0)
 ...S FLINK("SP",MULTIPLE,FILE)=$$NOLINK^EASEZF2(.EAS,"SP",MULTIPLE)
"RTN","EASEZF3",58,0)
 ...S FLD="" F  S FLD=$O(SP(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF3",59,0)
 ....S $P(SP(MULTIPLE,FILE,SUBFILE,FLD),U,5)=FLINK("SP",MULTIPLE,FILE)
"RTN","EASEZF3",60,0)
 Q
"RTN","EASEZF3",61,0)
 ;
"RTN","EASEZF3",62,0)
F40812(TYPE,MULT) ;create a new record in file #408.12
"RTN","EASEZF3",63,0)
 ;input TYPE = "SP" for Souse or "CN" for Child
"RTN","EASEZF3",64,0)
 ;      MULT = always 1 for spouse; or
"RTN","EASEZF3",65,0)
 ;             1st subscript of CN array for child
"RTN","EASEZF3",66,0)
 ;can't use normal FileMan data entry
"RTN","EASEZF3",67,0)
 N C,ARR,FILE,SUBFILE,FLD,DGPRIEN,XDATE,SUBIEN,RELATE,XX,X,Y,DA,DIK,EAS,ERR
"RTN","EASEZF3",68,0)
 S DGPRIEN=""
"RTN","EASEZF3",69,0)
 S ARR=TYPE
"RTN","EASEZF3",70,0)
 S FILE=408.12,SUBFILE=408.12
"RTN","EASEZF3",71,0)
 I TYPE="SP" S RELATE=2
"RTN","EASEZF3",72,0)
 I TYPE="CN" D
"RTN","EASEZF3",73,0)
 .S X=$P($G(CN(MULT,FILE,SUBFILE,".02")),U,1)
"RTN","EASEZF3",74,0)
 .S RELATE=$S(X="SON":3,X="DAUGHTER":4,1:99)
"RTN","EASEZF3",75,0)
 ;verify that no record points to known file #408.13 record
"RTN","EASEZF3",76,0)
 S C=FLINK(TYPE,MULT,408.13)_";DGPR(408.13,"
"RTN","EASEZF3",77,0)
 I $D(^DGPR(408.12,"C",C)) S DGPRIEN=$O(^DGPR(408.12,"C",C,0))
"RTN","EASEZF3",78,0)
 ;if it does, quit w/o filing
"RTN","EASEZF3",79,0)
 Q:DGPRIEN
"RTN","EASEZF3",80,0)
 ;otherwise create a new entry
"RTN","EASEZF3",81,0)
 L +^DGPR(408.12,0):30
"RTN","EASEZF3",82,0)
 K DA,DIK
"RTN","EASEZF3",83,0)
 S DGPRIEN=$P(^DGPR(408.12,0),U,3)+1,$P(^DGPR(408.12,0),U,3)=DGPRIEN
"RTN","EASEZF3",84,0)
 S ^DGPR(408.12,DGPRIEN,0)=EASDFN_U_RELATE_U_C
"RTN","EASEZF3",85,0)
 S DA=DGPRIEN,DIK="^DGPR(408.12,",DIK(1)=".01^" D EN^DIK S DIK(1)=".03" D EN^DIK
"RTN","EASEZF3",86,0)
 S X=$P(^DGPR(408.12,0),U,4),$P(^DGPR(408.12,0),U,4)=X+1
"RTN","EASEZF3",87,0)
 L -^DGPR(408.12,0)
"RTN","EASEZF3",88,0)
 S FLINK(TYPE,MULT,408.12)=DGPRIEN
"RTN","EASEZF3",89,0)
 ;don't continue if file#408.12 record doesn't exist
"RTN","EASEZF3",90,0)
 Q:'$G(FLINK(TYPE,MULT,408.12))
"RTN","EASEZF3",91,0)
 ;store the link in subfile #712.01 record
"RTN","EASEZF3",92,0)
 S FLD="" F  S FLD=$O(@ARR@(MULT,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF3",93,0)
 .S SUBIEN=$P(@ARR@(MULT,FILE,SUBFILE,FLD),U,3)
"RTN","EASEZF3",94,0)
 .S $P(@ARR@(MULT,FILE,SUBFILE,FLD),U,5)=FLINK(TYPE,MULT,FILE)
"RTN","EASEZF3",95,0)
 ;there's never more than one array node for subfile #408.1275; for field #.01;
"RTN","EASEZF3",96,0)
 S SUBFILE=408.1275,FLD=".01"
"RTN","EASEZF3",97,0)
 S XX=$G(@ARR@(MULT,FILE,SUBFILE,FLD))
"RTN","EASEZF3",98,0)
 K EAS
"RTN","EASEZF3",99,0)
 S XDATE=$P(XX,U,1)
"RTN","EASEZF3",100,0)
 S SUBIEN=$P(XX,U,3)
"RTN","EASEZF3",101,0)
 Q:XDATE=""
"RTN","EASEZF3",102,0)
 S X=XDATE D ^%DT S XDATE=Y
"RTN","EASEZF3",103,0)
 S EAS(EASAPP,SUBFILE,"+1,"_FLINK(TYPE,MULT,408.12)_",",".01")=XDATE
"RTN","EASEZF3",104,0)
 S EAS(EASAPP,SUBFILE,"+1,"_FLINK(TYPE,MULT,408.12)_",",".02")=1
"RTN","EASEZF3",105,0)
 S FLINK(TYPE,MULT,SUBFILE)=$$NOLINK^EASEZF2(.EAS,TYPE,MULT)
"RTN","EASEZF3",106,0)
 Q:FLINK(TYPE,MULT,SUBFILE)=""
"RTN","EASEZF3",107,0)
 ;store link to new subrecord in subfile #712.01
"RTN","EASEZF3",108,0)
 S $P(@ARR@(MULT,FILE,SUBFILE,FLD),U,5)=FLINK(TYPE,MULT,FILE)_";"_FLINK(TYPE,MULT,SUBFILE)
"RTN","EASEZF3",109,0)
 Q
"RTN","EASEZF4")
0^6^B13992070
"RTN","EASEZF4",1,0)
EASEZF4 ;ALB/jap - Filing 1010EZ Data to Patient Database ;10/31/00  13:07
"RTN","EASEZF4",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZF4",3,0)
 ;
"RTN","EASEZF4",4,0)
CN ;file Dependent/Child data
"RTN","EASEZF4",5,0)
 N MULTIPLE,FILE,SUBFILE,FLD,XDATA,ACCEPT,SUBIEN,SEX,SSN,EZDATA,EAS,ERR,X,Y
"RTN","EASEZF4",6,0)
 ;process sequence must be 408.13 - 408.12 - 408.21 - 408.22
"RTN","EASEZF4",7,0)
 S MULTIPLE=0 F  S MULTIPLE=$O(CN(MULTIPLE)) Q:'MULTIPLE  F FILE=408.13,408.12,408.21,408.22 D
"RTN","EASEZF4",8,0)
 .S SUBFILE=FILE,FLD=""
"RTN","EASEZF4",9,0)
 .S XLINK=$G(FLINK("CN",MULTIPLE,FILE))
"RTN","EASEZF4",10,0)
 .;record in file #408.13 is needed for all further data filng
"RTN","EASEZF4",11,0)
 .Q:(FILE'=408.13)&('$G(FLINK("CN",MULTIPLE,408.13)))
"RTN","EASEZF4",12,0)
 .;for data elements with link to database, 
"RTN","EASEZF4",13,0)
 .;only file 1010EZ data if accepted by user;
"RTN","EASEZF4",14,0)
 .;data in external format
"RTN","EASEZF4",15,0)
 .I XLINK D
"RTN","EASEZF4",16,0)
 ..;when #408.12 record exists, don't try to update subfile #408.1275
"RTN","EASEZF4",17,0)
 ..S FLD="" F  S FLD=$O(CN(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF4",18,0)
 ...S XDATA=CN(MULTIPLE,FILE,SUBFILE,FLD),ACCEPT=$P(XDATA,U,2)
"RTN","EASEZF4",19,0)
 ...I FILE=408.13,FLD=.09 S XDATA=$TR(XDATA,"-","")
"RTN","EASEZF4",20,0)
 ...I ACCEPT D LINK^EASEZF2(XDATA,FILE,FLD,"CN",MULTIPLE)
"RTN","EASEZF4",21,0)
 .;for data elements with no link to database, 
"RTN","EASEZF4",22,0)
 .;always create new record(s) to store 1010EZ data;
"RTN","EASEZF4",23,0)
 .;put data in internal format
"RTN","EASEZF4",24,0)
 .I 'XLINK D
"RTN","EASEZF4",25,0)
 ..K EAS,ERR
"RTN","EASEZF4",26,0)
 ..S FLD="" F  S FLD=$O(CN(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF4",27,0)
 ...S EZDATA=$P(CN(MULTIPLE,FILE,SUBFILE,FLD),U,1)
"RTN","EASEZF4",28,0)
 ...S EAS(EASAPP,FILE,"+1,",FLD)=EZDATA
"RTN","EASEZF4",29,0)
 ..;supplement data and convert to internal format
"RTN","EASEZF4",30,0)
 ..I FILE=408.13 D
"RTN","EASEZF4",31,0)
 ...S X=$G(EAS(EASAPP,FILE,"+1,",".03")) I X'="" D ^%DT S EAS(EASAPP,FILE,"+1,",".03")=Y
"RTN","EASEZF4",32,0)
 ...S X=$G(EAS(EASAPP,FILE,"+1,",".09")) I X'="" D
"RTN","EASEZF4",33,0)
 ....S SSN=$TR(X,"-","") S EAS(EASAPP,FILE,"+1,",".09")=SSN
"RTN","EASEZF4",34,0)
 ....I $D(^DGPR(408.13,"SSN",SSN)) S EAS(EASAPP,FILE,"+1,",".09")=""
"RTN","EASEZF4",35,0)
 ...S X=$P($G(CN(MULTIPLE,408.12,408.12,.02)),U,1) S SEX=$S(X="SON":"M",X="DAUGHTER":"F",1:"")
"RTN","EASEZF4",36,0)
 ...I SEX'="" S EAS(EASAPP,FILE,"+1,",".02")=SEX
"RTN","EASEZF4",37,0)
 ..I FILE=408.12,$G(FLINK("CN",MULTIPLE,408.13)) D F40812^EASEZF3("CN",MULTIPLE)
"RTN","EASEZF4",38,0)
 ..I FILE=408.21,$G(FLINK("CN",MULTIPLE,408.12)) D
"RTN","EASEZF4",39,0)
 ...S EAS(EASAPP,FILE,"+1,",".01")=INCYR
"RTN","EASEZF4",40,0)
 ...S EAS(EASAPP,FILE,"+1,",".02")=FLINK("CN",MULTIPLE,408.12)
"RTN","EASEZF4",41,0)
 ...S EAS(EASAPP,FILE,"+1,","101")=DUZ
"RTN","EASEZF4",42,0)
 ...S EAS(EASAPP,FILE,"+1,","102")=DT
"RTN","EASEZF4",43,0)
 ...S EAS(EASAPP,FILE,"+1,","103")=DUZ
"RTN","EASEZF4",44,0)
 ...S EAS(EASAPP,FILE,"+1,","104")=DT
"RTN","EASEZF4",45,0)
 ..I FILE=408.22,$G(FLINK("CN",MULTIPLE,408.21)) D
"RTN","EASEZF4",46,0)
 ...S EAS(EASAPP,FILE,"+1,",".01")=EASDFN
"RTN","EASEZF4",47,0)
 ...S EAS(EASAPP,FILE,"+1,",".02")=FLINK("CN",MULTIPLE,408.21)
"RTN","EASEZF4",48,0)
 ...S X=$P($G(CN(MULTIPLE,FILE,SUBFILE,".09")),U,1),EAS(EASAPP,FILE,"+1,",".09")=$S(X="YES":1,1:0)
"RTN","EASEZF4",49,0)
 ...S X=$P($G(CN(MULTIPLE,FILE,SUBFILE,".1")),U,1) I X S EAS(EASAPP,FILE,"+1,",".1")=1
"RTN","EASEZF4",50,0)
 ..I FILE'=408.12 D
"RTN","EASEZF4",51,0)
 ...S FLINK("CN",MULTIPLE,FILE)=$$NOLINK^EASEZF2(.EAS)
"RTN","EASEZF4",52,0)
 ...S FLD="" F  S FLD=$O(CN(MULTIPLE,FILE,SUBFILE,FLD)) Q:FLD=""  D
"RTN","EASEZF4",53,0)
 ....S $P(CN(MULTIPLE,FILE,SUBFILE,FLD),U,5)=FLINK("CN",MULTIPLE,FILE)
"RTN","EASEZF4",54,0)
 Q
"RTN","EASEZF4",55,0)
 ;
"RTN","EASEZF4",56,0)
LINKUP ;
"RTN","EASEZF4",57,0)
 N SUBIEN,KEYIEN,MULTIPLE,FILE,SUBFILE,DATANM,TYPE,LINK,X
"RTN","EASEZF4",58,0)
 S SUBIEN=0 F  S SUBIEN=$O(^EAS(712,EASAPP,10,SUBIEN)) Q:+SUBIEN=0  D
"RTN","EASEZF4",59,0)
 .S X=$G(^EAS(712,EASAPP,10,SUBIEN,1))
"RTN","EASEZF4",60,0)
 .;quit if no data to file
"RTN","EASEZF4",61,0)
 .Q:(($P(X,U,1)="")&($P(X,U,2)=""))
"RTN","EASEZF4",62,0)
 .S TYPE=""
"RTN","EASEZF4",63,0)
 .S KEYIEN=$P(^EAS(712,EASAPP,10,SUBIEN,0),U,1),MULTIPLE=$P(^(0),U,2)
"RTN","EASEZF4",64,0)
 .S DATANM=$P(^EAS(711,KEYIEN,0),U,1),FILE=$P(^EAS(711,KEYIEN,1),U,1),SUBFILE=$P(^(1),U,2)
"RTN","EASEZF4",65,0)
 .Q:FILE<408
"RTN","EASEZF4",66,0)
 .Q:FILE>408.22
"RTN","EASEZF4",67,0)
 .I SUBFILE=408.1275 S FILE=SUBFILE
"RTN","EASEZF4",68,0)
 .I DATANM["CHILD" S TYPE="CN"
"RTN","EASEZF4",69,0)
 .I DATANM["CHILD(N)" S MULTIPLE=MULTIPLE+1
"RTN","EASEZF4",70,0)
 .I DATANM["SPOUSE" S TYPE="SP"
"RTN","EASEZF4",71,0)
 .I TYPE="" S TYPE="AP"
"RTN","EASEZF4",72,0)
 .S LINK=$G(FLINK(TYPE,MULTIPLE,FILE))
"RTN","EASEZF4",73,0)
 .Q:'LINK
"RTN","EASEZF4",74,0)
 .I FILE=408.1275 S LINK=FLINK(TYPE,MULTIPLE,408.12)_";"_FLINK(TYPE,MULTIPLE,FILE)
"RTN","EASEZF4",75,0)
 .S $P(^EAS(712,EASAPP,10,SUBIEN,2),U,2)=LINK
"RTN","EASEZF4",76,0)
 Q
"RTN","EASEZFM")
0^7^B8303288
"RTN","EASEZFM",1,0)
EASEZFM ;ALB/jap - Filing 1010EZ Data to Patient Database ;10/12/00  13:08
"RTN","EASEZFM",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZFM",3,0)
 ;
"RTN","EASEZFM",4,0)
QUE ;entry point from queued background job
"RTN","EASEZFM",5,0)
 ;
"RTN","EASEZFM",6,0)
 ;check signature verification before continuing
"RTN","EASEZFM",7,0)
 K ^TMP("1010EZERROR",$J)
"RTN","EASEZFM",8,0)
 Q:'$G(EASAPP)
"RTN","EASEZFM",9,0)
 Q:'$D(^EAS(712,EASAPP,0))
"RTN","EASEZFM",10,0)
 S EASEZNEW=$P(^EAS(712,EASAPP,0),U,11)
"RTN","EASEZFM",11,0)
 S X=$G(^EAS(712,EASAPP,1))
"RTN","EASEZFM",12,0)
 ;recheck signature status
"RTN","EASEZFM",13,0)
 I ('$P(X,U,1))&('$P(X,U,2)) D  Q
"RTN","EASEZFM",14,0)
 .;remove filing date if can't continue
"RTN","EASEZFM",15,0)
 .S FDT=$P(^EAS(712,EASAPP,2),U,5),$P(^EAS(712,EASAPP,2),U,5)="",$P(^EAS(712,EASAPP,2),U,6)="",$P(^EAS(712,EASAPP,2),U,11)=""
"RTN","EASEZFM",16,0)
 .I FDT K ^EAS(712,"FIL",FDT,EASAPP)
"RTN","EASEZFM",17,0)
 .D APPINDEX^EASEZU2(EASAPP)
"RTN","EASEZFM",18,0)
 ;
"RTN","EASEZFM",19,0)
 L +^EAS(712,EASAPP)
"RTN","EASEZFM",20,0)
 ;check incoming data
"RTN","EASEZFM",21,0)
 D CHECK
"RTN","EASEZFM",22,0)
 ;
"RTN","EASEZFM",23,0)
 ;get EZ1010 data into ^TMP("EZDATA" array
"RTN","EASEZFM",24,0)
 D EN^EASEZC1(EASAPP,.EASDFN)
"RTN","EASEZFM",25,0)
 ;
"RTN","EASEZFM",26,0)
 ;store file #2 data
"RTN","EASEZFM",27,0)
 D F2^EASEZF1(EASAPP,EASDFN)
"RTN","EASEZFM",28,0)
 ;
"RTN","EASEZFM",29,0)
 ;store file #408.12, #408.13, #408.21, #408.22 data
"RTN","EASEZFM",30,0)
 D F408^EASEZF2(EASAPP,EASDFN)
"RTN","EASEZFM",31,0)
 ;
"RTN","EASEZFM",32,0)
 ;store file #355.33 data;
"RTN","EASEZFM",33,0)
 ;call IB API to file health insurance and Medicare data
"RTN","EASEZFM",34,0)
 D IBINS^EASEZF5(EASAPP,EASDFN)
"RTN","EASEZFM",35,0)
 ;
"RTN","EASEZFM",36,0)
 ;update 'new patient' remark
"RTN","EASEZFM",37,0)
 I EASEZNEW D
"RTN","EASEZFM",38,0)
 .S REM="New Patient record added by ELECTRONIC 10-10EZ."
"RTN","EASEZFM",39,0)
 .S DA=EASDFN,DIE="^DPT(",DR=".091///^S X=REM"
"RTN","EASEZFM",40,0)
 .D ^DIE
"RTN","EASEZFM",41,0)
 ;update processing status if not already done
"RTN","EASEZFM",42,0)
 I $P($G(^EAS(712,EASAPP,2)),U,5)="" D SETDATE^EASEZU2(EASAPP,"FIL")
"RTN","EASEZFM",43,0)
 ;remove the task id
"RTN","EASEZFM",44,0)
 S $P(^EAS(712,EASAPP,2),U,11)=""
"RTN","EASEZFM",45,0)
 L -^EAS(712,EASAPP)
"RTN","EASEZFM",46,0)
 I $D(^TMP("1010EZERROR",$J)) D MAILERR
"RTN","EASEZFM",47,0)
 S ZTREQ="@"
"RTN","EASEZFM",48,0)
 Q
"RTN","EASEZFM",49,0)
 ;
"RTN","EASEZFM",50,0)
CHECK ;check data
"RTN","EASEZFM",51,0)
 ;returns '0' if any invalid data found; otherwise '1'
"RTN","EASEZFM",52,0)
 N SUBIEN,X,CHK,DIK,DA
"RTN","EASEZFM",53,0)
 ;remove any 'noise' from incoming data
"RTN","EASEZFM",54,0)
 S SUBIEN=0 F  S SUBIEN=$O(^EAS(712,EASAPP,10,SUBIEN)) Q:+SUBIEN=0  D
"RTN","EASEZFM",55,0)
 .S CHK=$P($G(^EAS(712,EASAPP,10,SUBIEN,1)),U,1)
"RTN","EASEZFM",56,0)
 .I (CHK="/")!(CHK="//")!(CHK="-")!(CHK="--")!(CHK=" ")!(CHK="") D
"RTN","EASEZFM",57,0)
 ..S DA=SUBIEN,DA(1)=EASAPP,DIK="^EAS(712,"_DA(1)_",10,"
"RTN","EASEZFM",58,0)
 ..D ^DIK
"RTN","EASEZFM",59,0)
 Q
"RTN","EASEZFM",60,0)
 ;
"RTN","EASEZFM",61,0)
CLEAN ; cleanup
"RTN","EASEZFM",62,0)
 K ^TMP("EZDATA",$J),^TMP("EZINDEX",$J),^TMP("EZTEMP",$J),^TMP("EZDISP",$J)
"RTN","EASEZFM",63,0)
 Q
"RTN","EASEZFM",64,0)
 ;
"RTN","EASEZFM",65,0)
MAILERR ;notify user if any data elements failed FM validator
"RTN","EASEZFM",66,0)
 ;
"RTN","EASEZFM",67,0)
 N XMY,XMSUB,XMDUZ,XMTEXT,Y
"RTN","EASEZFM",68,0)
 ;fill-in first 6 lines of message
"RTN","EASEZFM",69,0)
 S ^TMP("1010EZERROR",$J,1,0)="Errors were returned by the FileMan validator when filing 1010EZ"
"RTN","EASEZFM",70,0)
 S ^TMP("1010EZERROR",$J,2,0)="data for --"
"RTN","EASEZFM",71,0)
 S ^TMP("1010EZERROR",$J,3,0)="Applicant:     "_$P($G(^EAS(712,EASAPP,0)),U,4)
"RTN","EASEZFM",72,0)
 S ^TMP("1010EZERROR",$J,4,0)="Application #: "_EASAPP
"RTN","EASEZFM",73,0)
 S Y=DT D DD^%DT
"RTN","EASEZFM",74,0)
 S ^TMP("1010EZERROR",$J,5,0)="Filing Date:   "_Y
"RTN","EASEZFM",75,0)
 S ^TMP("1010EZERROR",$J,6,0)=" "
"RTN","EASEZFM",76,0)
 ;setup call to MailMan
"RTN","EASEZFM",77,0)
 S XMSUB="EAS 1010EZ Error Report for APP #"_EASAPP,XMDUZ=.5
"RTN","EASEZFM",78,0)
 S XMY(DUZ)=""
"RTN","EASEZFM",79,0)
 S XMTEXT="^TMP(""1010EZERROR"",$J,"
"RTN","EASEZFM",80,0)
 D ^XMD
"RTN","EASEZFM",81,0)
 K ^TMP("1010EZERROR",$J)
"RTN","EASEZFM",82,0)
 Q
"RTN","EASEZI")
0^8^B45048604
"RTN","EASEZI",1,0)
EASEZI ;ALB/jap - Database Inquiry & Record Finder for 1010EZ Processing ;10/12/00  13:08
"RTN","EASEZI",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZI",3,0)
 ;
"RTN","EASEZI",4,0)
DFN(EASAPP,EASDFN) ;match or add 1010EZ applicant to Patient file #2
"RTN","EASEZI",5,0)
 ;
"RTN","EASEZI",6,0)
 ;input  
"RTN","EASEZI",7,0)
 ;  EASAPP = application ien in file #712
"RTN","EASEZI",8,0)
 ;output 
"RTN","EASEZI",9,0)
 ;  EASDFN = valid ien in file #2; passed by reference
"RTN","EASEZI",10,0)
 ;           OR -1 if no patient match made;
"RTN","EASEZI",11,0)
 ;           note: this may be an existing patient or one newly created by user action
"RTN","EASEZI",12,0)
 ;
"RTN","EASEZI",13,0)
 ;This entry point it used only for initial match of Applicant with Patient database.
"RTN","EASEZI",14,0)
 ;
"RTN","EASEZI",15,0)
 N DFN,DGNEWPF,DGRPTOUT,EZDATA,KEY,NAME,SSN,DOB,SEX,KEYIEN,ACCEPT,ARRAY,RECD
"RTN","EASEZI",16,0)
 N VETTYPE,NEW,TSSN,REM,N,X,DA,DR,DIE,DIC,DIQ,ALREADY,OUT,FILE,SUBFILE,FLD,ELIGVER,SVCVER
"RTN","EASEZI",17,0)
 Q:'EASAPP
"RTN","EASEZI",18,0)
 ;do not proceed if link to file #2 already established
"RTN","EASEZI",19,0)
 S EASDFN=$P($G(^EAS(712,EASAPP,0)),U,10) Q:EASDFN
"RTN","EASEZI",20,0)
 ;
"RTN","EASEZI",21,0)
 D FULL^VALM1 W @IOF
"RTN","EASEZI",22,0)
 S EASEZNEW="",ELIGVER=0,SVCVER=0
"RTN","EASEZI",23,0)
 S KEY=$$KEY711^EASEZU1("APPLICANT SEX")
"RTN","EASEZI",24,0)
 S SEX=$P($$DATA712^EASEZU1(EASAPP,KEY),U,1),SEX=$S(SEX="M":"Male",SEX="F":"Female",1:"")
"RTN","EASEZI",25,0)
 S DIQ="ARRAY",DIQ(0)="E",DA=EASAPP,DR="1;2;3;3.3",DIC=712 D EN^DIQ1
"RTN","EASEZI",26,0)
 S NAME=$G(ARRAY(712,EASAPP,1,"E"))
"RTN","EASEZI",27,0)
 S SSN=$P($G(ARRAY(712,EASAPP,2,"E")),"&",1)
"RTN","EASEZI",28,0)
 S DOB=$P($G(ARRAY(712,EASAPP,2,"E")),"&",2)
"RTN","EASEZI",29,0)
 S RECD=$G(ARRAY(712,EASAPP,3,"E"))
"RTN","EASEZI",30,0)
 S VETTYPE=$G(ARRAY(712,EASAPP,3.3,"E"))
"RTN","EASEZI",31,0)
 W !,"Applicant Data",?24,"Application #: ",EASAPP,?48,"Received: ",RECD,!
"RTN","EASEZI",32,0)
 W !,"Name: ",NAME
"RTN","EASEZI",33,0)
 W !,"SSN: ",SSN,?24,"DOB: ",DOB,?48,"Sex: ",SEX
"RTN","EASEZI",34,0)
 W !,"Veteran Type: ",VETTYPE
"RTN","EASEZI",35,0)
 W !!,"Enter Applicant data as prompted --"
"RTN","EASEZI",36,0)
 ;
"RTN","EASEZI",37,0)
 ;Get Patient file (#2) IEN - DFN
"RTN","EASEZI",38,0)
 D GETPAT^DGRPTU("",1,.DFN,.DGNEWPF)
"RTN","EASEZI",39,0)
 Q:($G(DFN)'>0)
"RTN","EASEZI",40,0)
 ;if DGNEWPF=1 then applicant has just been added to file #2 as new patient
"RTN","EASEZI",41,0)
 S NEW=""
"RTN","EASEZI",42,0)
 I DGNEWPF D
"RTN","EASEZI",43,0)
 .S NEW=1
"RTN","EASEZI",44,0)
 .;add a remark to file #2 record to help keep track of new patients added by 1010EZ
"RTN","EASEZI",45,0)
 .S REM="NEW PT. FROM ELECTRONIC 10-10EZ -- IN PROCESS"
"RTN","EASEZI",46,0)
 .S DA=DFN,DIE="^DPT(",DR=".091///^S X=REM"
"RTN","EASEZI",47,0)
 .D ^DIE
"RTN","EASEZI",48,0)
 ;if seems to be not new, check remark field just to make sure
"RTN","EASEZI",49,0)
 I NEW="" D
"RTN","EASEZI",50,0)
 .S REM="NEW PT. FROM ELECTRONIC 10-10EZ -- IN PROCESS"
"RTN","EASEZI",51,0)
 .I $P(^DPT(DFN,0),U,10)=REM S NEW=1
"RTN","EASEZI",52,0)
 ;
"RTN","EASEZI",53,0)
 ;MPI Query
"RTN","EASEZI",54,0)
 S X="MPIFAPI" X ^%ZOSF("TEST")  D
"RTN","EASEZI",55,0)
 .Q:'$T
"RTN","EASEZI",56,0)
 .K MPIFRTN
"RTN","EASEZI",57,0)
 .D MPIQ^MPIFAPI(DFN)
"RTN","EASEZI",58,0)
 .K MPIFRTN,MPIQRYNM
"RTN","EASEZI",59,0)
 ;
"RTN","EASEZI",60,0)
 ;check for an in-process application already linked to this DFN
"RTN","EASEZI",61,0)
 S OUT=0,ALREADY=0 F  S ALREADY=$O(^EAS(712,"AC",DFN,ALREADY)) Q:'ALREADY  D  Q:OUT
"RTN","EASEZI",62,0)
 .S FILDATE=$P($G(^EAS(712,ALREADY,2)),U,5)
"RTN","EASEZI",63,0)
 .S CLSDATE=$P($G(^EAS(712,ALREADY,2)),U,9)
"RTN","EASEZI",64,0)
 .I 'FILDATE,'CLSDATE S OUT=1 D
"RTN","EASEZI",65,0)
 ..W !!?3,"Sorry... cannot link to selected Patient."
"RTN","EASEZI",66,0)
 ..W !?3,"Application #"_ALREADY_" is already linked to this Patient,"
"RTN","EASEZI",67,0)
 ..W !?3,"and is still in-process."
"RTN","EASEZI",68,0)
 ..D PAUSE^VALM1 K FILDATE,CLSDATE
"RTN","EASEZI",69,0)
 Q:OUT
"RTN","EASEZI",70,0)
 ;
"RTN","EASEZI",71,0)
 ;set link in file #712 record
"RTN","EASEZI",72,0)
 S DA=EASAPP
"RTN","EASEZI",73,0)
 S DIE="^EAS(712,"
"RTN","EASEZI",74,0)
 S DR="3.4///^S X=DFN;" I NEW S DR=DR_"3.5///^S X=NEW"
"RTN","EASEZI",75,0)
 D ^DIE
"RTN","EASEZI",76,0)
 ;
"RTN","EASEZI",77,0)
 W !,"One moment please...",!
"RTN","EASEZI",78,0)
 S EASDFN=DFN
"RTN","EASEZI",79,0)
 ;if applicant is new to database, user accept/not accept of data elements is constrained; 
"RTN","EASEZI",80,0)
 ;if applicant is new to VistA, mark all data elements 'accepted';
"RTN","EASEZI",81,0)
 I NEW S N=0 F  S N=$O(^EAS(712,EASAPP,10,N)) Q:'N  I $G(^EAS(712,EASAPP,10,N,1))'="" D
"RTN","EASEZI",82,0)
 .S ACCEPT="",FLD="",SUBFILE="",FILE=""
"RTN","EASEZI",83,0)
 .S KEYIEN=$P(^EAS(712,EASAPP,10,N,0),U,1)
"RTN","EASEZI",84,0)
 .I KEYIEN S X=$G(^EAS(711,KEYIEN,1)),FILE=$P(X,U,1),SUBFILE=$P(X,U,2),FLD=$P(X,U,3)
"RTN","EASEZI",85,0)
 .I FLD S ACCEPT=1
"RTN","EASEZI",86,0)
 .I 'FLD S ACCEPT=-1
"RTN","EASEZI",87,0)
 .I (FILE=355.33)!(FILE>408) S ACCEPT=2
"RTN","EASEZI",88,0)
 .I FILE=2,((FLD=.01)!(FLD=.03)!(FLD=.09)!(FLD=.531)) S ACCEPT=-1
"RTN","EASEZI",89,0)
 .I ((SUBFILE=2.01)!(SUBFILE=2.101)) S ACCEPT=-1
"RTN","EASEZI",90,0)
 .S $P(^EAS(712,EASAPP,10,N,0),U,3)=ACCEPT
"RTN","EASEZI",91,0)
 ;for applicants matched to existing patients check for verified eligibility
"RTN","EASEZI",92,0)
 I 'NEW D
"RTN","EASEZI",93,0)
 .K ARRAY
"RTN","EASEZI",94,0)
 .S DA=EASDFN,DIC="^DPT(",DR=".3611;.3613",DIQ(0)="I",DIQ="ARRAY"
"RTN","EASEZI",95,0)
 .D EN^DIQ1
"RTN","EASEZI",96,0)
 .I ARRAY(2,EASDFN,.3611,"I")="V",ARRAY(2,EASDFN,.3613,"I")="H" S ELIGVER=1
"RTN","EASEZI",97,0)
 ;setup tmp array for data mapping
"RTN","EASEZI",98,0)
 D LOCAL711^EASEZU2
"RTN","EASEZI",99,0)
 ;correlate #712 data with mapping array
"RTN","EASEZI",100,0)
 S N=0 F  S N=$O(^EAS(712,EASAPP,10,N)) Q:'N  S X=^(N,0) D
"RTN","EASEZI",101,0)
 .;don't set array node if no 1010EZ data
"RTN","EASEZI",102,0)
 .S EZDATA=$P($G(^EAS(712,EASAPP,10,N,1)),U,1)
"RTN","EASEZI",103,0)
 .Q:EZDATA=""
"RTN","EASEZI",104,0)
 .S IEN=$P(X,U,1),MULTIPLE=$P(X,U,2),ACCEPT=$P(X,U,3)
"RTN","EASEZI",105,0)
 .S ^TMP("EZDATA",$J,IEN,MULTIPLE,1)=EZDATA_U_ACCEPT_U_N
"RTN","EASEZI",106,0)
 ;
"RTN","EASEZI",107,0)
 ;if applicant new to VistA, stop here;
"RTN","EASEZI",108,0)
 I NEW S EASEZNEW=1
"RTN","EASEZI",109,0)
 Q:EASEZNEW
"RTN","EASEZI",110,0)
 ;if matched to existing patient, get all iens needed
"RTN","EASEZI",111,0)
 W !,"Preparing for data comparison to VistA Patient database...",!
"RTN","EASEZI",112,0)
 K ALIAS,DISPOS,ENROLL,INCREL
"RTN","EASEZI",113,0)
 D I201^EASEZI(EASDFN,.ALIAS) W "."
"RTN","EASEZI",114,0)
 I $D(ALIAS)>1 D C201^EASEZC1
"RTN","EASEZI",115,0)
 D I2101^EASEZI(EASDFN,.DISPOS) W "."
"RTN","EASEZI",116,0)
 I $D(DISPOS)>1 D C2101^EASEZC1
"RTN","EASEZI",117,0)
 ;finish getting the rest of file #2 data needed for comparison 
"RTN","EASEZI",118,0)
 D C2^EASEZC1
"RTN","EASEZI",119,0)
 D I2711^EASEZI(EASDFN,.ENROLL) W "."
"RTN","EASEZI",120,0)
 I $D(ENROLL)>1 D C2711^EASEZC1
"RTN","EASEZI",121,0)
 D I408^EASEZI(EASDFN,.INCREL) W "."
"RTN","EASEZI",122,0)
 I $D(INCREL)>1 D C408^EASEZC1
"RTN","EASEZI",123,0)
 ;
"RTN","EASEZI",124,0)
 ;for all applicants matched to existing patients, 
"RTN","EASEZI",125,0)
 ;  set file #355.33 data to 'always accept';
"RTN","EASEZI",126,0)
 ;  ;set unmatched data for files #408.12, #408.13, #408.21, #408.22 to 'always accept';
"RTN","EASEZI",127,0)
 S N=0 F  S N=$O(^EAS(712,EASAPP,10,N)) Q:'N  S X=^(N,0) D
"RTN","EASEZI",128,0)
 .S KEYIEN=$P(X,U,1),MULTIPLE=$P(X,U,2)
"RTN","EASEZI",129,0)
 .;S LINK=$P($G(^EAS(712,EASAPP,10,N,2)),U,2)
"RTN","EASEZI",130,0)
 .S X=$G(^EAS(711,KEYIEN,1)),FILE=$P(X,U,1),FLD=$P(X,U,3)
"RTN","EASEZI",131,0)
 .S ACCEPT=""
"RTN","EASEZI",132,0)
 .I 'FLD S ACCEPT=-1
"RTN","EASEZI",133,0)
 .I FILE=2,((FLD=.01)!(FLD=.03)!(FLD=.09)!(FLD=.531)) S ACCEPT=-1
"RTN","EASEZI",134,0)
 .;set certain eligibility related data elements to 'never accept' if eligibility verified
"RTN","EASEZI",135,0)
 .I FILE=2,FLD=.313,$G(ARRAY(2,EASDFN,.3611,"I"))="V" S ACCEPT=-1
"RTN","EASEZI",136,0)
 .I FILE=2,ELIGVER,((FLD=.301)!(FLD=.302)!(FLD=.36235)) S ACCEPT=-1
"RTN","EASEZI",137,0)
 .I FILE=355.33 S ACCEPT=2
"RTN","EASEZI",138,0)
 .I FILE>408 S ACCEPT=2
"RTN","EASEZI",139,0)
 .S $P(^EAS(712,EASAPP,10,N,0),U,3)=ACCEPT
"RTN","EASEZI",140,0)
 .S $P(^TMP("EZDATA",$J,KEYIEN,MULTIPLE,1),U,2)=ACCEPT
"RTN","EASEZI",141,0)
 K ALIAS,DISPOS,ENROLL,INCREL
"RTN","EASEZI",142,0)
 Q
"RTN","EASEZI",143,0)
 ;
"RTN","EASEZI",144,0)
I201(EASDFN,EASARRAY) ;retrieve ien(s) in Alias subfile #2.01
"RTN","EASEZI",145,0)
 ;input EASDFN    = ien to #2
"RTN","EASEZI",146,0)
 ;output EASARRAY = ien(s) to #2.01
"RTN","EASEZI",147,0)
 ;                  each array element = EASDFN;subfile_ien
"RTN","EASEZI",148,0)
 ;
"RTN","EASEZI",149,0)
 N N,IEN
"RTN","EASEZI",150,0)
 S IEN=0,N=0 F  S IEN=$O(^DPT(EASDFN,.01,IEN)) Q:'IEN  S N=N+1,EASARRAY(N)=EASDFN_";"_IEN
"RTN","EASEZI",151,0)
 Q
"RTN","EASEZI",152,0)
 ;
"RTN","EASEZI",153,0)
I2101(EASDFN,EASARRAY) ;retrieve ien to Disposition subfile #2.101
"RTN","EASEZI",154,0)
 ;input EASDFN    = ien to #2
"RTN","EASEZI",155,0)
 ;output EASARRAY = most recent ien in #2.101;
"RTN","EASEZI",156,0)
 ;                  array element = EASDFN;subfile_ien
"RTN","EASEZI",157,0)
 ;
"RTN","EASEZI",158,0)
 N N,IEN,ARR,LAST
"RTN","EASEZI",159,0)
 S IEN=0,N=0 F  S IEN=$O(^DPT(EASDFN,"DIS",IEN)) Q:'IEN  D
"RTN","EASEZI",160,0)
 .S RDATE=$P(^DPT(EASDFN,"DIS",IEN,0),U,1),ARR(RDATE)=IEN
"RTN","EASEZI",161,0)
 I $D(ARR) D
"RTN","EASEZI",162,0)
 .S LAST=$O(ARR(999999999),-1),IEN=ARR(LAST)
"RTN","EASEZI",163,0)
 .S EASARRAY(1)=EASDFN_";"_IEN
"RTN","EASEZI",164,0)
 Q
"RTN","EASEZI",165,0)
 ;
"RTN","EASEZI",166,0)
I2711(EASDFN,EASARRAY) ;retrieve ien to Enrollment file #27.11
"RTN","EASEZI",167,0)
 ;input EASDFN    = ien to #2
"RTN","EASEZI",168,0)
 ;output EASARRAY = current enrollment ien in #27.11;
"RTN","EASEZI",169,0)
 ;                  array element = ien
"RTN","EASEZI",170,0)
 N CUR
"RTN","EASEZI",171,0)
 S CUR=$$FINDCUR^DGENA(+EASDFN)
"RTN","EASEZI",172,0)
 S EASARRAY(1)=CUR
"RTN","EASEZI",173,0)
 Q
"RTN","EASEZI",174,0)
 ;
"RTN","EASEZI",175,0)
I408(EASDFN,EASARRAY) ;retrieve ien(s) to files #408.12,#408.13,#408.21,#408.22
"RTN","EASEZI",176,0)
 ;
"RTN","EASEZI",177,0)
 ;input EASDFN    = ien to #2
"RTN","EASEZI",178,0)
 ;output EASARRAY = ien(s) to files; passed by reference
"RTN","EASEZI",179,0)
 ;       array(408,"V",1) = ien_#408.12^ien_#408.13^ien_#408.21^ien#408.22 ;veteran data
"RTN","EASEZI",180,0)
 ;       array(408,"S",1) = ien_#408.12^ien_#408.13^ien_#408.21^ien#408.22 ;spouse data
"RTN","EASEZI",181,0)
 ;       array(408,"C",multiple) = ien_#408.12^ien_#408.13^ien_#408.21^ien#408.22 ;child data
"RTN","EASEZI",182,0)
 ;   where ien_#408.13 = ien;global_root
"RTN","EASEZI",183,0)
 ;
"RTN","EASEZI",184,0)
 N CURINCYR,X,Y,DIC,DA,DR,DIQ,EAS,DEP,REL,IX,JX,KX,I13,SUB1,SUB2,INCYR,PT
"RTN","EASEZI",185,0)
 ;
"RTN","EASEZI",186,0)
 Q:'EASDFN
"RTN","EASEZI",187,0)
 S Y=DT,%F=5,X=$$FMTE^XLFDT(Y,%F),X=$P(X,"/",3)-1,%DT="P" D ^%DT S CURINCYR=Y
"RTN","EASEZI",188,0)
 ;find all associated 408 records, even if no actual income test
"RTN","EASEZI",189,0)
 ; get #408.12, #408.13, #408.21, #408.22 iens
"RTN","EASEZI",190,0)
 K EAS S DEP=0
"RTN","EASEZI",191,0)
 S IX=0 F  S IX=$O(^DGPR(408.12,"B",EASDFN,IX)) Q:'IX  D
"RTN","EASEZI",192,0)
 .S DIC=408.12,DA=IX,DIQ="EAS",DIQ(0)="I",DR=".02;.03" D EN^DIQ1
"RTN","EASEZI",193,0)
 .S REL=$G(EAS(408.12,IX,.02,"I")),I13=$G(EAS(408.12,IX,.03,"I"))
"RTN","EASEZI",194,0)
 .S (SUB1,SUB2)="" S:REL=1 SUB1="V",SUB2=1 S:REL=2 SUB1="S",SUB2=1 S:REL>2 SUB1="C",DEP=DEP+1,SUB2=DEP
"RTN","EASEZI",195,0)
 .I SUB1]"" S EASARRAY(408,SUB1,SUB2)=IX_U_I13 D
"RTN","EASEZI",196,0)
 ..S JX=$O(^DGMT(408.21,"C",IX,""),-1)
"RTN","EASEZI",197,0)
 ..I JX D
"RTN","EASEZI",198,0)
 ...S DIC=408.21,DA=JX,DIQ="EAS",DIQ(0)="I",DR=".01;.02" D EN^DIQ1
"RTN","EASEZI",199,0)
 ...S INCYR=$G(EAS(408.21,JX,.01,"I")),PT=$G(EAS(408.21,JX,.02,"I"))
"RTN","EASEZI",200,0)
 ...Q:PT'=IX
"RTN","EASEZI",201,0)
 ...Q:INCYR<CURINCYR
"RTN","EASEZI",202,0)
 ...S KX=$O(^DGMT(408.22,"AIND",JX,0))
"RTN","EASEZI",203,0)
 ...S EASARRAY(408,SUB1,SUB2)=EASARRAY(408,SUB1,SUB2)_U_JX_U_KX
"RTN","EASEZI",204,0)
 Q
"RTN","EASEZI",205,0)
 ;
"RTN","EASEZI",206,0)
I1275(IEN) ;get the active subrecord from subfile #408.1275
"RTN","EASEZI",207,0)
 ;input     IEN = internal record number to file #408.12
"RTN","EASEZI",208,0)
 ;output SUBIEN = internal record number for active subrecord,
"RTN","EASEZI",209,0)
 ;                or -1 if invalid
"RTN","EASEZI",210,0)
 N B,ACT,SUBIEN
"RTN","EASEZI",211,0)
 I 'IEN Q -1
"RTN","EASEZI",212,0)
 S SUBIEN=-1
"RTN","EASEZI",213,0)
 S B=0 F  S B=$O(^DGPR(408.12,IEN,"E",B)) Q:'B  D
"RTN","EASEZI",214,0)
 .S ACT=$P(^DGPR(408.12,IEN,"E",B,0),U,2)
"RTN","EASEZI",215,0)
 .I ACT S SUBIEN=B
"RTN","EASEZI",216,0)
 Q SUBIEN
"RTN","EASEZL1")
0^9^B32210596
"RTN","EASEZL1",1,0)
EASEZL1 ;ALB/jap - 1010EZ List Manager Processing Screens (cont.) ;10/12/00  13:07
"RTN","EASEZL1",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM**1**;Mar 15, 2001
"RTN","EASEZL1",3,0)
 ;
"RTN","EASEZL1",4,0)
EN ;Entry point to build list area for EAS EZ Applications processing
"RTN","EASEZL1",5,0)
 ;
"RTN","EASEZL1",6,0)
 D EN^VALM("EAS EZ 1010EZ INITIAL SCREEN")
"RTN","EASEZL1",7,0)
 Q
"RTN","EASEZL1",8,0)
 ;
"RTN","EASEZL1",9,0)
EXPND ;
"RTN","EASEZL1",10,0)
 N V
"RTN","EASEZL1",11,0)
 K EASDFN,EASEZNEW,EASAPP,EASLOCK,EASLN
"RTN","EASEZL1",12,0)
 K ^TMP("EASEXP",$J)
"RTN","EASEZL1",13,0)
 S EASARY="EASEXP"
"RTN","EASEZL1",14,0)
 S VALMBCK=""
"RTN","EASEZL1",15,0)
 D SEL^EASEZLM
"RTN","EASEZL1",16,0)
 Q:$G(EASERR)
"RTN","EASEZL1",17,0)
 Q:'$G(EASSEL)
"RTN","EASEZL1",18,0)
 S EASAPP=$O(^TMP("EASEZ",$J,"IDX",EASSEL,0)) I 'EASAPP K ^TMP("EASEZ",$J,"IDX",EASSEL)
"RTN","EASEZL1",19,0)
 Q:'EASAPP
"RTN","EASEZL1",20,0)
 S EASLOCK=1 L +^EAS(712,EASAPP,0):5 I '$T S EASLOCK=0
"RTN","EASEZL1",21,0)
 I 'EASLOCK D  Q
"RTN","EASEZL1",22,0)
 .W !,"Another user is processing that Application... try later.",!
"RTN","EASEZL1",23,0)
 .D PAUSE^VALM1
"RTN","EASEZL1",24,0)
 .S VALMBCK="R"
"RTN","EASEZL1",25,0)
 S V=EASVIEW,EASPSTAT=$S(V=1:"NEW",V=2:"REV",V=3:"PRT",V=4:"SIG",V=5:"FIL",V=6:"CLS",1:"")
"RTN","EASEZL1",26,0)
 I EASVIEW=1 W ! D WAIT^DICD,EN^VALM("EAS EZ 1010EZ REVIEW1")
"RTN","EASEZL1",27,0)
 I EASVIEW=2 W ! D WAIT^DICD,EN^VALM("EAS EZ 1010EZ REVIEW2")
"RTN","EASEZL1",28,0)
 I EASVIEW=3 W ! D WAIT^DICD,EN^VALM("EAS EZ 1010EZ REVIEW3")
"RTN","EASEZL1",29,0)
 I EASVIEW=4 W ! D WAIT^DICD,EN^VALM("EAS EZ 1010EZ REVIEW4")
"RTN","EASEZL1",30,0)
 I EASVIEW=5 W ! D WAIT^DICD,EN^VALM("EAS EZ 1010EZ REVIEW5")
"RTN","EASEZL1",31,0)
 I EASVIEW=6 W ! D WAIT^DICD,EN^VALM("EAS EZ 1010EZ REVIEW6")
"RTN","EASEZL1",32,0)
 ;revision of 01/09/01 -- 'filed' separated from 'signed' so
"RTN","EASEZL1",33,0)
 ; EASVIEW=4 --> signed
"RTN","EASEZL1",34,0)
 ; EASVIEW=5 --> filed
"RTN","EASEZL1",35,0)
 ; EASVIEW=6 --> closed/inactivated
"RTN","EASEZL1",36,0)
 Q
"RTN","EASEZL1",37,0)
 ;
"RTN","EASEZL1",38,0)
INIT2 ;
"RTN","EASEZL1",39,0)
 ;generate ^TMP("EZDISP",$J, in order to build display
"RTN","EASEZL1",40,0)
 I '$G(EASAPP) S VALMCNT=0 D NOLINES^EASEZLM
"RTN","EASEZL1",41,0)
 S EASDFN=+$P(^EAS(712,EASAPP,0),U,10)
"RTN","EASEZL1",42,0)
 D EN^EASEZC1(EASAPP,EASDFN)
"RTN","EASEZL1",43,0)
 D HDR2
"RTN","EASEZL1",44,0)
 D BLD2
"RTN","EASEZL1",45,0)
 I '$G(VALMCNT) D NOLINES^EASEZLM
"RTN","EASEZL1",46,0)
 Q
"RTN","EASEZL1",47,0)
 ;
"RTN","EASEZL1",48,0)
HDR2 ;
"RTN","EASEZL1",49,0)
 N H,V,X,XX,SEL,FAC,JNAME,EDATE,WEBID,WILLSEND
"RTN","EASEZL1",50,0)
 S SEL=^TMP("EASEZIDX",$J,EASAPP)
"RTN","EASEZL1",51,0)
 S JNAME=$P(SEL,U,1),EDATE=$P(SEL,U,2),WEBID=$P(SEL,U,3),WILLSEND=$P(SEL,U,4),FAC=$P(SEL,U,5)
"RTN","EASEZL1",52,0)
 S WILLSEND=$S(WILLSEND:"YES",1:"NO")
"RTN","EASEZL1",53,0)
 S V=EASPSTAT
"RTN","EASEZL1",54,0)
 S H=$S(V="NEW":"NEW",V="REV":"IN REVIEW",V="PRT":"PRINTED,PENDING SIG.",V="SIG":"SIGNED",V="FIL":"FILED",V="CLS":"INACTIVATED",1:"")
"RTN","EASEZL1",55,0)
 I H="FILED",$P($G(^EAS(712,EASAPP,2)),U,11)'="" S H="Still filing..."
"RTN","EASEZL1",56,0)
 S X="Application #:",X=$$SETSTR^VALM1(X,"",1,14)
"RTN","EASEZL1",57,0)
 S X=$$SETSTR^VALM1(EASAPP,X,16,6)
"RTN","EASEZL1",58,0)
 S FAC="("_FAC_")",X=$$SETSTR^VALM1(FAC,X,27,8)
"RTN","EASEZL1",59,0)
 S XX="Status:",X=$$SETSTR^VALM1(XX,X,46,12)
"RTN","EASEZL1",60,0)
 S X=$$SETSTR^VALM1(H,X,59,21)
"RTN","EASEZL1",61,0)
 S VALMHDR(1)=X
"RTN","EASEZL1",62,0)
 S X="Applicant:",X=$$SETSTR^VALM1(X,"",1,14)
"RTN","EASEZL1",63,0)
 S X=$$SETSTR^VALM1(JNAME,X,16,28)
"RTN","EASEZL1",64,0)
 S XX="Date Rec'd:",X=$$SETSTR^VALM1(XX,X,46,12)
"RTN","EASEZL1",65,0)
 S X=$$SETSTR^VALM1(EDATE,X,59,21)
"RTN","EASEZL1",66,0)
 S VALMHDR(2)=X
"RTN","EASEZL1",67,0)
 S X="Web ID #:",X=$$SETSTR^VALM1(X,"",1,14)
"RTN","EASEZL1",68,0)
 S X=$$SETSTR^VALM1(WEBID,X,16,28)
"RTN","EASEZL1",69,0)
 S XX="Vet Sending Signed Form?: "_WILLSEND,X=$$SETSTR^VALM1(XX,X,46,30)
"RTN","EASEZL1",70,0)
 S VALMHDR(3)=X
"RTN","EASEZL1",71,0)
 Q
"RTN","EASEZL1",72,0)
 ;
"RTN","EASEZL1",73,0)
BLD2 ;
"RTN","EASEZL1",74,0)
 N S,C,IT,JJ,ACCEPT,MULTIPLE,OLDM,QUES,Q1,QX,KEYIEN,DISPNM,EZDATA,PTDATA,X,FARRAY,WARRAY,WOUT,DA,DR,DIC,DIQ,X,Y
"RTN","EASEZL1",75,0)
 D CLEAR^VALM1
"RTN","EASEZL1",76,0)
 K ^TMP("EASEXPSRT",$J),^TMP("EASEXPIDX",$J)
"RTN","EASEZL1",77,0)
 S VALMBG=1,VALMCNT=0
"RTN","EASEZL1",78,0)
 S IT="" F  S IT=$O(VALMDDF(IT)) Q:IT=""  S X=VALMDDF(IT),EASCOL(IT)=$P(X,U,2),EASWID(IT)=$P(X,U,3)
"RTN","EASEZL1",79,0)
 S EASLN=0,EASNUM=0
"RTN","EASEZL1",80,0)
 ;build ^TMP("EASEXP", array which creates screen listing
"RTN","EASEZL1",81,0)
 S S="" F  S S=$O(^TMP("EZDISP",$J,S)) Q:S=""  D
"RTN","EASEZL1",82,0)
 .S MULTIPLE=0 F  S MULTIPLE=$O(^TMP("EZDISP",$J,S,MULTIPLE)) Q:'MULTIPLE  D
"RTN","EASEZL1",83,0)
 ..S Q1="" F  S Q1=$O(^TMP("EZDISP",$J,S,MULTIPLE,Q1)) Q:Q1=""  S QX="" F  S QX=$O(^TMP("EZDISP",$J,S,MULTIPLE,Q1,QX)) Q:QX=""  D
"RTN","EASEZL1",84,0)
 ...S X=^TMP("EZDISP",$J,S,MULTIPLE,Q1,QX)
"RTN","EASEZL1",85,0)
 ...S KEYIEN=$P(X,U,1),EZDATA=$P(X,U,2),ACCEPT=$P(X,U,3),SUBIEN=$P(X,U,4),PTDATA=$P(X,U,5),DISPNM=$P(X,U,6)
"RTN","EASEZL1",86,0)
 ...S EASLN=EASLN+1,EASNUM=EASNUM+1
"RTN","EASEZL1",87,0)
 ...S X=$$SETSTR^VALM1(EASLN,"",EASCOL("NUMBER"),EASWID("NUMBER"))
"RTN","EASEZL1",88,0)
 ...S X=$$SETSTR^VALM1(DISPNM,X,EASCOL("DATA ITEM"),EASWID("DATA ITEM"))
"RTN","EASEZL1",89,0)
 ...;S X=$$SETSTR^VALM1(ACCEPT,X,EASCOL("ACCEPT"),EASWID("ACCEPT"))
"RTN","EASEZL1",90,0)
 ...S X=$$SETSTR^VALM1(EZDATA,X,EASCOL("EZDATA"),EASWID("EZDATA"))
"RTN","EASEZL1",91,0)
 ...S X=$$SETSTR^VALM1(PTDATA,X,EASCOL("PTDATA"),EASWID("PTDATA"))
"RTN","EASEZL1",92,0)
 ...D SET^VALM10(EASLN,X)
"RTN","EASEZL1",93,0)
 ...I ACCEPT>0 D FLDCTRL^VALM10(EASLN,"EZDATA",IORVON,IORVOFF)
"RTN","EASEZL1",94,0)
 ...S ^TMP("EASEXP",$J,"IDX",EASLN)=SUBIEN_U_MULTIPLE_U_KEYIEN
"RTN","EASEZL1",95,0)
 ;add info from Section of 1010EZ
"RTN","EASEZL1",96,0)
 K FARRAY
"RTN","EASEZL1",97,0)
 S DA=EASAPP,DIC="^EAS(712,",DR="4.3;4.4;12",DIQ="FARRAY",DIQ(0)="E"
"RTN","EASEZL1",98,0)
 D EN^DIQ1
"RTN","EASEZL1",99,0)
 S DR=13,DIQ="WARRAY"
"RTN","EASEZL1",100,0)
 D EN^DIQ1
"RTN","EASEZL1",101,0)
 ;
"RTN","EASEZL1",102,0)
 S EASLN=EASLN+1
"RTN","EASEZL1",103,0)
 S X=$$SETSTR^VALM1("  ","",1,2) D SET^VALM10(EASLN,X)
"RTN","EASEZL1",104,0)
 S EASLN=EASLN+1
"RTN","EASEZL1",105,0)
 S X=$$SETSTR^VALM1("  ","",1,2) D SET^VALM10(EASLN,X)
"RTN","EASEZL1",106,0)
 S EASLN=EASLN+1
"RTN","EASEZL1",107,0)
 S X=$$SETSTR^VALM1("Appointment Requested: ","",1,24),X=$$SETSTR^VALM1($G(FARRAY(712,EASAPP,4.4,"E")),X,25,30)
"RTN","EASEZL1",108,0)
 D SET^VALM10(EASLN,X)
"RTN","EASEZL1",109,0)
 ;
"RTN","EASEZL1",110,0)
 S EASLN=EASLN+1
"RTN","EASEZL1",111,0)
 S X=$$SETSTR^VALM1("  ","",1,2) D SET^VALM10(EASLN,X)
"RTN","EASEZL1",112,0)
 S EASLN=EASLN+1
"RTN","EASEZL1",113,0)
 S X=$$SETSTR^VALM1("Services Requested: ","",1,24) D SET^VALM10(EASLN,X)
"RTN","EASEZL1",114,0)
 S EASLN=EASLN+1
"RTN","EASEZL1",115,0)
 S X=$$SETSTR^VALM1($G(FARRAY(712,EASAPP,12,"E")),"",3,78) D SET^VALM10(EASLN,X)
"RTN","EASEZL1",116,0)
 ;
"RTN","EASEZL1",117,0)
 S EASLN=EASLN+1
"RTN","EASEZL1",118,0)
 S X=$$SETSTR^VALM1("  ","",1,2) D SET^VALM10(EASLN,X)
"RTN","EASEZL1",119,0)
 S EASLN=EASLN+1
"RTN","EASEZL1",120,0)
 S X=$$SETSTR^VALM1("Comments: ","",1,12) D SET^VALM10(EASLN,X)
"RTN","EASEZL1",121,0)
 I $D(WARRAY)>1 S WOUT=0,JJ=0 F  D  Q:WOUT
"RTN","EASEZL1",122,0)
 .S JJ=JJ+1,C=$G(WARRAY(712,EASAPP,13,JJ))
"RTN","EASEZL1",123,0)
 .I C="" S WOUT=1 Q
"RTN","EASEZL1",124,0)
 .S EASLN=EASLN+1
"RTN","EASEZL1",125,0)
 .S X=$$SETSTR^VALM1(C,"",3,78) D SET^VALM10(EASLN,X)
"RTN","EASEZL1",126,0)
 ;
"RTN","EASEZL1",127,0)
 S EASLN=EASLN+1
"RTN","EASEZL1",128,0)
 S X=$$SETSTR^VALM1("  ","",1,2) D SET^VALM10(EASLN,X)
"RTN","EASEZL1",129,0)
 S EASLN=EASLN+1
"RTN","EASEZL1",130,0)
 S X=$$SETSTR^VALM1("E-mail: ","",1,9),X=$$SETSTR^VALM1($G(FARRAY(712,EASAPP,4.3,"E")),X,10,60)
"RTN","EASEZL1",131,0)
 D SET^VALM10(EASLN,X)
"RTN","EASEZL1",132,0)
 ;
"RTN","EASEZL1",133,0)
 S VALMCNT=EASLN,$P(^TMP("EASEXP",$J,0),U,4)=VALMCNT
"RTN","EASEZL1",134,0)
 Q
"RTN","EASEZL1",135,0)
 ;
"RTN","EASEZL1",136,0)
EXIT2 ;
"RTN","EASEZL1",137,0)
 D CLEAN^VALM10
"RTN","EASEZL1",138,0)
 L -^EAS(712,EASAPP,0)
"RTN","EASEZL1",139,0)
 K ^TMP("EASEXP",$J),^TMP("EASEZPSRT",$J),^TMP("EASEZPIDX",$J)
"RTN","EASEZL1",140,0)
 K ^TMP("EZDATA",$J),^TMP("EZINDEX",$J),^TMP("EZTEMP",$J),^TMP("EZDISP",$J)
"RTN","EASEZL1",141,0)
 Q
"RTN","EASEZL2")
0^10^B37367125
"RTN","EASEZL2",1,0)
EASEZL2 ;ALB/jap - 1010EZ List Manager Processing Screens (cont.) ;12/12/00  13:07
"RTN","EASEZL2",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZL2",3,0)
 ;
"RTN","EASEZL2",4,0)
HELP2 ;Help code
"RTN","EASEZL2",5,0)
 I $D(X),X'["??" D  S VALMBCK="R" Q
"RTN","EASEZL2",6,0)
 .D CLEAR^VALM1
"RTN","EASEZL2",7,0)
 .W !!,?2,"Only two actions allow a list line number indentifier --",!
"RTN","EASEZL2",8,0)
 .W !,?6,IOINHI,"AF Accept Field",IOINORM," -->",?22,"Enter ",IORVON,"AF=n",IORVOFF," to act on the field shown in line #n."
"RTN","EASEZL2",9,0)
 .W !,?6,IOINHI,"UF Update Field",IOINORM," -->",?22,"Enter ",IORVON,"UF=n",IORVOFF," to act on the field shown in line #n."
"RTN","EASEZL2",10,0)
 .W !!,?2,"All other actions act on the Application as a whole,"
"RTN","EASEZL2",11,0)
 .W !,?2,"so a line number is not used."
"RTN","EASEZL2",12,0)
 .W !!,?2,"Actions ",IOINHI,"Verify Signature",IOINORM,", ",IOINHI,"File 10-10EZ",IOINORM,", and ",IOINHI,"Inactivate",IOINORM
"RTN","EASEZL2",13,0)
 .W !,?2,"can be used only once per Application."
"RTN","EASEZL2",14,0)
 .D PAUSE^VALM1
"RTN","EASEZL2",15,0)
 D CLEAR^VALM1
"RTN","EASEZL2",16,0)
 I EASPSTAT="NEW" D  S VALMBCK="R" Q
"RTN","EASEZL2",17,0)
 .W !!,"Allowed actions for NEW Applications are:",!
"RTN","EASEZL2",18,0)
 .D HLZ
"RTN","EASEZL2",19,0)
 .D HIZ
"RTN","EASEZL2",20,0)
 .D PAUSE^VALM1
"RTN","EASEZL2",21,0)
 I EASPSTAT="REV" D  S VALMBCK="R" Q
"RTN","EASEZL2",22,0)
 .W !!,"Allowed actions for IN REVIEW Applications are:",!
"RTN","EASEZL2",23,0)
 .D HAF
"RTN","EASEZL2",24,0)
 .D HAZ
"RTN","EASEZL2",25,0)
 .D HUF
"RTN","EASEZL2",26,0)
 .D PAUSE^VALM1 Q:X="^"  D CLEAR^VALM1
"RTN","EASEZL2",27,0)
 .D HCZ
"RTN","EASEZL2",28,0)
 .D HRZ
"RTN","EASEZL2",29,0)
 .D HPZ
"RTN","EASEZL2",30,0)
 .D PAUSE^VALM1 Q:X="^"  D CLEAR^VALM1
"RTN","EASEZL2",31,0)
 .D HVZ
"RTN","EASEZL2",32,0)
 .D HIZ
"RTN","EASEZL2",33,0)
 .D PAUSE^VALM1
"RTN","EASEZL2",34,0)
 I EASPSTAT="PRT" D  S VALMBCK="R" Q
"RTN","EASEZL2",35,0)
 .W !!,"Allowed actions for PENDING SIGNATURE Applications are:",!
"RTN","EASEZL2",36,0)
 .D HRZ
"RTN","EASEZL2",37,0)
 .D HPZ
"RTN","EASEZL2",38,0)
 .D PAUSE^VALM1 Q:X="^"  D CLEAR^VALM1
"RTN","EASEZL2",39,0)
 .D HVZ
"RTN","EASEZL2",40,0)
 .D HIZ
"RTN","EASEZL2",41,0)
 .D PAUSE^VALM1
"RTN","EASEZL2",42,0)
 I EASPSTAT="SIG" D  S VALMBCK="R" Q
"RTN","EASEZL2",43,0)
 .W !!,"Allowed actions for SIGNED Applications are:",!
"RTN","EASEZL2",44,0)
 .D HUF
"RTN","EASEZL2",45,0)
 .D HPZ
"RTN","EASEZL2",46,0)
 .D PAUSE^VALM1 Q:X="^"  D CLEAR^VALM1
"RTN","EASEZL2",47,0)
 .D HFZ
"RTN","EASEZL2",48,0)
 .D PAUSE^VALM1
"RTN","EASEZL2",49,0)
 I EASPSTAT="FIL" D  S VALMBCK="R" Q
"RTN","EASEZL2",50,0)
 .W !!,"Allowed actions for FILED Applications are:",!
"RTN","EASEZL2",51,0)
 .D HPZ
"RTN","EASEZL2",52,0)
 .D PAUSE^VALM1
"RTN","EASEZL2",53,0)
 I EASPSTAT="CLS" D  S VALMBCK="R" Q
"RTN","EASEZL2",54,0)
 .W !!,"There are no allowed actions for an INACTIVATED Application.",!
"RTN","EASEZL2",55,0)
 .D PAUSE^VALM1
"RTN","EASEZL2",56,0)
 Q
"RTN","EASEZL2",57,0)
 ;
"RTN","EASEZL2",58,0)
HLZ ;
"RTN","EASEZL2",59,0)
 W !!,?2,IOINHI,"LZ  Link to Patient File",IOINORM
"RTN","EASEZL2",60,0)
 W !,?6,"The veteran associated with a NEW Application must be 'linked' to"
"RTN","EASEZL2",61,0)
 W !,?6,"the VistA Patient database."
"RTN","EASEZL2",62,0)
 W !,?6,"VistA Patient Lookup function is employed to match the applicant"
"RTN","EASEZL2",63,0)
 W !,?6,"to an existing Patient OR to establish a new Patient record."
"RTN","EASEZL2",64,0)
 Q
"RTN","EASEZL2",65,0)
 ;
"RTN","EASEZL2",66,0)
HAF ;
"RTN","EASEZL2",67,0)
 W !!,?2,IOINHI,"AF  Accept Field",IOINORM," --> Enter ",IORVON,"AF=n",IORVOFF," to act on the field shown in line #n."
"RTN","EASEZL2",68,0)
 W !,?6,"OR"
"RTN","EASEZL2",69,0)
 W !,?2,IOINHI,"AF  Accept Field",IOINORM," --> Enter ",IORVON,"AF",IORVOFF," to act on multiple fields."
"RTN","EASEZL2",70,0)
 W !,?6,"At the next prompt enter line numbers using '-' and/or ',' --"
"RTN","EASEZL2",71,0)
 W !,"  "
"RTN","EASEZL2",72,0)
 W !,?10,"Select Line Item(s):  (1-12): ",IORVON,"5-9,11",IORVOFF
"RTN","EASEZL2",73,0)
 W !,"  "
"RTN","EASEZL2",74,0)
 W !,?6,"'Accept' means the 10-10EZ data element is 'accepted' for later filing"
"RTN","EASEZL2",75,0)
 W !,?6,"into the VistA Patient database when the File 1010EZ action is performed."
"RTN","EASEZL2",76,0)
 W !,?6,"Using this action on a previously accepted data element, removes the"
"RTN","EASEZL2",77,0)
 W !,?6,"'accepted' indicator."
"RTN","EASEZL2",78,0)
 Q
"RTN","EASEZL2",79,0)
 ;
"RTN","EASEZL2",80,0)
HAZ ;
"RTN","EASEZL2",81,0)
 W !!,?2,IOINHI,"AZ  Accept All",IOINORM
"RTN","EASEZL2",82,0)
 W !,?6,"All 10-10EZ data element are 'accepted' for later filing into"
"RTN","EASEZL2",83,0)
 W !,?6,"the VistA Patient database."
"RTN","EASEZL2",84,0)
 Q
"RTN","EASEZL2",85,0)
 ;
"RTN","EASEZL2",86,0)
HCZ ;
"RTN","EASEZL2",87,0)
 W !!,?2,IOINHI,"CZ  Clear All",IOINORM
"RTN","EASEZL2",88,0)
 W !,?6,"The 'accepted' indicator is removed from any fields previously"
"RTN","EASEZL2",89,0)
 W !,?6,"'accepted'."
"RTN","EASEZL2",90,0)
 Q
"RTN","EASEZL2",91,0)
 ;
"RTN","EASEZL2",92,0)
HRZ ;
"RTN","EASEZL2",93,0)
 W !!,?2,IOINHI,"RZ  Reset to New",IOINORM
"RTN","EASEZL2",94,0)
 W !,?6,"The Application is returned to the 'New' processing status."
"RTN","EASEZL2",95,0)
 W !,?6,"It can be re-matched to the VistA database."
"RTN","EASEZL2",96,0)
 Q
"RTN","EASEZL2",97,0)
 ;
"RTN","EASEZL2",98,0)
HIZ ;
"RTN","EASEZL2",99,0)
 W !!,?2,IOINHI,"IZ  Inactivate 1010EZ",IOINORM
"RTN","EASEZL2",100,0)
 W !,?6,"Once the Application is inactivated, it will no longer be available"
"RTN","EASEZL2",101,0)
 W !,?6,"for processing."
"RTN","EASEZL2",102,0)
 W !,?6,"Use this action only if the Application is deemed invalid or is being"
"RTN","EASEZL2",103,0)
 W !,?6,"replaced by a new Application."
"RTN","EASEZL2",104,0)
 Q
"RTN","EASEZL2",105,0)
 ;
"RTN","EASEZL2",106,0)
HPZ ;
"RTN","EASEZL2",107,0)
 W !!,?2,IOINHI,"PZ  Print 1010EZ",IOINORM
"RTN","EASEZL2",108,0)
 W !,?6,"Once the 10-10EZ is Printed, actions of Accept Field, Accept All,"
"RTN","EASEZL2",109,0)
 W !,?6,"Clear All, and Update Field can no longer be used."
"RTN","EASEZL2",110,0)
 W !,?6,"The 10-10EZ form is printed using all 'accepted' data. "
"RTN","EASEZL2",111,0)
 W !,?6,"VistA Patient data is used for any fields not 'accepted'."
"RTN","EASEZL2",112,0)
 W !,?6,"Printing must be queued to a valid print device."
"RTN","EASEZL2",113,0)
 Q
"RTN","EASEZL2",114,0)
 ;
"RTN","EASEZL2",115,0)
HVZ ;
"RTN","EASEZL2",116,0)
 W !!,?2,IOINHI,"VZ  Verify Signature",IOINORM
"RTN","EASEZL2",117,0)
 W !,?6,"The user verifies that the Applicant's signature appears on a"
"RTN","EASEZL2",118,0)
 W !,?6,"printed 10-10EZ."
"RTN","EASEZL2",119,0)
 Q
"RTN","EASEZL2",120,0)
 ;
"RTN","EASEZL2",121,0)
HUF ;
"RTN","EASEZL2",122,0)
 W !!,?2,IOINHI,"UF  Update Field",IOINORM," --> Enter ",IORVON,"UF=n",IORVOFF," to act on the field shown in line #n."
"RTN","EASEZL2",123,0)
 W !,?6,"Only one line number can be selected within the Update Field action."
"RTN","EASEZL2",124,0)
 W !,?6,"The 10-10EZ data element on line #n can be overwritten by the user for"
"RTN","EASEZL2",125,0)
 W !,?6,"later filing into VistA."
"RTN","EASEZL2",126,0)
 W !,?6,"This action should be used to enter the Applicant's hand-written"
"RTN","EASEZL2",127,0)
 W !,?6,"changes to the signed 10-10EZ."
"RTN","EASEZL2",128,0)
 Q
"RTN","EASEZL2",129,0)
 ;
"RTN","EASEZL2",130,0)
HFZ ;
"RTN","EASEZL2",131,0)
 W !!,?2,IOINHI,"FZ  File 1010EZ",IOINORM
"RTN","EASEZL2",132,0)
 W !,?6,"All 'accepted' data elements on the 10-10EZ are filed to the"
"RTN","EASEZL2",133,0)
 W !,?6,"VistA Patient database."
"RTN","EASEZL2",134,0)
 W !,?6,"Use this action with caution -- 10-10EZ data elements will overwrite"
"RTN","EASEZL2",135,0)
 W !,?6,"any existing data in Vista."
"RTN","EASEZL2",136,0)
 Q
"RTN","EASEZLM")
0^11^B45274136
"RTN","EASEZLM",1,0)
EASEZLM ;ALB/jap - 1010EZ List Manager Processing Screens ;10/12/00  13:07
"RTN","EASEZLM",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZLM",3,0)
 ;
"RTN","EASEZLM",4,0)
EN ;Main entry point for 1010EZ processing
"RTN","EASEZLM",5,0)
 ;Ask user to select processing status
"RTN","EASEZLM",6,0)
 W @IOF
"RTN","EASEZLM",7,0)
 W !!,"10-10EZ Application Processing --",!
"RTN","EASEZLM",8,0)
 K DIR,DTOUT,DUOUT,DIRUT,Y
"RTN","EASEZLM",9,0)
 S DIR(0)="SMO^1:New;2:In Review;3:Printed, Pending Signature;4:Signed;5:Filed;6:Inactivated"
"RTN","EASEZLM",10,0)
 S DIR("A")="Select Applications to View"
"RTN","EASEZLM",11,0)
 ;interface to Help Frames
"RTN","EASEZLM",12,0)
 S DIR("??")="EAS EZ OPTION PROCESS"
"RTN","EASEZLM",13,0)
 D ^DIR K DIR
"RTN","EASEZLM",14,0)
 I $D(DIRUT) K DIR,DTOUT,DUOUT,DIRUT,Y  Q
"RTN","EASEZLM",15,0)
 ;
"RTN","EASEZLM",16,0)
 S EASVIEW=0
"RTN","EASEZLM",17,0)
 I Y,"^1^2^3^4^5^6^"[(U_Y_U) S EASVIEW=Y
"RTN","EASEZLM",18,0)
 Q:'EASVIEW
"RTN","EASEZLM",19,0)
 S EASPSTAT=""
"RTN","EASEZLM",20,0)
 D EN^EASEZL1
"RTN","EASEZLM",21,0)
 K EASVIEW G EN
"RTN","EASEZLM",22,0)
 Q
"RTN","EASEZLM",23,0)
 ;
"RTN","EASEZLM",24,0)
HDR ;Header code
"RTN","EASEZLM",25,0)
 N H
"RTN","EASEZLM",26,0)
 S VALMHDR(1)=" "
"RTN","EASEZLM",27,0)
 ;Processing - primary view
"RTN","EASEZLM",28,0)
 N HDR
"RTN","EASEZLM",29,0)
 S HDR=""
"RTN","EASEZLM",30,0)
 S H=$S(EASVIEW=1:"NEW",EASVIEW=2:"IN REVIEW",EASVIEW=3:"PRINTED, PENDING SIG.",EASVIEW=4:"SIGNED",EASVIEW=5:"FILED",EASVIEW=6:"INACTIVATED",1:"")
"RTN","EASEZLM",31,0)
 S HDR=HDR_H
"RTN","EASEZLM",32,0)
 S VALMHDR(2)="Application Status: "_$S(HDR="":"Unknown",1:HDR)
"RTN","EASEZLM",33,0)
 S VALMHDR(3)=" "
"RTN","EASEZLM",34,0)
 Q
"RTN","EASEZLM",35,0)
 ;
"RTN","EASEZLM",36,0)
INIT ;Init variables and list array
"RTN","EASEZLM",37,0)
 ;
"RTN","EASEZLM",38,0)
 S VALMSG=$$MSG^EASEZLM
"RTN","EASEZLM",39,0)
 S EASARY="EASEZ"
"RTN","EASEZLM",40,0)
 K ^TMP("EASEZ",$J),^TMP($J,712),^TMP("EASEZIDX",$J)
"RTN","EASEZLM",41,0)
 ;determine processing status
"RTN","EASEZLM",42,0)
 ;I EASPSTAT="" S V=EASVIEW,EASPSTAT=$S(V=1:"NEW",V=2:"REV",V=3:"PRT",V=4:"SIG",V=5:"CLS",1:"") K V
"RTN","EASEZLM",43,0)
 I EASPSTAT="" S V=EASVIEW,EASPSTAT=$S(V=1:"NEW",V=2:"REV",V=3:"PRT",V=4:"SIG",V=5:"FIL",V=6:"CLS",1:"") K V
"RTN","EASEZLM",44,0)
 I EASPSTAT="" S VALMCNT=0 D NOLINES^EASEZLM
"RTN","EASEZLM",45,0)
 I EASVIEW,EASPSTAT'="" D BLD
"RTN","EASEZLM",46,0)
 ;Print message if no Applications meet selection criteria
"RTN","EASEZLM",47,0)
 I 'VALMCNT D NOLINES^EASEZLM
"RTN","EASEZLM",48,0)
 Q
"RTN","EASEZLM",49,0)
 ;
"RTN","EASEZLM",50,0)
BLD ;Build initial EZ selection screen
"RTN","EASEZLM",51,0)
 N V,JDATE,JNAME,DAT,FILDATE,WEBID,WILLSEND,VETTYPE,FAC,APP,SSN,DOB,EDATE,IT,PRT,STATION
"RTN","EASEZLM",52,0)
 K ^TMP("EASEZ",$J)
"RTN","EASEZLM",53,0)
 S VALMBG=1,VALMCNT=0
"RTN","EASEZLM",54,0)
 S IT="" F  S IT=$O(VALMDDF(IT)) Q:IT=""  S X=VALMDDF(IT),EASCOL(IT)=$P(X,U,2),EASWID(IT)=$P(X,U,3)
"RTN","EASEZLM",55,0)
 S EASLN=0,EASNUM=0
"RTN","EASEZLM",56,0)
 I 'EASVIEW S VALMCNT=0,$P(^TMP("EASEZ",$J,0),U,4)=VALMCNT Q
"RTN","EASEZLM",57,0)
 W !!,"Please wait while processing...",!!
"RTN","EASEZLM",58,0)
 ;call to find all Applications needed for main LM screen
"RTN","EASEZLM",59,0)
 D PICKALL^EASEZU2(EASVIEW)
"RTN","EASEZLM",60,0)
 ;
"RTN","EASEZLM",61,0)
 S FAC="" F  S FAC=$O(^TMP($J,712,EASVIEW,FAC)) Q:FAC=""  S JNAME="" F  S JNAME=$O(^TMP($J,712,EASVIEW,FAC,JNAME)) Q:JNAME=""  D
"RTN","EASEZLM",62,0)
 .S JDATE=0  F  S JDATE=$O(^TMP($J,712,EASVIEW,FAC,JNAME,JDATE)) Q:'JDATE  S APP=0 F  S APP=$O(^TMP($J,712,EASVIEW,FAC,JNAME,JDATE,APP)) Q:'APP  D
"RTN","EASEZLM",63,0)
 ..S DAT=^TMP($J,712,EASVIEW,FAC,JNAME,JDATE,APP)
"RTN","EASEZLM",64,0)
 ..;reset processing status if application has filing date
"RTN","EASEZLM",65,0)
 ..;I EASVIEW=4 S FILDATE=$P(DAT,U,5)
"RTN","EASEZLM",66,0)
 ..S SSN=$P(DAT,U,2),VETTYPE=$P(DAT,U,3),EDATE=$P(DAT,U,4),WEBID=$P(DAT,U,6),WILLSEND=$P(DAT,U,7),FAC=$P(DAT,U,8)
"RTN","EASEZLM",67,0)
 ..S PRT=$S(WILLSEND:"Vet",1:"VA")
"RTN","EASEZLM",68,0)
 ..S STATION=FAC S:STATION=1 STATION=""
"RTN","EASEZLM",69,0)
 ..S EASLN=EASLN+1,EASNUM=EASNUM+1
"RTN","EASEZLM",70,0)
 ..S X=$$SETSTR^VALM1(EASLN,"",EASCOL("NUMBER"),EASWID("NUMBER"))
"RTN","EASEZLM",71,0)
 ..S X=$$SETSTR^VALM1(JNAME,X,EASCOL("APPLICANT"),EASWID("APPLICANT"))
"RTN","EASEZLM",72,0)
 ..S X=$$SETSTR^VALM1(SSN,X,EASCOL("SSN"),EASWID("SSN"))
"RTN","EASEZLM",73,0)
 ..S X=$$SETSTR^VALM1(VETTYPE,X,EASCOL("TYPE"),EASWID("TYPE"))
"RTN","EASEZLM",74,0)
 ..S X=$$SETSTR^VALM1(EDATE,X,EASCOL("DATE"),EASWID("DATE"))
"RTN","EASEZLM",75,0)
 ..S X=$$SETSTR^VALM1(" "_PRT,X,EASCOL("PRINTED"),EASWID("PRINTED"))
"RTN","EASEZLM",76,0)
 ..S X=$$SETSTR^VALM1(STATION,X,EASCOL("STATION"),EASWID("STATION"))
"RTN","EASEZLM",77,0)
 ..S X=$$SETSTR^VALM1(APP,X,EASCOL("APPNUM"),EASWID("APPNUM"))
"RTN","EASEZLM",78,0)
 ..S ^TMP("EASEZ",$J,EASLN,0)=X
"RTN","EASEZLM",79,0)
 ..S ^TMP("EASEZ",$J,"IDX",EASLN,APP)=JNAME_U_EDATE
"RTN","EASEZLM",80,0)
 ..;I EASVIEW=4,'FILDATE D
"RTN","EASEZLM",81,0)
 ..;.S $P(^TMP("EASEZ",$J,"IDX",EASLN,APP),U,3)=1
"RTN","EASEZLM",82,0)
 ..;.D FLDCTRL^VALM10(EASLN,"APPLICANT",IOINHI,IOINORM)
"RTN","EASEZLM",83,0)
 ..;.D FLDCTRL^VALM10(EASLN,"APPNUM",IOINHI,IOINORM)
"RTN","EASEZLM",84,0)
 ..S ^TMP("EASEZIDX",$J,APP)=JNAME_U_EDATE_U_WEBID_U_WILLSEND_U_STATION
"RTN","EASEZLM",85,0)
 S VALMCNT=EASNUM
"RTN","EASEZLM",86,0)
 S $P(^TMP("EASEZ",$J,0),U,4)=VALMCNT
"RTN","EASEZLM",87,0)
 Q
"RTN","EASEZLM",88,0)
 ;
"RTN","EASEZLM",89,0)
MSG() ;Custom message for list manager 'message window'
"RTN","EASEZLM",90,0)
 ;
"RTN","EASEZLM",91,0)
 I EASVIEW=4 Q "Applications not yet filed to the Patient database."
"RTN","EASEZLM",92,0)
 Q "Select an Application to view."
"RTN","EASEZLM",93,0)
 ;
"RTN","EASEZLM",94,0)
HELP ;Help code
"RTN","EASEZLM",95,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","EASEZLM",96,0)
 Q
"RTN","EASEZLM",97,0)
 ;
"RTN","EASEZLM",98,0)
EXIT ;protocol action Exit code
"RTN","EASEZLM",99,0)
 D CLEAN^VALM10
"RTN","EASEZLM",100,0)
 D CLEAR^VALM1
"RTN","EASEZLM",101,0)
 K ^TMP(EASARY_"SRT",$J),^TMP(EASARY_"IDX",$J)
"RTN","EASEZLM",102,0)
 K EASBEG,EASEND,EASDFN,EASEZNEW,EASAPP,EASLOCK,EASLN
"RTN","EASEZLM",103,0)
 Q
"RTN","EASEZLM",104,0)
 ;
"RTN","EASEZLM",105,0)
SEL ;Select item in inital view to expand
"RTN","EASEZLM",106,0)
 N BG,LST,Y,DIR,DTOUT,DUOUT,DIRUT
"RTN","EASEZLM",107,0)
 S BG=VALMBG
"RTN","EASEZLM",108,0)
 S LST=VALMLST
"RTN","EASEZLM",109,0)
 S EASSEL=0,EASERR=0
"RTN","EASEZLM",110,0)
 I 'BG D  Q
"RTN","EASEZLM",111,0)
 .W !!,*7,"There are no '",VALM("ENTITY"),"s' to select.",!
"RTN","EASEZLM",112,0)
 .S EASERR=1
"RTN","EASEZLM",113,0)
 .S DIR(0)="E" D ^DIR K DIR
"RTN","EASEZLM",114,0)
 S Y=+$P($P(XQORNOD(0),U,4),"=",2)
"RTN","EASEZLM",115,0)
 I 'Y D
"RTN","EASEZLM",116,0)
 .S DIR(0)="N^"_BG_":"_LST,DIR("A")="Select "_VALM("ENTITY")_"(s)"
"RTN","EASEZLM",117,0)
 .D ^DIR K DIR I $D(DIRUT) S EASERR=1,EASSEL=0
"RTN","EASEZLM",118,0)
 Q:EASERR
"RTN","EASEZLM",119,0)
 ;
"RTN","EASEZLM",120,0)
 ;check for valid entries
"RTN","EASEZLM",121,0)
 S EASSEL=Y
"RTN","EASEZLM",122,0)
 I EASSEL<BG!(EASSEL>LST) D
"RTN","EASEZLM",123,0)
 .W !,*7,"Selection '",EASSEL,"' is not a valid choice."
"RTN","EASEZLM",124,0)
 .S EASERR=1,EASSEL=0 D PAUSE^VALM1
"RTN","EASEZLM",125,0)
 ;
"RTN","EASEZLM",126,0)
 Q
"RTN","EASEZLM",127,0)
 ;
"RTN","EASEZLM",128,0)
NOLINES ;if array empty, inform user
"RTN","EASEZLM",129,0)
 I $G(EASLOCK)=1 D  Q
"RTN","EASEZLM",130,0)
 .S ^TMP(EASARY,$J,1,0)=$$SETSTR^VALM1(" ","",1,60)
"RTN","EASEZLM",131,0)
 .S ^TMP(EASARY,$J,"IDX",1,1)=""
"RTN","EASEZLM",132,0)
 .S ^TMP(EASARY,$J,2,0)=$$SETSTR^VALM1("No Applications meet the selection criteria. ","",5,60)
"RTN","EASEZLM",133,0)
 .S ^TMP(EASARY,$J,"IDX",2,2)=""
"RTN","EASEZLM",134,0)
 I $G(EASLOCK)=0 D  Q
"RTN","EASEZLM",135,0)
 .S ^TMP(EASARY,$J,1,0)=$$SETSTR^VALM1(" ","",1,60)
"RTN","EASEZLM",136,0)
 .S ^TMP(EASARY,$J,"IDX",1,1)=""
"RTN","EASEZLM",137,0)
 .S ^TMP(EASARY,$J,2,0)=$$SETSTR^VALM1("Application being processed by another user.","",5,60)
"RTN","EASEZLM",138,0)
 .S ^TMP(EASARY,$J,"IDX",2,2)=""
"RTN","EASEZLM",139,0)
 .S ^TMP(EASARY,$J,3,0)=$$SETSTR^VALM1("Try again late.....","",5,60)
"RTN","EASEZLM",140,0)
 .S ^TMP(EASARY,$J,"IDX",3,3)=""
"RTN","EASEZLM",141,0)
 S ^TMP(EASARY,$J,1,0)=$$SETSTR^VALM1(" ","",1,60)
"RTN","EASEZLM",142,0)
 S ^TMP(EASARY,$J,"IDX",1,1)=""
"RTN","EASEZLM",143,0)
 S ^TMP(EASARY,$J,2,0)=$$SETSTR^VALM1("No Applications meet the selection criteria. ","",5,60)
"RTN","EASEZLM",144,0)
 S ^TMP(EASARY,$J,"IDX",2,2)=""
"RTN","EASEZLM",145,0)
 Q
"RTN","EASEZLM",146,0)
 ;
"RTN","EASEZLM",147,0)
FNL ;option (list template) Exit code
"RTN","EASEZLM",148,0)
 D CLEAN^VALM10
"RTN","EASEZLM",149,0)
 D CLEAR^VALM1
"RTN","EASEZLM",150,0)
 K ^TMP($J,712)
"RTN","EASEZLM",151,0)
 K ^TMP("EASEZ",$J),^TMP("EASEZSRT",$J),^TMP("EASEZIDX",$J)
"RTN","EASEZLM",152,0)
 K ^TMP("VALM STACK",$J)
"RTN","EASEZLM",153,0)
 K EASVIEW,EASSEL,EASLN,EASNUM,EASARY,EASCOL,EASWID,EASAPP,EASPSTAT,EASRTR,EASERR
"RTN","EASEZLM",154,0)
 Q
"RTN","EASEZLM",155,0)
 ;
"RTN","EASEZLM",156,0)
NOACT(STAT,ACTION) ;action not allowed
"RTN","EASEZLM",157,0)
 ;
"RTN","EASEZLM",158,0)
 W !!,$C(7),ACTION_" not allowed for this "_STAT_" Application."
"RTN","EASEZLM",159,0)
 S VALMBCK="R"
"RTN","EASEZLM",160,0)
 D PAUSE^VALM1
"RTN","EASEZLM",161,0)
 Q
"RTN","EASEZLM",162,0)
 ;
"RTN","EASEZLM",163,0)
SELRNGE ;Select multiple items from range
"RTN","EASEZLM",164,0)
 N J,JJ,BG,LST,X,Y,DIR,DTOUT,DUOUT,DIRUT
"RTN","EASEZLM",165,0)
 S BG=VALMBG
"RTN","EASEZLM",166,0)
 S LST=VALMLST
"RTN","EASEZLM",167,0)
 K EASSEL S EASSEL=0,EASERR=0
"RTN","EASEZLM",168,0)
 I 'BG D  Q
"RTN","EASEZLM",169,0)
 .W !!,*7,"There are no '",VALM("ENTITY"),"s' to select.",!
"RTN","EASEZLM",170,0)
 .S EASERR=1
"RTN","EASEZLM",171,0)
 .S DIR(0)="E" D ^DIR K DIR
"RTN","EASEZLM",172,0)
 S Y=+$P($P($G(XQORNOD(0)),U,4),"=",2)
"RTN","EASEZLM",173,0)
 I 'Y D
"RTN","EASEZLM",174,0)
 .S DIR(0)="L^"_BG_":"_LST,DIR("A")="Select "_VALM("ENTITY")_"(s)"
"RTN","EASEZLM",175,0)
 .D ^DIR K DIR I $D(DIRUT) S EASERR=1,EASSEL=0
"RTN","EASEZLM",176,0)
 Q:EASERR
"RTN","EASEZLM",177,0)
 ;check for valid entries
"RTN","EASEZLM",178,0)
 S EASSEL=Y I EASSEL=0 S EASERR=1 Q
"RTN","EASEZLM",179,0)
 F J=1:1:99 S X=$P(EASSEL,",",J) Q:'X  S EASSEL(X)=X
"RTN","EASEZLM",180,0)
 S JJ=$O(EASSEL(0)),EASSEL("BG")=JJ,JJ=$O(EASSEL(999999),-1),EASSEL("LST")=JJ
"RTN","EASEZLM",181,0)
 I (EASSEL("BG")<BG)!(EASSEL("LST")>LST)!(EASSEL("LST")="") D
"RTN","EASEZLM",182,0)
 .W !,*7,"Selection '",EASSEL,"' is not a valid range."
"RTN","EASEZLM",183,0)
 .S EASERR=1,EASSEL=0 D PAUSE^VALM1
"RTN","EASEZLM",184,0)
 Q
"RTN","EASEZQ")
0^12^B27971005
"RTN","EASEZQ",1,0)
EASEZQ ;ALB/jap - 1010EZ Quick Lookup ;02/26/2001  13:07
"RTN","EASEZQ",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZQ",3,0)
 ;
"RTN","EASEZQ",4,0)
EN ;Main entry point from 1010EZ menu option
"RTN","EASEZQ",5,0)
 N X,Y,DIC,DA,OUT,DTOUT,DUOUT
"RTN","EASEZQ",6,0)
 ;Ask user to select processing status
"RTN","EASEZQ",7,0)
 W @IOF
"RTN","EASEZQ",8,0)
 W !,"10-10EZ Application Quick Lookup --",!
"RTN","EASEZQ",9,0)
 W !,"At the prompt, you may enter any one of the following:"
"RTN","EASEZQ",10,0)
 W !!,?5,"(1) Application ID"
"RTN","EASEZQ",11,0)
 W !,?5,"    Example: 158"
"RTN","EASEZQ",12,0)
 W !!,?5,"(2) Web Submission ID"
"RTN","EASEZQ",13,0)
 W !,?5,"    Example: 4537-15222-2001"
"RTN","EASEZQ",14,0)
 W !,?5,"             Hyphens must appear just as received from"
"RTN","EASEZQ",15,0)
 W !,?5,"             the On-Line 1010-EZ application."
"RTN","EASEZQ",16,0)
 W !!,?5,"(3) Applicant Name"
"RTN","EASEZQ",17,0)
 W !,?5,"    Examples: SMITH,JOHN R"
"RTN","EASEZQ",18,0)
 W !,?5,"              JONES,D"
"RTN","EASEZQ",19,0)
 W !,?5,"              No space between last and first name."
"RTN","EASEZQ",20,0)
 W !!,?5,"(4) Applicant SSN"
"RTN","EASEZQ",21,0)
 W !,?5,"    Example: ***********"
"RTN","EASEZQ",22,0)
 W !,?5,"             Must be entered as nnn-nn-nnnn."
"RTN","EASEZQ",23,0)
 W !
"RTN","EASEZQ",24,0)
 ;do lookup
"RTN","EASEZQ",25,0)
 S OUT=0 F  D  Q:OUT
"RTN","EASEZQ",26,0)
 .K X,Y
"RTN","EASEZQ",27,0)
 .S DIC=712,DIC(0)="AEQMZ" D ^DIC
"RTN","EASEZQ",28,0)
 .I ($D(DUOUT))!($D(DTOUT))!(Y=-1) S OUT=1 Q
"RTN","EASEZQ",29,0)
 .I Y>0 D DISPLAY K X,Y
"RTN","EASEZQ",30,0)
 D KILL^%ZISS
"RTN","EASEZQ",31,0)
 Q
"RTN","EASEZQ",32,0)
 ;
"RTN","EASEZQ",33,0)
DISPLAY ;display application data
"RTN","EASEZQ",34,0)
 N APPNO,WEBID,APPNM,APPSSN,APPDOB,RECDT,NEWPT,EXPECT,FIDIS,CURR,COMM,ARRAY,DA,DIQ,DIC,DR,XX
"RTN","EASEZQ",35,0)
 S X="IORVON;IORVOFF" D ENDR^%ZISS
"RTN","EASEZQ",36,0)
 W @IOF
"RTN","EASEZQ",37,0)
 I $G(Y(0))'="" D
"RTN","EASEZQ",38,0)
 .S APPNO=$P(Y(0),U,1),WEBID=$P(Y(0),U,2),APPNM=$P(Y(0),U,4)
"RTN","EASEZQ",39,0)
 .S APPSSN=$P($P(Y(0),U,5),"&",1),APPDOB=$P($P(Y(0),U,5),"&",2)
"RTN","EASEZQ",40,0)
 .S X=$P(Y(0),U,11),NEWPT=$S(X=1:"YES",1:"NO")
"RTN","EASEZQ",41,0)
 .S X=$P(Y(0),U,13),EXPECT=$S(X=1:"YES",1:"NO")
"RTN","EASEZQ",42,0)
 .S X=$P(Y(0),U,14),FIDIS=$S(X=1:"YES",1:"NO")
"RTN","EASEZQ",43,0)
 .S Y=$P(Y(0),U,6) D DD^%DT S RECDT=Y
"RTN","EASEZQ",44,0)
 .S DIQ="ARRAY",DIQ(0)="E",DA=+APPNO,DR="3.3;4;4.1;4.3;4.4;4.5;5.1;6.1;7.1;9.1;12",DIC=712 D EN^DIQ1
"RTN","EASEZQ",45,0)
 .S X=$$GET1^DIQ(712,APPNO_",",13,"","COMM")
"RTN","EASEZQ",46,0)
 .S X=$$CURRSTAT^EASEZU2(APPNO)
"RTN","EASEZQ",47,0)
 .S CURR=$S(X="CLS":"INACTIVATED",X="FIL":"FILED",X="SIG":"SIGNED",X="PRT":"PRINTED,PENDING SIG.",X="REV":"IN REVIEW",1:"NEW")
"RTN","EASEZQ",48,0)
 .I CURR="NEW",NEWPT="NO" S NEWPT="unknown"
"RTN","EASEZQ",49,0)
 .;display screen1 of data
"RTN","EASEZQ",50,0)
 .;line1
"RTN","EASEZQ",51,0)
 .S X=""
"RTN","EASEZQ",52,0)
 .S X=$$SETSTR^VALM1("App #: ",X,1,8),X=$$SETSTR^VALM1(APPNO,X,12,6)
"RTN","EASEZQ",53,0)
 .S X=$$SETSTR^VALM1("Web ID: ",X,40,8),X=$$SETSTR^VALM1(WEBID,X,53,20)
"RTN","EASEZQ",54,0)
 .W !,X
"RTN","EASEZQ",55,0)
 .;line2
"RTN","EASEZQ",56,0)
 .S X=""
"RTN","EASEZQ",57,0)
 .S X=$$SETSTR^VALM1("To: ",X,1,7),XX=$G(ARRAY(712,APPNO,4.5,"E")),X=$$SETSTR^VALM1(XX,X,12,8)
"RTN","EASEZQ",58,0)
 .S X=$$SETSTR^VALM1("Date Rec'd: ",X,40,12),X=$$SETSTR^VALM1(RECDT,X,53,18)
"RTN","EASEZQ",59,0)
 .W !,X
"RTN","EASEZQ",60,0)
 .;line3
"RTN","EASEZQ",61,0)
 .S X=""
"RTN","EASEZQ",62,0)
 .S X=$$SETSTR^VALM1("Status: ",X,1,8),X=$$SETSTR^VALM1(IORVON_CURR_IORVOFF,X,12,30)
"RTN","EASEZQ",63,0)
 .W !,X
"RTN","EASEZQ",64,0)
 .;line4
"RTN","EASEZQ",65,0)
 .S X=""
"RTN","EASEZQ",66,0)
 .S X=$$SETSTR^VALM1("Applicant: ",X,1,11),X=$$SETSTR^VALM1(APPNM,X,12,26)
"RTN","EASEZQ",67,0)
 .S X=$$SETSTR^VALM1("SSN: ",X,40,5),X=$$SETSTR^VALM1(APPSSN,X,45,11)
"RTN","EASEZQ",68,0)
 .S X=$$SETSTR^VALM1("DOB: ",X,61,5),X=$$SETSTR^VALM1(APPDOB,X,66,14)
"RTN","EASEZQ",69,0)
 .W !,X
"RTN","EASEZQ",70,0)
 .W !
"RTN","EASEZQ",71,0)
 .;line5
"RTN","EASEZQ",72,0)
 .S X=""
"RTN","EASEZQ",73,0)
 .S X=$$SETSTR^VALM1("Vet Type: ",X,1,11),XX=$G(ARRAY(712,APPNO,3.3,"E")),X=$$SETSTR^VALM1(XX,X,12,10)
"RTN","EASEZQ",74,0)
 .S X=$$SETSTR^VALM1("Veteran new to Vista?:",X,40,26),X=$$SETSTR^VALM1(NEWPT,X,68,7)
"RTN","EASEZQ",75,0)
 .W !,X
"RTN","EASEZQ",76,0)
 .;line6
"RTN","EASEZQ",77,0)
 .S X=""
"RTN","EASEZQ",78,0)
 .S X=$$SETSTR^VALM1("Financial Disclosure: ",X,1,22),X=$$SETSTR^VALM1(FIDIS,X,23,4)
"RTN","EASEZQ",79,0)
 .S X=$$SETSTR^VALM1("Expect copy from veteran?:",X,40,26),X=$$SETSTR^VALM1(EXPECT,X,68,4)
"RTN","EASEZQ",80,0)
 .W !,X
"RTN","EASEZQ",81,0)
 .W !
"RTN","EASEZQ",82,0)
 .;line7
"RTN","EASEZQ",83,0)
 .S X=""
"RTN","EASEZQ",84,0)
 .S X=$$SETSTR^VALM1("Review start date: ",X,1,20),XX=$G(ARRAY(712,APPNO,5.1,"E")),X=$$SETSTR^VALM1(XX,X,23,14)
"RTN","EASEZQ",85,0)
 .S X=$$SETSTR^VALM1("Print date: ",X,40,13),XX=$G(ARRAY(712,APPNO,6.1,"E")),X=$$SETSTR^VALM1(XX,X,53,14)
"RTN","EASEZQ",86,0)
 .W !,X
"RTN","EASEZQ",87,0)
 .;line8
"RTN","EASEZQ",88,0)
 .S X=""
"RTN","EASEZQ",89,0)
 .S X=$$SETSTR^VALM1("Sign date: ",X,1,20),XX=$G(ARRAY(712,APPNO,4.1,"E")),X=$$SETSTR^VALM1(XX,X,23,14)
"RTN","EASEZQ",90,0)
 .S X=$$SETSTR^VALM1("File date: ",X,40,13),XX=$G(ARRAY(712,APPNO,7.1,"E")),X=$$SETSTR^VALM1(XX,X,53,14)
"RTN","EASEZQ",91,0)
 .W !,X
"RTN","EASEZQ",92,0)
 .;line9
"RTN","EASEZQ",93,0)
 .S X=""
"RTN","EASEZQ",94,0)
 .S X=$$SETSTR^VALM1("Inactivate date: ",X,1,20),XX=$G(ARRAY(712,APPNO,9.1,"E")),X=$$SETSTR^VALM1(XX,X,23,14)
"RTN","EASEZQ",95,0)
 .W !,X
"RTN","EASEZQ",96,0)
 .W !
"RTN","EASEZQ",97,0)
 .;line10
"RTN","EASEZQ",98,0)
 .S X=""
"RTN","EASEZQ",99,0)
 .S X=$$SETSTR^VALM1("Services Requested: ",X,1,20),XX=$G(ARRAY(712,APPNO,12,"E")),X=$$SETSTR^VALM1(XX,X,21,78)
"RTN","EASEZQ",100,0)
 .W !,X
"RTN","EASEZQ",101,0)
 .;line11
"RTN","EASEZQ",102,0)
 .S X=""
"RTN","EASEZQ",103,0)
 .S X=$$SETSTR^VALM1("Appt. Requested: ",X,1,20),XX=$G(ARRAY(712,APPNO,4.4,"E")),X=$$SETSTR^VALM1(XX,X,21,78)
"RTN","EASEZQ",104,0)
 .W !,X
"RTN","EASEZQ",105,0)
 .;line12
"RTN","EASEZQ",106,0)
 .S X=""
"RTN","EASEZQ",107,0)
 .S X=$$SETSTR^VALM1("e-mail Address: ",X,1,20),XX=$G(ARRAY(712,APPNO,4.3,"E")),X=$$SETSTR^VALM1(XX,X,21,78)
"RTN","EASEZQ",108,0)
 .W !,X
"RTN","EASEZQ",109,0)
 .;end of screen1
"RTN","EASEZQ",110,0)
 .K DIR D PAUSE^VALM1
"RTN","EASEZQ",111,0)
 .Q:X="^"
"RTN","EASEZQ",112,0)
 .;display screen2 of data
"RTN","EASEZQ",113,0)
 .W @IOF
"RTN","EASEZQ",114,0)
 .;line1
"RTN","EASEZQ",115,0)
 .S X=""
"RTN","EASEZQ",116,0)
 .S X=$$SETSTR^VALM1("App #: ",X,1,8),X=$$SETSTR^VALM1(APPNO,X,9,6)
"RTN","EASEZQ",117,0)
 .S X=$$SETSTR^VALM1("Web ID: ",X,40,8),X=$$SETSTR^VALM1(WEBID,X,53,20)
"RTN","EASEZQ",118,0)
 .W !,X
"RTN","EASEZQ",119,0)
 .;line2
"RTN","EASEZQ",120,0)
 .S X=""
"RTN","EASEZQ",121,0)
 .S X=$$SETSTR^VALM1("Status: ",X,1,8),X=$$SETSTR^VALM1(IORVON_CURR_IORVOFF,X,9,30)
"RTN","EASEZQ",122,0)
 .W !,X
"RTN","EASEZQ",123,0)
 .;line3
"RTN","EASEZQ",124,0)
 .S X=""
"RTN","EASEZQ",125,0)
 .S X=$$SETSTR^VALM1("Applicant: ",X,1,11),X=$$SETSTR^VALM1(APPNM,X,12,26)
"RTN","EASEZQ",126,0)
 .W !,X
"RTN","EASEZQ",127,0)
 .W !
"RTN","EASEZQ",128,0)
 .;comments
"RTN","EASEZQ",129,0)
 .W !,"Comments --"
"RTN","EASEZQ",130,0)
 .S I=0 F  S I=$O(COMM(I)) Q:'I  D
"RTN","EASEZQ",131,0)
 ..W !,?3,COMM(I)
"RTN","EASEZQ",132,0)
 ..W !
"RTN","EASEZQ",133,0)
 .K DIR D PAUSE^VALM1
"RTN","EASEZQ",134,0)
 Q
"RTN","EASEZU3")
0^13^B62230482
"RTN","EASEZU3",1,0)
EASEZU3 ;ALB/jap - Utilities for 1010EZ Processing ;10/12/00  13:08
"RTN","EASEZU3",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM**1**;Mar 15, 2001
"RTN","EASEZU3",3,0)
 ;
"RTN","EASEZU3",4,0)
NSD(EASAPP,TYPE,MULTIPLE) ;get name, ssn, dob for person of interest
"RTN","EASEZU3",5,0)
 ;input  EASAPP = application ien in file #712
"RTN","EASEZU3",6,0)
 ;         TYPE = "APPLICANT", "SPOUSE", "CHILD1", or "CHILD(N)"
"RTN","EASEZU3",7,0)
 ;     MULTIPLE = default to 1, unless TYPE="CHILD(N)"
"RTN","EASEZU3",8,0)
 ;output  RTR   =  name^ssn^dob
"RTN","EASEZU3",9,0)
 N RTR,KEY,EASNAME,EASSSN,EASDOB,LAST,FIRST,MDL,SUFF
"RTN","EASEZU3",10,0)
 S RTR="",EASNAME="",EASSSN="",EASDOB=""
"RTN","EASEZU3",11,0)
 S KEY=+$$KEY711^EASEZU1(TYPE_" LAST NAME") I KEY S LAST=$P($$DATA712^EASEZU1(EASAPP,KEY,MULTIPLE),U,1)
"RTN","EASEZU3",12,0)
 S KEY=+$$KEY711^EASEZU1(TYPE_" FIRST NAME") I KEY S FIRST=$P($$DATA712^EASEZU1(EASAPP,KEY,MULTIPLE),U,1)
"RTN","EASEZU3",13,0)
 S KEY=+$$KEY711^EASEZU1(TYPE_" MIDDLE NAME") I KEY S MDL=$P($$DATA712^EASEZU1(EASAPP,KEY,MULTIPLE),U,1)
"RTN","EASEZU3",14,0)
 S KEY=+$$KEY711^EASEZU1(TYPE_" SUFFIX NAME") I KEY S SUFF=$P($$DATA712^EASEZU1(EASAPP,KEY,MULTIPLE),U,1)
"RTN","EASEZU3",15,0)
 I (LAST="")!(FIRST="") Q RTR
"RTN","EASEZU3",16,0)
 S EASNAME=LAST_","_FIRST
"RTN","EASEZU3",17,0)
 I $L(EASNAME)+$L(MDL)>45 S MDL=$E(MDL,1)
"RTN","EASEZU3",18,0)
 I MDL'="" S EASNAME=EASNAME_" "_MDL
"RTN","EASEZU3",19,0)
 I SUFF'="" S EASNAME=EASNAME_" "_SUFF
"RTN","EASEZU3",20,0)
 S EASNAME=$$UC^EASEZT1($E(EASNAME,1,45))
"RTN","EASEZU3",21,0)
 S KEY=+$$KEY711^EASEZU1(TYPE_" SOCIAL SECURITY NUMBER")
"RTN","EASEZU3",22,0)
 I KEY S EASSSN=$P($$DATA712^EASEZU1(EASAPP,KEY,MULTIPLE),U,1),EASSSN=$$SSNOUT^EASEZT1(EASSSN)
"RTN","EASEZU3",23,0)
 S KEY=+$$KEY711^EASEZU1(TYPE_" DATE OF BIRTH")
"RTN","EASEZU3",24,0)
 I KEY S EASDOB=$P($$DATA712^EASEZU1(EASAPP,KEY,MULTIPLE),U,1)
"RTN","EASEZU3",25,0)
 S RTR=EASNAME_U_EASSSN_U_EASDOB
"RTN","EASEZU3",26,0)
 Q RTR
"RTN","EASEZU3",27,0)
 ;
"RTN","EASEZU3",28,0)
LINK ;
"RTN","EASEZU3",29,0)
 ;link applicant to file #2 as new or existing patient
"RTN","EASEZU3",30,0)
 Q:EASVIEW'=1
"RTN","EASEZU3",31,0)
 S EASPSTAT="NEW"
"RTN","EASEZU3",32,0)
 D DFN^EASEZI(EASAPP,.EASDFN)
"RTN","EASEZU3",33,0)
 I $G(EASDFN)>0 D
"RTN","EASEZU3",34,0)
 .D SETDATE^EASEZU2(EASAPP,"REV") S EASPSTAT="REV"
"RTN","EASEZU3",35,0)
 .D BLD^EASEZLM
"RTN","EASEZU3",36,0)
 .W ! D WAIT^DICD,EN^VALM("EAS EZ 1010EZ REVIEW2")
"RTN","EASEZU3",37,0)
 .S VALMBCK="Q"
"RTN","EASEZU3",38,0)
 I '$G(EASDFN) S VALMBCK="R"
"RTN","EASEZU3",39,0)
 Q
"RTN","EASEZU3",40,0)
 ;
"RTN","EASEZU3",41,0)
ACCFLD ;accept a single 1010EZ data element 
"RTN","EASEZU3",42,0)
 ;if data element was previously accepted, this action returns to non-accepted status
"RTN","EASEZU3",43,0)
 ;input  EASAPP   = pointer to file #712 for 1010EZ
"RTN","EASEZU3",44,0)
 ;       EASPSTAT = current processing status of Application;
"RTN","EASEZU3",45,0)
 ;result ACCEPT = 1, if toggled to accepted
"RTN","EASEZU3",46,0)
 ;                0, if toggled to non-accepted
"RTN","EASEZU3",47,0)
 N J,LN,SUBIEN,KEYIEN,MULTIPLE,ACCEPT,ACTION,LINK,ONE
"RTN","EASEZU3",48,0)
 Q:'EASAPP  Q:EASPSTAT=""
"RTN","EASEZU3",49,0)
 Q:'EASLN
"RTN","EASEZU3",50,0)
 S ACTION="'Accept Field'"
"RTN","EASEZU3",51,0)
 I EASPSTAT="PRT" D NOACT^EASEZLM("Printed",ACTION) Q
"RTN","EASEZU3",52,0)
 I EASPSTAT="SIG" D NOACT^EASEZLM("Signed",ACTION) Q
"RTN","EASEZU3",53,0)
 I EASPSTAT="FIL" D NOACT^EASEZLM("Filed",ACTION) Q
"RTN","EASEZU3",54,0)
 I EASPSTAT="CLS" D NOACT^EASEZLM("Inactivated",ACTION) Q
"RTN","EASEZU3",55,0)
 ;select data item to toggle
"RTN","EASEZU3",56,0)
 S VALMBCK=""
"RTN","EASEZU3",57,0)
 S ONE=0
"RTN","EASEZU3",58,0)
 S VALM("ENTITY")="Line Item" D SELRNGE^EASEZLM
"RTN","EASEZU3",59,0)
 Q:$G(EASERR)
"RTN","EASEZU3",60,0)
 Q:'$G(EASSEL("BG"))
"RTN","EASEZU3",61,0)
 ;
"RTN","EASEZU3",62,0)
 I EASSEL("BG")=EASSEL("LST") S ONE=1
"RTN","EASEZU3",63,0)
 ;
"RTN","EASEZU3",64,0)
 S J=0 F  S J=$O(EASSEL(J)) Q:'J  S EASLN=J D
"RTN","EASEZU3",65,0)
 .S LN=^TMP("EASEXP",$J,"IDX",EASLN),SUBIEN=$P(LN,U,1),MULTIPLE=$P(LN,U,2),KEYIEN=$P(LN,U,3)
"RTN","EASEZU3",66,0)
 .S EZDATA=$P($G(^TMP("EZDATA",$J,KEYIEN,MULTIPLE,1)),U,1),XFILE=$P($G(^TMP("EZDATA",$J,KEYIEN)),U,1)
"RTN","EASEZU3",67,0)
 .Q:EZDATA=""
"RTN","EASEZU3",68,0)
 .Q:'SUBIEN
"RTN","EASEZU3",69,0)
 .S ACCEPT=$P($G(^EAS(712,EASAPP,10,SUBIEN,0)),U,3)
"RTN","EASEZU3",70,0)
 .;provide info to user only if exactly one line item being 'accepted'
"RTN","EASEZU3",71,0)
 .I ONE D FULL^VALM1
"RTN","EASEZU3",72,0)
 .;don't allow accept of data which cannot be filed
"RTN","EASEZU3",73,0)
 .I ((XFILE=0)!(ACCEPT=-1)) D:ONE  Q
"RTN","EASEZU3",74,0)
 ..W !!,?5,"Sorry, that data element cannot be 'Accepted' for 'Filing'."
"RTN","EASEZU3",75,0)
 ..W !!,?5,"After filing this Application to VistA, use Register a Patient "
"RTN","EASEZU3",76,0)
 ..W !,?5,"or Patient Enrollment to enter/update data as needed.",!
"RTN","EASEZU3",77,0)
 ..K DIR D PAUSE^VALM1 S VALMBCK="R"
"RTN","EASEZU3",78,0)
 .;if an 'always' accept data element, don't allow user to toggle off;
"RTN","EASEZU3",79,0)
 .I ACCEPT=2 D:ONE  Q
"RTN","EASEZU3",80,0)
 ..W !!,?5,"Sorry, that data element must be 'Accepted' for this Applicant."
"RTN","EASEZU3",81,0)
 ..I XFILE'=355.33 D
"RTN","EASEZU3",82,0)
 ...W !!,?5,"After filing this Application to VistA, the Registration options"
"RTN","EASEZU3",83,0)
 ...W !,?5,"can be used to modify data as needed.",!
"RTN","EASEZU3",84,0)
 ..I XFILE=355.33 D
"RTN","EASEZU3",85,0)
 ...W !!,?5,"After filing this Application to VistA, Integrated Billing users"
"RTN","EASEZU3",86,0)
 ...W !,?5,"can modify the data using the 'Process Insurance Buffer' option.",!
"RTN","EASEZU3",87,0)
 ..K DIR D PAUSE^VALM1 S VALMBCK="R"
"RTN","EASEZU3",88,0)
 .;don't allow 'updated' element to be toggled off;
"RTN","EASEZU3",89,0)
 .S UPD=$P($G(^EAS(712,EASAPP,10,SUBIEN,1)),U,2) I UPD'="" D:ONE  Q
"RTN","EASEZU3",90,0)
 ..W !!,?5,"Sorry, that data element has been Updated and must be 'Accepted'"
"RTN","EASEZU3",91,0)
 ..W !,?5,"for this Applicant."
"RTN","EASEZU3",92,0)
 ..K DIR D PAUSE^VALM1 S VALMBCK="R"
"RTN","EASEZU3",93,0)
 .;toggle 'accept' indicator for line itme
"RTN","EASEZU3",94,0)
 .S ACCEPT=$$ATOGGLE(EASLN,SUBIEN,ACCEPT)
"RTN","EASEZU3",95,0)
 ;
"RTN","EASEZU3",96,0)
 Q
"RTN","EASEZU3",97,0)
 ;
"RTN","EASEZU3",98,0)
ATOGGLE(EASLN,SUBIEN,ACCEPT) ;toggle 'accept' on line item
"RTN","EASEZU3",99,0)
 S ACCEPT='ACCEPT
"RTN","EASEZU3",100,0)
 S $P(^EAS(712,EASAPP,10,SUBIEN,0),U,3)=ACCEPT
"RTN","EASEZU3",101,0)
 ;highlight data on screen
"RTN","EASEZU3",102,0)
 I ACCEPT D CNTRL^VALM10(EASLN,27,25,IORVON,IORVOFF)
"RTN","EASEZU3",103,0)
 I 'ACCEPT D CNTRL^VALM10(EASLN,27,25,IORVOFF,IORVOFF)
"RTN","EASEZU3",104,0)
 D WRITE^VALM10(EASLN)
"RTN","EASEZU3",105,0)
 S VALMBCK="R"
"RTN","EASEZU3",106,0)
 Q ACCEPT
"RTN","EASEZU3",107,0)
 ;
"RTN","EASEZU3",108,0)
ACCALL ;accept all non-null 1010EZ data elements
"RTN","EASEZU3",109,0)
 ;prevously accepted data elements are not toggled to non-accepted
"RTN","EASEZU3",110,0)
 ;input  EASAPP   = pointer to file #712 for 1010EZ
"RTN","EASEZU3",111,0)
 ;       EASPSTAT = current processing status of Application; 
"RTN","EASEZU3",112,0)
 N EASLN,ACTION,XFILE
"RTN","EASEZU3",113,0)
 Q:'EASAPP  Q:EASPSTAT=""
"RTN","EASEZU3",114,0)
 S ACTION="'Accept All'"
"RTN","EASEZU3",115,0)
 I EASPSTAT="PRT" D NOACT^EASEZLM("Printed",ACTION) Q
"RTN","EASEZU3",116,0)
 I EASPSTAT="SIG" D NOACT^EASEZLM("Signed",ACTION) Q
"RTN","EASEZU3",117,0)
 I EASPSTAT="FIL" D NOACT^EASEZLM("Filed",ACTION) Q
"RTN","EASEZU3",118,0)
 I EASPSTAT="CLS" D NOACT^EASEZLM("Inactivated",ACTION) Q
"RTN","EASEZU3",119,0)
 ;
"RTN","EASEZU3",120,0)
 S EASLN=0 F  S EASLN=$O(^TMP("EASEXP",$J,"IDX",EASLN)) Q:'EASLN  D
"RTN","EASEZU3",121,0)
 .S SUBIEN=$P(^TMP("EASEXP",$J,"IDX",EASLN),U,1),MULTIPLE=$P(^(EASLN),U,2),KEYIEN=$P(^(EASLN),U,3)
"RTN","EASEZU3",122,0)
 .S XFILE=$P(^TMP("EZDATA",$J,KEYIEN),U,1)
"RTN","EASEZU3",123,0)
 .Q:XFILE=0
"RTN","EASEZU3",124,0)
 .S EZDATA=$P($G(^TMP("EZDATA",$J,KEYIEN,MULTIPLE,1)),U,1) I EZDATA'="" D
"RTN","EASEZU3",125,0)
 ..I $P(^EAS(712,EASAPP,10,SUBIEN,0),U,3)="" S $P(^(0),U,3)=1
"RTN","EASEZU3",126,0)
 ..D FLDCTRL^VALM10(EASLN,"EZDATA",IORVON,IORVOFF)
"RTN","EASEZU3",127,0)
 ..Q:(EASLN<VALMBG)!(EASLN>VALMLST)
"RTN","EASEZU3",128,0)
 ..D CNTRL^VALM10(EASLN,27,25,IORVON,IORVOFF)
"RTN","EASEZU3",129,0)
 ..D WRITE^VALM10(EASLN)
"RTN","EASEZU3",130,0)
 ;
"RTN","EASEZU3",131,0)
 ;update processing status if necessary
"RTN","EASEZU3",132,0)
 I EASPSTAT="NEW" D
"RTN","EASEZU3",133,0)
 .D SETDATE^EASEZU2(EASAPP,"REV") S EASPSTAT="REV"
"RTN","EASEZU3",134,0)
 .D BLD^EASEZLM,HDR2^EASEZL1
"RTN","EASEZU3",135,0)
 S VALMBCK="R"
"RTN","EASEZU3",136,0)
 Q
"RTN","EASEZU3",137,0)
 ;
"RTN","EASEZU3",138,0)
CLEAR ;clear all accept indicators from subfile #712.01 & LM array
"RTN","EASEZU3",139,0)
 ;input EASAPP   = ien to #712 for Application
"RTN","EASEZU3",140,0)
 ;      EASPSTAT = current processing status of Application; 
"RTN","EASEZU3",141,0)
 N BB,EASLN,ACTION
"RTN","EASEZU3",142,0)
 Q:'EASAPP  Q:EASPSTAT=""
"RTN","EASEZU3",143,0)
 S ACTION="'Clear All'"
"RTN","EASEZU3",144,0)
 I EASPSTAT="PRT" D NOACT^EASEZLM("Printed",ACTION) Q
"RTN","EASEZU3",145,0)
 I EASPSTAT="SIG" D NOACT^EASEZLM("Signed",ACTION) Q
"RTN","EASEZU3",146,0)
 I EASPSTAT="FIL" D NOACT^EASEZLM("Filed",ACTION) Q
"RTN","EASEZU3",147,0)
 I EASPSTAT="CLS" D NOACT^EASEZLM("Inactivated",ACTION) Q
"RTN","EASEZU3",148,0)
 ;
"RTN","EASEZU3",149,0)
 ;if a new patient, don't allow user to reset all accept
"RTN","EASEZU3",150,0)
 I $G(EASEZNEW) D  Q
"RTN","EASEZU3",151,0)
 .D FULL^VALM1
"RTN","EASEZU3",152,0)
 .W !!,?5,"Sorry, the 'Clear All' action cannot be used for this new patient."
"RTN","EASEZU3",153,0)
 .W !,?5,"It is recommended that all data elements be 'Accepted' for 'Filing'."
"RTN","EASEZU3",154,0)
 .W !!,?5,"After filing the Application to VistA, the Registration options"
"RTN","EASEZU3",155,0)
 .W !,?5,"can be used to modify data.",!
"RTN","EASEZU3",156,0)
 .D PAUSE^VALM1 S VALMBCK="R"
"RTN","EASEZU3",157,0)
 ;
"RTN","EASEZU3",158,0)
 ;clear accept flags and updates
"RTN","EASEZU3",159,0)
 ;remove accept indicators from List Manager display array
"RTN","EASEZU3",160,0)
 S EASLN=0 F  S EASLN=$O(^TMP("EASEXP",$J,"IDX",EASLN)) Q:'EASLN  D
"RTN","EASEZU3",161,0)
 .S SUBIEN=$P(^TMP("EASEXP",$J,"IDX",EASLN),U,1)
"RTN","EASEZU3",162,0)
 .;don't clear if updated
"RTN","EASEZU3",163,0)
 .Q:'SUBIEN
"RTN","EASEZU3",164,0)
 .I $P($G(^EAS(712,EASAPP,10,SUBIEN,0)),U,3)=1 D
"RTN","EASEZU3",165,0)
 ..F P=3,4,5 S $P(^EAS(712,EASAPP,10,SUBIEN,0),U,P)=""
"RTN","EASEZU3",166,0)
 ..S $P(^EAS(712,EASAPP,10,SUBIEN,1),U,2)=""
"RTN","EASEZU3",167,0)
 ..S $P(^EAS(712,EASAPP,10,SUBIEN,2),U,1)=""
"RTN","EASEZU3",168,0)
 ..D FLDCTRL^VALM10(EASLN,"EZDATA",IORVOFF,IORVOFF)
"RTN","EASEZU3",169,0)
 ..Q:(EASLN<VALMBG)!(EASLN>VALMLST)
"RTN","EASEZU3",170,0)
 ..D CNTRL^VALM10(EASLN,27,25,IORVOFF,IORVOFF) D WRITE^VALM10(EASLN)
"RTN","EASEZU3",171,0)
 S VALMBCK=""
"RTN","EASEZU3",172,0)
 Q
"RTN","EASEZU3",173,0)
 ;
"RTN","EASEZU3",174,0)
RESET ;reset 1010EZ Application to 'new' processing status
"RTN","EASEZU3",175,0)
 ;input  EASAPP  = pointer to file #712 for 1010EZ
"RTN","EASEZU3",176,0)
 ;      EASPSTAT = current processing status of Application; 
"RTN","EASEZU3",177,0)
 ;this action must be follwed by an 'exit' action from the List Manager screen
"RTN","EASEZU3",178,0)
 N ACTION,NEWDATE
"RTN","EASEZU3",179,0)
 Q:'EASAPP  Q:EASPSTAT=""
"RTN","EASEZU3",180,0)
 S ACTION="'Reset to New'"
"RTN","EASEZU3",181,0)
 I EASPSTAT="SIG" D NOACT^EASEZLM("Signed",ACTION) Q
"RTN","EASEZU3",182,0)
 I EASPSTAT="FIL" D NOACT^EASEZLM("Filed",ACTION) Q
"RTN","EASEZU3",183,0)
 I EASPSTAT="CLS" D NOACT^EASEZLM("Inactivated",ACTION) Q
"RTN","EASEZU3",184,0)
 ;
"RTN","EASEZU3",185,0)
 D OKRESET
"RTN","EASEZU3",186,0)
 ;update to 'New' status
"RTN","EASEZU3",187,0)
 S EASPSTAT="NEW",NEWDATE=$P(^EAS(712,EASAPP,0),U,6)
"RTN","EASEZU3",188,0)
 D REINDEX^EASEZU2(EASAPP,EASPSTAT,NEWDATE)
"RTN","EASEZU3",189,0)
 ;rebuild selection list since this application is removed from list
"RTN","EASEZU3",190,0)
 D BLD^EASEZLM
"RTN","EASEZU3",191,0)
 I 'VALMCNT D NOLINES^EASEZLM
"RTN","EASEZU3",192,0)
 W !,"Application has been Reset to New...",!
"RTN","EASEZU3",193,0)
 D PAUSE^VALM1
"RTN","EASEZU3",194,0)
 S VALMBCK="Q"
"RTN","EASEZU3",195,0)
 Q
"RTN","EASEZU3",196,0)
 ;
"RTN","EASEZU3",197,0)
OKRESET ;perform all housekeeping to for 'reset to new' or 'inactivate'
"RTN","EASEZU3",198,0)
 N BB,DA,DR,DIE,REM
"RTN","EASEZU3",199,0)
 ;remove status indicator fields from file #712 record
"RTN","EASEZU3",200,0)
 S DA=EASAPP,DIE="^EAS(712,"
"RTN","EASEZU3",201,0)
 S DR="5.1///^S X=""@"";5.2///^S X=""@"";6.1///^S X=""@"";6.2///^S X=""@"";8.1///^S X=""@"";8.2///^S X=""@"";"
"RTN","EASEZU3",202,0)
 D ^DIE
"RTN","EASEZU3",203,0)
 ;
"RTN","EASEZU3",204,0)
 ;delete link to file #2
"RTN","EASEZU3",205,0)
 I '$G(EASDFN) S EASDFN=$P(^EAS(712,EASAPP,0),U,10)
"RTN","EASEZU3",206,0)
 S $P(^EAS(712,EASAPP,0),U,10)=""
"RTN","EASEZU3",207,0)
 I $G(EASDFN) K ^EAS(712,"AC",EASDFN,EASAPP)
"RTN","EASEZU3",208,0)
 ;remove all links to VistA datbase
"RTN","EASEZU3",209,0)
 ;delete link, delete updated data, remove accept in each subfile #712.01 record
"RTN","EASEZU3",210,0)
 S BB=0 F  S BB=$O(^EAS(712,EASAPP,10,BB)) Q:'BB  D
"RTN","EASEZU3",211,0)
 .F P=3,4,5 S $P(^EAS(712,EASAPP,10,BB,0),U,P)=""
"RTN","EASEZU3",212,0)
 .S $P(^EAS(712,EASAPP,10,BB,1),U,2)=""
"RTN","EASEZU3",213,0)
 .F P=1,2 S $P(^EAS(712,EASAPP,10,BB,2),U,P)=""
"RTN","EASEZU3",214,0)
 ;
"RTN","EASEZU3",215,0)
 ;clear new patient indicator since applicant must be re-matched to VistA;
"RTN","EASEZU3",216,0)
 ;but if this applicant is matched again with same new stub record in VistA,
"RTN","EASEZU3",217,0)
 ;  there's a comment in file #2/field #.091 to indicate the record was previously
"RTN","EASEZU3",218,0)
 ;  added by 1010EZ process
"RTN","EASEZU3",219,0)
 ;update 'new patient' remark
"RTN","EASEZU3",220,0)
 I '$G(EASEZNEW) S EASEZNEW=$P(^EAS(712,EASAPP,0),U,11)
"RTN","EASEZU3",221,0)
 S $P(^EAS(712,EASAPP,0),U,11)=""
"RTN","EASEZU3",222,0)
 I EASEZNEW,EASDFN D
"RTN","EASEZU3",223,0)
 .S REM="New Patient record added by ELECTRONIC 10-10EZ."
"RTN","EASEZU3",224,0)
 .S DA=EASDFN,DIE="^DPT(",DR=".091///^S X=REM"
"RTN","EASEZU3",225,0)
 .D ^DIE
"RTN","EASEZU3",226,0)
 Q
"RTN","EASEZU5")
0^14^B33343925
"RTN","EASEZU5",1,0)
EASEZU5 ;ALB/jap - Utilities for 1010EZ Processing ;10/25/00  13:08
"RTN","EASEZU5",2,0)
 ;;1.0;ENROLLMENT APPLICATION SYSTEM;**1**;Mar 15, 2001
"RTN","EASEZU5",3,0)
 ;
"RTN","EASEZU5",4,0)
PRTCOMP ;print comparison of 10-10EZ data with VistA data
"RTN","EASEZU5",5,0)
 N ACTION
"RTN","EASEZU5",6,0)
 S ACTION="'Print Data'"
"RTN","EASEZU5",7,0)
 ;no action if closed
"RTN","EASEZU5",8,0)
 I EASPSTAT="CLS" D NOACT^EASEZLM("Inactivated",ACTION) Q
"RTN","EASEZU5",9,0)
 ;proceed with print of data comparison
"RTN","EASEZU5",10,0)
 W !,"Data Print queued to background...",!
"RTN","EASEZU5",11,0)
 S VALMBCK="R"
"RTN","EASEZU5",12,0)
 D PAUSE^VALM1
"RTN","EASEZU5",13,0)
 Q
"RTN","EASEZU5",14,0)
 ;
"RTN","EASEZU5",15,0)
UPDATE ;update/overwrite a 10-10EZ data element
"RTN","EASEZU5",16,0)
 N ACTION,SIGDATE,EASSEL,EASERR,EASLN,LN,SUBIEN,MULTIPLE,KEYIEN,UPDATE,UPDATE2,FILE,SUBFILE,FLD,FFF
"RTN","EASEZU5",17,0)
 N ORIGINAL,DATANM,UPDATE,CODE,FILE,SUBFILE,FLD,FDEF,FTYPE,ROOT,SETCODES,MIN,MAX,X,Y,DA,DR,DIC,DIE,DIR,X1,X2,X3
"RTN","EASEZU5",18,0)
 ;variable ORIGINAL holds original 1010EZ data
"RTN","EASEZU5",19,0)
 S ACTION="'Update Field'"
"RTN","EASEZU5",20,0)
 ;no action if closed
"RTN","EASEZU5",21,0)
 I EASPSTAT="CLS" D NOACT^EASEZLM("Inactivated",ACTION) Q
"RTN","EASEZU5",22,0)
 ;invalid for the following process status
"RTN","EASEZU5",23,0)
 I EASPSTAT="NEW" D NOACT^EASEZLM("New",ACTION) Q
"RTN","EASEZU5",24,0)
 I EASPSTAT="PRT" D NOACT^EASEZLM("Unsigned",ACTION) Q
"RTN","EASEZU5",25,0)
 I EASPSTAT="FIL" D NOACT^EASEZLM("Filed",ACTION) Q
"RTN","EASEZU5",26,0)
 ;select data item to update
"RTN","EASEZU5",27,0)
 S VALMBCK="R"
"RTN","EASEZU5",28,0)
 D SEL^EASEZLM
"RTN","EASEZU5",29,0)
 Q:$G(EASERR)
"RTN","EASEZU5",30,0)
 Q:'$G(EASSEL)
"RTN","EASEZU5",31,0)
 S EASLN=EASSEL
"RTN","EASEZU5",32,0)
 ;
"RTN","EASEZU5",33,0)
 ;use DIR reader to get input from user which overwrites 1010EZ data
"RTN","EASEZU5",34,0)
 D FULL^VALM1
"RTN","EASEZU5",35,0)
 S DIR(0)="",(FDEF,FTYPE)=""
"RTN","EASEZU5",36,0)
 S LN=^TMP("EASEXP",$J,"IDX",EASLN),SUBIEN=$P(LN,U,1),MULTIPLE=$P(LN,U,2),KEYIEN=$P(LN,U,3)
"RTN","EASEZU5",37,0)
 S X=$G(^TMP("EZDATA",$J,KEYIEN,MULTIPLE,1)),ORIGINAL=$P(X,U,1),ACCEPT=$P(X,U,2)
"RTN","EASEZU5",38,0)
 S DATANM=$P($G(^EAS(711,KEYIEN,0)),U,1)
"RTN","EASEZU5",39,0)
 S DIR("A")=DATANM
"RTN","EASEZU5",40,0)
 ;if #3 of file #711 is defined then use to set DIR(0);
"RTN","EASEZU5",41,0)
 S X=$G(^EAS(711,KEYIEN,3)) I X'="" X X
"RTN","EASEZU5",42,0)
 S FFF=$G(^EAS(711,KEYIEN,1)),FILE=$P(FFF,U,1),SUBFILE=$P(FFF,U,2),FLD=$P(FFF,U,3)
"RTN","EASEZU5",43,0)
 ;don't allow updates to data which cannot be filed
"RTN","EASEZU5",44,0)
 I ((FILE=0)!(ACCEPT=-1)) D  Q
"RTN","EASEZU5",45,0)
 .W !!,?5,"Sorry...the selected data element cannot be 'Updated'."
"RTN","EASEZU5",46,0)
 .W !!,?5,"After filing this Application to VistA, use Register a Patient "
"RTN","EASEZU5",47,0)
 .W !,?5,"or Patient Enrollment to enter/update data as needed.",!
"RTN","EASEZU5",48,0)
 .K DIR D PAUSE^VALM1 S VALMBCK="R"
"RTN","EASEZU5",49,0)
 ;exceptions for data input; too complex for simple DIR call;
"RTN","EASEZU5",50,0)
 I DATANM["NAME",DATANM'["OTHER" D ANAME^EASEZU6(EASLN,LN,DATANM) Q
"RTN","EASEZU5",51,0)
 I DATANM["PHONE" D APHONE^EASEZU6(EASLN,LN,DATANM) Q
"RTN","EASEZU5",52,0)
 I DATANM["COUNTY" D ACOUNTY^EASEZU6(EASLN,LN,DATANM) Q
"RTN","EASEZU5",53,0)
 I DATANM["STATE" D ASTATE^EASEZU6(EASLN,LN,DATANM) Q
"RTN","EASEZU5",54,0)
 I DATANM["SOCIAL SECURITY NUMBER",FILE'=2 D ASSN^EASEZU6(EASLN,LN,DATANM,ACCEPT) Q
"RTN","EASEZU5",55,0)
 ;setup DIR(0) for remaining mapped-to data elements
"RTN","EASEZU5",56,0)
 I DIR(0)="",FLD'=0 D
"RTN","EASEZU5",57,0)
 .;use DIR read based on mapped-to file/field for all other data elements
"RTN","EASEZU5",58,0)
 .I (SUBFILE=FILE)!(SUBFILE="") S FDEF=FILE
"RTN","EASEZU5",59,0)
 .E  S FDEF=SUBFILE
"RTN","EASEZU5",60,0)
 .S FTYPE=$$GET1^DID(FDEF,FLD,"","TYPE")
"RTN","EASEZU5",61,0)
 .;can't use DD type read, some fields will error because DA is not defined for the input transform;
"RTN","EASEZU5",62,0)
 .;so set DIR(0) according to field type of VistA target location instead;
"RTN","EASEZU5",63,0)
 .I FTYPE["POINTER" D
"RTN","EASEZU5",64,0)
 ..;mapped to pointer field
"RTN","EASEZU5",65,0)
 ..S ROOT=$$GET1^DID(FDEF,FLD,"","POINTER")
"RTN","EASEZU5",66,0)
 ..I ROOT'="" S DIR(0)="P"_U_ROOT_":EMZ"
"RTN","EASEZU5",67,0)
 .I FTYPE="SET" D
"RTN","EASEZU5",68,0)
 ..;mapped to set of codes field
"RTN","EASEZU5",69,0)
 ..S X=^DD(FDEF,FLD,0)
"RTN","EASEZU5",70,0)
 ..S SETCODES=$P(X,U,3) K X
"RTN","EASEZU5",71,0)
 ..S DIR(0)="S"_U_SETCODES
"RTN","EASEZU5",72,0)
 .I FTYPE="DATE/TIME" D
"RTN","EASEZU5",73,0)
 ..;mapped to date/time field
"RTN","EASEZU5",74,0)
 ..S DIR(0)="D^::AEP"
"RTN","EASEZU5",75,0)
 .I FTYPE="FREE TEXT" D
"RTN","EASEZU5",76,0)
 ..;mapped to free text field
"RTN","EASEZU5",77,0)
 ..S MAX=$$GET1^DID(FDEF,FLD,"","FIELD LENGTH")
"RTN","EASEZU5",78,0)
 ..I MAX S DIR(0)="F^1:"_MAX
"RTN","EASEZU5",79,0)
 ..E  S DIR(0)="F^1:80"
"RTN","EASEZU5",80,0)
 .I FTYPE="NUMERIC" D
"RTN","EASEZU5",81,0)
 ..;mapped to numeric field
"RTN","EASEZU5",82,0)
 ..S FINP=$$GET1^DID(FDEF,FLD,"","INPUT TRANSFORM")
"RTN","EASEZU5",83,0)
 ..S MIN=+$P(FINP,"X<",2),MAX=+$P(FINP,"X>",2)
"RTN","EASEZU5",84,0)
 ..I MAX S DIR(0)="N"_U_MIN_":"_MAX_":0"
"RTN","EASEZU5",85,0)
 ..E  S DIR(0)="N^0:9999999:0"
"RTN","EASEZU5",86,0)
 I FLD=0 D
"RTN","EASEZU5",87,0)
 .;unmapped data element
"RTN","EASEZU5",88,0)
 .I DIR(0)="" S DIR(0)="F^1:80"
"RTN","EASEZU5",89,0)
 ;make the DIR call for user input only if DIR(0) has been set
"RTN","EASEZU5",90,0)
 Q:DIR(0)=""
"RTN","EASEZU5",91,0)
 D ^DIR
"RTN","EASEZU5",92,0)
 ;don't continue if user exited w/o input
"RTN","EASEZU5",93,0)
 Q:($D(DTOUT)!$D(DUOUT))
"RTN","EASEZU5",94,0)
 K DIR,DTOUT,DUOUT,DIRUT
"RTN","EASEZU5",95,0)
 ;pickup the DIR output
"RTN","EASEZU5",96,0)
 S UPDATE=$P($G(Y(0)),U,1) S:UPDATE="" UPDATE=$P($G(Y),U,1)
"RTN","EASEZU5",97,0)
 ;don't continue if no data
"RTN","EASEZU5",98,0)
 Q:UPDATE=""
"RTN","EASEZU5",99,0)
 ;convert dates to mm/dd/yyyy
"RTN","EASEZU5",100,0)
 I FTYPE="DATE/TIME" D
"RTN","EASEZU5",101,0)
 .;Y holds date from DIR call in internal format 
"RTN","EASEZU5",102,0)
 .S %F=5,UPDATE2=$$FMTE^XLFDT(Y,%F) I $L(UPDATE2)<10 D
"RTN","EASEZU5",103,0)
 ..S X1=$P(UPDATE2,"/",1),X2=$P(UPDATE2,"/",2),X3=$P(UPDATE2,"/",3)
"RTN","EASEZU5",104,0)
 ..S:$L(X1)=1 X1="0"_X1 S:$L(X2)=1 X2="0"_X2
"RTN","EASEZU5",105,0)
 ..S UPDATE2=X1_"/"_X2_"/"_X3
"RTN","EASEZU5",106,0)
 ..S UPDATE=UPDATE2
"RTN","EASEZU5",107,0)
 ;don't continue if no change to data
"RTN","EASEZU5",108,0)
 Q:(UPDATE=ORIGINAL)
"RTN","EASEZU5",109,0)
 Q:(UPDATE="")
"RTN","EASEZU5",110,0)
 ;
"RTN","EASEZU5",111,0)
 I 'ACCEPT S ACCEPT=1
"RTN","EASEZU5",112,0)
 S $P(^TMP("EZDATA",$J,KEYIEN,MULTIPLE,1),U,1,2)=UPDATE_U_ACCEPT
"RTN","EASEZU5",113,0)
 ;file data element; any manually updated element is 'accepted'
"RTN","EASEZU5",114,0)
 S DIE="^EAS(712,EASAPP,10,",DA=SUBIEN,DA(1)=EASAPP,DR(1)="10;"
"RTN","EASEZU5",115,0)
 S DR="1.5///^S X=UPDATE;1.1///^S X=ACCEPT;1.2///^S X=DT;1.3///^S X=DUZ"
"RTN","EASEZU5",116,0)
 D ^DIE
"RTN","EASEZU5",117,0)
 S VALMBCK="R"
"RTN","EASEZU5",118,0)
 ;update screen list
"RTN","EASEZU5",119,0)
 D FLDTEXT^VALM10(EASLN,"EZDATA",UPDATE)
"RTN","EASEZU5",120,0)
 D FLDCTRL^VALM10(EASLN,"EZDATA",IORVON,IORVOFF)
"RTN","EASEZU5",121,0)
 D WRITE^VALM10(EASLN)
"RTN","EASEZU5",122,0)
 Q
"RTN","EASEZU5",123,0)
 ;
"RTN","EASEZU5",124,0)
REMSIG ;remove signature verification from selected Application
"RTN","EASEZU5",125,0)
 N APP,STATUS,DA,DIC,DR,DIR,DIRUT,DUOUT,DTOUT,S,X,Y
"RTN","EASEZU5",126,0)
 W @IOF
"RTN","EASEZU5",127,0)
 W !!,"Lookup and selection for Signature Verification Removal"
"RTN","EASEZU5",128,0)
 W !,"is by Application # only."
"RTN","EASEZU5",129,0)
 W !!,"Only Applications with a Signature Verification Date, but no"
"RTN","EASEZU5",130,0)
 W !,"Filing Date may be selected.",!!
"RTN","EASEZU5",131,0)
 S DIC="^EAS(712,",DIC(0)="AENQXZ",DIC("S")="I +$P($G(^(1)),U,2)>0,+$P($G(^(2)),U,5)=0"
"RTN","EASEZU5",132,0)
 D ^DIC
"RTN","EASEZU5",133,0)
 S APP=+Y
"RTN","EASEZU5",134,0)
 I APP>0 D
"RTN","EASEZU5",135,0)
 .S DIR(0)="YA",DIR("A")="Are you sure Signature Verification should be removed? (Y/N): " D ^DIR
"RTN","EASEZU5",136,0)
 .Q:$D(DIRUT)
"RTN","EASEZU5",137,0)
 .Q:'Y
"RTN","EASEZU5",138,0)
 .W !!,"One moment please...",!
"RTN","EASEZU5",139,0)
 .;remove signature verification data; update audit fields for sig. removal
"RTN","EASEZU5",140,0)
 .S DA=APP K X,Y
"RTN","EASEZU5",141,0)
 .S DIE=DIC,DR="4///^S X=""@"";4.1///^S X=""@"";4.2///^S X=""@"";4.6///^S X=DT;4.7///^S X=DUZ"
"RTN","EASEZU5",142,0)
 .D ^DIE
"RTN","EASEZU5",143,0)
 .D APPINDEX^EASEZU2(APP)
"RTN","EASEZU5",144,0)
 .S S=$$CURRSTAT^EASEZU2(APP),STATUS=$S(S="PRT":"Printed, Pending Signature",1:"In Review")
"RTN","EASEZU5",145,0)
 .W !!,"Signature Verification removed..."
"RTN","EASEZU5",146,0)
 .W !!,"Application #"_APP_" STATUS -- ",STATUS
"RTN","EASEZU5",147,0)
 W !!
"RTN","EASEZU5",148,0)
 Q
"VER")
8.0^22
"^DD",712,712,4.6,0)
SIG. REMOVAL DATE^D^^1;7^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",712,712,4.6,21,0)
^^2^2^3010406^
"^DD",712,712,4.6,21,1,0)
This is the date on which Signature Verification was removed by
"^DD",712,712,4.6,21,2,0)
a user.  This is done through the EAS EZ REMOVE SIGNATURE option.
"^DD",712,712,4.6,"DT")
3010406
"^DD",712,712,4.7,0)
SIG. REMOVED BY^P200'^VA(200,^1;8^Q
"^DD",712,712,4.7,21,0)
^^2^2^3010406^
"^DD",712,712,4.7,21,1,0)
This is the user that removed the Signature Verification by
"^DD",712,712,4.7,21,2,0)
using the EAS EZ REMOVE SIGNATURE option.
"^DD",712,712,4.7,"DT")
3010406
**END**
**END**
