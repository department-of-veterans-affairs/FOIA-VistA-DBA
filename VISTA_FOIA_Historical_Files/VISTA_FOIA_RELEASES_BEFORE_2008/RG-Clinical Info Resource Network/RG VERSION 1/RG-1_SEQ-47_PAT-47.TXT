$TXT Created by DAVIS,PAULETTE T at DEVCRN.FO-ALBANY.MED.VA.GOV  (KIDS) on Tuesday, 05/08/07 at 09:40
=============================================================================
Run Date: MAY 14, 2007                     Designation: RG*1*47
Package : RG - CLINICAL INFO RESOURCE NETWORK Priority: EMERGENCY
Version : 1        SEQ #47                      Status: Released
                  Compliance Date: MAY 16, 2007
=============================================================================

Associated patches: (v)RG*1*44     <<= must be installed BEFORE `RG*1*47'

Subject: MPI MESSAGING ENHANCEMENTS

Category: 
  - Routine
  - Enhancement ()

Description:
============

  PLEASE NOTE:
  ============
  The schedules for a number of projects (e.g., Enrollment System
  Redesign (ESR), Person Service Identity Management (PSIM),
  Administrative Data Repository (ADR), etc.) are awaiting the
  release of patch DG*5.3*707.  DG*5.3*707 can not resume testing
  until patch RG*1.0*47 is installed at all facilities.  Therefore,
  we are requesting, upon release of patch RG*1.0*47, that installation
  take place within forty-eight hours.
   
  NOTE:  RG* and MPIF* patches should NOT be installed on legacy
  systems to avoid issues with the legacy systems ending up as
  Treating Facilities.
   
  RG*1.0*44 is a required build for patch RG*1*47.
   
  Issue #1
  Previously, the Patient Audit File Print [RGMT AUDIT PRINT] option
  was confusing.  Often, there were fields that displayed on the
  report where the 'before' and 'after' values were the same.
  The purpose of the report is to review the AUDIT (#1.1) file data
  for fields being audited in the PATIENT (#2) file.  A code change
  was made in routine RGADTP2 so that now the audit log data is only
  displayed for those fields where the 'before' and 'after' values
  are actually different.
   
  Issue #2
  When the MPI sends an update via HL7, if the field had no value on the
  MPI, double quotes weren't being sent to indicate a delete for the
  field.  This has been modified in MPI*1*40.  The VistA side now handles
  the double quotes and processes them as a delete.  Routine RGADTP1
  and RGADTP2 have been modified to support this change.
   
  Issue #3
  In routine RGADTP, the code does not take into account that there
  could be more than one ZEL segment.  A change has been made to RGADTP
  to process multiple ZEL segments.
   
  Issue #4
  The MULTIPLE BIRTH INDICATOR field has been sent and stored on the
  MPI for some time.  However, that information previously was not
  transmitted to all of the "systems of interest" (i.e., Treating
  Facilities).  As part of the MPI CHANGES 3 project, the MULTIPLE
  BIRTH INDICATOR is included in the list of identity elements that
  are broadcast from the MPI out to all "systems of interest."
  This functionality is in support of the patient safety office effort
  to reduce the number of local duplicate record merges on records that
  are related to patients with trait values similar to their siblings.
  The KERNEL Duplicate Record Merge software has already been modified
  to display the value if present.  Routines RGADTP1 and RGADTP2 have
  been updated to support this change.
     
  Issue #5
  When working with a "Primary View Reject" exception in the MPI/PD
  Exception Handling [RG EXCEPTION HANDLING] option, when a previously
  sent query fails to return results from the MPI the user is not
  explicitly told why this happens.  Code has been added to RGPVREJ to
  display the following message when/if this occurs:
  "Query data has NOT returned from the MPI; please check back later."
  
  Issue #6
  Pseudo social security numbers are not stored on the MPI.  Instead on
  the MPI, the SOCIAL SECURITY NUMBER field (#13) in the MPI VETERAN/CLIENT
  (#985) file is blank.  When sending a Primary View update to VistA, if
  the SOCIAL SECURITY NUMBER field on the MPI is blank, then double quotes
  are sent in the HL7 message PID segment.  If this occurs, and if there is
  no pseudo social security number on VistA, a pseudo is created.  Routine
  RGADTP2 contains the code to create the pseudo on VistA.
   
  Issue #7
  When the MPI sends the SSN Verification Status field in the OBX segment,
  the processing routine was using the text for the status instead of the
  coded value to decide what value to use to update the SSN VERIFICATION
  STATUS (#.0907) field in the PATIENT (#2) file.  The text that was being
  sent had changed since the original coding occurred, which could result
  in the wrong value being updated.  RGADTP has been changed to use the
  coded value for updating the SSN VERFICATION STATUS (#.0907) field.
  Note: The SSN VERIFICATION STATUS (#.0907) field in the PATIENT file
  (#2) will be added in the future by patch DG*5.3*688, distributed by
  the Enrollment VistA Changes (EVC) project.
  
  Issue #8
  When the MPI sends the Pseudo SSN Reason field in the ZPD segment, the
  code to update the fields in the PATIENT (#2) file does not have a value
  for the PSEUDO SSN REASON (#.0906) field, so it is not getting updated.
  Routine RGADTP2 has been modified so that the PSEUDO SSN REASON (#.0906)
  field is populated when appropriate.
  Note: The PSEUDO SSN REASON (#.0906) field in the PATIENT file (#2) will
  be added in the future by patch DG*5.3*653, distributed by the Enrollment
  VistA Changes (EVC) project.
   
  Issue #9
  The introductory text and option description for the Patient MPI/PD
  Data Inquiry [RG EXCEPTION TF INQUIRY] option have been updated.  This
  change is in routine RGEX01.
   
  Issue #10
  If the MPI/PD Exception Purge [RG EXCEPTION PURGE] errors out for
  any reason (e.g. missing cross-reference), the EXC PURGE STATUS (#42)
  field in the CIRN SITE PARAMETER (#991.8) file (which is set to
  'RUNNING') was not being cleaned up.  Code was added to routine
  RGEX01 to delete the obsolete status.  This check occurs when the
  user enters the MPI/PD Exception Handling [RG EXCEPTION HANDLING]
  option.
   
  Issue #11
  Remedy Tickets HD0000000186288 and HD0000000186334:
  These errors occurred because an inbound message that the Master Patient
  Index (MPI) is forwarding to the Coordinating Master of Record (CMOR)
  is trying to process the new HL7 messaging PV2 segment but the RGADTP
  processing routine is trying to call that subroutine as if it is an API
  instead of just a line tag.  This has been corrected in routine RGADTP.
   
  Associated Remedy Tickets:
  ==========================
  HD0000000186288
  HD0000000186334
   
  Associated New Service Request (NSR):
  =====================================
  There is no associated NSR with the patch.
   
  Test Sites:
  ===========
  Augusta, GA
  Charleston, SC
  Salisbury, NC
  Upstate New York HCS
     
  Routine Summary:
  ================
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
   
  <TAB>;;1.0;CLINICAL INFO RESOURCE NETWORK;**[Patch List]**;30 Apr 99
  
  Using old logic: CHECK^XTSUMBLD results
  Routine       Before Patch       After Patch       Patch List
  --------      ------------       ------------      ----------
  RGADTP          20373944           19956893        26,27,20,34,35,40,
                                                     45,44,47
  RGADTP1         13959974           14435912        26,27,42,45,44,47
  RGADTP2         16485645           21664023        27,20,45,44,47
  RGEX01           9579416            9532749        3,12,19,23,43,45,47
  RGPVREJ          7114638            8025574        44,47
       
  PLEASE NOTE:
  ============
  Routine VAFCSB will be released in a future patch - DG*5.3*707.
  Routine RGADTP references routine VAFCSB.  XINDEX may display:
  "Reference to routine '^VAFCSB'. That isn't in this UCI."
   
  The references to VAFCSB from within routine RGADTP contain conditional
  %ZOSF("TEST") checks for the existence of the routine and quit if it is
  not there.  So, the code is not dependent on DG*5.3*707 and will work
  with or without that patch being present.
    
  Installation Instructions:
  ==========================
  This patch may be loaded with users on the system.  It should be
  installed during non-peak hours to minimize disruption to the
  users.  Installation will take less than 2 minutes.
   
  1.  Users are allowed on the system during patch installation.
     
  2.  Use the INSTALL/CHECK MESSAGE option on the Packman menu.
      Note:  TEXT PRINT/DISPLAY option in the PackMan menu will
      display the patch text only.
     
  3.  From the Kernel Installation and Distribution System Menu, select
      the Installation menu.
   
  4.  From this menu, you may elect to use the following options:
      (a)  Backup a Transport Global.
      (b)  Compare Transport Global to Current System.
      (c)  Verify Checksums in Transport Global.
      (d)  Print Transport Global.
   
  5.  Use the Install Package(s) option and select the package RG*1.0*47.
   
  6.  When prompted 'Want KIDS to Rebuild Menu Trees Upon Completion of
      Install? YES//', respond YES.
   
  7.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? YES//',
      respond NO.
   
  8.  When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
      Protocols? YES//', respond YES.  The following OPTION should be
      disabled during the installation.
           MPI/PD Exception Handling [RG EXCEPTION HANDLING]
           Patient MPI/PD Data Inquiry [RG EXCEPTION TF INQUIRY]

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: RGADTP
    Before: B77946765  After: B77748334  **26,27,20,34,35,40,45,44,47**
Routine Name: RGADTP1
    Before: B31035462  After: B32629728  **26,27,42,45,44,47**
Routine Name: RGADTP2
    Before: B42653247  After: B68268271  **27,20,45,44,47**
Routine Name: RGEX01
    Before: B32784010  After: B33945025  **3,12,19,23,43,45,47**
Routine Name: RGPVREJ
    Before: B14664495  After: B16898530  **44,47**

=============================================================================
User Information:
Entered By  : DAVIS,PAULETTE                Date Entered  : FEB 07, 2007
Completed By: ALDERMAN,MATT S               Date Completed: MAY 14, 2007
Released By : HEUER,CINDY                   Date Released : MAY 14, 2007
=============================================================================


Packman Mail Message:
=====================

$END TXT
