Released XM*8*36 SEQ #36
Extracted from mail message
**KIDS**:XM*8.0*36^

**INSTALL NAME**
XM*8.0*36
"BLD",5931,0)
XM*8.0*36^MAILMAN^0^3060309^y
"BLD",5931,1,0)
^^1^1^3060228^^
"BLD",5931,1,1,0)
Allow a non-human user to send bulletins.
"BLD",5931,4,0)
^9.64PA^^
"BLD",5931,"ABPKG")
n
"BLD",5931,"KRN",0)
^9.67PA^8989.52^19
"BLD",5931,"KRN",.4,0)
.4
"BLD",5931,"KRN",.401,0)
.401
"BLD",5931,"KRN",.402,0)
.402
"BLD",5931,"KRN",.403,0)
.403
"BLD",5931,"KRN",.5,0)
.5
"BLD",5931,"KRN",.84,0)
.84
"BLD",5931,"KRN",3.6,0)
3.6
"BLD",5931,"KRN",3.8,0)
3.8
"BLD",5931,"KRN",9.2,0)
9.2
"BLD",5931,"KRN",9.8,0)
9.8
"BLD",5931,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",5931,"KRN",9.8,"NM",1,0)
XMXPARM1^^0^B10873939
"BLD",5931,"KRN",9.8,"NM",2,0)
XMVVITAE^^0^B50266073
"BLD",5931,"KRN",9.8,"NM","B","XMVVITAE",2)

"BLD",5931,"KRN",9.8,"NM","B","XMXPARM1",1)

"BLD",5931,"KRN",19,0)
19
"BLD",5931,"KRN",19.1,0)
19.1
"BLD",5931,"KRN",101,0)
101
"BLD",5931,"KRN",409.61,0)
409.61
"BLD",5931,"KRN",771,0)
771
"BLD",5931,"KRN",870,0)
870
"BLD",5931,"KRN",8989.51,0)
8989.51
"BLD",5931,"KRN",8989.52,0)
8989.52
"BLD",5931,"KRN",8994,0)
8994
"BLD",5931,"KRN","B",.4,.4)

"BLD",5931,"KRN","B",.401,.401)

"BLD",5931,"KRN","B",.402,.402)

"BLD",5931,"KRN","B",.403,.403)

"BLD",5931,"KRN","B",.5,.5)

"BLD",5931,"KRN","B",.84,.84)

"BLD",5931,"KRN","B",3.6,3.6)

"BLD",5931,"KRN","B",3.8,3.8)

"BLD",5931,"KRN","B",9.2,9.2)

"BLD",5931,"KRN","B",9.8,9.8)

"BLD",5931,"KRN","B",19,19)

"BLD",5931,"KRN","B",19.1,19.1)

"BLD",5931,"KRN","B",101,101)

"BLD",5931,"KRN","B",409.61,409.61)

"BLD",5931,"KRN","B",771,771)

"BLD",5931,"KRN","B",870,870)

"BLD",5931,"KRN","B",8989.51,8989.51)

"BLD",5931,"KRN","B",8989.52,8989.52)

"BLD",5931,"KRN","B",8994,8994)

"BLD",5931,"QUES",0)
^9.62^^
"BLD",5931,"REQB",0)
^9.611^2^1
"BLD",5931,"REQB",2,0)
XU*8.0*361^2
"BLD",5931,"REQB","B","XU*8.0*361",2)

"MBREQ")
0
"PKG",54,-1)
1^1
"PKG",54,0)
MAILMAN^XM^Electronic Mail, both local and networked
"PKG",54,20,0)
^9.402P^^
"PKG",54,22,0)
^9.49I^1^1
"PKG",54,22,1,0)
8.0^3020815^3020827^2441
"PKG",54,22,1,"PAH",1,0)
36^3060309
"PKG",54,22,1,"PAH",1,1,0)
^^1^1^3060309
"PKG",54,22,1,"PAH",1,1,1,0)
Allow a non-human user to send bulletins.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","XMVVITAE")
0^2^B50266073^B48248055
"RTN","XMVVITAE",1,0)
XMVVITAE ;ISC-SF/GMB-Initialize User's MailMan Variables ;04/19/2002  13:26
"RTN","XMVVITAE",2,0)
 ;;8.0;MailMan;**36**;Jun 28, 2002
"RTN","XMVVITAE",3,0)
 ; Replaces ^XMGAPI1,FWD^XMA21,FWD,BANNER^XMA6,EDIT^XMA7 (ISC-WASH/CAP)
"RTN","XMVVITAE",4,0)
 ; Entry points (DBIA 2728):
"RTN","XMVVITAE",5,0)
 ; INIT     Set up variables for DUZ or XMDUZ.
"RTN","XMVVITAE",6,0)
 ; OTHER    Set up variables to become a surrogate of someone else.
"RTN","XMVVITAE",7,0)
 ; SELF     Return from being a surrogate to being oneself again.
"RTN","XMVVITAE",8,0)
 Q
"RTN","XMVVITAE",9,0)
INIT ; Set up one's variables (for yourself or as a surrogate).
"RTN","XMVVITAE",10,0)
 N XMAPI
"RTN","XMVVITAE",11,0)
INIT2 K XMV
"RTN","XMVVITAE",12,0)
 D SYSTEM(.XMV)
"RTN","XMVVITAE",13,0)
 S:'$D(XMDUZ) XMDUZ=DUZ
"RTN","XMVVITAE",14,0)
 D DUZ(DUZ,.XMV,.XMDUN,.XMDISPI,.XMNOSEND)
"RTN","XMVVITAE",15,0)
 D:XMDUZ'=DUZ SURROGAT(XMDUZ,.XMV,.XMDUN,.XMNOSEND,.XMPRIV)
"RTN","XMVVITAE",16,0)
 Q
"RTN","XMVVITAE",17,0)
INITAPI ; (For MailMan use only) Set up variables for an API call.
"RTN","XMVVITAE",18,0)
 N XMAPI
"RTN","XMVVITAE",19,0)
 S XMAPI=1 ; "last used MailMan" will not be recorded.
"RTN","XMVVITAE",20,0)
 G INIT2
"RTN","XMVVITAE",21,0)
CHECK ; Check to make sure one's variables exist.
"RTN","XMVVITAE",22,0)
 I '$D(XMV("NAME"))!'$D(XMV("RDR DEF")) D INIT
"RTN","XMVVITAE",23,0)
 Q
"RTN","XMVVITAE",24,0)
OTHER ; Become someone else.  INIT should have been called previously.
"RTN","XMVVITAE",25,0)
 I '$D(XMV) D INIT Q
"RTN","XMVVITAE",26,0)
 N XMAPI
"RTN","XMVVITAE",27,0)
 D SURROGAT(XMDUZ,.XMV,.XMDUN,.XMNOSEND,.XMPRIV)
"RTN","XMVVITAE",28,0)
 Q
"RTN","XMVVITAE",29,0)
SELF ; Return to oneself after having become someone else.
"RTN","XMVVITAE",30,0)
 ; INIT should have been called previously.
"RTN","XMVVITAE",31,0)
 S XMDUZ=DUZ
"RTN","XMVVITAE",32,0)
 I '$D(XMV) D INIT Q
"RTN","XMVVITAE",33,0)
 N XMAPI
"RTN","XMVVITAE",34,0)
 D USER(XMDUZ,.XMV,.XMNOSEND,.XMDUN)
"RTN","XMVVITAE",35,0)
 D LASTUSE(XMDUZ,.XMV)
"RTN","XMVVITAE",36,0)
 Q
"RTN","XMVVITAE",37,0)
SYSTEM(XMV) ;
"RTN","XMVVITAE",38,0)
 ; XMV("VERSION")
"RTN","XMVVITAE",39,0)
 I '$D(DT) D DT^DICRW
"RTN","XMVVITAE",40,0)
 S XMV("VERSION")="VA MailMan "_$P($T(XMVVITAE+1),";",3)
"RTN","XMVVITAE",41,0)
 ; Check to make sure that important variables are defined correctly.
"RTN","XMVVITAE",42,0)
 I +$G(^XMB("NUM")),$G(^XMB("NAME"))=$G(^XMB("NETNAME")),$G(^XMB("NETNAME"))=$P($G(^DIC(4.2,+$G(^XMB("NUM")),0)),U,1),$G(^XMB("NUM"))=$P($G(^XMB(1,1,0)),U,1) Q
"RTN","XMVVITAE",43,0)
 N XMPARM  ; The domain for this facility is not christened correctly.
"RTN","XMVVITAE",44,0)
 S XMPARM(1)=$G(^XMB("NUM"))
"RTN","XMVVITAE",45,0)
 S XMPARM(2)=$P($G(^XMB(1,1,0)),U,1)
"RTN","XMVVITAE",46,0)
 S XMPARM(3)=$P($G(^DIC(4.2,+$G(^XMB("NUM")),0)),U,1)
"RTN","XMVVITAE",47,0)
 S XMPARM(4)=$P($G(^DIC(4.2,+XMPARM(2),0)),U,1)
"RTN","XMVVITAE",48,0)
 S XMPARM(5)=$G(^XMB("NETNAME"))
"RTN","XMVVITAE",49,0)
 S XMPARM(6)=$G(^XMB("NAME"))
"RTN","XMVVITAE",50,0)
 F I=1:1:6 I XMPARM(I)="" S XMPARM(I)="?"
"RTN","XMVVITAE",51,0)
 ;The domain for this facility is not christened correctly.
"RTN","XMVVITAE",52,0)
 ;IRM must correct this for network mail to function properly.
"RTN","XMVVITAE",53,0)
 ;The following pointers should contain the same numbers,
"RTN","XMVVITAE",54,0)
 ;which should point to this facility's domain in ^DIC(4.2:
"RTN","XMVVITAE",55,0)
 ;^XMB("NUM")=|1|          ==> |3|
"RTN","XMVVITAE",56,0)
 ;$P(^XMB(1,1,0),U,1)=|2|  ==> |4|
"RTN","XMVVITAE",57,0)
 ;The following globals should contain the domain name of this facility:
"RTN","XMVVITAE",58,0)
 ;^XMB("NETNAME")=           |5|
"RTN","XMVVITAE",59,0)
 ;^XMB("NAME")=              |6|
"RTN","XMVVITAE",60,0)
 D BLD^DIALOG(38100,.XMPARM,"","XMV(""SYSERR"")")
"RTN","XMVVITAE",61,0)
 Q
"RTN","XMVVITAE",62,0)
DUZ(XMDUZ,XMV,XMDUN,XMDISPI,XMNOSEND) ;
"RTN","XMVVITAE",63,0)
 ; XMV("DUZ NAME")
"RTN","XMVVITAE",64,0)
 K XMV("ERROR")
"RTN","XMVVITAE",65,0)
 I $G(DUZ,0)=0 S XMV("ERROR",1)=$$EZBLD^DIALOG(38105) Q  ;You do not have a DUZ.
"RTN","XMVVITAE",66,0)
 D USER(XMDUZ,.XMV,.XMNOSEND,.XMDUN) Q:$D(XMV("ERROR"))
"RTN","XMVVITAE",67,0)
 S XMV("DUZ NAME")=XMV("NAME")
"RTN","XMVVITAE",68,0)
 D LASTUSE(XMDUZ,.XMV)
"RTN","XMVVITAE",69,0)
 D PREFER(XMDUZ,.XMV,.XMDISPI)
"RTN","XMVVITAE",70,0)
 Q
"RTN","XMVVITAE",71,0)
SURROGAT(XMDUZ,XMV,XMDUN,XMNOSEND,XMPRIV) ;
"RTN","XMVVITAE",72,0)
 ; XMV("PRIV")
"RTN","XMVVITAE",73,0)
 ; XMPRIV
"RTN","XMVVITAE",74,0)
 Q:XMDUZ=DUZ
"RTN","XMVVITAE",75,0)
 K XMV("ERROR"),XMV("WARNING")
"RTN","XMVVITAE",76,0)
 I XMDUZ=.6 D  Q
"RTN","XMVVITAE",77,0)
 . S XMV("PRIV")="R",XMPRIV="y^n"
"RTN","XMVVITAE",78,0)
 . S (XMDUN,XMV("NAME"))=$$NAME^XMXUTIL(.6)
"RTN","XMVVITAE",79,0)
 . D SETNET(XMDUZ,.XMV)
"RTN","XMVVITAE",80,0)
 . S XMV("NEW MSGS")=+$P(^XMB(3.7,XMDUZ,0),U,6)
"RTN","XMVVITAE",81,0)
 E  D  Q:$D(XMV("ERROR"))
"RTN","XMVVITAE",82,0)
 . N XMIEN
"RTN","XMVVITAE",83,0)
 . S XMIEN=+$O(^XMB(3.7,"AB",DUZ,XMDUZ,0))
"RTN","XMVVITAE",84,0)
 . ;Commented out because we shouldn't be here if not a valid surrogate
"RTN","XMVVITAE",85,0)
 . ;I 'XMIEN S XMV("ERROR",5)=$$EZBLD^DIALOG(38106,XMDUZ) Q  ;You are not a surrogate of DUZ |1|.
"RTN","XMVVITAE",86,0)
 . S XMPRIV=$G(^XMB(3.7,XMDUZ,9,XMIEN,0))
"RTN","XMVVITAE",87,0)
 . S XMV("PRIV")=$S($P(XMPRIV,U,2)="y":"R",1:"")_$S($P(XMPRIV,U,3)="y":"W",1:"")
"RTN","XMVVITAE",88,0)
 D USER(XMDUZ,.XMV,.XMNOSEND,.XMDUN) Q:$D(XMV("ERROR"))
"RTN","XMVVITAE",89,0)
 D LASTUSE(XMDUZ,.XMV)
"RTN","XMVVITAE",90,0)
 Q
"RTN","XMVVITAE",91,0)
USER(XMDUZ,XMV,XMNOSEND,XMDUN) ;
"RTN","XMVVITAE",92,0)
 ; XMV("WARNING")
"RTN","XMVVITAE",93,0)
 ; XMV("ERROR")
"RTN","XMVVITAE",94,0)
 ; XMV("NEW MSGS")
"RTN","XMVVITAE",95,0)
 ; XMV("NAME")
"RTN","XMVVITAE",96,0)
 ; XMV("NOSEND")
"RTN","XMVVITAE",97,0)
 ; XMNOSEND
"RTN","XMVVITAE",98,0)
 ; XMDUN
"RTN","XMVVITAE",99,0)
 N XMREC
"RTN","XMVVITAE",100,0)
 K XMV("ERROR"),XMV("WARNING")
"RTN","XMVVITAE",101,0)
 S XMREC=$G(^VA(200,XMDUZ,0))
"RTN","XMVVITAE",102,0)
 I XMREC="" S XMV("ERROR",2)=$$EZBLD^DIALOG(38107,XMDUZ) Q  ;There is no person with DUZ |1|.
"RTN","XMVVITAE",103,0)
 ;I $P(XMREC,U,3)="" S XMV("ERROR",3)=$$EZBLD^DIALOG(38108,XMDUZ) Q  ; There is no Access Code for DUZ XMDUZ
"RTN","XMVVITAE",104,0)
 I $P(XMREC,U,3)="",'$$USERTYPE^XUSAP(XMDUZ,"APPLICATION PROXY") S XMV("ERROR",3)=$$EZBLD^DIALOG(38108,XMDUZ) Q  ; There is no Access Code for DUZ XMDUZ
"RTN","XMVVITAE",105,0)
 ;I '$D(^XMB(3.7,XMDUZ,0)) S XMV("ERROR",4)=$$EZBLD^DIALOG(38109,XMDUZ) Q  ;There is no mailbox for DUZ |1|.
"RTN","XMVVITAE",106,0)
 I '$D(^XMB(3.7,XMDUZ,0)),'$$USERTYPE^XUSAP(XMDUZ,"APPLICATION PROXY") S XMV("ERROR",4)=$$EZBLD^DIALOG(38109,XMDUZ) Q  ;There is no mailbox for DUZ |1|.
"RTN","XMVVITAE",107,0)
 S XMV("NOSEND")=0
"RTN","XMVVITAE",108,0)
 S (XMDUN,XMV("NAME"))=$$NAME^XMXUTIL(XMDUZ)
"RTN","XMVVITAE",109,0)
 D SETNET(XMDUZ,.XMV)
"RTN","XMVVITAE",110,0)
 Q:$D(ZTQUEUED)!$G(XMAPI)
"RTN","XMVVITAE",111,0)
 I $D(^XTMP("XM","MAKENEW",XMDUZ)) D NEWAGAIN^XMJBN1(XMDUZ)
"RTN","XMVVITAE",112,0)
 I '$D(DUZ("SAV")),$D(XMMENU(0)) L +^XMB(3.7,"AD",DUZ):0 E  S (XMV("NOSEND"),XMNOSEND)=1,XMV("WARNING",4)=$$EZBLD^DIALOG(38110) ;Multiple Signon
"RTN","XMVVITAE",113,0)
 S:$D(^XMB(3.7,XMDUZ,"N")) XMV("WARNING",1)=$$EZBLD^DIALOG(38111) ;Priority Mail
"RTN","XMVVITAE",114,0)
 I '$D(DUZ("SAV")),'XMV("NOSEND"),$D(^XMB(3.7,"AD",XMDUZ)) D
"RTN","XMVVITAE",115,0)
 . I XMDUZ='DUZ,$G(XMV("PRIV"))'["W" Q
"RTN","XMVVITAE",116,0)
 . N XMZ
"RTN","XMVVITAE",117,0)
 . S XMREC=$G(^XMB(3.7,XMDUZ,"T"))
"RTN","XMVVITAE",118,0)
 . S XMZ=$P(XMREC,U,1) I XMZ="" K ^XMB(3.7,"AD",XMDUZ) Q
"RTN","XMVVITAE",119,0)
 . I '$D(^XMB(3.9,XMZ,0)) K ^XMB(3.7,XMDUZ,"T"),^XMB(3.7,"AD",XMDUZ) Q
"RTN","XMVVITAE",120,0)
 . S XMZ=$P(XMREC,U,3)
"RTN","XMVVITAE",121,0)
 . I XMZ,'$D(^XMB(3.9,XMZ,0)) K ^XMB(3.7,XMDUZ,"T"),^XMB(3.7,"AD",XMDUZ) Q
"RTN","XMVVITAE",122,0)
 . S XMV("WARNING",2)=$$EZBLD^DIALOG(38112) ;Message in Buffer
"RTN","XMVVITAE",123,0)
 S XMV("NEW MSGS")=+$P(^XMB(3.7,XMDUZ,0),U,6)
"RTN","XMVVITAE",124,0)
 I XMDUZ=.5 D
"RTN","XMVVITAE",125,0)
 . N I,XMK
"RTN","XMVVITAE",126,0)
 . S XMK=.99
"RTN","XMVVITAE",127,0)
 . F I=1:1 S XMK=$O(^XMB(3.7,.5,2,XMK)) Q:XMK>999!'XMK
"RTN","XMVVITAE",128,0)
 . S:I>900 XMV("WARNING",5)=$$EZBLD^DIALOG(38113,I) ;POSTMASTER has |1| baskets.
"RTN","XMVVITAE",129,0)
 D SETBAN(XMDUZ,.XMV)
"RTN","XMVVITAE",130,0)
 Q
"RTN","XMVVITAE",131,0)
SETNET(XMDUZ,XMV) ;
"RTN","XMVVITAE",132,0)
 ; XMV("NETNAME")
"RTN","XMVVITAE",133,0)
 S XMV("NETNAME")=$$NETNAME^XMXUTIL(XMDUZ)
"RTN","XMVVITAE",134,0)
 Q
"RTN","XMVVITAE",135,0)
SETBAN(XMDUZ,XMV) ;
"RTN","XMVVITAE",136,0)
 ; XMV("BANNER")
"RTN","XMVVITAE",137,0)
 N XMBANNER
"RTN","XMVVITAE",138,0)
 S XMBANNER=$G(^XMB(3.7,XMDUZ,"B"))
"RTN","XMVVITAE",139,0)
 I XMBANNER="" K XMV("BANNER")
"RTN","XMVVITAE",140,0)
 E  S XMV("BANNER")=XMBANNER
"RTN","XMVVITAE",141,0)
 Q
"RTN","XMVVITAE",142,0)
PREFER(XMDUZ,XMV,XMDISPI) ;
"RTN","XMVVITAE",143,0)
 ; XMV("SHOW INST")
"RTN","XMVVITAE",144,0)
 ; XMV("SHOW TITL")
"RTN","XMVVITAE",145,0)
 ; XMV("SHOW DUZ")
"RTN","XMVVITAE",146,0)
 ; XMV("ASK BSKT")
"RTN","XMVVITAE",147,0)
 ; XMV("MSG DEF")
"RTN","XMVVITAE",148,0)
 ; XMV("RDR DEF")
"RTN","XMVVITAE",149,0)
 ; XMV("RDR ASK")
"RTN","XMVVITAE",150,0)
 ; XMV("ORDER")
"RTN","XMVVITAE",151,0)
 ; XMV("PREVU")
"RTN","XMVVITAE",152,0)
 ; XMV("NEW OPT")
"RTN","XMVVITAE",153,0)
 ; XMV("NEW ORDER")
"RTN","XMVVITAE",154,0)
 ; XMDISPI
"RTN","XMVVITAE",155,0)
 N XMUREC,XMSREC
"RTN","XMVVITAE",156,0)
 S XMSREC=$G(^XMB(1,1,0)) ; Site's preferences
"RTN","XMVVITAE",157,0)
 ;S XMUREC=^XMB(3.7,DUZ,0) ; User's preferences
"RTN","XMVVITAE",158,0)
 S XMUREC=$G(^XMB(3.7,DUZ,0)) ; User's preferences
"RTN","XMVVITAE",159,0)
 S XMV("SHOW INST")=$S($P(XMSREC,U,5)["y":1,1:0)  ; Show Institution
"RTN","XMVVITAE",160,0)
 S XMV("SHOW TITL")=$S($P(XMUREC,U,10)=1:1,1:0)   ; Show Titles
"RTN","XMVVITAE",161,0)
 I XMV("SHOW TITL") S XMV("TITL SRC")=$S($P(XMSREC,U,11)'="":$P(XMSREC,U,11),1:"T") ; Title Source (Signature Block or Title)
"RTN","XMVVITAE",162,0)
 Q:$D(ZTQUEUED)
"RTN","XMVVITAE",163,0)
 S XMV("SHOW DUZ")=+$P(XMSREC,U,8)  ; Show DUZ when addressing messages
"RTN","XMVVITAE",164,0)
 S XMV("PREVU")=$S($P(XMUREC,U,4)="Y":1,1:0)
"RTN","XMVVITAE",165,0)
 S XMV("ASK BSKT")=$S($P(XMUREC,U,5)'["n":1,1:0)
"RTN","XMVVITAE",166,0)
 ; User's default message action (Delete, Ignore). If user doesn't have one, take site's.  If site doesn't have one, make it Ignore.
"RTN","XMVVITAE",167,0)
 S XMV("MSG DEF")=$S($P(XMUREC,U,9)'="":$P(XMUREC,U,9),$P(XMSREC,U,15)'="":$P(XMSREC,U,15),1:"I")
"RTN","XMVVITAE",168,0)
 S XMV("ORDER")=$S($P(XMUREC,U,13)="N":-1,1:1)
"RTN","XMVVITAE",169,0)
 S XMV("RDR DEF")=$S($P(XMUREC,U,16)'="":$P(XMUREC,U,16),1:"C")
"RTN","XMVVITAE",170,0)
 S XMV("RDR ASK")=$S($P(XMUREC,U,17)'="":$P(XMUREC,U,17),1:"Y")
"RTN","XMVVITAE",171,0)
 S XMV("NEW OPT")=$S($P(XMUREC,U,18)'="":$P(XMUREC,U,18),1:"R")
"RTN","XMVVITAE",172,0)
 S XMV("NEW ORDER")=$S($P(XMUREC,U,19)="N":-1,1:1)
"RTN","XMVVITAE",173,0)
 Q:$G(XMAPI)
"RTN","XMVVITAE",174,0)
 I $P(XMSREC,U,6)["y",'$D(^XMB(3.7,XMDUZ,1,1,0)) S XMV("WARNING",3)=$$EZBLD^DIALOG(38114) ;No Introduction
"RTN","XMVVITAE",175,0)
 S XMDISPI="X"  ; Show Help (Not used?)
"RTN","XMVVITAE",176,0)
 I XMV("SHOW INST") S XMDISPI=XMDISPI_"I"
"RTN","XMVVITAE",177,0)
 I XMV("SHOW TITL") S XMDISPI=XMDISPI_"T"
"RTN","XMVVITAE",178,0)
 I XMV("ASK BSKT") S XMDISPI=XMDISPI_"A"
"RTN","XMVVITAE",179,0)
 S XMDISPI=XMDISPI_U_XMV("MSG DEF")
"RTN","XMVVITAE",180,0)
 Q
"RTN","XMVVITAE",181,0)
LASTUSE(XMDUZ,XMV) ;
"RTN","XMVVITAE",182,0)
 ; XMV("LAST USE")
"RTN","XMVVITAE",183,0)
 I XMDUZ=.6!$D(ZTQUEUED)!$G(XMAPI) Q
"RTN","XMVVITAE",184,0)
 S XMV("LAST USE")=$P($G(^XMB(3.7,XMDUZ,"L"),$$EZBLD^DIALOG(38002)),U,1) ;Never
"RTN","XMVVITAE",185,0)
 Q:$D(DUZ("SAV"))
"RTN","XMVVITAE",186,0)
 S ^XMB(3.7,XMDUZ,"L")=$$MMDT^XMXUTIL1($$NOW^XLFDT)_$S(XMDUZ'=DUZ:$$EZBLD^DIALOG(38008,XMV("DUZ NAME")),1:"")_U_DT_U_DUZ ; (Surrogate: |1|)
"RTN","XMVVITAE",187,0)
 Q
"RTN","XMXPARM1")
0^1^B10873939^B10264070
"RTN","XMXPARM1",1,0)
XMXPARM1 ;ISC-SF/GMB-Parameter check (cont.) ;04/19/2002  12:14
"RTN","XMXPARM1",2,0)
 ;;8.0;MailMan;**36**;Jun 28, 2002
"RTN","XMXPARM1",3,0)
CHKUSER(XMDUZ,XMNOMBOX) ; Ascertain/verify user's DUZ, and make sure authorized to use MailMan
"RTN","XMXPARM1",4,0)
 ; XMNOMBOX Is it possible that this user does not have a mailbox?
"RTN","XMXPARM1",5,0)
 ;          0=no (default); 1=yes
"RTN","XMXPARM1",6,0)
 N XMSCREEN,XMUSER,XMADDR
"RTN","XMXPARM1",7,0)
 S XMADDR=XMDUZ
"RTN","XMXPARM1",8,0)
 S XMADDR=$$UP^XLFSTR(XMADDR)
"RTN","XMXPARM1",9,0)
 ;S:'$G(XMNOMBOX) XMSCREEN="I $L($P(^(0),U,3)),$D(^XMB(3.7,+Y,2))"  ; User must have an access code & mailbox
"RTN","XMXPARM1",10,0)
 I '$G(XMNOMBOX),'$$USERTYPE^XUSAP(XMDUZ,"APPLICATION PROXY") S XMSCREEN="I $L($P(^(0),U,3)),$D(^XMB(3.7,+Y,2))"  ; User must have an access code & mailbox
"RTN","XMXPARM1",11,0)
 ; "B^BB^C^D" = name^alias^initial^nickname
"RTN","XMXPARM1",12,0)
 S XMDUZ=$$FIND1^DIC(200,"","O",$S(+XMADDR=XMADDR:"`"_XMADDR,1:XMADDR),"B^BB^C^D",.XMSCREEN)
"RTN","XMXPARM1",13,0)
 Q:XMDUZ
"RTN","XMXPARM1",14,0)
 S XMDUZ=XMADDR
"RTN","XMXPARM1",15,0)
 D ERRSET^XMXUTIL($S($D(DIERR):39432,1:39433),XMDUZ) ; User '|1|' ambiguous / not found.
"RTN","XMXPARM1",16,0)
 Q
"RTN","XMXPARM1",17,0)
XMATTACH(XMATTACH) ; Validate attachments
"RTN","XMXPARM1",18,0)
 Q
"RTN","XMXPARM1",19,0)
XMBN(XMBN) ; Check bulletin name
"RTN","XMXPARM1",20,0)
 I $G(XMBN)="" D ERRSET^XMXUTIL(39430) Q  ; Bulletin name must be supplied.
"RTN","XMXPARM1",21,0)
 Q:$D(^XMB(3.6,"B",XMBN))
"RTN","XMXPARM1",22,0)
 D ERRSET^XMXUTIL(39431,XMBN) ; Bulletin '|1|' not found.
"RTN","XMXPARM1",23,0)
 Q
"RTN","XMXPARM1",24,0)
XMBODY(XMBODY,XMOPTNL) ; Check the body of the message (just make sure there is a body)
"RTN","XMXPARM1",25,0)
 I $G(XMBODY)="" D  Q
"RTN","XMXPARM1",26,0)
 . I '$G(XMOPTNL) D ERRSET^XMXUTIL(39405) ;Message must have a body.
"RTN","XMXPARM1",27,0)
 I $E(XMBODY,1,6)="XMBODY" D  Q
"RTN","XMXPARM1",28,0)
 . D ERRSET^XMXUTIL(39406) ;Message body may not be called XMBODY.
"RTN","XMXPARM1",29,0)
 I $D(@XMBODY)'>9 D  Q
"RTN","XMXPARM1",30,0)
 . D ERRSET^XMXUTIL(39407,XMBODY) ;Message body '|1|' has no data.
"RTN","XMXPARM1",31,0)
 Q
"RTN","XMXPARM1",32,0)
XMCODE(XMPARM,XMCODE,XMSET) ;
"RTN","XMXPARM1",33,0)
 Q:XMSET[(U_XMCODE_U)
"RTN","XMXPARM1",34,0)
 N XMP
"RTN","XMXPARM1",35,0)
 S XMP("PARAM","ID")=XMPARM
"RTN","XMXPARM1",36,0)
 S XMP("PARAM","VALUE")=XMCODE
"RTN","XMXPARM1",37,0)
 ;S XMP("PARAM","FILE")=3.901,XMP("PARAM","FIELD")=1.8
"RTN","XMXPARM1",38,0)
 S XMP(1)=XMSET
"RTN","XMXPARM1",39,0)
 D ERRSET^XMXUTIL(39438,.XMP) ; Must be one of |1|.
"RTN","XMXPARM1",40,0)
 Q
"RTN","XMXPARM1",41,0)
XMHINT(XMHINT) ; Validate a scramble hint
"RTN","XMXPARM1",42,0)
 I $G(XMHINT)="" Q
"RTN","XMXPARM1",43,0)
 ;I $G(XMHINT)="" D ERRSET^XMXUTIL(39436) Q  ; Scramble hint must be supplied
"RTN","XMXPARM1",44,0)
 ;D CHK^DIE(3.9,1.8,"H",XMHINT)
"RTN","XMXPARM1",45,0)
 I $L(XMHINT)>0,$L(XMHINT)<41,XMHINT'[U Q
"RTN","XMXPARM1",46,0)
 N XMP
"RTN","XMXPARM1",47,0)
 S XMP("PARAM","ID")="XMINSTR(""SCR HINT"")"
"RTN","XMXPARM1",48,0)
 S XMP("PARAM","VALUE")=XMHINT
"RTN","XMXPARM1",49,0)
 ;S XMP("PARAM","FILE")=3.901,XMP("PARAM","FIELD")=1.8
"RTN","XMXPARM1",50,0)
 S XMP(1)=1,XMP(2)=40
"RTN","XMXPARM1",51,0)
 D ERRSET^XMXUTIL(39437,.XMP) ; Must be |1|-|2| characters, no ^.
"RTN","XMXPARM1",52,0)
 Q
"RTN","XMXPARM1",53,0)
XMKEY(XMKEY) ; Validate a scramble key
"RTN","XMXPARM1",54,0)
 I $G(XMKEY)="" D ERRSET^XMXUTIL(39435) Q  ; Scramble key must be supplied.
"RTN","XMXPARM1",55,0)
 ;D CHK^DIE(3.9,1.85,"H",XMKEY)
"RTN","XMXPARM1",56,0)
 I $L(XMKEY)>2,$L(XMKEY)<21 Q
"RTN","XMXPARM1",57,0)
 N XMP
"RTN","XMXPARM1",58,0)
 S XMP("PARAM","ID")="XMINSTR(""SCR KEY"")"
"RTN","XMXPARM1",59,0)
 S XMP("PARAM","VALUE")=XMKEY
"RTN","XMXPARM1",60,0)
 ;S XMP("PARAM","FILE")=3.9,XMP("PARAM","FIELD")=1.85
"RTN","XMXPARM1",61,0)
 S XMP(1)=3,XMP(2)=20
"RTN","XMXPARM1",62,0)
 D ERRSET^XMXUTIL(39434,.XMP) ; Must be |1|-|2| characters.
"RTN","XMXPARM1",63,0)
 Q
"RTN","XMXPARM1",64,0)
XMKZ(XMK,XMKZ) ;
"RTN","XMXPARM1",65,0)
 I $G(XMKZ),$D(^XMB(3.7,XMDUZ,2,XMK,1,"C",XMKZ)) Q
"RTN","XMXPARM1",66,0)
 N XMP S XMP(1)=XMKZ,XMP(2)=XMK
"RTN","XMXPARM1",67,0)
 D ERRSET^XMXUTIL(34351,.XMP) ; message not found in basket
"RTN","XMXPARM1",68,0)
 Q
"RTN","XMXPARM1",69,0)
XMKZA(XMKZA) ; Check the message numbers (just make sure there is at least one)
"RTN","XMXPARM1",70,0)
 Q:$D(XMKZA)
"RTN","XMXPARM1",71,0)
 D ERRSET^XMXUTIL(39418) ;No message numbers.
"RTN","XMXPARM1",72,0)
 Q
"RTN","XMXPARM1",73,0)
XMROOT(XMPARM,XMROOT) ; Validate root
"RTN","XMXPARM1",74,0)
 Q
"RTN","XMXPARM1",75,0)
XMSTRIP(XMSTRIP) ; Validate a message strip string
"RTN","XMXPARM1",76,0)
 I $L(XMSTRIP)>0,$L(XMSTRIP)<21 Q
"RTN","XMXPARM1",77,0)
 N XMP
"RTN","XMXPARM1",78,0)
 S XMP("PARAM","ID")="XMINSTR(""STRIP"")"
"RTN","XMXPARM1",79,0)
 S XMP("PARAM","VALUE")=XMSTRIP
"RTN","XMXPARM1",80,0)
 S XMP(1)=1,XMP(2)=20
"RTN","XMXPARM1",81,0)
 D ERRSET^XMXUTIL(39434,.XMP) ; Must be |1|-|2| characters.
"RTN","XMXPARM1",82,0)
 Q
"RTN","XMXPARM1",83,0)
XMTO(XMTO,XMOPTNL) ; Check the addressees (just make sure there is at least one)
"RTN","XMXPARM1",84,0)
 Q:$D(XMTO)
"RTN","XMXPARM1",85,0)
 I $G(XMOPTNL),$$GOTADDR^XMXADDR Q
"RTN","XMXPARM1",86,0)
 D ERRSET^XMXUTIL(39408) ;No recipients
"RTN","XMXPARM1",87,0)
 Q
"VER")
8.0^22.0
"BLD",5931,6)
^36
**END**
**END**
