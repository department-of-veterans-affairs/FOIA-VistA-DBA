Released LR*5.2*343 SEQ #274
Extracted from mail message
**KIDS**:LR*5.2*343^

**INSTALL NAME**
LR*5.2*343
"BLD",5928,0)
LR*5.2*343^LAB SERVICE^0^3060620^y
"BLD",5928,1,0)
^^304^304^3060620^
"BLD",5928,1,1,0)
Blood Bank Team Coordination
"BLD",5928,1,2,0)
============================
"BLD",5928,1,3,0)
VISTA Laboratory Package patch LR*5.2*343 contains changes to software 
"BLD",5928,1,4,0)
controlled by VHA DIRECTIVE 2004-058, titled VISTA BLOOD BANK SOFTWARE. 
"BLD",5928,1,5,0)
Changes include: 
"BLD",5928,1,6,0)
 File #69.9 (Laboratory Site)
"BLD",5928,1,7,0)
    Field #150.3 (CANCEL ON ADMIT) - Removed
"BLD",5928,1,8,0)
    Field #150.4 (CANCEL ON DISCHARGE) - Removed
"BLD",5928,1,9,0)
    Field #150.5 (CANCEL ON SPECIALTY TRANSFER) - Removed
"BLD",5928,1,10,0)
 
"BLD",5928,1,11,0)
All of the above changes have been reviewed by the VISTA Blood Bank 
"BLD",5928,1,12,0)
Developer and found to have no impact on the VISTA BLOOD BANK SOFTWARE 
"BLD",5928,1,13,0)
control functions.
"BLD",5928,1,14,0)
 
"BLD",5928,1,15,0)
RISK ANALYSIS: Changes made by patch LR*5.2*343 have no effect on Blood 
"BLD",5928,1,16,0)
Bank software functionality, therefore RISK is none.
"BLD",5928,1,17,0)
 
"BLD",5928,1,18,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*343 does not 
"BLD",5928,1,19,0)
alter or modify any software design safeguards or safety critical 
"BLD",5928,1,20,0)
elements functions.
"BLD",5928,1,21,0)
 
"BLD",5928,1,22,0)
POTENTIAL IMPACT ON SITES: This patch contains changes to 0 routines and 
"BLD",5928,1,23,0)
1 file identified in Veterans Health Administration (VHA) Directive 
"BLD",5928,1,24,0)
2004-058, group B listing. The changes have no effect on Blood Bank 
"BLD",5928,1,25,0)
functionality or medical device control functions. There is no adverse 
"BLD",5928,1,26,0)
potential to sites.
"BLD",5928,1,27,0)
 
"BLD",5928,1,28,0)
VALIDATION REQUIREMENTS BY OPTION: 
"BLD",5928,1,29,0)
There are no validation requirements for this patch.
"BLD",5928,1,30,0)
 
"BLD",5928,1,31,0)
MINIMAL TEST CASE SCENARIOS BY OPTION, INCLUSIVE OF ALL CONTROL FUNCTIONS:
"BLD",5928,1,32,0)
There are no test case scenarios for this patch.
"BLD",5928,1,33,0)
************************************************************************
"BLD",5928,1,34,0)
 
"BLD",5928,1,35,0)
Remove the LABORATORY package's rules for managing laboratory order 
"BLD",5928,1,36,0)
auto-discontinuance on admission, transfer, or discharge events and let 
"BLD",5928,1,37,0)
the existing rules in the OERR (ORDER ENTRY RESULTS REPORTING) package 
"BLD",5928,1,38,0)
handle the order auto-discontinuance process.
"BLD",5928,1,39,0)
 
"BLD",5928,1,40,0)
The LABORATORY package's process that is used to decide if an order 
"BLD",5928,1,41,0)
should be discontinued when a patient move event is triggered will be 
"BLD",5928,1,42,0)
disabled.  This business rule is already being handled by the OERR 
"BLD",5928,1,43,0)
package and the Lab's business rules do not perform all of the needed 
"BLD",5928,1,44,0)
checks that the OERR package performs.  For example, the Lab's process 
"BLD",5928,1,45,0)
does not check that a new movement is actually tied to the current 
"BLD",5928,1,46,0)
admission.  An edit of a patient movement can result in erroneous auto 
"BLD",5928,1,47,0)
discontinue of a patient's laboratory orders.  OERR also provides checks 
"BLD",5928,1,48,0)
in the software to establish whether the patient event is new or an edit 
"BLD",5928,1,49,0)
to an existing event.
"BLD",5928,1,50,0)
 
"BLD",5928,1,51,0)
The Lab's process has caused erroneous auto discontinuance of laboratory 
"BLD",5928,1,52,0)
orders because it does not check if a new movement is actually tied to 
"BLD",5928,1,53,0)
the patient's current admission.  In the case outlined by the Patient 
"BLD",5928,1,54,0)
Safety Issue (PSI) report it appeared that a user deleted and re-entered 
"BLD",5928,1,55,0)
a movement for a prior admission to make a correction.  Since it was a 
"BLD",5928,1,56,0)
new movement the Lab code executed and the orders were discontinued.  
"BLD",5928,1,57,0)
This problem would especially impact sites with patients that are 
"BLD",5928,1,58,0)
transferred from the acute hospital to the nursing home.
"BLD",5928,1,59,0)
 
"BLD",5928,1,60,0)
 
"BLD",5928,1,61,0)
 
"BLD",5928,1,62,0)
Technical Description
"BLD",5928,1,63,0)
=====================
"BLD",5928,1,64,0)
When the DGPM MOVEMENT EVENTS of the PROTOCOL file (#101) is triggered 
"BLD",5928,1,65,0)
the LR7O MOVEMENT EVENT protocol may be called (if it is an item of the 
"BLD",5928,1,66,0)
DGPM MOVEMENT EVENTS protocol).  In this situation the business rule 
"BLD",5928,1,67,0)
processing in the LABORATORY package fails to make all of the needed 
"BLD",5928,1,68,0)
checks to properly determine if the order should be discontinued.  If 
"BLD",5928,1,69,0)
Lab's logic discontinues the order there will be no order for OERR to 
"BLD",5928,1,70,0)
apply its more detailed set of business rules against when the OERR code 
"BLD",5928,1,71,0)
is called from the patient movement event.
"BLD",5928,1,72,0)
 
"BLD",5928,1,73,0)
Lab will no longer perform any package-level checks for order 
"BLD",5928,1,74,0)
auto-discontinuance based on patient movements.  These checks will be 
"BLD",5928,1,75,0)
performed by the OERR package.  This change is accomplished by:
"BLD",5928,1,76,0)
 
"BLD",5928,1,77,0)
Deletion of PROTOCOL file (#101) entries:
"BLD",5928,1,78,0)
         LR7O MOVEMENT EVENT and LR7O MOVEMENT EVENT TASK
"BLD",5928,1,79,0)
Deletion of routine LR7OEVNT
"BLD",5928,1,80,0)
Deletion of the following Data Dictionary for LABORATORY SITE file 
"BLD",5928,1,81,0)
(#69.9):
"BLD",5928,1,82,0)
    CANCEL ON ADMIT field (#150.3)
"BLD",5928,1,83,0)
    CANCEL ON DISCHARGE field (#150.4)
"BLD",5928,1,84,0)
    CANCEL ON SPECIALTY TRANSFER field (#150.5)
"BLD",5928,1,85,0)
 
"BLD",5928,1,86,0)
 
"BLD",5928,1,87,0)
 
"BLD",5928,1,88,0)
New Service Request:
"BLD",5928,1,89,0)
====================
"BLD",5928,1,90,0)
#20050802 -- Remove Lab Package Options to DC Order on Patient Movement
"BLD",5928,1,91,0)
 
"BLD",5928,1,92,0)
 
"BLD",5928,1,93,0)
Associated Remedy:
"BLD",5928,1,94,0)
==================
"BLD",5928,1,95,0)
HD0000000104211
"BLD",5928,1,96,0)
 
"BLD",5928,1,97,0)
 
"BLD",5928,1,98,0)
Associated E3R:
"BLD",5928,1,99,0)
===============
"BLD",5928,1,100,0)
N/A
"BLD",5928,1,101,0)
 
"BLD",5928,1,102,0)
 
"BLD",5928,1,103,0)
Associated PSI:
"BLD",5928,1,104,0)
===============
"BLD",5928,1,105,0)
PSI-05-068 
"BLD",5928,1,106,0)
 
"BLD",5928,1,107,0)
 
"BLD",5928,1,108,0)
Test Sites
"BLD",5928,1,109,0)
==========
"BLD",5928,1,110,0)
DURHAM, NC -VAMC (Large site)
"BLD",5928,1,111,0)
NORTHERN CALIFORNIA HCS (Large site) 
"BLD",5928,1,112,0)
 
"BLD",5928,1,113,0)
 
"BLD",5928,1,114,0)
 
"BLD",5928,1,115,0)
ROUTINE SUMMARY
"BLD",5928,1,116,0)
===============
"BLD",5928,1,117,0)
  The following routines are included in this patch.  The second line
"BLD",5928,1,118,0)
  of each of these routines now looks like:
"BLD",5928,1,119,0)
      <tab> ;; 5.2;LAB SERVICE;<patch list>;Sep 27, 1994
"BLD",5928,1,120,0)
 
"BLD",5928,1,121,0)
                  Checksum       Checksum
"BLD",5928,1,122,0)
 Routine Name     Before Patch   After Patch    Patch List
"BLD",5928,1,123,0)
     LR343        N/A            12851791       343
"BLD",5928,1,124,0)
     LR7OEVNT     5021306        deleted by KIDS
"BLD",5928,1,125,0)
 
"BLD",5928,1,126,0)
     Routines deleted by KIDS: LR343,LR70EVNT
"BLD",5928,1,127,0)
     List of preceding patches: n/a
"BLD",5928,1,128,0)
     Sites should use CHECK^XTSUMBLD to verify checksums.
"BLD",5928,1,129,0)
 
"BLD",5928,1,130,0)
 
"BLD",5928,1,131,0)
PROTOCOLS
"BLD",5928,1,132,0)
    LR7O MOVEMENT EVENT  (deleted)
"BLD",5928,1,133,0)
    LR7O MOVEMENT EVENT TASK  (deleted)
"BLD",5928,1,134,0)
 
"BLD",5928,1,135,0)
 
"BLD",5928,1,136,0)
DATA DICTIONARIES
"BLD",5928,1,137,0)
    LABORATORY SITE file (#69.9)
"BLD",5928,1,138,0)
        CANCEL ON ADMIT field (#150.3)  (deleted)
"BLD",5928,1,139,0)
        CANCEL ON DISCHARGE field (#150.4)  (deleted)
"BLD",5928,1,140,0)
        CANCEL ON SPECIALTY TRANSFER field (#150.5)  (deleted)
"BLD",5928,1,141,0)
 
"BLD",5928,1,142,0)
 
"BLD",5928,1,143,0)
INSTALLATION INSTRUCTIONS
"BLD",5928,1,144,0)
=========================
"BLD",5928,1,145,0)
 
"BLD",5928,1,146,0)
  The install time for this patch is approximately 6 minutes.
"BLD",5928,1,147,0)
  Suggested time to install: non-peak requirement hours.
"BLD",5928,1,148,0)
  This patch can be installed when Laboratory users are on the system.
"BLD",5928,1,149,0)
 
"BLD",5928,1,150,0)
 
"BLD",5928,1,151,0)
                     I  M  P  O  R  T  A  N  T
"BLD",5928,1,152,0)
                   =============================
"BLD",5928,1,153,0)
                 THIS INSTALLATION MUST BE QUEUED
"BLD",5928,1,154,0)
 
"BLD",5928,1,155,0)
 
"BLD",5928,1,156,0)
  NOTE: Kernel patches must be current on the target system to avoid
"BLD",5928,1,157,0)
        problems loading and/or installing this patch.
"BLD",5928,1,158,0)
 
"BLD",5928,1,159,0)
      Patch installation needs to be coordinated with the Laboratory
"BLD",5928,1,160,0)
      Information Manager (LIM/ADPAC).
"BLD",5928,1,161,0)
 
"BLD",5928,1,162,0)
 
"BLD",5928,1,163,0)
  1.  Use the 'INSTALL/CHECK MESSAGE' option of the PackMan menu.  This
"BLD",5928,1,164,0)
      option will load the KIDS patch onto your system.
"BLD",5928,1,165,0)
 
"BLD",5928,1,166,0)
  2.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"BLD",5928,1,167,0)
      select the 'Installation' menu.
"BLD",5928,1,168,0)
 
"BLD",5928,1,169,0)
  3.  Use the 'Verify Checksum in Transport Global' option and verify
"BLD",5928,1,170,0)
      that all routines have the correct checksums.
"BLD",5928,1,171,0)
 
"BLD",5928,1,172,0)
  4.  On the KIDS menu, under the 'Installation' menu, use the following
"BLD",5928,1,173,0)
      options:
"BLD",5928,1,174,0)
        Print Transport Global
"BLD",5928,1,175,0)
        Compare Transport Global to Current System
"BLD",5928,1,176,0)
        Backup a Transport Global
"BLD",5928,1,177,0)
 
"BLD",5928,1,178,0)
  5.  Use the 'Install Package(s)' option under the 'Installation' menu
"BLD",5928,1,179,0)
      and select the package 'LR*5.2*343*'
"BLD",5928,1,180,0)
 
"BLD",5928,1,181,0)
      If prompted "Want KIDS to Rebuild Menu Trees Upon Completion of
"BLD",5928,1,182,0)
      Install?" choose "NO".  Note: Responding "Yes" to the prompt for
"BLD",5928,1,183,0)
      rebuilding menu trees can significantly increase install time.
"BLD",5928,1,184,0)
 
"BLD",5928,1,185,0)
      If prompted "Want KIDS to INHIBIT LOGONs during the install?"
"BLD",5928,1,186,0)
      choose "NO".
"BLD",5928,1,187,0)
 
"BLD",5928,1,188,0)
      If prompted "Want to DISABLE Scheduled Options, Menu Options, and
"BLD",5928,1,189,0)
      Protocols? YES//" choose "NO" unless the site has additional local
"BLD",5928,1,190,0)
      laboratory options that should be disabled during install.
"BLD",5928,1,191,0)
 
"BLD",5928,1,192,0)
  6.  When prompted for the DEVICE, enter "Q" to queue the build.  If you
"BLD",5928,1,193,0)
      do not queue the installation KIDS will abort the install.  When
"BLD",5928,1,194,0)
      you try to restart the install you may encounter an <UNDEF> error
"BLD",5928,1,195,0)
      due to a bug in KIDS.  If this happens you will need to use FileMan
"BLD",5928,1,196,0)
      to modify the INSTALL file (#9.7) for entry LR*5.2*343 which 
"BLD",5928,1,197,0)
      currently has the status of "Start of Install" and set its' STATUS 
"BLD",5928,1,198,0)
      field to "Install Completed".  Reload the transport global and 
"BLD",5928,1,199,0)
      install the patch again. 
"BLD",5928,1,200,0)
 
"BLD",5928,1,201,0)
  7.  Check your system for errors which may have occurred during the 
"BLD",5928,1,202,0)
      time this patch was installed.  If the PROTOCOL DGPM MOVEMENT 
"BLD",5928,1,203,0)
      EVENTS was called during this patch installation, system errors 
"BLD",5928,1,204,0)
      (such as "Can't return to source" for routine LR7OEVNT) may have 
"BLD",5928,1,205,0)
      been generated.  If so, those patient movements will have to be re-
"BLD",5928,1,206,0)
      created. 
"BLD",5928,1,207,0)
 
"BLD",5928,1,208,0)
 
"BLD",5928,1,209,0)
INSTALLATION EXAMPLE
"BLD",5928,1,210,0)
====================
"BLD",5928,1,211,0)
 
"BLD",5928,1,212,0)
Select Installation Option:  Install Package(s)
"BLD",5928,1,213,0)
Select INSTALL NAME:    LR*5.2*343     Loaded from Distribution  
"BLD",5928,1,214,0)
10/20/05@12:39:58
"BLD",5928,1,215,0)
     => LR343 KIDS  ;Created on Oct 20, 2005@11:59:59
"BLD",5928,1,216,0)
 
"BLD",5928,1,217,0)
This Distribution was loaded on Oct 20, 2005@12:39:58 with header of 
"BLD",5928,1,218,0)
   LR343 KIDS  ;Created on Oct 20, 2005@11:59:59
"BLD",5928,1,219,0)
   It consisted of the following Install(s):
"BLD",5928,1,220,0)
     LR*5.2*343
"BLD",5928,1,221,0)
Checking Install for Package LR*5.2*343
"BLD",5928,1,222,0)
Will first run the Environment Check Routine, LR343
"BLD",5928,1,223,0)
 
"BLD",5928,1,224,0)
                Environment is okay 
"BLD",5928,1,225,0)
 
"BLD",5928,1,226,0)
Install Questions for LR*5.2*343
"BLD",5928,1,227,0)
 
"BLD",5928,1,228,0)
Want KIDS to INHIBIT LOGONs during the install? NO// 
"BLD",5928,1,229,0)
 
"BLD",5928,1,230,0)
Enter the Device you want to print the Install messages.
"BLD",5928,1,231,0)
You can queue the install by enter a 'Q' at the device prompt.
"BLD",5928,1,232,0)
Enter a '^' to abort the install.
"BLD",5928,1,233,0)
 
"BLD",5928,1,234,0)
DEVICE: HOME// QUEUE TO PRINT ON
"BLD",5928,1,235,0)
DEVICE: HOME// P-MAIN
"BLD",5928,1,236,0)
 
"BLD",5928,1,237,0)
Request Start Time: Oct 20, 2005@12:42:41//   (OCT 20, 2005@12:42:41)
"BLD",5928,1,238,0)
Install Queued!
"BLD",5928,1,239,0)
 
"BLD",5928,1,240,0)
 
"BLD",5928,1,241,0)
 
"BLD",5928,1,242,0)
Sample Installation Output
"BLD",5928,1,243,0)
==========================
"BLD",5928,1,244,0)
 
"BLD",5928,1,245,0)
Install Started for LR*5.2*343 : 
"BLD",5928,1,246,0)
       Oct 20, 2005@12:42:42
"BLD",5928,1,247,0)
 
"BLD",5928,1,248,0)
Build Distribution Date: Oct 20, 2005
"BLD",5928,1,249,0)
 
"BLD",5928,1,250,0)
 Installing Routines:...
"BLD",5928,1,251,0)
       Oct 20, 2005@12:42:42
"BLD",5928,1,252,0)
 
"BLD",5928,1,253,0)
 Running Pre-Install Routine: PRE^LR343.
"BLD",5928,1,254,0)
 
"BLD",5928,1,255,0)
       Pre install started at Oct 20, 2005@12:42:42
"BLD",5928,1,256,0)
 
"BLD",5928,1,257,0)
      Sent install started alert to mail group G.LMI
"BLD",5928,1,258,0)
 
"BLD",5928,1,259,0)
      Setting DISABLE and ACTION fields for Protocols
"BLD",5928,1,260,0)
 
"BLD",5928,1,261,0)
            No actions required for pre install
"BLD",5928,1,262,0)
 
"BLD",5928,1,263,0)
      Pre install completed at Oct 20, 2005@12:47:42
"BLD",5928,1,264,0)
 
"BLD",5928,1,265,0)
 Installing PACKAGE COMPONENTS: 
"BLD",5928,1,266,0)
 
"BLD",5928,1,267,0)
 Installing PROTOCOL...
"BLD",5928,1,268,0)
               Oct 20, 2005@12:47:42
"BLD",5928,1,269,0)
 
"BLD",5928,1,270,0)
 Running Post-Install Routine: POST^LR343.
"BLD",5928,1,271,0)
 
"BLD",5928,1,272,0)
       Post install started at Oct 20, 2005@12:47:42
"BLD",5928,1,273,0)
 
"BLD",5928,1,274,0)
            File #69.9 field data update started
"BLD",5928,1,275,0)
 
"BLD",5928,1,276,0)
           File #69.9 field data deletion finished
"BLD",5928,1,277,0)
 
"BLD",5928,1,278,0)
  Post install completed at Oct 20, 2005@12:47:42
"BLD",5928,1,279,0)
 
"BLD",5928,1,280,0)
     Sending install completion alert to mail group G.LMI
"BLD",5928,1,281,0)
 
"BLD",5928,1,282,0)
 Updating Routine file......
"BLD",5928,1,283,0)
 
"BLD",5928,1,284,0)
 Updating KIDS files.......
"BLD",5928,1,285,0)
 
"BLD",5928,1,286,0)
 LR*5.2*343 Installed. 
"BLD",5928,1,287,0)
               Oct 20, 2005@12:47:42
"BLD",5928,1,288,0)
 
"BLD",5928,1,289,0)
 Install Message sent
"BLD",5928,1,290,0)
 
"BLD",5928,1,291,0)
 
"BLD",5928,1,292,0)
 
"BLD",5928,1,293,0)
Sample MailMan Message
"BLD",5928,1,294,0)
======================
"BLD",5928,1,295,0)
Pre install started at Oct 20, 2005@12:48:15
"BLD",5928,1,296,0)
Sent install started alert to mail group G.LMI
"BLD",5928,1,297,0)
Setting DISABLE and ACTION fields for Protocols
"BLD",5928,1,298,0)
No actions required for pre install
"BLD",5928,1,299,0)
Pre install completed at Oct 20, 2005@12:48:55
"BLD",5928,1,300,0)
Post install started at Oct 20, 2005@12:53:59
"BLD",5928,1,301,0)
File #69.9 field data update started
"BLD",5928,1,302,0)
File #69.9 field data deletion finished
"BLD",5928,1,303,0)
Post install completed at Oct 20, 2005@12:54:45
"BLD",5928,1,304,0)
Sending install completion alert to mail group G.LMI
"BLD",5928,4,0)
^9.64PA^^0
"BLD",5928,6.3)
1
"BLD",5928,"INI")
PRE^LR343
"BLD",5928,"INID")
y^y^y
"BLD",5928,"INIT")
POST^LR343
"BLD",5928,"KRN",0)
^9.67PA^8989.52^19
"BLD",5928,"KRN",.4,0)
.4
"BLD",5928,"KRN",.401,0)
.401
"BLD",5928,"KRN",.402,0)
.402
"BLD",5928,"KRN",.403,0)
.403
"BLD",5928,"KRN",.5,0)
.5
"BLD",5928,"KRN",.84,0)
.84
"BLD",5928,"KRN",3.6,0)
3.6
"BLD",5928,"KRN",3.8,0)
3.8
"BLD",5928,"KRN",9.2,0)
9.2
"BLD",5928,"KRN",9.8,0)
9.8
"BLD",5928,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5928,"KRN",9.8,"NM",1,0)
LR7OEVNT^^1^
"BLD",5928,"KRN",9.8,"NM","B","LR7OEVNT",1)

"BLD",5928,"KRN",19,0)
19
"BLD",5928,"KRN",19.1,0)
19.1
"BLD",5928,"KRN",101,0)
101
"BLD",5928,"KRN",101,"NM",0)
^9.68A^2^2
"BLD",5928,"KRN",101,"NM",1,0)
LR7O MOVEMENT EVENT^^1^
"BLD",5928,"KRN",101,"NM",2,0)
LR7O MOVEMENT EVENT TASK^^1^
"BLD",5928,"KRN",101,"NM","B","LR7O MOVEMENT EVENT",1)

"BLD",5928,"KRN",101,"NM","B","LR7O MOVEMENT EVENT TASK",2)

"BLD",5928,"KRN",409.61,0)
409.61
"BLD",5928,"KRN",771,0)
771
"BLD",5928,"KRN",870,0)
870
"BLD",5928,"KRN",8989.51,0)
8989.51
"BLD",5928,"KRN",8989.52,0)
8989.52
"BLD",5928,"KRN",8994,0)
8994
"BLD",5928,"KRN","B",.4,.4)

"BLD",5928,"KRN","B",.401,.401)

"BLD",5928,"KRN","B",.402,.402)

"BLD",5928,"KRN","B",.403,.403)

"BLD",5928,"KRN","B",.5,.5)

"BLD",5928,"KRN","B",.84,.84)

"BLD",5928,"KRN","B",3.6,3.6)

"BLD",5928,"KRN","B",3.8,3.8)

"BLD",5928,"KRN","B",9.2,9.2)

"BLD",5928,"KRN","B",9.8,9.8)

"BLD",5928,"KRN","B",19,19)

"BLD",5928,"KRN","B",19.1,19.1)

"BLD",5928,"KRN","B",101,101)

"BLD",5928,"KRN","B",409.61,409.61)

"BLD",5928,"KRN","B",771,771)

"BLD",5928,"KRN","B",870,870)

"BLD",5928,"KRN","B",8989.51,8989.51)

"BLD",5928,"KRN","B",8989.52,8989.52)

"BLD",5928,"KRN","B",8994,8994)

"BLD",5928,"PRE")
LR343
"BLD",5928,"QUES",0)
^9.62^^
"BLD",5928,"REQB",0)
^9.611^2^2
"BLD",5928,"REQB",1,0)
OR*3.0*142^2
"BLD",5928,"REQB",2,0)
OR*3.0*141^2
"BLD",5928,"REQB","B","OR*3.0*141",2)

"BLD",5928,"REQB","B","OR*3.0*142",1)

"INI")
PRE^LR343
"INIT")
POST^LR343
"KRN",101,5150,-1)
1^1
"KRN",101,5150,0)
LR7O MOVEMENT EVENT
"KRN",101,5151,-1)
1^2
"KRN",101,5151,0)
LR7O MOVEMENT EVENT TASK
"MBREQ")
0
"ORD",0,9.8)
9.8;;1;RTNF^XPDTA;RTNE^XPDTA
"ORD",0,9.8,0)
ROUTINE
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2941128
"PKG",26,22,1,"PAH",1,0)
343^3060620^6686
"PKG",26,22,1,"PAH",1,1,0)
^^304^304^3060620
"PKG",26,22,1,"PAH",1,1,1,0)
Blood Bank Team Coordination
"PKG",26,22,1,"PAH",1,1,2,0)
============================
"PKG",26,22,1,"PAH",1,1,3,0)
VISTA Laboratory Package patch LR*5.2*343 contains changes to software 
"PKG",26,22,1,"PAH",1,1,4,0)
controlled by VHA DIRECTIVE 2004-058, titled VISTA BLOOD BANK SOFTWARE. 
"PKG",26,22,1,"PAH",1,1,5,0)
Changes include: 
"PKG",26,22,1,"PAH",1,1,6,0)
 File #69.9 (Laboratory Site)
"PKG",26,22,1,"PAH",1,1,7,0)
    Field #150.3 (CANCEL ON ADMIT) - Removed
"PKG",26,22,1,"PAH",1,1,8,0)
    Field #150.4 (CANCEL ON DISCHARGE) - Removed
"PKG",26,22,1,"PAH",1,1,9,0)
    Field #150.5 (CANCEL ON SPECIALTY TRANSFER) - Removed
"PKG",26,22,1,"PAH",1,1,10,0)
 
"PKG",26,22,1,"PAH",1,1,11,0)
All of the above changes have been reviewed by the VISTA Blood Bank 
"PKG",26,22,1,"PAH",1,1,12,0)
Developer and found to have no impact on the VISTA BLOOD BANK SOFTWARE 
"PKG",26,22,1,"PAH",1,1,13,0)
control functions.
"PKG",26,22,1,"PAH",1,1,14,0)
 
"PKG",26,22,1,"PAH",1,1,15,0)
RISK ANALYSIS: Changes made by patch LR*5.2*343 have no effect on Blood 
"PKG",26,22,1,"PAH",1,1,16,0)
Bank software functionality, therefore RISK is none.
"PKG",26,22,1,"PAH",1,1,17,0)
 
"PKG",26,22,1,"PAH",1,1,18,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*343 does not 
"PKG",26,22,1,"PAH",1,1,19,0)
alter or modify any software design safeguards or safety critical 
"PKG",26,22,1,"PAH",1,1,20,0)
elements functions.
"PKG",26,22,1,"PAH",1,1,21,0)
 
"PKG",26,22,1,"PAH",1,1,22,0)
POTENTIAL IMPACT ON SITES: This patch contains changes to 0 routines and 
"PKG",26,22,1,"PAH",1,1,23,0)
1 file identified in Veterans Health Administration (VHA) Directive 
"PKG",26,22,1,"PAH",1,1,24,0)
2004-058, group B listing. The changes have no effect on Blood Bank 
"PKG",26,22,1,"PAH",1,1,25,0)
functionality or medical device control functions. There is no adverse 
"PKG",26,22,1,"PAH",1,1,26,0)
potential to sites.
"PKG",26,22,1,"PAH",1,1,27,0)
 
"PKG",26,22,1,"PAH",1,1,28,0)
VALIDATION REQUIREMENTS BY OPTION: 
"PKG",26,22,1,"PAH",1,1,29,0)
There are no validation requirements for this patch.
"PKG",26,22,1,"PAH",1,1,30,0)
 
"PKG",26,22,1,"PAH",1,1,31,0)
MINIMAL TEST CASE SCENARIOS BY OPTION, INCLUSIVE OF ALL CONTROL FUNCTIONS:
"PKG",26,22,1,"PAH",1,1,32,0)
There are no test case scenarios for this patch.
"PKG",26,22,1,"PAH",1,1,33,0)
************************************************************************
"PKG",26,22,1,"PAH",1,1,34,0)
 
"PKG",26,22,1,"PAH",1,1,35,0)
Remove the LABORATORY package's rules for managing laboratory order 
"PKG",26,22,1,"PAH",1,1,36,0)
auto-discontinuance on admission, transfer, or discharge events and let 
"PKG",26,22,1,"PAH",1,1,37,0)
the existing rules in the OERR (ORDER ENTRY RESULTS REPORTING) package 
"PKG",26,22,1,"PAH",1,1,38,0)
handle the order auto-discontinuance process.
"PKG",26,22,1,"PAH",1,1,39,0)
 
"PKG",26,22,1,"PAH",1,1,40,0)
The LABORATORY package's process that is used to decide if an order 
"PKG",26,22,1,"PAH",1,1,41,0)
should be discontinued when a patient move event is triggered will be 
"PKG",26,22,1,"PAH",1,1,42,0)
disabled.  This business rule is already being handled by the OERR 
"PKG",26,22,1,"PAH",1,1,43,0)
package and the Lab's business rules do not perform all of the needed 
"PKG",26,22,1,"PAH",1,1,44,0)
checks that the OERR package performs.  For example, the Lab's process 
"PKG",26,22,1,"PAH",1,1,45,0)
does not check that a new movement is actually tied to the current 
"PKG",26,22,1,"PAH",1,1,46,0)
admission.  An edit of a patient movement can result in erroneous auto 
"PKG",26,22,1,"PAH",1,1,47,0)
discontinue of a patient's laboratory orders.  OERR also provides checks 
"PKG",26,22,1,"PAH",1,1,48,0)
in the software to establish whether the patient event is new or an edit 
"PKG",26,22,1,"PAH",1,1,49,0)
to an existing event.
"PKG",26,22,1,"PAH",1,1,50,0)
 
"PKG",26,22,1,"PAH",1,1,51,0)
The Lab's process has caused erroneous auto discontinuance of laboratory 
"PKG",26,22,1,"PAH",1,1,52,0)
orders because it does not check if a new movement is actually tied to 
"PKG",26,22,1,"PAH",1,1,53,0)
the patient's current admission.  In the case outlined by the Patient 
"PKG",26,22,1,"PAH",1,1,54,0)
Safety Issue (PSI) report it appeared that a user deleted and re-entered 
"PKG",26,22,1,"PAH",1,1,55,0)
a movement for a prior admission to make a correction.  Since it was a 
"PKG",26,22,1,"PAH",1,1,56,0)
new movement the Lab code executed and the orders were discontinued.  
"PKG",26,22,1,"PAH",1,1,57,0)
This problem would especially impact sites with patients that are 
"PKG",26,22,1,"PAH",1,1,58,0)
transferred from the acute hospital to the nursing home.
"PKG",26,22,1,"PAH",1,1,59,0)
 
"PKG",26,22,1,"PAH",1,1,60,0)
 
"PKG",26,22,1,"PAH",1,1,61,0)
 
"PKG",26,22,1,"PAH",1,1,62,0)
Technical Description
"PKG",26,22,1,"PAH",1,1,63,0)
=====================
"PKG",26,22,1,"PAH",1,1,64,0)
When the DGPM MOVEMENT EVENTS of the PROTOCOL file (#101) is triggered 
"PKG",26,22,1,"PAH",1,1,65,0)
the LR7O MOVEMENT EVENT protocol may be called (if it is an item of the 
"PKG",26,22,1,"PAH",1,1,66,0)
DGPM MOVEMENT EVENTS protocol).  In this situation the business rule 
"PKG",26,22,1,"PAH",1,1,67,0)
processing in the LABORATORY package fails to make all of the needed 
"PKG",26,22,1,"PAH",1,1,68,0)
checks to properly determine if the order should be discontinued.  If 
"PKG",26,22,1,"PAH",1,1,69,0)
Lab's logic discontinues the order there will be no order for OERR to 
"PKG",26,22,1,"PAH",1,1,70,0)
apply its more detailed set of business rules against when the OERR code 
"PKG",26,22,1,"PAH",1,1,71,0)
is called from the patient movement event.
"PKG",26,22,1,"PAH",1,1,72,0)
 
"PKG",26,22,1,"PAH",1,1,73,0)
Lab will no longer perform any package-level checks for order 
"PKG",26,22,1,"PAH",1,1,74,0)
auto-discontinuance based on patient movements.  These checks will be 
"PKG",26,22,1,"PAH",1,1,75,0)
performed by the OERR package.  This change is accomplished by:
"PKG",26,22,1,"PAH",1,1,76,0)
 
"PKG",26,22,1,"PAH",1,1,77,0)
Deletion of PROTOCOL file (#101) entries:
"PKG",26,22,1,"PAH",1,1,78,0)
         LR7O MOVEMENT EVENT and LR7O MOVEMENT EVENT TASK
"PKG",26,22,1,"PAH",1,1,79,0)
Deletion of routine LR7OEVNT
"PKG",26,22,1,"PAH",1,1,80,0)
Deletion of the following Data Dictionary for LABORATORY SITE file 
"PKG",26,22,1,"PAH",1,1,81,0)
(#69.9):
"PKG",26,22,1,"PAH",1,1,82,0)
    CANCEL ON ADMIT field (#150.3)
"PKG",26,22,1,"PAH",1,1,83,0)
    CANCEL ON DISCHARGE field (#150.4)
"PKG",26,22,1,"PAH",1,1,84,0)
    CANCEL ON SPECIALTY TRANSFER field (#150.5)
"PKG",26,22,1,"PAH",1,1,85,0)
 
"PKG",26,22,1,"PAH",1,1,86,0)
 
"PKG",26,22,1,"PAH",1,1,87,0)
 
"PKG",26,22,1,"PAH",1,1,88,0)
New Service Request:
"PKG",26,22,1,"PAH",1,1,89,0)
====================
"PKG",26,22,1,"PAH",1,1,90,0)
#20050802 -- Remove Lab Package Options to DC Order on Patient Movement
"PKG",26,22,1,"PAH",1,1,91,0)
 
"PKG",26,22,1,"PAH",1,1,92,0)
 
"PKG",26,22,1,"PAH",1,1,93,0)
Associated Remedy:
"PKG",26,22,1,"PAH",1,1,94,0)
==================
"PKG",26,22,1,"PAH",1,1,95,0)
HD0000000104211
"PKG",26,22,1,"PAH",1,1,96,0)
 
"PKG",26,22,1,"PAH",1,1,97,0)
 
"PKG",26,22,1,"PAH",1,1,98,0)
Associated E3R:
"PKG",26,22,1,"PAH",1,1,99,0)
===============
"PKG",26,22,1,"PAH",1,1,100,0)
N/A
"PKG",26,22,1,"PAH",1,1,101,0)
 
"PKG",26,22,1,"PAH",1,1,102,0)
 
"PKG",26,22,1,"PAH",1,1,103,0)
Associated PSI:
"PKG",26,22,1,"PAH",1,1,104,0)
===============
"PKG",26,22,1,"PAH",1,1,105,0)
PSI-05-068 
"PKG",26,22,1,"PAH",1,1,106,0)
 
"PKG",26,22,1,"PAH",1,1,107,0)
 
"PKG",26,22,1,"PAH",1,1,108,0)
Test Sites
"PKG",26,22,1,"PAH",1,1,109,0)
==========
"PKG",26,22,1,"PAH",1,1,110,0)
DURHAM, NC -VAMC (Large site)
"PKG",26,22,1,"PAH",1,1,111,0)
NORTHERN CALIFORNIA HCS (Large site) 
"PKG",26,22,1,"PAH",1,1,112,0)
 
"PKG",26,22,1,"PAH",1,1,113,0)
 
"PKG",26,22,1,"PAH",1,1,114,0)
 
"PKG",26,22,1,"PAH",1,1,115,0)
ROUTINE SUMMARY
"PKG",26,22,1,"PAH",1,1,116,0)
===============
"PKG",26,22,1,"PAH",1,1,117,0)
  The following routines are included in this patch.  The second line
"PKG",26,22,1,"PAH",1,1,118,0)
  of each of these routines now looks like:
"PKG",26,22,1,"PAH",1,1,119,0)
      <tab> ;; 5.2;LAB SERVICE;<patch list>;Sep 27, 1994
"PKG",26,22,1,"PAH",1,1,120,0)
 
"PKG",26,22,1,"PAH",1,1,121,0)
                  Checksum       Checksum
"PKG",26,22,1,"PAH",1,1,122,0)
 Routine Name     Before Patch   After Patch    Patch List
"PKG",26,22,1,"PAH",1,1,123,0)
     LR343        N/A            12851791       343
"PKG",26,22,1,"PAH",1,1,124,0)
     LR7OEVNT     5021306        deleted by KIDS
"PKG",26,22,1,"PAH",1,1,125,0)
 
"PKG",26,22,1,"PAH",1,1,126,0)
     Routines deleted by KIDS: LR343,LR70EVNT
"PKG",26,22,1,"PAH",1,1,127,0)
     List of preceding patches: n/a
"PKG",26,22,1,"PAH",1,1,128,0)
     Sites should use CHECK^XTSUMBLD to verify checksums.
"PKG",26,22,1,"PAH",1,1,129,0)
 
"PKG",26,22,1,"PAH",1,1,130,0)
 
"PKG",26,22,1,"PAH",1,1,131,0)
PROTOCOLS
"PKG",26,22,1,"PAH",1,1,132,0)
    LR7O MOVEMENT EVENT  (deleted)
"PKG",26,22,1,"PAH",1,1,133,0)
    LR7O MOVEMENT EVENT TASK  (deleted)
"PKG",26,22,1,"PAH",1,1,134,0)
 
"PKG",26,22,1,"PAH",1,1,135,0)
 
"PKG",26,22,1,"PAH",1,1,136,0)
DATA DICTIONARIES
"PKG",26,22,1,"PAH",1,1,137,0)
    LABORATORY SITE file (#69.9)
"PKG",26,22,1,"PAH",1,1,138,0)
        CANCEL ON ADMIT field (#150.3)  (deleted)
"PKG",26,22,1,"PAH",1,1,139,0)
        CANCEL ON DISCHARGE field (#150.4)  (deleted)
"PKG",26,22,1,"PAH",1,1,140,0)
        CANCEL ON SPECIALTY TRANSFER field (#150.5)  (deleted)
"PKG",26,22,1,"PAH",1,1,141,0)
 
"PKG",26,22,1,"PAH",1,1,142,0)
 
"PKG",26,22,1,"PAH",1,1,143,0)
INSTALLATION INSTRUCTIONS
"PKG",26,22,1,"PAH",1,1,144,0)
=========================
"PKG",26,22,1,"PAH",1,1,145,0)
 
"PKG",26,22,1,"PAH",1,1,146,0)
  The install time for this patch is approximately 6 minutes.
"PKG",26,22,1,"PAH",1,1,147,0)
  Suggested time to install: non-peak requirement hours.
"PKG",26,22,1,"PAH",1,1,148,0)
  This patch can be installed when Laboratory users are on the system.
"PKG",26,22,1,"PAH",1,1,149,0)
 
"PKG",26,22,1,"PAH",1,1,150,0)
 
"PKG",26,22,1,"PAH",1,1,151,0)
                     I  M  P  O  R  T  A  N  T
"PKG",26,22,1,"PAH",1,1,152,0)
                   =============================
"PKG",26,22,1,"PAH",1,1,153,0)
                 THIS INSTALLATION MUST BE QUEUED
"PKG",26,22,1,"PAH",1,1,154,0)
 
"PKG",26,22,1,"PAH",1,1,155,0)
 
"PKG",26,22,1,"PAH",1,1,156,0)
  NOTE: Kernel patches must be current on the target system to avoid
"PKG",26,22,1,"PAH",1,1,157,0)
        problems loading and/or installing this patch.
"PKG",26,22,1,"PAH",1,1,158,0)
 
"PKG",26,22,1,"PAH",1,1,159,0)
      Patch installation needs to be coordinated with the Laboratory
"PKG",26,22,1,"PAH",1,1,160,0)
      Information Manager (LIM/ADPAC).
"PKG",26,22,1,"PAH",1,1,161,0)
 
"PKG",26,22,1,"PAH",1,1,162,0)
 
"PKG",26,22,1,"PAH",1,1,163,0)
  1.  Use the 'INSTALL/CHECK MESSAGE' option of the PackMan menu.  This
"PKG",26,22,1,"PAH",1,1,164,0)
      option will load the KIDS patch onto your system.
"PKG",26,22,1,"PAH",1,1,165,0)
 
"PKG",26,22,1,"PAH",1,1,166,0)
  2.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"PKG",26,22,1,"PAH",1,1,167,0)
      select the 'Installation' menu.
"PKG",26,22,1,"PAH",1,1,168,0)
 
"PKG",26,22,1,"PAH",1,1,169,0)
  3.  Use the 'Verify Checksum in Transport Global' option and verify
"PKG",26,22,1,"PAH",1,1,170,0)
      that all routines have the correct checksums.
"PKG",26,22,1,"PAH",1,1,171,0)
 
"PKG",26,22,1,"PAH",1,1,172,0)
  4.  On the KIDS menu, under the 'Installation' menu, use the following
"PKG",26,22,1,"PAH",1,1,173,0)
      options:
"PKG",26,22,1,"PAH",1,1,174,0)
        Print Transport Global
"PKG",26,22,1,"PAH",1,1,175,0)
        Compare Transport Global to Current System
"PKG",26,22,1,"PAH",1,1,176,0)
        Backup a Transport Global
"PKG",26,22,1,"PAH",1,1,177,0)
 
"PKG",26,22,1,"PAH",1,1,178,0)
  5.  Use the 'Install Package(s)' option under the 'Installation' menu
"PKG",26,22,1,"PAH",1,1,179,0)
      and select the package 'LR*5.2*343*'
"PKG",26,22,1,"PAH",1,1,180,0)
 
"PKG",26,22,1,"PAH",1,1,181,0)
      If prompted "Want KIDS to Rebuild Menu Trees Upon Completion of
"PKG",26,22,1,"PAH",1,1,182,0)
      Install?" choose "NO".  Note: Responding "Yes" to the prompt for
"PKG",26,22,1,"PAH",1,1,183,0)
      rebuilding menu trees can significantly increase install time.
"PKG",26,22,1,"PAH",1,1,184,0)
 
"PKG",26,22,1,"PAH",1,1,185,0)
      If prompted "Want KIDS to INHIBIT LOGONs during the install?"
"PKG",26,22,1,"PAH",1,1,186,0)
      choose "NO".
"PKG",26,22,1,"PAH",1,1,187,0)
 
"PKG",26,22,1,"PAH",1,1,188,0)
      If prompted "Want to DISABLE Scheduled Options, Menu Options, and
"PKG",26,22,1,"PAH",1,1,189,0)
      Protocols? YES//" choose "NO" unless the site has additional local
"PKG",26,22,1,"PAH",1,1,190,0)
      laboratory options that should be disabled during install.
"PKG",26,22,1,"PAH",1,1,191,0)
 
"PKG",26,22,1,"PAH",1,1,192,0)
  6.  When prompted for the DEVICE, enter "Q" to queue the build.  If you
"PKG",26,22,1,"PAH",1,1,193,0)
      do not queue the installation KIDS will abort the install.  When
"PKG",26,22,1,"PAH",1,1,194,0)
      you try to restart the install you may encounter an <UNDEF> error
"PKG",26,22,1,"PAH",1,1,195,0)
      due to a bug in KIDS.  If this happens you will need to use FileMan
"PKG",26,22,1,"PAH",1,1,196,0)
      to modify the INSTALL file (#9.7) for entry LR*5.2*343 which 
"PKG",26,22,1,"PAH",1,1,197,0)
      currently has the status of "Start of Install" and set its' STATUS 
"PKG",26,22,1,"PAH",1,1,198,0)
      field to "Install Completed".  Reload the transport global and 
"PKG",26,22,1,"PAH",1,1,199,0)
      install the patch again. 
"PKG",26,22,1,"PAH",1,1,200,0)
 
"PKG",26,22,1,"PAH",1,1,201,0)
  7.  Check your system for errors which may have occurred during the 
"PKG",26,22,1,"PAH",1,1,202,0)
      time this patch was installed.  If the PROTOCOL DGPM MOVEMENT 
"PKG",26,22,1,"PAH",1,1,203,0)
      EVENTS was called during this patch installation, system errors 
"PKG",26,22,1,"PAH",1,1,204,0)
      (such as "Can't return to source" for routine LR7OEVNT) may have 
"PKG",26,22,1,"PAH",1,1,205,0)
      been generated.  If so, those patient movements will have to be re-
"PKG",26,22,1,"PAH",1,1,206,0)
      created. 
"PKG",26,22,1,"PAH",1,1,207,0)
 
"PKG",26,22,1,"PAH",1,1,208,0)
 
"PKG",26,22,1,"PAH",1,1,209,0)
INSTALLATION EXAMPLE
"PKG",26,22,1,"PAH",1,1,210,0)
====================
"PKG",26,22,1,"PAH",1,1,211,0)
 
"PKG",26,22,1,"PAH",1,1,212,0)
Select Installation Option:  Install Package(s)
"PKG",26,22,1,"PAH",1,1,213,0)
Select INSTALL NAME:    LR*5.2*343     Loaded from Distribution  
"PKG",26,22,1,"PAH",1,1,214,0)
10/20/05@12:39:58
"PKG",26,22,1,"PAH",1,1,215,0)
     => LR343 KIDS  ;Created on Oct 20, 2005@11:59:59
"PKG",26,22,1,"PAH",1,1,216,0)
 
"PKG",26,22,1,"PAH",1,1,217,0)
This Distribution was loaded on Oct 20, 2005@12:39:58 with header of 
"PKG",26,22,1,"PAH",1,1,218,0)
   LR343 KIDS  ;Created on Oct 20, 2005@11:59:59
"PKG",26,22,1,"PAH",1,1,219,0)
   It consisted of the following Install(s):
"PKG",26,22,1,"PAH",1,1,220,0)
     LR*5.2*343
"PKG",26,22,1,"PAH",1,1,221,0)
Checking Install for Package LR*5.2*343
"PKG",26,22,1,"PAH",1,1,222,0)
Will first run the Environment Check Routine, LR343
"PKG",26,22,1,"PAH",1,1,223,0)
 
"PKG",26,22,1,"PAH",1,1,224,0)
                Environment is okay 
"PKG",26,22,1,"PAH",1,1,225,0)
 
"PKG",26,22,1,"PAH",1,1,226,0)
Install Questions for LR*5.2*343
"PKG",26,22,1,"PAH",1,1,227,0)
 
"PKG",26,22,1,"PAH",1,1,228,0)
Want KIDS to INHIBIT LOGONs during the install? NO// 
"PKG",26,22,1,"PAH",1,1,229,0)
 
"PKG",26,22,1,"PAH",1,1,230,0)
Enter the Device you want to print the Install messages.
"PKG",26,22,1,"PAH",1,1,231,0)
You can queue the install by enter a 'Q' at the device prompt.
"PKG",26,22,1,"PAH",1,1,232,0)
Enter a '^' to abort the install.
"PKG",26,22,1,"PAH",1,1,233,0)
 
"PKG",26,22,1,"PAH",1,1,234,0)
DEVICE: HOME// QUEUE TO PRINT ON
"PKG",26,22,1,"PAH",1,1,235,0)
DEVICE: HOME// P-MAIN
"PKG",26,22,1,"PAH",1,1,236,0)
 
"PKG",26,22,1,"PAH",1,1,237,0)
Request Start Time: Oct 20, 2005@12:42:41//   (OCT 20, 2005@12:42:41)
"PKG",26,22,1,"PAH",1,1,238,0)
Install Queued!
"PKG",26,22,1,"PAH",1,1,239,0)
 
"PKG",26,22,1,"PAH",1,1,240,0)
 
"PKG",26,22,1,"PAH",1,1,241,0)
 
"PKG",26,22,1,"PAH",1,1,242,0)
Sample Installation Output
"PKG",26,22,1,"PAH",1,1,243,0)
==========================
"PKG",26,22,1,"PAH",1,1,244,0)
 
"PKG",26,22,1,"PAH",1,1,245,0)
Install Started for LR*5.2*343 : 
"PKG",26,22,1,"PAH",1,1,246,0)
       Oct 20, 2005@12:42:42
"PKG",26,22,1,"PAH",1,1,247,0)
 
"PKG",26,22,1,"PAH",1,1,248,0)
Build Distribution Date: Oct 20, 2005
"PKG",26,22,1,"PAH",1,1,249,0)
 
"PKG",26,22,1,"PAH",1,1,250,0)
 Installing Routines:...
"PKG",26,22,1,"PAH",1,1,251,0)
       Oct 20, 2005@12:42:42
"PKG",26,22,1,"PAH",1,1,252,0)
 
"PKG",26,22,1,"PAH",1,1,253,0)
 Running Pre-Install Routine: PRE^LR343.
"PKG",26,22,1,"PAH",1,1,254,0)
 
"PKG",26,22,1,"PAH",1,1,255,0)
       Pre install started at Oct 20, 2005@12:42:42
"PKG",26,22,1,"PAH",1,1,256,0)
 
"PKG",26,22,1,"PAH",1,1,257,0)
      Sent install started alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,258,0)
 
"PKG",26,22,1,"PAH",1,1,259,0)
      Setting DISABLE and ACTION fields for Protocols
"PKG",26,22,1,"PAH",1,1,260,0)
 
"PKG",26,22,1,"PAH",1,1,261,0)
            No actions required for pre install
"PKG",26,22,1,"PAH",1,1,262,0)
 
"PKG",26,22,1,"PAH",1,1,263,0)
      Pre install completed at Oct 20, 2005@12:47:42
"PKG",26,22,1,"PAH",1,1,264,0)
 
"PKG",26,22,1,"PAH",1,1,265,0)
 Installing PACKAGE COMPONENTS: 
"PKG",26,22,1,"PAH",1,1,266,0)
 
"PKG",26,22,1,"PAH",1,1,267,0)
 Installing PROTOCOL...
"PKG",26,22,1,"PAH",1,1,268,0)
               Oct 20, 2005@12:47:42
"PKG",26,22,1,"PAH",1,1,269,0)
 
"PKG",26,22,1,"PAH",1,1,270,0)
 Running Post-Install Routine: POST^LR343.
"PKG",26,22,1,"PAH",1,1,271,0)
 
"PKG",26,22,1,"PAH",1,1,272,0)
       Post install started at Oct 20, 2005@12:47:42
"PKG",26,22,1,"PAH",1,1,273,0)
 
"PKG",26,22,1,"PAH",1,1,274,0)
            File #69.9 field data update started
"PKG",26,22,1,"PAH",1,1,275,0)
 
"PKG",26,22,1,"PAH",1,1,276,0)
           File #69.9 field data deletion finished
"PKG",26,22,1,"PAH",1,1,277,0)
 
"PKG",26,22,1,"PAH",1,1,278,0)
  Post install completed at Oct 20, 2005@12:47:42
"PKG",26,22,1,"PAH",1,1,279,0)
 
"PKG",26,22,1,"PAH",1,1,280,0)
     Sending install completion alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,281,0)
 
"PKG",26,22,1,"PAH",1,1,282,0)
 Updating Routine file......
"PKG",26,22,1,"PAH",1,1,283,0)
 
"PKG",26,22,1,"PAH",1,1,284,0)
 Updating KIDS files.......
"PKG",26,22,1,"PAH",1,1,285,0)
 
"PKG",26,22,1,"PAH",1,1,286,0)
 LR*5.2*343 Installed. 
"PKG",26,22,1,"PAH",1,1,287,0)
               Oct 20, 2005@12:47:42
"PKG",26,22,1,"PAH",1,1,288,0)
 
"PKG",26,22,1,"PAH",1,1,289,0)
 Install Message sent
"PKG",26,22,1,"PAH",1,1,290,0)
 
"PKG",26,22,1,"PAH",1,1,291,0)
 
"PKG",26,22,1,"PAH",1,1,292,0)
 
"PKG",26,22,1,"PAH",1,1,293,0)
Sample MailMan Message
"PKG",26,22,1,"PAH",1,1,294,0)
======================
"PKG",26,22,1,"PAH",1,1,295,0)
Pre install started at Oct 20, 2005@12:48:15
"PKG",26,22,1,"PAH",1,1,296,0)
Sent install started alert to mail group G.LMI
"PKG",26,22,1,"PAH",1,1,297,0)
Setting DISABLE and ACTION fields for Protocols
"PKG",26,22,1,"PAH",1,1,298,0)
No actions required for pre install
"PKG",26,22,1,"PAH",1,1,299,0)
Pre install completed at Oct 20, 2005@12:48:55
"PKG",26,22,1,"PAH",1,1,300,0)
Post install started at Oct 20, 2005@12:53:59
"PKG",26,22,1,"PAH",1,1,301,0)
File #69.9 field data update started
"PKG",26,22,1,"PAH",1,1,302,0)
File #69.9 field data deletion finished
"PKG",26,22,1,"PAH",1,1,303,0)
Post install completed at Oct 20, 2005@12:54:45
"PKG",26,22,1,"PAH",1,1,304,0)
Sending install completion alert to mail group G.LMI
"PRE")
LR343
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","LR343")
0^^B57547450^n/a
"RTN","LR343",1,0)
LR343 ;DALOI/JDB - LR*5.2*343 KIDS ROUTINE
"RTN","LR343",2,0)
 ;;5.2;LAB SERVICE;**343**;Sep 27, 1994;Build 1
"RTN","LR343",3,0)
 ;
"RTN","LR343",4,0)
 ; Send email if #69.9 fields set to Yes
"RTN","LR343",5,0)
 ; Set LR7O MOVEMENT EVENT protocols DISABLE and ACTION fields
"RTN","LR343",6,0)
 ; Pause X minutes so any running protocols can clear
"RTN","LR343",7,0)
 ; KIDS deletes LR7OEVNT routine
"RTN","LR343",8,0)
 ; KIDS deletes LR7O MOVEMENT EVENT protocols
"RTN","LR343",9,0)
 ; Delete data from #69.9 fields
"RTN","LR343",10,0)
 ; Delete #69.9 fields DD
"RTN","LR343",11,0)
 ; 
"RTN","LR343",12,0)
 ; 
"RTN","LR343",13,0)
EN ;
"RTN","LR343",14,0)
 ; Environment Check
"RTN","LR343",15,0)
 ; Does not prevent loading of the transport global.
"RTN","LR343",16,0)
 ;
"RTN","LR343",17,0)
 D CLEAN
"RTN","LR343",18,0)
 D CHECK
"RTN","LR343",19,0)
 I $G(XPDQUIT) D  Q  ;
"RTN","LR343",20,0)
 . W !,$$CJ^XLFSTR("Environment check failed",$G(IOM,80))
"RTN","LR343",21,0)
 ;
"RTN","LR343",22,0)
 W !,$$CJ^XLFSTR("Environment is okay",$G(IOM,80))
"RTN","LR343",23,0)
 D ALERT("Installation of patch "_$G(XPDNM,"Unknown patch")_" started on "_$$HTE^XLFDT($H))
"RTN","LR343",24,0)
 I '$G(XPDENV) D  Q
"RTN","LR343",25,0)
 . D ALERT("Transport global for patch "_$G(XPDNM,"Unknown patch")_" loaded on "_$$HTE^XLFDT($H))
"RTN","LR343",26,0)
 . D MSGADD("Sending transport global loaded alert to mail group G.LMI")
"RTN","LR343",27,0)
 Q
"RTN","LR343",28,0)
 ;
"RTN","LR343",29,0)
CHECK ;
"RTN","LR343",30,0)
 ; Perform environment check
"RTN","LR343",31,0)
 N POP
"RTN","LR343",32,0)
 ; Is Home device defined
"RTN","LR343",33,0)
 ; Need Home device so "task install" option is displayed
"RTN","LR343",34,0)
 S POP=0 S IOP="",%ZIS=0 D ^%ZIS
"RTN","LR343",35,0)
 I POP D  Q
"RTN","LR343",36,0)
 . S XPDQUIT=2
"RTN","LR343",37,0)
 . W !,$$CJ^XLFSTR("*** Home device is not defined ***",$G(IOM,80))
"RTN","LR343",38,0)
 ;
"RTN","LR343",39,0)
 ; Device Defined
"RTN","LR343",40,0)
 I $S('$G(IOM):1,'$G(IOSL):1,$G(U)'="^":1,1:0) D  Q
"RTN","LR343",41,0)
 . W !,$$CJ^XLFSTR("*** Terminal Device is not defined ***",$G(IOM,80))
"RTN","LR343",42,0)
 . S XPDQUIT=2
"RTN","LR343",43,0)
 ;
"RTN","LR343",44,0)
 ; DUZ setup
"RTN","LR343",45,0)
 I $S('$G(DUZ):1,$D(DUZ)[0:1,$D(DUZ(0))[0:1,1:0) D  Q
"RTN","LR343",46,0)
 . W !,$$CJ^XLFSTR("*** Please log in to set variables ***",$G(IOM,80))
"RTN","LR343",47,0)
 . S XPDQUIT=2
"RTN","LR343",48,0)
 ;
"RTN","LR343",49,0)
 ; Active User
"RTN","LR343",50,0)
 I $P($$ACTIVE^XUSER(DUZ),"^")'=1 D  Q
"RTN","LR343",51,0)
 . W !,$$CJ^XLFSTR("*** You are not a valid user on this system ***",$G(IOM,80))
"RTN","LR343",52,0)
 . S XPDQUIT=2
"RTN","LR343",53,0)
 ;
"RTN","LR343",54,0)
 ; KIDS default answer to "Disable Protocols...."
"RTN","LR343",55,0)
 S XPDDIQ("XPZ1")=0  ;;Dont allow disabling options
"RTN","LR343",56,0)
 S XPDDIQ("XPZ1","B")="NO"
"RTN","LR343",57,0)
 Q
"RTN","LR343",58,0)
 ;
"RTN","LR343",59,0)
PRE ;
"RTN","LR343",60,0)
 ; KIDS Pre Install
"RTN","LR343",61,0)
 ; Check that install was tasked
"RTN","LR343",62,0)
 ; Check if any File #69.9 fields are set to "YES" If so send
"RTN","LR343",63,0)
 ; notification email.
"RTN","LR343",64,0)
 ; Disable Lab Protocols (set DISABLED field and set ACTION to Q)
"RTN","LR343",65,0)
 ; Hang so current processes started by protocols can end
"RTN","LR343",66,0)
 N IEN,ERR,PREERR,RECIPS,BODY,VALS,STR
"RTN","LR343",67,0)
 S PREERR=0
"RTN","LR343",68,0)
 D MSGADD("Pre install started at "_$$HTE^XLFDT($H))
"RTN","LR343",69,0)
 ;
"RTN","LR343",70,0)
 ; Was install tasked? Quit if not
"RTN","LR343",71,0)
 I '$D(ZTQUEUED) I $G(IO("Q"))="" D  Q
"RTN","LR343",72,0)
 . S XPDQUIT=2
"RTN","LR343",73,0)
 . S XPDABORT=2
"RTN","LR343",74,0)
 . D MSGADD("***  THIS INSTALLATION MUST BE TASKED  ***")
"RTN","LR343",75,0)
 . D MSGADD("",0)
"RTN","LR343",76,0)
 . D MSGADD("Refer to the Patch Installation instructions",0)
"RTN","LR343",77,0)
 . D MSGADD("for details concerning re-running the install.",0)
"RTN","LR343",78,0)
 . D CLEAN
"RTN","LR343",79,0)
 ;
"RTN","LR343",80,0)
 ; check DD field values and send email if any are YES
"RTN","LR343",81,0)
 S VALS=$$GETVALS()
"RTN","LR343",82,0)
 I VALS>0 D  ;
"RTN","LR343",83,0)
 . S STR="File #69.9 LABORATORY SITE has one or more fields that were set to YES."
"RTN","LR343",84,0)
 . D BLDBODY(STR,.BODY)
"RTN","LR343",85,0)
 . S STR="    #150.3  CANCEL ON ADMIT set to "_$S($E(VALS,1,1):"YES",1:"NO")
"RTN","LR343",86,0)
 . D BLDBODY(STR,.BODY)
"RTN","LR343",87,0)
 . S STR="    #150.4  CANCEL ON DISCHARGE set to "_$S($E(VALS,2,2):"YES",1:"NO")
"RTN","LR343",88,0)
 . D BLDBODY(STR,.BODY)
"RTN","LR343",89,0)
 . S STR="    #150.5  CANCEL ON SPECIALTY set to "_$S($E(VALS,3,3):"YES",1:"NO")
"RTN","LR343",90,0)
 . D BLDBODY(STR,.BODY)
"RTN","LR343",91,0)
 . D BLDBODY(" ",.BODY)
"RTN","LR343",92,0)
 . S STR="One or more DC fields of File #69.9 are set to Yes. These fields should have been set to No according to guidelines issued with the release of OR*3*142 and OR*3*141."
"RTN","LR343",93,0)
 . S STR=STR_"  Facilities would be advised to use the functionality provided in file #100.6 (released with OR*3*142) to maintain the ability to auto discontinue laboratory orders upon a patient movement."
"RTN","LR343",94,0)
 . S STR=STR_"  Please check your configurations to ensure that this migration has occurred."
"RTN","LR343",95,0)
 . D BLDBODY(STR,.BODY)
"RTN","LR343",96,0)
 . S RECIPS(DUZ)=""
"RTN","LR343",97,0)
 . S RECIPS("G.LMI")=""
"RTN","LR343",98,0)
 . D EMAIL("LR*5.2*343 -- 69.9 DC Fields","BODY",.RECIPS)
"RTN","LR343",99,0)
 . K BODY
"RTN","LR343",100,0)
 . D MSGADD("***  File #69.9 field(s) set to YES  ***")
"RTN","LR343",101,0)
 ;
"RTN","LR343",102,0)
 D ALERT("LR*5.2*343 Installation has started")
"RTN","LR343",103,0)
 D MSGADD("Sent install started alert to mail group G.LMI")
"RTN","LR343",104,0)
 ;
"RTN","LR343",105,0)
 ; Disable Protocols and set action event to quit
"RTN","LR343",106,0)
 D MSGADD("Setting DISABLE and ACTION fields for Protocols")
"RTN","LR343",107,0)
 S IEN=$$FIND1^DIC(101,,"XO","LR7O MOVEMENT EVENT","B",,"ERR")
"RTN","LR343",108,0)
 I IEN D UPDTPROT(IEN)
"RTN","LR343",109,0)
 I 'IEN D MSGADD("***  Did not find LR7O MOVEMENT EVENT PROTOCOL  ***")
"RTN","LR343",110,0)
 S IEN=$$FIND1^DIC(101,,"XO","LR7O MOVEMENT EVENT TASK","B",,"ERR")
"RTN","LR343",111,0)
 I IEN D UPDTPROT(IEN)
"RTN","LR343",112,0)
 I 'IEN D MSGADD("***  Did not find LR7O MOVEMENT EVENT TASK PROTOCOL  ***")
"RTN","LR343",113,0)
 ;
"RTN","LR343",114,0)
 ; Now hang for X minutes to let all existing triggered
"RTN","LR343",115,0)
 ; events to clear so we don't cause any "cant return to source"
"RTN","LR343",116,0)
 ; errors when we overwrite the protocl's routine which would
"RTN","LR343",117,0)
 ; cause the other chained events not to be processed (the hang is
"RTN","LR343",118,0)
 ; why the install is tasked and not run in direct mode)
"RTN","LR343",119,0)
 H 300
"RTN","LR343",120,0)
 ;
"RTN","LR343",121,0)
 I 'PREERR D MSGADD("No actions required for pre install")
"RTN","LR343",122,0)
 D MSGADD("Pre install completed at "_$$HTE^XLFDT($H))
"RTN","LR343",123,0)
 Q
"RTN","LR343",124,0)
 ;
"RTN","LR343",125,0)
POST ;
"RTN","LR343",126,0)
 ; KIDS Post Install
"RTN","LR343",127,0)
 ; Delete data in File #69.9 fields
"RTN","LR343",128,0)
 ; Remove #69.9 fields from Data Dictionary
"RTN","LR343",129,0)
 ; Email installation progress message
"RTN","LR343",130,0)
 N DA,DIK,LRFDA,LRMSG,LRMSG2,POSTERR,RECIPS
"RTN","LR343",131,0)
 S POSTERR=0
"RTN","LR343",132,0)
 D MSGADD("Post install started at "_$$HTE^XLFDT($H))
"RTN","LR343",133,0)
 D MSGADD("File #69.9 field data update started")
"RTN","LR343",134,0)
 ; delete #69.9 field data
"RTN","LR343",135,0)
 S LRFDA(1,69.9,"1,",150.3)="@"
"RTN","LR343",136,0)
 S LRFDA(1,69.9,"1,",150.4)="@"
"RTN","LR343",137,0)
 S LRFDA(1,69.9,"1,",150.5)="@"
"RTN","LR343",138,0)
 K MSG
"RTN","LR343",139,0)
 D FILE^DIE("","LRFDA(1)","LRMSG")
"RTN","LR343",140,0)
 I $D(LRMSG) D  ;
"RTN","LR343",141,0)
 . K LRMSG2
"RTN","LR343",142,0)
 . D MSG^DIALOG("ASEM",.LRMSG2,$G(IOM,80),,"LRMSG")
"RTN","LR343",143,0)
 . S POSTERR=1
"RTN","LR343",144,0)
 . D MSGADD(.LRMSG2)
"RTN","LR343",145,0)
 D KILLDD(150.3)
"RTN","LR343",146,0)
 D KILLDD(150.4)
"RTN","LR343",147,0)
 D KILLDD(150.5)
"RTN","LR343",148,0)
 D MSGADD("File #69.9 field data deletion finished")
"RTN","LR343",149,0)
 D MSGADD("Post install completed"_$S(POSTERR:" with errors",1:"")_" at "_$$HTE^XLFDT($H))
"RTN","LR343",150,0)
 D MSGADD("Sending install completion alert to mail group G.LMI")
"RTN","LR343",151,0)
 ; Send alert
"RTN","LR343",152,0)
 D ALERT("Installation of patch "_$G(XPDNM,"Unknown patch")_" completed on "_$$HTE^XLFDT($H)_$S(POSTERR:" with errors",1:""))
"RTN","LR343",153,0)
 S RECIPS(DUZ)=""
"RTN","LR343",154,0)
 D EMAIL("INSTALL COMPLETED:"_$G(XPDNM),"^TMP(""LR343"","_$J_",""MSG"")",.RECIPS)
"RTN","LR343",155,0)
 D CLEAN
"RTN","LR343",156,0)
 Q
"RTN","LR343",157,0)
 ;
"RTN","LR343",158,0)
ALERT(MSG) ;
"RTN","LR343",159,0)
 N DA,DIK,XQA,XQAMSG
"RTN","LR343",160,0)
 S MSG=$G(MSG)
"RTN","LR343",161,0)
 S XQAMSG=MSG
"RTN","LR343",162,0)
 S XQA("G.LMI")=""
"RTN","LR343",163,0)
 D SETUP^XQALERT
"RTN","LR343",164,0)
 Q
"RTN","LR343",165,0)
 ;
"RTN","LR343",166,0)
EMAIL(SUB,LRTXT,LRADDR) ;
"RTN","LR343",167,0)
 ; Sends an email message via MailMan using installer's DUZ
"RTN","LR343",168,0)
 ;    SUB <byval>   Subject for the message
"RTN","LR343",169,0)
 ;  LRTXT <byval>   Closed root local or global array
"RTN","LR343",170,0)
 ;              ie local array TEXT(1) passed as "TEXT"
"RTN","LR343",171,0)
 ; LRADDR <byref>   MailMan compatable array of message recipients
"RTN","LR343",172,0)
 N XMERR,XMZ,DIFROM
"RTN","LR343",173,0)
 D SENDMSG^XMXAPI($G(DUZ),$G(SUB),$G(LRTXT),.LRADDR)
"RTN","LR343",174,0)
 Q $G(XMZ,-1)
"RTN","LR343",175,0)
 ;
"RTN","LR343",176,0)
BLDBODY(STR,ARR) ;
"RTN","LR343",177,0)
 ; Adds a string to the end of the passed array
"RTN","LR343",178,0)
 ; Useful for building email message bodies
"RTN","LR343",179,0)
 ; STR <req>    The string to add to the array
"RTN","LR343",180,0)
 ; ARR <byref>  The array. Should be a simple, integer
"RTN","LR343",181,0)
 ;              based subscript array ie X(1), X(2), etc.
"RTN","LR343",182,0)
 N SUB
"RTN","LR343",183,0)
 S STR=$G(STR)
"RTN","LR343",184,0)
 S SUB=+$O(ARR("A"),-1)
"RTN","LR343",185,0)
 S ARR(SUB+1)=STR
"RTN","LR343",186,0)
 Q
"RTN","LR343",187,0)
 ;
"RTN","LR343",188,0)
GETVALS(NULL) ;
"RTN","LR343",189,0)
 ; Returns the values for #69.9 fields 150.3,150.4,150.5
"RTN","LR343",190,0)
 ; as a string  ie 000  or 010 etc (each field is only 1 or 0)
"RTN","LR343",191,0)
 N NODE,LRDATA,LRERR,VALUES
"RTN","LR343",192,0)
 S VALUES=""
"RTN","LR343",193,0)
 D GETS^DIQ(69.9,"1,","150.3;150.4;150.5","I","LRDATA","LRERR")
"RTN","LR343",194,0)
 I $D(LRDATA(69.9))>9 D  ;
"RTN","LR343",195,0)
 . S NODE="LRDATA(69.9)"
"RTN","LR343",196,0)
 .  F  S NODE=$Q(@NODE) Q:NODE=""  Q:$QS(NODE,1)'=69.9  S VALUES=VALUES_+@NODE
"RTN","LR343",197,0)
 Q VALUES
"RTN","LR343",198,0)
 ;
"RTN","LR343",199,0)
UPDTPROT(IEN) ;
"RTN","LR343",200,0)
 ; Sets the PROTOCOL's (#101) DISABLE field (#2) to DISABLED
"RTN","LR343",201,0)
 ; and its ENTRY ACTION field (#20) to Q (QUIT)
"RTN","LR343",202,0)
 N LRFDA,LRMSG
"RTN","LR343",203,0)
 S IEN=$G(IEN)
"RTN","LR343",204,0)
 S LRFDA(1,101,IEN_",",2)="DISABLED BY LR*5.2*343"
"RTN","LR343",205,0)
 S LRFDA(1,101,IEN_",",20)="Q"
"RTN","LR343",206,0)
 D FILE^DIE("ET","LRFDA(1)","LRMSG")
"RTN","LR343",207,0)
 Q
"RTN","LR343",208,0)
 ;
"RTN","LR343",209,0)
MSGADD(TXT,LB) ;
"RTN","LR343",210,0)
 ; Utility to create a message global to save install
"RTN","LR343",211,0)
 ; messages and send later, usually via mailman.  Useful
"RTN","LR343",212,0)
 ; when an install is tasked.  It will print
"RTN","LR343",213,0)
 ; the messages out as they come in, as well as save them
"RTN","LR343",214,0)
 ; to the TMP global
"RTN","LR343",215,0)
 ; Input
"RTN","LR343",216,0)
 ; TXT <byref or byval>
"RTN","LR343",217,0)
 ;         If $D(TXT)=1 then TXT is saved
"RTN","LR343",218,0)
 ;         If $D(TXT)>9 then step through array and save each node 
"RTN","LR343",219,0)
 ;         as separate line.
"RTN","LR343",220,0)
 ;  LB <opt>   LineBreak  (True then uses MBES -- False uses MES)
"RTN","LR343",221,0)
 ;
"RTN","LR343",222,0)
 ; TXT <byref> is used by-ref when passsing in arrays created by
"RTN","LR343",223,0)
 ; the FileMan MSG^DIALOG output array
"RTN","LR343",224,0)
 ;
"RTN","LR343",225,0)
 N NODE,SUB,POS
"RTN","LR343",226,0)
 S TXT=$G(TXT)
"RTN","LR343",227,0)
 S LB=$G(LB)
"RTN","LR343",228,0)
 I LB="" S LB=1
"RTN","LR343",229,0)
 S LB=+LB
"RTN","LR343",230,0)
 S SUB=+$O(^TMP("LR343",$J,"MSG","A"),-1)
"RTN","LR343",231,0)
 I $D(TXT)>9 D  ;
"RTN","LR343",232,0)
 . S NODE="TXT"
"RTN","LR343",233,0)
 . F  S NODE=$Q(@NODE) Q:NODE=""  D  ;
"RTN","LR343",234,0)
 . . S ^TMP("LR343",$J,"MSG",SUB+1)=@NODE
"RTN","LR343",235,0)
 . . S SUB=SUB+1
"RTN","LR343",236,0)
 . . I $D(XPDENV) I LB D BMES^XPDUTL($$CJ^XLFSTR(@NODE,$G(IOM,80)))
"RTN","LR343",237,0)
 . . I $D(XPDENV) I 'LB D MES^XPDUTL($$CJ^XLFSTR(@NODE,$G(IOM,80)))
"RTN","LR343",238,0)
 . . I '$D(XPDENV) W !,$$CJ^XLFSTR(@NODE,$G(IOM,80))
"RTN","LR343",239,0)
 . ;
"RTN","LR343",240,0)
 ;
"RTN","LR343",241,0)
 I $D(TXT)=1 D  ;
"RTN","LR343",242,0)
 . S ^TMP("LR343",$J,"MSG",SUB+1)=TXT
"RTN","LR343",243,0)
 . I '$D(XPDENV) I LB D BMES^XPDUTL($$CJ^XLFSTR(TXT,$G(IOM,80)))
"RTN","LR343",244,0)
 . I '$D(XPDENV) I 'LB D MES^XPDUTL($$CJ^XLFSTR(TXT,$G(IOM,80)))
"RTN","LR343",245,0)
 . I $D(XPDENV) W !,$$CJ^XLFSTR(TXT,$G(IOM,80))
"RTN","LR343",246,0)
 Q
"RTN","LR343",247,0)
 ;
"RTN","LR343",248,0)
CLEAN ;
"RTN","LR343",249,0)
 K ^TMP("LR343",$J)
"RTN","LR343",250,0)
 D CLEAN^DILF
"RTN","LR343",251,0)
 Q
"RTN","LR343",252,0)
 ;
"RTN","LR343",253,0)
KILLDD(FIELD) ;
"RTN","LR343",254,0)
 ; Deletes the #69.9 field's DD
"RTN","LR343",255,0)
 N DIK,DA
"RTN","LR343",256,0)
 S DIK="^DD(69.9,"
"RTN","LR343",257,0)
 S DA=FIELD
"RTN","LR343",258,0)
 S DA(1)=69.9
"RTN","LR343",259,0)
 D ^DIK
"RTN","LR343",260,0)
 Q
"RTN","LR7OEVNT")
1^1^^B9750943
"VER")
8.0^22.0
"BLD",5928,6)
^274
**END**
**END**
