Released XU*8*316 SEQ #263
Extracted from mail message
**KIDS**:XU*8.0*316^

**INSTALL NAME**
XU*8.0*316
"BLD",511,0)
XU*8.0*316^KERNEL^0^3030903^y
"BLD",511,1,0)
^^181^181^3030903^
"BLD",511,1,1,0)
This patch provides several reporting options for Alerts, including
"BLD",511,1,2,0)
ones that: list users with large number of alerts in the ALERTS file
"BLD",511,1,3,0)
(#8992); list alerts for a specified user from a specified date; list
"BLD",511,1,4,0)
alerts for a specified patient for a specified day or date range. 
"BLD",511,1,5,0)
Since the retention period for alerts in the ALERT TRACKING file
"BLD",511,1,6,0)
(#8992.1) is currently a site parameter, some users may have alerts
"BLD",511,1,7,0)
in the ALERTS file that no longer are present in the ALERT TRACKING file,
"BLD",511,1,8,0)
data from both sources is used when necessary.
"BLD",511,1,9,0)
 
"BLD",511,1,10,0)
This patch adds the following options:
"BLD",511,1,11,0)
 
"BLD",511,1,12,0)
Report Menu for Alerts (XQAL REPORTS MENU)
"BLD",511,1,13,0)
 
"BLD",511,1,14,0)
This menu provides several options for generating reports on alerts for
"BLD",511,1,15,0)
users or patients.
"BLD",511,1,16,0)
 
"BLD",511,1,17,0)
 
"BLD",511,1,18,0)
User Alerts Count Report  (XQAL USER ALERTS COUNT)
"BLD",511,1,19,0)
 
"BLD",511,1,20,0)
This option is used to generate a report on users who have more than a
"BLD",511,1,21,0)
specified number of alerts in the ALERTS file (#8992).  The report covers
"BLD",511,1,22,0)
a specified range of dates, and can be sorted by user name, number of
"BLD",511,1,23,0)
alerts, or by service/section.  In addition, the report in each of these
"BLD",511,1,24,0)
formats may be generated by Divisions if desired.
"BLD",511,1,25,0)
 
"BLD",511,1,26,0)
For each user who has the specified number of alerts or more, the report
"BLD",511,1,27,0)
includes the user name, the section/service for the user, the number of
"BLD",511,1,28,0)
alerts in the ALERTS file, the last sign-on date, the number of Critical
"BLD",511,1,29,0)
alerts or Abnormal Imaging alerts, and the date of the oldest alert.
"BLD",511,1,30,0)
 
"BLD",511,1,31,0)
The counting of alerts may also be restricted to those alerts which contain 
"BLD",511,1,32,0)
specific text or phrases.
"BLD",511,1,33,0)
 
"BLD",511,1,34,0)
 
"BLD",511,1,35,0)
Critical Alerts Count Report (XQAL CRITICAL ALERT COUNT)
"BLD",511,1,36,0)
 
"BLD",511,1,37,0)
This option is used to generate a report of users who have more than a
"BLD",511,1,38,0)
specified number of alerts containing the word 'critical' or the words
"BLD",511,1,39,0)
'abnormal imaging' between the specified start and end dates. The report
"BLD",511,1,40,0)
is presented in descending order for the number of critical/abnormal
"BLD",511,1,41,0)
imaging alerts present.
"BLD",511,1,42,0)
 
"BLD",511,1,43,0)
For each user who has the specified number of critical/abnormal
"BLD",511,1,44,0)
imaging alerts or more, the report includes the user name, the
"BLD",511,1,45,0)
section/service for the user, the number of alerts in the ALERTS file, the
"BLD",511,1,46,0)
last sign-on date, the number of Critical alerts or Abnormal Imaging
"BLD",511,1,47,0)
alerts, and the date of the oldest alert.
"BLD",511,1,48,0)
 
"BLD",511,1,49,0)
 
"BLD",511,1,50,0)
List Alerts for a user from a specified date (XQAL ALERT LIST FROM DATE)
"BLD",511,1,51,0)
 
"BLD",511,1,52,0)
This option is used to obtain a list of alerts from the ALERT TRACKING
"BLD",511,1,53,0)
file (#8992.1) for a specified user for a specified date range.  The user
"BLD",511,1,54,0)
may select all of the alerts to be displayed, or enter specific text or
"BLD",511,1,55,0)
phrases to select only alerts which contain the specified text.  In the
"BLD",511,1,56,0)
latter case, the user may also select to see only those alerts which match
"BLD",511,1,57,0)
the criteria and are only info only alerts, only action alerts, or both.
"BLD",511,1,58,0)
 
"BLD",511,1,59,0)
The listing includes the internal entry number for the alert in the ALERT
"BLD",511,1,60,0)
TRACKING file, the date and time the alert was generated, the message
"BLD",511,1,61,0)
text of the alert, and information about any option or routine to be
"BLD",511,1,62,0)
executed for processing the alert.
"BLD",511,1,63,0)
 
"BLD",511,1,64,0)
 
"BLD",511,1,65,0)
Patient Alert List for specified date (XQAL PATIENT ALERT LIST)
"BLD",511,1,66,0)
 
"BLD",511,1,67,0)
This option is used to obtain a list of alerts for a specified patient
"BLD",511,1,68,0)
from the ALERT TRACKING file (#8992.1) for a selected date range (it is
"BLD",511,1,69,0)
recommended that this range be only a few days at most, since every entry
"BLD",511,1,70,0)
in the ALERT TRACKING file in the selected date range must be checked to
"BLD",511,1,71,0)
provide a complete listing of alerts for a patient).
"BLD",511,1,72,0)
 
"BLD",511,1,73,0)
A prompt is provided to obtain a quick scan listing of dates with at least
"BLD",511,1,74,0)
some alerts for the patient on it based on OR and DVB alerts (other
"BLD",511,1,75,0)
patient related alerts need to be identified by looking at each alert's
"BLD",511,1,76,0)
message text and are included in the full list, but not the quick scan).
"BLD",511,1,77,0)
 
"BLD",511,1,78,0)
The user may select all of the alerts to be displayed, or enter specific
"BLD",511,1,79,0)
text or phrases to select only alerts which contain the specified text. 
"BLD",511,1,80,0)
In the latter case, the user may also select to see only those alerts
"BLD",511,1,81,0)
which match the criteria and are info only alerts, only action alerts,
"BLD",511,1,82,0)
or both.
"BLD",511,1,83,0)
 
"BLD",511,1,84,0)
The listing includes the internal entry number for the alert in the ALERT
"BLD",511,1,85,0)
TRACKING file, the date and time the alert was generated, the message
"BLD",511,1,86,0)
text of the alert, and information about any option or routine to be
"BLD",511,1,87,0)
executed for processing the alert.
"BLD",511,1,88,0)
 
"BLD",511,1,89,0)
 
"BLD",511,1,90,0)
View data for Alert Tracking file entry  (XQAL VIEW ALERT TRACKING ENTRY)
"BLD",511,1,91,0)
 
"BLD",511,1,92,0)
This option can be used to obtain a listing of data in captioned format for
"BLD",511,1,93,0)
selected entries in the ALERT TRACKING file (#8992.1).  The internal entry
"BLD",511,1,94,0)
numbers for the entries to be listed must be entered individually.
"BLD",511,1,95,0)
 
"BLD",511,1,96,0)
 
"BLD",511,1,97,0)
There were no NOIS or E3Rs related to this patch.
"BLD",511,1,98,0)
 
"BLD",511,1,99,0)
 
"BLD",511,1,100,0)
List of Test Sites
"BLD",511,1,101,0)
==================
"BLD",511,1,102,0)
ANN ARBOR, MI
"BLD",511,1,103,0)
CLEVELAND, OH
"BLD",511,1,104,0)
DAYTON, OH
"BLD",511,1,105,0)
DUBLIN, GA
"BLD",511,1,106,0)
DURHAM, NC
"BLD",511,1,107,0)
FARGO, ND
"BLD",511,1,108,0)
LEXINGTON, KY
"BLD",511,1,109,0)
LITTLE ROCK, AR (C)
"BLD",511,1,110,0)
MARYLAND HCS 
"BLD",511,1,111,0)
NEW JERSEY HCS  
"BLD",511,1,112,0)
NORTH CHICAGO, IL  
"BLD",511,1,113,0)
NORTHERN CALIFORNIA HCS
"BLD",511,1,114,0)
PALO ALTO HCS
"BLD",511,1,115,0)
PHILADELPHIA, PA 
"BLD",511,1,116,0)
PHOENIX, AZ
"BLD",511,1,117,0)
SAN FRANCISCO, CA
"BLD",511,1,118,0)
 
"BLD",511,1,119,0)
 
"BLD",511,1,120,0)
Routine Summary:
"BLD",511,1,121,0)
================
"BLD",511,1,122,0)
The following routines are included in this patch.  The second
"BLD",511,1,123,0)
line of each of these routines now looks like:
"BLD",511,1,124,0)
 
"BLD",511,1,125,0)
     <tab>;;8.0;KERNEL;**[patch list]**;Jul 10, 1995
"BLD",511,1,126,0)
 
"BLD",511,1,127,0)
Checksums:
"BLD",511,1,128,0)
==========
"BLD",511,1,129,0)
Checksums obtained using CHECK^XTSUMBLD
"BLD",511,1,130,0)
 
"BLD",511,1,131,0)
 Rtn Nm    Chksum Before   Chksum After    Patch List
"BLD",511,1,132,0)
 ------    -------------   ------------    ----------
"BLD",511,1,133,0)
 XQARPRT1           N/A       33282029    **316**
"BLD",511,1,134,0)
 XQARPRT2           N/A       33312830    **316**
"BLD",511,1,135,0)
 
"BLD",511,1,136,0)
 
"BLD",511,1,137,0)
List of preceding patches: none
"BLD",511,1,138,0)
 
"BLD",511,1,139,0)
 
"BLD",511,1,140,0)
Blood Bank Team Coordination:
"BLD",511,1,141,0)
=============================
"BLD",511,1,142,0)
Clearance - Approved 8/21/2003
"BLD",511,1,143,0)
 
"BLD",511,1,144,0)
 
"BLD",511,1,145,0)
Installation Instructions:
"BLD",511,1,146,0)
 
"BLD",511,1,147,0)
     1.   Users ARE allowed to be on the system during the
"BLD",511,1,148,0)
     installation.
"BLD",511,1,149,0)
 
"BLD",511,1,150,0)
     2.   Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu.
"BLD",511,1,151,0)
     This option will load the KIDS (Kernel Installation and Distribution
"BLD",511,1,152,0)
     System) package onto your system.
"BLD",511,1,153,0)
 
"BLD",511,1,154,0)
     3.   You DO NOT need to stop TaskMan or the background filers.
"BLD",511,1,155,0)
 
"BLD",511,1,156,0)
     4.   The patch has now been loaded into a transport global on your
"BLD",511,1,157,0)
     system.  On the KIDS menu, select the 'Installation' menu and use
"BLD",511,1,158,0)
     the following options:
"BLD",511,1,159,0)
           Verify Checksums in Transport Global
"BLD",511,1,160,0)
           Print Transport Global
"BLD",511,1,161,0)
           Compare Transport Global to Current System
"BLD",511,1,162,0)
           Backup a Transport Global
"BLD",511,1,163,0)
 
"BLD",511,1,164,0)
           Return to Programmers Prompt and use "D ^XPDKRN":
"BLD",511,1,165,0)
           Select KIDS OPTION: Install
"BLD",511,1,166,0)
                               =======
"BLD",511,1,167,0)
            Install Package(s)
"BLD",511,1,168,0)
            Select INSTALL NAME: XU*8.0*316
"BLD",511,1,169,0)
                                 ==========
"BLD",511,1,170,0)
 
"BLD",511,1,171,0)
        Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES//
"BLD",511,1,172,0)
        NO
"BLD",511,1,173,0)
        ==
"BLD",511,1,174,0)
        Want KIDS to INHIBIT LOGONs during the install? YES// NO
"BLD",511,1,175,0)
                                                              ==
"BLD",511,1,176,0)
        Want to DISABLE Scheduled Options, Menu Options, and Protocols?
"BLD",511,1,177,0)
        YES// NO
"BLD",511,1,178,0)
              ==
"BLD",511,1,179,0)
 
"BLD",511,1,180,0)
     5.  AXP Sites - Answer 'NO' to the question 'Want to MOVE
"BLD",511,1,181,0)
     routines to other CPUs?'.
"BLD",511,4,0)
^9.64PA^^
"BLD",511,"KRN",0)
^9.67PA^8989.52^19
"BLD",511,"KRN",.4,0)
.4
"BLD",511,"KRN",.401,0)
.401
"BLD",511,"KRN",.402,0)
.402
"BLD",511,"KRN",.403,0)
.403
"BLD",511,"KRN",.5,0)
.5
"BLD",511,"KRN",.84,0)
.84
"BLD",511,"KRN",3.6,0)
3.6
"BLD",511,"KRN",3.8,0)
3.8
"BLD",511,"KRN",9.2,0)
9.2
"BLD",511,"KRN",9.8,0)
9.8
"BLD",511,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",511,"KRN",9.8,"NM",1,0)
XQARPRT1^^0^B84797096
"BLD",511,"KRN",9.8,"NM",2,0)
XQARPRT2^^0^B74224397
"BLD",511,"KRN",9.8,"NM","B","XQARPRT1",1)

"BLD",511,"KRN",9.8,"NM","B","XQARPRT2",2)

"BLD",511,"KRN",19,0)
19
"BLD",511,"KRN",19,"NM",0)
^9.68A^7^7
"BLD",511,"KRN",19,"NM",1,0)
XQALERT MGR^^2
"BLD",511,"KRN",19,"NM",2,0)
XQAL REPORTS MENU^^0
"BLD",511,"KRN",19,"NM",3,0)
XQAL USER ALERTS COUNT^^0
"BLD",511,"KRN",19,"NM",4,0)
XQAL CRITICAL ALERT COUNT^^0
"BLD",511,"KRN",19,"NM",5,0)
XQAL ALERT LIST FROM DATE^^0
"BLD",511,"KRN",19,"NM",6,0)
XQAL PATIENT ALERT LIST^^0
"BLD",511,"KRN",19,"NM",7,0)
XQAL VIEW ALERT TRACKING ENTRY^^0
"BLD",511,"KRN",19,"NM","B","XQAL ALERT LIST FROM DATE",5)

"BLD",511,"KRN",19,"NM","B","XQAL CRITICAL ALERT COUNT",4)

"BLD",511,"KRN",19,"NM","B","XQAL PATIENT ALERT LIST",6)

"BLD",511,"KRN",19,"NM","B","XQAL REPORTS MENU",2)

"BLD",511,"KRN",19,"NM","B","XQAL USER ALERTS COUNT",3)

"BLD",511,"KRN",19,"NM","B","XQAL VIEW ALERT TRACKING ENTRY",7)

"BLD",511,"KRN",19,"NM","B","XQALERT MGR",1)

"BLD",511,"KRN",19.1,0)
19.1
"BLD",511,"KRN",101,0)
101
"BLD",511,"KRN",409.61,0)
409.61
"BLD",511,"KRN",771,0)
771
"BLD",511,"KRN",870,0)
870
"BLD",511,"KRN",8989.51,0)
8989.51
"BLD",511,"KRN",8989.52,0)
8989.52
"BLD",511,"KRN",8994,0)
8994
"BLD",511,"KRN","B",.4,.4)

"BLD",511,"KRN","B",.401,.401)

"BLD",511,"KRN","B",.402,.402)

"BLD",511,"KRN","B",.403,.403)

"BLD",511,"KRN","B",.5,.5)

"BLD",511,"KRN","B",.84,.84)

"BLD",511,"KRN","B",3.6,3.6)

"BLD",511,"KRN","B",3.8,3.8)

"BLD",511,"KRN","B",9.2,9.2)

"BLD",511,"KRN","B",9.8,9.8)

"BLD",511,"KRN","B",19,19)

"BLD",511,"KRN","B",19.1,19.1)

"BLD",511,"KRN","B",101,101)

"BLD",511,"KRN","B",409.61,409.61)

"BLD",511,"KRN","B",771,771)

"BLD",511,"KRN","B",870,870)

"BLD",511,"KRN","B",8989.51,8989.51)

"BLD",511,"KRN","B",8989.52,8989.52)

"BLD",511,"KRN","B",8994,8994)

"BLD",511,"QUES",0)
^9.62^^
"BLD",511,"REQB",0)
^9.611^^
"KRN",19,174,-1)
2^1
"KRN",19,174,0)
XQALERT MGR^Alert Management^^M^1^^^^^^^3
"KRN",19,174,10,0)
^19.01IP^7^7
"KRN",19,174,10,7,0)
786
"KRN",19,174,10,7,"^")
XQAL REPORTS MENU
"KRN",19,174,"U")
ALERT MANAGEMENT
"KRN",19,786,-1)
0^2
"KRN",19,786,0)
XQAL REPORTS MENU^Report Menu for Alerts^^M^^^^^^^^KERNEL
"KRN",19,786,1,0)
^19.06^2^2^3030805^^^
"KRN",19,786,1,1,0)
This menu provides several options for generating reports on alerts for 
"KRN",19,786,1,2,0)
users or patients.
"KRN",19,786,10,0)
^19.01IP^5^5
"KRN",19,786,10,1,0)
787
"KRN",19,786,10,1,"^")
XQAL USER ALERTS COUNT
"KRN",19,786,10,2,0)
788
"KRN",19,786,10,2,"^")
XQAL CRITICAL ALERT COUNT
"KRN",19,786,10,3,0)
789
"KRN",19,786,10,3,"^")
XQAL ALERT LIST FROM DATE
"KRN",19,786,10,4,0)
790
"KRN",19,786,10,4,"^")
XQAL PATIENT ALERT LIST
"KRN",19,786,10,5,0)
791
"KRN",19,786,10,5,"^")
XQAL VIEW ALERT TRACKING ENTRY
"KRN",19,786,99)
59408,49248
"KRN",19,786,"U")
REPORT MENU FOR ALERTS
"KRN",19,787,-1)
0^3
"KRN",19,787,0)
XQAL USER ALERTS COUNT^User Alerts Count Report^^R^^^^^^^^KERNEL
"KRN",19,787,1,0)
^^10^10^3030731^
"KRN",19,787,1,1,0)
This option is used to generate a report on users who have more than a 
"KRN",19,787,1,2,0)
specified number of alerts in the ALERTS file (#8992).  The report covers 
"KRN",19,787,1,3,0)
a specified range of dates, and can be sorted by user name, number of 
"KRN",19,787,1,4,0)
alerts, or by service/section.  In addition, the report in each of these 
"KRN",19,787,1,5,0)
formats may be generated by Divisions if desired.
"KRN",19,787,1,6,0)
 
"KRN",19,787,1,7,0)
For each user who has the specified number of alerts or more, the report
"KRN",19,787,1,8,0)
includes the user name, the section/service for the user, the number of
"KRN",19,787,1,9,0)
alerts in the ALERTS file, the last sign-on date, the number of Critical 
"KRN",19,787,1,10,0)
alerts or Abnormal Imaging alerts, and the date of the oldest alert.
"KRN",19,787,25)
EN1^XQARPRT1
"KRN",19,787,"U")
USER ALERTS COUNT REPORT
"KRN",19,788,-1)
0^4
"KRN",19,788,0)
XQAL CRITICAL ALERT COUNT^Critical Alerts Count Report^^R^^^^^^^^KERNEL
"KRN",19,788,1,0)
^^11^11^3030731^
"KRN",19,788,1,1,0)
This option is used to generate a report of users who have more than a 
"KRN",19,788,1,2,0)
specified number of alerts containing the word 'critical' or the words 
"KRN",19,788,1,3,0)
'abnormal imaging' between the specified start and end dates. The report
"KRN",19,788,1,4,0)
is presented in descending order for the number of critical/abnormal
"KRN",19,788,1,5,0)
imaging alerts present.
"KRN",19,788,1,6,0)
 
"KRN",19,788,1,7,0)
For each user who has the specified number of critical/abnormal 
"KRN",19,788,1,8,0)
imaging alerts or more, the report includes the user name, the
"KRN",19,788,1,9,0)
section/service for the user, the number of alerts in the ALERTS file, the
"KRN",19,788,1,10,0)
last sign-on date, the number of Critical alerts or Abnormal Imaging
"KRN",19,788,1,11,0)
alerts, and the date of the oldest alert.
"KRN",19,788,25)
CRITICAL^XQARPRT1
"KRN",19,788,"U")
CRITICAL ALERTS COUNT REPORT
"KRN",19,789,-1)
0^5
"KRN",19,789,0)
XQAL ALERT LIST FROM DATE^List Alerts for a user from a specified date^^R^^^^^^^^KERNEL
"KRN",19,789,1,0)
^^8^8^3030731^
"KRN",19,789,1,1,0)
This option is used to obtain an interactive list of alerts from the 
"KRN",19,789,1,2,0)
ALERT TRACKING file (#8992.1) for a specified user starting from a 
"KRN",19,789,1,3,0)
specified date.
"KRN",19,789,1,4,0)
 
"KRN",19,789,1,5,0)
The listing includes the internal entry number for the alert in the ALERT 
"KRN",19,789,1,6,0)
TRACKING file, the date and time the alert was generated, the message 
"KRN",19,789,1,7,0)
text of the alert, and information about any option or routine to be 
"KRN",19,789,1,8,0)
executed for processing the alert.
"KRN",19,789,25)
EN^XQARPRT2
"KRN",19,789,"U")
LIST ALERTS FOR A USER FROM A 
"KRN",19,790,-1)
0^6
"KRN",19,790,0)
XQAL PATIENT ALERT LIST^Patient Alert List for specified date^^R^^^^^^^^KERNEL
"KRN",19,790,1,0)
^^12^12^3030731^
"KRN",19,790,1,1,0)
This option is used to obtain a list of alerts for a specified patient 
"KRN",19,790,1,2,0)
from the ALERT TRACKING file (#8992.1) for a selected date.
"KRN",19,790,1,3,0)
 
"KRN",19,790,1,4,0)
A prompt is provided to obtain a quick scan listing of dates with at least
"KRN",19,790,1,5,0)
some alerts for the patient on it based on OR and DVB alerts (other
"KRN",19,790,1,6,0)
patient related alerts need to be identified by looking at each alert's
"KRN",19,790,1,7,0)
message text and are included in the full list, but not the quick scan).
"KRN",19,790,1,8,0)
 
"KRN",19,790,1,9,0)
The listing includes the internal entry number for the alert in the ALERT
"KRN",19,790,1,10,0)
TRACKING file, the date and time the alert was generated, the message
"KRN",19,790,1,11,0)
text of the alert, and information about any option or routine to be
"KRN",19,790,1,12,0)
executed for processing the alert.
"KRN",19,790,25)
DTPT^XQARPRT2
"KRN",19,790,"U")
PATIENT ALERT LIST FOR SPECIFI
"KRN",19,791,-1)
0^7
"KRN",19,791,0)
XQAL VIEW ALERT TRACKING ENTRY^View data for Alert Tracking file entry^^R^^^^^^^^KERNEL
"KRN",19,791,1,0)
^^3^3^3030805^
"KRN",19,791,1,1,0)
This option can be used to view data for one or more entries in the Alert 
"KRN",19,791,1,2,0)
Tracking file (#8992.1) in captioned format. The internal entry numbers
"KRN",19,791,1,3,0)
for the entries to be displayed must be entered individually.
"KRN",19,791,25)
VIEWTRAK^XQARPRT2
"KRN",19,791,"U")
VIEW DATA FOR ALERT TRACKING F
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2990606^1
"PKG",3,22,1,"PAH",1,0)
316^3030903^5
"PKG",3,22,1,"PAH",1,1,0)
^^181^181^3030903
"PKG",3,22,1,"PAH",1,1,1,0)
This patch provides several reporting options for Alerts, including
"PKG",3,22,1,"PAH",1,1,2,0)
ones that: list users with large number of alerts in the ALERTS file
"PKG",3,22,1,"PAH",1,1,3,0)
(#8992); list alerts for a specified user from a specified date; list
"PKG",3,22,1,"PAH",1,1,4,0)
alerts for a specified patient for a specified day or date range. 
"PKG",3,22,1,"PAH",1,1,5,0)
Since the retention period for alerts in the ALERT TRACKING file
"PKG",3,22,1,"PAH",1,1,6,0)
(#8992.1) is currently a site parameter, some users may have alerts
"PKG",3,22,1,"PAH",1,1,7,0)
in the ALERTS file that no longer are present in the ALERT TRACKING file,
"PKG",3,22,1,"PAH",1,1,8,0)
data from both sources is used when necessary.
"PKG",3,22,1,"PAH",1,1,9,0)
 
"PKG",3,22,1,"PAH",1,1,10,0)
This patch adds the following options:
"PKG",3,22,1,"PAH",1,1,11,0)
 
"PKG",3,22,1,"PAH",1,1,12,0)
Report Menu for Alerts (XQAL REPORTS MENU)
"PKG",3,22,1,"PAH",1,1,13,0)
 
"PKG",3,22,1,"PAH",1,1,14,0)
This menu provides several options for generating reports on alerts for
"PKG",3,22,1,"PAH",1,1,15,0)
users or patients.
"PKG",3,22,1,"PAH",1,1,16,0)
 
"PKG",3,22,1,"PAH",1,1,17,0)
 
"PKG",3,22,1,"PAH",1,1,18,0)
User Alerts Count Report  (XQAL USER ALERTS COUNT)
"PKG",3,22,1,"PAH",1,1,19,0)
 
"PKG",3,22,1,"PAH",1,1,20,0)
This option is used to generate a report on users who have more than a
"PKG",3,22,1,"PAH",1,1,21,0)
specified number of alerts in the ALERTS file (#8992).  The report covers
"PKG",3,22,1,"PAH",1,1,22,0)
a specified range of dates, and can be sorted by user name, number of
"PKG",3,22,1,"PAH",1,1,23,0)
alerts, or by service/section.  In addition, the report in each of these
"PKG",3,22,1,"PAH",1,1,24,0)
formats may be generated by Divisions if desired.
"PKG",3,22,1,"PAH",1,1,25,0)
 
"PKG",3,22,1,"PAH",1,1,26,0)
For each user who has the specified number of alerts or more, the report
"PKG",3,22,1,"PAH",1,1,27,0)
includes the user name, the section/service for the user, the number of
"PKG",3,22,1,"PAH",1,1,28,0)
alerts in the ALERTS file, the last sign-on date, the number of Critical
"PKG",3,22,1,"PAH",1,1,29,0)
alerts or Abnormal Imaging alerts, and the date of the oldest alert.
"PKG",3,22,1,"PAH",1,1,30,0)
 
"PKG",3,22,1,"PAH",1,1,31,0)
The counting of alerts may also be restricted to those alerts which contain 
"PKG",3,22,1,"PAH",1,1,32,0)
specific text or phrases.
"PKG",3,22,1,"PAH",1,1,33,0)
 
"PKG",3,22,1,"PAH",1,1,34,0)
 
"PKG",3,22,1,"PAH",1,1,35,0)
Critical Alerts Count Report (XQAL CRITICAL ALERT COUNT)
"PKG",3,22,1,"PAH",1,1,36,0)
 
"PKG",3,22,1,"PAH",1,1,37,0)
This option is used to generate a report of users who have more than a
"PKG",3,22,1,"PAH",1,1,38,0)
specified number of alerts containing the word 'critical' or the words
"PKG",3,22,1,"PAH",1,1,39,0)
'abnormal imaging' between the specified start and end dates. The report
"PKG",3,22,1,"PAH",1,1,40,0)
is presented in descending order for the number of critical/abnormal
"PKG",3,22,1,"PAH",1,1,41,0)
imaging alerts present.
"PKG",3,22,1,"PAH",1,1,42,0)
 
"PKG",3,22,1,"PAH",1,1,43,0)
For each user who has the specified number of critical/abnormal
"PKG",3,22,1,"PAH",1,1,44,0)
imaging alerts or more, the report includes the user name, the
"PKG",3,22,1,"PAH",1,1,45,0)
section/service for the user, the number of alerts in the ALERTS file, the
"PKG",3,22,1,"PAH",1,1,46,0)
last sign-on date, the number of Critical alerts or Abnormal Imaging
"PKG",3,22,1,"PAH",1,1,47,0)
alerts, and the date of the oldest alert.
"PKG",3,22,1,"PAH",1,1,48,0)
 
"PKG",3,22,1,"PAH",1,1,49,0)
 
"PKG",3,22,1,"PAH",1,1,50,0)
List Alerts for a user from a specified date (XQAL ALERT LIST FROM DATE)
"PKG",3,22,1,"PAH",1,1,51,0)
 
"PKG",3,22,1,"PAH",1,1,52,0)
This option is used to obtain a list of alerts from the ALERT TRACKING
"PKG",3,22,1,"PAH",1,1,53,0)
file (#8992.1) for a specified user for a specified date range.  The user
"PKG",3,22,1,"PAH",1,1,54,0)
may select all of the alerts to be displayed, or enter specific text or
"PKG",3,22,1,"PAH",1,1,55,0)
phrases to select only alerts which contain the specified text.  In the
"PKG",3,22,1,"PAH",1,1,56,0)
latter case, the user may also select to see only those alerts which match
"PKG",3,22,1,"PAH",1,1,57,0)
the criteria and are only info only alerts, only action alerts, or both.
"PKG",3,22,1,"PAH",1,1,58,0)
 
"PKG",3,22,1,"PAH",1,1,59,0)
The listing includes the internal entry number for the alert in the ALERT
"PKG",3,22,1,"PAH",1,1,60,0)
TRACKING file, the date and time the alert was generated, the message
"PKG",3,22,1,"PAH",1,1,61,0)
text of the alert, and information about any option or routine to be
"PKG",3,22,1,"PAH",1,1,62,0)
executed for processing the alert.
"PKG",3,22,1,"PAH",1,1,63,0)
 
"PKG",3,22,1,"PAH",1,1,64,0)
 
"PKG",3,22,1,"PAH",1,1,65,0)
Patient Alert List for specified date (XQAL PATIENT ALERT LIST)
"PKG",3,22,1,"PAH",1,1,66,0)
 
"PKG",3,22,1,"PAH",1,1,67,0)
This option is used to obtain a list of alerts for a specified patient
"PKG",3,22,1,"PAH",1,1,68,0)
from the ALERT TRACKING file (#8992.1) for a selected date range (it is
"PKG",3,22,1,"PAH",1,1,69,0)
recommended that this range be only a few days at most, since every entry
"PKG",3,22,1,"PAH",1,1,70,0)
in the ALERT TRACKING file in the selected date range must be checked to
"PKG",3,22,1,"PAH",1,1,71,0)
provide a complete listing of alerts for a patient).
"PKG",3,22,1,"PAH",1,1,72,0)
 
"PKG",3,22,1,"PAH",1,1,73,0)
A prompt is provided to obtain a quick scan listing of dates with at least
"PKG",3,22,1,"PAH",1,1,74,0)
some alerts for the patient on it based on OR and DVB alerts (other
"PKG",3,22,1,"PAH",1,1,75,0)
patient related alerts need to be identified by looking at each alert's
"PKG",3,22,1,"PAH",1,1,76,0)
message text and are included in the full list, but not the quick scan).
"PKG",3,22,1,"PAH",1,1,77,0)
 
"PKG",3,22,1,"PAH",1,1,78,0)
The user may select all of the alerts to be displayed, or enter specific
"PKG",3,22,1,"PAH",1,1,79,0)
text or phrases to select only alerts which contain the specified text. 
"PKG",3,22,1,"PAH",1,1,80,0)
In the latter case, the user may also select to see only those alerts
"PKG",3,22,1,"PAH",1,1,81,0)
which match the criteria and are info only alerts, only action alerts,
"PKG",3,22,1,"PAH",1,1,82,0)
or both.
"PKG",3,22,1,"PAH",1,1,83,0)
 
"PKG",3,22,1,"PAH",1,1,84,0)
The listing includes the internal entry number for the alert in the ALERT
"PKG",3,22,1,"PAH",1,1,85,0)
TRACKING file, the date and time the alert was generated, the message
"PKG",3,22,1,"PAH",1,1,86,0)
text of the alert, and information about any option or routine to be
"PKG",3,22,1,"PAH",1,1,87,0)
executed for processing the alert.
"PKG",3,22,1,"PAH",1,1,88,0)
 
"PKG",3,22,1,"PAH",1,1,89,0)
 
"PKG",3,22,1,"PAH",1,1,90,0)
View data for Alert Tracking file entry  (XQAL VIEW ALERT TRACKING ENTRY)
"PKG",3,22,1,"PAH",1,1,91,0)
 
"PKG",3,22,1,"PAH",1,1,92,0)
This option can be used to obtain a listing of data in captioned format for
"PKG",3,22,1,"PAH",1,1,93,0)
selected entries in the ALERT TRACKING file (#8992.1).  The internal entry
"PKG",3,22,1,"PAH",1,1,94,0)
numbers for the entries to be listed must be entered individually.
"PKG",3,22,1,"PAH",1,1,95,0)
 
"PKG",3,22,1,"PAH",1,1,96,0)
 
"PKG",3,22,1,"PAH",1,1,97,0)
There were no NOIS or E3Rs related to this patch.
"PKG",3,22,1,"PAH",1,1,98,0)
 
"PKG",3,22,1,"PAH",1,1,99,0)
 
"PKG",3,22,1,"PAH",1,1,100,0)
List of Test Sites
"PKG",3,22,1,"PAH",1,1,101,0)
==================
"PKG",3,22,1,"PAH",1,1,102,0)
ANN ARBOR, MI
"PKG",3,22,1,"PAH",1,1,103,0)
CLEVELAND, OH
"PKG",3,22,1,"PAH",1,1,104,0)
DAYTON, OH
"PKG",3,22,1,"PAH",1,1,105,0)
DUBLIN, GA
"PKG",3,22,1,"PAH",1,1,106,0)
DURHAM, NC
"PKG",3,22,1,"PAH",1,1,107,0)
FARGO, ND
"PKG",3,22,1,"PAH",1,1,108,0)
LEXINGTON, KY
"PKG",3,22,1,"PAH",1,1,109,0)
LITTLE ROCK, AR (C)
"PKG",3,22,1,"PAH",1,1,110,0)
MARYLAND HCS 
"PKG",3,22,1,"PAH",1,1,111,0)
NEW JERSEY HCS  
"PKG",3,22,1,"PAH",1,1,112,0)
NORTH CHICAGO, IL  
"PKG",3,22,1,"PAH",1,1,113,0)
NORTHERN CALIFORNIA HCS
"PKG",3,22,1,"PAH",1,1,114,0)
PALO ALTO HCS
"PKG",3,22,1,"PAH",1,1,115,0)
PHILADELPHIA, PA 
"PKG",3,22,1,"PAH",1,1,116,0)
PHOENIX, AZ
"PKG",3,22,1,"PAH",1,1,117,0)
SAN FRANCISCO, CA
"PKG",3,22,1,"PAH",1,1,118,0)
 
"PKG",3,22,1,"PAH",1,1,119,0)
 
"PKG",3,22,1,"PAH",1,1,120,0)
Routine Summary:
"PKG",3,22,1,"PAH",1,1,121,0)
================
"PKG",3,22,1,"PAH",1,1,122,0)
The following routines are included in this patch.  The second
"PKG",3,22,1,"PAH",1,1,123,0)
line of each of these routines now looks like:
"PKG",3,22,1,"PAH",1,1,124,0)
 
"PKG",3,22,1,"PAH",1,1,125,0)
     <tab>;;8.0;KERNEL;**[patch list]**;Jul 10, 1995
"PKG",3,22,1,"PAH",1,1,126,0)
 
"PKG",3,22,1,"PAH",1,1,127,0)
Checksums:
"PKG",3,22,1,"PAH",1,1,128,0)
==========
"PKG",3,22,1,"PAH",1,1,129,0)
Checksums obtained using CHECK^XTSUMBLD
"PKG",3,22,1,"PAH",1,1,130,0)
 
"PKG",3,22,1,"PAH",1,1,131,0)
 Rtn Nm    Chksum Before   Chksum After    Patch List
"PKG",3,22,1,"PAH",1,1,132,0)
 ------    -------------   ------------    ----------
"PKG",3,22,1,"PAH",1,1,133,0)
 XQARPRT1           N/A       33282029    **316**
"PKG",3,22,1,"PAH",1,1,134,0)
 XQARPRT2           N/A       33312830    **316**
"PKG",3,22,1,"PAH",1,1,135,0)
 
"PKG",3,22,1,"PAH",1,1,136,0)
 
"PKG",3,22,1,"PAH",1,1,137,0)
List of preceding patches: none
"PKG",3,22,1,"PAH",1,1,138,0)
 
"PKG",3,22,1,"PAH",1,1,139,0)
 
"PKG",3,22,1,"PAH",1,1,140,0)
Blood Bank Team Coordination:
"PKG",3,22,1,"PAH",1,1,141,0)
=============================
"PKG",3,22,1,"PAH",1,1,142,0)
Clearance - Approved 8/21/2003
"PKG",3,22,1,"PAH",1,1,143,0)
 
"PKG",3,22,1,"PAH",1,1,144,0)
 
"PKG",3,22,1,"PAH",1,1,145,0)
Installation Instructions:
"PKG",3,22,1,"PAH",1,1,146,0)
 
"PKG",3,22,1,"PAH",1,1,147,0)
     1.   Users ARE allowed to be on the system during the
"PKG",3,22,1,"PAH",1,1,148,0)
     installation.
"PKG",3,22,1,"PAH",1,1,149,0)
 
"PKG",3,22,1,"PAH",1,1,150,0)
     2.   Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu.
"PKG",3,22,1,"PAH",1,1,151,0)
     This option will load the KIDS (Kernel Installation and Distribution
"PKG",3,22,1,"PAH",1,1,152,0)
     System) package onto your system.
"PKG",3,22,1,"PAH",1,1,153,0)
 
"PKG",3,22,1,"PAH",1,1,154,0)
     3.   You DO NOT need to stop TaskMan or the background filers.
"PKG",3,22,1,"PAH",1,1,155,0)
 
"PKG",3,22,1,"PAH",1,1,156,0)
     4.   The patch has now been loaded into a transport global on your
"PKG",3,22,1,"PAH",1,1,157,0)
     system.  On the KIDS menu, select the 'Installation' menu and use
"PKG",3,22,1,"PAH",1,1,158,0)
     the following options:
"PKG",3,22,1,"PAH",1,1,159,0)
           Verify Checksums in Transport Global
"PKG",3,22,1,"PAH",1,1,160,0)
           Print Transport Global
"PKG",3,22,1,"PAH",1,1,161,0)
           Compare Transport Global to Current System
"PKG",3,22,1,"PAH",1,1,162,0)
           Backup a Transport Global
"PKG",3,22,1,"PAH",1,1,163,0)
 
"PKG",3,22,1,"PAH",1,1,164,0)
           Return to Programmers Prompt and use "D ^XPDKRN":
"PKG",3,22,1,"PAH",1,1,165,0)
           Select KIDS OPTION: Install
"PKG",3,22,1,"PAH",1,1,166,0)
                               =======
"PKG",3,22,1,"PAH",1,1,167,0)
            Install Package(s)
"PKG",3,22,1,"PAH",1,1,168,0)
            Select INSTALL NAME: XU*8.0*316
"PKG",3,22,1,"PAH",1,1,169,0)
                                 ==========
"PKG",3,22,1,"PAH",1,1,170,0)
 
"PKG",3,22,1,"PAH",1,1,171,0)
        Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES//
"PKG",3,22,1,"PAH",1,1,172,0)
        NO
"PKG",3,22,1,"PAH",1,1,173,0)
        ==
"PKG",3,22,1,"PAH",1,1,174,0)
        Want KIDS to INHIBIT LOGONs during the install? YES// NO
"PKG",3,22,1,"PAH",1,1,175,0)
                                                              ==
"PKG",3,22,1,"PAH",1,1,176,0)
        Want to DISABLE Scheduled Options, Menu Options, and Protocols?
"PKG",3,22,1,"PAH",1,1,177,0)
        YES// NO
"PKG",3,22,1,"PAH",1,1,178,0)
              ==
"PKG",3,22,1,"PAH",1,1,179,0)
 
"PKG",3,22,1,"PAH",1,1,180,0)
     5.  AXP Sites - Answer 'NO' to the question 'Want to MOVE
"PKG",3,22,1,"PAH",1,1,181,0)
     routines to other CPUs?'.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","XQARPRT1")
0^1^B84797096
"RTN","XQARPRT1",1,0)
XQARPRT1 ;sgh/mtz,JLI/OAK_OIFO-ROUTINE TO PROVIDE COUNTS OF ALERTS ;9/3/03  11:17
"RTN","XQARPRT1",2,0)
 ;;8.0;KERNEL;**316**;Jul 10, 1995
"RTN","XQARPRT1",3,0)
 ; based on an original routine AMNUALT
"RTN","XQARPRT1",4,0)
EN1 ; OPT - generates a listing of the number of alerts a user has as well as last sign-on date, number of critical and/or abnomal imaging alerts, and the date of the oldest alert
"RTN","XQARPRT1",5,0)
 N XQACRIT S XQACRIT=0
"RTN","XQARPRT1",6,0)
EN2 ;
"RTN","XQARPRT1",7,0)
 N XQASDT,XQAEDT,XQAC1,XQAORDER,Y,DIR,%ZIS,POP,ZTSAVE,ZTDESC,ZTRTN
"RTN","XQARPRT1",8,0)
 N SHOWDIV,DIVISION,I,DATE,DIRUT,SERVICE,SERVSRT,ALLSERV,XQAWORDS
"RTN","XQARPRT1",9,0)
 I 'XQACRIT D WORDS^XQARPRT2("A") K Y
"RTN","XQARPRT1",10,0)
 S DIR(0)="NO",DIR("A")="Display users whose "_$S(XQACRIT:"CRITICAL ",1:"")_"ALERT count is at least"
"RTN","XQARPRT1",11,0)
 S DIR("B")=$S(XQACRIT:10,1:100) D ^DIR K DIR Q:Y'>0  S XQAC1=Y
"RTN","XQARPRT1",12,0)
 D DATES Q:Y'>0
"RTN","XQARPRT1",13,0)
 D QUERYDIV Q:$D(DIRUT)  D ORDER Q:XQAORDER'>0
"RTN","XQARPRT1",14,0)
 S %ZIS="MQ" D ^%ZIS Q:POP  I $D(IO("Q")) K IO("Q") S ZTRTN="DQ1^XQARPRT1",ZTDESC="How Many "_$S(XQACRIT:"Critical ",1:"")_"Alerts",ZTSAVE("*")="" D ^%ZTLOAD W:$G(ZTSK)>0 !,"Task number is ",ZTSK K ZTSK Q
"RTN","XQARPRT1",15,0)
 G DQ1
"RTN","XQARPRT1",16,0)
 ;
"RTN","XQARPRT1",17,0)
CRITICAL ; OPT - generates a listing of users with more than a specified number of alerts containing CRITICAL or ABNORMAL IMAGING
"RTN","XQARPRT1",18,0)
 N XQACRIT S XQACRIT=1
"RTN","XQARPRT1",19,0)
 G EN2
"RTN","XQARPRT1",20,0)
 ;
"RTN","XQARPRT1",21,0)
DATES ;
"RTN","XQARPRT1",22,0)
 S DIR(0)="DO",DIR("A")="START DATE"
"RTN","XQARPRT1",23,0)
 D ^DIR K DIR Q:Y'>0
"RTN","XQARPRT1",24,0)
 S XQASDT=Y
"RTN","XQARPRT1",25,0)
 S DIR(0)="DO^"_XQASDT_":DT",DIR("A")="END DATE"
"RTN","XQARPRT1",26,0)
 D ^DIR K DIR Q:Y'>0
"RTN","XQARPRT1",27,0)
 S XQAEDT=Y_".24"
"RTN","XQARPRT1",28,0)
 Q
"RTN","XQARPRT1",29,0)
 ;
"RTN","XQARPRT1",30,0)
QUERYDIV ;
"RTN","XQARPRT1",31,0)
 S DIR(0)="Y",DIR("A")="Breakout by One or More Divisions",DIR("?")="Entering YES will result in the entries being grouped by DIVISION." D ^DIR K DIR S DIVISION=+Y Q:$D(DIRUT)
"RTN","XQARPRT1",32,0)
 I DIVISION D  Q:SHOWDIV'>0
"RTN","XQARPRT1",33,0)
 . S DIR(0)="Y",DIR("A")="Show ALL Divisions",DIR("?",1)="Entering YES will result in the analysis being performed for ALL Divisons,",DIR("?")="A NO will result in prompts to select which division(S) you want listed."
"RTN","XQARPRT1",34,0)
 . D ^DIR K DIR I +Y D  I 1
"RTN","XQARPRT1",35,0)
 . . S DIR(0)="S^1:Show only as 'Multiple Division';2:Show in EACH Division",DIR("A")="If a user has more than one division"
"RTN","XQARPRT1",36,0)
 . . S DIR("?",1)="If New Person entries have multiple divisions, entering 1 will result in",DIR("?",2)="those entries being shown only under a heading of 'These users are assigned"
"RTN","XQARPRT1",37,0)
 . . S DIR("?",3)="to multiple divisions', while entering 2 will result in the data for a",DIR("?",4)="specific New Person entry  being shown under each division heading which",DIR("?")="that entry may select."
"RTN","XQARPRT1",38,0)
 . . D ^DIR K DIR S SHOWDIV=+Y
"RTN","XQARPRT1",39,0)
 . . Q
"RTN","XQARPRT1",40,0)
 . E  S SHOWDIV=2 D  K DIRUT
"RTN","XQARPRT1",41,0)
 . . F I=1:1 S DIR(0)="PO^4:EMZ",DIR("A")="Select "_$S(I>1:"Another ",1:"")_"Division: " D ^DIR K DIR Q:Y'>0  S DIVISION($P(Y,U,2))=""
"RTN","XQARPRT1",42,0)
 . Q
"RTN","XQARPRT1",43,0)
 Q
"RTN","XQARPRT1",44,0)
 ;
"RTN","XQARPRT1",45,0)
ORDER ;
"RTN","XQARPRT1",46,0)
 S DIR(0)="SO^;1:By Name;2:By Number;3:By Service/Section;",DIR("A")="Select the ordering of results desired",DIR("?",1)="Select a number to indicate how you would like the selected entries to be"
"RTN","XQARPRT1",47,0)
 S DIR("?",2)="listed by"_$S(DIVISION:" (Within Division)",1:"")_": the New Person entrie's Name; the Number of "_$S(DIVISION:"",1:$S(XQACRIT:"Critical ",1:"")_"Alerts,")
"RTN","XQARPRT1",48,0)
 S DIR("?")=$S(DIVISION:$S(XQACRIT:"Critical ",1:"")_"Alerts, ",1:"")_"or by Service/Section"
"RTN","XQARPRT1",49,0)
 D ^DIR K DIR S XQAORDER=+Y
"RTN","XQARPRT1",50,0)
 I XQAORDER=3 D  Q:$D(DIRUT)
"RTN","XQARPRT1",51,0)
 . S DIR(0)="Y",DIR("A")="Show ALL Service/Sections",DIR("?",1)="Entering YES will result in the analysis being performed for ALL Services,",DIR("?")="A NO will result in prompts to select which Service(s) you want listed."
"RTN","XQARPRT1",52,0)
 . D ^DIR K DIR Q:$D(DIRUT)  S ALLSERV=+Y
"RTN","XQARPRT1",53,0)
 . I 'ALLSERV D
"RTN","XQARPRT1",54,0)
 . . S DIR(0)="PO^49:EMZ" F I=1:1 S DIR("A")="Select "_$S(I>1:"Another ",1:"")_"Service/Section" D ^DIR Q:Y'>0  S SERVICE($E($P(Y,U,2),1,17))=""
"RTN","XQARPRT1",55,0)
 . . K DIR
"RTN","XQARPRT1",56,0)
 . . Q
"RTN","XQARPRT1",57,0)
 . S DIR(0)="SO^;1:By Name;2:By Number;",DIR("A")="Within Service/Section order results by" D ^DIR K DIR Q:$D(DIRUT)  S SERVSRT=+Y
"RTN","XQARPRT1",58,0)
 . Q
"RTN","XQARPRT1",59,0)
 Q
"RTN","XQARPRT1",60,0)
 ;
"RTN","XQARPRT1",61,0)
DQ1 ;
"RTN","XQARPRT1",62,0)
 N XQAGLOB,XQAN1
"RTN","XQARPRT1",63,0)
 S XQAGLOB=$NA(^TMP("XQARPRT1",$J)) K @XQAGLOB
"RTN","XQARPRT1",64,0)
 U IO
"RTN","XQARPRT1",65,0)
 D G1,PRT
"RTN","XQARPRT1",66,0)
 D ^%ZISC
"RTN","XQARPRT1",67,0)
 K @XQAGLOB
"RTN","XQARPRT1",68,0)
 Q
"RTN","XQARPRT1",69,0)
 ;
"RTN","XQARPRT1",70,0)
G1 ;gather
"RTN","XQARPRT1",71,0)
 N COUNT,MSG,DATE
"RTN","XQARPRT1",72,0)
 F XQAN1=0:0 S XQAN1=$O(^XTV(8992,XQAN1)) Q:XQAN1'>0  D
"RTN","XQARPRT1",73,0)
 . S COUNT=0,OLDEST=0,NCRIT=0 F I=0:0 S I=$O(^XTV(8992,XQAN1,"XQA",I)) Q:I'>0  D
"RTN","XQARPRT1",74,0)
 . . S DATE=$P($P(^XTV(8992,XQAN1,"XQA",I,0),U,2),";",3)  S:OLDEST=0 OLDEST=DATE\1 I (DATE<XQASDT)!(DATE>XQAEDT) Q
"RTN","XQARPRT1",75,0)
 . . S MSG=$$UP^XLFSTR($P(^XTV(8992,XQAN1,"XQA",I,0),U,3)) I (MSG["CRITICAL")!(MSG["ABNORMAL IMA") S NCRIT=NCRIT+1
"RTN","XQARPRT1",76,0)
 . . I $D(XQAWORDS)'>0 S COUNT=COUNT+1
"RTN","XQARPRT1",77,0)
 . . I $D(XQAWORDS)>1 D  I MSG'="" S COUNT=COUNT+1
"RTN","XQARPRT1",78,0)
 . . . N MSG1,I,J S MSG1=MSG F J=0:0 S J=$O(XQAWORDS(J)) Q:J'>0  S MSG=MSG1 D  Q:MSG'=""
"RTN","XQARPRT1",79,0)
 . . . . F I=0:0 S I=$O(XQAWORDS(J,I)) Q:I'>0  I MSG'[XQAWORDS(J,I) S MSG="" Q
"RTN","XQARPRT1",80,0)
 . . . . Q
"RTN","XQARPRT1",81,0)
 . . . Q
"RTN","XQARPRT1",82,0)
 . . Q
"RTN","XQARPRT1",83,0)
 . I $S(XQACRIT:NCRIT,1:COUNT)<XQAC1 Q
"RTN","XQARPRT1",84,0)
 . S VALUE=COUNT_U_XQAN1_U_$$FMTE^XLFDT(OLDEST,"5DZ")_U_NCRIT_U_$$GET1^DIQ(200,XQAN1_",",.01)
"RTN","XQARPRT1",85,0)
 . I DIVISION D  I 1
"RTN","XQARPRT1",86,0)
 . . K XQARRAY,XQADIV S XQADIV=0 D GETS^DIQ(200,XQAN1_",","16*","","XQARRAY") S:'$D(XQARRAY) XQADIV(0)="",XQADIV=1 I $D(XQARRAY) D
"RTN","XQARPRT1",87,0)
 . . . N K,L S K="" F  S K=$O(XQARRAY(200.02,K)) Q:K=""  D
"RTN","XQARPRT1",88,0)
 . . . . I $D(DIVISION)'>1 S XQADIV(XQARRAY(200.02,K,.01))="",XQADIV=XQADIV+1
"RTN","XQARPRT1",89,0)
 . . . . E  S L=XQARRAY(200.02,K,.01) I $D(DIVISION(L))>0 S XQADIV(L)="",XQADIV=XQADIV+1
"RTN","XQARPRT1",90,0)
 . . . I XQADIV>1,SHOWDIV=1 K XQADIV S XQADIV(99999)="",XQADIV=1
"RTN","XQARPRT1",91,0)
 . . . Q
"RTN","XQARPRT1",92,0)
 . . S K=$S($D(DIVISION)'>1:"",1:0) F  S K=$O(XQADIV(K)) Q:K=""  S @XQAGLOB@("DIV",K,"NAME",$$GET1^DIQ(200,XQAN1_",",.01)_XQAN1)=VALUE
"RTN","XQARPRT1",93,0)
 . . Q
"RTN","XQARPRT1",94,0)
 . E  S @XQAGLOB@("NAME",$$GET1^DIQ(200,XQAN1_",",.01)_XQAN1)=VALUE
"RTN","XQARPRT1",95,0)
 . Q
"RTN","XQARPRT1",96,0)
 Q
"RTN","XQARPRT1",97,0)
 ;
"RTN","XQARPRT1",98,0)
PRT ;print
"RTN","XQARPRT1",99,0)
 N NAME,NUMBER,LSIGNON,VALUE,XQAGLOB1,DIVNAME
"RTN","XQARPRT1",100,0)
 S XQAGLOB1=XQAGLOB
"RTN","XQARPRT1",101,0)
 I DIVISION D  I 1
"RTN","XQARPRT1",102,0)
 . S DIVNAME="" F  S DIVNAME=$O(@XQAGLOB@("DIV",DIVNAME)) Q:DIVNAME=""  S XQAGLOB1=$NA(@XQAGLOB@("DIV",DIVNAME)) D HEADER,PRTLOC
"RTN","XQARPRT1",103,0)
 E  D HEADER,PRTLOC
"RTN","XQARPRT1",104,0)
 Q
"RTN","XQARPRT1",105,0)
 ;
"RTN","XQARPRT1",106,0)
PRTLOC ;
"RTN","XQARPRT1",107,0)
 N PRTLOC
"RTN","XQARPRT1",108,0)
 S PRTLOC=$S(XQAORDER=1:"PRTNAME",XQAORDER=2:"PRTNUMBR",1:"PRTSERVC") D @PRTLOC
"RTN","XQARPRT1",109,0)
 Q
"RTN","XQARPRT1",110,0)
 ;
"RTN","XQARPRT1",111,0)
HEADER ;
"RTN","XQARPRT1",112,0)
 N XQACTR S XQACTR=0
"RTN","XQARPRT1",113,0)
 W @IOF W " COUNT of ",$S($D(XQAWORDS)>1:"SELECTED ",1:""),"ALERTS - users with more than ",XQAC1," on ",$$FMTE^XLFDT($$NOW^XLFDT())
"RTN","XQARPRT1",114,0)
 W !,"   for date range ",$$FMTE^XLFDT(XQASDT,"5DZ")," to ",$$FMTE^XLFDT(XQAEDT,"5DZ")
"RTN","XQARPRT1",115,0)
 W !,"CRIT column indicates number of CRITICAL alerts and ABNORMAL IMAGING alerts"
"RTN","XQARPRT1",116,0)
 D WORDHDR^XQARPRT2
"RTN","XQARPRT1",117,0)
 W !!,?42,$S($D(XQAWORDS)>1:"Selected",1:"  Total"),?70,"Oldest"
"RTN","XQARPRT1",118,0)
 W !,"Name",?25,"Service/section",?43,"Alerts",?50,"Last Sign-on",?64,"CRIT   Alert"
"RTN","XQARPRT1",119,0)
 W !,"-----------------",?25,"-----------------",?43,"------",?50,"------------",?64,"---- ----------"
"RTN","XQARPRT1",120,0)
 I $D(DIVNAME) D DIVPRINT
"RTN","XQARPRT1",121,0)
 Q
"RTN","XQARPRT1",122,0)
 ;
"RTN","XQARPRT1",123,0)
PRTNAME ;
"RTN","XQARPRT1",124,0)
 N NAME,NUMBER,VALUE,XQAN1,NCRIT,OLDEST,LSIGNON
"RTN","XQARPRT1",125,0)
 S NAME="" F  S NAME=$O(@XQAGLOB1@("NAME",NAME)) Q:NAME=""  S VALUE=@XQAGLOB1@("NAME",NAME) D PRINTVAL
"RTN","XQARPRT1",126,0)
 Q
"RTN","XQARPRT1",127,0)
 ;
"RTN","XQARPRT1",128,0)
PRTNUMBR ;
"RTN","XQARPRT1",129,0)
 N NAME,NUMBER,NUMB,VALUE,XQAN1,NCRIT,OLDEST,LSIGNON
"RTN","XQARPRT1",130,0)
 S NAME="" F  S NAME=$O(@XQAGLOB1@("NAME",NAME)) Q:NAME=""  D
"RTN","XQARPRT1",131,0)
 . S NUMBER=$S(XQACRIT:$P(@XQAGLOB1@("NAME",NAME),U,4),1:+@XQAGLOB1@("NAME",NAME))
"RTN","XQARPRT1",132,0)
 . S @XQAGLOB1@("NUMB",100000-NUMBER,NAME)=@XQAGLOB1@("NAME",NAME)
"RTN","XQARPRT1",133,0)
 . Q
"RTN","XQARPRT1",134,0)
 N NUMB S NUMB="" F  S NUMB=$O(@XQAGLOB1@("NUMB",NUMB)) Q:NUMB=""  S NAME="" F  S NAME=$O(@XQAGLOB1@("NUMB",NUMB,NAME)) Q:NAME=""  S VALUE=@XQAGLOB1@("NUMB",NUMB,NAME) D PRINTVAL
"RTN","XQARPRT1",135,0)
 Q
"RTN","XQARPRT1",136,0)
 ;
"RTN","XQARPRT1",137,0)
PRTSERVC ;
"RTN","XQARPRT1",138,0)
 N NAME,NUMBER,NUMB,VALUE,XQAN1,NCRIT,OLDEST,LSIGNON
"RTN","XQARPRT1",139,0)
 S NAME="" F  S NAME=$O(@XQAGLOB1@("NAME",NAME)) Q:NAME=""  D
"RTN","XQARPRT1",140,0)
 . S XQAN1=$P(@XQAGLOB1@("NAME",NAME),U,2)
"RTN","XQARPRT1",141,0)
 . S SERVICE=$E($$GET1^DIQ(200,XQAN1_",",29),1,17) I SERVICE="" S SERVICE="<No Service>"
"RTN","XQARPRT1",142,0)
 . I ALLSERV!$D(SERVICE(SERVICE)) D
"RTN","XQARPRT1",143,0)
 . . I SERVSRT=1 S @XQAGLOB1@("SERV",SERVICE,NAME)=@XQAGLOB1@("NAME",NAME) Q
"RTN","XQARPRT1",144,0)
 . . I SERVSRT=2 S @XQAGLOB1@("SERV",SERVICE,"NUMB",100000-@XQAGLOB1@("NAME",NAME),NAME)=@XQAGLOB1@("NAME",NAME)
"RTN","XQARPRT1",145,0)
 . . Q
"RTN","XQARPRT1",146,0)
 . Q
"RTN","XQARPRT1",147,0)
 S SERVICE="" F  S SERVICE=$O(@XQAGLOB1@("SERV",SERVICE)) Q:SERVICE=""  D HEADER D
"RTN","XQARPRT1",148,0)
 . I SERVSRT=1 S NAME="" F  S NAME=$O(@XQAGLOB1@("SERV",SERVICE,NAME)) Q:NAME=""  S VALUE=@XQAGLOB1@("SERV",SERVICE,NAME) D PRINTVAL
"RTN","XQARPRT1",149,0)
 . I SERVSRT=2 F NUMB=0:0 S NUMB=$O(@XQAGLOB1@("SERV",SERVICE,"NUMB",NUMB)) Q:NUMB'>0  D
"RTN","XQARPRT1",150,0)
 . . S NAME="" F  S NAME=$O(@XQAGLOB1@("SERV",SERVICE,"NUMB",NUMB,NAME)) Q:NAME=""  S VALUE=@XQAGLOB1@("SERV",SERVICE,"NUMB",NUMB,NAME) D PRINTVAL
"RTN","XQARPRT1",151,0)
 . . Q
"RTN","XQARPRT1",152,0)
 . Q
"RTN","XQARPRT1",153,0)
 Q
"RTN","XQARPRT1",154,0)
 ;
"RTN","XQARPRT1",155,0)
PRINTVAL ;
"RTN","XQARPRT1",156,0)
 N NAME
"RTN","XQARPRT1",157,0)
 S NUMBER=+VALUE,XQAN1=$P(VALUE,U,2),NCRIT=$P(VALUE,U,4),OLDEST=$P(VALUE,U,3),NAME=$P(VALUE,U,5)
"RTN","XQARPRT1",158,0)
 S SERVICE=$E($$GET1^DIQ(200,XQAN1_",",29),1,17)
"RTN","XQARPRT1",159,0)
 S LSIGNON=$$GET1^DIQ(200,XQAN1_",",202)
"RTN","XQARPRT1",160,0)
 I LSIGNON["@" S LSIGNON=$P(LSIGNON,"@")
"RTN","XQARPRT1",161,0)
 I $Y>(IOSL-4) W @IOF D HEADER
"RTN","XQARPRT1",162,0)
 W !,NAME,?25,SERVICE,?43,NUMBER,?50,LSIGNON,?64,NCRIT,?69,OLDEST
"RTN","XQARPRT1",163,0)
 Q
"RTN","XQARPRT1",164,0)
 ;
"RTN","XQARPRT1",165,0)
DIVPRINT ;
"RTN","XQARPRT1",166,0)
 I $Y>(IOSL-6) D HEADER
"RTN","XQARPRT1",167,0)
 W !,?5,"Division: ",$S(DIVNAME=0:"These users are not assigned to a division",DIVNAME=99999:"These users are assigned to multiple divisions",1:DIVNAME)
"RTN","XQARPRT1",168,0)
 Q
"RTN","XQARPRT1",169,0)
 ;
"RTN","XQARPRT1",170,0)
OLDEST() ; Returns date of oldest entry in alert tracking file
"RTN","XQARPRT1",171,0)
 N OLDEST,I,J,FND
"RTN","XQARPRT1",172,0)
 ; Use cross-ref, since if user data used to create entries in tracking file oldest may not be first in file
"RTN","XQARPRT1",173,0)
 ; Make sure cross-ref is valid
"RTN","XQARPRT1",174,0)
 S FND=0 F I=0:0 Q:FND  S I=$O(^XTV(8992.1,"D",I)) Q:I'>0  F J=0:0 S J=$O(^XTV(8992.1,"D",I,J)) Q:J'>0  I $D(^XTV(8992.1,J,0)) S FND=1 Q
"RTN","XQARPRT1",175,0)
 S OLDEST=I S:OLDEST'>0 OLDEST=DT+1
"RTN","XQARPRT1",176,0)
 Q OLDEST\1
"RTN","XQARPRT1",177,0)
 ;
"RTN","XQARPRT1",178,0)
VIEWTRAK ; OPT.  View an entry in the Alert Tracking file in Captioned mode
"RTN","XQARPRT1",179,0)
 N DIR,X0,X1,DAARRAY
"RTN","XQARPRT1",180,0)
 S X0=$O(^XTV(8992.1,0)),X1=$P(^XTV(8992.1,0),U,3)
"RTN","XQARPRT1",181,0)
 S DIR(0)="NO^"_X0_":"_X1
"RTN","XQARPRT1",182,0)
 F I=1:1 S DIR("A")=$S(I>1:"Another ",1:"")_"Internal Entry number in Alert Tracking File" D ^DIR K DIRUT Q:Y'>0  S DAARRAY(I)=+Y
"RTN","XQARPRT1",183,0)
 K DIR Q:$D(DAARRAY)'>1
"RTN","XQARPRT1",184,0)
 S %ZIS="MQ" D ^%ZIS Q:POP  I $D(IO("Q")) K IO("Q") S ZTRTN="VIEWDQ^XQARPRT2",ZTDESC="List data from Alert Tracking file",ZTSAVE("*")="" D ^%ZTLOAD W:$G(ZTSK)>0 !,"Task number is ",ZTSK K ZTSK Q
"RTN","XQARPRT1",185,0)
 ;
"RTN","XQARPRT1",186,0)
VIEWDQ ;
"RTN","XQARPRT1",187,0)
 N DIC,DA,DIC,XQAI,DR,DIQ
"RTN","XQARPRT1",188,0)
 W @IOF
"RTN","XQARPRT1",189,0)
 S DIQ(0)="CR"
"RTN","XQARPRT1",190,0)
 F XQAI=0:0 S XQAI=$O(DAARRAY(XQAI)) Q:XQAI'>0  D
"RTN","XQARPRT1",191,0)
 . S DA=DAARRAY(XQAI),DIC="^XTV(8992.1," D EN^DIQ
"RTN","XQARPRT1",192,0)
 Q
"RTN","XQARPRT2")
0^2^B74224397
"RTN","XQARPRT2",1,0)
XQARPRT2 ;DCN/BUF,JLI/OAK-OIFO - LOOKUP PROVIDER ALERTS 25 SEP 98 ;9/3/03  11:15
"RTN","XQARPRT2",2,0)
 ;;8.0;KERNEL;**316**;Jul 10, 1995
"RTN","XQARPRT2",3,0)
 ;  Based on the original routine AEKALERT
"RTN","XQARPRT2",4,0)
 Q
"RTN","XQARPRT2",5,0)
EN ; OPT - interactive lists alerts from start date for a single user based on contents of alert tracking file
"RTN","XQARPRT2",6,0)
 N DIR,XQADOC S DIR(0)="PO^200:EMZ" D ^DIR K DIR Q:$D(DIRUT)  Q:Y'>0  S XQADOC=+Y
"RTN","XQARPRT2",7,0)
EN1 ;
"RTN","XQARPRT2",8,0)
 N XQASDATE,XQAWORDS,XQADISP,%ZIS,ZTRTN,ZTDESC,ZTSAVE,POP,XQAU1N4
"RTN","XQARPRT2",9,0)
 D DATES Q:Y'>0
"RTN","XQARPRT2",10,0)
 D WORDS() Q:$D(DIRUT)  K Y
"RTN","XQARPRT2",11,0)
 S %ZIS="MQ" D ^%ZIS Q:POP  I $D(IO("Q")) K IO("Q") S ZTRTN="DQ1^XQARPRT2",ZTDESC="List of User Alerts",ZTSAVE("*")="" D ^%ZTLOAD W:$G(ZTSK)>0 !,"Task number is ",ZTSK K ZTSK Q
"RTN","XQARPRT2",12,0)
DQ1 ;
"RTN","XQARPRT2",13,0)
 N XQANWID,XQAIEN,XQADATE,XQANODE0,XQACTR,HEADERID,XQATOT
"RTN","XQARPRT2",14,0)
 S HEADERID="User "_$$GET1^DIQ(200,XQADOC_",",.01)_" (DFN="_XQADOC_")"
"RTN","XQARPRT2",15,0)
 D HEADER(HEADERID,1)
"RTN","XQARPRT2",16,0)
 S XQAIEN=$O(^XTV(8992.1,"D",XQASDATE-.0000001)) I XQAIEN>0 S XQAIEN=$O(^(XQAIEN,0)) ; find starting point instead of having to work up through x-ref
"RTN","XQARPRT2",17,0)
 I XQAIEN>0 F  S XQAIEN=$O(^XTV(8992.1,"R",XQADOC,XQAIEN)) Q:XQAIEN'>0  D  Q:$D(DIRUT)!(XQADATE>XQAEDATE)
"RTN","XQARPRT2",18,0)
 . S XQANODE0=$G(^XTV(8992.1,XQAIEN,0)),XQADATE=$P(XQANODE0,"^",2) Q:(XQADATE<XQASDATE)!(XQADATE>XQAEDATE)
"RTN","XQARPRT2",19,0)
 . D PRNTATRK(XQAIEN)
"RTN","XQARPRT2",20,0)
 D HEADER(HEADERID,0)
"RTN","XQARPRT2",21,0)
 K XQADATE,XQACTR,DATA,DIR,DIRUT,XQADOC,XQAIEN,XQANODE0,XQASDATE,Y
"RTN","XQARPRT2",22,0)
 Q
"RTN","XQARPRT2",23,0)
 ;
"RTN","XQARPRT2",24,0)
WORDS(TYPE) ; Allow user to select alerts containing only certain words
"RTN","XQARPRT2",25,0)
 S DIR(0)="Y",DIR("A")="Do you want to "_$S($G(TYPE)'="":"count",1:"list")_" only alerts containing specific words or phrase(s)"
"RTN","XQARPRT2",26,0)
 S DIR("?",1)="You can enter one or more words or phrases which you want to be used to"
"RTN","XQARPRT2",27,0)
 S DIR("?",2)="select the alerts to be listed.  If you enter NO, all for the selected"
"RTN","XQARPRT2",28,0)
 S DIR("?",3)="individual in the selected time period will be selected.  If you enter"
"RTN","XQARPRT2",29,0)
 S DIR("?",4)="YES, you will be prompted to enter a word or phrase.  You will be prompted"
"RTN","XQARPRT2",30,0)
 S DIR("?",5)="again, and you may enter as many word or phrase entries as you want."
"RTN","XQARPRT2",31,0)
 S DIR("?",6)="Comparisons will NOT be case specific."
"RTN","XQARPRT2",32,0)
 S DIR("?",7)=""
"RTN","XQARPRT2",33,0)
 S DIR("?",8)="HOWEVER ALL WORDS OR PHRASES ENTERED MUST BE IN THE MESSAGE FOR AN ALERT"
"RTN","XQARPRT2",34,0)
 S DIR("?")="TO BE SELECTED."
"RTN","XQARPRT2",35,0)
 D ^DIR K DIR Q:Y'>0
"RTN","XQARPRT2",36,0)
 ;
"RTN","XQARPRT2",37,0)
 F J=1:1 W:J>1 !?7,"--- OR ---",!,"Enter another set of words or phrases that should",!,"be matched independently of the previous entr"_$S(J>2:"ies",1:"y") D  Q:'$D(XQAWORDS(J))
"RTN","XQARPRT2",38,0)
 . W !?10,"ALL words or phrases connected by -AND- must appear in the",!?10,"message for an alert to be selected"
"RTN","XQARPRT2",39,0)
 . S DIR("?",1)="Enter a word, at least three characters long, or phrase, without regard to"
"RTN","XQARPRT2",40,0)
 . S DIR("?",2)="case, that you want to be required for selection of alerts to be listed."
"RTN","XQARPRT2",41,0)
 . S DIR("?",3)="If more than one word or phrase are specified, ALL of them must be in alerts"
"RTN","XQARPRT2",42,0)
 . S DIR("?")="which will be listed."
"RTN","XQARPRT2",43,0)
 . F I=1:1 S DIR(0)="FO^3:",DIR("A")="Enter "_$S(I=1:"a",1:"another")_" word or phrase" W:I>1 !?10,"-AND-" D ^DIR Q:(Y="")!(Y["^")  S XQAWORDS(J,I)=$$UP^XLFSTR(Y)
"RTN","XQARPRT2",44,0)
 . K DIR,DIRUT
"RTN","XQARPRT2",45,0)
 . Q
"RTN","XQARPRT2",46,0)
 ;
"RTN","XQARPRT2",47,0)
 I $D(XQAWORDS)>1,$G(TYPE)="" D 
"RTN","XQARPRT2",48,0)
 . S DIR(0)="SO^1:Both Action and Info Only;2:Action Alerts;3:Info Only Alerts",DIR("?",1)="Select whether alerts listed should be alerts involving actions (2), info",DIR("?")="only or text only alerts (3), or both (1)."
"RTN","XQARPRT2",49,0)
 . S DIR("A")="Select Alert Type(s) desired",DIR("B")=1 D ^DIR K DIR S:Y'>0 Y=1 K DIRUT S XQADISP=+Y
"RTN","XQARPRT2",50,0)
 . Q
"RTN","XQARPRT2",51,0)
 Q
"RTN","XQARPRT2",52,0)
 ;
"RTN","XQARPRT2",53,0)
USER ;USER ENTRY POINT
"RTN","XQARPRT2",54,0)
 N DIR,XQADOC S XQADOC=DUZ
"RTN","XQARPRT2",55,0)
 G EN1
"RTN","XQARPRT2",56,0)
 ;
"RTN","XQARPRT2",57,0)
DATES ;
"RTN","XQARPRT2",58,0)
 S DIR(0)="DO^::EX",DIR("B")="TODAY",DIR("A")="START DATE" D ^DIR K DIR Q:Y'>0  S XQASDATE=+Y
"RTN","XQARPRT2",59,0)
 I XQASDATE<$$OLDEST() W !?10,"The earliest date in the alert tracking file is ",$$FMTE^XLFDT($$OLDEST(),"D") S XQASDATE=$$OLDEST()
"RTN","XQARPRT2",60,0)
 I $D(XQA1U4N) W !,"*** WARNING ***: Do not specify too many days - each entry in the Alert Tracking",!,"file must be checked for the date range specified.",! S DIR("B")=$$FMTE^XLFDT(XQASDATE)
"RTN","XQARPRT2",61,0)
 S DIR(0)="DO^"_XQASDATE_":DT",DIR("A")="END DATE" D ^DIR K DIR Q:$D(DIRUT)  I Y>0 S XQAEDATE=Y+.24
"RTN","XQARPRT2",62,0)
 Q
"RTN","XQARPRT2",63,0)
 ;
"RTN","XQARPRT2",64,0)
PRNTATRK(IEN) ; Print data for an entry from the alert tracking file
"RTN","XQARPRT2",65,0)
 N XQANODE0,XQADATE,Y,XQANEN,XQAMSG,XQAOPT,XQAROU,XQAMSGUC
"RTN","XQARPRT2",66,0)
 S XQANODE0=$G(^XTV(8992.1,IEN,0)),XQADATE=$P(XQANODE0,"^",2)
"RTN","XQARPRT2",67,0)
 S XQAMSG=$G(^XTV(8992.1,IEN,1)),XQAOPT=$P(XQAMSG,U,2),XQAROU=$P(XQAMSG,U,3,4),XQAMSG=$P(XQAMSG,U)
"RTN","XQARPRT2",68,0)
 S XQAOPT=$S(XQAOPT>0:" [OPT]",1:"") S XQAROU=$S((XQAROU'="")&(XQAROU'="^"):" [ROU]",1:"") S XQAOPT=$S(XQAOPT'="":XQAOPT,XQAROU'="":XQAROU,1:"      ")
"RTN","XQARPRT2",69,0)
 I $D(XQAWORDS)>1 S XQAMSGUC=$$UP^XLFSTR(XQAMSG) D  Q:XQAMSGUC=""
"RTN","XQARPRT2",70,0)
 . N XQAMSG1,J,I S XQAMSG1=XQAMSGUC F J=0:0 S J=$O(XQAWORDS(J)) Q:J'>0  S XQAMSGUC=XQAMSG1 D  Q:XQAMSGUC'=""
"RTN","XQARPRT2",71,0)
 . . F I=0:0 S I=$O(XQAWORDS(J,I)) Q:I'>0  I XQAMSGUC'[XQAWORDS(J,I) S XQAMSGUC="" Q
"RTN","XQARPRT2",72,0)
 . . I XQAMSGUC'="",XQADISP'=1 D
"RTN","XQARPRT2",73,0)
 . . . I XQADISP=2,XQAOPT="",XQAROU="" S XQAMSGUC=""
"RTN","XQARPRT2",74,0)
 . . . I XQADISP=3,(XQAOPT'="")!(XQAROU'="") S XQAMSGUC=""
"RTN","XQARPRT2",75,0)
 . . . Q
"RTN","XQARPRT2",76,0)
 . . Q
"RTN","XQARPRT2",77,0)
 . Q
"RTN","XQARPRT2",78,0)
 S XQANEN=$$FMTE^XLFDT(XQADATE,"5Z")_XQAOPT_" ien="_IEN
"RTN","XQARPRT2",79,0)
 W !,$E(XQAMSG,1,IOM-1) W !?35,XQANEN S XQATOT=XQATOT+1
"RTN","XQARPRT2",80,0)
 S XQACTR=XQACTR+2 I XQACTR>(IOSL-4) D  Q:$D(DIRUT)  S XQACTR=0
"RTN","XQARPRT2",81,0)
 . I $D(ZTQUEUED) W @IOF
"RTN","XQARPRT2",82,0)
 . E  S DIR(0)="E" D ^DIR K DIR W !
"RTN","XQARPRT2",83,0)
 . Q
"RTN","XQARPRT2",84,0)
 Q
"RTN","XQARPRT2",85,0)
 ;
"RTN","XQARPRT2",86,0)
HEADER(XQANAME,DOFF) ; Output header at start of report XQANAME indicates who report is for
"RTN","XQARPRT2",87,0)
 W:DOFF @IOF W:'DOFF ! W $S('DOFF:"Found "_XQATOT_" ",1:""),$S($D(XQAWORDS)>1:"Selected ",1:""),"Alerts for ",XQANAME,!,"  for dates ",$$FMTE^XLFDT(XQASDATE)," through "
"RTN","XQARPRT2",88,0)
 N OUTDATE S OUTDATE=$$FMTE^XLFDT(XQAEDATE,"D") I 'DOFF,$D(XQADATE),XQADATE<XQAEDATE,'$D(ZTQUEUED) S OUTDATE=$$FMTE^XLFDT(XQADATE)
"RTN","XQARPRT2",89,0)
 W OUTDATE S XQACTR=2
"RTN","XQARPRT2",90,0)
 D WORDHDR
"RTN","XQARPRT2",91,0)
 W ! S XQACTR=XQACTR+1
"RTN","XQARPRT2",92,0)
 S XQATOT=0
"RTN","XQARPRT2",93,0)
 Q
"RTN","XQARPRT2",94,0)
 ;
"RTN","XQARPRT2",95,0)
WORDHDR ;
"RTN","XQARPRT2",96,0)
 N I,J
"RTN","XQARPRT2",97,0)
 F I=0:0 S I=$O(XQAWORDS(I)) Q:I'>0  W:I>1 !?10,"--- OR ---" D
"RTN","XQARPRT2",98,0)
 . F J=0:0 S J=$O(XQAWORDS(I,J)) Q:J'>0  W !?5,$S(J=1:"Selected alerts containing:",1:"            and containing:"),?35,XQAWORDS(I,J) S XQACTR=XQACTR+1
"RTN","XQARPRT2",99,0)
 . Q
"RTN","XQARPRT2",100,0)
 Q
"RTN","XQARPRT2",101,0)
DTPT ; OPT - GIVEN DATE AND PATIENT, TAKE A LOOK AT ALL USING 'D' X-REF
"RTN","XQARPRT2",102,0)
 ; for one day and for 1 patient list data in alert tracking file related to patient
"RTN","XQARPRT2",103,0)
 N DIR,XQANAME,XQADFN,XQA1U4N,XQASDATE,XQAEDATE,XQA1U4NP,XQAWORDS
"RTN","XQARPRT2",104,0)
 S DIR(0)="PO^2:EMZ" D ^DIR Q:Y'>0  S XQANAME=$P(Y,"^",2),XQADFN=+Y,XQA1U4N=$$GET1^DIQ(2,XQADFN_",",.0905),XQA1U4NP="("_XQA1U4N_")"
"RTN","XQARPRT2",105,0)
 D CHEKSCAN(XQADFN) Q:$D(DIRUT)
"RTN","XQARPRT2",106,0)
 D DATES Q:Y'>0
"RTN","XQARPRT2",107,0)
 D WORDS() K Y Q:$D(DIRUT)
"RTN","XQARPRT2",108,0)
 S %ZIS="MQ" D ^%ZIS Q:POP  I $D(IO("Q")) K IO("Q") S ZTRTN="DTPTDQ^XQARPRT2",ZTDESC="List of Patient Alerts",ZTSAVE("*")="" D ^%ZTLOAD W:$G(ZTSK)>0 !,"Task number is ",ZTSK K ZTSK Q
"RTN","XQARPRT2",109,0)
DTPTDQ ;
"RTN","XQARPRT2",110,0)
 N XQANWID,FOUND,ONE,ZERO,XQACTR,XQAIEN,XQATYPE,XQADATE,HEADERID,XQATOT
"RTN","XQARPRT2",111,0)
 S HEADERID="Patient "_$$GET1^DIQ(2,XQADFN_",",.01)_" ("_$$GET1^DIQ(2,XQADFN_",",.0905)_")"
"RTN","XQARPRT2",112,0)
 D HEADER(HEADERID,1)
"RTN","XQARPRT2",113,0)
 S XQADATE=XQASDATE-0.0000001 F  S XQADATE=$O(^XTV(8992.1,"D",XQADATE)) Q:(XQADATE'>0)!(XQADATE>XQAEDATE)  D  Q:$D(DIRUT)
"RTN","XQARPRT2",114,0)
 . S XQAIEN=0 F  S XQAIEN=$O(^XTV(8992.1,"D",XQADATE,XQAIEN)) Q:XQAIEN=""  S ONE=$G(^XTV(8992.1,XQAIEN,1)),ZERO=$G(^(0)),XQATYPE=$E(ZERO,1,3) D  Q:$D(DIRUT)
"RTN","XQARPRT2",115,0)
 . . S FOUND=0
"RTN","XQARPRT2",116,0)
 . . I (XQATYPE="DVB")!(XQATYPE="OR,") I $P(ZERO,U,4)=XQADFN S FOUND=1
"RTN","XQARPRT2",117,0)
 . . I (XQATYPE="GMA"),$P(ONE,U)[XQANAME S FOUND=1
"RTN","XQARPRT2",118,0)
 . . I (XQATYPE="TIU"),$P(ONE,U)[$E(XQANAME,1,9),$P(ONE,U)[XQA1U4NP S FOUND=1
"RTN","XQARPRT2",119,0)
 . . I FOUND D PRNTATRK(XQAIEN)
"RTN","XQARPRT2",120,0)
 . . Q
"RTN","XQARPRT2",121,0)
 . Q
"RTN","XQARPRT2",122,0)
 D HEADER(HEADERID,0)
"RTN","XQARPRT2",123,0)
 Q
"RTN","XQARPRT2",124,0)
 ;
"RTN","XQARPRT2",125,0)
CHEKSCAN(XQADFN) ; Output a list of dates when OR, and DVB alerts are found
"RTN","XQARPRT2",126,0)
 N DIR,OLDEST,X,Y,XQASDATE,XX,CNT,COL,BASECNT,I
"RTN","XQARPRT2",127,0)
 W !!! S DIR(0)="Y",DIR("A")="Do you want to scan for a list of dates that have at least some alerts for this patient",DIR("A",1)="The quick scan method used here will not pick up some alerts,"
"RTN","XQARPRT2",128,0)
 S DIR("A",2)="but should give an indication of when alerts might be found.",DIR("A",3)=""
"RTN","XQARPRT2",129,0)
 D ^DIR K DIR Q:$D(DIRUT)  I Y D
"RTN","XQARPRT2",130,0)
 . K ^TMP("XQARPRT2",$J)
"RTN","XQARPRT2",131,0)
 . N OLDEST S OLDEST=$$FMTE^XLFDT($$OLDEST(),"5DZ")
"RTN","XQARPRT2",132,0)
 . S DIR(0)="SO^;1:1 Week ago;2:1 month ago;3:3 months ago;4:6 months ago;5:1 year ago;6:As far back as possible",DIR("A")="Select a period for starting",DIR("A",1)="The oldest entry in your Alert Tracking file is from "_OLDEST,DIR("A",2)=""
"RTN","XQARPRT2",133,0)
 . D ^DIR K DIR Q:Y'>0
"RTN","XQARPRT2",134,0)
 . S X=$S(Y=1:"1W",Y=2:"1M",Y=3:"3M",Y=4:"6M",Y=5:"12M",1:"1000M"),X="T-"_X D ^%DT S XQASDATE=Y
"RTN","XQARPRT2",135,0)
 . F I=0:0 S I=$O(^XTV(8992.1,"C",XQADFN,I)) Q:I'>0  S ZERO=$P(^XTV(8992.1,I,0),U,2) I ZERO'<XQASDATE S ^TMP("XQARPRT2",$J,(ZERO\1))=$G(^TMP("XQARPRT2",$J,(ZERO\1)))+1
"RTN","XQARPRT2",136,0)
 . ; Output date and number found in vertical columns, with (if lots of dates) three columns per screen
"RTN","XQARPRT2",137,0)
 . I $D(^TMP("XQARPRT2",$J)) W !,"Dates and number of alerts found in () [may not be all of them]"
"RTN","XQARPRT2",138,0)
 . ; S CNT=0,COL=1,BASECNT=0 F I=0:0 S I=$O(^TMP("XQARPRT2",$J,I)) Q:I'>0  S CNT=CNT+1,XX(CNT)=$G(XX(CNT))_$$FMTE^XLFDT(I,"5DZ")_"  ("_^(I)_")"_"     " I (CNT-BASECNT)>(IOSL-4) S COL=COL+1 S:'(COL#3) BASECNT=CNT S CNT=BASECNT
"RTN","XQARPRT2",139,0)
 . S CNT=2 F I=0:0 S I=$O(^TMP("XQARPRT2",$J,I)) Q:I'>0  S CNT=CNT+1,XX(CNT\3)=$G(XX(CNT\3))_$$FMTE^XLFDT(I,"5DZ")_"  ("_^(I)_")"_"     "
"RTN","XQARPRT2",140,0)
 . F I=0:0 S I=$O(XX(I)) Q:I'>0  W !,XX(I)
"RTN","XQARPRT2",141,0)
 . Q
"RTN","XQARPRT2",142,0)
 Q
"RTN","XQARPRT2",143,0)
 ;
"RTN","XQARPRT2",144,0)
VIEWTRAK ; OPT.  View an entry in the Alert Tracking file in Captioned mode
"RTN","XQARPRT2",145,0)
 D VIEWTRAK^XQARPRT1
"RTN","XQARPRT2",146,0)
 Q
"RTN","XQARPRT2",147,0)
 ;
"RTN","XQARPRT2",148,0)
OLDEST() ; Returns date of oldest entry in alert tracking file
"RTN","XQARPRT2",149,0)
 Q $$OLDEST^XQARPRT1()
"VER")
8.0^22.0
**END**
**END**
