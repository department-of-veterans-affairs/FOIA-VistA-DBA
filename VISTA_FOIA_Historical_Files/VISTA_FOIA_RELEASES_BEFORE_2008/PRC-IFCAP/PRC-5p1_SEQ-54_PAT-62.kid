Released PRC*5.1*62 SEQ #54
Extracted from mail message
**KIDS**:PRC*5.1*62^

**INSTALL NAME**
PRC*5.1*62
"BLD",2885,0)
PRC*5.1*62^IFCAP^0^3030415^y
"BLD",2885,1,0)
^^10^10^3030114^^
"BLD",2885,1,1,0)
This report has been modified to ensure that the information provided
"BLD",2885,1,2,0)
is move useful to the user community.  The following changes have been
"BLD",2885,1,3,0)
implemented.
"BLD",2885,1,4,0)

"BLD",2885,1,5,0)
1. Purchase Card Orders with the following status will NOT appear
"BLD",2885,1,6,0)
   on this report:
"BLD",2885,1,7,0)
   a. Order not completely prepared
"BLD",2885,1,8,0)

"BLD",2885,1,9,0)
2. A date range has been added.
"BLD",2885,1,10,0)

"BLD",2885,4,0)
^9.64PA^^
"BLD",2885,"KRN",0)
^9.67PA^19^17
"BLD",2885,"KRN",.4,0)
.4
"BLD",2885,"KRN",.401,0)
.401
"BLD",2885,"KRN",.402,0)
.402
"BLD",2885,"KRN",.403,0)
.403
"BLD",2885,"KRN",.5,0)
.5
"BLD",2885,"KRN",.84,0)
.84
"BLD",2885,"KRN",3.6,0)
3.6
"BLD",2885,"KRN",3.8,0)
3.8
"BLD",2885,"KRN",9.2,0)
9.2
"BLD",2885,"KRN",9.8,0)
9.8
"BLD",2885,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",2885,"KRN",9.8,"NM",1,0)
PRCHRP2^^0^B14861761
"BLD",2885,"KRN",9.8,"NM","B","PRCHRP2",1)

"BLD",2885,"KRN",19,0)
19
"BLD",2885,"KRN",19.1,0)
19.1
"BLD",2885,"KRN",101,0)
101
"BLD",2885,"KRN",409.61,0)
409.61
"BLD",2885,"KRN",771,0)
771
"BLD",2885,"KRN",870,0)
870
"BLD",2885,"KRN",8994,0)
8994
"BLD",2885,"KRN","B",.4,.4)

"BLD",2885,"KRN","B",.401,.401)

"BLD",2885,"KRN","B",.402,.402)

"BLD",2885,"KRN","B",.403,.403)

"BLD",2885,"KRN","B",.5,.5)

"BLD",2885,"KRN","B",.84,.84)

"BLD",2885,"KRN","B",3.6,3.6)

"BLD",2885,"KRN","B",3.8,3.8)

"BLD",2885,"KRN","B",9.2,9.2)

"BLD",2885,"KRN","B",9.8,9.8)

"BLD",2885,"KRN","B",19,19)

"BLD",2885,"KRN","B",19.1,19.1)

"BLD",2885,"KRN","B",101,101)

"BLD",2885,"KRN","B",409.61,409.61)

"BLD",2885,"KRN","B",771,771)

"BLD",2885,"KRN","B",870,870)

"BLD",2885,"KRN","B",8994,8994)

"BLD",2885,"QUES",0)
^9.62^^
"BLD",2885,"REQB",0)
^9.611^^
"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
62^3030415
"PKG",455,22,1,"PAH",1,1,0)
^^10^10^3030415
"PKG",455,22,1,"PAH",1,1,1,0)
This report has been modified to ensure that the information provided
"PKG",455,22,1,"PAH",1,1,2,0)
is move useful to the user community.  The following changes have been
"PKG",455,22,1,"PAH",1,1,3,0)
implemented.
"PKG",455,22,1,"PAH",1,1,4,0)

"PKG",455,22,1,"PAH",1,1,5,0)
1. Purchase Card Orders with the following status will NOT appear
"PKG",455,22,1,"PAH",1,1,6,0)
   on this report:
"PKG",455,22,1,"PAH",1,1,7,0)
   a. Order not completely prepared
"PKG",455,22,1,"PAH",1,1,8,0)

"PKG",455,22,1,"PAH",1,1,9,0)
2. A date range has been added.
"PKG",455,22,1,"PAH",1,1,10,0)

"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PRCHRP2")
0^1^B14861761
"RTN","PRCHRP2",1,0)
PRCHRP2 ;WISC/KMB/CR UNPAID PC TRANSACTION BY FCP ;6/05/98  11:15
"RTN","PRCHRP2",2,0)
 ;;5.1;IFCAP;**62**;Oct 20, 2000
"RTN","PRCHRP2",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCHRP2",4,0)
START ;
"RTN","PRCHRP2",5,0)
 N BDATE,EDATE,PODATE,PC1,ARR,XXZ,EX,CP,VEND,USER,STATUS,TDATE,EDATE,FDATE,DIR,ZP,P,X,Y,F1,F2,LINE3,TOT,PCNUM,ZTR,ZTR1
"RTN","PRCHRP2",6,0)
 N AMT,AMT1,LINE1,LINE2,LSTATUS,PRCST,PRCSJ,ZIP,BOC,CC,CCREC,PP,QSTATUS
"RTN","PRCHRP2",7,0)
 K ^TMP($J)
"RTN","PRCHRP2",8,0)
 ;
"RTN","PRCHRP2",9,0)
 W @IOF,!!,"Detailed Report of Unpaid PC Transactions by FCP"
"RTN","PRCHRP2",10,0)
 ;
"RTN","PRCHRP2",11,0)
DATE S DIR(0)="D",DIR("A")="P.O. DATE (BEGIN RANGE) ",DIR("B")="T-30"
"RTN","PRCHRP2",12,0)
 D ^DIR Q:$D(DIRUT)  S BDATE=Y
"RTN","PRCHRP2",13,0)
 ;
"RTN","PRCHRP2",14,0)
 S DIR("A")="P.O. DATE (END RANGE) ",DIR("B")="T"
"RTN","PRCHRP2",15,0)
 D ^DIR Q:$D(DIRUT)  S EDATE=Y
"RTN","PRCHRP2",16,0)
 ;
"RTN","PRCHRP2",17,0)
 I BDATE'<EDATE,BDATE'=EDATE D  G DATE
"RTN","PRCHRP2",18,0)
 . W !,"Please enter a valid date range",!
"RTN","PRCHRP2",19,0)
 ;
"RTN","PRCHRP2",20,0)
 W !,"Please select a device for printing this report.",!
"RTN","PRCHRP2",21,0)
 ;
"RTN","PRCHRP2",22,0)
 S %ZIS("B")="",%ZIS="MQ" D ^%ZIS Q:POP
"RTN","PRCHRP2",23,0)
 ;
"RTN","PRCHRP2",24,0)
 ;Queue the report
"RTN","PRCHRP2",25,0)
 I $D(IO("Q")) D  Q
"RTN","PRCHRP2",26,0)
 . S ZTRTN="DETAIL^PRCHRP2"
"RTN","PRCHRP2",27,0)
 . S ZTSAVE("BDATE")=""
"RTN","PRCHRP2",28,0)
 . S ZTSAVE("EDATE")=""
"RTN","PRCHRP2",29,0)
 . D ^%ZTLOAD,^%ZISC Q
"RTN","PRCHRP2",30,0)
 ;
"RTN","PRCHRP2",31,0)
 D DETAIL,^%ZISC Q
"RTN","PRCHRP2",32,0)
 ;
"RTN","PRCHRP2",33,0)
DETAIL ;
"RTN","PRCHRP2",34,0)
 F ZTR=1,24,29,32,34,37,38,40,41,45,50,51 S ARR(ZTR)=""
"RTN","PRCHRP2",35,0)
 U IO S U="^",(P,EX)=1,ZP="" F  S ZP=$O(^PRC(442,"F",25,ZP)) Q:ZP=""  D
"RTN","PRCHRP2",36,0)
 .S ZTR1=+$P($G(^PRC(442,ZP,7)),"^",2) Q:ZTR1=""
"RTN","PRCHRP2",37,0)
 .Q:$D(ARR(ZTR1))
"RTN","PRCHRP2",38,0)
 .S F1=$G(^PRC(442,ZP,0)),F2=$G(^PRC(442,ZP,1)),LINE3=$G(^PRC(442,ZP,2,1,1,1,0))
"RTN","PRCHRP2",39,0)
 .S (PODATE,Y)=$P(F2,"^",15)
"RTN","PRCHRP2",40,0)
 .I PODATE<BDATE!(PODATE>EDATE) Q
"RTN","PRCHRP2",41,0)
 .S STATUS=+$P($G(^PRC(442,ZP,7)),"^",1),LSTATUS=$P($G(^PRCD(442.3,STATUS,0)),"^",1)
"RTN","PRCHRP2",42,0)
 .S PCNUM=$P(F1,"^"),CP=$P(F1,"^",3),CP=$P(CP," ")
"RTN","PRCHRP2",43,0)
 .S ZTR1=+$P($G(^PRC(442,ZP,7)),"^",2) Q:$D(ARR(ZTR1))
"RTN","PRCHRP2",44,0)
 .Q:CP=""
"RTN","PRCHRP2",45,0)
 .S PC1=$P($G(^PRC(442,ZP,23)),"^",8) Q:PC1=""
"RTN","PRCHRP2",46,0)
 .D DD^%DT S TDATE=Y
"RTN","PRCHRP2",47,0)
 .S USER=$P($G(^PRC(440.5,PC1,0)),"^",8),USER=$P($G(^VA(200,+USER,0)),"^"),VEND=$P(F2,"^"),VEND=$P($G(^PRC(440,+VEND,0)),"^"),AMT=$P(F1,"^",15),VEND=$E(VEND,1,30)
"RTN","PRCHRP2",48,0)
 .I VEND="SIMPLIFIED",$P($G(^PRC(442,ZP,24)),"^",2)'="" S VEND=$P($G(^PRC(442,ZP,24)),"^",2)
"RTN","PRCHRP2",49,0)
 .S LINE1=CP_"^"_PCNUM_"^"_USER_"^"_VEND
"RTN","PRCHRP2",50,0)
 .S CC=$P(F1,"^",5),BOC=$P($G(^PRC(442,ZP,2,1,0)),"^",4),BOC=$E(BOC,1,20)
"RTN","PRCHRP2",51,0)
 .S LINE2=AMT_"^"_TDATE_"^"_CC_"^"_$E(BOC,1,30)
"RTN","PRCHRP2",52,0)
 .S CP=+CP,^TMP($J,CP,ZP,1)=LINE1,^TMP($J,CP,ZP,2)=LINE2,^TMP($J,CP,ZP,3)=LINE3,^TMP($J,CP,ZP,4)=LSTATUS
"RTN","PRCHRP2",53,0)
 ;
"RTN","PRCHRP2",54,0)
WRITE ;
"RTN","PRCHRP2",55,0)
 I '$D(^TMP($J)) S P=1 D HEADER W !!!!,?10,"*** NO RECORDS TO PRINT ***" Q
"RTN","PRCHRP2",56,0)
 S (TOT,CP,ZP)="" F  S CP=$O(^TMP($J,CP)) Q:EX[U  Q:CP=""  D
"RTN","PRCHRP2",57,0)
 .F  S ZP=$O(^TMP($J,CP,ZP)) Q:EX[U  Q:ZP=""  D
"RTN","PRCHRP2",58,0)
 ..D:P=1 HEADER I (IOSL-$Y)<6 D HOLD Q:EX[U
"RTN","PRCHRP2",59,0)
 ..S LINE1=^TMP($J,CP,ZP,1) W !,$P(LINE1,"^"),?6,$P(LINE1,"^",2),?25,$P(LINE1,"^",3),?50,$P(LINE1,"^",4)
"RTN","PRCHRP2",60,0)
 ..S AMT1=$P(^TMP($J,CP,ZP,2),"^",1) W !,?3,$J(AMT1,0,2),?20,$P(^TMP($J,CP,ZP,2),"^",2),?36,$P(^TMP($J,CP,ZP,2),"^",3),?50,$P(^TMP($J,CP,ZP,2),"^",4)
"RTN","PRCHRP2",61,0)
 ..W !,^TMP($J,CP,ZP,3),!,^TMP($J,CP,ZP,4),!
"RTN","PRCHRP2",62,0)
 ..S TOT=TOT+AMT1
"RTN","PRCHRP2",63,0)
 .I EX'[U W !,?40,"CONTROL POINT ",CP," SUBTOTAL: ",$J(TOT,0,2),! S TOT=0
"RTN","PRCHRP2",64,0)
 QUIT
"RTN","PRCHRP2",65,0)
 ;
"RTN","PRCHRP2",66,0)
HOLD G HEADER:$E(IOST)="P"!(IO'=IO(0)) W !,"Press return to continue, '^' to exit: " R XXZ:DTIME S:XXZ["^" EX=U S:'$T EX=U D:EX'=U HEADER Q
"RTN","PRCHRP2",67,0)
 ;
"RTN","PRCHRP2",68,0)
HEADER ;
"RTN","PRCHRP2",69,0)
 W @IOF
"RTN","PRCHRP2",70,0)
 W !,"DETAILED REPORT OF UNPAID PURCHASE CARD TRANSACTIONS BY FCP",?65,"PAGE: ",P
"RTN","PRCHRP2",71,0)
 W !,"FCP",?6,"PC NUMBER",?25,"BUYER",?50,"VENDOR"
"RTN","PRCHRP2",72,0)
 W !,?3,"AMOUNT",?20,"PURCHASE DATE",?36,"COST CENTER",?50,"BUDGET OBJECT CODE",!,"FIRST LINE ITEM DESCRIPTION",!,"STATUS"
"RTN","PRCHRP2",73,0)
 W ! F I=1:1:10 W "--------"
"RTN","PRCHRP2",74,0)
 S P=P+1 Q
"VER")
8.0^22.0
**END**
**END**
