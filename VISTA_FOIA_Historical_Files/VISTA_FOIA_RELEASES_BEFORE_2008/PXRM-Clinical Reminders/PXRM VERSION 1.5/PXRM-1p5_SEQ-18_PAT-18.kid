Released PXRM*1.5*18 SEQ #18
Extracted from mail message
**KIDS**:PXRM*1.5*18^

**INSTALL NAME**
PXRM*1.5*18
"BLD",4197,0)
PXRM*1.5*18^CLINICAL REMINDERS^0^3030903^y
"BLD",4197,1,0)
^^2^2^3030414^^^^
"BLD",4197,1,1,0)
The description of this patch is found in the National Patch Module under 
"BLD",4197,1,2,0)
the name PXRM*1.5*18. Clinical Reminders - Code Set Versioning
"BLD",4197,4,0)
^9.64PA^811.2^1
"BLD",4197,4,811.2,0)
811.2
"BLD",4197,4,811.2,222)
y^y^f^^^^n
"BLD",4197,4,"B",811.2,811.2)

"BLD",4197,"INI")
PRE^PXRMP18I
"BLD",4197,"INID")
^^
"BLD",4197,"INIT")
POST^PXRMP18I
"BLD",4197,"KRN",0)
^9.67PA^8989.52^19
"BLD",4197,"KRN",.4,0)
.4
"BLD",4197,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",4197,"KRN",.4,"NM",1,0)
PXRM TAXONOMY INQUIRY    FILE #811.2^811.2^0
"BLD",4197,"KRN",.4,"NM","B","PXRM TAXONOMY INQUIRY    FILE #811.2",1)

"BLD",4197,"KRN",.401,0)
.401
"BLD",4197,"KRN",.402,0)
.402
"BLD",4197,"KRN",.403,0)
.403
"BLD",4197,"KRN",.5,0)
.5
"BLD",4197,"KRN",.84,0)
.84
"BLD",4197,"KRN",3.6,0)
3.6
"BLD",4197,"KRN",3.8,0)
3.8
"BLD",4197,"KRN",9.2,0)
9.2
"BLD",4197,"KRN",9.8,0)
9.8
"BLD",4197,"KRN",9.8,"NM",0)
^9.68A^18^18
"BLD",4197,"KRN",9.8,"NM",1,0)
PXRMCSD^^0^B75969117
"BLD",4197,"KRN",9.8,"NM",2,0)
PXRMCSU^^0^B7161038
"BLD",4197,"KRN",9.8,"NM",3,0)
PXRMVALC^^0^B67226271
"BLD",4197,"KRN",9.8,"NM",4,0)
PXRMDLLA^^0^B56156564
"BLD",4197,"KRN",9.8,"NM",5,0)
PXRMDLLB^^0^B16463488
"BLD",4197,"KRN",9.8,"NM",6,0)
PXRMBXTL^^0^B17537149
"BLD",4197,"KRN",9.8,"NM",7,0)
PXRMCODE^^0^B6672018
"BLD",4197,"KRN",9.8,"NM",8,0)
PXRMCSPE^^0^B1065787
"BLD",4197,"KRN",9.8,"NM",9,0)
PXRMCSTX^^0^B31401683
"BLD",4197,"KRN",9.8,"NM",10,0)
PXRMCSSC^^0^B5002819
"BLD",4197,"KRN",9.8,"NM",11,0)
PXRMDLG1^^0^B79437142
"BLD",4197,"KRN",9.8,"NM",12,0)
PXRMPTTX^^0^B13593591
"BLD",4197,"KRN",9.8,"NM",13,0)
PXRMTDLG^^0^B17957253
"BLD",4197,"KRN",9.8,"NM",14,0)
PXRMTDUP^^0^B809193
"BLD",4197,"KRN",9.8,"NM",15,0)
PXRMTEDT^^0^B4054028
"BLD",4197,"KRN",9.8,"NM",16,0)
PXRMINTR^^0^B44071827
"BLD",4197,"KRN",9.8,"NM",17,0)
PXRMP18E^^0^B473282
"BLD",4197,"KRN",9.8,"NM",18,0)
PXRMP18I^^0^B6133354
"BLD",4197,"KRN",9.8,"NM","B","PXRMBXTL",6)

"BLD",4197,"KRN",9.8,"NM","B","PXRMCODE",7)

"BLD",4197,"KRN",9.8,"NM","B","PXRMCSD",1)

"BLD",4197,"KRN",9.8,"NM","B","PXRMCSPE",8)

"BLD",4197,"KRN",9.8,"NM","B","PXRMCSSC",10)

"BLD",4197,"KRN",9.8,"NM","B","PXRMCSTX",9)

"BLD",4197,"KRN",9.8,"NM","B","PXRMCSU",2)

"BLD",4197,"KRN",9.8,"NM","B","PXRMDLG1",11)

"BLD",4197,"KRN",9.8,"NM","B","PXRMDLLA",4)

"BLD",4197,"KRN",9.8,"NM","B","PXRMDLLB",5)

"BLD",4197,"KRN",9.8,"NM","B","PXRMINTR",16)

"BLD",4197,"KRN",9.8,"NM","B","PXRMP18E",17)

"BLD",4197,"KRN",9.8,"NM","B","PXRMP18I",18)

"BLD",4197,"KRN",9.8,"NM","B","PXRMPTTX",12)

"BLD",4197,"KRN",9.8,"NM","B","PXRMTDLG",13)

"BLD",4197,"KRN",9.8,"NM","B","PXRMTDUP",14)

"BLD",4197,"KRN",9.8,"NM","B","PXRMTEDT",15)

"BLD",4197,"KRN",9.8,"NM","B","PXRMVALC",3)

"BLD",4197,"KRN",19,0)
19
"BLD",4197,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",4197,"KRN",19,"NM",1,0)
PXRMCS INACTIVE DIALOG CODES^^0
"BLD",4197,"KRN",19,"NM",2,0)
PXRM DIALOG MANAGEMENT^^2
"BLD",4197,"KRN",19,"NM","B","PXRM DIALOG MANAGEMENT",2)

"BLD",4197,"KRN",19,"NM","B","PXRMCS INACTIVE DIALOG CODES",1)

"BLD",4197,"KRN",19.1,0)
19.1
"BLD",4197,"KRN",101,0)
101
"BLD",4197,"KRN",101,"NM",0)
^9.68A^8^4
"BLD",4197,"KRN",101,"NM",3,0)
ICPT CODE UPDATE EVENT^^2
"BLD",4197,"KRN",101,"NM",6,0)
PXRM CODE SET UPDATE CPT^^0
"BLD",4197,"KRN",101,"NM",7,0)
ICD CODE UPDATE EVENT^^2
"BLD",4197,"KRN",101,"NM",8,0)
PXRM CODE SET UPDATE ICD^^0
"BLD",4197,"KRN",101,"NM","B","ICD CODE UPDATE EVENT",7)

"BLD",4197,"KRN",101,"NM","B","ICPT CODE UPDATE EVENT",3)

"BLD",4197,"KRN",101,"NM","B","PXRM CODE SET UPDATE CPT",6)

"BLD",4197,"KRN",101,"NM","B","PXRM CODE SET UPDATE ICD",8)

"BLD",4197,"KRN",409.61,0)
409.61
"BLD",4197,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",4197,"KRN",771,0)
771
"BLD",4197,"KRN",870,0)
870
"BLD",4197,"KRN",8989.51,0)
8989.51
"BLD",4197,"KRN",8989.52,0)
8989.52
"BLD",4197,"KRN",8994,0)
8994
"BLD",4197,"KRN","B",.4,.4)

"BLD",4197,"KRN","B",.401,.401)

"BLD",4197,"KRN","B",.402,.402)

"BLD",4197,"KRN","B",.403,.403)

"BLD",4197,"KRN","B",.5,.5)

"BLD",4197,"KRN","B",.84,.84)

"BLD",4197,"KRN","B",3.6,3.6)

"BLD",4197,"KRN","B",3.8,3.8)

"BLD",4197,"KRN","B",9.2,9.2)

"BLD",4197,"KRN","B",9.8,9.8)

"BLD",4197,"KRN","B",19,19)

"BLD",4197,"KRN","B",19.1,19.1)

"BLD",4197,"KRN","B",101,101)

"BLD",4197,"KRN","B",409.61,409.61)

"BLD",4197,"KRN","B",771,771)

"BLD",4197,"KRN","B",870,870)

"BLD",4197,"KRN","B",8989.51,8989.51)

"BLD",4197,"KRN","B",8989.52,8989.52)

"BLD",4197,"KRN","B",8994,8994)

"BLD",4197,"PRE")
PXRMP18E
"BLD",4197,"PRET")

"BLD",4197,"QUES",0)
^9.62^^
"BLD",4197,"REQB",0)
^9.611^1^1
"BLD",4197,"REQB",1,0)
LEX*2.0*25^2
"BLD",4197,"REQB","B","LEX*2.0*25",1)

"FIA",811.2)
REMINDER TAXONOMY
"FIA",811.2,0)
^PXD(811.2,
"FIA",811.2,0,0)
811.2IO
"FIA",811.2,0,1)
y^y^f^^^^n
"FIA",811.2,0,10)

"FIA",811.2,0,11)

"FIA",811.2,0,"RLRO")

"FIA",811.2,0,"VR")
1.5^PXRM
"FIA",811.2,811.2)
0
"FIA",811.2,811.21)
0
"FIA",811.2,811.212)
0
"FIA",811.2,811.22102)
0
"FIA",811.2,811.22103)
0
"FIA",811.2,811.22104)
0
"FIA",811.2,811.23102)
0
"FIA",811.2,811.23104)
0
"INI")
PRE^PXRMP18I
"INIT")
POST^PXRMP18I
"IX",811.2,811.2,"B",0)
811.2^B^New style B cross-reference^R^^F^IR^I^811.2^^^^^LS
"IX",811.2,811.2,"B",1)
S ^PXD(811.2,"B",$E(X,1,35),DA)=""
"IX",811.2,811.2,"B",2)
K ^PXD(811.2,"B",$E(X,1,35),DA)
"IX",811.2,811.2,"B",2.5)
K ^PXD(811.2,"B")
"IX",811.2,811.2,"B",11.1,0)
^.114IA^1^1
"IX",811.2,811.2,"B",11.1,1,0)
1^F^811.2^.01^35^1^F
"IX",811.2,811.2,"B",11.1,1,3)

"IX",811.2,811.22102,"AD",0)
811.22102^AD^Whenever ICD9 entries are edited rebuild expanded taxonomy^MU^^R^IR^I^811.22102^^^^^A
"IX",811.2,811.22102,"AD",1)
D TAXEDIT^PXRMTAX(DA(1),"")
"IX",811.2,811.22102,"AD",2)
D TAXEDIT^PXRMTAX(DA(1),DA)
"IX",811.2,811.22102,"AD",2.4)
S X=1 I $$EDITNXR^PXRMLOGX(.X1,.X2) S X=0
"IX",811.2,811.22102,"AD",2.5)
D TAXKILL^PXRMTAX(DA(1))
"IX",811.2,811.22102,"AD",11.1,0)
^.114IA^2^2
"IX",811.2,811.22102,"AD",11.1,1,0)
1^F^811.22102^.01^^^F
"IX",811.2,811.22102,"AD",11.1,2,0)
2^F^811.22102^1^^^F
"IX",811.2,811.22102,"AICD9N",0)
811.22102^AICD9N^Populate the ICD9 ADJACENT HIGHER CODE field^MU^^F^IR^I^811.22102^^^^^A
"IX",811.2,811.22102,"AICD9N",1)
S $P(^PXD(811.2,DA(1),80,DA,0),U,4)=$$NEXT^ICDAPIU(X)
"IX",811.2,811.22102,"AICD9N",2)
S $P(^PXD(811.2,DA(1),80,DA,0),U,4)=""
"IX",811.2,811.22102,"AICD9N",11.1,0)
^.114IA^1^1
"IX",811.2,811.22102,"AICD9N",11.1,1,0)
1^F^811.22102^1^^1^F
"IX",811.2,811.22102,"AICD9P",0)
811.22102^AICD9P^Populate the ICD9 ADJACENT LOWER CODE FIELD^MU^^F^IR^I^811.22102^^^^^A
"IX",811.2,811.22102,"AICD9P",1)
S $P(^PXD(811.2,DA(1),80,DA,0),U,3)=$$PREV^ICDAPIU(X)
"IX",811.2,811.22102,"AICD9P",2)
S $P(^PXD(811.2,DA(1),80,DA,0),U,3)=""
"IX",811.2,811.22102,"AICD9P",11.1,0)
^.114IA^1^1
"IX",811.2,811.22102,"AICD9P",11.1,1,0)
1^F^811.22102^.01^^1^F
"IX",811.2,811.22103,"AC",0)
811.22103^AC^Whenever ICD0 entries are changed rebuild the expanded taxonomy^MU^^R^IR^I^811.22103^^^^^A
"IX",811.2,811.22103,"AC",1)
D TAXEDIT^PXRMTAX(DA(1),"")
"IX",811.2,811.22103,"AC",2)
D TAXEDIT^PXRMTAX(DA(1),DA)
"IX",811.2,811.22103,"AC",2.4)
S X=1 I $$EDITNXR^PXRMLOGX(.X1,.X2) S X=0
"IX",811.2,811.22103,"AC",2.5)
D TAXKILL^PXRMTAX(DA(1))
"IX",811.2,811.22103,"AC",11.1,0)
^.114IA^2^2
"IX",811.2,811.22103,"AC",11.1,1,0)
1^F^811.22103^.01^^^F
"IX",811.2,811.22103,"AC",11.1,2,0)
2^F^811.22103^1^^^F
"IX",811.2,811.22103,"AICD0N",0)
811.22103^AICD0N^Populate the ICD0 ADJACENT HIGHER CODE field^MU^^F^IR^I^811.22103^^^^^A
"IX",811.2,811.22103,"AICD0N",1)
S $P(^PXD(811.2,DA(1),80.1,DA,0),U,4)=$$NEXT^ICDAPIU(X)
"IX",811.2,811.22103,"AICD0N",2)
S $P(^PXD(811.2,DA(1),80.1,DA,0),U,4)=""
"IX",811.2,811.22103,"AICD0N",11.1,0)
^.114IA^1^1
"IX",811.2,811.22103,"AICD0N",11.1,1,0)
1^F^811.22103^1^^1^F
"IX",811.2,811.22103,"AICD0P",0)
811.22103^AICD0P^Populate the ICD0 ADJACENT LOWER CODE field^MU^^F^IR^I^811.22103^^^^^A
"IX",811.2,811.22103,"AICD0P",1)
S $P(^PXD(811.2,DA(1),80.1,DA,0),U,3)=$$PREV^ICDAPIU(X)
"IX",811.2,811.22103,"AICD0P",2)
S $P(^PXD(811.2,DA(1),80.1,DA,0),U,3)=""
"IX",811.2,811.22103,"AICD0P",11.1,0)
^.114IA^1^1
"IX",811.2,811.22103,"AICD0P",11.1,1,0)
1^F^811.22103^.01^^1^F
"IX",811.2,811.22104,"ACPTN",0)
811.22104^ACPTN^Populate the CPT ADJACENT HIGHER CODE field^MU^^F^IR^I^811.22104^^^^^A
"IX",811.2,811.22104,"ACPTN",1)
S $P(^PXD(811.2,DA(1),81,DA,0),U,4)=$$NEXT^ICPTAPIU(X)
"IX",811.2,811.22104,"ACPTN",2)
S $P(^PXD(811.2,DA(1),81,DA,0),U,4)=""
"IX",811.2,811.22104,"ACPTN",11.1,0)
^.114IA^1^1
"IX",811.2,811.22104,"ACPTN",11.1,1,0)
1^F^811.22104^1^^1^F
"IX",811.2,811.22104,"ACPTP",0)
811.22104^ACPTP^Populate the CPT ADJACENT LOWER CODE field^MU^^F^IR^I^811.22104^^^^^A
"IX",811.2,811.22104,"ACPTP",1)
S $P(^PXD(811.2,DA(1),81,DA,0),U,3)=$$PREV^ICPTAPIU(X)
"IX",811.2,811.22104,"ACPTP",2)
S $P(^PXD(811.2,DA(1),81,DA,0),U,3)=""
"IX",811.2,811.22104,"ACPTP",11.1,0)
^.114IA^1^1
"IX",811.2,811.22104,"ACPTP",11.1,1,0)
1^F^811.22104^.01^^1^F
"IX",811.2,811.22104,"AE",0)
811.22104^AE^Whenever CPT entries are changed rebuild the expanded taxonomy^MU^^R^IR^I^811.22104^^^^^A
"IX",811.2,811.22104,"AE",1)
D TAXEDIT^PXRMTAX(DA(1),"")
"IX",811.2,811.22104,"AE",2)
D TAXEDIT^PXRMTAX(DA(1),DA)
"IX",811.2,811.22104,"AE",2.4)
S X=1 I $$EDITNXR^PXRMLOGX(.X1,.X2) S X=0
"IX",811.2,811.22104,"AE",2.5)
D TAXKILL^PXRMTAX(DA(1))
"IX",811.2,811.22104,"AE",11.1,0)
^.114IA^2^2
"IX",811.2,811.22104,"AE",11.1,1,0)
1^F^811.22104^.01^^^F
"IX",811.2,811.22104,"AE",11.1,2,0)
2^F^811.22104^1^^^F
"KEY",811.2,811.2,"A",0)
811.2^A^P^115
"KEY",811.2,811.2,"A",2,0)
^.312IA^1^1
"KEY",811.2,811.2,"A",2,1,0)
.01^811.2^1
"KEYPTR",811.2,811.2,"A")
811.2^B
"KRN",.4,962,-1)
0^1
"KRN",.4,962,0)
PXRM TAXONOMY INQUIRY^3030414.0923^@^811.2^^@^3030811
"KRN",.4,962,"F",1)
.01;C1;S1;X~1.6;C55;;X~"-----------------------------------";C1~"Brief Description:";C1;S1~.02;C5;X~"Class:";C1;S1~100;C31;X~"Sponsor:";C1;S1~
"KRN",.4,962,"F",2)
101;C31;X~"Review Date:";C1;S1~102;C31;X~"Edit History:";C1;S1~110,"Edit Date:";C5;S1~110,.01;C16;X~110,"Edit By:";C41~110,1;C50;X~
"KRN",.4,962,"F",3)
110,"Edit Comments:";C5~110,2,.01;W~"Patient Data Source:";C1;S1~4;C5;X~"Use Inactive Problems:";C1;S1~10;C5;X~"ICD9 Codes:";C1;S1~2102,"Range ";C2;S1~
"KRN",.4,962,"F",4)
2102,.01;C8;X~2102,"-"~2102,1;X~2102,"  Adjacent Lower-"~2102,2;X~2102,"  Adjacent Higher-"~2102,3;X~2102,D ICD9LIST^PXRMPTTX;Z;"D ICD9LIST^PXRMPTTX"~
"KRN",.4,962,"F",5)
"ICD0 Codes:";C1;S2~2103,"Range ";C2;S1~2103,.01;C8;X~2103,"-"~2103,1;X~2103,"  Adjacent Lower-"~2103,2;X~2103,"  Adjacent Higher-"~2103,3;X~
"KRN",.4,962,"F",6)
2103,D ICD0LIST^PXRMPTTX;Z;"D ICD0LIST^PXRMPTTX"~"CPT Codes:";C1;S2~2104,"Range ";C2;S1~2104,.01;C8;X~2104,"-"~2104,1;X~2104,"  Adjacent Lower-"~
"KRN",.4,962,"F",7)
2104,2;X~2104,"  Adjacent Higher-"~2104,3;X~2104,D ICPTLIST^PXRMPTTX;Z;"D ICPTLIST^PXRMPTTX"~
"KRN",.4,962,"H")
REMINDER TAXONOMY LIST
"KRN",19,7807,-1)
2^2
"KRN",19,7807,0)
PXRM DIALOG MANAGEMENT^Reminder Dialog Management^^M^1342^^^^^^^364^n
"KRN",19,7807,10,0)
^19.01IP^20^3
"KRN",19,7807,10,20,0)
9147^IC^
"KRN",19,7807,10,20,"^")
PXRMCS INACTIVE DIALOG CODES
"KRN",19,7807,"U")
REMINDER DIALOG MANAGEMENT
"KRN",19,9147,-1)
0^1
"KRN",19,9147,0)
PXRMCS INACTIVE DIALOG CODES^Inactive Codes Mail Message^^A^^^^^^^y^CLINICAL REMINDERS^^1
"KRN",19,9147,1,0)
^^3^3^3030327^
"KRN",19,9147,1,1,0)
This option is used to search the Dialog File #801.41 in search of ICD and 
"KRN",19,9147,1,2,0)
CPT Codes that have become inactive and send the report in a mail message to 
"KRN",19,9147,1,3,0)
the Clinical Reminders mail group
"KRN",19,9147,10.1)
Inactive Codes
"KRN",19,9147,20)
D OPTION^PXRMCSD
"KRN",19,9147,"U")
INACTIVE CODES MAIL MESSAGE
"KRN",101,6318,-1)
0^6
"KRN",101,6318,0)
PXRM CODE SET UPDATE CPT^^^A^^^^^^^^CLINICAL REMINDERS
"KRN",101,6318,1,0)
^101.06^1^1^3030408^^^
"KRN",101,6318,1,1,0)
Search for inactive CPT codes in the Dialog file #801.41
"KRN",101,6318,20)
D CPTPE^PXRMCSPE
"KRN",101,6319,-1)
0^8
"KRN",101,6319,0)
PXRM CODE SET UPDATE ICD^^^A^^^^^^^^CLINICAL REMINDERS
"KRN",101,6319,1,0)
^101.06^1^1^3030422^^^^
"KRN",101,6319,1,1,0)
Searches for all Inactive code in the Dialog file #801.41
"KRN",101,6319,20)
D ICDPE^PXRMCSPE
"KRN",101,6367,-1)
2^7
"KRN",101,6367,0)
ICD CODE UPDATE EVENT^ICD Code Update^^X^1118^^^^^^^
"KRN",101,6367,10,0)
^101.01PA^3^3
"KRN",101,6367,10,3,0)
6319^^^
"KRN",101,6367,10,3,"^")
PXRM CODE SET UPDATE ICD
"KRN",101,6368,-1)
2^3
"KRN",101,6368,0)
ICPT CODE UPDATE EVENT^CPT Code Update^^X^1118^^^^^^^
"KRN",101,6368,10,0)
^101.01PA^1^1
"KRN",101,6368,10,1,0)
6318^^^
"KRN",101,6368,10,1,"^")
PXRM CODE SET UPDATE CPT
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",364,-1)
1^1
"PKG",364,0)
CLINICAL REMINDERS^PXRM^Clinical Reminders^^^3030115
"PKG",364,20,0)
^9.402P^^
"PKG",364,22,0)
^9.49I^1^1
"PKG",364,22,1,0)
1.5^3000619^3000622^1342
"PKG",364,22,1,"PAH",1,0)
18^3030903
"PKG",364,22,1,"PAH",1,1,0)
^^2^2^3030903
"PKG",364,22,1,"PAH",1,1,1,0)
The description of this patch is found in the National Patch Module under 
"PKG",364,22,1,"PAH",1,1,2,0)
the name PXRM*1.5*18. Clinical Reminders - Code Set Versioning
"PRE")
PXRMP18E
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
18
"RTN","PXRMBXTL")
0^6^B17537149
"RTN","PXRMBXTL",1,0)
PXRMBXTL ;SLC/PKR - Build expanded taxonomies. ;04/30/2003
"RTN","PXRMBXTL",2,0)
 ;;1.5;CLINICAL REMINDERS;**2,18**;Jun 19, 2000
"RTN","PXRMBXTL",3,0)
 ;
"RTN","PXRMBXTL",4,0)
 ;=======================================================================
"RTN","PXRMBXTL",5,0)
CHECK(TAXIEN,KI) ;Check for expanded taxonomy, build it if it does not
"RTN","PXRMBXTL",6,0)
 ;exist.
"RTN","PXRMBXTL",7,0)
 N TEMP
"RTN","PXRMBXTL",8,0)
 S TEMP=$G(^PXD(811.3,TAXIEN,0))
"RTN","PXRMBXTL",9,0)
 I TEMP="" D EXPAND(TAXIEN,KI)
"RTN","PXRMBXTL",10,0)
 Q
"RTN","PXRMBXTL",11,0)
 ;
"RTN","PXRMBXTL",12,0)
 ;=======================================================================
"RTN","PXRMBXTL",13,0)
DELEXTL(TAXIEN) ;Delete an expanded taxonomy.
"RTN","PXRMBXTL",14,0)
 I '$$LOCKXTL(TAXIEN) Q
"RTN","PXRMBXTL",15,0)
 N DA,DIK
"RTN","PXRMBXTL",16,0)
 S DIK="^PXD(811.3,"
"RTN","PXRMBXTL",17,0)
 S DA=TAXIEN
"RTN","PXRMBXTL",18,0)
 D ^DIK
"RTN","PXRMBXTL",19,0)
 D ULOCKXTL(TAXIEN)
"RTN","PXRMBXTL",20,0)
 Q
"RTN","PXRMBXTL",21,0)
 ;
"RTN","PXRMBXTL",22,0)
 ;=======================================================================
"RTN","PXRMBXTL",23,0)
EXPAND(TAXIEN,KI) ;Build an expanded taxonomy. If KI is defined then
"RTN","PXRMBXTL",24,0)
 ;entry KI is being deleted so skip it. KI is checked because this
"RTN","PXRMBXTL",25,0)
 ;can be called by cross-references in 811.2.
"RTN","PXRMBXTL",26,0)
 I '$$LOCKXTL(TAXIEN) Q
"RTN","PXRMBXTL",27,0)
 N DATEBLT,HIGH,ICD0SUM,ICD9SUM,ICPTDATE,IND,LOW
"RTN","PXRMBXTL",28,0)
 N NICD0,NICD9,NICPT,NRCPT,TEMP
"RTN","PXRMBXTL",29,0)
 K ^PXD(811.3,TAXIEN)
"RTN","PXRMBXTL",30,0)
 S DATEBLT=$$NOW^XLFDT
"RTN","PXRMBXTL",31,0)
 S $P(^PXD(811.3,TAXIEN,0),U,1)=TAXIEN
"RTN","PXRMBXTL",32,0)
 S $P(^PXD(811.3,TAXIEN,0),U,2)=DATEBLT
"RTN","PXRMBXTL",33,0)
 ;
"RTN","PXRMBXTL",34,0)
 S (IND,NICD0)=0
"RTN","PXRMBXTL",35,0)
 F  S IND=+$O(^PXD(811.2,TAXIEN,80.1,IND)) Q:IND=0  D
"RTN","PXRMBXTL",36,0)
 . I KI=IND Q
"RTN","PXRMBXTL",37,0)
 . S TEMP=^PXD(811.2,TAXIEN,80.1,IND,0)
"RTN","PXRMBXTL",38,0)
 . S LOW=$P(TEMP,U,1)
"RTN","PXRMBXTL",39,0)
 . S HIGH=$P(TEMP,U,2)
"RTN","PXRMBXTL",40,0)
 . I HIGH="" S HIGH=LOW
"RTN","PXRMBXTL",41,0)
 . D ICD0(TAXIEN,LOW,HIGH,.NICD0)
"RTN","PXRMBXTL",42,0)
 S TEMP=^ICD0(0)
"RTN","PXRMBXTL",43,0)
 S ICD0SUM=+$P(TEMP,U,3)+$P(TEMP,U,4)
"RTN","PXRMBXTL",44,0)
 S $P(^PXD(811.3,TAXIEN,0),U,3,4)=NICD0_U_ICD0SUM
"RTN","PXRMBXTL",45,0)
 ;
"RTN","PXRMBXTL",46,0)
 S (IND,NICD9)=0
"RTN","PXRMBXTL",47,0)
 F  S IND=+$O(^PXD(811.2,TAXIEN,80,IND)) Q:IND=0  D
"RTN","PXRMBXTL",48,0)
 . I KI=IND Q
"RTN","PXRMBXTL",49,0)
 . S TEMP=^PXD(811.2,TAXIEN,80,IND,0)
"RTN","PXRMBXTL",50,0)
 . S LOW=$P(TEMP,U,1)
"RTN","PXRMBXTL",51,0)
 . S HIGH=$P(TEMP,U,2)
"RTN","PXRMBXTL",52,0)
 . I HIGH="" S HIGH=LOW
"RTN","PXRMBXTL",53,0)
 . D ICD9(TAXIEN,LOW,HIGH,.NICD9)
"RTN","PXRMBXTL",54,0)
 S TEMP=^ICD9(0)
"RTN","PXRMBXTL",55,0)
 S ICD9SUM=+$P(TEMP,U,3)+$P(TEMP,U,4)
"RTN","PXRMBXTL",56,0)
 S $P(^PXD(811.3,TAXIEN,0),U,5,6)=NICD9_U_ICD9SUM
"RTN","PXRMBXTL",57,0)
 ;
"RTN","PXRMBXTL",58,0)
 S (IND,NICPT,NRCPT)=0
"RTN","PXRMBXTL",59,0)
 F  S IND=+$O(^PXD(811.2,TAXIEN,81,IND)) Q:IND=0  D
"RTN","PXRMBXTL",60,0)
 . I KI=IND Q
"RTN","PXRMBXTL",61,0)
 . S TEMP=^PXD(811.2,TAXIEN,81,IND,0)
"RTN","PXRMBXTL",62,0)
 . S LOW=$P(TEMP,U,1)
"RTN","PXRMBXTL",63,0)
 . S HIGH=$P(TEMP,U,2)
"RTN","PXRMBXTL",64,0)
 . I HIGH="" S HIGH=LOW
"RTN","PXRMBXTL",65,0)
 . D ICPT(TAXIEN,LOW,HIGH,.NICPT,.NRCPT)
"RTN","PXRMBXTL",66,0)
 S ICPTDATE=$$CPTDIST^ICPTAPIU
"RTN","PXRMBXTL",67,0)
 S $P(^PXD(811.3,TAXIEN,0),U,7,9)=NICPT_U_ICPTDATE_U_NRCPT
"RTN","PXRMBXTL",68,0)
 ;
"RTN","PXRMBXTL",69,0)
 D ULOCKXTL(TAXIEN)
"RTN","PXRMBXTL",70,0)
 Q
"RTN","PXRMBXTL",71,0)
 ;
"RTN","PXRMBXTL",72,0)
 ;=======================================================================
"RTN","PXRMBXTL",73,0)
ICD0(TAXIEN,LOW,HIGH,NICD0) ;Build the list of internal entries for ICD0
"RTN","PXRMBXTL",74,0)
 ;(File 80.1).
"RTN","PXRMBXTL",75,0)
 N CODE,IEN,TEMP
"RTN","PXRMBXTL",76,0)
 S CODE=LOW
"RTN","PXRMBXTL",77,0)
 F  Q:(CODE]HIGH)!(CODE="")  D
"RTN","PXRMBXTL",78,0)
 . S TEMP=$$STATCHK^ICDAPIU(CODE,"")
"RTN","PXRMBXTL",79,0)
 . S IEN=$P(TEMP,U,2)
"RTN","PXRMBXTL",80,0)
 . I IEN'=-1,'$D(^PXD(811.3,TAXIEN,80.1,"ICD0P",IEN)) D
"RTN","PXRMBXTL",81,0)
 .. S NICD0=NICD0+1
"RTN","PXRMBXTL",82,0)
 .. S ^PXD(811.3,TAXIEN,80.1,NICD0,0)=IEN
"RTN","PXRMBXTL",83,0)
 .. S ^PXD(811.3,TAXIEN,80.1,"ICD0P",IEN,NICD0,0)=""
"RTN","PXRMBXTL",84,0)
 . S CODE=$$NEXT^ICDAPIU(CODE)
"RTN","PXRMBXTL",85,0)
 Q
"RTN","PXRMBXTL",86,0)
 ;
"RTN","PXRMBXTL",87,0)
 ;=======================================================================
"RTN","PXRMBXTL",88,0)
ICD9(TAXIEN,LOW,HIGH,NICD9) ;Build the list of internal entries for ICD9
"RTN","PXRMBXTL",89,0)
 ;(File 80).
"RTN","PXRMBXTL",90,0)
 N CODE,IEN,TEMP
"RTN","PXRMBXTL",91,0)
 S CODE=LOW
"RTN","PXRMBXTL",92,0)
 F  Q:(CODE]HIGH)!(CODE="")  D
"RTN","PXRMBXTL",93,0)
 . S TEMP=$$STATCHK^ICDAPIU(CODE,"")
"RTN","PXRMBXTL",94,0)
 . S IEN=$P(TEMP,U,2)
"RTN","PXRMBXTL",95,0)
 . I IEN'=-1,'$D(^PXD(811.3,TAXIEN,80,"ICD9P",IEN)) D
"RTN","PXRMBXTL",96,0)
 .. S NICD9=NICD9+1
"RTN","PXRMBXTL",97,0)
 .. S ^PXD(811.3,TAXIEN,80,NICD9,0)=IEN
"RTN","PXRMBXTL",98,0)
 .. S ^PXD(811.3,TAXIEN,80,"ICD9P",IEN,NICD9,0)=""
"RTN","PXRMBXTL",99,0)
 . S CODE=$$NEXT^ICDAPIU(CODE)
"RTN","PXRMBXTL",100,0)
 Q
"RTN","PXRMBXTL",101,0)
 ;
"RTN","PXRMBXTL",102,0)
 ;=======================================================================
"RTN","PXRMBXTL",103,0)
ICPT(TAXIEN,LOW,HIGH,NICPT,NRCPT) ;Build the list of internal entries
"RTN","PXRMBXTL",104,0)
 ;for ICPT (File 81).
"RTN","PXRMBXTL",105,0)
 N CODE,IEN,RADIEN,TEMP
"RTN","PXRMBXTL",106,0)
 S CODE=LOW
"RTN","PXRMBXTL",107,0)
 F  Q:(CODE]HIGH)!(CODE="")  D
"RTN","PXRMBXTL",108,0)
 . S TEMP=$$STATCHK^ICPTAPIU(CODE,"")
"RTN","PXRMBXTL",109,0)
 . S IEN=$P(TEMP,U,2)
"RTN","PXRMBXTL",110,0)
 . I IEN'=-1,'$D(^PXD(811.3,TAXIEN,81,"ICPTP",IEN)) D
"RTN","PXRMBXTL",111,0)
 .. S NICPT=NICPT+1
"RTN","PXRMBXTL",112,0)
 .. S ^PXD(811.3,TAXIEN,81,NICPT,0)=IEN
"RTN","PXRMBXTL",113,0)
 .. S ^PXD(811.3,TAXIEN,81,"ICPTP",IEN,NICPT,0)=""
"RTN","PXRMBXTL",114,0)
 ..;Determine if this is a radiology procedure.
"RTN","PXRMBXTL",115,0)
 .. S RADIEN=+$O(^RAMIS(71,"D",IEN,""))
"RTN","PXRMBXTL",116,0)
 .. I RADIEN>0 D
"RTN","PXRMBXTL",117,0)
 ... S NRCPT=NRCPT+1
"RTN","PXRMBXTL",118,0)
 ... S ^PXD(811.3,TAXIEN,71,NRCPT,0)=IEN_U_RADIEN
"RTN","PXRMBXTL",119,0)
 . S CODE=$$NEXT^ICPTAPIU(CODE)
"RTN","PXRMBXTL",120,0)
 Q
"RTN","PXRMBXTL",121,0)
 ;
"RTN","PXRMBXTL",122,0)
 ;=======================================================================
"RTN","PXRMBXTL",123,0)
LOCKXTL(TAXIEN) ;Lock the expanded taxonomy entry. This may be called during
"RTN","PXRMBXTL",124,0)
 ;reminder evalution in which case PXRMXTLK will be defined or during
"RTN","PXRMBXTL",125,0)
 ;a taxonomy edit in which case PXRMXTLK will be undefined.
"RTN","PXRMBXTL",126,0)
 N IND,LC,LOCK
"RTN","PXRMBXTL",127,0)
 I $D(PXRMXTLK) S LC=30
"RTN","PXRMBXTL",128,0)
 E  S LC=2
"RTN","PXRMBXTL",129,0)
 S LOCK=0
"RTN","PXRMBXTL",130,0)
 F IND=1:1:LC Q:LOCK  D
"RTN","PXRMBXTL",131,0)
 . L +^PXD(811.3,TAXIEN):1
"RTN","PXRMBXTL",132,0)
 . S LOCK=$T
"RTN","PXRMBXTL",133,0)
 ;If we can't a get a lock take appropriate action.
"RTN","PXRMBXTL",134,0)
 I 'LOCK D
"RTN","PXRMBXTL",135,0)
 . I $D(PXRMXTLK) S PXRMXTLK=TAXIEN
"RTN","PXRMBXTL",136,0)
 . E  D
"RTN","PXRMBXTL",137,0)
 .. N TEXT
"RTN","PXRMBXTL",138,0)
 .. S TEXT="Could not get lock for expanded taxonomy "_TAXIEN_" try again later."
"RTN","PXRMBXTL",139,0)
 .. D EN^DDIOL(TEXT)
"RTN","PXRMBXTL",140,0)
 Q LOCK
"RTN","PXRMBXTL",141,0)
 ;
"RTN","PXRMBXTL",142,0)
 ;=======================================================================
"RTN","PXRMBXTL",143,0)
ULOCKXTL(TAXIEN) ;Unlock the expanded taxonomy.
"RTN","PXRMBXTL",144,0)
 L -^PXD(811.3,TAXIEN)
"RTN","PXRMBXTL",145,0)
 Q
"RTN","PXRMBXTL",146,0)
 ;
"RTN","PXRMCODE")
0^7^B6672018
"RTN","PXRMCODE",1,0)
PXRMCODE ;SLC/PKR - Routines for handling standard coded items. ;04/23/2003
"RTN","PXRMCODE",2,0)
 ;;1.5;CLINICAL REMINDERS;**18**;Jun 19, 2000
"RTN","PXRMCODE",3,0)
 ;
"RTN","PXRMCODE",4,0)
 ;=======================================================================
"RTN","PXRMCODE",5,0)
VHICD0(DA,X) ;This is the input transform for ICD0 codes subfile 811.22103
"RTN","PXRMCODE",6,0)
 ;high code to make sure it is greater than the low code.
"RTN","PXRMCODE",7,0)
 ;Do not execute as part of exchange.
"RTN","PXRMCODE",8,0)
 I $G(PXRMEXCH) Q 1
"RTN","PXRMCODE",9,0)
 N VALID
"RTN","PXRMCODE",10,0)
 S VALID=$$VICD0(X)
"RTN","PXRMCODE",11,0)
 I 'VALID Q VALID
"RTN","PXRMCODE",12,0)
 ;Make sure the high code follows the low code.
"RTN","PXRMCODE",13,0)
 N LOW
"RTN","PXRMCODE",14,0)
 S LOW=$P(^PXD(811.2,DA(1),80.1,DA,0),U,1)
"RTN","PXRMCODE",15,0)
 S VALID=$S(X]LOW:1,X=LOW:1,1:0)
"RTN","PXRMCODE",16,0)
 I 'VALID D EN^DDIOL("The high code must be equal to or higher than the low code")
"RTN","PXRMCODE",17,0)
 Q VALID
"RTN","PXRMCODE",18,0)
 ;
"RTN","PXRMCODE",19,0)
 ;=======================================================================
"RTN","PXRMCODE",20,0)
VHICD9(DA,X) ;This is the input transform for ICD9 codes subfile 811.22102
"RTN","PXRMCODE",21,0)
 ;high code to make sure it is greater than the low code.
"RTN","PXRMCODE",22,0)
 ;Do not execute as part of exchange.
"RTN","PXRMCODE",23,0)
 I $G(PXRMEXCH) Q 1
"RTN","PXRMCODE",24,0)
 N VALID
"RTN","PXRMCODE",25,0)
 S VALID=$$VICD9(X)
"RTN","PXRMCODE",26,0)
 I 'VALID Q VALID
"RTN","PXRMCODE",27,0)
 ;Make sure the high code follows the low code.
"RTN","PXRMCODE",28,0)
 N LOW
"RTN","PXRMCODE",29,0)
 S LOW=$P(^PXD(811.2,DA(1),80,DA,0),U,1)
"RTN","PXRMCODE",30,0)
 S VALID=$S(X]LOW:1,X=LOW:1,1:0)
"RTN","PXRMCODE",31,0)
 I 'VALID D EN^DDIOL("The high code must be equal to or higher than the low code")
"RTN","PXRMCODE",32,0)
 Q VALID
"RTN","PXRMCODE",33,0)
 ;
"RTN","PXRMCODE",34,0)
 ;=======================================================================
"RTN","PXRMCODE",35,0)
VHICPT(DA,X) ;This is the input transform for ICPT codes subfile 811.22104
"RTN","PXRMCODE",36,0)
 ;high code to make sure it is greater than the low code.
"RTN","PXRMCODE",37,0)
 ;Do not execute as part of exchange.
"RTN","PXRMCODE",38,0)
 I $G(PXRMEXCH) Q 1
"RTN","PXRMCODE",39,0)
 N VALID
"RTN","PXRMCODE",40,0)
 S VALID=$$VICPT(X)
"RTN","PXRMCODE",41,0)
 I 'VALID Q VALID
"RTN","PXRMCODE",42,0)
 ;Make sure the high code follows the low code.
"RTN","PXRMCODE",43,0)
 N LOW
"RTN","PXRMCODE",44,0)
 S LOW=$P(^PXD(811.2,DA(1),81,DA,0),U,1)
"RTN","PXRMCODE",45,0)
 S VALID=$S(X]LOW:1,X=LOW:1,1:0)
"RTN","PXRMCODE",46,0)
 I 'VALID D EN^DDIOL("The high code must be equal to or higher than the low code")
"RTN","PXRMCODE",47,0)
 Q VALID
"RTN","PXRMCODE",48,0)
 ;
"RTN","PXRMCODE",49,0)
 ;=======================================================================
"RTN","PXRMCODE",50,0)
VICD0(X) ;This is the input transform for ICD0 codes, subfile 811.22102.
"RTN","PXRMCODE",51,0)
 ;Do not execute as part of exchange.
"RTN","PXRMCODE",52,0)
 I $G(PXRMEXCH) Q 1
"RTN","PXRMCODE",53,0)
 N RETVAL,TEMP,TEXT
"RTN","PXRMCODE",54,0)
 S RETVAL=$$CODE^PXRMVAL(X,80.1)
"RTN","PXRMCODE",55,0)
 I '(+RETVAL) D
"RTN","PXRMCODE",56,0)
 . S TEXT=X_"-"_$P(RETVAL,U,4)
"RTN","PXRMCODE",57,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMCODE",58,0)
 . S TEMP=$P(RETVAL,U,3)
"RTN","PXRMCODE",59,0)
 . I TEMP'="" D
"RTN","PXRMCODE",60,0)
 .. S TEXT="Did you mean "_TEMP
"RTN","PXRMCODE",61,0)
 .. D EN^DDIOL(TEXT)
"RTN","PXRMCODE",62,0)
 Q $P(RETVAL,U,1)
"RTN","PXRMCODE",63,0)
 ;
"RTN","PXRMCODE",64,0)
 ;=======================================================================
"RTN","PXRMCODE",65,0)
VICD9(X) ;This is the input transform for ICD9 codes subfile 811.22103.
"RTN","PXRMCODE",66,0)
 ;Do not execute as part of exchange.
"RTN","PXRMCODE",67,0)
 I $G(PXRMEXCH) Q 1
"RTN","PXRMCODE",68,0)
 N RETVAL,TEMP,TEXT
"RTN","PXRMCODE",69,0)
 S RETVAL=$$CODE^PXRMVAL(X,80)
"RTN","PXRMCODE",70,0)
 I '(+RETVAL) D
"RTN","PXRMCODE",71,0)
 . S TEXT=X_"-"_$P(RETVAL,U,4)
"RTN","PXRMCODE",72,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMCODE",73,0)
 . S TEMP=$P(RETVAL,U,3)
"RTN","PXRMCODE",74,0)
 . I TEMP'="" D
"RTN","PXRMCODE",75,0)
 .. S TEXT="Did you mean "_TEMP
"RTN","PXRMCODE",76,0)
 .. D EN^DDIOL(TEXT)
"RTN","PXRMCODE",77,0)
 Q $P(RETVAL,U,1)
"RTN","PXRMCODE",78,0)
 ;
"RTN","PXRMCODE",79,0)
 ;=======================================================================
"RTN","PXRMCODE",80,0)
VICPT(X) ;This is the input transform for CPT codes subfile 811.22104.
"RTN","PXRMCODE",81,0)
 ;Do not execute as part of exchange.
"RTN","PXRMCODE",82,0)
 I $G(PXRMEXCH) Q 1
"RTN","PXRMCODE",83,0)
 N RETVAL,TEMP,TEXT
"RTN","PXRMCODE",84,0)
 S RETVAL=$$CODE^PXRMVAL(X,81)
"RTN","PXRMCODE",85,0)
 I '(+RETVAL) D
"RTN","PXRMCODE",86,0)
 . S TEXT=X_"-"_$P(RETVAL,U,4)
"RTN","PXRMCODE",87,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMCODE",88,0)
 . S TEMP=$P(RETVAL,U,3)
"RTN","PXRMCODE",89,0)
 . I TEMP'="" D
"RTN","PXRMCODE",90,0)
 .. S TEXT="Did you mean "_TEMP
"RTN","PXRMCODE",91,0)
 .. D EN^DDIOL(TEXT)
"RTN","PXRMCODE",92,0)
 Q $P(RETVAL,U,1)
"RTN","PXRMCODE",93,0)
 ;
"RTN","PXRMCSD")
0^1^B75969117
"RTN","PXRMCSD",1,0)
PXRMCSD ;SLC/JVS - Code Set Version-dialog file ;04/10/2003  12:02
"RTN","PXRMCSD",2,0)
 ;;1.5;CLINICAL REMINDERS;**18**;Jun 19, 2000
"RTN","PXRMCSD",3,0)
 ;Variable List
"RTN","PXRMCSD",4,0)
 ;TMP        =Mail message array
"RTN","PXRMCSD",5,0)
 ;DLGNAME    =Dialogue Name .01 field
"RTN","PXRMCSD",6,0)
 ;EFFDATE    =Effective Date
"RTN","PXRMCSD",7,0)
 ;FILE       =Name of the Glpbal (ie ICPT or ICD9)
"RTN","PXRMCSD",8,0)
 ;VAR,VAR3   =Variable Pointer
"RTN","PXRMCSD",9,0)
 ;VARIEN     =Ien from Variable Pointer
"RTN","PXRMCSD",10,0)
 ;VRSTATUS   =Status of Code in form 1 or 0
"RTN","PXRMCSD",11,0)
 ;VARDESC    =Code Text Description
"RTN","PXRMCSD",12,0)
 ;STATUS     =External form of Code Status
"RTN","PXRMCSD",13,0)
 ;NUM        =Line Number
"RTN","PXRMCSD",14,0)
 ;
"RTN","PXRMCSD",15,0)
 Q
"RTN","PXRMCSD",16,0)
TASKALL ;TASK for all codes
"RTN","PXRMCSD",17,0)
 S ZTRTN="DLG^PXRMCSD(""ALL"")"
"RTN","PXRMCSD",18,0)
 S ZTDESC="Finding Inactive Codes in Dialog file"
"RTN","PXRMCSD",19,0)
 S ZTIO=""
"RTN","PXRMCSD",20,0)
 S ZTDTH=$H
"RTN","PXRMCSD",21,0)
 D ^%ZTLOAD
"RTN","PXRMCSD",22,0)
 Q
"RTN","PXRMCSD",23,0)
TASKCPT ;TASK for Icpt codes Diagnosis
"RTN","PXRMCSD",24,0)
 S ZTRTN="DLG^PXRMCSD(""ICPT"")"
"RTN","PXRMCSD",25,0)
 S ZTDESC="Finding Inactive Codes in Dialog file"
"RTN","PXRMCSD",26,0)
 S ZTIO=""
"RTN","PXRMCSD",27,0)
 S ZTDTH=$H
"RTN","PXRMCSD",28,0)
 D ^%ZTLOAD
"RTN","PXRMCSD",29,0)
 Q
"RTN","PXRMCSD",30,0)
TASKICD ;TASK for ICD codes
"RTN","PXRMCSD",31,0)
 S ZTRTN="DLG^PXRMCSD(""ICD9"")"
"RTN","PXRMCSD",32,0)
 S ZTDESC="Finding Inactive Codes in Dialog file"
"RTN","PXRMCSD",33,0)
 S ZTIO=""
"RTN","PXRMCSD",34,0)
 S ZTDTH=$H
"RTN","PXRMCSD",35,0)
 D ^%ZTLOAD
"RTN","PXRMCSD",36,0)
 Q
"RTN","PXRMCSD",37,0)
OPTION  ;Option entry point for dir call
"RTN","PXRMCSD",38,0)
 N X,Y,%,%H,X
"RTN","PXRMCSD",39,0)
 K DIR,Y,%I
"RTN","PXRMCSD",40,0)
 S DIR(0)="SX^1:ICPT Codes;2:ICD9 Codes;3:ALL Codes"
"RTN","PXRMCSD",41,0)
 S DIR("A")="Select Codes or All of the codes or ""^"" to exit"
"RTN","PXRMCSD",42,0)
 S DIR("?",1)="This option is use to evaluate the various codes"
"RTN","PXRMCSD",43,0)
 S DIR("?",2)="used in the reminder dialogs as Finding Items and"
"RTN","PXRMCSD",44,0)
 S DIR("?",3)="Additonal Finding Items. It will report by mail message"
"RTN","PXRMCSD",45,0)
 S DIR("?",4)="which codes are now inactive or are set to become"
"RTN","PXRMCSD",46,0)
 S DIR("?",5)="in the future."
"RTN","PXRMCSD",47,0)
 S DIR("B")="3"
"RTN","PXRMCSD",48,0)
 S DIR("?")="Select a code set to be evaluated"
"RTN","PXRMCSD",49,0)
 D ^DIR
"RTN","PXRMCSD",50,0)
 I Y=1 W !,"Check Mail for results....." S ZTRTN="DLG^PXRMCSD(""ICPT"",1)"
"RTN","PXRMCSD",51,0)
 I Y=2 W !,"Check Mail for results....." S ZTRTN="DLG^PXRMCSD(""ICD9"",1)"
"RTN","PXRMCSD",52,0)
 I Y=3 W !,"Check Mail for results....." S ZTRTN="DLG^PXRMCSD(""ALL"",1)"
"RTN","PXRMCSD",53,0)
 S ZTDESC="Finding Inactive Codes in Dialog file"
"RTN","PXRMCSD",54,0)
 S ZTIO=""
"RTN","PXRMCSD",55,0)
 D NOW^%DTC S ZTDTH=%H
"RTN","PXRMCSD",56,0)
 D ^%ZTLOAD
"RTN","PXRMCSD",57,0)
 K DIR,Y,%I,X
"RTN","PXRMCSD",58,0)
 Q
"RTN","PXRMCSD",59,0)
 ;
"RTN","PXRMCSD",60,0)
DLG(GLOBAL,OPTION) ;ENTRY POINT
"RTN","PXRMCSD",61,0)
 ;Test entry point to $O through dialogues
"RTN","PXRMCSD",62,0)
 ;GLOBAL = Which code set to check out.
"RTN","PXRMCSD",63,0)
 ;GLOBAL ="ICPT" OR "ICD9" OR "ALL"
"RTN","PXRMCSD",64,0)
 ;OPTION = From and option 1=yes null=no
"RTN","PXRMCSD",65,0)
 ;^PXRMD(801.41,IEN,1) 5TH PIECE
"RTN","PXRMCSD",66,0)
 Q:'$D(GLOBAL)
"RTN","PXRMCSD",67,0)
 N IEN,VAR,STATUS,NUM,ITEM,FILE,VARDIS,LINE,VARTYP
"RTN","PXRMCSD",68,0)
 N VARIEN,VRSTATUS,VARDESC,DLGNAME,VARIENX,ARRY,VARDIS
"RTN","PXRMCSD",69,0)
 N TMP
"RTN","PXRMCSD",70,0)
 ;=====Set variables====================================
"RTN","PXRMCSD",71,0)
 S TMP="^TMP(""PXRMXMZ"",$J,NUM,0)"
"RTN","PXRMCSD",72,0)
 S NUM=0
"RTN","PXRMCSD",73,0)
 S LINE="S NUM=NUM+1"
"RTN","PXRMCSD",74,0)
 D TEXT
"RTN","PXRMCSD",75,0)
 S IEN=0 F  S IEN=$O(^PXRMD(801.41,IEN)) Q:IEN'>0  D
"RTN","PXRMCSD",76,0)
 .S VAR=$P($G(^PXRMD(801.41,IEN,1)),"^",5) ;varable pointer
"RTN","PXRMCSD",77,0)
 .S DLGNAME=$P($G(^PXRMD(801.41,IEN,0)),"^",1)
"RTN","PXRMCSD",78,0)
 .I +VAR'=0 S ITEM=" FI" D
"RTN","PXRMCSD",79,0)
 ..;============ICPT(=================================
"RTN","PXRMCSD",80,0)
 ..N VARIEN,CPTDATA,IADATE,VARCODE,VARDESC,VARPAST,VARTYP,VARDIS,VART
"RTN","PXRMCSD",81,0)
 ..I $P(VAR,";",2)="ICPT(",((GLOBAL="ICPT")!(GLOBAL="ALL")) D
"RTN","PXRMCSD",82,0)
 ...S FILE=" CPT"
"RTN","PXRMCSD",83,0)
 ...S VARIEN=$P(VAR,";",1) ;Ien from variable pointer
"RTN","PXRMCSD",84,0)
 ...S CPTDATA=$$CPTA^PXRMCSU(VARIEN) ;ALL Cpt data
"RTN","PXRMCSD",85,0)
 ...I ($P(CPTDATA,"^",7)=0) D
"RTN","PXRMCSD",86,0)
 ....S IADATE=$$CONV^PXRMCSU($P(CPTDATA,"^",8)) ;Convert Inactive date
"RTN","PXRMCSD",87,0)
 ....S VARCODE=$$CPT^PXRMCSU(VARIEN) ;Code value
"RTN","PXRMCSD",88,0)
 ....S VARDESC=$$CPTD^PXRMCSU(VARIEN) ;Description
"RTN","PXRMCSD",89,0)
 ....S VARPAST=$P(CPTDATA,"^",11)
"RTN","PXRMCSD",90,0)
 ....D GETS^DIQ(801.41,IEN,"3;4","E","VART") S VARIENX=IEN_"," D
"RTN","PXRMCSD",91,0)
 .....S VARTYP=$G(VART(801.41,VARIENX,4,"E")) ;element type
"RTN","PXRMCSD",92,0)
 .....S VARDIS=$G(VART(801.41,VARIENX,3,"E")) ;element disabled
"RTN","PXRMCSD",93,0)
 ....D TMP
"RTN","PXRMCSD",94,0)
 ..;============ICD9(=================================
"RTN","PXRMCSD",95,0)
 ..N VARIEN,ICD9DATA,IADATE,VARCODE,VARDESC,VARPAST,VARTYP,VARDIS,VART
"RTN","PXRMCSD",96,0)
 ..I $P(VAR,";",2)="ICD9(",((GLOBAL="ICD9")!(GLOBAL="ALL")) D
"RTN","PXRMCSD",97,0)
 ...S FILE="ICD9"
"RTN","PXRMCSD",98,0)
 ...S VARIEN=$P(VAR,";",1) ;Ien from variable pointer
"RTN","PXRMCSD",99,0)
 ...S ICD9DATA=$$ICD9A^PXRMCSU(VARIEN) ;All ICD9 data
"RTN","PXRMCSD",100,0)
 ...I ($P(ICD9DATA,"^",10)=0) D
"RTN","PXRMCSD",101,0)
 ....S IADATE=$$CONV^PXRMCSU($P(ICD9DATA,"^",12)) ;Conver Inact date
"RTN","PXRMCSD",102,0)
 ....S VARCODE=$$ICD9^PXRMCSU(VARIEN) ;Code
"RTN","PXRMCSD",103,0)
 ....S VARDESC=$$ICD9D^PXRMCSU(VARIEN) ;Description
"RTN","PXRMCSD",104,0)
 ....S VARPAST=$P(ICD9DATA,"^",19)
"RTN","PXRMCSD",105,0)
 ....D GETS^DIQ(801.41,IEN,"3;4","E","VART") S VARIENX=IEN_"," D
"RTN","PXRMCSD",106,0)
 .....S VARTYP=$G(VART(801.41,VARIENX,4,"E")) ;element type
"RTN","PXRMCSD",107,0)
 .....S VARDIS=$G(VART(801.41,VARIENX,3,"E")) ;element description
"RTN","PXRMCSD",108,0)
 ....D TMP
"RTN","PXRMCSD",109,0)
 ..D DLG3
"RTN","PXRMCSD",110,0)
 S XMSUB="Reminder Dialog "_$S(GLOBAL="ALL":"ICD9 AND CPT",GLOBAL="ICPT":"CPT",1:GLOBAL)_" Code changes"
"RTN","PXRMCSD",111,0)
 D SEND^PXRMMSG(XMSUB)
"RTN","PXRMCSD",112,0)
 K ^TMP("PXRMXUZ",$J),XMDUN,XMSUB,XMUSB
"RTN","PXRMCSD",113,0)
 S ZTREQ="@"
"RTN","PXRMCSD",114,0)
 Q
"RTN","PXRMCSD",115,0)
DLG3 ;^PXRMD(801.41,IEN,3,IEN3,0) 1ST PIECE
"RTN","PXRMCSD",116,0)
 N IEN3,VAR3
"RTN","PXRMCSD",117,0)
 S IEN3=0 F  S IEN3=$O(^PXRMD(801.41,IEN,3,IEN3)) Q:IEN3'>0  D
"RTN","PXRMCSD",118,0)
 .S VAR3=$P($G(^PXRMD(801.41,IEN,3,IEN3,0)),"^",1)
"RTN","PXRMCSD",119,0)
 .I +VAR3'=0 S ITEM="AFI" D
"RTN","PXRMCSD",120,0)
 ..;================ICPT================================= 
"RTN","PXRMCSD",121,0)
 ..N VARIEN,CPTDATA,IADATE,VARCODE,VARDESC,VARPAST,VARTYP,VARDIS,VART
"RTN","PXRMCSD",122,0)
 ..I $P(VAR3,";",2)="ICPT(",((GLOBAL="ICPT")!(GLOBAL="ALL")) D
"RTN","PXRMCSD",123,0)
 ...S FILE=" CPT"
"RTN","PXRMCSD",124,0)
 ...S VARIEN=$P(VAR3,";",1) ;Ien from variable pointer
"RTN","PXRMCSD",125,0)
 ...S CPTDATA=$$CPTA^PXRMCSU(VARIEN) ;All CPT data
"RTN","PXRMCSD",126,0)
 ...I ($P(CPTDATA,"^",7)=0) D
"RTN","PXRMCSD",127,0)
 ....S IADATE=$$CONV^PXRMCSU($P(CPTDATA,"^",8)) ;Convert Inac Date
"RTN","PXRMCSD",128,0)
 ....S VARCODE=$$CPT^PXRMCSU(VARIEN) ;Code
"RTN","PXRMCSD",129,0)
 ....S VARDESC=$$CPTD^PXRMCSU(VARIEN) ;Description
"RTN","PXRMCSD",130,0)
 ....S VARPAST=$P(CPTDATA,"^",11)
"RTN","PXRMCSD",131,0)
 ....D GETS^DIQ(801.41,IEN,"3;4","E","VART") S VARIENX=IEN_"," D
"RTN","PXRMCSD",132,0)
 .....S VARTYP=$G(VART(801.41,VARIENX,4,"E")) ;element type
"RTN","PXRMCSD",133,0)
 .....S VARDIS=$G(VART(801.41,VARIENX,3,"E")) ;element description
"RTN","PXRMCSD",134,0)
 ....D TMP
"RTN","PXRMCSD",135,0)
 ..;================ICD9=================================
"RTN","PXRMCSD",136,0)
 ..N VARIEN,ICD9DATA,IADATE,VARCODE,VARDESC,VARPAST,VARTYP,VARDIS,VART
"RTN","PXRMCSD",137,0)
 ..I $P(VAR3,";",2)="ICD9(",((GLOBAL="ICD9")!(GLOBAL="ALL")) D
"RTN","PXRMCSD",138,0)
 ...S FILE="ICD9"
"RTN","PXRMCSD",139,0)
 ...S VARIEN=$P(VAR3,";",1) ;Ien from variable pointer
"RTN","PXRMCSD",140,0)
 ...S ICD9DATA=$$ICD9A^PXRMCSU(VARIEN) ;All ICD9 data
"RTN","PXRMCSD",141,0)
 ...I ($P(ICD9DATA,"^",10)=0) D
"RTN","PXRMCSD",142,0)
 ....S IADATE=$$CONV^PXRMCSU($P(ICD9DATA,"^",12)) ;Conver Inac date
"RTN","PXRMCSD",143,0)
 ....S VARCODE=$$ICD9^PXRMCSU(VARIEN) ;Code
"RTN","PXRMCSD",144,0)
 ....S VARDESC=$$ICD9D^PXRMCSU(VARIEN) ;Description
"RTN","PXRMCSD",145,0)
 ....S VARPAST=$P(ICD9DATA,"^",19)
"RTN","PXRMCSD",146,0)
 ....D GETS^DIQ(801.41,IEN,"3;4","E","VART") S VARIENX=IEN_"," D
"RTN","PXRMCSD",147,0)
 .....S VARTYP=$G(VART(801.41,VARIENX,4,"E")) ;element type
"RTN","PXRMCSD",148,0)
 .....S VARDIS=$G(VART(801.41,VARIENX,3,"E")) ;element desc
"RTN","PXRMCSD",149,0)
 ....D TMP
"RTN","PXRMCSD",150,0)
 Q
"RTN","PXRMCSD",151,0)
SUB ;==============Sub Routines=============================
"RTN","PXRMCSD",152,0)
 ;SET MAIL MESSAGE LINE
"RTN","PXRMCSD",153,0)
TMP ;Set tmp global lines
"RTN","PXRMCSD",154,0)
 X LINE S @TMP="    "_FILE_" "_ITEM_": "_VARCODE_" (Inactive "_$G(IADATE)_")"
"RTN","PXRMCSD",155,0)
 S VARDIS=$S($G(VARDIS)'="":"(Disabled)",1:"(Enabled)")
"RTN","PXRMCSD",156,0)
 S VARTYP=$G(VARTYP)
"RTN","PXRMCSD",157,0)
 X LINE S @TMP="    Found in: "_DLGNAME_" ["_VARTYP_"]"_" "_VARDIS
"RTN","PXRMCSD",158,0)
 D PARENT(IEN)
"RTN","PXRMCSD",159,0)
 Q
"RTN","PXRMCSD",160,0)
MESS ;Mail Message Static Text
"RTN","PXRMCSD",161,0)
 Q
"RTN","PXRMCSD",162,0)
MESS1 ;
"RTN","PXRMCSD",163,0)
 N GLOBALX
"RTN","PXRMCSD",164,0)
 S GLOBALX=$S(GLOBAL="ICPT":"CPT",GLOBAL="ICD9":"ICD9",GLOBAL="ALL":"CPT and/or ICD9",1:"")
"RTN","PXRMCSD",165,0)
 I $G(OPTION)=1 S MESS1="Review of inactive codes as of "_$$CONV^PXRMCSU(DT)
"RTN","PXRMCSD",166,0)
 I $G(OPTION)="" S MESS1="There was a "_GLOBALX_" code set update on "_$$CONV^PXRMCSU(DT)
"RTN","PXRMCSD",167,0)
 Q
"RTN","PXRMCSD",168,0)
MESS2 ;
"RTN","PXRMCSD",169,0)
 ;;
"RTN","PXRMCSD",170,0)
 ;;Please review the FINDING ITEM and ADDITIONAL FINDING items
"RTN","PXRMCSD",171,0)
 ;;currently used by REMINDER DIALOGS that may need changes.
"RTN","PXRMCSD",172,0)
 ;;
"RTN","PXRMCSD",173,0)
 ;;Consider adding another ADDITIONAL FINDING item to the reminder dialog
"RTN","PXRMCSD",174,0)
 ;;entry which will be active. This will allow the dialog to have old
"RTN","PXRMCSD",175,0)
 ;;and new codes associated with a dialog element, which will use
"RTN","PXRMCSD",176,0)
 ;;the item that is active for the encounter date.
"RTN","PXRMCSD",177,0)
 ;;Eventually, the inactive FINDING ITEM or ADDITIONAL FINDING items
"RTN","PXRMCSD",178,0)
 ;;should be removed from the dialog element.
"RTN","PXRMCSD",179,0)
 ;;
"RTN","PXRMCSD",180,0)
 ;;Note: FI=FINDING ITEM field    AFI=ADDITIONAL FINDING ITEMS field
"RTN","PXRMCSD",181,0)
 ;;Note: [finding type]  (status)
"RTN","PXRMCSD",182,0)
 ;;_______________________________________________________________________________
"RTN","PXRMCSD",183,0)
 Q
"RTN","PXRMCSD",184,0)
MESS3 ;
"RTN","PXRMCSD",185,0)
 ;;Report of Inactive ICD9 and CPT Codes referenced in the Reminder
"RTN","PXRMCSD",186,0)
 ;;Dialog file.
"RTN","PXRMCSD",187,0)
 ;;
"RTN","PXRMCSD",188,0)
 ;;Note: FI=FINDING ITEM field    AFI=ADDITIONAL FINDING ITEMS field
"RTN","PXRMCSD",189,0)
 ;;Note: [finding type]  (status)
"RTN","PXRMCSD",190,0)
 ;;_______________________________________________________________________________
"RTN","PXRMCSD",191,0)
 Q
"RTN","PXRMCSD",192,0)
TEXT ;display text
"RTN","PXRMCSD",193,0)
 N MESS1,PXRMI
"RTN","PXRMCSD",194,0)
 I GLOBAL="ALL" D
"RTN","PXRMCSD",195,0)
 .F PXRMI=1:1:6 X LINE S @TMP=$P($T(MESS3+PXRMI),";",3)
"RTN","PXRMCSD",196,0)
 I GLOBAL'="ALL" D
"RTN","PXRMCSD",197,0)
 .D MESS1 X LINE S @TMP=MESS1
"RTN","PXRMCSD",198,0)
 .F PXRMI=1:1:14 D
"RTN","PXRMCSD",199,0)
 ..X LINE S @TMP=$P($T(MESS2+PXRMI),";",3)
"RTN","PXRMCSD",200,0)
 Q
"RTN","PXRMCSD",201,0)
PARENT(PARXY) ;Get the Parent Dialog Element of the Dialog Element
"RTN","PXRMCSD",202,0)
 N PARY,PARXYVAR,PARX,PXRMTYPE
"RTN","PXRMCSD",203,0)
 S PARX=0 F  S PARX=$O(^PXRMD(801.41,PARX)) Q:PARX<1  D
"RTN","PXRMCSD",204,0)
 .S PARY=0 F  S PARY=$O(^PXRMD(801.41,PARX,10,"D",PARY)) Q:PARY<1  D 
"RTN","PXRMCSD",205,0)
 ..I PARXY=PARY D GETS^DIQ(801.41,PARX,"3;4","E","PXRMTYPE") D
"RTN","PXRMCSD",206,0)
 ...S PARXYVAR=PARX_",",VARDIS=$G(PXRMTYPE(801.41,PARXYVAR,3,"E")),VARDIS=$S($G(VARDIS)'="":"(Disabled)",1:"(Enabled)")
"RTN","PXRMCSD",207,0)
 ...X LINE S @TMP="     Used by: "_$P($G(^PXRMD(801.41,PARX,0)),"^",1)_" ["_$G(PXRMTYPE(801.41,PARXYVAR,4,"E"))_"]"_" "_VARDIS
"RTN","PXRMCSD",208,0)
 X LINE S @TMP="___________________________________________________________________________"
"RTN","PXRMCSD",209,0)
 Q
"RTN","PXRMCSPE")
0^8^B1065787
"RTN","PXRMCSPE",1,0)
PXRMCSPE ;SLC/PKR - Entry points for CSV protocol event point.;04/22/2003
"RTN","PXRMCSPE",2,0)
 ;;1.5;CLINICAL REMINDERS;**18**;Jun 19, 2000
"RTN","PXRMCSPE",3,0)
 ;
"RTN","PXRMCSPE",4,0)
 Q
"RTN","PXRMCSPE",5,0)
 ;===============================================================
"RTN","PXRMCSPE",6,0)
CPTPE ;CPT code set update
"RTN","PXRMCSPE",7,0)
 S ZTDESC="Clinical Reminders CPT code set update"
"RTN","PXRMCSPE",8,0)
 S ZTDTH=$H
"RTN","PXRMCSPE",9,0)
 S ZTIO=""
"RTN","PXRMCSPE",10,0)
 S ZTRTN="CPT^PXRMCSPE"
"RTN","PXRMCSPE",11,0)
 D ^%ZTLOAD
"RTN","PXRMCSPE",12,0)
 W !,"Task number ",ZTSK," queued."
"RTN","PXRMCSPE",13,0)
 Q
"RTN","PXRMCSPE",14,0)
 ;
"RTN","PXRMCSPE",15,0)
 ;===============================================================
"RTN","PXRMCSPE",16,0)
CPT ;Do the CPT update.
"RTN","PXRMCSPE",17,0)
 D CSU^PXRMCSTX("CPT")
"RTN","PXRMCSPE",18,0)
 D DLG^PXRMCSD("ICPT")
"RTN","PXRMCSPE",19,0)
 S ZTREQ="@"
"RTN","PXRMCSPE",20,0)
 Q
"RTN","PXRMCSPE",21,0)
 ;
"RTN","PXRMCSPE",22,0)
 ;===============================================================
"RTN","PXRMCSPE",23,0)
ICDPE ;ICD code set update.
"RTN","PXRMCSPE",24,0)
 S ZTDESC="Clinical Reminders ICD code set update"
"RTN","PXRMCSPE",25,0)
 S ZTDTH=$H
"RTN","PXRMCSPE",26,0)
 S ZTIO=""
"RTN","PXRMCSPE",27,0)
 S ZTRTN="ICD^PXRMCSPE"
"RTN","PXRMCSPE",28,0)
 D ^%ZTLOAD
"RTN","PXRMCSPE",29,0)
 W !,"Task number ",ZTSK," queued."
"RTN","PXRMCSPE",30,0)
 Q
"RTN","PXRMCSPE",31,0)
 ;
"RTN","PXRMCSPE",32,0)
 ;===============================================================
"RTN","PXRMCSPE",33,0)
ICD ;Do the ICD update.
"RTN","PXRMCSPE",34,0)
 D CSU^PXRMCSTX("ICD")
"RTN","PXRMCSPE",35,0)
 D DLG^PXRMCSD("ICD9")
"RTN","PXRMCSPE",36,0)
 S ZTREQ="@"
"RTN","PXRMCSPE",37,0)
 Q
"RTN","PXRMCSPE",38,0)
 ;
"RTN","PXRMCSSC")
0^10^B5002819
"RTN","PXRMCSSC",1,0)
PXRMCSSC ;SLC/PKR - Routines for taxonomy code set update. ;04/10/2003
"RTN","PXRMCSSC",2,0)
 ;;1.5;CLINICAL REMINDERS;**18**;Jun 19, 2000
"RTN","PXRMCSSC",3,0)
 ;
"RTN","PXRMCSSC",4,0)
 ;======================================================================
"RTN","PXRMCSSC",5,0)
SELCODE(FILENUM,TAXIEN,LC,TAXMSG) ;Create the message for selectable
"RTN","PXRMCSSC",6,0)
 ;codes. Check for codes that are currently inactive or will be
"RTN","PXRMCSSC",7,0)
 ;inactive within the next 180 days.
"RTN","PXRMCSSC",8,0)
 N CODE,CPTCLST,CPTFLST,DT6M,ICD9CLST,ICD9FLST,IEN,ILC,MSGARR,NODE,STATUS
"RTN","PXRMCSSC",9,0)
 ;Go through the selectable codes making an ordered list.
"RTN","PXRMCSSC",10,0)
 I FILENUM'=80,FILENUM'=81 Q
"RTN","PXRMCSSC",11,0)
 S DT6M=$$DT6M^PXRMCSU(DT)
"RTN","PXRMCSSC",12,0)
 S ILC=0
"RTN","PXRMCSSC",13,0)
 I FILENUM=80 D
"RTN","PXRMCSSC",14,0)
 . S IEN=0
"RTN","PXRMCSSC",15,0)
 . F  S IEN=$O(^PXD(811.2,TAXIEN,"SDX","B",IEN)) Q:IEN=""  D
"RTN","PXRMCSSC",16,0)
 .. S CODE=$$CODEC^ICDCODE(IEN)
"RTN","PXRMCSSC",17,0)
 .. S STATUS=+$$STATCHK^ICDAPIU(CODE,DT)
"RTN","PXRMCSSC",18,0)
 .. I 'STATUS S ICD9CLST(CODE_" ")=CODE
"RTN","PXRMCSSC",19,0)
 .. I STATUS D
"RTN","PXRMCSSC",20,0)
 ... S STATUS=+$$STATCHK^ICDAPIU(CODE,DT6M)
"RTN","PXRMCSSC",21,0)
 ... I 'STATUS S ICD9FLST(CODE_" ")=CODE
"RTN","PXRMCSSC",22,0)
 I FILENUM=81 D
"RTN","PXRMCSSC",23,0)
 . S IEN=0
"RTN","PXRMCSSC",24,0)
 . F  S IEN=$O(^PXD(811.2,TAXIEN,"SPR","B",IEN)) Q:IEN=""  D
"RTN","PXRMCSSC",25,0)
 .. S CODE=$$CODEC^ICPTCOD(IEN)
"RTN","PXRMCSSC",26,0)
 .. S STATUS=+$$STATCHK^ICPTAPIU(CODE,DT)
"RTN","PXRMCSSC",27,0)
 .. I 'STATUS S CPTCLST(CODE_" ")=CODE
"RTN","PXRMCSSC",28,0)
 I $D(ICD9CLST) D
"RTN","PXRMCSSC",29,0)
 . S IEN=""
"RTN","PXRMCSSC",30,0)
 . F  S IEN=$O(ICD9CLST(IEN)) Q:IEN=""  D
"RTN","PXRMCSSC",31,0)
 .. S CODE=ICD9CLST(IEN),ILC=ILC+1
"RTN","PXRMCSSC",32,0)
 .. S MSGARR(ILC)="Selectable ICD9 code "_CODE_" is inactive."
"RTN","PXRMCSSC",33,0)
 I $D(ICD9FLST) D
"RTN","PXRMCSSC",34,0)
 . S IEN=""
"RTN","PXRMCSSC",35,0)
 . F  S IEN=$O(ICD9FLST(IEN)) Q:IEN=""  D
"RTN","PXRMCSSC",36,0)
 .. S CODE=ICD9FLST(IEN),ILC=ILC+1
"RTN","PXRMCSSC",37,0)
 .. S MSGARR(ILC)="Selectable ICD9 code "_CODE_" will be inactive within 180 days."
"RTN","PXRMCSSC",38,0)
 I $D(CPTCLST) D
"RTN","PXRMCSSC",39,0)
 . S IEN=""
"RTN","PXRMCSSC",40,0)
 . F  S IEN=$O(CPTCLST(IEN)) Q:IEN=""  D
"RTN","PXRMCSSC",41,0)
 .. S CODE=CPTCLST(IEN),ILC=ILC+1
"RTN","PXRMCSSC",42,0)
 .. S MSGARR(ILC)="Selectable CPT code "_CODE_" is inactive."
"RTN","PXRMCSSC",43,0)
 I $D(CPTFLST) D
"RTN","PXRMCSSC",44,0)
 . S IEN=""
"RTN","PXRMCSSC",45,0)
 . F  S IEN=$O(CPTFLST(IEN)) Q:IEN=""  D
"RTN","PXRMCSSC",46,0)
 .. S CODE=CPTFLST(IEN),ILC=ILC+1
"RTN","PXRMCSSC",47,0)
 .. S MSGARR(ILC)="Selectable CPT code "_CODE_" will be inactive with 180 days."
"RTN","PXRMCSSC",48,0)
 I ILC>0 D
"RTN","PXRMCSSC",49,0)
 . S ILC=ILC+1,MSGARR(ILC)=" ",TAXMSG=1
"RTN","PXRMCSSC",50,0)
 . D ADDTMSG^PXRMCSTX(.LC,.MSGARR)
"RTN","PXRMCSSC",51,0)
 Q
"RTN","PXRMCSSC",52,0)
 ;
"RTN","PXRMCSTX")
0^9^B31401683
"RTN","PXRMCSTX",1,0)
PXRMCSTX ;SLC/PKR - Routines for taxonomy code set update. ;04/22/2003
"RTN","PXRMCSTX",2,0)
 ;;1.5;CLINICAL REMINDERS;**18**;Jun 19, 2000
"RTN","PXRMCSTX",3,0)
 ;
"RTN","PXRMCSTX",4,0)
 ;======================================================================
"RTN","PXRMCSTX",5,0)
ADDTMSG(LC,MSG) ;Add a set of messages to the global message.
"RTN","PXRMCSTX",6,0)
 N IND
"RTN","PXRMCSTX",7,0)
 S IND=0
"RTN","PXRMCSTX",8,0)
 F  S IND=$O(MSG(IND)) Q:IND=""  S LC=LC+1,^TMP("PXRMXMZ",$J,LC,0)=MSG(IND)
"RTN","PXRMCSTX",9,0)
 Q
"RTN","PXRMCSTX",10,0)
 ;
"RTN","PXRMCSTX",11,0)
 ;======================================================================
"RTN","PXRMCSTX",12,0)
ADJMSG(FILENUM,LOW,HIGH,ALOW,ALOWC,ALOWO,AHIGH,AHIGHC,AHIGHO,ADJMSG) ;
"RTN","PXRMCSTX",13,0)
 ;Create the message for adjacent codes that have changed.
"RTN","PXRMCSTX",14,0)
 N LC,TYPE
"RTN","PXRMCSTX",15,0)
 K ADJMSG
"RTN","PXRMCSTX",16,0)
 S TYPE=$S(FILENUM=80:"ICD9",FILENUM=80.1:"ICD0",FILENUM=81:"CPT")
"RTN","PXRMCSTX",17,0)
 S ADJMSG(1)="Adjacent "_TYPE_" codes have changed for the range defined by:"
"RTN","PXRMCSTX",18,0)
 S ADJMSG(2)=" Low code  "_LOW_"-"_$$GETCTEXT(FILENUM,LOW)
"RTN","PXRMCSTX",19,0)
 S ADJMSG(3)=" High code "_HIGH_"-"_$$GETCTEXT(FILENUM,HIGH)
"RTN","PXRMCSTX",20,0)
 S LC=3
"RTN","PXRMCSTX",21,0)
 I ALOWC D
"RTN","PXRMCSTX",22,0)
 . S LC=LC+1,ADJMSG(LC)="  Old adjacent lower code "_ALOWO_"-"_$$GETCTEXT(FILENUM,ALOWO)
"RTN","PXRMCSTX",23,0)
 . S LC=LC+1,ADJMSG(LC)="  New adjacent lower code "_ALOW_"-"_$$GETCTEXT(FILENUM,ALOW)
"RTN","PXRMCSTX",24,0)
 E  S LC=LC+1,ADJMSG(LC)="  No change in adjacent lower code"
"RTN","PXRMCSTX",25,0)
 I AHIGHC D
"RTN","PXRMCSTX",26,0)
 . S LC=LC+1,ADJMSG(LC)="  Old adjacent higher code "_AHIGHO_"-"_$$GETCTEXT(FILENUM,AHIGHO)
"RTN","PXRMCSTX",27,0)
 . S LC=LC+1,ADJMSG(LC)="  New adjacent higher code "_AHIGH_"-"_$$GETCTEXT(FILENUM,AHIGH)
"RTN","PXRMCSTX",28,0)
 E  S LC=LC+1,ADJMSG(LC)="  No change in adjacent higher code"
"RTN","PXRMCSTX",29,0)
 S LC=LC+1,ADJMSG(LC)=" "
"RTN","PXRMCSTX",30,0)
 Q
"RTN","PXRMCSTX",31,0)
 ;
"RTN","PXRMCSTX",32,0)
 ;======================================================================
"RTN","PXRMCSTX",33,0)
CMSGHDR(TYPE) ;Create the message header.
"RTN","PXRMCSTX",34,0)
 N PTYPE
"RTN","PXRMCSTX",35,0)
 S PTYPE=$S(TYPE="CPT":"a CPT",TYPE="ICD":"an ICD")
"RTN","PXRMCSTX",36,0)
 S ^TMP("PXRMXMZ",$J,1,0)="There was "_PTYPE_" code set update on "_$$FMTE^XLFDT(DT,"5Z")_"."
"RTN","PXRMCSTX",37,0)
 S ^TMP("PXRMXMZ",$J,2,0)="This could affect adjacent codes and/or taxonomy expansions."
"RTN","PXRMCSTX",38,0)
 S ^TMP("PXRMXMZ",$J,3,0)="Please review the affected taxonomies and take appropriate action."
"RTN","PXRMCSTX",39,0)
 S ^TMP("PXRMXMZ",$J,4,0)="You can get the full details of a taxonomy using the taxonomy inquiry option."
"RTN","PXRMCSTX",40,0)
 S ^TMP("PXRMXMZ",$J,5,0)=" "
"RTN","PXRMCSTX",41,0)
 Q
"RTN","PXRMCSTX",42,0)
 ;
"RTN","PXRMCSTX",43,0)
 ;======================================================================
"RTN","PXRMCSTX",44,0)
CSU(TYPE) ;Entry point for code set update.
"RTN","PXRMCSTX",45,0)
 I TYPE'="CPT",TYPE'="ICD" Q
"RTN","PXRMCSTX",46,0)
 N ADJMSG,ALOW,ALOWC,ALOWO,AHIGH,AHIGHC,AHIGHO,CODEIEN,CODEMSG
"RTN","PXRMCSTX",47,0)
 N FI,FILELIST,FILENUM,IEN,IND,HIGH,LC,LOW,NFILES,NNEW,NEWCODES,SENDMSG
"RTN","PXRMCSTX",48,0)
 N TAXHDRE,TAXHDRL,TAXHDRE,TAXMSG,TEMP
"RTN","PXRMCSTX",49,0)
 I TYPE="CPT" S NFILES=1,FILELIST(1)=81
"RTN","PXRMCSTX",50,0)
 I TYPE="ICD" S NFILES=2,FILELIST(1)=80,FILELIST(2)=80.1
"RTN","PXRMCSTX",51,0)
 K ^TMP("PXRMXMZ",$J)
"RTN","PXRMCSTX",52,0)
 ;Set the line count to the end of the taxonomy header.
"RTN","PXRMCSTX",53,0)
 S TAXHDRS=6,TAXHDRL=1,TAXHDRE=TAXHDRS+TAXHDRL,LC=TAXHDRE
"RTN","PXRMCSTX",54,0)
 S (IEN,SENDMSG)=0
"RTN","PXRMCSTX",55,0)
 F  S IEN=+$O(^PXD(811.2,IEN)) Q:IEN=0  D
"RTN","PXRMCSTX",56,0)
 . F FI=1:1:NFILES D
"RTN","PXRMCSTX",57,0)
 .. S FILENUM=FILELIST(FI)
"RTN","PXRMCSTX",58,0)
 .. I '$D(^PXD(811.2,IEN,FILENUM,"B")) Q
"RTN","PXRMCSTX",59,0)
 .. ;W !,"TAX ",IEN," has file ",FILENUM," codes"
"RTN","PXRMCSTX",60,0)
 .. S (IND,TAXMSG)=0
"RTN","PXRMCSTX",61,0)
 .. F  S IND=+$O(^PXD(811.2,IEN,FILENUM,IND)) Q:IND=0  D
"RTN","PXRMCSTX",62,0)
 ... S TEMP=^PXD(811.2,IEN,FILENUM,IND,0)
"RTN","PXRMCSTX",63,0)
 ... S LOW=$P(TEMP,U,1),HIGH=$P(TEMP,U,2)
"RTN","PXRMCSTX",64,0)
 ... S ALOWO=$P(TEMP,U,3),AHIGHO=$P(TEMP,U,4)
"RTN","PXRMCSTX",65,0)
 ... S ALOW=$S(FILENUM=80:$$PREV^ICDAPIU(LOW),FILENUM=80.1:$$PREV^ICDAPIU(LOW),FILENUM=81:$$PREV^ICPTAPIU(LOW))
"RTN","PXRMCSTX",66,0)
 ... S AHIGH=$S(FILENUM=80:$$NEXT^ICDAPIU(HIGH),FILENUM=80.1:$$NEXT^ICDAPIU(HIGH),FILENUM=81:$$NEXT^ICPTAPIU(HIGH))
"RTN","PXRMCSTX",67,0)
 ... I ALOW'=ALOWO S ALOWC=1,$P(^PXD(811.2,IEN,FILENUM,IND,0),U,3)=ALOW
"RTN","PXRMCSTX",68,0)
 ... E  S ALOWC=0
"RTN","PXRMCSTX",69,0)
 ... I AHIGH'=AHIGHO S AHIGHC=1,$P(^PXD(811.2,IEN,FILENUM,IND,0),U,4)=AHIGH
"RTN","PXRMCSTX",70,0)
 ... E  S AHIGHC=0
"RTN","PXRMCSTX",71,0)
 ... I ALOWC!AHIGHC D
"RTN","PXRMCSTX",72,0)
 .... D ADJMSG(FILENUM,LOW,HIGH,ALOW,ALOWC,ALOWO,AHIGH,AHIGHC,AHIGHO,.ADJMSG)
"RTN","PXRMCSTX",73,0)
 .... D ADDTMSG(.LC,.ADJMSG)
"RTN","PXRMCSTX",74,0)
 .... S TAXMSG=1
"RTN","PXRMCSTX",75,0)
 ..;Save the old expansion and compare with the old one.
"RTN","PXRMCSTX",76,0)
 .. K ^TMP($J,"OLDEXP")
"RTN","PXRMCSTX",77,0)
 .. S IND=0
"RTN","PXRMCSTX",78,0)
 .. F  S IND=+$O(^PXD(811.3,IEN,FILENUM,IND)) Q:IND=0  D
"RTN","PXRMCSTX",79,0)
 ... S CODEIEN=^PXD(811.3,IEN,FILENUM,IND,0)
"RTN","PXRMCSTX",80,0)
 ... S ^TMP($J,"OLDEXP",CODEIEN)=""
"RTN","PXRMCSTX",81,0)
 ..;Rexpand and compare with the old.
"RTN","PXRMCSTX",82,0)
 .. D DELEXTL^PXRMBXTL(IEN)
"RTN","PXRMCSTX",83,0)
 .. D EXPAND^PXRMBXTL(IEN,"")
"RTN","PXRMCSTX",84,0)
 ..;Old codes are never deleted from the ICD or CPT globals so just
"RTN","PXRMCSTX",85,0)
 ..;check for new entries in the expansion.
"RTN","PXRMCSTX",86,0)
 .. S (IND,NNEW)=0
"RTN","PXRMCSTX",87,0)
 .. F  S IND=+$O(^PXD(811.3,IEN,FILENUM,IND)) Q:IND=0  D
"RTN","PXRMCSTX",88,0)
 ... S CODEIEN=^PXD(811.3,IEN,FILENUM,IND,0)
"RTN","PXRMCSTX",89,0)
 ... I '$D(^TMP($J,"OLDEXP",CODEIEN)) S NNEW=NNEW+1,NEWCODES(NNEW)=CODEIEN
"RTN","PXRMCSTX",90,0)
 ..;If there are any new codes add them to the message.
"RTN","PXRMCSTX",91,0)
 .. I NNEW>0 D
"RTN","PXRMCSTX",92,0)
 ... D NEWCMSG(FILENUM,NNEW,.NEWCODES,.CODEMSG)
"RTN","PXRMCSTX",93,0)
 ... D ADDTMSG(.LC,.CODEMSG)
"RTN","PXRMCSTX",94,0)
 ... S TAXMSG=1
"RTN","PXRMCSTX",95,0)
 ..;Check the selectable codes.
"RTN","PXRMCSTX",96,0)
 .. D SELCODE^PXRMCSSC(FILENUM,IEN,.LC,.TAXMSG)
"RTN","PXRMCSTX",97,0)
 .. I TAXMSG D
"RTN","PXRMCSTX",98,0)
 ... D TAXHDR(IEN,TAXHDRS)
"RTN","PXRMCSTX",99,0)
 ... S TAXHDRS=LC+1,TAXHDRE=TAXHDRS+TAXHDRL,LC=TAXHDRE
"RTN","PXRMCSTX",100,0)
 ... S SENDMSG=1
"RTN","PXRMCSTX",101,0)
 I SENDMSG D
"RTN","PXRMCSTX",102,0)
 . N XMSUB
"RTN","PXRMCSTX",103,0)
 . S XMSUB="Clinical Reminder taxonomy updates, new "_TYPE_" global installation."
"RTN","PXRMCSTX",104,0)
 . D CMSGHDR(TYPE)
"RTN","PXRMCSTX",105,0)
 . D SEND^PXRMMSG(XMSUB)
"RTN","PXRMCSTX",106,0)
 K ^TMP("PXRMXMZ",$J),^TMP($J,"OLDEXP")
"RTN","PXRMCSTX",107,0)
 Q
"RTN","PXRMCSTX",108,0)
 ;
"RTN","PXRMCSTX",109,0)
 ;======================================================================
"RTN","PXRMCSTX",110,0)
GETCTEXT(FILENUM,CODE) ;Return the text associated with the code.
"RTN","PXRMCSTX",111,0)
 N TEMP,TEXT
"RTN","PXRMCSTX",112,0)
 I FILENUM=80 D  Q TEXT
"RTN","PXRMCSTX",113,0)
 . S TEMP=$$ICDDX^ICDCODE(CODE,DT)
"RTN","PXRMCSTX",114,0)
 . S TEXT=$P(TEMP,U,4)
"RTN","PXRMCSTX",115,0)
 I FILENUM=80.1 D  Q TEXT
"RTN","PXRMCSTX",116,0)
 . S TEMP=$$ICDOP^ICDCODE(CODE,DT)
"RTN","PXRMCSTX",117,0)
 . S TEXT=$P(TEMP,U,5)
"RTN","PXRMCSTX",118,0)
 I FILENUM=81 D
"RTN","PXRMCSTX",119,0)
 . S TEMP=$$CPT^ICPTCOD(CODE,DT)
"RTN","PXRMCSTX",120,0)
 . S TEXT=$P(TEMP,U,3)
"RTN","PXRMCSTX",121,0)
 Q TEXT
"RTN","PXRMCSTX",122,0)
 ;
"RTN","PXRMCSTX",123,0)
 ;======================================================================
"RTN","PXRMCSTX",124,0)
NEWCMSG(FILENUM,NNEW,NEWCODES,CODEMSG) ;Create the message for new codes
"RTN","PXRMCSTX",125,0)
 ;appearing in the expansion.
"RTN","PXRMCSTX",126,0)
 I NNEW=0 Q
"RTN","PXRMCSTX",127,0)
 N LC,IND,TYPE
"RTN","PXRMCSTX",128,0)
 K CODEMSG
"RTN","PXRMCSTX",129,0)
 S TYPE=$S(FILENUM=80:"ICD9",FILENUM=80.1:"ICD0",FILENUM=81:"CPT")
"RTN","PXRMCSTX",130,0)
 S CODEMSG(1)="The following are new "_TYPE_" codes in the expansion for this taxonomy:"
"RTN","PXRMCSTX",131,0)
 S LC=1
"RTN","PXRMCSTX",132,0)
 F IND=1:1:NNEW D
"RTN","PXRMCSTX",133,0)
 . S CODE=NEWCODES(IND)
"RTN","PXRMCSTX",134,0)
 . S LC=LC+1,CODEMSG(LC)=" "_CODE_"-"_$$GETCTEXT(FILENUM,CODE)
"RTN","PXRMCSTX",135,0)
 S LC=LC+1,CODEMSG(LC)=" "
"RTN","PXRMCSTX",136,0)
 Q
"RTN","PXRMCSTX",137,0)
 ;
"RTN","PXRMCSTX",138,0)
 ;======================================================================
"RTN","PXRMCSTX",139,0)
TAXHDR(IEN,LC) ;Create message header for a specific taxonomy.
"RTN","PXRMCSTX",140,0)
 S ^TMP("PXRMXMZ",$J,LC,0)="Taxonomy: "_$P(^PXD(811.2,IEN,0),U,1)_" = TX("_IEN_")"
"RTN","PXRMCSTX",141,0)
 Q
"RTN","PXRMCSTX",142,0)
 ;
"RTN","PXRMCSU")
0^2^B7161038
"RTN","PXRMCSU",1,0)
PXRMCSU ;SLC/JVS - Code Set Version-dialog file-Utilities ;3/11/03  11:31
"RTN","PXRMCSU",2,0)
 ;;1.5;CLINICAL REMINDERS;**18**;Jun 19, 2000
"RTN","PXRMCSU",3,0)
 ;Variable List
"RTN","PXRMCSU",4,0)
 ;DATECV     =Converted Date
"RTN","PXRMCSU",5,0)
 ;Integration Agreements
"RTN","PXRMCSU",6,0)
 ;supported  4125 and 4126
"RTN","PXRMCSU",7,0)
 Q
"RTN","PXRMCSU",8,0)
SUB ;==============Sub Routines=============================
"RTN","PXRMCSU",9,0)
DT6M(DT) ;Add 180 days to DT
"RTN","PXRMCSU",10,0)
 N DT6M
"RTN","PXRMCSU",11,0)
 S DT6M=$$FMADD^XLFDT(DT,180,0,0,0)
"RTN","PXRMCSU",12,0)
 Q DT6M
"RTN","PXRMCSU",13,0)
CONV(DATE) ;Date time conversion
"RTN","PXRMCSU",14,0)
 N DATECV
"RTN","PXRMCSU",15,0)
 S DATECV=$$FMTE^XLFDT(DATE,"5Z")
"RTN","PXRMCSU",16,0)
 Q DATECV
"RTN","PXRMCSU",17,0)
CPTA(VARIEN) ; Return all data for cpt code
"RTN","PXRMCSU",18,0)
 ; INACDATE=Inactive date
"RTN","PXRMCSU",19,0)
 ; FPP     =FUTURE PRESENT PAST
"RTN","PXRMCSU",20,0)
 ; RETURNS CPTDATA = Whole string of information
"RTN","PXRMCSU",21,0)
 ;         FPPREF  = Time Reference (Null if no data)
"RTN","PXRMCSU",22,0)
 N INACDATE,FPP,FPPREF,CPTDATA
"RTN","PXRMCSU",23,0)
 S CPTDATA=$$CPT^ICPTCOD(VARIEN,$$DT6M(DT))
"RTN","PXRMCSU",24,0)
 S INACDATE=$P(CPTDATA,"^",8),FPPREF="" I INACDATE>0 D
"RTN","PXRMCSU",25,0)
 .S FPP=$S(INACDATE>DT:"Future",INACDATE<DT:"Past",INACDATE=DT:"Today",1:"Unknown")
"RTN","PXRMCSU",26,0)
 .S FPPREF=FPP
"RTN","PXRMCSU",27,0)
 Q CPTDATA_"^"_FPPREF
"RTN","PXRMCSU",28,0)
ICD9A(VARIEN) ; Return all data for cpt code
"RTN","PXRMCSU",29,0)
 ; INACDATE=Inactive date
"RTN","PXRMCSU",30,0)
 ; FPP     =FUTURE PRESENT PAST
"RTN","PXRMCSU",31,0)
 ; RETURNS CPTDATA = Whole string of information
"RTN","PXRMCSU",32,0)
 ;         FPPREF  = Time Reference (Null if no data)
"RTN","PXRMCSU",33,0)
 N INACDATE,FPP,FPPREF,ICD9DATA
"RTN","PXRMCSU",34,0)
 S ICD9DATA=$$ICDDX^ICDCODE(VARIEN,$$DT6M(DT))
"RTN","PXRMCSU",35,0)
 S INACDATE=$P(ICD9DATA,"^",12),FPPREF="" I INACDATE>0 D
"RTN","PXRMCSU",36,0)
 .S FPP=$S(INACDATE>DT:"Future",INACDATE<DT:"Past",INACDATE=DT:"Today",1:"Unknown")
"RTN","PXRMCSU",37,0)
 .S FPPREF=FPP
"RTN","PXRMCSU",38,0)
 Q ICD9DATA_"^"_FPPREF
"RTN","PXRMCSU",39,0)
CPT(VARIEN) ; Return code from IEN
"RTN","PXRMCSU",40,0)
 N VARCODE
"RTN","PXRMCSU",41,0)
 S VARCODE=$$CPT^ICPTCOD(VARIEN,$$DT6M(DT))
"RTN","PXRMCSU",42,0)
 S VARCODE=$P(VARCODE,"^",2)
"RTN","PXRMCSU",43,0)
 Q VARCODE
"RTN","PXRMCSU",44,0)
CPTD(VARIEN) ;Return CPT code Description from IEN
"RTN","PXRMCSU",45,0)
 N VARDESC
"RTN","PXRMCSU",46,0)
 S VARDESC=$$CPT^ICPTCOD(VARIEN,$$DT6M(DT))
"RTN","PXRMCSU",47,0)
 S VARDESC=$P(VARDESC,"^",3)
"RTN","PXRMCSU",48,0)
 Q VARDESC
"RTN","PXRMCSU",49,0)
ICD9(VARIEN) ; Return ICD9 (Diagnosis) Code from IEN
"RTN","PXRMCSU",50,0)
 N VARCODE
"RTN","PXRMCSU",51,0)
 S VARCODE=$$ICDDX^ICDCODE(VARIEN,$$DT6M(DT))
"RTN","PXRMCSU",52,0)
 S VARCODE=$P(VARCODE,"^",2)
"RTN","PXRMCSU",53,0)
 Q VARCODE
"RTN","PXRMCSU",54,0)
ICD9D(VARIEN) ; Return ICD9 (Diagnosis) Description from IEN
"RTN","PXRMCSU",55,0)
 N VARDESC
"RTN","PXRMCSU",56,0)
 S VARDESC=$$ICDDX^ICDCODE(VARIEN,$$DT6M(DT))
"RTN","PXRMCSU",57,0)
 S VARDESC=$P(VARDESC,"^",4)
"RTN","PXRMCSU",58,0)
 Q VARDESC
"RTN","PXRMCSU",59,0)
ICD0(VARIEN) ; Return ICD0 (Operation) Code from an IEN
"RTN","PXRMCSU",60,0)
 N VARCODE
"RTN","PXRMCSU",61,0)
 S VARCODE=$$ICDOP^ICDCODE(VARIEN,$$DT6M(DT))
"RTN","PXRMCSU",62,0)
 S VARCODE=$P(VARCODE,"^",2)
"RTN","PXRMCSU",63,0)
 Q VARCODE
"RTN","PXRMCSU",64,0)
ICD0D(VARIEN) ; Return ICD0 (Operation) Description from IEN
"RTN","PXRMCSU",65,0)
 N VARCODE
"RTN","PXRMCSU",66,0)
 S VARDESC=$$ICDOP^ICDCODE(VARIEN,$$DT6M(DT))
"RTN","PXRMCSU",67,0)
 S VARDESC=$P(VARDESC,"^",5)
"RTN","PXRMCSU",68,0)
 Q VARDESC
"RTN","PXRMCSU",69,0)
STATUS(VRSTATUS) ;RETURN STATUS FOR BOTH CPT AND ICD CODES
"RTN","PXRMCSU",70,0)
 N STATUS
"RTN","PXRMCSU",71,0)
 ;VRSTATUS = Internal form of status
"RTN","PXRMCSU",72,0)
 ;STATUS    = Exteral form of status
"RTN","PXRMCSU",73,0)
 S STATUS=$S(($P(VRSTATUS,"^",1)=1)&($P(VRSTATUS,"^",2)>0):"Active",($P(VRSTATUS,"^",1)=0)&($P(VRSTATUS,"^",2)>0):"Inactive",($P(VRSTATUS,"^",1)=0)&($P(VRSTATUS,"^",2)<0):"Unknown",1:"")
"RTN","PXRMCSU",74,0)
 Q STATUS
"RTN","PXRMDLG1")
0^11^B79437142
"RTN","PXRMDLG1",1,0)
PXRMDLG1 ; SLC/PJH - Reminder Dialog Edit/Inquiry (overflow) ;04/16/2003
"RTN","PXRMDLG1",2,0)
 ;;1.5;CLINICAL REMINDERS;**2,5,6,18**;Jun 19, 2000
"RTN","PXRMDLG1",3,0)
 ;
"RTN","PXRMDLG1",4,0)
 ;Get selectable codes for a taxonomy
"RTN","PXRMDLG1",5,0)
 ;-----------------------------------
"RTN","PXRMDLG1",6,0)
CODES(FILE,TIEN) ;
"RTN","PXRMDLG1",7,0)
 N BDATE,CODES,CODE,DATES,DESC,DTEXT,EDATE,STR,SUB,TAB,TEXT
"RTN","PXRMDLG1",8,0)
 ;Display text
"RTN","PXRMDLG1",9,0)
 S TEXT=$J("",15)_"Selectable codes:",TAB=18
"RTN","PXRMDLG1",10,0)
 S STR=$$LJ^XLFSTR($G(TEXT),60)
"RTN","PXRMDLG1",11,0)
 S STR=STR_"Activation Periods"
"RTN","PXRMDLG1",12,0)
 S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",13,0)
 ;S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",15)_$G(TEXT)
"RTN","PXRMDLG1",14,0)
 S ^TMP("PXRMDLG",$J,VALMCNT,0)=STR
"RTN","PXRMDLG1",15,0)
 ;Get array
"RTN","PXRMDLG1",16,0)
 D CODES^PXRMDLLB(FILE,TIEN,.CODES)
"RTN","PXRMDLG1",17,0)
 ;Move results into workfile
"RTN","PXRMDLG1",18,0)
 S SUB=""
"RTN","PXRMDLG1",19,0)
 F  S SUB=$O(CODES(SUB)) Q:SUB=""  D
"RTN","PXRMDLG1",20,0)
 .S CODE=$P(CODES(SUB),U,2),DESC=$P(CODES(SUB),U,3)
"RTN","PXRMDLG1",21,0)
 .S BDATE=$$FMTE^XLFDT($P($G(CODE),":",2))
"RTN","PXRMDLG1",22,0)
 .I $P($G(CODE),":",3)'="" S EDATE=$$FMTE^XLFDT($P($G(CODE),":",3))
"RTN","PXRMDLG1",23,0)
 .S DATE=BDATE I $G(EDATE)'="" S DATE=DATE_"-"_EDATE
"RTN","PXRMDLG1",24,0)
 .S STR=$$LJ^XLFSTR($P($G(CODE),":"),8)
"RTN","PXRMDLG1",25,0)
 .S STR=STR_$$LJ^XLFSTR(DESC,31)
"RTN","PXRMDLG1",26,0)
 .S DTEXT=STR_DATE
"RTN","PXRMDLG1",27,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",28,0)
 .S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",15)_DTEXT
"RTN","PXRMDLG1",29,0)
 .;S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",15)_$G(TEXT)_DTEXT
"RTN","PXRMDLG1",30,0)
 .;S TEXT=$J("",TAB)
"RTN","PXRMDLG1",31,0)
 Q
"RTN","PXRMDLG1",32,0)
 ;
"RTN","PXRMDLG1",33,0)
 ;Either dialog text or P/N text
"RTN","PXRMDLG1",34,0)
 ;------------------------------
"RTN","PXRMDLG1",35,0)
TSUB(IEN,VIEW) ;
"RTN","PXRMDLG1",36,0)
 ;Dialog View uses Dialog text
"RTN","PXRMDLG1",37,0)
 I VIEW=1 Q 25
"RTN","PXRMDLG1",38,0)
 ;P/N View uses P/N TEXT if defined
"RTN","PXRMDLG1",39,0)
 I $D(^PXRMD(801.41,IEN,35)) Q 35
"RTN","PXRMDLG1",40,0)
 ;Otherwise Dialog Text
"RTN","PXRMDLG1",41,0)
 Q 25
"RTN","PXRMDLG1",42,0)
 ;
"RTN","PXRMDLG1",43,0)
 ;Progress note text (DP)
"RTN","PXRMDLG1",44,0)
 ;-----------------------
"RTN","PXRMDLG1",45,0)
VIEW(IEN,VIEW) ;
"RTN","PXRMDLG1",46,0)
 N DCAP,TSUB
"RTN","PXRMDLG1",47,0)
 ;Dialog Group process
"RTN","PXRMDLG1",48,0)
 I DGRP D  Q
"RTN","PXRMDLG1",49,0)
 .N DATA,DGBEG,DGIEN,DGSEQ,DGSUB
"RTN","PXRMDLG1",50,0)
 .;Update index
"RTN","PXRMDLG1",51,0)
 .S ^TMP("PXRMDLG",$J,"IDX",SEQ,IEN)=""
"RTN","PXRMDLG1",52,0)
 .;Get GROUP text
"RTN","PXRMDLG1",53,0)
 .S DGSUB=0,DGBEG=$J(SEQ,3),TSUB=$$TSUB(IEN,VIEW)
"RTN","PXRMDLG1",54,0)
 .F  S DGSUB=$O(^PXRMD(801.41,IEN,TSUB,DGSUB)) Q:'DGSUB  D
"RTN","PXRMDLG1",55,0)
 ..S DTXT=$G(^PXRMD(801.41,IEN,TSUB,DGSUB,0))
"RTN","PXRMDLG1",56,0)
 ..S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",57,0)
 ..S ^TMP("PXRMDLG",$J,VALMCNT,0)=DGBEG_$J("",12)_DTXT,DGBEG=$J("",3)
"RTN","PXRMDLG1",58,0)
 .;Get additional prompts
"RTN","PXRMDLG1",59,0)
 .D PROMPT(IEN,0,"","")
"RTN","PXRMDLG1",60,0)
 .;Group caption text
"RTN","PXRMDLG1",61,0)
 .S DTXT=$P($G(^PXRMD(801.41,IEN,0)),U,5),DCAP=" [group caption]"
"RTN","PXRMDLG1",62,0)
 .I DTXT="" S DCAP="[no caption for this group]"
"RTN","PXRMDLG1",63,0)
 .;Text of caption
"RTN","PXRMDLG1",64,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",65,0)
 .S ^TMP("PXRMDLG",$J,VALMCNT,0)=DGBEG_$J("",12)_DTXT_DCAP,DGBEG=$J("",3)
"RTN","PXRMDLG1",66,0)
 .;Get dialog group sub-elements
"RTN","PXRMDLG1",67,0)
 .S DGSEQ=0
"RTN","PXRMDLG1",68,0)
 .F  S DGSEQ=$O(^PXRMD(801.41,IEN,10,"B",DGSEQ)) Q:'DGSEQ  D
"RTN","PXRMDLG1",69,0)
 ..S SUB=$O(^PXRMD(801.41,IEN,10,"B",DGSEQ,"")) Q:'SUB
"RTN","PXRMDLG1",70,0)
 ..S DGIEN=$P($G(^PXRMD(801.41,IEN,10,SUB,0)),U,2) Q:'DGIEN
"RTN","PXRMDLG1",71,0)
 ..;Ignore forced values and prompts
"RTN","PXRMDLG1",72,0)
 ..Q:"PF"[$P($G(^PXRMD(801.41,DGIEN,0)),U,4)
"RTN","PXRMDLG1",73,0)
 ..S DGBEG=$J(SEQ,3)_"."_DGSEQ
"RTN","PXRMDLG1",74,0)
 ..;Get Resolution/Finding details
"RTN","PXRMDLG1",75,0)
 ..S FIEN=$P($G(^PXRMD(801.41,DGIEN,1)),U,5)
"RTN","PXRMDLG1",76,0)
 ..;If taxonomy generate 
"RTN","PXRMDLG1",77,0)
 ..I $P(FIEN,";",2)="PXD(811.2," D TAX(FIEN,DGBEG,DGIEN) Q
"RTN","PXRMDLG1",78,0)
 ..;Otherwise get text from dialog element
"RTN","PXRMDLG1",79,0)
 ..S DGSUB=0,TSUB=$$TSUB(DGIEN,VIEW)
"RTN","PXRMDLG1",80,0)
 ..F  S DGSUB=$O(^PXRMD(801.41,DGIEN,TSUB,DGSUB)) Q:'DGSUB  D
"RTN","PXRMDLG1",81,0)
 ...S DTXT=$G(^PXRMD(801.41,DGIEN,TSUB,DGSUB,0))
"RTN","PXRMDLG1",82,0)
 ...S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",83,0)
 ...S ^TMP("PXRMDLG",$J,VALMCNT,0)=DGBEG_$J("",10)_DTXT,DGBEG=$J("",5)
"RTN","PXRMDLG1",84,0)
 ...;Get additional prompts
"RTN","PXRMDLG1",85,0)
 ..D PROMPT(DGIEN,0,"","")
"RTN","PXRMDLG1",86,0)
 ..;Final linefeed
"RTN","PXRMDLG1",87,0)
 ..S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",88,0)
 ..S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",79)
"RTN","PXRMDLG1",89,0)
 ;
"RTN","PXRMDLG1",90,0)
 N TAX,SUB
"RTN","PXRMDLG1",91,0)
 ;Get Resolution/Finding details
"RTN","PXRMDLG1",92,0)
 S DATA=$G(^PXRMD(801.41,IEN,1)),FIEN=$P(DATA,U,5),TAX=0
"RTN","PXRMDLG1",93,0)
 ;Mental Health
"RTN","PXRMDLG1",94,0)
 I $P(FIEN,";",2)="YTT(601," D MENTAL(FIEN) Q
"RTN","PXRMDLG1",95,0)
 ;Check if taxonomy
"RTN","PXRMDLG1",96,0)
 I $P(FIEN,";",2)="PXD(811.2," S TAX=1
"RTN","PXRMDLG1",97,0)
 ;If a taxonomy use the dialog text from taxonomy file
"RTN","PXRMDLG1",98,0)
 I TAX D TAX(FIEN,SEQ,IEN) Q
"RTN","PXRMDLG1",99,0)
 ;If not a taxonomy use dialog file
"RTN","PXRMDLG1",100,0)
 I 'TAX D  Q
"RTN","PXRMDLG1",101,0)
 .S TSUB=$$TSUB(IEN,VIEW)
"RTN","PXRMDLG1",102,0)
 .S DTXT=$G(^PXRMD(801.41,IEN,TSUB,1,0))
"RTN","PXRMDLG1",103,0)
 .;Text of the first prompt
"RTN","PXRMDLG1",104,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",105,0)
 .S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J(SEQ,3)_$J("",12)_DTXT
"RTN","PXRMDLG1",106,0)
 .S ^TMP("PXRMDLG",$J,"IDX",SEQ,IEN)=""
"RTN","PXRMDLG1",107,0)
 .;Text or subsequent lines
"RTN","PXRMDLG1",108,0)
 .S SUB=1
"RTN","PXRMDLG1",109,0)
 .F  S SUB=$O(^PXRMD(801.41,IEN,TSUB,SUB)) Q:'SUB  D
"RTN","PXRMDLG1",110,0)
 ..S DTXT=$G(^PXRMD(801.41,IEN,TSUB,SUB,0))
"RTN","PXRMDLG1",111,0)
 ..S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",112,0)
 ..S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",15)_DTXT
"RTN","PXRMDLG1",113,0)
 .;Get additional prompts
"RTN","PXRMDLG1",114,0)
 .D PROMPT(IEN,0,"","")
"RTN","PXRMDLG1",115,0)
 ;
"RTN","PXRMDLG1",116,0)
 Q
"RTN","PXRMDLG1",117,0)
 ;
"RTN","PXRMDLG1",118,0)
 ;additional prompts in 801.45
"RTN","PXRMDLG1",119,0)
 ;----------------------------
"RTN","PXRMDLG1",120,0)
FPROMPT(FNODE,RSUB,CNT,ARRAY) ;
"RTN","PXRMDLG1",121,0)
 ;Get all additional fields for this resolution type
"RTN","PXRMDLG1",122,0)
 S ASUB=0,ACNT=0
"RTN","PXRMDLG1",123,0)
 F  S ASUB=$O(^PXRMD(801.45,FNODE,1,RSUB,5,ASUB)) Q:'ASUB  D
"RTN","PXRMDLG1",124,0)
 .S DNODE=$G(^PXRMD(801.45,FNODE,1,RSUB,5,ASUB,0)) Q:DNODE=""
"RTN","PXRMDLG1",125,0)
 .;Ignore if disabled
"RTN","PXRMDLG1",126,0)
 .I $P(DNODE,U,3)=1 Q
"RTN","PXRMDLG1",127,0)
 .S DNODE=$P(DNODE,U) Q:DNODE=""
"RTN","PXRMDLG1",128,0)
 .S ATXT=$P($G(^PXRMD(801.41,DNODE,0)),U) Q:ATXT=""
"RTN","PXRMDLG1",129,0)
 .;S ATXT=$TR(ATXT,UPPER,LOWER)
"RTN","PXRMDLG1",130,0)
 .S ACNT=ACNT+1
"RTN","PXRMDLG1",131,0)
 .S ARRAY(CNT,ACNT)=DNODE
"RTN","PXRMDLG1",132,0)
 Q
"RTN","PXRMDLG1",133,0)
 ;
"RTN","PXRMDLG1",134,0)
 ;Group text and caption
"RTN","PXRMDLG1",135,0)
 ;----------------------
"RTN","PXRMDLG1",136,0)
GROUP(IEN,VIEW) ;
"RTN","PXRMDLG1",137,0)
 N DDATA,DGIEN,DGSUB,DTXT
"RTN","PXRMDLG1",138,0)
 ;Get GROUP text
"RTN","PXRMDLG1",139,0)
 S DGSUB=0,TSUB=$$TSUB(IEN,VIEW)
"RTN","PXRMDLG1",140,0)
 F  S DGSUB=$O(^PXRMD(801.41,IEN,TSUB,DGSUB)) Q:'DGSUB  D
"RTN","PXRMDLG1",141,0)
 .S DTXT=$G(^PXRMD(801.41,IEN,TSUB,DGSUB,0))
"RTN","PXRMDLG1",142,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",143,0)
 .S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",12)_DTXT
"RTN","PXRMDLG1",144,0)
 ;Group caption text
"RTN","PXRMDLG1",145,0)
 S DDATA=$G(^PXRMD(801.41,IEN,0))
"RTN","PXRMDLG1",146,0)
 S DTXT=$P(DDATA,U,5),DCAP=" [group caption]"
"RTN","PXRMDLG1",147,0)
 I DTXT="" S DCAP="[no caption for this group]"
"RTN","PXRMDLG1",148,0)
 ;Text of caption
"RTN","PXRMDLG1",149,0)
 S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",150,0)
 S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",12)_DTXT_DCAP
"RTN","PXRMDLG1",151,0)
 ;Get additional group prompts
"RTN","PXRMDLG1",152,0)
 D PROMPT(IEN,0,"","")
"RTN","PXRMDLG1",153,0)
 ;Other group fields
"RTN","PXRMDLG1",154,0)
 N DBOX,DSUPP,DSHOW,DMULT
"RTN","PXRMDLG1",155,0)
 S DBOX=$S($P(DDATA,U,6)="Y":"BOX",1:"NO BOX")
"RTN","PXRMDLG1",156,0)
 S DSUPP=$S($P(DDATA,U,11):"SUPPRESS",1:"NO SUPPRESS")
"RTN","PXRMDLG1",157,0)
 S DSHOW=$S($P(DDATA,U,10):"HIDE",1:"SHOW")
"RTN","PXRMDLG1",158,0)
 S DMULT=$P(DDATA,U,9)
"RTN","PXRMDLG1",159,0)
 S DMULT=$S(DMULT=1:"ONE ONLY",DMULT=2:"ONE OR MORE",DMULT=3:"NONE OR ONE",1:"NO SELECTION")
"RTN","PXRMDLG1",160,0)
 S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",161,0)
 S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",12)_"["_DBOX_", "_DSUPP_", "_DSHOW_", "_DMULT_"]"
"RTN","PXRMDLG1",162,0)
 S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",163,0)
 S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",79)
"RTN","PXRMDLG1",164,0)
 Q
"RTN","PXRMDLG1",165,0)
 ;
"RTN","PXRMDLG1",166,0)
 ;Mental Healt Instrument
"RTN","PXRMDLG1",167,0)
 ;-----------------------
"RTN","PXRMDLG1",168,0)
MENTAL(RESN) ;
"RTN","PXRMDLG1",169,0)
 N ARRAY,CNT,SUB,TXT,TYP,YT,YIEN,YNAM,YSEQ
"RTN","PXRMDLG1",170,0)
 S YIEN=$P(RESN,";") Q:'YIEN
"RTN","PXRMDLG1",171,0)
 S YNAM=$P($G(^YTT(601,YIEN,0)),U) Q:YNAM=""
"RTN","PXRMDLG1",172,0)
 S YT("CODE")=YNAM
"RTN","PXRMDLG1",173,0)
 ;Get test details
"RTN","PXRMDLG1",174,0)
 D SHOWALL^YTAPI3(.ARRAY,.YT)
"RTN","PXRMDLG1",175,0)
 ;Quit if invalid test
"RTN","PXRMDLG1",176,0)
 I ARRAY(1)["[ERROR]" Q
"RTN","PXRMDLG1",177,0)
 ;Get Name
"RTN","PXRMDLG1",178,0)
 S TXT=$G(ARRAY(2)),TXT=$P(TXT,U)_" : "_$P(TXT,U,2)
"RTN","PXRMDLG1",179,0)
 S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",180,0)
 S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J(SEQ,3)_$J("",12)_TXT
"RTN","PXRMDLG1",181,0)
 S ^TMP("PXRMDLG",$J,"IDX",SEQ,IEN)=""
"RTN","PXRMDLG1",182,0)
 S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",183,0)
 S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",79)
"RTN","PXRMDLG1",184,0)
 ;Get caption
"RTN","PXRMDLG1",185,0)
 S SUB=0
"RTN","PXRMDLG1",186,0)
 F  S SUB=$O(ARRAY(1,"I",SUB)) Q:'SUB  D
"RTN","PXRMDLG1",187,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",188,0)
 .S TXT=$J("",15)_ARRAY(1,"I",SUB)
"RTN","PXRMDLG1",189,0)
 .S ^TMP("PXRMDLG",$J,VALMCNT,0)=TXT
"RTN","PXRMDLG1",190,0)
 ;
"RTN","PXRMDLG1",191,0)
 S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",192,0)
 S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",79)
"RTN","PXRMDLG1",193,0)
 S CNT=0
"RTN","PXRMDLG1",194,0)
 F  S CNT=$O(ARRAY(CNT)) Q:CNT=""  D
"RTN","PXRMDLG1",195,0)
 .S YSEQ=$J(SEQ,3)_"."_CNT,SUB=0
"RTN","PXRMDLG1",196,0)
 .;Get question
"RTN","PXRMDLG1",197,0)
 .F  S SUB=$O(ARRAY(CNT,"T",SUB)) Q:'SUB  D
"RTN","PXRMDLG1",198,0)
 ..S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",199,0)
 ..S TXT=YSEQ_$J("",15-$L(YSEQ))_ARRAY(CNT,"T",SUB),YSEQ=""
"RTN","PXRMDLG1",200,0)
 ..S ^TMP("PXRMDLG",$J,VALMCNT,0)=TXT
"RTN","PXRMDLG1",201,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",202,0)
 .S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",79)
"RTN","PXRMDLG1",203,0)
 Q
"RTN","PXRMDLG1",204,0)
 ;
"RTN","PXRMDLG1",205,0)
 ;additional prompts in the dialog file
"RTN","PXRMDLG1",206,0)
 ;-------------------------------------
"RTN","PXRMDLG1",207,0)
PROMPT(IEN,TAB,TEXT,DGRP) ;
"RTN","PXRMDLG1",208,0)
 N DATA,DDIS,DGSEQ,DSUB,DTITLE,DTXT,DTYP,SEQ,SUB
"RTN","PXRMDLG1",209,0)
 S SEQ=0
"RTN","PXRMDLG1",210,0)
 F  S SEQ=$O(^PXRMD(801.41,IEN,10,"B",SEQ)) Q:'SEQ  D
"RTN","PXRMDLG1",211,0)
 .S SUB=$O(^PXRMD(801.41,IEN,10,"B",SEQ,"")) Q:'SUB
"RTN","PXRMDLG1",212,0)
 .S DSUB=$P($G(^PXRMD(801.41,IEN,10,SUB,0)),U,2) Q:'DSUB
"RTN","PXRMDLG1",213,0)
 .S DATA=$G(^PXRMD(801.41,DSUB,0)) Q:DATA=""
"RTN","PXRMDLG1",214,0)
 .S DNAME=$P(DATA,U),DDIS=$P(DATA,U,3),DTYP=$P(DATA,U,4)
"RTN","PXRMDLG1",215,0)
 .I VIEW,('DGRP),(DTYP'="P") Q
"RTN","PXRMDLG1",216,0)
 .I ('VIEW),('DGRP),("FP"'[DTYP) Q
"RTN","PXRMDLG1",217,0)
 .S:VIEW DDIS=""
"RTN","PXRMDLG1",218,0)
 .I DTYP="F" S DNAME=DNAME_" (forced value)"
"RTN","PXRMDLG1",219,0)
 .I DGRP D
"RTN","PXRMDLG1",220,0)
 ..S DGSEQ=$P($G(^PXRMD(801.41,IEN,10,SUB,0)),U)
"RTN","PXRMDLG1",221,0)
 ..S DNAME=DGSEQ_$J("",3-$L(DGSEQ))_DNAME
"RTN","PXRMDLG1",222,0)
 .I TAB=0,DTYP="P" D
"RTN","PXRMDLG1",223,0)
 ..;Override prompt caption
"RTN","PXRMDLG1",224,0)
 ..S DTITLE=$P($G(^PXRMD(801.41,IEN,10,SUB,0)),U,6)
"RTN","PXRMDLG1",225,0)
 ..I DTITLE="" S DTITLE=$P($G(^PXRMD(801.41,DSUB,2)),U,4)
"RTN","PXRMDLG1",226,0)
 ..S DNAME=$J("",3)_DTITLE
"RTN","PXRMDLG1",227,0)
 .I TAB=0,DTYP="F" S DNAME=$J("",3)_DNAME
"RTN","PXRMDLG1",228,0)
 .S DNAME=$J("",15)_$G(TEXT)_DNAME
"RTN","PXRMDLG1",229,0)
 .S:DDIS]"" DNAME=DNAME_$J("",72-$L(DNAME))_DDIS
"RTN","PXRMDLG1",230,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",231,0)
 .S ^TMP("PXRMDLG",$J,VALMCNT,0)=DNAME
"RTN","PXRMDLG1",232,0)
 .S TEXT=$J("",TAB)
"RTN","PXRMDLG1",233,0)
 Q
"RTN","PXRMDLG1",234,0)
 ;
"RTN","PXRMDLG1",235,0)
 ;
"RTN","PXRMDLG1",236,0)
 ;Taxonomy Questions
"RTN","PXRMDLG1",237,0)
 ;------------------
"RTN","PXRMDLG1",238,0)
TAX(FIEN,SEQ,DIEN) ;
"RTN","PXRMDLG1",239,0)
 N ARRAY,CNT,TIEN,TSEQ
"RTN","PXRMDLG1",240,0)
 S TIEN=$P(FIEN,";") Q:TIEN=""
"RTN","PXRMDLG1",241,0)
 ;Get associated codes
"RTN","PXRMDLG1",242,0)
 D TAX^PXRMDLL(TIEN,.ARRAY)
"RTN","PXRMDLG1",243,0)
 ;Taxonomy header
"RTN","PXRMDLG1",244,0)
 S TSEQ=SEQ I $L(SEQ)<3 S TSEQ=$J(SEQ,3)_"  "
"RTN","PXRMDLG1",245,0)
 S CNT=0,VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",246,0)
 S ^TMP("PXRMDLG",$J,VALMCNT,0)=TSEQ_$J("",15-$L(TSEQ))_ARRAY
"RTN","PXRMDLG1",247,0)
 S ^TMP("PXRMDLG",$J,"IDX",SEQ,DIEN)=""
"RTN","PXRMDLG1",248,0)
 ;Dialog and Procedure entries
"RTN","PXRMDLG1",249,0)
 F  S CNT=$O(ARRAY(CNT)) Q:CNT=""  D
"RTN","PXRMDLG1",250,0)
 .S TSEQ=$J(SEQ,3)_"."_CNT
"RTN","PXRMDLG1",251,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",252,0)
 .S ^TMP("PXRMDLG",$J,VALMCNT,0)=TSEQ_$J("",15-$L(TSEQ))_$P(ARRAY(CNT),U)
"RTN","PXRMDLG1",253,0)
 .D CODES($P(ARRAY(CNT),U,2),TIEN)
"RTN","PXRMDLG1",254,0)
 .;Get additional prompts (from finding parameter file)
"RTN","PXRMDLG1",255,0)
 .D TPROMPT(ARRAY(CNT),0,"")
"RTN","PXRMDLG1",256,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",257,0)
 .S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",79)
"RTN","PXRMDLG1",258,0)
 Q
"RTN","PXRMDLG1",259,0)
 ;
"RTN","PXRMDLG1",260,0)
 ;additional prompts for a taxonomy
"RTN","PXRMDLG1",261,0)
 ;---------------------------------
"RTN","PXRMDLG1",262,0)
TPROMPT(DATA,TAB,TEXT) ;
"RTN","PXRMDLG1",263,0)
 N FNODE,FTYP,RSUB,SEQ,DSUB,DTXT,DTYP
"RTN","PXRMDLG1",264,0)
 ;Finding type
"RTN","PXRMDLG1",265,0)
 S FTYP=$P(DATA,U,4) Q:FTYP=""
"RTN","PXRMDLG1",266,0)
 ;Get parameter file node for this finding type
"RTN","PXRMDLG1",267,0)
 S FNODE=$O(^PXRMD(801.45,"B",FTYP,"")) Q:FNODE=""
"RTN","PXRMDLG1",268,0)
 ;Resolution type
"RTN","PXRMDLG1",269,0)
 S RSUB=$P(DATA,U,3) Q:'RSUB
"RTN","PXRMDLG1",270,0)
 ;Get details from  parameter file 
"RTN","PXRMDLG1",271,0)
 D FPROMPT(FNODE,RSUB,CNT,.ARRAY)
"RTN","PXRMDLG1",272,0)
 S SEQ=0
"RTN","PXRMDLG1",273,0)
 F  S SEQ=$O(ARRAY(CNT,SEQ)) Q:'SEQ  D
"RTN","PXRMDLG1",274,0)
 .S DSUB=ARRAY(CNT,SEQ) Q:'DSUB
"RTN","PXRMDLG1",275,0)
 .S DNAME=$P($G(^PXRMD(801.41,DSUB,0)),U)
"RTN","PXRMDLG1",276,0)
 .S DTYP=$P($G(^PXRMD(801.41,DSUB,0)),U,4)
"RTN","PXRMDLG1",277,0)
 .I DTYP="F" S DNAME=DNAME_" (forced value)"
"RTN","PXRMDLG1",278,0)
 .I TAB=0,DTYP="F" S DNAME=$J("",3)_DNAME
"RTN","PXRMDLG1",279,0)
 .I TAB=0,DTYP="P" S DNAME=$J("",3)_$P($G(^PXRMD(801.41,DSUB,2)),U,4)
"RTN","PXRMDLG1",280,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMDLG1",281,0)
 .S ^TMP("PXRMDLG",$J,VALMCNT,0)=$J("",15)_$G(TEXT)_DNAME
"RTN","PXRMDLG1",282,0)
 .S TEXT=$J("",TAB)
"RTN","PXRMDLG1",283,0)
 Q
"RTN","PXRMDLLA")
0^4^B56156564
"RTN","PXRMDLLA",1,0)
PXRMDLLA ;SLC/PJH - REMINDER DIALOG LOADER ;04/05/2003
"RTN","PXRMDLLA",2,0)
 ;;1.5;CLINICAL REMINDERS;**2,5,7,18**;Jun 19, 2000
"RTN","PXRMDLLA",3,0)
 ;
"RTN","PXRMDLLA",4,0)
 ;
"RTN","PXRMDLLA",5,0)
FREC(DFIEN,DFTYP) ;Build type 3 record
"RTN","PXRMDLLA",6,0)
 N CSCNT
"RTN","PXRMDLLA",7,0)
 K CSARRAY
"RTN","PXRMDLLA",8,0)
 ;Dialog type/text and resolution  
"RTN","PXRMDLLA",9,0)
 S DNAM=$$NAME(DFIEN,DFTYP)
"RTN","PXRMDLLA",10,0)
 ;,DCOD=$$CODE^PXRMDLLB(DFIEN,DFTYP)
"RTN","PXRMDLLA",11,0)
 D CODE^PXRMDLLB(DFIEN,DFTYP,.CSARRAY)
"RTN","PXRMDLLA",12,0)
 I $D(CSARRAY)>0 D  Q
"RTN","PXRMDLLA",13,0)
 .S CSCNT="" F  S CSCNT=$O(CSARRAY(CSCNT)) Q:CSCNT=""  D
"RTN","PXRMDLLA",14,0)
 ..S OCNT=OCNT+1
"RTN","PXRMDLLA",15,0)
 ..S ORY(OCNT)=3_U_DITEM_U_U_DPCE_U_DEXC_U_DFIEN_U_$G(CSARRAY(CSCNT))_U_DNAM_U_U_DVIT
"RTN","PXRMDLLA",16,0)
 ;Translate vitals ien to PCE code - This will need a DBIA
"RTN","PXRMDLLA",17,0)
 K CSARRAY
"RTN","PXRMDLLA",18,0)
 S DCOD=""
"RTN","PXRMDLLA",19,0)
 I DPCE="VIT" D
"RTN","PXRMDLLA",20,0)
 .S DFIEN=$$GET1^DIQ(120.51,DFIEN,7,"E")
"RTN","PXRMDLLA",21,0)
 .;Vitals Caption
"RTN","PXRMDLLA",22,0)
 .S DVIT=$P($G(^PXRMD(801.41,DITEM,2)),U,4)
"RTN","PXRMDLLA",23,0)
 I DFTYP]"" D
"RTN","PXRMDLLA",24,0)
 .S OCNT=OCNT+1
"RTN","PXRMDLLA",25,0)
 .S ORY(OCNT)=3_U_DITEM_U_U_DPCE_U_DEXC_U_DFIEN_U_$G(DCOD)_U_DNAM_U_U_DVIT
"RTN","PXRMDLLA",26,0)
 .;Get order type for orderable items
"RTN","PXRMDLLA",27,0)
 .S:DPCE="Q" $P(ORY(OCNT),U,11)=$P($G(^ORD(101.41,DFIEN,0)),U,4)
"RTN","PXRMDLLA",28,0)
 .;If mental health check if a GAF score
"RTN","PXRMDLLA",29,0)
 .I DPCE="MH",DFIEN D
"RTN","PXRMDLLA",30,0)
 ..I $P($G(^YTT(601,DFIEN,0)),U)="GAF" S $P(ORY(OCNT),U,12)=1
"RTN","PXRMDLLA",31,0)
 Q
"RTN","PXRMDLLA",32,0)
 ;
"RTN","PXRMDLLA",33,0)
GUI(IEN) ;Work out prompt type for PCE
"RTN","PXRMDLLA",34,0)
 Q:IEN="" ""
"RTN","PXRMDLLA",35,0)
 N SUB S SUB=$P($G(^PXRMD(801.41,IEN,46)),U)
"RTN","PXRMDLLA",36,0)
 Q:'SUB ""
"RTN","PXRMDLLA",37,0)
 Q $P($G(^PXRMD(801.42,SUB,0)),U)
"RTN","PXRMDLLA",38,0)
 ;
"RTN","PXRMDLLA",39,0)
LOAD(DITEM,DCUR,DTTYP) ;Load dialog questions into array
"RTN","PXRMDLLA",40,0)
 N DARRAY,DCOD,DEXC,DFIND,DFIEN,DFTYP,DNAM,DPCE,DRES,DSEQ,DSUB,DTYP,OCNT
"RTN","PXRMDLLA",41,0)
 N DVIT
"RTN","PXRMDLLA",42,0)
 ;
"RTN","PXRMDLLA",43,0)
 ;Build list of PCE codes
"RTN","PXRMDLLA",44,0)
 S DARRAY("AUTTEDT(")="PED"
"RTN","PXRMDLLA",45,0)
 S DARRAY("AUTTEXAM(")="XAM"
"RTN","PXRMDLLA",46,0)
 S DARRAY("AUTTHF(")="HF"
"RTN","PXRMDLLA",47,0)
 S DARRAY("AUTTIMM(")="IMM"
"RTN","PXRMDLLA",48,0)
 S DARRAY("AUTTSK(")="SK"
"RTN","PXRMDLLA",49,0)
 ;
"RTN","PXRMDLLA",50,0)
 S DARRAY("GMRD(120.51,")="VIT"
"RTN","PXRMDLLA",51,0)
 S DARRAY("ORD(101.41,")="Q"
"RTN","PXRMDLLA",52,0)
 S DARRAY("YTT(601,")="MH"
"RTN","PXRMDLLA",53,0)
 ;
"RTN","PXRMDLLA",54,0)
 S DARRAY("ICD9(")="POV"
"RTN","PXRMDLLA",55,0)
 S DARRAY("ICPT(")="CPT"
"RTN","PXRMDLLA",56,0)
 ;
"RTN","PXRMDLLA",57,0)
 S DARRAY("PXD(811.2,")="T" ;dialog cpt/pov is generated from taxonomy
"RTN","PXRMDLLA",58,0)
 ;
"RTN","PXRMDLLA",59,0)
 ;Get the dialog element
"RTN","PXRMDLLA",60,0)
 S OCNT=0,DTYP=$P($G(^PXRMD(801.41,DITEM,0)),U,4)
"RTN","PXRMDLLA",61,0)
 ;Finding detail
"RTN","PXRMDLLA",62,0)
 S DRES=$P($G(^PXRMD(801.41,DITEM,1)),U,3)
"RTN","PXRMDLLA",63,0)
 S DFIND=$P($G(^PXRMD(801.41,DITEM,1)),U,5)
"RTN","PXRMDLLA",64,0)
 S DFIEN=$P(DFIND,";"),DFTYP=$P(DFIND,";",2)
"RTN","PXRMDLLA",65,0)
 S DPCE="",DVIT="" I DFTYP'="" S DPCE=$G(DARRAY(DFTYP))
"RTN","PXRMDLLA",66,0)
 ;Exclude from P/N
"RTN","PXRMDLLA",67,0)
 S DEXC=$P($G(^PXRMD(801.41,DITEM,2)),U,3)
"RTN","PXRMDLLA",68,0)
 ;
"RTN","PXRMDLLA",69,0)
 ;Non taxonomy codes (3 - finding record)
"RTN","PXRMDLLA",70,0)
 I DPCE'="T" D FREC(DFIEN,DFTYP)
"RTN","PXRMDLLA",71,0)
 ;
"RTN","PXRMDLLA",72,0)
 ;Taxonomy codes need expanding (3 - finding record)
"RTN","PXRMDLLA",73,0)
 I DPCE="T" D EXP^PXRMDLLB(DFIEN,DCUR,DTTYP)
"RTN","PXRMDLLA",74,0)
 ;
"RTN","PXRMDLLA",75,0)
 ;Prompt details (4 - prompt records)
"RTN","PXRMDLLA",76,0)
 N ARRAY,DTITLE,DREQ,DSEQ,DSSEQ,DSUB,DTYP
"RTN","PXRMDLLA",77,0)
 ;If not a taxonomy get prompts from dialog file
"RTN","PXRMDLLA",78,0)
 I DPCE'="T" D PROTH(DITEM)
"RTN","PXRMDLLA",79,0)
 ;Ceck for MST findings
"RTN","PXRMDLLA",80,0)
 I (DPCE'="T"),(DFTYP]"") D MST^PXRMDLLB(DFTYP,DFIEN)
"RTN","PXRMDLLA",81,0)
 ;If a taxonomy get details from general finding parameters (CPT/POV)
"RTN","PXRMDLLA",82,0)
 I DPCE="T" D
"RTN","PXRMDLLA",83,0)
 .;Quit if finding type not passed
"RTN","PXRMDLLA",84,0)
 .Q:DTTYP=""
"RTN","PXRMDLLA",85,0)
 .N RSUB,FNODE
"RTN","PXRMDLLA",86,0)
 .;Get parameter file node for this finding type
"RTN","PXRMDLLA",87,0)
 .S FNODE=$O(^PXRMD(801.45,"B",DTTYP,"")) Q:FNODE=""
"RTN","PXRMDLLA",88,0)
 .;Derive resolution from line ien 1=done 2=done elsewhere
"RTN","PXRMDLLA",89,0)
 .S RSUB=DCUR+1 I (RSUB<1)!(RSUB>2) Q
"RTN","PXRMDLLA",90,0)
 .;Get details from 811.5
"RTN","PXRMDLLA",91,0)
 .D PRTAX(FNODE,RSUB)
"RTN","PXRMDLLA",92,0)
 ;Return array of type 4 records
"RTN","PXRMDLLA",93,0)
 S DSEQ=""
"RTN","PXRMDLLA",94,0)
 F  S DSEQ=$O(ARRAY(DSEQ)) Q:'DSEQ  D
"RTN","PXRMDLLA",95,0)
 .S OCNT=OCNT+1
"RTN","PXRMDLLA",96,0)
 .S ORY(OCNT)=4_U_DITEM_U_DSEQ_U_ARRAY(DSEQ)
"RTN","PXRMDLLA",97,0)
 .S DSSEQ=""
"RTN","PXRMDLLA",98,0)
 .F  S DSSEQ=$O(ARRAY(DSEQ,DSSEQ)) Q:'DSSEQ  D
"RTN","PXRMDLLA",99,0)
 ..S OCNT=OCNT+1
"RTN","PXRMDLLA",100,0)
 ..S ORY(OCNT)=4_U_DITEM_U_DSEQ_"."_DSSEQ_U_ARRAY(DSEQ,DSSEQ)
"RTN","PXRMDLLA",101,0)
 ;
"RTN","PXRMDLLA",102,0)
 ;Get progress note text if defined
"RTN","PXRMDLLA",103,0)
 I DPCE'="T" D:'DEXC PTXT(DITEM)
"RTN","PXRMDLLA",104,0)
 ;Additional findings
"RTN","PXRMDLLA",105,0)
 N FASUB
"RTN","PXRMDLLA",106,0)
 S FASUB=0
"RTN","PXRMDLLA",107,0)
 F  S FASUB=$O(^PXRMD(801.41,DITEM,3,FASUB)) Q:'FASUB  D
"RTN","PXRMDLLA",108,0)
 .S DFIND=$P($G(^PXRMD(801.41,DITEM,3,FASUB,0)),U)
"RTN","PXRMDLLA",109,0)
 .S DFIEN=$P(DFIND,";"),DFTYP=$P(DFIND,";",2) Q:DFTYP=""  Q:DFIEN=""
"RTN","PXRMDLLA",110,0)
 .S DVIT="",DPCE=$G(DARRAY(DFTYP))
"RTN","PXRMDLLA",111,0)
 .I DPCE'="" D FREC(DFIEN,DFTYP)
"RTN","PXRMDLLA",112,0)
 Q
"RTN","PXRMDLLA",113,0)
 ;
"RTN","PXRMDLLA",114,0)
 ;Returns item name
"RTN","PXRMDLLA",115,0)
NAME(DFIEN,DFTYP) ;
"RTN","PXRMDLLA",116,0)
 Q:DFTYP="" ""
"RTN","PXRMDLLA",117,0)
 Q:DFIEN="" ""
"RTN","PXRMDLLA",118,0)
 N NAME,FGLOB,POSN
"RTN","PXRMDLLA",119,0)
 I DFTYP["ICD9" S NAME=$P($G(^ICD9(DFIEN,1)),U) Q:NAME]"" NAME
"RTN","PXRMDLLA",120,0)
 S POSN=2
"RTN","PXRMDLLA",121,0)
 S:DFTYP["AUTT" POSN=1 S:DFTYP["AUTTEDT" POSN=4 S:DFTYP["ICD" POSN=3
"RTN","PXRMDLLA",122,0)
 S FGLOB=U_DFTYP_DFIEN_",0)",NAME=$P($G(@FGLOB),U,POSN)
"RTN","PXRMDLLA",123,0)
 I (POSN>1),NAME="" S NAME=$P($G(@FGLOB),U)
"RTN","PXRMDLLA",124,0)
 I NAME="" S NAME=DFIEN
"RTN","PXRMDLLA",125,0)
 Q NAME
"RTN","PXRMDLLA",126,0)
 ;
"RTN","PXRMDLLA",127,0)
PROTH(IEN) ; Additional prompts defined in 801.41
"RTN","PXRMDLLA",128,0)
 N DDATA,DDEF,DIEN,DEXC,DGUI,DNAME,DOVR,DREQ,DSEQ,DSNL,DSUB,DTXT,DTYP
"RTN","PXRMDLLA",129,0)
 S DSEQ=0
"RTN","PXRMDLLA",130,0)
 F  S DSEQ=$O(^PXRMD(801.41,IEN,10,"B",DSEQ)) Q:'DSEQ  D
"RTN","PXRMDLLA",131,0)
 .;Get prompts in sequence
"RTN","PXRMDLLA",132,0)
 .S DSUB=$O(^PXRMD(801.41,IEN,10,"B",DSEQ,"")) Q:'DSUB
"RTN","PXRMDLLA",133,0)
 .;Prompt ien
"RTN","PXRMDLLA",134,0)
 .S DIEN=$P($G(^PXRMD(801.41,IEN,10,DSUB,0)),U,2) Q:'DIEN
"RTN","PXRMDLLA",135,0)
 .;Ignore disabled components, and those that are not prompts
"RTN","PXRMDLLA",136,0)
 .Q:($P($G(^PXRMD(801.41,DIEN,0)),U,3)]"")!("PF"'[$P($G(^(0)),U,4))
"RTN","PXRMDLLA",137,0)
 .;Set defaults to null
"RTN","PXRMDLLA",138,0)
 .S DDEF="",DEXC="",DREQ="",DSNL=""
"RTN","PXRMDLLA",139,0)
 .;Prompt name and GUI process (quit if null)
"RTN","PXRMDLLA",140,0)
 .S DNAME=$P($G(^PXRMD(801.41,DIEN,0)),U),DGUI=$$GUI(DIEN)
"RTN","PXRMDLLA",141,0)
 .;Type Prompt or Forced
"RTN","PXRMDLLA",142,0)
 .S DTYP=$P($G(^PXRMD(801.41,DIEN,0)),U,4)
"RTN","PXRMDLLA",143,0)
 .I "PF"[DTYP D
"RTN","PXRMDLLA",144,0)
 ..;Required/Prompt caption
"RTN","PXRMDLLA",145,0)
 ..S DDATA=$G(^PXRMD(801.41,DIEN,2)),DTXT=$P(DDATA,U,4)
"RTN","PXRMDLLA",146,0)
 ..;Default value or forced value
"RTN","PXRMDLLA",147,0)
 ..S:DTYP="P" DDEF=$P(DDATA,U) S:DTYP="F" DDEF=$P(DDATA,U,2)
"RTN","PXRMDLLA",148,0)
 ..;Override caption/start new line/exclude PN from dialog file
"RTN","PXRMDLLA",149,0)
 ..S DDATA=$G(^PXRMD(801.41,IEN,10,DSUB,0)),DREQ=$P(DDATA,U,9)
"RTN","PXRMDLLA",150,0)
 ..S DOVR=$P(DDATA,U,6),DSNL=$P(DDATA,U,7),DEXC=$P(DDATA,U,8)
"RTN","PXRMDLLA",151,0)
 ..S DNAME=DTXT I DOVR]"" S DNAME=DOVR
"RTN","PXRMDLLA",152,0)
 ..;Convert date to fileman format
"RTN","PXRMDLLA",153,0)
 ..I DGUI="VST_DATE",DDEF["T" S DDEF=$$DT^XLFDT()
"RTN","PXRMDLLA",154,0)
 .S ARRAY(DSEQ)=DGUI_U_DEXC_U_DDEF_U_DTYP_U_DNAME_U_DSNL_U_DREQ
"RTN","PXRMDLLA",155,0)
 .;Additional checkboxes
"RTN","PXRMDLLA",156,0)
 .I DGUI="COM",DIEN>1 D
"RTN","PXRMDLLA",157,0)
 ..N DSSEQ,DSUB,DTEXT
"RTN","PXRMDLLA",158,0)
 ..S DSSEQ=0
"RTN","PXRMDLLA",159,0)
 ..F  S DSSEQ=$O(^PXRMD(801.41,DIEN,45,"B",DSSEQ)) Q:'DSSEQ  D
"RTN","PXRMDLLA",160,0)
 ...S DSUB=$O(^PXRMD(801.41,DIEN,45,"B",DSSEQ,"")) Q:'DSUB
"RTN","PXRMDLLA",161,0)
 ...S DTEXT=$P($G(^PXRMD(801.41,DIEN,45,DSUB,0)),U,2) Q:DTEXT=""
"RTN","PXRMDLLA",162,0)
 ...S ARRAY(DSEQ,DSSEQ)=U_DEXC_U_DDEF_U_DTYP_U_DTEXT_U_DSNL_U_DREQ
"RTN","PXRMDLLA",163,0)
 Q
"RTN","PXRMDLLA",164,0)
 ;
"RTN","PXRMDLLA",165,0)
PRTAX(FNODE,RSUB) ;Get all additional fields for this resolution type
"RTN","PXRMDLLA",166,0)
 N ACNT,ASUB
"RTN","PXRMDLLA",167,0)
 N DDATA,DDEF,DEXC,DGUI,DNAME,DREQ,DSEQ,DSUB,DTYP
"RTN","PXRMDLLA",168,0)
 S ASUB=0,DSEQ=0
"RTN","PXRMDLLA",169,0)
 F  S ASUB=$O(^PXRMD(801.45,FNODE,1,RSUB,5,ASUB)) Q:'ASUB  D
"RTN","PXRMDLLA",170,0)
 .S DDATA=$G(^PXRMD(801.45,FNODE,1,RSUB,5,ASUB,0)) Q:DDATA=""
"RTN","PXRMDLLA",171,0)
 .;Ignore if disabled
"RTN","PXRMDLLA",172,0)
 .I $P(DDATA,U,3)=1 Q
"RTN","PXRMDLLA",173,0)
 .S DSUB=$P(DDATA,U) Q:DDATA=""
"RTN","PXRMDLLA",174,0)
 .S DSEQ=DSEQ+1
"RTN","PXRMDLLA",175,0)
 .;Set defaults to null
"RTN","PXRMDLLA",176,0)
 .S DDEF="",DEXC="",DREQ="",DSNL=""
"RTN","PXRMDLLA",177,0)
 .;Prompt name and GUI process (quit if null)
"RTN","PXRMDLLA",178,0)
 .S DNAME=$P($G(^PXRMD(801.41,DSUB,0)),U),DGUI=$$GUI(DSUB)
"RTN","PXRMDLLA",179,0)
 .;Type Prompt or Forced
"RTN","PXRMDLLA",180,0)
 .S DTYP=$P($G(^PXRMD(801.41,DSUB,0)),U,4)
"RTN","PXRMDLLA",181,0)
 .I DTYP="P" D
"RTN","PXRMDLLA",182,0)
 ..S DREQ=$P(DDATA,U,2),DTXT=$P($G(^PXRMD(801.41,DSUB,2)),U,4)
"RTN","PXRMDLLA",183,0)
 ..;Override caption/start new line/exclude from PN from finding type 
"RTN","PXRMDLLA",184,0)
 ..S DOVR=$P(DDATA,U,5),DSNL=$P(DDATA,U,6),DEXC=$P(DDATA,U,7)
"RTN","PXRMDLLA",185,0)
 ..S DNAME=DTXT I DOVR]"" S DNAME=DOVR
"RTN","PXRMDLLA",186,0)
 ..;Required/Prompt caption
"RTN","PXRMDLLA",187,0)
 ..S DDATA=$G(^PXRMD(801.41,DSUB,2))
"RTN","PXRMDLLA",188,0)
 .S ARRAY(DSEQ)=DGUI_U_DEXC_U_DDEF_U_DTYP_U_DNAME_U_DSNL_U_DREQ
"RTN","PXRMDLLA",189,0)
 Q
"RTN","PXRMDLLA",190,0)
 ;
"RTN","PXRMDLLA",191,0)
PTXT(ITEM) ;Get progress note (WP) text for type 6 records
"RTN","PXRMDLLA",192,0)
 N LAST,NULL,SUB,TEXT S SUB=0,LAST=0
"RTN","PXRMDLLA",193,0)
 F  S SUB=$O(^PXRMD(801.41,ITEM,35,SUB)) Q:'SUB  D
"RTN","PXRMDLLA",194,0)
 .S TEXT=$G(^PXRMD(801.41,ITEM,35,SUB,0))
"RTN","PXRMDLLA",195,0)
 .S NULL=0 I (TEXT="")!($E(TEXT)=" ") S NULL=1
"RTN","PXRMDLLA",196,0)
 .I LAST,'NULL S TEXT="<br>"_TEXT
"RTN","PXRMDLLA",197,0)
 .S LAST=0 I NULL S TEXT="<br>"_TEXT,LAST=1
"RTN","PXRMDLLA",198,0)
 .S OCNT=OCNT+1,ORY(OCNT)=6_U_ITEM_U_U_TEXT
"RTN","PXRMDLLA",199,0)
 Q
"RTN","PXRMDLLA",200,0)
 ;
"RTN","PXRMDLLA",201,0)
TOK(TIEN,TYPE) ;Check if selectable codes exist
"RTN","PXRMDLLA",202,0)
 N DATA,FOUND,SUB
"RTN","PXRMDLLA",203,0)
 S FOUND=0,SUB=0
"RTN","PXRMDLLA",204,0)
 F  S SUB=$O(^PXD(811.2,TIEN,TYPE,SUB)) Q:'SUB  D  Q:FOUND
"RTN","PXRMDLLA",205,0)
 .S DATA=$G(^PXD(811.2,TIEN,TYPE,SUB,0)) Q:DATA=""
"RTN","PXRMDLLA",206,0)
 .;Ignore disabled codes
"RTN","PXRMDLLA",207,0)
 .I '$P(DATA,U,3) S FOUND=1
"RTN","PXRMDLLA",208,0)
 Q FOUND
"RTN","PXRMDLLA",209,0)
 ;
"RTN","PXRMDLLA",210,0)
TEST(ORY,DITEM,DCUR,DTTYP) ;
"RTN","PXRMDLLA",211,0)
 D LOAD(DITEM,DCUR,DTTYP)
"RTN","PXRMDLLA",212,0)
 Q
"RTN","PXRMDLLB")
0^5^B16463488
"RTN","PXRMDLLB",1,0)
PXRMDLLB ;SLC/PJH - REMINDER DIALOG LOADER ;03/18/2003
"RTN","PXRMDLLB",2,0)
 ;;1.5;CLINICAL REMINDERS;**18**;Jun 19, 2000
"RTN","PXRMDLLB",3,0)
 ;
"RTN","PXRMDLLB",4,0)
 ;
"RTN","PXRMDLLB",5,0)
 ;CODE(DFIEN,DFTYP)
"RTN","PXRMDLLB",6,0)
 ;Q:DFIEN="" ""
"RTN","PXRMDLLB",7,0)
 ;Q:DFTYP["ICD9" $P($G(^ICD9(DFIEN,0)),U)
"RTN","PXRMDLLB",8,0)
 ;Q:DFTYP["ICPT" $P($$CPT^ICPTCOD(DFIEN),U,2)
"RTN","PXRMDLLB",9,0)
 ;Q ""
"RTN","PXRMDLLB",10,0)
 ;
"RTN","PXRMDLLB",11,0)
CODE(DFIEN,DFTYP,ARRAY) ;
"RTN","PXRMDLLB",12,0)
 N ARY,CNT,CNT1
"RTN","PXRMDLLB",13,0)
 I DFTYP["ICD9" S CODE=$P($G(^ICD9(DFIEN,0)),U) D PERIOD^ICDAPIU(CODE,.ARY)
"RTN","PXRMDLLB",14,0)
 I DFTYP["ICPT" S CODE=$P($$CPT^ICPTCOD(DFIEN),U,2) D PERIOD^ICPTAPIU(CODE,.ARY)
"RTN","PXRMDLLB",15,0)
 I $D(ARY)'>0 Q
"RTN","PXRMDLLB",16,0)
 I $P($G(ARY(0)),U,2)'>0 Q
"RTN","PXRMDLLB",17,0)
 S (CNT,CNT1)=0
"RTN","PXRMDLLB",18,0)
 F  S CNT=$O(ARY(CNT)) Q:CNT=""  D
"RTN","PXRMDLLB",19,0)
 . S ARRAY(CNT1)=CODE_":"_CNT_":"_$P($G(ARY(CNT)),U)
"RTN","PXRMDLLB",20,0)
 . S CNT1=CNT1+1
"RTN","PXRMDLLB",21,0)
 Q
"RTN","PXRMDLLB",22,0)
 ;
"RTN","PXRMDLLB",23,0)
CODES(FILE,TXIEN,ARRAY) ;Return list of selectable codes from taxonomy file
"RTN","PXRMDLLB",24,0)
 N CNT,CODE,DATA,DATES,IEN,TEMP,TEXT,NODE,SUB,ARYX,ARY,CSCNT,CSARRAY,CSCNT1
"RTN","PXRMDLLB",25,0)
 S SUB=0,CNT=0,NODE=$S(FILE=80:"SDX",FILE=81:"SPR")
"RTN","PXRMDLLB",26,0)
 F  S SUB=$O(^PXD(811.2,TXIEN,NODE,SUB)) Q:'SUB  D
"RTN","PXRMDLLB",27,0)
 .S DATA=$G(^PXD(811.2,TXIEN,NODE,SUB,0)) Q:DATA=""
"RTN","PXRMDLLB",28,0)
 .;Ignore if disabled
"RTN","PXRMDLLB",29,0)
 .I $P(DATA,U,3)=1 Q
"RTN","PXRMDLLB",30,0)
 .;Get ien of code
"RTN","PXRMDLLB",31,0)
 .S IEN=$P(DATA,U) Q:IEN=""
"RTN","PXRMDLLB",32,0)
 .;Translate ien to code
"RTN","PXRMDLLB",33,0)
 .;Ignore invalid codes
"RTN","PXRMDLLB",34,0)
 .;I FILE=80 S CODE=$P($G(^ICD9(IEN,0)),U)
"RTN","PXRMDLLB",35,0)
 .;I FILE=81 S CODE=$P($$CPT^ICPTCOD(IEN),U,2)
"RTN","PXRMDLLB",36,0)
 .;S TEMP=$$CODE^PXRMVAL(CODE,FILE) Q:'$P(TEMP,U)  Q:$P(TEMP,U,9)=1
"RTN","PXRMDLLB",37,0)
 .;Set display text from taxonomy selectable code text
"RTN","PXRMDLLB",38,0)
 .;S TEXT=$P(DATA,U,2)
"RTN","PXRMDLLB",39,0)
 .;otherwise use icd9/cpt description
"RTN","PXRMDLLB",40,0)
 .;I TEXT="",FILE=80 S TEXT=$G(^ICD9(IEN,1))
"RTN","PXRMDLLB",41,0)
 .;I TEXT="",FILE=80 S TEXT=$P($G(^ICD9(IEN,0)),U,3)
"RTN","PXRMDLLB",42,0)
 .;I TEXT="",FILE=81 S TEXT=$P($$CPT^ICPTCOD(IEN),U,3)
"RTN","PXRMDLLB",43,0)
 .;S CNT=CNT+1,ARRAY(CNT)=IEN_U_CODE_U_TEXT
"RTN","PXRMDLLB",44,0)
 .K ARY
"RTN","PXRMDLLB",45,0)
 .I FILE=80 S CODE=$P($G(^ICD9(IEN,0)),U) D PERIOD^ICDAPIU(CODE,.ARY)
"RTN","PXRMDLLB",46,0)
 .I FILE=81 S CODE=$P($$CPT^ICPTCOD(IEN),U,2) D PERIOD^ICPTAPIU(CODE,.ARY)
"RTN","PXRMDLLB",47,0)
 .I $D(ARY)'>0 Q
"RTN","PXRMDLLB",48,0)
 .I $P($G(ARY(0)),U,2)'>0 Q
"RTN","PXRMDLLB",49,0)
 .S CSCNT=0 F  S CSCNT=$O(ARY(CSCNT)) Q:CSCNT=""  D
"RTN","PXRMDLLB",50,0)
 ..S DATES=":"_CSCNT_":"_$P($G(ARY(CSCNT)),U),TEXT=$P($G(ARY(CSCNT)),U,2)
"RTN","PXRMDLLB",51,0)
 ..S CNT=CNT+1,ARRAY(CNT)=IEN_U_$G(CODE)_$G(DATES)_U_$G(TEXT)
"RTN","PXRMDLLB",52,0)
 .K ARY
"RTN","PXRMDLLB",53,0)
 .;I $G(ARYX)=0 S CNT=CNT+1,ARRAY(CNT)=IEN_U_CODE_U_TEXT
"RTN","PXRMDLLB",54,0)
 Q
"RTN","PXRMDLLB",55,0)
 ;
"RTN","PXRMDLLB",56,0)
EXP(TIEN,DCUR,DTTYP) ;Expand taxonomy codes
"RTN","PXRMDLLB",57,0)
 N CODES,CNT,FILE,LIT,CAT
"RTN","PXRMDLLB",58,0)
 S FILE=$S(DTTYP="POV":80,DTTYP="CPT":81,1:"") Q:'FILE
"RTN","PXRMDLLB",59,0)
 S LIT="Selectable "_$S(FILE=80:"Diagnoses:",1:"Procedures:")
"RTN","PXRMDLLB",60,0)
 S CAT=$P($G(^PXD(811.2,TIEN,0)),U)
"RTN","PXRMDLLB",61,0)
 ;
"RTN","PXRMDLLB",62,0)
 S OCNT=OCNT+1
"RTN","PXRMDLLB",63,0)
 S ORY(OCNT)=3_U_DITEM_U_U_DTTYP_U_U_U_U_U_CAT_U_LIT
"RTN","PXRMDLLB",64,0)
 ;Get selectable codes
"RTN","PXRMDLLB",65,0)
 D CODES(FILE,TIEN,.CODES)
"RTN","PXRMDLLB",66,0)
 S CNT=0
"RTN","PXRMDLLB",67,0)
 ;Save selectable codes as type 5 records
"RTN","PXRMDLLB",68,0)
 F  S CNT=$O(CODES(CNT)) Q:'CNT  D
"RTN","PXRMDLLB",69,0)
 .S OCNT=OCNT+1,ORY(OCNT)=5_U_DITEM_U_U_DTTYP_U_U_CODES(CNT)
"RTN","PXRMDLLB",70,0)
 Q
"RTN","PXRMDLLB",71,0)
 ;
"RTN","PXRMDLLB",72,0)
 ;Pass MST code as a forced value
"RTN","PXRMDLLB",73,0)
MST(DFTYP,DFIEN) ;
"RTN","PXRMDLLB",74,0)
 ;Validate finding ien
"RTN","PXRMDLLB",75,0)
 Q:DFIEN=""
"RTN","PXRMDLLB",76,0)
 ;For each MST term check if finding is mapped
"RTN","PXRMDLLB",77,0)
 N FOUND,TCOND,TIEN,TNAM,TSUB
"RTN","PXRMDLLB",78,0)
 S FOUND=0
"RTN","PXRMDLLB",79,0)
 F TNAM="POSITIVE","NEGATIVE","DECLINES" D  Q:FOUND
"RTN","PXRMDLLB",80,0)
 .;Get term IEN
"RTN","PXRMDLLB",81,0)
 .S TIEN=$O(^PXRMD(811.5,"B","MST "_TNAM_" REPORT","")) Q:'TIEN
"RTN","PXRMDLLB",82,0)
 .;Check if finding is mapped to term
"RTN","PXRMDLLB",83,0)
 .Q:'$D(^PXRMD(811.5,TIEN,20,"E",DFTYP,DFIEN))
"RTN","PXRMDLLB",84,0)
 .;If exam and term condition logic is null ignore
"RTN","PXRMDLLB",85,0)
 .I DFTYP="AUTTEXAM(" D  Q:TCOND=""
"RTN","PXRMDLLB",86,0)
 ..S TCOND="",TSUB=$O(^PXRMD(811.5,TIEN,20,"E",DFTYP,DFIEN,"")) Q:'TSUB
"RTN","PXRMDLLB",87,0)
 ..S TCOND=$P($G(^PXRMD(811.5,TIEN,20,TSUB,3)),U)
"RTN","PXRMDLLB",88,0)
 .;If it is then create additional prompt for MST
"RTN","PXRMDLLB",89,0)
 .N DSEQ,DEXC,DDEF,DGUI,DTYP,DTEXT,DSNL,DREQ
"RTN","PXRMDLLB",90,0)
 .;Add to end of array
"RTN","PXRMDLLB",91,0)
 .S DSEQ=$O(ARRAY(""),-1)+1
"RTN","PXRMDLLB",92,0)
 .;Null fields
"RTN","PXRMDLLB",93,0)
 .S DDEF="",DEXC="",DTEXT="",DSNL="",DREQ=""
"RTN","PXRMDLLB",94,0)
 .;MST status (exept for exams)
"RTN","PXRMDLLB",95,0)
 .I DFTYP'="AUTTEXAM(" S DDEF=$$STCODE^PXRMMST("MST "_TNAM_" REPORT")
"RTN","PXRMDLLB",96,0)
 .;GUI process and forced value
"RTN","PXRMDLLB",97,0)
 .S DGUI="MST",DTYP="F"
"RTN","PXRMDLLB",98,0)
 .;Save in array
"RTN","PXRMDLLB",99,0)
 .S ARRAY(DSEQ)=DGUI_U_DEXC_U_DDEF_U_DTYP_U_DTEXT_U_DSNL_U_DREQ
"RTN","PXRMDLLB",100,0)
 .;Quit after the first term is found
"RTN","PXRMDLLB",101,0)
 .S FOUND=1
"RTN","PXRMDLLB",102,0)
 Q
"RTN","PXRMDLLB",103,0)
 ;
"RTN","PXRMINTR")
0^16^B44071827
"RTN","PXRMINTR",1,0)
PXRMINTR ; SLC/PKR/PJH - Input transforms for Clinical Reminders. ;04/29/2003
"RTN","PXRMINTR",2,0)
 ;;1.5;CLINICAL REMINDERS;**5,7,18**;Jun 19, 2000
"RTN","PXRMINTR",3,0)
 ;=======================================================================
"RTN","PXRMINTR",4,0)
VASP(X) ;Check for valid associate sponsor in file 811.6.
"RTN","PXRMINTR",5,0)
 ;Do not execute as part of a verify fields.
"RTN","PXRMINTR",6,0)
 I $G(DIUTIL)="VERIFY FIELDS" Q 1
"RTN","PXRMINTR",7,0)
 ;Do not execute as part of exchange.
"RTN","PXRMINTR",8,0)
 I $G(PXRMEXCH) Q 1
"RTN","PXRMINTR",9,0)
 ;Make sure that an associated sponsor does not point to itself.
"RTN","PXRMINTR",10,0)
 I X=DA D  Q 0
"RTN","PXRMINTR",11,0)
 . D EN^DDIOL("An associated sponsor cannot point to itself.")
"RTN","PXRMINTR",12,0)
 ;A sponsor cannot be an associated sponsor if it contains associated
"RTN","PXRMINTR",13,0)
 ;sponsors.
"RTN","PXRMINTR",14,0)
 I $D(^PXRMD(811.6,X,2,"B")) D  Q 0
"RTN","PXRMINTR",15,0)
 . D EN^DDIOL("A sponsor cannot be selected as an associated sponsor if it contains associated sponsors.")
"RTN","PXRMINTR",16,0)
 ;The class of an associated sponsor must match that of the sponsor.
"RTN","PXRMINTR",17,0)
 N ASCLASS,SCLASS
"RTN","PXRMINTR",18,0)
 S SCLASS=$P(^PXRMD(811.6,DA,0),U,2)
"RTN","PXRMINTR",19,0)
 S ASCLASS=$P(^PXRMD(811.6,X,0),U,2)
"RTN","PXRMINTR",20,0)
 I ASCLASS'=SCLASS D  Q 0
"RTN","PXRMINTR",21,0)
 . N TEXT
"RTN","PXRMINTR",22,0)
 . S TEXT="The associated sponsor's class is "_ASCLASS_", it does not match the sponsor's class which is "_SCLASS_". They must match."
"RTN","PXRMINTR",23,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMINTR",24,0)
 Q 1
"RTN","PXRMINTR",25,0)
 ;
"RTN","PXRMINTR",26,0)
 ;=======================================================================
"RTN","PXRMINTR",27,0)
VCLASS(X) ;Check for valid CLASS field, ordinary users cannot create
"RTN","PXRMINTR",28,0)
 ;National classes.
"RTN","PXRMINTR",29,0)
 ;Do not execute as part of a verify fields.
"RTN","PXRMINTR",30,0)
 I $G(DIUTIL)="VERIFY FIELDS" Q 1
"RTN","PXRMINTR",31,0)
 ;Do not execute as part of exchange.
"RTN","PXRMINTR",32,0)
 I $G(PXRMEXCH) Q 1
"RTN","PXRMINTR",33,0)
 I (X["N"),(($G(PXRMINST)'=1)!(DUZ(0)'="@")) D  Q 0
"RTN","PXRMINTR",34,0)
 . D EN^DDIOL("You are not allowed to create a NATIONAL class")
"RTN","PXRMINTR",35,0)
 E  Q 1
"RTN","PXRMINTR",36,0)
 ;
"RTN","PXRMINTR",37,0)
 ;=======================================================================
"RTN","PXRMINTR",38,0)
VCOND(X) ;Make sure X is a valid CONDITION.
"RTN","PXRMINTR",39,0)
 I '$D(X) Q
"RTN","PXRMINTR",40,0)
 ;The CONDITION must start with "I ".
"RTN","PXRMINTR",41,0)
 I $E(X,1,2)'="I " D  Q
"RTN","PXRMINTR",42,0)
 . K X
"RTN","PXRMINTR",43,0)
 . D EN^DDIOL("CONDITION must start with ""I"" followed by a single space")
"RTN","PXRMINTR",44,0)
 N COND,CS,RS
"RTN","PXRMINTR",45,0)
 ;Find the condition and the left and right sides.
"RTN","PXRMINTR",46,0)
 S (CS,RS)=""
"RTN","PXRMINTR",47,0)
 F COND="=",">","<","[","]" Q:CS'=""  D
"RTN","PXRMINTR",48,0)
 . S RS=$P(X,COND,2)
"RTN","PXRMINTR",49,0)
 . I RS'="" S CS=COND
"RTN","PXRMINTR",50,0)
 I CS="" D  Q
"RTN","PXRMINTR",51,0)
 . K X
"RTN","PXRMINTR",52,0)
 . D EN^DDIOL("CONDITION must use a conditional operator i.e., =, >, <, [, or ]")
"RTN","PXRMINTR",53,0)
 ;As a safety measure everything after the "I " cannot contain space
"RTN","PXRMINTR",54,0)
 ;or ^.
"RTN","PXRMINTR",55,0)
 S RS=$E(X,3,$L(X))
"RTN","PXRMINTR",56,0)
 S RS=$TR(RS," ^","~")
"RTN","PXRMINTR",57,0)
 S X="I "_RS
"RTN","PXRMINTR",58,0)
 D ^DIM
"RTN","PXRMINTR",59,0)
 I '$D(X) D EN^DDIOL("This is not a valid CONDITION")
"RTN","PXRMINTR",60,0)
 Q
"RTN","PXRMINTR",61,0)
 ;
"RTN","PXRMINTR",62,0)
 ;=======================================================================
"RTN","PXRMINTR",63,0)
VFINDING(X) ;Check X to see if it is a valid finding. This is the input
"RTN","PXRMINTR",64,0)
 ;transform on the .01 field of the reminder findings multiple. Data
"RTN","PXRMINTR",65,0)
 ;element 811.902,.01.
"RTN","PXRMINTR",66,0)
 ;Include stubs for all possible finding types in case we need input
"RTN","PXRMINTR",67,0)
 ;transforms on them.
"RTN","PXRMINTR",68,0)
 ;I X["AUTTEDT(" Q 1
"RTN","PXRMINTR",69,0)
 ;I X["AUTTEXAM(" Q 1
"RTN","PXRMINTR",70,0)
 I X["AUTTHF(" Q $$VHF(X)
"RTN","PXRMINTR",71,0)
 ;I X["AUTTIMM(" Q 1
"RTN","PXRMINTR",72,0)
 ;I X["AUTTSK(" Q 1
"RTN","PXRMINTR",73,0)
 ;I X["GMRD(120.51," Q 1
"RTN","PXRMINTR",74,0)
 I X["LAB(60," Q $$VLAB(X)
"RTN","PXRMINTR",75,0)
 ;I X["ORD(101.43," Q 1
"RTN","PXRMINTR",76,0)
 I X["PXD(811.2," Q $$VTAX(X)
"RTN","PXRMINTR",77,0)
 ;I X["PXRMD(811.4," Q 1
"RTN","PXRMINTR",78,0)
 ;I X["PXRMD(811.5," Q 1
"RTN","PXRMINTR",79,0)
 ;I X["PS(50.605," Q 1
"RTN","PXRMINTR",80,0)
 ;I X["PSDRUG(" Q 1
"RTN","PXRMINTR",81,0)
 ;I X["PSNDF(50.6," Q 1
"RTN","PXRMINTR",82,0)
 ;I X["RAMIS(71," Q 1
"RTN","PXRMINTR",83,0)
 I X["YTT(601," Q $$VMH(X)
"RTN","PXRMINTR",84,0)
 Q 1
"RTN","PXRMINTR",85,0)
 ;
"RTN","PXRMINTR",86,0)
 ;=======================================================================
"RTN","PXRMINTR",87,0)
VHF(X) ;Check for valid health factor findings. It must be a factor, not
"RTN","PXRMINTR",88,0)
 ;a category.
"RTN","PXRMINTR",89,0)
 N CAT,IEN,TEMP,TYPE
"RTN","PXRMINTR",90,0)
 S IEN=$P(X,";",1)
"RTN","PXRMINTR",91,0)
 S TEMP=$G(^AUTTHF(IEN,0))
"RTN","PXRMINTR",92,0)
 S TYPE=$P(TEMP,U,10)
"RTN","PXRMINTR",93,0)
 I TYPE="C" D  Q 0
"RTN","PXRMINTR",94,0)
 . D EN^DDIOL("Category health factors cannot be used in reminder definitions!")
"RTN","PXRMINTR",95,0)
 I TYPE'="F" D  Q 0
"RTN","PXRMINTR",96,0)
 . D EN^DDIOL("Only factor health factors can be used in reminder definitions!")
"RTN","PXRMINTR",97,0)
 ;Make sure that the health factor has a category.
"RTN","PXRMINTR",98,0)
 S CAT=$P(TEMP,U,3)
"RTN","PXRMINTR",99,0)
 I CAT="" D  Q 0
"RTN","PXRMINTR",100,0)
 . D EN^DDIOL("Factor health factors must have a category!")
"RTN","PXRMINTR",101,0)
 Q 1
"RTN","PXRMINTR",102,0)
 ;
"RTN","PXRMINTR",103,0)
 ;=======================================================================
"RTN","PXRMINTR",104,0)
VIGNAC(X) ;Check X to see if it contains valid IGNORE ON N/A codes.
"RTN","PXRMINTR",105,0)
 ;This is part of the input transform for this field. The length of the
"RTN","PXRMINTR",106,0)
 ;IGNORE ON N/A field is 8 characters. The valid codes are:
"RTN","PXRMINTR",107,0)
 ;   A - age
"RTN","PXRMINTR",108,0)
 ;   I - inactive
"RTN","PXRMINTR",109,0)
 ;   R - race
"RTN","PXRMINTR",110,0)
 ;   S - sex
"RTN","PXRMINTR",111,0)
 ;   * - wildcard matches anything.
"RTN","PXRMINTR",112,0)
 N LEN
"RTN","PXRMINTR",113,0)
 S LEN=$L(X)
"RTN","PXRMINTR",114,0)
 I (LEN>8)!(LEN<1) Q 0
"RTN","PXRMINTR",115,0)
 ;
"RTN","PXRMINTR",116,0)
 N TEMP,TEXT
"RTN","PXRMINTR",117,0)
 S TEMP=X
"RTN","PXRMINTR",118,0)
 S TEMP=$TR(TEMP,"A","")
"RTN","PXRMINTR",119,0)
 S TEMP=$TR(TEMP,"I","")
"RTN","PXRMINTR",120,0)
 S TEMP=$TR(TEMP,"R","")
"RTN","PXRMINTR",121,0)
 S TEMP=$TR(TEMP,"S","")
"RTN","PXRMINTR",122,0)
 S TEMP=$TR(TEMP,"*","")
"RTN","PXRMINTR",123,0)
 ;At this point TEMP should be NULL,if it is not then there are
"RTN","PXRMINTR",124,0)
 ;bad codes.
"RTN","PXRMINTR",125,0)
 S LEN=$L(TEMP)
"RTN","PXRMINTR",126,0)
 I LEN=1 D  Q 0
"RTN","PXRMINTR",127,0)
 . S TEXT=TEMP_" is not a valid IGNORE ON N/A code!"
"RTN","PXRMINTR",128,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMINTR",129,0)
 I LEN>1 D  Q 0
"RTN","PXRMINTR",130,0)
 . S TEXT=TEMP_" are not valid IGNORE ON N/A codes!"
"RTN","PXRMINTR",131,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMINTR",132,0)
 Q 1
"RTN","PXRMINTR",133,0)
 ;
"RTN","PXRMINTR",134,0)
 ;=======================================================================
"RTN","PXRMINTR",135,0)
VLAB(X) ;Check for valid lab findings. They must be in the
"RTN","PXRMINTR",136,0)
 ;chemistry/hematology node and are not a panel.
"RTN","PXRMINTR",137,0)
 I X'["LAB(60" Q 1
"RTN","PXRMINTR",138,0)
 N LAB0,LABTEST,TEST,WARN
"RTN","PXRMINTR",139,0)
 S LABTEST=$P(X,";",1)
"RTN","PXRMINTR",140,0)
 S LAB0=^LAB(60,LABTEST,0)
"RTN","PXRMINTR",141,0)
 S WARN='+$P(X,";",3)
"RTN","PXRMINTR",142,0)
 I $P(LAB0,U,4)'["CH" D  Q 0
"RTN","PXRMINTR",143,0)
 . I WARN D
"RTN","PXRMINTR",144,0)
 .. S TEXT(1)=$P(LAB0,U,1)_" is not a ""CH"" subscript lab, cannot be used for a reminder!"
"RTN","PXRMINTR",145,0)
 .. S TEXT(2)="Contact your Lab ADPAC for help"
"RTN","PXRMINTR",146,0)
 .. D EN^DDIOL(.TEXT)
"RTN","PXRMINTR",147,0)
 I $P($P(LAB0,U,5),";",2)="" D  Q 0
"RTN","PXRMINTR",148,0)
 . I WARN D
"RTN","PXRMINTR",149,0)
 .. S TEXT(1)=$P(LAB0,U,1)_" is a lab panel, cannot be used for a reminder!"
"RTN","PXRMINTR",150,0)
 .. S TEXT(2)="Contact your Lab ADPAC for help"
"RTN","PXRMINTR",151,0)
 .. D EN^DDIOL(.TEXT)
"RTN","PXRMINTR",152,0)
 Q 1
"RTN","PXRMINTR",153,0)
 ;
"RTN","PXRMINTR",154,0)
 ;=======================================================================
"RTN","PXRMINTR",155,0)
VMH(X) ;The site must have the routine YTAPI installed in order to use
"RTN","PXRMINTR",156,0)
 ;mental health instrument findings.
"RTN","PXRMINTR",157,0)
 N EXISTS
"RTN","PXRMINTR",158,0)
 S EXISTS=$$EXISTS^PXRMEXCF("YTAPI")
"RTN","PXRMINTR",159,0)
 I EXISTS Q 1
"RTN","PXRMINTR",160,0)
 N TEXT
"RTN","PXRMINTR",161,0)
 S TEXT(1)="Your site does not have the routine YTAPI installed."
"RTN","PXRMINTR",162,0)
 S TEXT(2)="It is required in order to use Mental Instrument findings."
"RTN","PXRMINTR",163,0)
 S TEXT(3)="The routine was originally released in patch YS*5.01*53."
"RTN","PXRMINTR",164,0)
 S TEXT(4)=" "
"RTN","PXRMINTR",165,0)
 D EN^DDIOL(.TEXT)
"RTN","PXRMINTR",166,0)
 Q 0
"RTN","PXRMINTR",167,0)
 ;
"RTN","PXRMINTR",168,0)
 ;=======================================================================
"RTN","PXRMINTR",169,0)
VNAME(NAME,FILE) ;Check for valid .01 value.
"RTN","PXRMINTR",170,0)
 ;For files 801.41, 811.2, 811.4 and 811.9 the name cannot start with VA-
"RTN","PXRMINTR",171,0)
 ;unless this is a national reminder.
"RTN","PXRMINTR",172,0)
 ;Do not execute as part of a verify fields.
"RTN","PXRMINTR",173,0)
 I $G(DIUTIL)="VERIFY FIELDS" Q 1
"RTN","PXRMINTR",174,0)
 ;Do not execute as part of exchange.
"RTN","PXRMINTR",175,0)
 I $G(PXRMEXCH) Q 1
"RTN","PXRMINTR",176,0)
 N STEXT,TEXT,VALID
"RTN","PXRMINTR",177,0)
 S VALID=1
"RTN","PXRMINTR",178,0)
 I (FILE=811.2)!(FILE=811.4)!(FILE=811.9)!(FILE=801.41) D
"RTN","PXRMINTR",179,0)
 . S STEXT=$E(NAME,1,3)
"RTN","PXRMINTR",180,0)
 . I (STEXT="VA-"),(($G(PXRMINST)'=1)!(DUZ(0)'="@")) D
"RTN","PXRMINTR",181,0)
 .. S TEXT=NAME_" cannot start with ""VA-"", reserved for national distribution!"
"RTN","PXRMINTR",182,0)
 .. D EN^DDIOL(TEXT)
"RTN","PXRMINTR",183,0)
 .. H 2
"RTN","PXRMINTR",184,0)
 .. S VALID=0
"RTN","PXRMINTR",185,0)
 Q VALID
"RTN","PXRMINTR",186,0)
 ;
"RTN","PXRMINTR",187,0)
 ;=======================================================================
"RTN","PXRMINTR",188,0)
VSPONSOR(X) ;Make sure file Class and Sponsor Class match.
"RTN","PXRMINTR",189,0)
 ;If there is no sponsor don't do the check.
"RTN","PXRMINTR",190,0)
 I X="" Q 1
"RTN","PXRMINTR",191,0)
 ;Do not execute as part of a verify fields.
"RTN","PXRMINTR",192,0)
 I $G(DIUTIL)="VERIFY FIELDS" Q 1
"RTN","PXRMINTR",193,0)
 ;Do not execute as part of exchange.
"RTN","PXRMINTR",194,0)
 I $G(PXRMEXCH) Q 1
"RTN","PXRMINTR",195,0)
 N FCLASS,SCLASS,TEXT,VALID
"RTN","PXRMINTR",196,0)
 S VALID=1
"RTN","PXRMINTR",197,0)
 S FCLASS=$P(@(DIC_DA_",100)"),U,1)
"RTN","PXRMINTR",198,0)
 S SCLASS=$P(^PXRMD(811.6,X,0),U,2)
"RTN","PXRMINTR",199,0)
 I SCLASS'=FCLASS D
"RTN","PXRMINTR",200,0)
 . S FCLASS=$$EXTERNAL^DILFD(811.6,.02,"",FCLASS)
"RTN","PXRMINTR",201,0)
 . S SCLASS=$$EXTERNAL^DILFD(811.6,.02,"",SCLASS)
"RTN","PXRMINTR",202,0)
 . S TEXT="Sponsor Class is "_SCLASS_", File Class is "_FCLASS_" they must match!"
"RTN","PXRMINTR",203,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMINTR",204,0)
 . S VALID=0
"RTN","PXRMINTR",205,0)
 Q VALID
"RTN","PXRMINTR",206,0)
 ;
"RTN","PXRMINTR",207,0)
 ;=======================================================================
"RTN","PXRMINTR",208,0)
VTAX(X) ;Make sure the taxonomy is active.
"RTN","PXRMINTR",209,0)
 N IEN,INACTIVE
"RTN","PXRMINTR",210,0)
 S IEN=$P(X,";",1)
"RTN","PXRMINTR",211,0)
 S INACTIVE=$P(^PXD(811.2,IEN,0),U,6)
"RTN","PXRMINTR",212,0)
 I INACTIVE D  Q 0
"RTN","PXRMINTR",213,0)
 . D EN^DDIOL("This taxonomy is inactive and cannot be selected.")
"RTN","PXRMINTR",214,0)
 E  Q 1
"RTN","PXRMINTR",215,0)
 ;
"RTN","PXRMINTR",216,0)
 ;=======================================================================
"RTN","PXRMINTR",217,0)
VTPER(X) ;Check for valid time period. They must be of the form NS,
"RTN","PXRMINTR",218,0)
 ; where N is a number and S is D for days, M for months, or Y for years.
"RTN","PXRMINTR",219,0)
 N LEN
"RTN","PXRMINTR",220,0)
 S X=$$UP^XLFSTR(X)
"RTN","PXRMINTR",221,0)
 S LEN=$L(X)
"RTN","PXRMINTR",222,0)
 I (LEN>5)!(LEN<2) Q 0
"RTN","PXRMINTR",223,0)
 I ((X'?1N.N1"D")&(X'?1N.N1"M")&(X'?1N.N1"Y")) Q 0
"RTN","PXRMINTR",224,0)
 Q 1
"RTN","PXRMINTR",225,0)
 ;
"RTN","PXRMINTR",226,0)
 ;=======================================================================
"RTN","PXRMINTR",227,0)
VUSAGE(X) ;Check X to see if it contains valid USAGE codes.
"RTN","PXRMINTR",228,0)
 ;This is part of the input transform for this field. The length of the
"RTN","PXRMINTR",229,0)
 ;USAGE field is 10 characters. The valid codes are:
"RTN","PXRMINTR",230,0)
 ;   C - CPRS
"RTN","PXRMINTR",231,0)
 ;   R - reports
"RTN","PXRMINTR",232,0)
 ;   X - extracts
"RTN","PXRMINTR",233,0)
 ;   * - wildcard matches anything.
"RTN","PXRMINTR",234,0)
 N LEN
"RTN","PXRMINTR",235,0)
 S LEN=$L(X)
"RTN","PXRMINTR",236,0)
 I (LEN>10)!(LEN<1) Q 0
"RTN","PXRMINTR",237,0)
 ;
"RTN","PXRMINTR",238,0)
 N TEMP,TEXT
"RTN","PXRMINTR",239,0)
 S TEMP=X
"RTN","PXRMINTR",240,0)
 S TEMP=$TR(TEMP,"C","")
"RTN","PXRMINTR",241,0)
 S TEMP=$TR(TEMP,"R","")
"RTN","PXRMINTR",242,0)
 S TEMP=$TR(TEMP,"X","")
"RTN","PXRMINTR",243,0)
 S TEMP=$TR(TEMP,"*","")
"RTN","PXRMINTR",244,0)
 ;At this point TEMP should be NULL,if it is not then there are
"RTN","PXRMINTR",245,0)
 ;bad codes.
"RTN","PXRMINTR",246,0)
 S LEN=$L(TEMP)
"RTN","PXRMINTR",247,0)
 I LEN=1 D  Q 0
"RTN","PXRMINTR",248,0)
 . S TEXT=TEMP_" is not a valid USAGE code!"
"RTN","PXRMINTR",249,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMINTR",250,0)
 I LEN>1 D  Q 0
"RTN","PXRMINTR",251,0)
 . S TEXT=TEMP_" are not valid USAGE codes!"
"RTN","PXRMINTR",252,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMINTR",253,0)
 Q 1
"RTN","PXRMP18E")
0^17^B473282
"RTN","PXRMP18E",1,0)
PXRMP18E ; SLC/JVS - Inits for PXRM*1.5*18 ;08/25/2000
"RTN","PXRMP18E",2,0)
 ;;1.5;CLINICAL REMINDERS;**18**;Jun 19, 2000
"RTN","PXRMP18E",3,0)
 ;===============================================================
"RTN","PXRMP18E",4,0)
ENV ;Environment check
"RTN","PXRMP18E",5,0)
 ;
"RTN","PXRMP18E",6,0)
 ;Make sure the user has programmer access
"RTN","PXRMP18E",7,0)
 I $G(DUZ(0))'="@" D  Q
"RTN","PXRMP18E",8,0)
 .D BMES^XPDUTL("Programmer access required") S XPDQUIT=2
"RTN","PXRMP18E",9,0)
 ;Make sure the package version is 1.5 and not 2.0
"RTN","PXRMP18E",10,0)
 I $$VERSION^XPDUTL("PXRM")'=1.5 D  Q
"RTN","PXRMP18E",11,0)
 .D BMES^XPDUTL("Not Reminder Package Version 1.5") S XPDQUIT=2
"RTN","PXRMP18E",12,0)
 Q
"RTN","PXRMP18I")
0^18^B6133354
"RTN","PXRMP18I",1,0)
PXRMP18I ; SLC/PKR/PJH - Patch 18 inits. ;08/29/2003
"RTN","PXRMP18I",2,0)
 ;;1.5;CLINICAL REMINDERS;**18**;Jun 19, 2000
"RTN","PXRMP18I",3,0)
 ;
"RTN","PXRMP18I",4,0)
 Q
"RTN","PXRMP18I",5,0)
 ;
"RTN","PXRMP18I",6,0)
 ;===============================================================
"RTN","PXRMP18I",7,0)
CSVPE ;Execute the CSV protocol event points.
"RTN","PXRMP18I",8,0)
 D ICDPE^PXRMCSPE
"RTN","PXRMP18I",9,0)
 D CPTPE^PXRMCSPE
"RTN","PXRMP18I",10,0)
 Q
"RTN","PXRMP18I",11,0)
 ;
"RTN","PXRMP18I",12,0)
 ;===============================================================
"RTN","PXRMP18I",13,0)
DELDD ;Delete the old data dictionaries.
"RTN","PXRMP18I",14,0)
 N DIU,TEXT
"RTN","PXRMP18I",15,0)
 D EN^DDIOL("Removing old data dictionaries.")
"RTN","PXRMP18I",16,0)
 S DIU(0)=""
"RTN","PXRMP18I",17,0)
 F DIU=811.2 D
"RTN","PXRMP18I",18,0)
 . S TEXT=" Deleting data dictionary for file # "_DIU
"RTN","PXRMP18I",19,0)
 . D EN^DDIOL(TEXT)
"RTN","PXRMP18I",20,0)
 . D EN^DIU2
"RTN","PXRMP18I",21,0)
 Q
"RTN","PXRMP18I",22,0)
 ;
"RTN","PXRMP18I",23,0)
 ;===============================================================
"RTN","PXRMP18I",24,0)
PRE ;Pre-inits
"RTN","PXRMP18I",25,0)
 D DELDD
"RTN","PXRMP18I",26,0)
 Q
"RTN","PXRMP18I",27,0)
 ;
"RTN","PXRMP18I",28,0)
 ;===============================================================
"RTN","PXRMP18I",29,0)
POST ;Post-inits
"RTN","PXRMP18I",30,0)
 D RTAXEXP
"RTN","PXRMP18I",31,0)
 D SADJTXN
"RTN","PXRMP18I",32,0)
 D CSVPE
"RTN","PXRMP18I",33,0)
 Q
"RTN","PXRMP18I",34,0)
 ;
"RTN","PXRMP18I",35,0)
 ;===============================================================
"RTN","PXRMP18I",36,0)
RTAXEXP ;Rebuild all taxonomy expansions.
"RTN","PXRMP18I",37,0)
 N IND,TEXT,X,X1,X2
"RTN","PXRMP18I",38,0)
 S (X1,X2)="TAX"
"RTN","PXRMP18I",39,0)
 D BMES^XPDUTL("Rebuilding taxonomy expansions.")
"RTN","PXRMP18I",40,0)
 S IND=0
"RTN","PXRMP18I",41,0)
 F  S IND=+$O(^PXD(811.2,IND)) Q:IND=0  D
"RTN","PXRMP18I",42,0)
 . S TEXT=" Working on taxonomy "_IND
"RTN","PXRMP18I",43,0)
 . D BMES^XPDUTL(TEXT)
"RTN","PXRMP18I",44,0)
 . D DELEXTL^PXRMBXTL(IND)
"RTN","PXRMP18I",45,0)
 . D EXPAND^PXRMBXTL(IND,"")
"RTN","PXRMP18I",46,0)
 D BMES^XPDUTL(" DONE")
"RTN","PXRMP18I",47,0)
 Q
"RTN","PXRMP18I",48,0)
 ;
"RTN","PXRMP18I",49,0)
 ;===============================================================
"RTN","PXRMP18I",50,0)
SADJTXN ;Set new adjacent nodes in the taxonomies.
"RTN","PXRMP18I",51,0)
 N ALOW,AHIGH,FILENUM,HIGH,LOW,IEN,IND,TEMP,TEXT
"RTN","PXRMP18I",52,0)
 D BMES^XPDUTL("Setting adjacent values for all taxonomies.")
"RTN","PXRMP18I",53,0)
 S IEN=0
"RTN","PXRMP18I",54,0)
 F  S IEN=+$O(^PXD(811.2,IEN)) Q:IEN=0  D
"RTN","PXRMP18I",55,0)
 . S TEXT=" Working on taxonomy "_IEN
"RTN","PXRMP18I",56,0)
 . D BMES^XPDUTL(TEXT)
"RTN","PXRMP18I",57,0)
 . F FILENUM=80,80.1,81 D
"RTN","PXRMP18I",58,0)
 .. S IND=0
"RTN","PXRMP18I",59,0)
 .. F  S IND=+$O(^PXD(811.2,IEN,FILENUM,IND)) Q:IND=0  D
"RTN","PXRMP18I",60,0)
 ... S TEMP=^PXD(811.2,IEN,FILENUM,IND,0)
"RTN","PXRMP18I",61,0)
 ... S LOW=$P(TEMP,U,1),HIGH=$P(TEMP,U,2)
"RTN","PXRMP18I",62,0)
 ... S ALOW=$S(FILENUM=80:$$PREV^ICDAPIU(LOW),FILENUM=80.1:$$PREV^ICDAPIU(LOW),FILENUM=81:$$PREV^ICPTAPIU(LOW))
"RTN","PXRMP18I",63,0)
 ... S AHIGH=$S(FILENUM=80:$$NEXT^ICDAPIU(HIGH),FILENUM=80.1:$$NEXT^ICDAPIU(HIGH),FILENUM=81:$$NEXT^ICPTAPIU(HIGH))
"RTN","PXRMP18I",64,0)
 ... S $P(^PXD(811.2,IEN,FILENUM,IND,0),U,3,4)=ALOW_U_AHIGH
"RTN","PXRMP18I",65,0)
 D BMES^XPDUTL(" DONE")
"RTN","PXRMP18I",66,0)
 Q
"RTN","PXRMP18I",67,0)
 ;
"RTN","PXRMPTTX")
0^12^B13593591
"RTN","PXRMPTTX",1,0)
PXRMPTTX ;SLC/PKR - Routines for taxonomy print templates ;04/09/2003
"RTN","PXRMPTTX",2,0)
 ;;1.5;CLINICAL REMINDERS;**2,18**;Jun 19, 2000
"RTN","PXRMPTTX",3,0)
 ;
"RTN","PXRMPTTX",4,0)
 ;======================================================================
"RTN","PXRMPTTX",5,0)
ICD0LIST ;Print expanded list of ICD0 codes.
"RTN","PXRMPTTX",6,0)
 N ACTDATE,CODE,DATA,INADATE,LOW,HIGH,TEMP,TEXT
"RTN","PXRMPTTX",7,0)
 S TEMP=^PXD(811.2,D0,80.1,D1,0)
"RTN","PXRMPTTX",8,0)
 S (ACTDATE,INADATE)=$$FMTE^XLFDT(DT,"5Z")
"RTN","PXRMPTTX",9,0)
 S LOW=$P(TEMP,U,1)
"RTN","PXRMPTTX",10,0)
 S HIGH=$P(TEMP,U,2)
"RTN","PXRMPTTX",11,0)
 I HIGH="" S HIGH=LOW
"RTN","PXRMPTTX",12,0)
 W !!,?2,"Code",?10,"ICD Operation/Procedure",?42,"Activation",?54,"Inactivation"
"RTN","PXRMPTTX",13,0)
 W !,?2,"----",?10,"-----------------------",?42,"----------",?54,"------------"
"RTN","PXRMPTTX",14,0)
 S CODE=LOW
"RTN","PXRMPTTX",15,0)
 F  Q:(CODE]HIGH)!(CODE="")  D
"RTN","PXRMPTTX",16,0)
 . K DATA
"RTN","PXRMPTTX",17,0)
 . D PERIOD^ICDAPIU(CODE,.DATA)
"RTN","PXRMPTTX",18,0)
 . S ACTDATE=0
"RTN","PXRMPTTX",19,0)
 . F  S ACTDATE=$O(DATA(ACTDATE)) Q:ACTDATE=""  D
"RTN","PXRMPTTX",20,0)
 .. S INADATE=$P(DATA(ACTDATE),U,1)
"RTN","PXRMPTTX",21,0)
 .. S TEXT=$P(DATA(ACTDATE),U,2)
"RTN","PXRMPTTX",22,0)
 .. S TEXT=$E(TEXT,1,30)
"RTN","PXRMPTTX",23,0)
 .. W !,?2,CODE,?10,TEXT,?42,$$FMTE^XLFDT(ACTDATE,"5Z"),?54,$$FMTE^XLFDT(INADATE,"5Z")
"RTN","PXRMPTTX",24,0)
 . S CODE=$$NEXT^ICDAPIU(CODE)
"RTN","PXRMPTTX",25,0)
 Q
"RTN","PXRMPTTX",26,0)
 ;
"RTN","PXRMPTTX",27,0)
 ;======================================================================
"RTN","PXRMPTTX",28,0)
ICD9LIST ;Print expanded list of ICD9 codes.
"RTN","PXRMPTTX",29,0)
 N ACTDATE,CODE,DATA,IEN,INADATE,LOW,HIGH,SEL,TEMP,TEXT
"RTN","PXRMPTTX",30,0)
 S TEMP=^PXD(811.2,D0,80,D1,0)
"RTN","PXRMPTTX",31,0)
 S LOW=$P(TEMP,U,1)
"RTN","PXRMPTTX",32,0)
 S HIGH=$P(TEMP,U,2)
"RTN","PXRMPTTX",33,0)
 I HIGH="" S HIGH=LOW
"RTN","PXRMPTTX",34,0)
 W !!,?2,"Code",?10,"ICD Diagnosis",?42,"Activation",?54,"Inactivation",?67,"Selectable"
"RTN","PXRMPTTX",35,0)
 W !,?2,"----",?10,"--------------",?42,"----------",?54,"------------",?67,"----------"
"RTN","PXRMPTTX",36,0)
 S CODE=LOW
"RTN","PXRMPTTX",37,0)
 F  Q:(CODE]HIGH)!(CODE="")  D
"RTN","PXRMPTTX",38,0)
 . K DATA
"RTN","PXRMPTTX",39,0)
 . D PERIOD^ICDAPIU(CODE,.DATA)
"RTN","PXRMPTTX",40,0)
 . S IEN=$P(DATA(0),U,1)
"RTN","PXRMPTTX",41,0)
 . S SEL=$S($D(^PXD(811.2,D0,"SDX","B",IEN)):"X",1:"")
"RTN","PXRMPTTX",42,0)
 . S ACTDATE=0
"RTN","PXRMPTTX",43,0)
 . F  S ACTDATE=$O(DATA(ACTDATE)) Q:ACTDATE=""  D
"RTN","PXRMPTTX",44,0)
 .. S INADATE=$P(DATA(ACTDATE),U,1)
"RTN","PXRMPTTX",45,0)
 .. S TEXT=$P(DATA(ACTDATE),U,2)
"RTN","PXRMPTTX",46,0)
 .. W !,?2,CODE,?10,TEXT,?42,$$FMTE^XLFDT(ACTDATE,"5Z"),?54,$$FMTE^XLFDT(INADATE,"5Z"),?71,SEL
"RTN","PXRMPTTX",47,0)
 . S CODE=$$NEXT^ICDAPIU(CODE)
"RTN","PXRMPTTX",48,0)
 Q
"RTN","PXRMPTTX",49,0)
 ;
"RTN","PXRMPTTX",50,0)
 ;======================================================================
"RTN","PXRMPTTX",51,0)
ICPTLIST ;Print expanded list of CPT codes.
"RTN","PXRMPTTX",52,0)
 N ACTDATE,CODE,DATA,IEN,INADATE,LOW,HIGH,SEL,TEMP,TEXT
"RTN","PXRMPTTX",53,0)
 S TEMP=^PXD(811.2,D0,81,D1,0)
"RTN","PXRMPTTX",54,0)
 S LOW=$P(TEMP,U,1)
"RTN","PXRMPTTX",55,0)
 S HIGH=$P(TEMP,U,2)
"RTN","PXRMPTTX",56,0)
 I HIGH="" S HIGH=LOW
"RTN","PXRMPTTX",57,0)
 W !!,?2,"Code",?10,"CPT Short Name",?42,"Activation",?54,"Inactivation",?67,"Selectable"
"RTN","PXRMPTTX",58,0)
 W !,?2,"----",?10,"--------------",?42,"----------",?54,"------------",?67,"----------"
"RTN","PXRMPTTX",59,0)
 S CODE=LOW
"RTN","PXRMPTTX",60,0)
 F  Q:(CODE]HIGH)!(CODE="")  D
"RTN","PXRMPTTX",61,0)
 . K DATA
"RTN","PXRMPTTX",62,0)
 . D PERIOD^ICPTAPIU(CODE,.DATA)
"RTN","PXRMPTTX",63,0)
 . S IEN=$P(DATA(0),U,1)
"RTN","PXRMPTTX",64,0)
 . S SEL=$S($D(^PXD(811.2,D0,"SPR","B",IEN)):"X",1:"")
"RTN","PXRMPTTX",65,0)
 . S ACTDATE=0
"RTN","PXRMPTTX",66,0)
 . F  S ACTDATE=$O(DATA(ACTDATE)) Q:ACTDATE=""  D
"RTN","PXRMPTTX",67,0)
 .. S INADATE=$P(DATA(ACTDATE),U,1)
"RTN","PXRMPTTX",68,0)
 .. S TEXT=$P(DATA(ACTDATE),U,2)
"RTN","PXRMPTTX",69,0)
 .. W !,?2,CODE,?10,TEXT,?42,$$FMTE^XLFDT(ACTDATE,"5Z"),?54,$$FMTE^XLFDT(INADATE,"5Z"),?71,SEL
"RTN","PXRMPTTX",70,0)
 . S CODE=$$NEXT^ICPTAPIU(CODE)
"RTN","PXRMPTTX",71,0)
 Q
"RTN","PXRMPTTX",72,0)
 ;
"RTN","PXRMPTTX",73,0)
 ;======================================================================
"RTN","PXRMPTTX",74,0)
TAXLIST ;Taxonomy list.
"RTN","PXRMPTTX",75,0)
 N CODES,CPT,CPTLIST,ICD0,ICD0LIST,ICD9,ICD9LIST,IND,NCODES
"RTN","PXRMPTTX",76,0)
 S (IC,IND)=0
"RTN","PXRMPTTX",77,0)
 F  S IND=+$O(^PXD(811.2,D0,80,IND)) Q:IND=0  D
"RTN","PXRMPTTX",78,0)
 . S IC=IC+1
"RTN","PXRMPTTX",79,0)
 . S CODES=^PXD(811.2,D0,80,IND,0)
"RTN","PXRMPTTX",80,0)
 . S ICD9LIST(IC)=CODES
"RTN","PXRMPTTX",81,0)
 S NCODES=IC
"RTN","PXRMPTTX",82,0)
 ;
"RTN","PXRMPTTX",83,0)
 S (IC,IND)=0
"RTN","PXRMPTTX",84,0)
 F  S IND=+$O(^PXD(811.2,D0,80.1,IND)) Q:IND=0  D
"RTN","PXRMPTTX",85,0)
 . S IC=IC+1
"RTN","PXRMPTTX",86,0)
 . S CODES=^PXD(811.2,D0,80.1,IND,0)
"RTN","PXRMPTTX",87,0)
 . S ICD0LIST(IC)=CODES
"RTN","PXRMPTTX",88,0)
 S NCODES=$$MAX^XLFMTH(NCODES,IC)
"RTN","PXRMPTTX",89,0)
 ;
"RTN","PXRMPTTX",90,0)
 S (IC,IND)=0
"RTN","PXRMPTTX",91,0)
 F  S IND=+$O(^PXD(811.2,D0,81,IND)) Q:IND=0  D
"RTN","PXRMPTTX",92,0)
 . S IC=IC+1
"RTN","PXRMPTTX",93,0)
 . S CODES=^PXD(811.2,D0,81,IND,0)
"RTN","PXRMPTTX",94,0)
 . S CPTLIST(IC)=CODES
"RTN","PXRMPTTX",95,0)
 S NCODES=$$MAX^XLFMTH(NCODES,IC)
"RTN","PXRMPTTX",96,0)
 ;Print the list.
"RTN","PXRMPTTX",97,0)
 F IC=1:1:NCODES D
"RTN","PXRMPTTX",98,0)
 . S ICD9=$G(ICD9LIST(IC))
"RTN","PXRMPTTX",99,0)
 . S ICD0=$G(ICD0LIST(IC))
"RTN","PXRMPTTX",100,0)
 . S CPT=$G(CPTLIST(IC))
"RTN","PXRMPTTX",101,0)
 . W !,?9,$P(ICD9,U,1),?19,$P(ICD9,U,2)
"RTN","PXRMPTTX",102,0)
 . W ?29,$P(ICD0,U,1),?39,$P(ICD0,U,2)
"RTN","PXRMPTTX",103,0)
 . W ?49,$P(CPT,U,1),?59,$P(CPT,U,2)
"RTN","PXRMPTTX",104,0)
 Q
"RTN","PXRMPTTX",105,0)
 ;
"RTN","PXRMTDLG")
0^13^B17957253
"RTN","PXRMTDLG",1,0)
PXRMTDLG ;SLC/PJH - Edit/Inquire Taxonomy Dialog ;04/04/2003
"RTN","PXRMTDLG",2,0)
 ;;1.5;CLINICAL REMINDERS;**2,18**;Jun 19, 2000
"RTN","PXRMTDLG",3,0)
 ;
"RTN","PXRMTDLG",4,0)
 ;Called by option PXRM TAXONOMY DIALOG
"RTN","PXRMTDLG",5,0)
 ;
"RTN","PXRMTDLG",6,0)
START N DIC,PXRMGTYP,PXRMHD,PXRMTIEN,Y
"RTN","PXRMTDLG",7,0)
SELECT ;General selection
"RTN","PXRMTDLG",8,0)
 S PXRMHD="Taxonomy Dialog",PXRMGTYP="DTAX",PXRMTIEN=""
"RTN","PXRMTDLG",9,0)
 D START^PXRMSEL(PXRMHD,PXRMGTYP,"PXRMTIEN")
"RTN","PXRMTDLG",10,0)
 ;Should return a value
"RTN","PXRMTDLG",11,0)
 I PXRMTIEN D  G SELECT
"RTN","PXRMTDLG",12,0)
 .S PXRMHD="TAXONOMY NAME:"
"RTN","PXRMTDLG",13,0)
 .;Listman option
"RTN","PXRMTDLG",14,0)
 .D START^PXRMGEN(PXRMHD,PXRMGTYP,PXRMTIEN)
"RTN","PXRMTDLG",15,0)
 ;
"RTN","PXRMTDLG",16,0)
END Q
"RTN","PXRMTDLG",17,0)
 ;
"RTN","PXRMTDLG",18,0)
 ;List all Taxonomy Dialogs (for protocol PXRM SELECTION LIST)
"RTN","PXRMTDLG",19,0)
 ;-------------------------
"RTN","PXRMTDLG",20,0)
ALL N BY,DC,DHD,DIC,FLDS,FR,L,LOGIC,NOW,TO,Y
"RTN","PXRMTDLG",21,0)
 S Y=1
"RTN","PXRMTDLG",22,0)
 D SET
"RTN","PXRMTDLG",23,0)
 S DIC="^PXD(811.2,"
"RTN","PXRMTDLG",24,0)
 S BY=".01"
"RTN","PXRMTDLG",25,0)
 S FR=""
"RTN","PXRMTDLG",26,0)
 S TO=""
"RTN","PXRMTDLG",27,0)
 S DHD="W ?0 D HED^PXRMTDLG"
"RTN","PXRMTDLG",28,0)
 D DISP
"RTN","PXRMTDLG",29,0)
 Q
"RTN","PXRMTDLG",30,0)
 ;
"RTN","PXRMTDLG",31,0)
 ;Inquire/Print Option (for protocol PXRM GENERAL INQUIRE/PRINT)
"RTN","PXRMTDLG",32,0)
 ;--------------------
"RTN","PXRMTDLG",33,0)
INQ(Y) N BY,DC,DHD,DIC,FLDS,FR,L,LOGIC,NOW,TO
"RTN","PXRMTDLG",34,0)
 S DIC="^PXD(811.2,"
"RTN","PXRMTDLG",35,0)
 S DIC(0)="AEMQ"
"RTN","PXRMTDLG",36,0)
 D SET
"RTN","PXRMTDLG",37,0)
 D DISP
"RTN","PXRMTDLG",38,0)
 Q
"RTN","PXRMTDLG",39,0)
 ;
"RTN","PXRMTDLG",40,0)
 ;Display Header (see DHD variable)
"RTN","PXRMTDLG",41,0)
 ;--------------
"RTN","PXRMTDLG",42,0)
HED N TEMP,TEXTLEN,TEXTHED,TEXTUND
"RTN","PXRMTDLG",43,0)
 S TEXTHED="TAXONOMY DIALOG LIST"
"RTN","PXRMTDLG",44,0)
 S TEXTUND=$TR($J("",IOM)," ","-")
"RTN","PXRMTDLG",45,0)
 S TEMP=NOW_"  Page "_DC
"RTN","PXRMTDLG",46,0)
 S TEXTLEN=$L(TEMP)
"RTN","PXRMTDLG",47,0)
 W TEXTHED
"RTN","PXRMTDLG",48,0)
 W ?(IOM-TEXTLEN),TEMP
"RTN","PXRMTDLG",49,0)
 W !,TEXTUND,!!
"RTN","PXRMTDLG",50,0)
 Q
"RTN","PXRMTDLG",51,0)
 ;
"RTN","PXRMTDLG",52,0)
 ;DISPLAY (Display from FLDS array)
"RTN","PXRMTDLG",53,0)
 ;-------
"RTN","PXRMTDLG",54,0)
DISP S L=0,FLDS="[PXRM TAXONOMY DIALOG]"
"RTN","PXRMTDLG",55,0)
 D EN1^DIP
"RTN","PXRMTDLG",56,0)
 Q
"RTN","PXRMTDLG",57,0)
 ;
"RTN","PXRMTDLG",58,0)
SET ;Setup all the variables
"RTN","PXRMTDLG",59,0)
 ; Set Date for Header
"RTN","PXRMTDLG",60,0)
 S NOW=$$NOW^XLFDT
"RTN","PXRMTDLG",61,0)
 S NOW=$$FMTE^XLFDT(NOW,"1P")
"RTN","PXRMTDLG",62,0)
 ;
"RTN","PXRMTDLG",63,0)
 ;These variables need to be setup every time because DIP kills them.
"RTN","PXRMTDLG",64,0)
 S BY="NUMBER"
"RTN","PXRMTDLG",65,0)
 S (FR,TO)=+$P(Y,U,1)
"RTN","PXRMTDLG",66,0)
 S DHD="W ?0 D HED^PXRMTDLG"
"RTN","PXRMTDLG",67,0)
 ;
"RTN","PXRMTDLG",68,0)
 Q
"RTN","PXRMTDLG",69,0)
 ;
"RTN","PXRMTDLG",70,0)
 ;Build display for selected taxonomy - Called from PXRMGEN
"RTN","PXRMTDLG",71,0)
 ;---------------------------------------------------------
"RTN","PXRMTDLG",72,0)
DTAX(TIEN) ;
"RTN","PXRMTDLG",73,0)
 ;If dialog selectable codes don't exist build them
"RTN","PXRMTDLG",74,0)
 I ('$D(^PXD(811.2,TIEN,"SDX")))&('$D(^PXD(811.2,TIEN,"SPR"))) D
"RTN","PXRMTDLG",75,0)
 .D BUILD^PXRMTDUP(TIEN)
"RTN","PXRMTDLG",76,0)
 ;
"RTN","PXRMTDLG",77,0)
 N ARRAY,CNT,SEQ,TSEQ
"RTN","PXRMTDLG",78,0)
 S VALMCNT=0 K ^TMP("PXRMGEN",$J)
"RTN","PXRMTDLG",79,0)
 ;Format headings to include taxonomy name
"RTN","PXRMTDLG",80,0)
 S HEADER=PXRMHD_" "_$P(^PXD(811.2,TIEN,0),U)
"RTN","PXRMTDLG",81,0)
 ;Get associated codes
"RTN","PXRMTDLG",82,0)
 D TAX^PXRMDLL(TIEN,.ARRAY)
"RTN","PXRMTDLG",83,0)
 ;Taxonomy header
"RTN","PXRMTDLG",84,0)
 S SEQ=1,TSEQ=$J(SEQ,3)_"  "
"RTN","PXRMTDLG",85,0)
 S CNT=0,VALMCNT=VALMCNT+1
"RTN","PXRMTDLG",86,0)
 S ^TMP("PXRMGEN",$J,VALMCNT,0)=TSEQ_$J("",15-$L(TSEQ))_ARRAY
"RTN","PXRMTDLG",87,0)
 ;Dialog and Procedure entries
"RTN","PXRMTDLG",88,0)
 F  S CNT=$O(ARRAY(CNT)) Q:CNT=""  D
"RTN","PXRMTDLG",89,0)
 .S TSEQ=$J(SEQ,3)_"."_CNT
"RTN","PXRMTDLG",90,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMTDLG",91,0)
 .S ^TMP("PXRMGEN",$J,VALMCNT,0)=TSEQ_$J("",15-$L(TSEQ))_$P(ARRAY(CNT),U)
"RTN","PXRMTDLG",92,0)
 .D CODES($P(ARRAY(CNT),U,2),TIEN)
"RTN","PXRMTDLG",93,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMTDLG",94,0)
 .S ^TMP("PXRMGEN",$J,VALMCNT,0)=$J("",79)
"RTN","PXRMTDLG",95,0)
 ;Create headings
"RTN","PXRMTDLG",96,0)
 D CHGCAP^VALM("HEADER1","Taxonomy Dialog")
"RTN","PXRMTDLG",97,0)
 D CHGCAP^VALM("HEADER2","")
"RTN","PXRMTDLG",98,0)
 D CHGCAP^VALM("HEADER3","")
"RTN","PXRMTDLG",99,0)
 Q
"RTN","PXRMTDLG",100,0)
 ;
"RTN","PXRMTDLG",101,0)
 ;Selectable codes
"RTN","PXRMTDLG",102,0)
 ;----------------
"RTN","PXRMTDLG",103,0)
CODES(FILE,TIEN) ;
"RTN","PXRMTDLG",104,0)
 N BDATE,CODES,CODE,DATES,DESC,DTEXT,EDATE,STR,SUB,TAB,TEXT
"RTN","PXRMTDLG",105,0)
 ;Display text
"RTN","PXRMTDLG",106,0)
 S TEXT=$J("",15)_"Selectable codes:",TAB=18
"RTN","PXRMTDLG",107,0)
 S STR=$$LJ^XLFSTR($G(TEXT),60)
"RTN","PXRMTDLG",108,0)
 S STR=STR_"Activation Periods"
"RTN","PXRMTDLG",109,0)
 S VALMCNT=VALMCNT+1
"RTN","PXRMTDLG",110,0)
 S ^TMP("PXRMGEN",$J,VALMCNT,0)=STR
"RTN","PXRMTDLG",111,0)
 ;Get array
"RTN","PXRMTDLG",112,0)
 D CODES^PXRMDLLB(FILE,TIEN,.CODES)
"RTN","PXRMTDLG",113,0)
 ;Move results into workfile
"RTN","PXRMTDLG",114,0)
 S SUB=""
"RTN","PXRMTDLG",115,0)
 F  S SUB=$O(CODES(SUB)) Q:SUB=""  D
"RTN","PXRMTDLG",116,0)
 .S CODE=$P(CODES(SUB),U,2),DESC=$P(CODES(SUB),U,3)
"RTN","PXRMTDLG",117,0)
 .S BDATE=$$FMTE^XLFDT($P($G(CODE),":",2))
"RTN","PXRMTDLG",118,0)
 .I $P($G(CODE),":",3)'="" S EDATE=$$FMTE^XLFDT($P($G(CODE),":",3))
"RTN","PXRMTDLG",119,0)
 .S DATE=BDATE I $G(EDATE)'="" S DATE=DATE_"-"_EDATE
"RTN","PXRMTDLG",120,0)
 .S STR=$$LJ^XLFSTR($P($G(CODE),":"),8)
"RTN","PXRMTDLG",121,0)
 .S STR=STR_$$LJ^XLFSTR(DESC,31)
"RTN","PXRMTDLG",122,0)
 .S DTEXT=STR_DATE
"RTN","PXRMTDLG",123,0)
 .S VALMCNT=VALMCNT+1
"RTN","PXRMTDLG",124,0)
 .S ^TMP("PXRMGEN",$J,VALMCNT,0)=$J("",15)_DTEXT
"RTN","PXRMTDLG",125,0)
 Q
"RTN","PXRMTDLG",126,0)
 ;
"RTN","PXRMTDLG",127,0)
 ;Display selectable codes - called from print template
"RTN","PXRMTDLG",128,0)
 ;-----------------------------------------------------
"RTN","PXRMTDLG",129,0)
TDES(FILE,D0,D1) ;
"RTN","PXRMTDLG",130,0)
 N CNT,CODE,DATA,IEN,TEXT,NODE
"RTN","PXRMTDLG",131,0)
 S NODE=$S(FILE=80:"SDX",FILE=81:"SPR")
"RTN","PXRMTDLG",132,0)
 S DATA=$G(^PXD(811.2,D0,NODE,D1,0)) Q:DATA=""
"RTN","PXRMTDLG",133,0)
 ;Get ien of code
"RTN","PXRMTDLG",134,0)
 S IEN=$P(DATA,U) Q:IEN=""
"RTN","PXRMTDLG",135,0)
 ;Translate ien to code
"RTN","PXRMTDLG",136,0)
 I FILE=80 S CODE=$P($G(^ICD9(IEN,0)),U)
"RTN","PXRMTDLG",137,0)
 I FILE=81 S CODE=$P($$CPT^ICPTCOD(IEN),U,2)
"RTN","PXRMTDLG",138,0)
 ;Set display text from taxonomy selectable code text
"RTN","PXRMTDLG",139,0)
 S TEXT=$P(DATA,U,2)
"RTN","PXRMTDLG",140,0)
 ;otherwise use icd9/cpt description
"RTN","PXRMTDLG",141,0)
 I TEXT="",FILE=80 S TEXT=$G(^ICD9(IEN,1))
"RTN","PXRMTDLG",142,0)
 I TEXT="",FILE=80 S TEXT=$P($G(^ICD9(IEN,0)),U,3)
"RTN","PXRMTDLG",143,0)
 I TEXT="",FILE=81 S TEXT=$P($$CPT^ICPTCOD(IEN),U,3)
"RTN","PXRMTDLG",144,0)
 S TEXT=" "_$E(TEXT,1,40)_$J("",40-$L(TEXT))
"RTN","PXRMTDLG",145,0)
 W $J(CODE,10)_TEXT
"RTN","PXRMTDLG",146,0)
 Q
"RTN","PXRMTDUP")
0^14^B809193
"RTN","PXRMTDUP",1,0)
PXRMTDUP ;SLC/PKR - Update Taxonomy Dialog Selectable codes.;04/04/2003
"RTN","PXRMTDUP",2,0)
 ;;1.5;CLINICAL REMINDERS;**2,18**;Jun 19, 2000
"RTN","PXRMTDUP",3,0)
 ;
"RTN","PXRMTDUP",4,0)
 ;=======================================================================
"RTN","PXRMTDUP",5,0)
BUILD(TIEN) ;Build the list of selectable codes for one taxonomy
"RTN","PXRMTDUP",6,0)
 N DATEBLT,FILE,NODE,PTR,TEMP
"RTN","PXRMTDUP",7,0)
 S TEMP=$G(^PXD(811.3,TIEN,0))
"RTN","PXRMTDUP",8,0)
 S DATEBLT=$P(TEMP,U,2)
"RTN","PXRMTDUP",9,0)
 ;Make sure the expansion exists.
"RTN","PXRMTDUP",10,0)
 I DATEBLT="" D EXPAND^PXRMBXTL(TIEN,"")
"RTN","PXRMTDUP",11,0)
 ;
"RTN","PXRMTDUP",12,0)
 ;Copy the expansion into the selectable lists.
"RTN","PXRMTDUP",13,0)
 F FILE=80,81 D
"RTN","PXRMTDUP",14,0)
 . S NODE=$S(FILE=80:"SDX",FILE=81:"SPR")
"RTN","PXRMTDUP",15,0)
 . S PTR=$S(FILE=80:"ICD9P",FILE=81:"ICPTP")
"RTN","PXRMTDUP",16,0)
 . K ^PXD(811.2,TIEN,NODE)
"RTN","PXRMTDUP",17,0)
 . M ^PXD(811.2,TIEN,NODE)=^PXD(811.3,TIEN,FILE)
"RTN","PXRMTDUP",18,0)
 . M ^PXD(811.2,TIEN,NODE,"B")=^PXD(811.3,TIEN,FILE,PTR)
"RTN","PXRMTDUP",19,0)
 . K ^PXD(811.2,TIEN,NODE,PTR)
"RTN","PXRMTDUP",20,0)
 Q
"RTN","PXRMTDUP",21,0)
 ;
"RTN","PXRMTEDT")
0^15^B4054028
"RTN","PXRMTEDT",1,0)
PXRMTEDT ;SLC/PKR - Edit a taxonomy item. ;04/29/2003
"RTN","PXRMTEDT",2,0)
 ;;1.5;CLINICAL REMINDERS;**2,5,18**;Jun 19, 2000
"RTN","PXRMTEDT",3,0)
 ;
"RTN","PXRMTEDT",4,0)
 ;=======================================================================
"RTN","PXRMTEDT",5,0)
 N CS1,CS2,DA,DIC,DLAYGO,DTOUT,DUOUT,Y
"RTN","PXRMTEDT",6,0)
GETNAME ;Get the name of the reminder taxonomy to edit.
"RTN","PXRMTEDT",7,0)
 K DA,DIC,DLAYGO,DTOUT,DUOUT,Y
"RTN","PXRMTEDT",8,0)
 S DIC="^PXD(811.2,"
"RTN","PXRMTEDT",9,0)
 S DIC(0)="AEMQL"
"RTN","PXRMTEDT",10,0)
 S DIC("A")="Select Reminder Taxonomy: "
"RTN","PXRMTEDT",11,0)
 S DIC("S")="I $$VEDIT^PXRMUTIL(DIC,Y)"
"RTN","PXRMTEDT",12,0)
 S DLAYGO=811.2
"RTN","PXRMTEDT",13,0)
 ;Set the starting place for additions.
"RTN","PXRMTEDT",14,0)
 D SETSTART^PXRMCOPY(DIC)
"RTN","PXRMTEDT",15,0)
 W !
"RTN","PXRMTEDT",16,0)
 D ^DIC
"RTN","PXRMTEDT",17,0)
 I ($D(DTOUT))!($D(DUOUT)) Q
"RTN","PXRMTEDT",18,0)
 I Y=-1 G END
"RTN","PXRMTEDT",19,0)
 S DA=$P(Y,U,1)
"RTN","PXRMTEDT",20,0)
 S CS1=$$FILE^PXRMEXCS(811.2,DA)
"RTN","PXRMTEDT",21,0)
 D EDIT(DIC,DA)
"RTN","PXRMTEDT",22,0)
 ;See if any changes have been made, if so do the edit history.
"RTN","PXRMTEDT",23,0)
 S CS2=$$FILE^PXRMEXCS(811.2,DA)
"RTN","PXRMTEDT",24,0)
 I CS2'=0,CS2'=CS1 D SEHIST^PXRMUTIL(811.2,DIC,DA)
"RTN","PXRMTEDT",25,0)
 G GETNAME
"RTN","PXRMTEDT",26,0)
END ;
"RTN","PXRMTEDT",27,0)
 Q
"RTN","PXRMTEDT",28,0)
 ;
"RTN","PXRMTEDT",29,0)
 ;=======================================================================
"RTN","PXRMTEDT",30,0)
EDIT(ROOT,DA) ;
"RTN","PXRMTEDT",31,0)
 N DIE,DR,DIDEL,RESULT
"RTN","PXRMTEDT",32,0)
 S DIE=ROOT,DIDEL=811.2
"RTN","PXRMTEDT",33,0)
 W !!,"General Taxonomy Data"
"RTN","PXRMTEDT",34,0)
 S DR=".01"
"RTN","PXRMTEDT",35,0)
 D ^DIE
"RTN","PXRMTEDT",36,0)
 ;If DA is undefined then the entry was deleted.
"RTN","PXRMTEDT",37,0)
 I '$D(DA) Q
"RTN","PXRMTEDT",38,0)
 I $D(Y) Q
"RTN","PXRMTEDT",39,0)
 ;
"RTN","PXRMTEDT",40,0)
 S DR=".02"
"RTN","PXRMTEDT",41,0)
 D ^DIE
"RTN","PXRMTEDT",42,0)
 I '$D(DA) Q
"RTN","PXRMTEDT",43,0)
 I $D(Y) Q
"RTN","PXRMTEDT",44,0)
 ;
"RTN","PXRMTEDT",45,0)
CLASS ;
"RTN","PXRMTEDT",46,0)
 ;Class
"RTN","PXRMTEDT",47,0)
 W !!
"RTN","PXRMTEDT",48,0)
 S DR="100"
"RTN","PXRMTEDT",49,0)
 D ^DIE
"RTN","PXRMTEDT",50,0)
 I $D(Y) Q
"RTN","PXRMTEDT",51,0)
 ;Sponsor
"RTN","PXRMTEDT",52,0)
 S DR="101"
"RTN","PXRMTEDT",53,0)
 D ^DIE
"RTN","PXRMTEDT",54,0)
 I $D(Y) Q
"RTN","PXRMTEDT",55,0)
 ;Make sure Class and Sponsor Class are in synch.
"RTN","PXRMTEDT",56,0)
 S RESULT=$$VSPONSOR^PXRMINTR(X)
"RTN","PXRMTEDT",57,0)
 I RESULT=0 G CLASS
"RTN","PXRMTEDT",58,0)
 ;Review date
"RTN","PXRMTEDT",59,0)
 W !!
"RTN","PXRMTEDT",60,0)
 S DR="102"
"RTN","PXRMTEDT",61,0)
 D ^DIE
"RTN","PXRMTEDT",62,0)
 I $D(Y) Q
"RTN","PXRMTEDT",63,0)
 ;
"RTN","PXRMTEDT",64,0)
 W !!
"RTN","PXRMTEDT",65,0)
 S DR="4"
"RTN","PXRMTEDT",66,0)
 D ^DIE
"RTN","PXRMTEDT",67,0)
 I '$D(DA) Q
"RTN","PXRMTEDT",68,0)
 I $D(Y) Q
"RTN","PXRMTEDT",69,0)
 ;
"RTN","PXRMTEDT",70,0)
 S DR="10"
"RTN","PXRMTEDT",71,0)
 D ^DIE
"RTN","PXRMTEDT",72,0)
 I '$D(DA) Q
"RTN","PXRMTEDT",73,0)
 I $D(Y) Q
"RTN","PXRMTEDT",74,0)
 ;
"RTN","PXRMTEDT",75,0)
 S DR="1.6"
"RTN","PXRMTEDT",76,0)
 D ^DIE
"RTN","PXRMTEDT",77,0)
 I '$D(DA) Q
"RTN","PXRMTEDT",78,0)
 I $D(Y) Q
"RTN","PXRMTEDT",79,0)
 ;
"RTN","PXRMTEDT",80,0)
 W !!,"ICD0 Range of Coded Values"
"RTN","PXRMTEDT",81,0)
 S DR="2103"
"RTN","PXRMTEDT",82,0)
 S DR(2,811.22103)=".01;1"
"RTN","PXRMTEDT",83,0)
 D ^DIE
"RTN","PXRMTEDT",84,0)
 I $D(Y) Q
"RTN","PXRMTEDT",85,0)
 ;
"RTN","PXRMTEDT",86,0)
 W !!,"ICD9 Range of Coded Values"
"RTN","PXRMTEDT",87,0)
 S DR="2102"
"RTN","PXRMTEDT",88,0)
 S DR(2,811.22102)=".01;1"
"RTN","PXRMTEDT",89,0)
 D ^DIE
"RTN","PXRMTEDT",90,0)
 I $D(Y) Q
"RTN","PXRMTEDT",91,0)
 ;
"RTN","PXRMTEDT",92,0)
 W !!,"CPT Range of Coded Values"
"RTN","PXRMTEDT",93,0)
 S DR="2104"
"RTN","PXRMTEDT",94,0)
 S DR(2,811.22104)=".01;1"
"RTN","PXRMTEDT",95,0)
 D ^DIE
"RTN","PXRMTEDT",96,0)
 I $D(Y) Q
"RTN","PXRMTEDT",97,0)
 Q
"RTN","PXRMTEDT",98,0)
 ;
"RTN","PXRMVALC")
0^3^B67226271
"RTN","PXRMVALC",1,0)
PXRMVALC ; SLC/KR Validate Codes (format/value)    ;4/8/03  13:19
"RTN","PXRMVALC",2,0)
 ;;1.5;CLINICAL REMINDERS;**18**;Jun 19, 2000
"RTN","PXRMVALC",3,0)
 Q
"RTN","PXRMVALC",4,0)
 ;   
"RTN","PXRMVALC",5,0)
 ; Entry points (extrinsic functions)
"RTN","PXRMVALC",6,0)
 ;   
"RTN","PXRMVALC",7,0)
 ;     ICD^PXRMVALC(<code>)   Validate ICD-9-CM Diagnosis Code
"RTN","PXRMVALC",8,0)
 ;     ICP^PXRMVALC(<code>)   Validate ICD-9-CM Procedure Code
"RTN","PXRMVALC",9,0)
 ;     CPT^PXRMVALC(<code>)   Validate CPT-4 Procedure Code
"RTN","PXRMVALC",10,0)
 ;   
"RTN","PXRMVALC",11,0)
 ;  All entry points return:
"RTN","PXRMVALC",12,0)
 ;  
"RTN","PXRMVALC",13,0)
 ;    <validity>^<input>^<output>^<error>^<file #>^<global root>^
"RTN","PXRMVALC",14,0)
 ;    <type of code>^<input IEN>^<input flag>^<output IEN>^
"RTN","PXRMVALC",15,0)
 ;    <output flag>^<description>
"RTN","PXRMVALC",16,0)
 ;   
"RTN","PXRMVALC",17,0)
ICD(X) ; Validate ICD-9-CM Diagnosis Code from file 80
"RTN","PXRMVALC",18,0)
 S X=$G(X),U="^" N CHR,CHKD,CIN,CODE,COUT,DIC,ERR,ES,EXP,FNUM,FORM,IENI,IENO,IFIN,IFOUT,NAME,NUMERIC,PAT,TY,VAL,Y
"RTN","PXRMVALC",19,0)
 S VAL=1,FNUM=80,DIC="ICD9(",(IFIN,IFOUT,NAME)="",CIN=$TR(X,"""",""),U="^"
"RTN","PXRMVALC",20,0)
 S FORM=$S($E(X,1)="E":2,$E(X,1)="V":3,$E(X,1)?1N:1,1:1),TY=$S(FORM=2:"ICD ""E"" code",FORM=3:"ICD ""V"" code",FORM=1:"ICD code",1:"ICD code")
"RTN","PXRMVALC",21,0)
 S ERR="Valid "_TY,CHKD=$S(FORM=2:"ICD-9-CM ""E"" external cause code",FORM=3:"ICD-9-CM ""V"" health factor code",FORM=1:"ICD-9-CM diagnosis code",1:"ICD-9-CM code")
"RTN","PXRMVALC",22,0)
 S PAT=$S(FORM=2:"ENNN.nn",FORM=3:"VNN.nn",FORM=1:"NNN.nn",1:"ENNN.nn, VNN.nn or NNN.nn")
"RTN","PXRMVALC",23,0)
 ; Code transformation
"RTN","PXRMVALC",24,0)
 S CODE=X S:CODE'["." CODE=CODE_"."
"RTN","PXRMVALC",25,0)
 S:FORM=1&($L($P(CODE,".",1))=1)&(+($P(CODE,".",1))>0) $P(CODE,".",1)="00"_$P(CODE,".",1) S:FORM=1&($L($P(CODE,".",1))=2)&(+($P(CODE,".",1))>0) $P(CODE,".",1)="0"_$P(CODE,".",1) S X=CODE
"RTN","PXRMVALC",26,0)
 S CODE=$P(CODE,".",1,2),CODE=$$NEXT^PXRMVALU(CODE,80),COUT=CODE,(IENI,IENO)=""
"RTN","PXRMVALC",27,0)
 I +$$CODEN^ICDCODE(COUT,80)>0 D
"RTN","PXRMVALC",28,0)
 .N ICD9,IFOUTX
"RTN","PXRMVALC",29,0)
 .S IENO=+$$CODEN^ICDCODE(COUT,80)
"RTN","PXRMVALC",30,0)
 .S ICD9=$$ICDDX^ICDCODE(+IENO)
"RTN","PXRMVALC",31,0)
 .S NAME=$P(ICD9,U,4)
"RTN","PXRMVALC",32,0)
 .S IFOUTX=$P(ICD9,U,10),IFOUT=$S(IFOUTX=0:1,IFOUTX=1:0,1:"")
"RTN","PXRMVALC",33,0)
 S ES="Invalid "_TY_" format "
"RTN","PXRMVALC",34,0)
 ; Format
"RTN","PXRMVALC",35,0)
 ;    not enough digits
"RTN","PXRMVALC",36,0)
 I $E(CIN,1)="E",$L($P($E(CIN,2,$L(CIN)),".",1))<3 D ERR((ES_"(not enough digits, "_PAT_")")) G AQ
"RTN","PXRMVALC",37,0)
 I $E(CIN,1)?1N,$L($P(CIN,".",1))<3 D ERR((ES_"(not enough digits, "_PAT_")")) G AQ
"RTN","PXRMVALC",38,0)
 I $E(CIN,1)="V",$L($P($E(CIN,2,$L(CIN)),".",1))<2 D ERR((ES_"(not enough digits, "_PAT_")")) G AQ
"RTN","PXRMVALC",39,0)
 ;    too many digits
"RTN","PXRMVALC",40,0)
 I $E(CIN,1)="E",$L($P($E(CIN,2,$L(CIN)),".",1))>3 D ERR((ES_"(too many digits, "_PAT_")")) G AQ
"RTN","PXRMVALC",41,0)
 I $E(CIN,1)?1N,$L($P(CIN,".",1))>3 D ERR((ES_"(too many digits, "_PAT_")")) G AQ
"RTN","PXRMVALC",42,0)
 I $E(CIN,1)="V",$L($P($E(CIN,2,$L(CIN)),".",1))>2 D ERR((ES_"(too many digits, "_PAT_")")) G AQ
"RTN","PXRMVALC",43,0)
 ;    missing decimal point
"RTN","PXRMVALC",44,0)
 I CIN'["." D ERR((ES_"(missing decimal point "_PAT_")")) G AQ
"RTN","PXRMVALC",45,0)
 ;    to many decimal points
"RTN","PXRMVALC",46,0)
 I $L(CIN,".")>2 D ERR((ES_"(too many decimal points "_PAT_")")) G AQ
"RTN","PXRMVALC",47,0)
 ;    to many decimal places
"RTN","PXRMVALC",48,0)
 I $L($P(CIN,".",2))>2 D ERR((ES_"(too many decimals places, "_PAT_")")) G AQ
"RTN","PXRMVALC",49,0)
 ;    non-numeric decimal
"RTN","PXRMVALC",50,0)
 I $P(CIN,".",2)'?2N&($P(CIN,".",2)'?1N)&($P(CIN,".",2)'="") D ERR((ES_"(non-numeric decimal, "_PAT_")")) G AQ
"RTN","PXRMVALC",51,0)
 ;    invalid pattern
"RTN","PXRMVALC",52,0)
 I $E(CIN,1)="E",$P(CIN,".",1)'?1U3N D ERR((ES_"("_PAT_")")) G AQ
"RTN","PXRMVALC",53,0)
 I $E(CIN,1)="V",$P(CIN,".",1)'?1U2N D ERR((ES_"("_PAT_")")) G AQ
"RTN","PXRMVALC",54,0)
 I $E(CIN,1)?1N,$P(CIN,".",1)'?3N D ERR((ES_"("_PAT_")")) G AQ
"RTN","PXRMVALC",55,0)
 ; Value
"RTN","PXRMVALC",56,0)
 ;    not found
"RTN","PXRMVALC",57,0)
 I +$$CODEN^ICDCODE(CIN,80)<0 D  G AQ
"RTN","PXRMVALC",58,0)
 . N TC D ERR((TY_" not found in the ICD-9 file (#80)"))
"RTN","PXRMVALC",59,0)
 . S TC=COUT S:'$L(TC) TC=CIN I $E(TC,$L(TC))="0" D
"RTN","PXRMVALC",60,0)
 . . N SC,COUT S (SC,COUT)=TC F  S TC=$E(TC,1,($L(TC)-1)) S:+$$CODEN^ICDCODE(TC,80)>0 SC=TC Q:$E(TC,$L(TC))'="0"!(SC'=COUT)  Q:TC=""
"RTN","PXRMVALC",61,0)
 . . S TC="" S:SC'=COUT TC=SC
"RTN","PXRMVALC",62,0)
 . S:$L(TC) COUT=TC
"RTN","PXRMVALC",63,0)
 . S:+$$CODEN^ICDCODE(CIN_"0")>0 COUT=CIN_"0"
"RTN","PXRMVALC",64,0)
 . I +$$CODEN^ICDCODE(COUT,80)>0 D
"RTN","PXRMVALC",65,0)
 . . N ICD9,IFOUTX
"RTN","PXRMVALC",66,0)
 . . S IENO=+$$CODEN^ICDCODE(COUT,80)
"RTN","PXRMVALC",67,0)
 . . S ICD9=$$ICDDX^ICDCODE(+IENO)
"RTN","PXRMVALC",68,0)
 . . S NAME=$P(ICD9,U,4)
"RTN","PXRMVALC",69,0)
 . . S IFOUTX=$P(ICD9,U,10),IFOUT=$S(IFOUTX=0:1,IFOUTX=1:0,1:"")
"RTN","PXRMVALC",70,0)
 ;    found
"RTN","PXRMVALC",71,0)
 I $$CODEN^ICDCODE(CIN,80)>0 D  G AQ
"RTN","PXRMVALC",72,0)
 . D ERR(("Valid "_TY)) S VAL=1
"RTN","PXRMVALC",73,0)
 . S IENI=+$$CODEN^ICDCODE(CIN,80)
"RTN","PXRMVALC",74,0)
 . N ICD9,IFINX
"RTN","PXRMVALC",75,0)
 . S ICD9=$$ICDDX^ICDCODE(IENI)
"RTN","PXRMVALC",76,0)
 . S NAME=$P(ICD9,U,4)
"RTN","PXRMVALC",77,0)
 . S IFINX=$P(ICD9,U,10),IFIN=$S(IFINX=0:1,IFINX=1:0,1:"")
"RTN","PXRMVALC",78,0)
 . S:(+(IFOUT)+(IFIN))>0 ERR="Inactive "_TY
"RTN","PXRMVALC",79,0)
 G AQ
"RTN","PXRMVALC",80,0)
 ;   
"RTN","PXRMVALC",81,0)
ICP(X) ; Validate ICD-9-CM Procedure Code from file 80.1
"RTN","PXRMVALC",82,0)
 S X=$G(X),U="^" N CHR,CHKD,CIN,CODE,COUT,DIC,ERR,ES,EXP,FNUM,FORM,IENI,IENO,IFIN,IFOUT,NAME,NUMERIC,PAT,TY,VAL,Y
"RTN","PXRMVALC",83,0)
 S FNUM=80.1,DIC="ICD0(",VAL=1,(NAME,IFIN,IFOUT)="",CIN=$TR(X,"""","")
"RTN","PXRMVALC",84,0)
 ; Code transformation
"RTN","PXRMVALC",85,0)
 S CODE=X,TY="ICD Procedure code",PAT="NN.nn",CHKD=TY S:CODE'["." CODE=CODE_"." S:$L($P(CODE,".",1))=1 CODE="0"_CODE S CODE=$$NEXT^PXRMVALU(CODE,80.1),COUT=CODE
"RTN","PXRMVALC",86,0)
 S VAL=1,ERR="Valid "_TY
"RTN","PXRMVALC",87,0)
 I +$$CODEN^ICDCODE(CODE,80.1)>0 D
"RTN","PXRMVALC",88,0)
 .S IENO=+$$CODEN^ICDCODE(CODE,80.1)
"RTN","PXRMVALC",89,0)
 .N ICDO,IFOUTX
"RTN","PXRMVALC",90,0)
 .S ICDO=$$ICDOP^ICDCODE(+IENO)
"RTN","PXRMVALC",91,0)
 .S NAME=$P(ICDO,"^",5)
"RTN","PXRMVALC",92,0)
 .S IFOUTX=$P(ICDO,U,10),IFOUT=$S(IFOUTX=0:1,IFOUTX=1:"",1:"")
"RTN","PXRMVALC",93,0)
 S ES="Invalid "_TY_" format "
"RTN","PXRMVALC",94,0)
 ; Format
"RTN","PXRMVALC",95,0)
 ;    not enough digits
"RTN","PXRMVALC",96,0)
 I $L($P(CIN,".",1))<2 D ERR((ES_"(not enough digits, "_PAT_")")) G AQ
"RTN","PXRMVALC",97,0)
 ;    too many digits
"RTN","PXRMVALC",98,0)
 I $L($P(CIN,".",1))>2 D ERR((ES_"(too many digits, "_PAT_")")) G AQ
"RTN","PXRMVALC",99,0)
 ;    missing decimal point
"RTN","PXRMVALC",100,0)
 I CIN'["." D ERR((ES_"(missing decimal point "_PAT_")")) G AQ
"RTN","PXRMVALC",101,0)
 ;    too many decimal points
"RTN","PXRMVALC",102,0)
 I $L(CIN,".")>2 D ERR((ES_"(too many decimal points "_PAT_")")) G AQ
"RTN","PXRMVALC",103,0)
 ;    too many decimal places
"RTN","PXRMVALC",104,0)
 I $L($P(CIN,".",2))>2 D ERR((ES_"(too many decimals places, "_PAT_")")) G AQ
"RTN","PXRMVALC",105,0)
 ;    non-numeric decimal
"RTN","PXRMVALC",106,0)
 I $P(CIN,".",2)'?2N&($P(CIN,".",2)'?1N)&($P(CIN,".",2)'="") D ERR((ES_"(non-numeric decimal, "_PAT_")")) G AQ
"RTN","PXRMVALC",107,0)
 ;    invalid pattern
"RTN","PXRMVALC",108,0)
 I $P(CIN,".",1)'?2N D ERR((ES_"("_PAT_")")) G AQ
"RTN","PXRMVALC",109,0)
 ; Value
"RTN","PXRMVALC",110,0)
 ;    not found
"RTN","PXRMVALC",111,0)
 I +$$CODEN^ICDCODE(CIN,80.1)<0 D  G AQ
"RTN","PXRMVALC",112,0)
 . N TC D ERR((TY_" not found in the ICD-9 file (#80.1)")) S COUT=""
"RTN","PXRMVALC",113,0)
 . S TC=COUT S:'$L(TC) TC=CIN I $E(TC,$L(TC))="0" D
"RTN","PXRMVALC",114,0)
 . . N SC,COUT S (SC,COUT)=TC F  S TC=$E(TC,1,($L(TC)-1)) S:+$$CODEN^ICDCODE(TC,80.1)>0 SC=TC Q:$E(TC,$L(TC))'="0"!(SC'=COUT)  Q:TC=""
"RTN","PXRMVALC",115,0)
 . . S TC="" S:SC'=COUT TC=SC
"RTN","PXRMVALC",116,0)
 . S:$L(TC) COUT=TC
"RTN","PXRMVALC",117,0)
 . S:+$$CODEN^ICDCODE(CIN_"0",80.1)>0 COUT=CIN_"0"
"RTN","PXRMVALC",118,0)
 . I +$$CODEN^ICDCODE(COUT,80.1)>0 D
"RTN","PXRMVALC",119,0)
 . . S IENO=+$$CODEN^ICDCODE(COUT,80.1)
"RTN","PXRMVALC",120,0)
 . . N ICDO,IFOUTX
"RTN","PXRMVALC",121,0)
 . . S ICDO=$$ICDOP^ICDCODE(+IENO)
"RTN","PXRMVALC",122,0)
 . . S NAME=$P(ICDO,"^",5)
"RTN","PXRMVALC",123,0)
 . . S IFOUTX=$P(ICDO,U,10),IFOUT=$S(IFOUTX=0:1,IFOUTX=1:"",1:"")
"RTN","PXRMVALC",124,0)
 ;    found
"RTN","PXRMVALC",125,0)
 I $$CODEN^ICDCODE(CIN,80.1)>0 D  G AQ
"RTN","PXRMVALC",126,0)
 . S VAL=1,ERR="Valid "_TY
"RTN","PXRMVALC",127,0)
 . S IENI=+$$CODEN^ICDCODE(CIN,80.1)
"RTN","PXRMVALC",128,0)
 . N ICDO,IFINX
"RTN","PXRMVALC",129,0)
 . S ICDO=$$ICDOP^ICDCODE(+IENI)
"RTN","PXRMVALC",130,0)
 . S NAME=$P(ICDO,"^",5)
"RTN","PXRMVALC",131,0)
 . S IFINX=$P(ICDO,"^",10),IFIN=$S(IFINX=0:1,IFINX=1:"",1:"")
"RTN","PXRMVALC",132,0)
 . S:(+(IFOUT)+(IFIN))>0 ERR="Inactive "_TY
"RTN","PXRMVALC",133,0)
 G AQ
"RTN","PXRMVALC",134,0)
 ;            
"RTN","PXRMVALC",135,0)
CPT(X) ; Validate CPT-4 Procedure Code from file 81
"RTN","PXRMVALC",136,0)
 S X=$G(X),U="^"
"RTN","PXRMVALC",137,0)
 N CHR,CHKD,CIN,CODE,COUT,DIC,ERR,ES,EXP,FNUM,FORM,IENI,IENO,IFIN,IFOUT
"RTN","PXRMVALC",138,0)
 N NAME,NUMERIC,PAT,STATUS,TEMP,TY,VAL,Y
"RTN","PXRMVALC",139,0)
 S VAL=1,FNUM=81,DIC="ICPT(",(IFIN,IFOUT,NAME)="",CIN=$TR(X,"""",""),U="^",FORM=$S($E(X,1)?1N:1,$E(X,1)?1U:2,1:1)
"RTN","PXRMVALC",140,0)
 S TY=$S(FORM=1:"CPT-4 code",FORM=2:"HCPCS code",1:"Procedure code")
"RTN","PXRMVALC",141,0)
 S CHKD=$S(FORM=1:"CPT-4 procedure code",FORM=2:"HCPCS procedure code",1:"CPT-4 procedure code")
"RTN","PXRMVALC",142,0)
 S PAT=$S(FORM=1:"NNNNN",FORM=2:"UNNNN",1:"NNNNN or UNNNN")
"RTN","PXRMVALC",143,0)
 S ES="Invalid "_TY_" format "
"RTN","PXRMVALC",144,0)
 ; Code transformation
"RTN","PXRMVALC",145,0)
 ;    HCPCS
"RTN","PXRMVALC",146,0)
 S CODE=X I FORM=2 D
"RTN","PXRMVALC",147,0)
 . N CHR,NUMERIC S CHR=$E(CODE,1),NUMERIC=$E(CODE,2,$L(CODE))
"RTN","PXRMVALC",148,0)
 . S NUMERIC=$TR(NUMERIC,"~!@#$%^&*()_-+=[{]};:\|,./?<>QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm","0000000000000000000000000000000000000000000000000000000000000000000000000000000000")
"RTN","PXRMVALC",149,0)
 . F  Q:$E(NUMERIC,1)'="0"  S NUMERIC=$E(NUMERIC,2,$L(NUMERIC))
"RTN","PXRMVALC",150,0)
 . S NUMERIC=+NUMERIC F  Q:$L(NUMERIC)>3  S NUMERIC="0"_NUMERIC
"RTN","PXRMVALC",151,0)
 . S CODE=CHR_NUMERIC
"RTN","PXRMVALC",152,0)
 ;    CPT-4
"RTN","PXRMVALC",153,0)
 I FORM=1 D
"RTN","PXRMVALC",154,0)
 . N NUMERIC S NUMERIC=CODE,NUMERIC=$TR(NUMERIC,"~!@#$%^&*()_-+=[{]};:\|,./?<>QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm","0000000000000000000000000000000000000000000000000000000000000000000000000000000000")
"RTN","PXRMVALC",155,0)
 . I +NUMERIC>0,$E(NUMERIC,1)'="0",$L(NUMERIC)<5 F  Q:$L(NUMERIC)=5  S NUMERIC="0"_NUMERIC
"RTN","PXRMVALC",156,0)
 . I +NUMERIC>0,$E(NUMERIC,1)="0",$L(NUMERIC)<5 F  Q:$L(NUMERIC)=5  S NUMERIC=NUMERIC_"0"
"RTN","PXRMVALC",157,0)
 . F  Q:$E(NUMERIC,1)'="0"  S NUMERIC=$E(NUMERIC,2,$L(NUMERIC))
"RTN","PXRMVALC",158,0)
 . S NUMERIC=+NUMERIC F  Q:$L(NUMERIC)>4  S NUMERIC="0"_NUMERIC
"RTN","PXRMVALC",159,0)
 . S CODE=NUMERIC
"RTN","PXRMVALC",160,0)
 S CODE=$$NEXT^PXRMVALU(CODE,81),COUT=CODE S (IENI,IENO)=""
"RTN","PXRMVALC",161,0)
 I $L(COUT),+$$CODEN^ICPTCOD(COUT)>0 D
"RTN","PXRMVALC",162,0)
 . S IENO=+$$CODEN^ICPTCOD(COUT)
"RTN","PXRMVALC",163,0)
 . S TEMP=$$CPT^ICPTCOD(IENO)
"RTN","PXRMVALC",164,0)
 . S NAME=$P(TEMP,U,3)
"RTN","PXRMVALC",165,0)
 . S STATUS=$P(TEMP,U,7)
"RTN","PXRMVALC",166,0)
 . S IFOUT=$S(STATUS:"",1:1)
"RTN","PXRMVALC",167,0)
 ; Format
"RTN","PXRMVALC",168,0)
 ;    not enough characters
"RTN","PXRMVALC",169,0)
 I $L(CIN)<5 D ERR((ES_"(not enough characters)")) G AQ
"RTN","PXRMVALC",170,0)
 ;    too many characters
"RTN","PXRMVALC",171,0)
 I $L(CIN)>5 D ERR((ES_"(too many characters)")) G AQ
"RTN","PXRMVALC",172,0)
 ;    invalid pattern
"RTN","PXRMVALC",173,0)
 ;       CPT-4
"RTN","PXRMVALC",174,0)
 I $E(CIN,1)?1N,CIN'?5N D ERR((ES_"("_PAT_")")) G AQ
"RTN","PXRMVALC",175,0)
 ;       HCPCS
"RTN","PXRMVALC",176,0)
 I $E(CIN,1)?1U,CIN'?1U4N D ERR((ES_"("_PAT_")")) G AQ
"RTN","PXRMVALC",177,0)
 I CIN'?5N&(CIN'?1U.4N) D ERR(("Invalid code format (NNNNN or UNNNN)")) G AQ
"RTN","PXRMVALC",178,0)
 ; Value
"RTN","PXRMVALC",179,0)
 ;    not found
"RTN","PXRMVALC",180,0)
 I +$$CODEN^ICPTCOD(CIN)<1 D ERR((TY_" not found in the CPT file (#81)")) S COUT="" G AQ
"RTN","PXRMVALC",181,0)
 ;    found
"RTN","PXRMVALC",182,0)
 I +$$CODEN^ICPTCOD(CIN)>0 D  G AQ
"RTN","PXRMVALC",183,0)
 . S VAL=1,ERR="Valid "_TY
"RTN","PXRMVALC",184,0)
 . S IENI=+$$CODEN^ICPTCOD(CIN)
"RTN","PXRMVALC",185,0)
 . S TEMP=$$CPT^ICPTCOD(IENI)
"RTN","PXRMVALC",186,0)
 . S NAME=$P(TEMP,U,3)
"RTN","PXRMVALC",187,0)
 . S STATUS=$P(TEMP,U,7)
"RTN","PXRMVALC",188,0)
 . S IFIN=$S(STATUS:"",1:1)
"RTN","PXRMVALC",189,0)
 . S:(+(IFOUT)+(IFIN))>0 ERR="Inactive "_TY
"RTN","PXRMVALC",190,0)
 G AQ
"RTN","PXRMVALC",191,0)
AQ ; Assemble output string and quit
"RTN","PXRMVALC",192,0)
 S X=$G(VAL)_U_$G(CIN)_U_$G(COUT)_U_$G(ERR)_U_FNUM
"RTN","PXRMVALC",193,0)
 S X=X_U_DIC_U_$G(CHKD)_U_$G(IENI)_U_$G(IFIN)_U_$G(IENO)_U_$G(IFOUT)_U_$G(NAME)
"RTN","PXRMVALC",194,0)
 F  Q:$E(X,$L(X))'="^"  S X=$E(X,1,($L(X)-1))
"RTN","PXRMVALC",195,0)
 Q X
"RTN","PXRMVALC",196,0)
ERR(X) S VAL=0,ERR=$G(X) Q
"SEC","^DIC",811.2,811.2,0,"AUDIT")
@
"SEC","^DIC",811.2,811.2,0,"DD")
@
"SEC","^DIC",811.2,811.2,0,"DEL")
@
"SEC","^DIC",811.2,811.2,0,"LAYGO")
@
"SEC","^DIC",811.2,811.2,0,"RD")

"SEC","^DIC",811.2,811.2,0,"WR")
@
"VER")
8.0^22.0
"^DD",811.2,811.2,0)
FIELD^^3112^21
"^DD",811.2,811.2,0,"DDA")
N
"^DD",811.2,811.2,0,"DT")
3030325
"^DD",811.2,811.2,0,"ID",.02)
W "   ",$P(^(0),U,2)
"^DD",811.2,811.2,0,"ID",100)
W:$D(^(100)) "   ",@("$P($P($C(59)_$S($D(^DD(811.2,100,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(100),U,1)_"":"",2),$C(59),1)")
"^DD",811.2,811.2,0,"NM","REMINDER TAXONOMY")

"^DD",811.2,811.2,0,"PT",801.41,15)

"^DD",811.2,811.2,0,"PT",810.31,.04)

"^DD",811.2,811.2,0,"PT",810.32,.01)

"^DD",811.2,811.2,0,"PT",811.3,.01)

"^DD",811.2,811.2,0,"PT",811.52,.01)

"^DD",811.2,811.2,0,"PT",811.902,.01)

"^DD",811.2,811.2,0,"VRPK")
PXRM
"^DD",811.2,811.2,.01,0)
NAME^RFX^^0;1^K:$L(X)>35!($L(X)<3)!'(X'?1P.E)!('$$VNAME^PXRMINTR(X,811.2)) X
"^DD",811.2,811.2,.01,1,0)
^.1^^0
"^DD",811.2,811.2,.01,3)
Answer must be 3-35 characters in length.
"^DD",811.2,811.2,.01,21,0)
^.001^1^1^3000505^^^^
"^DD",811.2,811.2,.01,21,1,0)
This is the name of the taxonomy. It must be unique.
"^DD",811.2,811.2,.01,"DT")
3000601
"^DD",811.2,811.2,.02,0)
BRIEF DESCRIPTION^F^^0;2^K:$L(X)>80!($L(X)<3) X
"^DD",811.2,811.2,.02,3)
Answer must be 3-80 characters in length.
"^DD",811.2,811.2,.02,21,0)
^.001^2^2^3000505^^^^
"^DD",811.2,811.2,.02,21,1,0)
This is a brief description of what the taxonomy represents. This may be
"^DD",811.2,811.2,.02,21,2,0)
used to further define the intended use of this taxonomy.
"^DD",811.2,811.2,.02,"DT")
3000502
"^DD",811.2,811.2,.03,0)
DIALOG HEADER TEXT^F^^0;3^K:$L(X)>80!($L(X)<3) X
"^DD",811.2,811.2,.03,3)
Answer must be 3-80 characters in length.
"^DD",811.2,811.2,.03,21,0)
^.001^2^2^3000502^^^
"^DD",811.2,811.2,.03,21,1,0)
This text will be displayed as a checkbox in the reminder dialog for this
"^DD",811.2,811.2,.03,21,2,0)
taxonomy.
"^DD",811.2,811.2,.03,"DT")
2991025
"^DD",811.2,811.2,1.6,0)
INACTIVE FLAG^S^1:INACTIVE;^0;6^Q
"^DD",811.2,811.2,1.6,3)
Enter a 1 to inactivate this taxonomy.
"^DD",811.2,811.2,1.6,21,0)
^.001^6^6^3000502^^
"^DD",811.2,811.2,1.6,21,1,0)
Enter "1" to inactivate the taxonomy.  This flag is set to ACTIVE in
"^DD",811.2,811.2,1.6,21,2,0)
the distribution. As part of the installation, each site should review
"^DD",811.2,811.2,1.6,21,3,0)
the taxonomy definitions and inactivate those that do not meet the
"^DD",811.2,811.2,1.6,21,4,0)
site's needs. If desired, a site can copy a distributed taxonomy, using
"^DD",811.2,811.2,1.6,21,5,0)
the taxomony copy option, to a local version and edit it to meet the
"^DD",811.2,811.2,1.6,21,6,0)
site's needs.
"^DD",811.2,811.2,1.6,23,0)
^.001^2^2^3000502^^
"^DD",811.2,811.2,1.6,23,1,0)
This flag controls whether or not taxonomies may be selected as a
"^DD",811.2,811.2,1.6,23,2,0)
Clinical Reminder finding.
"^DD",811.2,811.2,1.6,"DT")
2960730
"^DD",811.2,811.2,4,0)
PATIENT DATA SOURCE^FX^^0;4^K:$L(X)>40!($L(X)<1) X D VPDS^PXRMTAX
"^DD",811.2,811.2,4,3)
Answer must be 1-40 characters in length.
"^DD",811.2,811.2,4,4)
D PDSXHELP^PXRMTAX
"^DD",811.2,811.2,4,21,0)
^.001^2^2^3030414^^^^
"^DD",811.2,811.2,4,21,1,0)
PATIENT DATA SOURCE refines the taxonomy search by specifying which
"^DD",811.2,811.2,4,21,2,0)
patient data sources are searched for matching codes.
"^DD",811.2,811.2,4,"DT")
3030414
"^DD",811.2,811.2,10,0)
USE INACTIVE PROBLEMS^S^1:YES;^0;9^Q
"^DD",811.2,811.2,10,3)
Enter YES if you want to use both active and inactive problems.
"^DD",811.2,811.2,10,21,0)
^.001^6^6^3030220^^^^
"^DD",811.2,811.2,10,21,1,0)
USE INACTIVE PROBLEMS applies only to searches in Problem List. Normally
"^DD",811.2,811.2,10,21,2,0)
inactive problems are not used. However, when this field is set to YES
"^DD",811.2,811.2,10,21,3,0)
then both active and inactive problems are used. This field works just
"^DD",811.2,811.2,10,21,4,0)
like the field with the same name that can be specified for a reminder
"^DD",811.2,811.2,10,21,5,0)
definition finding or a reminder term finding. The order of precedence
"^DD",811.2,811.2,10,21,6,0)
is taxonomy > term > definition.
"^DD",811.2,811.2,10,"DT")
3000403
"^DD",811.2,811.2,100,0)
CLASS^RSX^N:NATIONAL;V:VISN;L:LOCAL;^100;1^K:'$$VCLASS^PXRMINTR(X) X
"^DD",811.2,811.2,100,3)
Enter the class.
"^DD",811.2,811.2,100,21,0)
^.001^1^1^3010518^^^
"^DD",811.2,811.2,100,21,1,0)
This is the class of definition. National taxonomies cannot be edited.
"^DD",811.2,811.2,100,"DT")
3010518
"^DD",811.2,811.2,101,0)
SPONSOR^P811.6^PXRMD(811.6,^100;2^Q
"^DD",811.2,811.2,101,3)
Enter the sponsor.
"^DD",811.2,811.2,101,21,0)
^^1^1^3010501^
"^DD",811.2,811.2,101,21,1,0)
This is the organization or group that sponsors this taxonomy.
"^DD",811.2,811.2,101,"DT")
3010419
"^DD",811.2,811.2,102,0)
REVIEW DATE^D^^100;3^S %DT="E" D ^%DT S X=Y K:Y<1 X
"^DD",811.2,811.2,102,3)
Enter the review date.
"^DD",811.2,811.2,102,21,0)
^^3^3^3010501^
"^DD",811.2,811.2,102,21,1,0)
The REVIEW DATE is used to determine when the taxonomy should be
"^DD",811.2,811.2,102,21,2,0)
reviewed to verify that it is current with the latest standards and
"^DD",811.2,811.2,102,21,3,0)
guidelines.
"^DD",811.2,811.2,102,"DT")
3010419
"^DD",811.2,811.2,110,0)
EDIT HISTORY^811.21D^^110;0
"^DD",811.2,811.2,110,21,0)
^.001^2^2^3010502^^
"^DD",811.2,811.2,110,21,1,0)
This multiple is used to record a history of changes made to the
"^DD",811.2,811.2,110,21,2,0)
taxonomy.
"^DD",811.2,811.2,2102,0)
ICD9 RANGE OF CODES^811.22102^^80;0
"^DD",811.2,811.2,2102,21,0)
^.001^5^5^3030325^^^^
"^DD",811.2,811.2,2102,21,1,0)
This multiple is used to define ranges of ICD9 codes which
"^DD",811.2,811.2,2102,21,2,0)
constitute taxonomy entries. A range is defined by a low and high
"^DD",811.2,811.2,2102,21,3,0)
code which are inclusive. The low and high codes are actual codes
"^DD",811.2,811.2,2102,21,4,0)
from the source file, not internal entry numbers.
"^DD",811.2,811.2,2102,21,5,0)

"^DD",811.2,811.2,2102,"DT")
3030220
"^DD",811.2,811.2,2103,0)
ICD0 RANGE OF CODES^811.22103^^80.1;0
"^DD",811.2,811.2,2103,21,0)
^.001^4^4^3030325^^^^
"^DD",811.2,811.2,2103,21,1,0)
This multiple is used to define ranges of ICD0 codes which
"^DD",811.2,811.2,2103,21,2,0)
constitute taxonomy entries. A range is defined by a low and high
"^DD",811.2,811.2,2103,21,3,0)
code which are inclusive. The low and high code are actual codes
"^DD",811.2,811.2,2103,21,4,0)
from the source file, not internal entry numbers.
"^DD",811.2,811.2,2103,"DT")
3030220
"^DD",811.2,811.2,2104,0)
CPT RANGE OF CODES^811.22104^^81;0
"^DD",811.2,811.2,2104,21,0)
^.001^5^5^3030325^^^^
"^DD",811.2,811.2,2104,21,1,0)
This multiple is used to define ranges of CPT codes which
"^DD",811.2,811.2,2104,21,2,0)
constitute taxonomy entries. A range is defined by a low and high
"^DD",811.2,811.2,2104,21,3,0)
code which are inclusive. The low and high codes are actual codes
"^DD",811.2,811.2,2104,21,4,0)
from the source file, not internal entry numbers.
"^DD",811.2,811.2,2104,21,5,0)

"^DD",811.2,811.2,2104,"DT")
3030220
"^DD",811.2,811.2,3102,0)
SELECTABLE DIAGNOSIS^811.23102IP^^SDX;0
"^DD",811.2,811.2,3102,21,0)
^.001^4^4^3000505^^
"^DD",811.2,811.2,3102,21,1,0)
These are the diagnosis codes that may be selected when processing a
"^DD",811.2,811.2,3102,21,2,0)
taxonomy dialog within CPRS. The list of codes is built from the code
"^DD",811.2,811.2,3102,21,3,0)
ranges within the taxonomy when the Clinical Reminders package is
"^DD",811.2,811.2,3102,21,4,0)
installed and includes only active codes.
"^DD",811.2,811.2,3104,0)
SELECTABLE PROCEDURE^811.23104IP^^SPR;0
"^DD",811.2,811.2,3104,21,0)
^.001^4^4^3000505^^
"^DD",811.2,811.2,3104,21,1,0)
These are the procedure codes that may be selected when processing a
"^DD",811.2,811.2,3104,21,2,0)
taxonomy dialog within CPRS. The list of codes is built from the code
"^DD",811.2,811.2,3104,21,3,0)
ranges within the taxonomy when the Clinical Reminders package is
"^DD",811.2,811.2,3104,21,4,0)
installed and includes only active codes.
"^DD",811.2,811.2,3106,0)
GENERATE DIALOG DX PARAMETER^S^1:INDIVIDUAL DIALOG FOR EACH DIAGNOSIS CODE;^SDZ;1^Q
"^DD",811.2,811.2,3106,3)
Enter 1 if each selectable diagnosis should be a separate prompt.
"^DD",811.2,811.2,3106,21,0)
^^6^6^3000505^
"^DD",811.2,811.2,3106,21,1,0)
If this parameter is set then each active code in the selectable diagnosis
"^DD",811.2,811.2,3106,21,2,0)
list will be presented as a separate question in CPRS with text generated
"^DD",811.2,811.2,3106,21,3,0)
from the finding parameter file.
"^DD",811.2,811.2,3106,21,4,0)
 
"^DD",811.2,811.2,3106,21,5,0)
Otherwise the active selectable diagnoses will be displayed as a checkbox
"^DD",811.2,811.2,3106,21,6,0)
with the dialog header text for diagnoses. This is the default option.
"^DD",811.2,811.2,3106,"DT")
2990908
"^DD",811.2,811.2,3107,0)
CURRENT VISIT DX DIALOG HDR^F^^SDZ;2^K:$L(X)>80!($L(X)<1) X
"^DD",811.2,811.2,3107,.1)

"^DD",811.2,811.2,3107,3)
Enter 1-80 character header text for current visit diagnosis selection.
"^DD",811.2,811.2,3107,21,0)
^.001^6^6^3000503^^^
"^DD",811.2,811.2,3107,21,1,0)
This is the diagnosis dialog sub-header text that will be selectable for
"^DD",811.2,811.2,3107,21,2,0)
CPRS users to document a diagnosis from the taxonomy as treated at the
"^DD",811.2,811.2,3107,21,3,0)
current visit. The header text will display with a check box which CPRS
"^DD",811.2,811.2,3107,21,4,0)
users can select to see the selectable diagnoses list. 
"^DD",811.2,811.2,3107,21,5,0)
 
"^DD",811.2,811.2,3107,21,6,0)
If this field is not present the taxonomy name will be used.
"^DD",811.2,811.2,3107,"DT")
3000503
"^DD",811.2,811.2,3108,0)
HISTORICAL VISIT DX DIALOG HDR^F^^SDZ;3^K:$L(X)>80!($L(X)<1) X
"^DD",811.2,811.2,3108,3)
Enter 1-80 character header text for historical visit diagnosis selection.
"^DD",811.2,811.2,3108,21,0)
^^7^7^3000503^
"^DD",811.2,811.2,3108,21,1,0)
This is the diagnosis dialog sub-header text that will be selectable for
"^DD",811.2,811.2,3108,21,2,0)
CPRS users to document a diagnosis from the taxonomy as a historical
"^DD",811.2,811.2,3108,21,3,0)
diagnosis. The header text will display with a check box which CPRS users
"^DD",811.2,811.2,3108,21,4,0)
can select to see the selectable diagnoses list.  Historical diagnoses
"^DD",811.2,811.2,3108,21,5,0)
selected will require the CPRS user to enter a visit date.
"^DD",811.2,811.2,3108,21,6,0)
 
"^DD",811.2,811.2,3108,21,7,0)
If this field is not present the taxonomy name will be used.
"^DD",811.2,811.2,3108,"DT")
3000503
"^DD",811.2,811.2,3110,0)
GENERATE DIALOG PR PARAMETER^S^1:INDIVIDUAL DIALOG FOR EACH PROCEDURE;^SPZ;1^Q
"^DD",811.2,811.2,3110,3)
Enter 1 if each selectable procedure should be a separate prompt.
"^DD",811.2,811.2,3110,21,0)
^^6^6^3000505^
"^DD",811.2,811.2,3110,21,1,0)
If this parameter is set then each active code in the selectable procedure
"^DD",811.2,811.2,3110,21,2,0)
list will be presented as a separate question in CPRS with text generated
"^DD",811.2,811.2,3110,21,3,0)
from the finding parameter file.
"^DD",811.2,811.2,3110,21,4,0)
                                  
"^DD",811.2,811.2,3110,21,5,0)
Otherwise the active selectable procedures will be displayed as a checkbox
"^DD",811.2,811.2,3110,21,6,0)
with the dialog header text for procedures. This is the default option.
"^DD",811.2,811.2,3110,"DT")
2990909
"^DD",811.2,811.2,3111,0)
CURRENT VISIT PR DIALOG HDR^F^^SPZ;2^K:$L(X)>80!($L(X)<1) X
"^DD",811.2,811.2,3111,3)
Enter 1-80 character header text for current visit procedure selection.
"^DD",811.2,811.2,3111,21,0)
^.001^6^6^3000503^^
"^DD",811.2,811.2,3111,21,1,0)
This is the procedure dialog sub-header text that will be selectable for
"^DD",811.2,811.2,3111,21,2,0)
CPRS users to document a procedure from the taxonomy as done at the
"^DD",811.2,811.2,3111,21,3,0)
current visit. The header text will display with a check box which CPRS
"^DD",811.2,811.2,3111,21,4,0)
users can select to see the selectable procedure list. 
"^DD",811.2,811.2,3111,21,5,0)
 
"^DD",811.2,811.2,3111,21,6,0)
If this field is not present the taxonomy name will be used.
"^DD",811.2,811.2,3111,"DT")
3000503
"^DD",811.2,811.2,3112,0)
HISTORICAL VISIT PR DIALOG HDR^F^^SPZ;3^K:$L(X)>80!($L(X)<1) X
"^DD",811.2,811.2,3112,3)
Enter 1-80 character header text for historical visit procedure selection.
"^DD",811.2,811.2,3112,21,0)
^.001^7^7^3000503^^
"^DD",811.2,811.2,3112,21,1,0)
This is the procedure dialog sub-header text that will be selectable for
"^DD",811.2,811.2,3112,21,2,0)
CPRS users to document a procedure from the taxonomy as a historical
"^DD",811.2,811.2,3112,21,3,0)
procedure. The header text will display with a check box which CPRS users
"^DD",811.2,811.2,3112,21,4,0)
can select to see the selectable procedure list.  Historical procedures
"^DD",811.2,811.2,3112,21,5,0)
selected will require the CPRS user to enter a visit date.
"^DD",811.2,811.2,3112,21,6,0)
 
"^DD",811.2,811.2,3112,21,7,0)
If this field is not present the taxonomy name will be used.
"^DD",811.2,811.2,3112,"DT")
3000503
"^DD",811.2,811.21,0)
EDIT HISTORY SUB-FIELD^^2^3
"^DD",811.2,811.21,0,"DT")
3010419
"^DD",811.2,811.21,0,"IX","B",811.21,.01)

"^DD",811.2,811.21,0,"NM","EDIT HISTORY")

"^DD",811.2,811.21,0,"UP")
811.2
"^DD",811.2,811.21,.01,0)
EDIT DATE^D^^0;1^S %DT="ESTX" D ^%DT S X=Y K:Y<1 X
"^DD",811.2,811.21,.01,1,0)
^.1
"^DD",811.2,811.21,.01,1,1,0)
811.21^B
"^DD",811.2,811.21,.01,1,1,1)
S ^PXD(811.2,DA(1),110,"B",$E(X,1,30),DA)=""
"^DD",811.2,811.21,.01,1,1,2)
K ^PXD(811.2,DA(1),110,"B",$E(X,1,30),DA)
"^DD",811.2,811.21,.01,21,0)
^^2^2^3010501^
"^DD",811.2,811.21,.01,21,1,0)
This is the date and time when the editing was done. This field is set
"^DD",811.2,811.21,.01,21,2,0)
automatically and should not be changed by the user.
"^DD",811.2,811.21,.01,"DT")
3010419
"^DD",811.2,811.21,1,0)
EDIT BY^P200'^VA(200,^0;2^Q
"^DD",811.2,811.21,1,21,0)
^^2^2^3010501^
"^DD",811.2,811.21,1,21,1,0)
This is the person who did the editing. This field is set automatically
"^DD",811.2,811.21,1,21,2,0)
and should not be changed by the user.
"^DD",811.2,811.21,1,"DT")
3010419
"^DD",811.2,811.21,2,0)
EDIT COMMENTS^811.212^^1;0
"^DD",811.2,811.21,2,21,0)
^.001^2^2^3010502^^
"^DD",811.2,811.21,2,21,1,0)
This word-processing field can be used to the record the changes made
"^DD",811.2,811.21,2,21,2,0)
during the editing session.
"^DD",811.2,811.21,2,"DT")
3010425
"^DD",811.2,811.212,0)
EDIT COMMENTS SUB-FIELD^^.01^1
"^DD",811.2,811.212,0,"DT")
3010419
"^DD",811.2,811.212,0,"NM","EDIT COMMENTS")

"^DD",811.2,811.212,0,"UP")
811.21
"^DD",811.2,811.212,.01,0)
EDIT COMMENTS^W^^0;1^Q
"^DD",811.2,811.212,.01,3)
Enter your edit comments.
"^DD",811.2,811.212,.01,"DT")
3010425
"^DD",811.2,811.22102,0)
ICD9 RANGE OF CODES SUB-FIELD^^3^4
"^DD",811.2,811.22102,0,"DT")
3030325
"^DD",811.2,811.22102,0,"IX","B",811.22102,.01)

"^DD",811.2,811.22102,0,"NM","ICD9 RANGE OF CODES")

"^DD",811.2,811.22102,0,"UP")
811.2
"^DD",811.2,811.22102,.01,0)
ICD9 LOW CODE^MFX^^0;1^K:(($L(X)>7)!($L(X)<3)!('$$VICD9^PXRMCODE(X))) X
"^DD",811.2,811.22102,.01,1,0)
^.1^^-1
"^DD",811.2,811.22102,.01,1,1,0)
811.22102^B
"^DD",811.2,811.22102,.01,1,1,1)
S ^PXD(811.2,DA(1),80,"B",$E(X,1,30),DA)=""
"^DD",811.2,811.22102,.01,1,1,2)
K ^PXD(811.2,DA(1),80,"B",$E(X,1,30),DA)
"^DD",811.2,811.22102,.01,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22102,.01,"DT")
3030414
"^DD",811.2,811.22102,1,0)
ICD9 HIGH CODE^FX^^0;2^K:(($L(X)>7)!($L(X)<3)!('$$VHICD9^PXRMCODE(.DA,X))) X
"^DD",811.2,811.22102,1,1,0)
^.1^^0
"^DD",811.2,811.22102,1,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22102,1,"DT")
3030414
"^DD",811.2,811.22102,2,0)
ICD9 ADJACENT LOWER CODE^F^^0;3^K:$L(X)>7!($L(X)<3) X
"^DD",811.2,811.22102,2,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22102,2,21,0)
^.001^1^1^3030325^^^
"^DD",811.2,811.22102,2,21,1,0)
This is the code comes immediately before the ICD9 LOW CODE.
"^DD",811.2,811.22102,2,"DT")
3030325
"^DD",811.2,811.22102,3,0)
ICD9 ADJACENT HIGHER CODE^F^^0;4^K:$L(X)>7!($L(X)<3) X
"^DD",811.2,811.22102,3,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22102,3,21,0)
^.001^1^1^3030325^^^
"^DD",811.2,811.22102,3,21,1,0)
This is the code that comes immediately after the ICD9 HIGH CODE.
"^DD",811.2,811.22102,3,"DT")
3030325
"^DD",811.2,811.22103,0)
ICD0 RANGE OF CODES SUB-FIELD^^3^4
"^DD",811.2,811.22103,0,"DT")
3030325
"^DD",811.2,811.22103,0,"IX","B",811.22103,.01)

"^DD",811.2,811.22103,0,"NM","ICD0 RANGE OF CODES")

"^DD",811.2,811.22103,0,"UP")
811.2
"^DD",811.2,811.22103,.01,0)
ICDO LOW CODE^MFX^^0;1^K:(($L(X)>7)!($L(X)<3)!('$$VICD0^PXRMCODE(X))) X
"^DD",811.2,811.22103,.01,1,0)
^.1^^-1
"^DD",811.2,811.22103,.01,1,1,0)
811.22103^B
"^DD",811.2,811.22103,.01,1,1,1)
S ^PXD(811.2,DA(1),80.1,"B",$E(X,1,30),DA)=""
"^DD",811.2,811.22103,.01,1,1,2)
K ^PXD(811.2,DA(1),80.1,"B",$E(X,1,30),DA)
"^DD",811.2,811.22103,.01,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22103,.01,"DT")
3030414
"^DD",811.2,811.22103,1,0)
ICD0 HIGH CODE^FX^^0;2^K:(($L(X)>7)!($L(X)<3)!('$$VHICD0^PXRMCODE(.DA,X))) X
"^DD",811.2,811.22103,1,1,0)
^.1^^0
"^DD",811.2,811.22103,1,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22103,1,"DT")
3030414
"^DD",811.2,811.22103,2,0)
ICD0 ADJACENT LOWER CODE^F^^0;3^K:$L(X)>7!($L(X)<3) X
"^DD",811.2,811.22103,2,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22103,2,21,0)
^.001^1^1^3030325^^^
"^DD",811.2,811.22103,2,21,1,0)
This is the code that comes immediately before the ICD0 LOW CODE.
"^DD",811.2,811.22103,2,"DT")
3030325
"^DD",811.2,811.22103,3,0)
ICD0 ADJACENT HIGHER CODE^F^^0;4^K:$L(X)>7!($L(X)<3) X
"^DD",811.2,811.22103,3,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22103,3,21,0)
^.001^1^1^3030325^^^
"^DD",811.2,811.22103,3,21,1,0)
This is the code that comes immediately after the ICD0 HIGH CODE.
"^DD",811.2,811.22103,3,"DT")
3030325
"^DD",811.2,811.22104,0)
CPT RANGE OF CODES SUB-FIELD^^3^4
"^DD",811.2,811.22104,0,"DT")
3030321
"^DD",811.2,811.22104,0,"IX","B",811.22104,.01)

"^DD",811.2,811.22104,0,"NM","CPT RANGE OF CODES")

"^DD",811.2,811.22104,0,"UP")
811.2
"^DD",811.2,811.22104,.01,0)
CPT LOW CODE^MFX^^0;1^K:(($L(X)>7)!($L(X)<3)!('$$VICPT^PXRMCODE(X))) X
"^DD",811.2,811.22104,.01,1,0)
^.1^^-1
"^DD",811.2,811.22104,.01,1,1,0)
811.22104^B
"^DD",811.2,811.22104,.01,1,1,1)
S ^PXD(811.2,DA(1),81,"B",$E(X,1,30),DA)=""
"^DD",811.2,811.22104,.01,1,1,2)
K ^PXD(811.2,DA(1),81,"B",$E(X,1,30),DA)
"^DD",811.2,811.22104,.01,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22104,.01,"DT")
3030414
"^DD",811.2,811.22104,1,0)
CPT HIGH CODE^FX^^0;2^K:(($L(X)>7)!($L(X)<3)!('$$VHICPT^PXRMCODE(.DA,X))) X
"^DD",811.2,811.22104,1,1,0)
^.1^^0
"^DD",811.2,811.22104,1,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22104,1,"DT")
3030414
"^DD",811.2,811.22104,2,0)
CPT ADJACENT LOWER CODE^F^^0;3^K:$L(X)>7!($L(X)<3) X
"^DD",811.2,811.22104,2,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22104,2,21,0)
^.001^1^1^3030325^^
"^DD",811.2,811.22104,2,21,1,0)
This is the code that comes immediately before the CPT LOW CODE.
"^DD",811.2,811.22104,2,"DT")
3030325
"^DD",811.2,811.22104,3,0)
CPT ADJACENT HIGHER CODE^F^^0;4^K:$L(X)>7!($L(X)<3) X
"^DD",811.2,811.22104,3,3)
Answer must be 3-7 characters in length.
"^DD",811.2,811.22104,3,21,0)
^.001^1^1^3030325^^
"^DD",811.2,811.22104,3,21,1,0)
This is the code that comes immediately after the CPT HIGH CODE.
"^DD",811.2,811.22104,3,"DT")
3030325
"^DD",811.2,811.23102,0)
SELECTABLE DIAGNOSIS SUB-FIELD^^2^3
"^DD",811.2,811.23102,0,"DT")
2991025
"^DD",811.2,811.23102,0,"ID",1)
W "   ",$P(^(0),U,2)
"^DD",811.2,811.23102,0,"IX","B",811.23102,.01)

"^DD",811.2,811.23102,0,"NM","SELECTABLE DIAGNOSIS")

"^DD",811.2,811.23102,0,"UP")
811.2
"^DD",811.2,811.23102,.01,0)
SELECTABLE DIAGNOSIS^MP80'^ICD9(^0;1^Q
"^DD",811.2,811.23102,.01,1,0)
^.1
"^DD",811.2,811.23102,.01,1,1,0)
811.23102^B
"^DD",811.2,811.23102,.01,1,1,1)
S ^PXD(811.2,DA(1),"SDX","B",$E(X,1,30),DA)=""
"^DD",811.2,811.23102,.01,1,1,2)
K ^PXD(811.2,DA(1),"SDX","B",$E(X,1,30),DA)
"^DD",811.2,811.23102,.01,3)
Enter a ICD9 code that can be entered in CPRS to satisfy a reminder.
"^DD",811.2,811.23102,.01,21,0)
^.001^2^2^3000503^^
"^DD",811.2,811.23102,.01,21,1,0)
This is the selectable diagnosis code that will appear in the taxonomy
"^DD",811.2,811.23102,.01,21,2,0)
dialog. Only active codes may be selected.
"^DD",811.2,811.23102,.01,"DT")
2991025
"^DD",811.2,811.23102,1,0)
DISPLAY TEXT^F^^0;2^K:$L(X)>40!($L(X)<1) X
"^DD",811.2,811.23102,1,3)
Answer must be 1-40 characters in length.
"^DD",811.2,811.23102,1,21,0)
^.001^3^3^3000502^^
"^DD",811.2,811.23102,1,21,1,0)
This is the description of the diagnosis code that will appear in the
"^DD",811.2,811.23102,1,21,2,0)
taxonomy dialog in CPRS. The field is optional - the standard diagnosis
"^DD",811.2,811.23102,1,21,3,0)
code name is the default.
"^DD",811.2,811.23102,1,"DT")
2991025
"^DD",811.2,811.23102,2,0)
DISABLED^S^1:DISABLED;^0;3^Q
"^DD",811.2,811.23102,2,21,0)
^^2^2^3000502^
"^DD",811.2,811.23102,2,21,1,0)
This field should be input if a selectable code is to be excluded
"^DD",811.2,811.23102,2,21,2,0)
temporarily from the taxonomy dialog in CPRS.
"^DD",811.2,811.23102,2,"DT")
2991025
"^DD",811.2,811.23104,0)
SELECTABLE PROCEDURE SUB-FIELD^^2^3
"^DD",811.2,811.23104,0,"DT")
2991025
"^DD",811.2,811.23104,0,"ID",1)
W "   ",$P(^(0),U,2)
"^DD",811.2,811.23104,0,"IX","B",811.23104,.01)

"^DD",811.2,811.23104,0,"NM","SELECTABLE PROCEDURE")

"^DD",811.2,811.23104,0,"UP")
811.2
"^DD",811.2,811.23104,.01,0)
SELECTABLE PROCEDURE^MP81'^ICPT(^0;1^Q
"^DD",811.2,811.23104,.01,1,0)
^.1
"^DD",811.2,811.23104,.01,1,1,0)
811.23104^B
"^DD",811.2,811.23104,.01,1,1,1)
S ^PXD(811.2,DA(1),"SPR","B",$E(X,1,30),DA)=""
"^DD",811.2,811.23104,.01,1,1,2)
K ^PXD(811.2,DA(1),"SPR","B",$E(X,1,30),DA)
"^DD",811.2,811.23104,.01,3)
Enter a CPT code that can be entered in CPRS to satisfy a reminder
"^DD",811.2,811.23104,.01,21,0)
^^2^2^3000502^
"^DD",811.2,811.23104,.01,21,1,0)
This is the selectable procedure code that will appear in the taxonomy
"^DD",811.2,811.23104,.01,21,2,0)
dialog. Only active codes may be selected.
"^DD",811.2,811.23104,.01,"DT")
2991025
"^DD",811.2,811.23104,1,0)
DISPLAY TEXT^F^^0;2^K:$L(X)>40!($L(X)<1) X
"^DD",811.2,811.23104,1,3)
Answer must be 1-40 characters in length.
"^DD",811.2,811.23104,1,21,0)
^^3^3^3000502^
"^DD",811.2,811.23104,1,21,1,0)
This is the description of the procedure code that will appear in the
"^DD",811.2,811.23104,1,21,2,0)
taxonomy dialog in CPRS. The field is optional - the standard standard
"^DD",811.2,811.23104,1,21,3,0)
code name is the default.
"^DD",811.2,811.23104,1,"DT")
2991025
"^DD",811.2,811.23104,2,0)
DISABLED^S^1:DISABLED;^0;3^Q
"^DD",811.2,811.23104,2,21,0)
^^2^2^3000502^
"^DD",811.2,811.23104,2,21,1,0)
This field should be input if a selectable code is to be excluded
"^DD",811.2,811.23104,2,21,2,0)
temporarily from the taxonomy dialog in CPRS.
"^DD",811.2,811.23104,2,"DT")
2991025
"^DIC",811.2,811.2,0)
REMINDER TAXONOMY^811.2I
"^DIC",811.2,811.2,0,"GL")
^PXD(811.2,
"^DIC",811.2,811.2,"%",0)
^1.005^^0
"^DIC",811.2,811.2,"%D",0)
^^8^8^3000609^^^^
"^DIC",811.2,811.2,"%D",1,0)
This file stores the Clinical Reminder taxonomies. A taxonomy is just a
"^DIC",811.2,811.2,"%D",2,0)
way to give a name to a set of codes. These codes can be ICD Diagnosis,
"^DIC",811.2,811.2,"%D",3,0)
ICD Operation/Procedure or CPT.
"^DIC",811.2,811.2,"%D",4,0)

"^DIC",811.2,811.2,"%D",5,0)
This file contains a combination of nationally distributed and local
"^DIC",811.2,811.2,"%D",6,0)
entries. Any local entries are assigned an internal entry number
"^DIC",811.2,811.2,"%D",7,0)
prefixed with your site number. Nationally distributed entries have
"^DIC",811.2,811.2,"%D",8,0)
their name prefixed with VA-. Local entry names cannot start with VA-.
"^DIC",811.2,"B","REMINDER TAXONOMY",811.2)

**END**
**END**
