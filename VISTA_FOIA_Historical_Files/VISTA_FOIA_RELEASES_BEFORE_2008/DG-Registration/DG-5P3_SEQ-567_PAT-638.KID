Released DG*5.3*638 SEQ #567
Extracted from mail message
**KIDS**:DG*5.3*638^

**INSTALL NAME**
DG*5.3*638
"BLD",5601,0)
DG*5.3*638^REGISTRATION^0^3050411^y
"BLD",5601,1,0)
^^10^10^3050302^
"BLD",5601,1,1,0)
Patient catastrophic edits.
"BLD",5601,1,2,0)
 
"BLD",5601,1,3,0)
1.  Two or more edits (name, ssn, dob, or sex) during the Registration 
"BLD",5601,1,4,0)
process create alert to those holding the DG CATASTROPHIC EDIT key.
"BLD",5601,1,5,0)
2.  Alerts retained for 365 days.
"BLD",5601,1,6,0)
3.  Alert allows patient information displayed with collected data on 
"BLD",5601,1,7,0)
review and catastrophic edit status.
"BLD",5601,1,8,0)
4.  Report displays alert information (going back one year) on 
"BLD",5601,1,9,0)
catatastrophic edits (alerts posted, alerts reviewed, and alerts 
"BLD",5601,1,10,0)
determined to be catastrophic).
"BLD",5601,4,0)
^9.64PA^^
"BLD",5601,"ABPKG")
n
"BLD",5601,"INIT")
POST^DG53P638
"BLD",5601,"KRN",0)
^9.67PA^8989.52^19
"BLD",5601,"KRN",.4,0)
.4
"BLD",5601,"KRN",.401,0)
.401
"BLD",5601,"KRN",.402,0)
.402
"BLD",5601,"KRN",.403,0)
.403
"BLD",5601,"KRN",.5,0)
.5
"BLD",5601,"KRN",.84,0)
.84
"BLD",5601,"KRN",3.6,0)
3.6
"BLD",5601,"KRN",3.8,0)
3.8
"BLD",5601,"KRN",9.2,0)
9.2
"BLD",5601,"KRN",9.8,0)
9.8
"BLD",5601,"KRN",9.8,"NM",0)
^9.68A^8^7
"BLD",5601,"KRN",9.8,"NM",1,0)
DGRP1^^0^B22430607
"BLD",5601,"KRN",9.8,"NM",2,0)
DGRP2^^0^B10969747
"BLD",5601,"KRN",9.8,"NM",3,0)
DGRPE^^0^B45879875
"BLD",5601,"KRN",9.8,"NM",4,0)
DGRPECE^^0^B25851474
"BLD",5601,"KRN",9.8,"NM",5,0)
DGRPECE1^^0^B29329791
"BLD",5601,"KRN",9.8,"NM",7,0)
DGRPECE2^^0^B34049720
"BLD",5601,"KRN",9.8,"NM",8,0)
DGRPH^^0^B27007485
"BLD",5601,"KRN",9.8,"NM","B","DGRP1",1)

"BLD",5601,"KRN",9.8,"NM","B","DGRP2",2)

"BLD",5601,"KRN",9.8,"NM","B","DGRPE",3)

"BLD",5601,"KRN",9.8,"NM","B","DGRPECE",4)

"BLD",5601,"KRN",9.8,"NM","B","DGRPECE1",5)

"BLD",5601,"KRN",9.8,"NM","B","DGRPECE2",7)

"BLD",5601,"KRN",9.8,"NM","B","DGRPH",8)

"BLD",5601,"KRN",19,0)
19
"BLD",5601,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",5601,"KRN",19,"NM",1,0)
DG PATIENT CE REPORT^^0
"BLD",5601,"KRN",19,"NM","B","DG PATIENT CE REPORT",1)

"BLD",5601,"KRN",19.1,0)
19.1
"BLD",5601,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",5601,"KRN",19.1,"NM",1,0)
DG CATASTROPHIC EDIT^^0
"BLD",5601,"KRN",19.1,"NM","B","DG CATASTROPHIC EDIT",1)

"BLD",5601,"KRN",101,0)
101
"BLD",5601,"KRN",409.61,0)
409.61
"BLD",5601,"KRN",771,0)
771
"BLD",5601,"KRN",870,0)
870
"BLD",5601,"KRN",8989.51,0)
8989.51
"BLD",5601,"KRN",8989.52,0)
8989.52
"BLD",5601,"KRN",8994,0)
8994
"BLD",5601,"KRN","B",.4,.4)

"BLD",5601,"KRN","B",.401,.401)

"BLD",5601,"KRN","B",.402,.402)

"BLD",5601,"KRN","B",.403,.403)

"BLD",5601,"KRN","B",.5,.5)

"BLD",5601,"KRN","B",.84,.84)

"BLD",5601,"KRN","B",3.6,3.6)

"BLD",5601,"KRN","B",3.8,3.8)

"BLD",5601,"KRN","B",9.2,9.2)

"BLD",5601,"KRN","B",9.8,9.8)

"BLD",5601,"KRN","B",19,19)

"BLD",5601,"KRN","B",19.1,19.1)

"BLD",5601,"KRN","B",101,101)

"BLD",5601,"KRN","B",409.61,409.61)

"BLD",5601,"KRN","B",771,771)

"BLD",5601,"KRN","B",870,870)

"BLD",5601,"KRN","B",8989.51,8989.51)

"BLD",5601,"KRN","B",8989.52,8989.52)

"BLD",5601,"KRN","B",8994,8994)

"BLD",5601,"QUES",0)
^9.62^^
"BLD",5601,"REQB",0)
^9.611^4^4
"BLD",5601,"REQB",1,0)
DG*5.3*626^1
"BLD",5601,"REQB",2,0)
DG*5.3*570^1
"BLD",5601,"REQB",3,0)
DG*5.3*545^1
"BLD",5601,"REQB",4,0)
DG*5.3*629^1
"BLD",5601,"REQB","B","DG*5.3*545",3)

"BLD",5601,"REQB","B","DG*5.3*570",2)

"BLD",5601,"REQB","B","DG*5.3*626",1)

"BLD",5601,"REQB","B","DG*5.3*629",4)

"INIT")
POST^DG53P638
"KRN",19,12119,-1)
0^1
"KRN",19,12119,0)
DG PATIENT CE REPORT^Report - Patient Catastrophic Edits^^R^^DG SUPERVISOR^^^^^^REGISTRATION
"KRN",19,12119,1,0)
^19.06^6^6^3050301^^
"KRN",19,12119,1,1,0)
This report will list patients, edited through Registration, who were 
"KRN",19,12119,1,2,0)
flagged as having a pontential catastrophic edit alert created for 
"KRN",19,12119,1,3,0)
supervisory review.  A catatrophic edit alert is created when two or more 
"KRN",19,12119,1,4,0)
edits to fields: name, ssn, date of birth, or gender are performed.  
"KRN",19,12119,1,5,0)
Alerts are retained for 365 days, leaving the report to only listing a 
"KRN",19,12119,1,6,0)
years worth of information.
"KRN",19,12119,25)
DGRPECE2
"KRN",19,12119,"U")
REPORT - PATIENT CATASTROPHIC 
"KRN",19.1,478,-1)
0^1
"KRN",19.1,478,0)
DG CATASTROPHIC EDIT
"KRN",19.1,478,1,0)
^^2^2^3050202^
"KRN",19.1,478,1,1,0)
Users holding this key receive alerts when there is potential catastrophic
"KRN",19.1,478,1,2,0)
edits (name, ssn, dob, and sex) performed on a patient thru Registration.
"MBREQ")
0
"ORD",3,19.1)
19.1;3;1;;KEY^XPDTA1;;;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813
"PKG",5,22,1,"PAH",1,0)
638^3050411^123456825
"PKG",5,22,1,"PAH",1,1,0)
^^10^10^3050411
"PKG",5,22,1,"PAH",1,1,1,0)
Patient catastrophic edits.
"PKG",5,22,1,"PAH",1,1,2,0)
 
"PKG",5,22,1,"PAH",1,1,3,0)
1.  Two or more edits (name, ssn, dob, or sex) during the Registration 
"PKG",5,22,1,"PAH",1,1,4,0)
process create alert to those holding the DG CATASTROPHIC EDIT key.
"PKG",5,22,1,"PAH",1,1,5,0)
2.  Alerts retained for 365 days.
"PKG",5,22,1,"PAH",1,1,6,0)
3.  Alert allows patient information displayed with collected data on 
"PKG",5,22,1,"PAH",1,1,7,0)
review and catastrophic edit status.
"PKG",5,22,1,"PAH",1,1,8,0)
4.  Report displays alert information (going back one year) on 
"PKG",5,22,1,"PAH",1,1,9,0)
catatastrophic edits (alerts posted, alerts reviewed, and alerts 
"PKG",5,22,1,"PAH",1,1,10,0)
determined to be catastrophic).
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
8
"RTN","DG53P638")
0^^B787265
"RTN","DG53P638",1,0)
DG53P638 ;ALB/MRY - POST-INIT; 3/1/05 3:22pm
"RTN","DG53P638",2,0)
 ;;5.3;Registration;**638**;Aug 13,1993
"RTN","DG53P638",3,0)
 ;
"RTN","DG53P638",4,0)
POST ;Add option to menu
"RTN","DG53P638",5,0)
 N DGOK
"RTN","DG53P638",6,0)
 S DGOK=$$ADD^XPDMENU("DG REGISTRATION MENU","DG PATIENT CE REPORT")
"RTN","DG53P638",7,0)
 I DGOK=1 D
"RTN","DG53P638",8,0)
 .D BMES^XPDUTL("*****")
"RTN","DG53P638",9,0)
 .D MES^XPDUTL("[DG PATIENT CE REPORT] Option added to [DG REGISTRATION MENU].")
"RTN","DG53P638",10,0)
 E  D
"RTN","DG53P638",11,0)
 .D BMES^XPDUTL("*****")
"RTN","DG53P638",12,0)
 .D MES^XPDUTL("Error - [DG PATIENT CE REPORT] Option not added.")
"RTN","DG53P638",13,0)
 Q
"RTN","DGRP1")
0^1^B22430607
"RTN","DGRP1",1,0)
DGRP1 ;ALB/MRL - DEMOGRAPHIC DATA ; 7/24/03 11:46am
"RTN","DGRP1",2,0)
 ;;5.3;Registration;**109,161,506,244,546,570,629,638**;Aug 13, 1993
"RTN","DGRP1",3,0)
 ;
"RTN","DGRP1",4,0)
EN S (DGRPS,DGRPW)=1 D H^DGRPU F I=0,.11,.121,.13,.15,.24,57 S DGRP(I)=$S($D(^DPT(DFN,I)):^(I),1:"")
"RTN","DGRP1",5,0)
 I $P(DGRP(.15),"^",2)]"" S Z="APPLICANT IS LISTED AS 'INELIGIBLE' FOR TREATMENT!",DGRPCM=1 D WW^DGRPV S DGRPCM=0
"RTN","DGRP1",6,0)
 ;I $P(DGRP(.15),"^",3)]"" S Z="APPLICANT IS LISTED AS 'MISSING'.  NOTIFY APPROPRIATE PERSONNEL!",DGRPCM=1 D WW^DGRPV S DGRPCM=0
"RTN","DGRP1",7,0)
 W ! S Z=1 D WW^DGRPV W "    Name: " S Z=$P(DGRP(0),"^",1),Z1=31 D WW1^DGRPV W "SS: " S X=$P(DGRP(0),"^",9),Z=$E(X,1,3)_"-"_$E(X,4,5)_"-"_$E(X,6,10),Z1=13 D WW1^DGRPV S Y=$P(DGRP(0),"^",3) X ^DD("DD") W "DOB: ",Y
"RTN","DGRP1",8,0)
 D GETNCAL  ;Display name component, sex, and alias information
"RTN","DGRP1",9,0)
 S Z=3,DGRPX=DGRP(0) D WW^DGRPV W " Remarks: ",$S($P(DGRPX,"^",10)]"":$E($P(DGRPX,"^",10),1,65),1:"NO REMARKS ENTERED FOR THIS PATIENT") S DGAD=.11,(DGA1,DGA2)=1 D A^DGRPU I $P(DGRP(.121),"^",9)="Y" S DGAD=.121,DGA1=1,DGA2=2 D A^DGRPU
"RTN","DGRP1",10,0)
 S Z=4 D WW^DGRPV W " Permanent Address: " S Z=" ",Z1=17
"RTN","DGRP1",11,0)
 D WW1^DGRPV S Z=5,DGRPW=0 D WW^DGRPV W " Temporary Address: "
"RTN","DGRP1",12,0)
 W !?11
"RTN","DGRP1",13,0)
 S Z1=40,Z=$S($D(DGA(1)):DGA(1),1:"NONE ON FILE") D WW1^DGRPV W $S($D(DGA(2)):DGA(2),1:"NO TEMPORARY ADDRESS")
"RTN","DGRP1",14,0)
 S I=2 F I1=0:0 S I=$O(DGA(I)) Q:I=""  W:(I#2)!($X>50) !?11 W:'(I#2) ?51 W DGA(I)
"RTN","DGRP1",15,0)
 S DGCC=$S($D(^DIC(5,+$P(DGRP(.11),U,5),1,+$P(DGRP(.11),U,7),0)):$E($P(^(0),U,1),1,20)_$S($P(^(0),U,3)]"":" ("_$P(^(0),U,3)_")",1:""),1:DGRPU) W !?3,"County: ",DGCC K DGCC
"RTN","DGRP1",16,0)
 S DGCC=$S($P(DGRP(.121),U,9)'="Y":"NOT APPLICABLE",$D(^DIC(5,+$P(DGRP(.121),U,5),1,+$P(DGRP(.121),U,11),0)):$E($P(^(0),U,1),1,20)_$S($P(^(0),U,3)]"":" ("_$P(^(0),U,3)_")",1:""),1:DGRPU) W ?43,"County: ",DGCC K DGCC
"RTN","DGRP1",17,0)
 W !?4,"Phone: ",$S($P(DGRP(.13),U,1)]"":$P(DGRP(.13),U,1),1:DGRPU),?44,"Phone: ",$S($P(DGRP(.121),U,9)'="Y":"NOT APPLICABLE",$P(DGRP(.121),U,10)]"":$P(DGRP(.121),U,10),1:DGRPU)
"RTN","DGRP1",18,0)
 S X="NOT APPLICABLE" I $P(DGRP(.121),U,9)="Y" S Y=$P(DGRP(.121),U,7) X:Y]"" ^DD("DD") S X=$S(Y]"":Y,1:DGRPU)_"-",Y=$P(DGRP(.121),U,8) X:Y]"" ^DD("DD") S X=X_$S(Y]"":Y,1:DGRPU)
"RTN","DGRP1",19,0)
 W !?3,"Office: ",$S($P(DGRP(.13),U,2)]"":$P(DGRP(.13),U,2),1:DGRPU),?42,"From/To: ",X
"RTN","DGRP1",20,0)
 W !?1,"Bad Addr: ",$$EXTERNAL^DILFD(2,.121,"",$P(DGRP(.11),U,16))
"RTN","DGRP1",21,0)
 ;
"RTN","DGRP1",22,0)
 ; ***  Additional displays added for Pre-Registration
"RTN","DGRP1",23,0)
 I $G(DGPRFLG)=1 D
"RTN","DGRP1",24,0)
 . W !
"RTN","DGRP1",25,0)
 . N I,MIS1,X,X1,SA1,TP1,X2,X3,ES1
"RTN","DGRP1",26,0)
 . I $D(^DIA(2,"B",DFN)) S X="" F I=1:1 S X=$O(^DIA(2,"B",DFN,X)) Q:X<1  I $P(^DIA(2,X,0),U,3)=.05 S MIS1=$P(^DIA(2,X,0),U,2)
"RTN","DGRP1",27,0)
 . W:$D(MIS1)>0 !," [MARITAL STATUS CHANGED:] "_$$FMTE^XLFDT(MIS1,"5D")
"RTN","DGRP1",28,0)
 . I $D(^DIA(2,"B",DFN)) S X1="" F I=1:1 S X1=$O(^DIA(2,"B",DFN,X1)) Q:X1<1  S:$P(^DIA(2,X1,0),U,3)=.111 SA1=$P(^DIA(2,X1,0),U,2)
"RTN","DGRP1",29,0)
 . W:$D(SA1)>0 !," [STREET ADDRESS LAST CHANGED:] "_$$FMTE^XLFDT(SA1,"5D")
"RTN","DGRP1",30,0)
 . I $D(^DIA(2,"B",DFN)) S X2="" F I=1:1 S X2=$O(^DIA(2,"B",DFN,X2)) Q:X2<1  S:$P(^DIA(2,X2,0),U,3)=.131 TP1=$P(^DIA(2,X2,0),U,2)
"RTN","DGRP1",31,0)
 . W:$D(TP1)>0 !," [HOME PHONE NUMBER CHANGED:] "_$$FMTE^XLFDT(TP1,"5D")
"RTN","DGRP1",32,0)
 . I $D(^DIA(2,"B",DFN)) S X3="" F I=1:1 S X3=$O(^DIA(2,"B",DFN,X3)) Q:X3<1  S:$P(^DIA(2,X3,0),U,3)=.31115 ES1=$P(^DIA(2,X3,0),U,2)
"RTN","DGRP1",33,0)
 . W:$D(ES1)>0 !," [EMPLOYMENT STATUS CHANGED:] "_$$FMTE^XLFDT(ES1,"5D")
"RTN","DGRP1",34,0)
 . ; The IB Insurance API does not provide date entered or edited information, so this information will not be displayed for preregistration
"RTN","DGRP1",35,0)
 . I $$INSUR^IBBAPI(DFN,"","AR",.DGDATA,"1,10,11") F DGI=0:0 S DGI=$O(DGDATA("IBBAPI","INSUR",DGI)) Q:'DGI  D
"RTN","DGRP1",36,0)
 .. W !," [INSURANCE:] ",$P(DGDATA("IBBAPI","INSUR",DGI,1),U,2)
"RTN","DGRP1",37,0)
 .. W "  EFFECTIVE DATE: ",$$FMTE^XLFDT(DGDATA("IBBAPI","INSUR",DGI,10),"5D"),"  EXPIRATION DATE: ",$$FMTE^XLFDT(DGDATA("IBBAPI","INSUR",DGI,11),"5D")
"RTN","DGRP1",38,0)
 ;
"RTN","DGRP1",39,0)
 G ^DGRPP
"RTN","DGRP1",40,0)
 ;
"RTN","DGRP1",41,0)
GETNCAL ;Get name component values
"RTN","DGRP1",42,0)
 N DGCOMP,DGNC,DGI,DGA,DGALIAS,DGX,DGRPW
"RTN","DGRP1",43,0)
 S DGNC="Family^Given^Middle^Prefix^Suffix^Degree"
"RTN","DGRP1",44,0)
 S DGCOMP=+$G(^DPT(DFN,"NAME"))_","
"RTN","DGRP1",45,0)
 I DGCOMP D GETS^DIQ(20,DGCOMP,"1:6",,"DGCOMP")
"RTN","DGRP1",46,0)
 ;Get alias values
"RTN","DGRP1",47,0)
 S DGA=0 F DGI=1:1:5 D  Q:'$D(DGALIAS(DGI))
"RTN","DGRP1",48,0)
A2 .S DGA=$O(^DPT(DFN,.01,DGA))
"RTN","DGRP1",49,0)
 .I 'DGA D:DGI=1  Q
"RTN","DGRP1",50,0)
 ..S DGALIAS(DGI)="< No alias entries on file >" Q
"RTN","DGRP1",51,0)
 .I DGI=5 S DGALIAS(DGI)="< More alias entries on file >" Q
"RTN","DGRP1",52,0)
 .S DGX=$G(^DPT(DFN,.01,DGA,0)) G:'$L(DGX) A2
"RTN","DGRP1",53,0)
 .S DGALIAS(DGI)=$P(DGX,U),DGX=$P(DGX,U,2)
"RTN","DGRP1",54,0)
 .I $L(DGX) D
"RTN","DGRP1",55,0)
 ..S DGX=" "_$E(DGX,1,3)_"-"_$E(DGX,4,5)_"-"_$E(DGX,6,9)
"RTN","DGRP1",56,0)
 ..S $E(DGALIAS(DGI),20)=DGX Q
"RTN","DGRP1",57,0)
 .S DGALIAS(DGI)=$E(DGALIAS(DGI),1,31)
"RTN","DGRP1",58,0)
 .Q
"RTN","DGRP1",59,0)
 ;Display name component, sex,  and alias data
"RTN","DGRP1",60,0)
 F DGI=1:1:6 D
"RTN","DGRP1",61,0)
 .W !?5,$J($P(DGNC,U,DGI),6),": ",$E($G(DGCOMP(20,DGCOMP,DGI)),1,$S(DGI=1:23,1:27))
"RTN","DGRP1",62,0)
 .I DGI=1 S (Z,DGRPW)=1 W ?43,"Sex: " S X=$P(DGRP(0),"^",2),Z=$S(X="M":"MALE",X="F":"FEMALE",1:DGRPU),Z1=31 D WW1^DGRPV
"RTN","DGRP1",63,0)
 .I DGI=2 S DGRPW=0,Z=2 W ?37 D WW^DGRPV W " Alias: "
"RTN","DGRP1",64,0)
 .I DGI>1 W ?48,$G(DGALIAS(DGI-1))
"RTN","DGRP1",65,0)
 .Q
"RTN","DGRP1",66,0)
 Q
"RTN","DGRP2")
0^2^B10969747
"RTN","DGRP2",1,0)
DGRP2 ;ALB/MRL - REGISTRATION SCREEN 2/CONTACT INFORMATION ;06 JUN 88@2300
"RTN","DGRP2",2,0)
 ;;5.3;Registration;**415,545,638**;Aug 13, 1993
"RTN","DGRP2",3,0)
 S DGRPS=2 D H^DGRPU F I=0,.24,57,1010.15 S DGRP(I)=$S($D(^DPT(DFN,I)):^(I),1:"")
"RTN","DGRP2",4,0)
 S DGRPX=DGRP(0)
"RTN","DGRP2",5,0)
 S (Z,DGRPW)=1 D WW^DGRPV W "  Marital: " S Z=$S($D(^DIC(11,+$P(DGRPX,"^",5),0)):$E($P(^(0),"^",1),1,28),1:DGRPU),Z1=30 D WW1^DGRPV
"RTN","DGRP2",6,0)
 ;S (Z,DGRPW)=1 D WW^DGRPV W "     Sex: " S X=$P(DGRP(0),"^",2),Z=$S(X="M":"MALE",X="F":"FEMALE",1:DGRPU),Z1=31 D WW1^DGRPV
"RTN","DGRP2",7,0)
 S DGD=$$DISP^DG1010P0(DGRP(0),11,0,1),DGNOCITY=DGUNK,DGD1=$$POINT^DG1010P0(DGRP(0),12,5,1,0,1)
"RTN","DGRP2",8,0)
 W ?41,"POB: ",$E($S((DGNOCITY&DGUNK):"UNANSWERED",1:DGD_$S(($L(DGD)):", ",1:"")_DGD1),1,29)
"RTN","DGRP2",9,0)
 ;S DGRPX=DGRP(0)
"RTN","DGRP2",10,0)
 W !?4,"Religion: ",$S($D(^DIC(13,+$P(DGRPX,"^",8),0)):$P(^(0),"^",1),1:DGRPU),?41,"Father: ",$S($P(DGRP(.24),"^",1)]"":$E($P(DGRP(.24),"^",1),1,29),1:DGRPU)
"RTN","DGRP2",11,0)
 S X=$P(DGRP(57),"^",4),X=$S(X']"":DGRPU,X="X":"NOT APPLICABLE",X=1:"PARA,",X=2:"QUAD,",X=3:"PARA,NON",1:"QUAD,NON"),X=$S("QD"[$E(X):X_"TRAUMATIC",1:X) W !?9,"SCI: ",X
"RTN","DGRP2",12,0)
 W ?41,"Mother: ",$S($P(DGRP(.24),"^",2)]"":$E($P(DGRP(.24),"^",2),1,29),1:DGRPU)
"RTN","DGRP2",13,0)
 W !,?35,"Mom's Maiden: ",$S($P(DGRP(.24),"^",3)]"":$E($P(DGRP(.24),"^",3),1,29),1:DGRPU)
"RTN","DGRP2",14,0)
 W ! S Z=2 D WW^DGRPV W " Previous Care Date      Location of Previous Care",!?4,"------------------      -------------------------" S DGRPX=DGRP(1010.15) I $P(DGRPX,"^",5)'="Y" S X="NONE INDICATED" W !?4,X,?28,X
"RTN","DGRP2",15,0)
 E  F I=1:1:4 S I1=$P(DGRPX,"^",I) X "I I#2 S Y=I1 X:Y]"""" ^DD(""DD"") W !?4,$S(Y]"""":Y,1:DGRPU)" I '(I#2) W ?28,$S($D(^DIC(4,+I1,0)):$P(^(0),"^",1),1:DGRPU)
"RTN","DGRP2",16,0)
 W ! S Z=3 D WW^DGRPV W " Ethnicity: " D
"RTN","DGRP2",17,0)
 .I '$O(^DPT(DFN,.06,0)) W "UNANSWERED" Q
"RTN","DGRP2",18,0)
 .N NODE,NUM,ETHNIC
"RTN","DGRP2",19,0)
 .S I=0
"RTN","DGRP2",20,0)
 .F NUM=0:1 S I=+$O(^DPT(DFN,.06,I)) Q:'I  D
"RTN","DGRP2",21,0)
 ..S NODE=$G(^DPT(DFN,.06,I,0))
"RTN","DGRP2",22,0)
 ..S X=$P($G(^DIC(10.2,+NODE,0)),"^",1)
"RTN","DGRP2",23,0)
 ..S ETHNIC=$S(X="":"?????",1:X)
"RTN","DGRP2",24,0)
 ..S X=$P($G(^DIC(10.3,+$P(NODE,"^",2),0)),"^",2)
"RTN","DGRP2",25,0)
 ..S ETHNIC=ETHNIC_" ("_$S(X="":"?",1:X)_")"
"RTN","DGRP2",26,0)
 ..I NUM S ETHNIC=", "_ETHNIC
"RTN","DGRP2",27,0)
 ..I ($X+$L(ETHNIC))>IOM D  W !?15
"RTN","DGRP2",28,0)
 ...F  S X=$P(ETHNIC," ",1)_" " Q:($X+$L(X))>IOM  W X S ETHNIC=$P(ETHNIC," ",2,999)
"RTN","DGRP2",29,0)
 ..W ETHNIC
"RTN","DGRP2",30,0)
 W !?9,"Race: " D
"RTN","DGRP2",31,0)
 .I '$O(^DPT(DFN,.02,0)) W "UNANSWERED" Q
"RTN","DGRP2",32,0)
 .N NODE,NUM,RACE
"RTN","DGRP2",33,0)
 .S I=0
"RTN","DGRP2",34,0)
 .F NUM=0:1 S I=+$O(^DPT(DFN,.02,I)) Q:'I  D
"RTN","DGRP2",35,0)
 ..S NODE=$G(^DPT(DFN,.02,I,0))
"RTN","DGRP2",36,0)
 ..S X=$P($G(^DIC(10,+NODE,0)),"^",1)
"RTN","DGRP2",37,0)
 ..S RACE=$S(X="":"?????",1:X)
"RTN","DGRP2",38,0)
 ..S X=$P($G(^DIC(10.3,+$P(NODE,"^",2),0)),"^",2)
"RTN","DGRP2",39,0)
 ..S RACE=RACE_" ("_$S(X="":"?",1:X)_")"
"RTN","DGRP2",40,0)
 ..I NUM S RACE=", "_RACE
"RTN","DGRP2",41,0)
 ..I ($X+$L(RACE))>IOM D  W !?15
"RTN","DGRP2",42,0)
 ...F  S X=$P(RACE," ",1)_" " Q:($X+$L(X))>IOM  W X S RACE=$P(RACE," ",2,999)
"RTN","DGRP2",43,0)
 ..W RACE
"RTN","DGRP2",44,0)
 D GETS^DIQ(2,DFN_",",".351;.353;.354;.355","E","PDTHINFO")
"RTN","DGRP2",45,0)
 W !!
"RTN","DGRP2",46,0)
 W "<4> Date of Death Information"
"RTN","DGRP2",47,0)
 W !,?5,"Date of Death: ",$G(PDTHINFO(2,DFN_",",.351,"E"))
"RTN","DGRP2",48,0)
 W !,?5,"Date of Death Source of Notification: ",$G(PDTHINFO(2,DFN_",",.353,"E"))
"RTN","DGRP2",49,0)
 W !,?5,"Date of Death Last Updated Date/Time: ",$G(PDTHINFO(2,DFN_",",.354,"E"))
"RTN","DGRP2",50,0)
 W !,?5,"Date of Death Last Edited By: ",$G(PDTHINFO(2,DFN_",",.355,"E")),!
"RTN","DGRP2",51,0)
 K PDTHINFO
"RTN","DGRP2",52,0)
 G ^DGRPP
"RTN","DGRPE")
0^3^B45879875
"RTN","DGRPE",1,0)
DGRPE ;ALB/MRL,LBD - REGISTRATIONS EDITS ; 11/19/03 10:53am
"RTN","DGRPE",2,0)
 ;;5.3;Registration;**32,114,139,169,175,247,190,343,397,342,454,415,489,506,244,547,522,528,555,508,451,626,638**;Aug 13, 1993
"RTN","DGRPE",3,0)
 ;
"RTN","DGRPE",4,0)
 ;DGDR contains a string of edits; edit=screen*10+item #
"RTN","DGRPE",5,0)
 ;
"RTN","DGRPE",6,0)
 ;line tag screen*10+item*1000 = continuation line
"RTN","DGRPE",7,0)
 ;
"RTN","DGRPE",8,0)
 I DGRPS=1,DGDR["101," D CEDITS^DGRPECE(DFN)
"RTN","DGRPE",9,0)
 I DGRPS=8 D ^DGRPEIS,Q Q  ; family demographic edit...not conventional!!  :)
"RTN","DGRPE",10,0)
 I DGRPS=9 D EDIT9^DGRPEIS2,Q Q  ; income screening data ($$$)
"RTN","DGRPE",11,0)
 I DGRPS=5,DGDR["501," D
"RTN","DGRPE",12,0)
 .I $G(DGPRFLG) D PREG^IBCNBME(DFN) Q
"RTN","DGRPE",13,0)
 .D REG^IBCNBME(DFN)
"RTN","DGRPE",14,0)
 .Q
"RTN","DGRPE",15,0)
 ;-- Tricare screen #15
"RTN","DGRPE",16,0)
 I DGRPS=15 D EDIT^DGRP15,Q Q
"RTN","DGRPE",17,0)
 ;
"RTN","DGRPE",18,0)
 N DGPH,DGPHFLG
"RTN","DGRPE",19,0)
 K DR S (DA,Y)=DFN,DIE="^DPT(",DR="",DGDRS="DR",DGCT=0 G ^DGRPE1:DGRPS>6
"RTN","DGRPE",20,0)
 F I=1:1 S J=$P(DGDR,",",I) Q:J=""  F J1=J,J*1000,J*1000+1,J*1000+2 Q:'$T(@J1)  S DGDRD=$P($T(@J1),";;",2) D S
"RTN","DGRPE",21,0)
 D ^DIE
"RTN","DGRPE",22,0)
 ;check for Combat Vet status
"RTN","DGRPE",23,0)
 I $G(DGCVFLG)=1,($P($$CVEDT^DGCV(DFN),U,2)']"") D
"RTN","DGRPE",24,0)
 . W !!,"**NOTE-Change(s) made in this session deleted the veteran's Combat Vet status!"
"RTN","DGRPE",25,0)
 . S DIR(0)="EA" D ^DIR K DIR
"RTN","DGRPE",26,0)
 I $G(DGPHFLG)>0 D EDITPH1^DGRPLE()
"RTN","DGRPE",27,0)
Q K DA,DIE,DR,DGCT,DGCVFLG,DGDR,DGDRD,DGDRS,DGRPADI,I,J,J1,DGCOMLOC
"RTN","DGRPE",28,0)
 Q
"RTN","DGRPE",29,0)
S I $L(@DGDRS)+$L(DGDRD)<241 S @DGDRS=@DGDRS_DGDRD Q
"RTN","DGRPE",30,0)
 S DGCT=DGCT+1,DGDRS="DR(1,2,"_DGCT_")",@DGDRS=DGDRD Q
"RTN","DGRPE",31,0)
 Q
"RTN","DGRPE",32,0)
101 ;;
"RTN","DGRPE",33,0)
102 ;;1;
"RTN","DGRPE",34,0)
103 ;;.091;
"RTN","DGRPE",35,0)
104 ;;N FLG S (FLG(1),FLG(2))=1 D EN^DGREGAED(DFN,.FLG);
"RTN","DGRPE",36,0)
105 ;;.12105//NO;S:X="N" Y="@15" S:X="Y" DIE("NO^")="";.1217;I X']"" W !?4,$C(7),"But I need a Start Date for this Temporary Address." S Y=.12105;.1218;.1211;I X']"" W !?4,$C(7),"But I need at least one line of a Temporary address." S Y=.12105;
"RTN","DGRPE",37,0)
111 ;;.14105//NO;S:X="N" Y="@111" S:X="Y" DIE("NO^")="";.1417;I X']"" W !?4,$C(7),"But I need a Start Date." S Y=.14105;.1418;D DR111^DGRPE;.141;I '$P($$CAACT^DGRPCADD(DFN),U,2) W !?4,"But I need at least one active category." S Y=.14105;
"RTN","DGRPE",38,0)
111000 ;;K DR(2,2.141);.1411;I X']"" W !?4,$C(7),"I need at least one line of Address." S Y=.14105;.1412;S:X']"" Y=.1414;.1413;.1414;.1415;.1416;Q;.14111;@111;K DIE("NO^");
"RTN","DGRPE",39,0)
109 ;;N FLG S (FLG(1),FLG(2))=1 D EN^DGREGAED(DFN,.FLG);.02;D DR109^DGRPE;6;2;K DR(2,2.02),DR(2,2.06);.05;.08;K DIE("NO^");
"RTN","DGRPE",40,0)
105000 ;;.1212;S:X']"" Y=.1214;.1213:.1215;.12112;Q;.12111;.1219;@15;K DIE("NO^");
"RTN","DGRPE",41,0)
201 ;;.05;.08;.092;.093;.2401:.2403;57.4//NOT APPLICABLE;
"RTN","DGRPE",42,0)
202 ;;1010.15//NO;S:X'="Y" Y="@22";S DIE("NO^")="";1010.152;I X']"" W !?4,*7,"But I need to know where you were treated most recently." S Y=1010.15;1010.151;1010.154;S:X']"" Y="@22";1010.153;@22;K DIE("NO^");
"RTN","DGRPE",43,0)
203 ;;D DR203^DGRPE;6ETHNICITY;2RACE;K DR(2,2.02),DR(2,2.06);
"RTN","DGRPE",44,0)
301 ;;.211;S:X']"" Y="@31";.212;.2125//NO;I X="Y" S DGADD=".21" D AD^DGRPE S Y=.21011;.213;S:X']"" Y=.216;.214;S:X']"" Y=.216;.215:.217;.2207;.219;.21011;@31;
"RTN","DGRPE",45,0)
302 ;;.2191;S:X']"" Y="@32";.2192;.21925//NO;I X="Y" S DGADD=".211" D AD^DGRPE S Y=.211011;
"RTN","DGRPE",46,0)
302000 ;;.2193;S:X']"" Y=.2196;.2194;S:X']"" Y=.2196;.2195:.2197;.2203;.2199;.211011;@32;
"RTN","DGRPE",47,0)
303 ;;N DGX1,DGX2;I '$L($P($G(^DPT(DFN,.21)),U)) S Y="@33";.3305//NO;I X="Y" S Y="@34",DGX1=1;@33;S:$D(^DPT(DFN,.22)) $P(^(.22),U,1)=$P(^(.22),U,7);.331;S:X']"" DGX1=2,Y="@34";.332;@34;
"RTN","DGRPE",48,0)
303000 ;;S:$G(DGX1) Y="@341";.333;S:X']"" Y=.336;.334;S:X']"" Y=.336;.335:.337;.2201;.339;.33011;S DGX1=2;@341;
"RTN","DGRPE",49,0)
303001 ;;S:$G(DGX1)=2 Y="@35";S DGX2=$G(^DPT(DA,.21));.331///^S X=$P(DGX2,U);.332///^S X=$P(DGX2,U,2);.333////^S X=$P(DGX2,U,3);.334///^S X=$P(DGX2,U,4);@35;
"RTN","DGRPE",50,0)
303002 ;;S:$G(DGX1)=2 Y="@351";.335///^S X=$P(DGX2,U,5);.336///^S X=$P(DGX2,U,6);.337///^S X=$P(DGX2,U,7);.338///^S X=$P(DGX2,U,8);.339///^S X=$P(DGX2,U,9);.33011///^S X=$P(DGX2,U,11);@351;K DGX1,DGX2;
"RTN","DGRPE",51,0)
304 ;;.3311;S:X']"" Y="@36";.3312;.3313;S:X']"" Y=.3316;.3314;S:X']"" Y=.3316;.3315:.3317;.2204;.3319;.331011;@36;        
"RTN","DGRPE",52,0)
305 ;;N DGX1,DGX2;I '$L($P($G(^DPT(DFN,.21)),U)) S Y="@37";.3405//NO;I X="Y" S DGX1=1,Y="@371";@37;S:$D(^DPT(DFN,.22)) $P(^(.22),U,2)=$P(^(.22),U,7);.341;S:X']"" DGX1=2,Y="@371";.342;@371;
"RTN","DGRPE",53,0)
305000 ;;S:$G(DGX1) Y="@38";.343;S:X']"" Y=.346;.344;S:X']"" Y=.346;.345:.347;.2202;.349;.34011;S DGX1=2;@38;
"RTN","DGRPE",54,0)
305001 ;;S:$G(DGX1)=2 Y="@381";S DGX2=$G(^DPT(DA,.21));.341///^S X=$P(DGX2,U);.342///^S X=$P(DGX2,U,2);.343///^S X=$P(DGX2,U,3);.344///^S X=$P(DGX2,U,4);@381
"RTN","DGRPE",55,0)
305002 ;;S:$G(DGX1)=2 Y="@39";.345///^S X=$P(DGX2,U,5);.346///^S X=$P(DGX2,U,6);.347///^S X=$P(DGX2,U,7);.348///^S X=$P(DGX2,U,8);.349///^S X=$P(DGX2,U,9);.34011///^S X=$P(DGX2,U,11);@39;K DGX1,DGX2;
"RTN","DGRPE",56,0)
401 ;;.07;.31115;I $S(X']"":1,X=3:1,X=9:1,1:0) S Y="@41";.3111;S:X']"" Y="@41";.3113;S:X']"" Y=.3116;.3114;S:X']"" Y=.3116;.3115:.3117;.2205;.3119;@41;
"RTN","DGRPE",57,0)
402 ;;.2514;.2515;I $S(X']"":1,X=3:1,X=9:1,1:0) S Y="@42";.251;S:X']"" Y="@42";.252;S:X']"" Y=.255;.253;S:X']"" Y=.255;.254:.256;.2206;.258;@42;
"RTN","DGRPE",58,0)
501 ;;
"RTN","DGRPE",59,0)
502 ;;.381;.382///NOW;
"RTN","DGRPE",60,0)
503 ;;.383;
"RTN","DGRPE",61,0)
601 ;;.325;S:X']"" Y="@61";S:$$FV^DGRPMS(X)'=1 Y=".328";.3214;I X']"" W !?4,$C(7),"Proof is required for Filipino Vet." S Y=".325";.328;.326;.327;.324;
"RTN","DGRPE",62,0)
601000 ;;.3285//NO;S:X'="Y" Y="@61";.3291;S:X']"" Y="@61";S:$$FV^DGRPMS(X)'=1 Y=".3294";.3214;I X']"" W !?4,$C(7),"Proof is required for Filipino Vet." S Y=".3291";.3294;.3292;.3293;.329;
"RTN","DGRPE",63,0)
601001 ;;.32945//NO;S:X'="Y" Y="@61";.3296;S:X']"" Y="@61";S:$$FV^DGRPMS(X)'=1 Y=".3299";.3214;I X']"" W !?4,$C(7),"Proof is required for Filipino Vet." S Y=".3296";.3299;.3297;.3298;.3295;@61;
"RTN","DGRPE",64,0)
602 ;;.525//NO;S:X'="Y" Y="@62";.526:.528;@62;
"RTN","DGRPE",65,0)
603 ;;.5291//NO;S:X'="Y" Y="@63";.5292:.5294;@63;
"RTN","DGRPE",66,0)
604 ;;.32101//NO;S:X'="Y" Y="@64";.32104;.32105;@64;
"RTN","DGRPE",67,0)
605 ;;.32102//NO;S:X'="Y" Y="@65";.32107;.32109;.3211;.3213;@65;
"RTN","DGRPE",68,0)
606 ;;.32103//NO;S:X'="Y" Y="@66";.3212;.32111;@66;
"RTN","DGRPE",69,0)
607 ;;.3221//NO;S:X'="Y" Y="@67";.3222;Q;.3223;@67;
"RTN","DGRPE",70,0)
608 ;;.3224//NO;S:X'="Y" Y="@68";.3225;Q;.3226;@68;
"RTN","DGRPE",71,0)
609 ;;.3227//NO;S:X'="Y" Y="@69";.3228;Q;.3229;@69;
"RTN","DGRPE",72,0)
610 ;;.32201//NO;S:X'="Y" Y="@610";.322011;Q;.322012;@610;
"RTN","DGRPE",73,0)
611 ;;.322016//NO;S:X'="Y" Y="@611";.322017;Q;.322018;@611;
"RTN","DGRPE",74,0)
612 ;;.322013//NO;S:X'="Y" Y="@612";.322014;Q;.322015;@612;
"RTN","DGRPE",75,0)
613 ;;.362;
"RTN","DGRPE",76,0)
614 ;;.368//NO;.369//NO;I $S('$D(^DPT(DA,.36)):1,$P(^(.36),U,8)="Y"!($P(^(.36),U,9)="Y"):0,1:1) S Y="@614";.37;@614;
"RTN","DGRPE",77,0)
615 ;;.322019//NO;S:X'="Y" Y="@615";.32202;Q;.322021;@615;
"RTN","DGRPE",78,0)
616 ;;S DGPHFLG=0;.531;S:X'="Y" DGX=X,Y="@616";.532///^S X="PENDING";S Y="@6161";@616;S:DGX'="N" Y="@6162";.533///^S X="VAMC";@6161;S DGPHFLG=1;.535///^S X=$$DIV^DGRPLE();@6162;
"RTN","DGRPE",79,0)
617 ;;D REG^DGNTQ(DFN);
"RTN","DGRPE",80,0)
AD N DGZ4,DGPC
"RTN","DGRPE",81,0)
 S X=$S($D(^DPT(DA,.11)):^(.11),1:""),DGZ4=$P(X,U,12),DGPHONE=$S($D(^(.13)):$P(^(.13),U,1),1:""),Y=$S($D(^(DGADD)):^(DGADD),1:""),^(DGADD)=$P(Y,U,1)_U_$P(Y,U,2)_U_$P(X,U,1,6)_U_DGPHONE_U_$P(Y,U,10)
"RTN","DGRPE",82,0)
 I DGZ4 S DGPC=$S((DGADD=.33):1,(DGADD=.34):2,(DGADD=.211):3,(DGADD=.331):4,(DGADD=.311):5,(DGADD=.25):6,(DGADD=.21):7,1:0) S:DGPC $P(^DPT(DFN,.22),U,DGPC)=DGZ4
"RTN","DGRPE",83,0)
 K DGADD,DGPHONE Q
"RTN","DGRPE",84,0)
DR109 ;Drop through (use same logic as DR203)
"RTN","DGRPE",85,0)
DR203 S DR(2,2.02)=".01RACE;I $P($G(^DIC(10.3,+$P($G(^DPT(DA(1),.02,DA,0)),""^"",2),0)),""^"",2)=""S"" S Y=""@2031"";.02;@2031;"
"RTN","DGRPE",86,0)
 S DR(2,2.06)=".01ETHNICITY;I $P($G(^DIC(10.3,+$P($G(^DPT(DA(1),.06,DA,0)),""^"",2),0)),""^"",2)=""S"" S Y=""@2032"";.02;@2032;"
"RTN","DGRPE",87,0)
 Q
"RTN","DGRPE",88,0)
DR111 ;Set DR string for Confidential Address categories
"RTN","DGRPE",89,0)
 S DR(2,2.141)=".01;1//YES;"
"RTN","DGRPE",90,0)
 Q
"RTN","DGRPECE")
0^4^B25851474
"RTN","DGRPECE",1,0)
DGRPECE ;ALB/MRY - REGISTRATION CATASTROPHIC EDITS ; 11/16/04 9:00am
"RTN","DGRPECE",2,0)
 ;;5.3;Registration;**638**;Aug 13, 1993
"RTN","DGRPECE",3,0)
 ;
"RTN","DGRPECE",4,0)
CEDITS(DFN) ;catastrophic edits  - buffer values, save after check
"RTN","DGRPECE",5,0)
 ;Input;
"RTN","DGRPECE",6,0)
 ;  DFN  := patient ien
"RTN","DGRPECE",7,0)
 ;Catastrophic edits will prompt for name, ssn, dob, and sex.  Placing
"RTN","DGRPECE",8,0)
 ;responses into a buffer space.  User will be alerted on catastrophic
"RTN","DGRPECE",9,0)
 ;edits on the following conditions:
"RTN","DGRPECE",10,0)
 ; 1. Two or more catastrophic edits will generate a warning message.
"RTN","DGRPECE",11,0)
 ; 2. Acceptance of two or more catatrophic edits will generate an alert
"RTN","DGRPECE",12,0)
 ; to appropriate supervising staff holding the DG CATASTROPHIC EDIT key.
"RTN","DGRPECE",13,0)
 ; 3. Acceptance of <2 catatrophic edits will process normally.
"RTN","DGRPECE",14,0)
 ;
"RTN","DGRPECE",15,0)
 ; Arrays: BEFORE - Holds patient values before the edit process
"RTN","DGRPECE",16,0)
 ;                  (before snapshot).
"RTN","DGRPECE",17,0)
 ;         BUFFER - initialized with BEFORE array, holds edited changes
"RTN","DGRPECE",18,0)
 ;                  (after snapshot).
"RTN","DGRPECE",19,0)
 ;         SAVE   - holds only edited changes for filing into file #2.
"RTN","DGRPECE",20,0)
 ;
"RTN","DGRPECE",21,0)
 N DA,DIR,DIRUT,Y,BUFFER,BEFORE,SAVE
"RTN","DGRPECE",22,0)
 D BEFORE(DFN,.BEFORE,.BUFFER) ;retrieve before patient values
"RTN","DGRPECE",23,0)
 ;buffer - get name
"RTN","DGRPECE",24,0)
 K DG20NAME
"RTN","DGRPECE",25,0)
 S BUFFER("NAME")=$$NCEDIT^DPTNAME(DFN,,.DG20NAME)
"RTN","DGRPECE",26,0)
 I BUFFER("NAME")="" S BUFFER("NAME")=BEFORE("NAME")
"RTN","DGRPECE",27,0)
 I $D(DG20NAME("FAMILY")) S BUFFER("FAMILY")=DG20NAME("FAMILY")
"RTN","DGRPECE",28,0)
 I $D(DG20NAME("GIVEN")) S BUFFER("GIVEN")=DG20NAME("GIVEN")
"RTN","DGRPECE",29,0)
 K DG20NAME
"RTN","DGRPECE",30,0)
 ;buffer - get ssn
"RTN","DGRPECE",31,0)
 S DIR(0)="2,.09^^"
"RTN","DGRPECE",32,0)
 S DA=DFN D ^DIR
"RTN","DGRPECE",33,0)
 I $D(DIRUT) D CECHECK Q
"RTN","DGRPECE",34,0)
 S BUFFER("SSN")=Y
"RTN","DGRPECE",35,0)
 ;buffer - get dob
"RTN","DGRPECE",36,0)
 S DIR(0)="2,.03^^"
"RTN","DGRPECE",37,0)
 S DA=DFN D ^DIR
"RTN","DGRPECE",38,0)
 I $D(DIRUT) D CECHECK Q
"RTN","DGRPECE",39,0)
 S BUFFER("DOB")=Y
"RTN","DGRPECE",40,0)
 ;buffer - get sex
"RTN","DGRPECE",41,0)
 S DIR(0)="2,.02^^"
"RTN","DGRPECE",42,0)
 S DA=DFN D ^DIR
"RTN","DGRPECE",43,0)
 I $D(DIRUT) D CECHECK Q
"RTN","DGRPECE",44,0)
 S BUFFER("SEX")=Y
"RTN","DGRPECE",45,0)
 ;
"RTN","DGRPECE",46,0)
CECHECK ;do catastrophic edit checks, alert, and save
"RTN","DGRPECE",47,0)
 N DGCNT,DGCEFLG
"RTN","DGRPECE",48,0)
 ;Compare before/buffer arrays, putting edits into save array.
"RTN","DGRPECE",49,0)
 S DGCNT=$$AFTER(.BEFORE,.BUFFER,.SAVE)
"RTN","DGRPECE",50,0)
 ;   DGCNT:  0  = no changes
"RTN","DGRPECE",51,0)
 ;           1  = only one edit change, ok to save w/o CE message
"RTN","DGRPECE",52,0)
 ;           >1 = more then 1 edit, give CE message
"RTN","DGRPECE",53,0)
 I DGCNT>1 D  ;give CE message
"RTN","DGRPECE",54,0)
 . S DGCEFLG=$$WARNING()
"RTN","DGRPECE",55,0)
 . ;    DGCEFLG: 0  = exit without saving changes
"RTN","DGRPECE",56,0)
 . ;             1  = send alert and save
"RTN","DGRPECE",57,0)
 . I DGCEFLG=0 S DGCNT=0
"RTN","DGRPECE",58,0)
 I DGCNT>0 D SAVE(DFN) I $D(DGCEFLG),DGCEFLG D ALERT
"RTN","DGRPECE",59,0)
 Q
"RTN","DGRPECE",60,0)
 ;
"RTN","DGRPECE",61,0)
SAVE(DFN) ;store accepted/edited values into patient file
"RTN","DGRPECE",62,0)
 N FDATA,DIERR
"RTN","DGRPECE",63,0)
 I $D(SAVE("NAME")) S FDATA(2,+DFN_",",.01)=SAVE("NAME")
"RTN","DGRPECE",64,0)
 I $D(SAVE("DOB")) S FDATA(2,+DFN_",",.03)=SAVE("DOB")
"RTN","DGRPECE",65,0)
 I $D(SAVE("SEX")) S FDATA(2,+DFN_",",.02)=SAVE("SEX")
"RTN","DGRPECE",66,0)
 I $D(SAVE("SSN")) S FDATA(2,+DFN_",",.09)=SAVE("SSN")
"RTN","DGRPECE",67,0)
 D FILE^DIE("","FDATA","DIERR")
"RTN","DGRPECE",68,0)
 K FDATA,DIERR
"RTN","DGRPECE",69,0)
 Q
"RTN","DGRPECE",70,0)
 ;
"RTN","DGRPECE",71,0)
BEFORE(IEN,BEF,BUF) ;save original name, ssn, dob, sex
"RTN","DGRPECE",72,0)
 N DG20,DG20IEN
"RTN","DGRPECE",73,0)
 S BEF("NAME")=$$GET1^DIQ(2,+IEN_",",.01),BUF("NAME")=BEF("NAME")
"RTN","DGRPECE",74,0)
 S BEF("SSN")=$$GET1^DIQ(2,+IEN_",",.09),BUF("SSN")=BEF("SSN")
"RTN","DGRPECE",75,0)
 S BEF("DOB")=$$GET1^DIQ(2,+IEN_",",.03,"I"),BUF("DOB")=BEF("DOB")
"RTN","DGRPECE",76,0)
 S BEF("SEX")=$$GET1^DIQ(2,+IEN_",",.02,"I"),BUF("SEX")=BEF("SEX")
"RTN","DGRPECE",77,0)
 D GETS^DIQ(2,+IEN_",",1.01,"I","DG20")
"RTN","DGRPECE",78,0)
 S BEF("FAMILY")="",BEF("GIVEN")="",BUF("FAMILY")="",BUF("GIVEN")=""
"RTN","DGRPECE",79,0)
 S DG20IEN=DG20(2,+IEN_",",1.01,"I")
"RTN","DGRPECE",80,0)
 I $$GET1^DIQ(20,+DG20IEN_",",.03)[+IEN D
"RTN","DGRPECE",81,0)
 . S BEF("FAMILY")=$$GET1^DIQ(20,+DG20IEN_",",1),BUF("FAMILY")=BEF("FAMILY")
"RTN","DGRPECE",82,0)
 . S BEF("GIVEN")=$$GET1^DIQ(20,+DG20IEN_",",2),BUF("GIVEN")=BEF("GIVEN")
"RTN","DGRPECE",83,0)
 ;add some demographic information (before snapshot)
"RTN","DGRPECE",84,0)
 S BEF("MAIDEN")=$E($$GET1^DIQ(2,+IEN_",",.2403),1,17)
"RTN","DGRPECE",85,0)
 S BEF("POBCITY")=$E($$GET1^DIQ(2,+IEN_",",.092),1,15)
"RTN","DGRPECE",86,0)
 S BEF("POBSTATE")=$$GET1^DIQ(2,+IEN_",",.093,"I")
"RTN","DGRPECE",87,0)
 Q
"RTN","DGRPECE",88,0)
 ;
"RTN","DGRPECE",89,0)
AFTER(BEF,BUF,SAV) ;prevent catastrophic edit checks
"RTN","DGRPECE",90,0)
 N DGCNT,DG20CNT S (DGCNT,DG20CNT)=0
"RTN","DGRPECE",91,0)
 I $D(BUF("NAME")),BUF("NAME")'="",BUF("NAME")'=BEF("NAME") D
"RTN","DGRPECE",92,0)
 . S SAV("NAME")=BUF("NAME") ;minor name changes don't count
"RTN","DGRPECE",93,0)
 . I $D(BUF("FAMILY")),BUF("FAMILY")'=BEF("FAMILY") S DG20CNT=DG20CNT+1
"RTN","DGRPECE",94,0)
 . I $D(BUF("GIVEN")),BUF("GIVEN")'=BEF("GIVEN") S DG20CNT=DG20CNT+1
"RTN","DGRPECE",95,0)
 . I DG20CNT>0 S DGCNT=1
"RTN","DGRPECE",96,0)
 I $D(BUF("DOB")),BUF("DOB")'="",BUF("DOB")'=BEF("DOB") D
"RTN","DGRPECE",97,0)
 . S SAV("DOB")=BUF("DOB"),DGCNT=DGCNT+1
"RTN","DGRPECE",98,0)
 I $D(BUF("SEX")),BUF("SEX")'="",BUF("SEX")'=BEF("SEX") D
"RTN","DGRPECE",99,0)
 . S SAV("SEX")=BUF("SEX"),DGCNT=DGCNT+1
"RTN","DGRPECE",100,0)
 I $D(BUF("SSN")),BUF("SSN")'="",BUF("SSN")'=BEF("SSN") D
"RTN","DGRPECE",101,0)
 . S SAV("SSN")=BUF("SSN"),DGCNT=DGCNT+1
"RTN","DGRPECE",102,0)
 I DGCNT=0,$D(SAV("NAME")) Q 1 ;minor name change (i.e. middle name)
"RTN","DGRPECE",103,0)
 I DGCNT=0 Q 0 ;no changes
"RTN","DGRPECE",104,0)
 I DGCNT<2 Q 1 ;make one change w/o alert
"RTN","DGRPECE",105,0)
 I DGCNT>1 Q 2 ;more then 1 change, send warning message
"RTN","DGRPECE",106,0)
 ;
"RTN","DGRPECE",107,0)
WARNING() ;CE warning message
"RTN","DGRPECE",108,0)
 ;Output     0  = exit without saving changes
"RTN","DGRPECE",109,0)
 ;           1  = send alert and save
"RTN","DGRPECE",110,0)
 W !!,?25,"**WARNING!!**"
"RTN","DGRPECE",111,0)
 W !!,"The edits you are about to make, may potentially change the identity of"
"RTN","DGRPECE",112,0)
 W !,"this patient.  Please verify that you have selected the correct patient"
"RTN","DGRPECE",113,0)
 W !,"and ensure that supporting documentation exists for these changes.  If"
"RTN","DGRPECE",114,0)
 W !,"you continue with these edits, an alert will be generated and sent to"
"RTN","DGRPECE",115,0)
 W !,"your Supervisor and ADPAC, notifying them of the changes."
"RTN","DGRPECE",116,0)
 N DIR,DGANS,Y
"RTN","DGRPECE",117,0)
 S DIR(0)="Y",DIR("A")="Do you wish to continue and save your edits:"
"RTN","DGRPECE",118,0)
 S DIR("B")="NO" D ^DIR K DIR S DGANS=Y
"RTN","DGRPECE",119,0)
 S DGANS=$S(Y=1:1,1:0) ;0=don't save, 1=save with CE alert
"RTN","DGRPECE",120,0)
 Q DGANS
"RTN","DGRPECE",121,0)
 ;
"RTN","DGRPECE",122,0)
ALERT ;Queue alert
"RTN","DGRPECE",123,0)
 X ^%ZOSF("UCI") S ZTUCI=Y,ZTRTN="ALERT^DGRPECE1",ZTDTH=$H,ZTIO="",IEN=DFN
"RTN","DGRPECE",124,0)
 F V="IEN","BEFORE(","BUFFER(","SAVE(","XQY" S ZTSAVE(V)=""
"RTN","DGRPECE",125,0)
 S ZTDESC="Patient Catastrophic Edits alert" K V,ZTSK N X D ^%ZTLOAD  Q
"RTN","DGRPECE",126,0)
 ;D ALERT^DGRPECE1(DFN,.BEFORE,.BUFFER,.SAVE)
"RTN","DGRPECE",127,0)
 Q
"RTN","DGRPECE1")
0^5^B29329791
"RTN","DGRPECE1",1,0)
DGRPECE1 ;ALB/MRY - REGISTRATION CATASTROPHIC EDITS ALERT ; 11/17/04 9:30am
"RTN","DGRPECE1",2,0)
 ;;5.3;Registration;**638**;Aug 13, 1993
"RTN","DGRPECE1",3,0)
 ;
"RTN","DGRPECE1",4,0)
ALERT ;setup alert, display
"RTN","DGRPECE1",5,0)
 K XQA,XQAMSG,XQAROU,XQAARCH,XQAID,XQADATA
"RTN","DGRPECE1",6,0)
 N DGSITE,DGDUZ,CNT,DGI
"RTN","DGRPECE1",7,0)
 ;XQA builds alert array.  XMY builds mailgroup array (if needed).
"RTN","DGRPECE1",8,0)
 S DGDUZ=0 F  S DGDUZ=$O(^XUSEC("DG CATASTROPHIC EDIT",DGDUZ)) Q:'DGDUZ  S XQA(DGDUZ)=""
"RTN","DGRPECE1",9,0)
 I $O(XQA(""))="" D
"RTN","DGRPECE1",10,0)
 . S DGDUZ=0 F  S DGDUZ=$O(^XUSEC("DG SUPERVISOR",DGDUZ)) Q:'DGDUZ  S XQA(DGDUZ)="",XMY(DGDUZ)=""
"RTN","DGRPECE1",11,0)
 . S XMY("G.MPIF EXCEPTIONS")=""
"RTN","DGRPECE1",12,0)
 . D MSG
"RTN","DGRPECE1",13,0)
 I $O(XQA(""))="" Q  ;hard too believe no supervisors.
"RTN","DGRPECE1",14,0)
 S XQAMSG="POTENTIAL CATASTROPHIC EDIT OF PATIENT IDENTIFYING DATA"
"RTN","DGRPECE1",15,0)
 ;see below for XQADATA values
"RTN","DGRPECE1",16,0)
 S CNT=0 F DGI="NAME","SSN","DOB","SEX","MAIDEN","POBCITY","POBSTATE" S CNT=CNT+1 I $D(BEFORE(DGI)) S $P(XQADATA,U,CNT)=BEFORE(DGI)
"RTN","DGRPECE1",17,0)
 S CNT=7 F DGI="NAME","SSN","DOB","SEX" S CNT=CNT+1 I $D(BUFFER(DGI)) S $P(XQADATA,U,CNT)=BUFFER(DGI) I $D(SAVE(DGI)) S $P(XQADATA,U,CNT)=$P(XQADATA,U,CNT)_";*"
"RTN","DGRPECE1",18,0)
 S $P(XQADATA,U,12)=IEN,DGSITE=$$SITE^VASITE(),DGSITE=$P(DGSITE,U,3)
"RTN","DGRPECE1",19,0)
 S $P(XQADATA,U,13)=DGSITE,$P(XQADATA,U,14)=XQY ;XQY = users current option (pointer)
"RTN","DGRPECE1",20,0)
 S XQAROU="DISP^DGRPECE1",XQAARCH=365
"RTN","DGRPECE1",21,0)
 S XQAID="DG,"_IEN
"RTN","DGRPECE1",22,0)
 D SETUP^XQALERT Q
"RTN","DGRPECE1",23,0)
 ;
"RTN","DGRPECE1",24,0)
DISP ;display catastrophic alert information
"RTN","DGRPECE1",25,0)
 N DGNAME,DGIEN,DGDATA,Y,HDR,HDR1,HDR2,DGRFLG
"RTN","DGRPECE1",26,0)
 K XQAKILL ; Keep alert, unless removed (XQAKILL=1 below)
"RTN","DGRPECE1",27,0)
 S DGIEN=$O(^XTV(8992.1,"B",XQAID,""))
"RTN","DGRPECE1",28,0)
 W @IOF ;W !!,$TR($J("",IOM)," ","=")
"RTN","DGRPECE1",29,0)
 S HDR=" <POTENTIAL CATASTROPHIC EDIT OF PATIENT IDENTIFYING DATA> "
"RTN","DGRPECE1",30,0)
 S HDR1=$TR($J("",(IOM/2-($L(HDR)/2)))," ","=")_HDR,HDR2=HDR1_$TR($J("",(IOM-$L(HDR1)))," ","=")
"RTN","DGRPECE1",31,0)
 W !,HDR2 ;W !,?(IOM-$L(HDR)/2),HDR
"RTN","DGRPECE1",32,0)
 S DGNAME=$P($P(XQADATA,U,8),";")
"RTN","DGRPECE1",33,0)
 W !,"Patient: ",DGNAME_" (ICN:"_$$GETICN^MPIF001($P(XQADATA,U,12))_")",?60,"Station: ",$P(XQADATA,U,13)
"RTN","DGRPECE1",34,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","DGRPECE1",35,0)
 W !,"Patient Identification fields (before edit)"
"RTN","DGRPECE1",36,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","DGRPECE1",37,0)
 W !?1,"Name: ",$P(XQADATA,U),?45,"Soc. Security Number: ",$P(XQADATA,U,2)
"RTN","DGRPECE1",38,0)
 W !?1,"Date of Birth: ",$$DATE4($P(XQADATA,U,3)),?45,"Gender: ",$S($P(XQADATA,U,4)="M":"MALE",$P(XQADATA,U,4)="F":"FEMALE",1:"")
"RTN","DGRPECE1",39,0)
 W !?1,"Mother's Maiden Name: ",$P(XQADATA,U,5)
"RTN","DGRPECE1",40,0)
 W !?1,"Place of Birth [city]: ",$P(XQADATA,U,6)
"RTN","DGRPECE1",41,0)
 W !?1,"Place of Birth [state]: " I $P(XQADATA,U,7) W $P(^DIC(5,$P(XQADATA,U,7),0),U)
"RTN","DGRPECE1",42,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","DGRPECE1",43,0)
 W !,"Patient Identification fields (after edit)"
"RTN","DGRPECE1",44,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","DGRPECE1",45,0)
 W ! W:$P($P(XQADATA,U,8),";",2)="*" "*" W ?1,"Name: ",$P($P(XQADATA,U,8),";") W ?44 W:$P($P(XQADATA,U,9),";",2)="*" "*" W ?45,"Soc. Security Number: ",$P($P(XQADATA,U,9),";")
"RTN","DGRPECE1",46,0)
 W ! W:$P($P(XQADATA,U,10),";",2)="*" "*" W ?1,"Date of Birth: ",$$DATE4($P($P(XQADATA,U,10),";"))
"RTN","DGRPECE1",47,0)
 W ?44 W:$P($P(XQADATA,U,11),";",2)="*" "*" W ?45,"Gender: ",$S($P($P(XQADATA,U,11),";")="M":"MALE",$P($P(XQADATA,U,11),";")="F":"FEMALE",1:"")
"RTN","DGRPECE1",48,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","DGRPECE1",49,0)
 S DGDATA=$$GET1^DIQ(8992.1,+DGIEN_",",.02)
"RTN","DGRPECE1",50,0)
 W !,"Edited by:   ",$$GET1^DIQ(8992.1,+DGIEN_",",.05),?45,"Generated: ",$$FMTE^XLFDT(DGDATA,"2P")
"RTN","DGRPECE1",51,0)
 S DGDATA=$P(XQADATA,U,14),DGDATA=$$GET1^DIQ(19,+DGDATA_",",.01) ;option name
"RTN","DGRPECE1",52,0)
 W !,"With Option: ",DGDATA
"RTN","DGRPECE1",53,0)
 ;W !,$TR($J("",IOM)," ","-")
"RTN","DGRPECE1",54,0)
 S DGDATA=$$GET1^DIQ(8992.1,+DGIEN_",",2)
"RTN","DGRPECE1",55,0)
 W !,"Reviewed by: " W:$P(DGDATA,U,15) $P(^VA(200,$P(DGDATA,U,15),0),U)
"RTN","DGRPECE1",56,0)
 W:$P(DGDATA,U,15) ?45,"Catastrophic Edit: ",$S($P(DGDATA,U,16)=1:"YES",1:"NO")
"RTN","DGRPECE1",57,0)
 W !,$TR($J("",IOM)," ","-")
"RTN","DGRPECE1",58,0)
 ;CE reviewed?
"RTN","DGRPECE1",59,0)
 S DGRFLG=0 ;Review flag determine delete prompting
"RTN","DGRPECE1",60,0)
 I $P(DGDATA,U,15)="" D REVIEW S DGRFLG=1
"RTN","DGRPECE1",61,0)
 ;If CE reviewed, can the alert be removed?
"RTN","DGRPECE1",62,0)
 I $P(DGDATA,U,15) D REMOVE
"RTN","DGRPECE1",63,0)
 K XQAKILL
"RTN","DGRPECE1",64,0)
 Q
"RTN","DGRPECE1",65,0)
 ;
"RTN","DGRPECE1",66,0)
REVIEW ;
"RTN","DGRPECE1",67,0)
 N DGANS,DIR,DGCE
"RTN","DGRPECE1",68,0)
 S DIR(0)="Y",DIR("A")="IS REVIEW COMPLETE"
"RTN","DGRPECE1",69,0)
 S DIR("B")="NO" D ^DIR K DIR S DGANS=Y
"RTN","DGRPECE1",70,0)
 I DGANS=1 D
"RTN","DGRPECE1",71,0)
 . S DIR(0)="Y",DIR("A")="IS THIS ALERT DETERMINED TO BE A CATASTROPHIC EDIT"
"RTN","DGRPECE1",72,0)
 . S DIR("B")="NO" D ^DIR K DIR S DGCE=Y
"RTN","DGRPECE1",73,0)
 . N FDA
"RTN","DGRPECE1",74,0)
 . S $P(DGDATA,U,15)=DUZ
"RTN","DGRPECE1",75,0)
 . S $P(DGDATA,U,16)=DGCE
"RTN","DGRPECE1",76,0)
 . S FDA(8992.1,+DGIEN_",",2)=DGDATA
"RTN","DGRPECE1",77,0)
 . D FILE^DIE("","FDA","DIERR")
"RTN","DGRPECE1",78,0)
 Q
"RTN","DGRPECE1",79,0)
REMOVE ;
"RTN","DGRPECE1",80,0)
 N Y,DIR
"RTN","DGRPECE1",81,0)
 S DIR(0)="Y"
"RTN","DGRPECE1",82,0)
 S:DGRFLG=1 DIR("A")="DO YOU WANT TO DELETE ALERT"
"RTN","DGRPECE1",83,0)
 S:DGRFLG=0 DIR("A")="THIS ALERT HAS BEEN REVIEWED, DO YOU WANT TO DELETE THE ALERT"
"RTN","DGRPECE1",84,0)
 S DIR("B")="NO" D ^DIR K DIR
"RTN","DGRPECE1",85,0)
 I Y=1 S XQAKILL=1 D DELETE^XQALERT ;keep renewed, unless reviewed
"RTN","DGRPECE1",86,0)
 Q
"RTN","DGRPECE1",87,0)
MSG ;
"RTN","DGRPECE1",88,0)
 K ^TMP($J,"DGRPECE")
"RTN","DGRPECE1",89,0)
 S XMDUZ=.5,XMSUB="POTENTIAL CATASTROPHIC EDIT ALERT SETUP"
"RTN","DGRPECE1",90,0)
 S ^TMP($J,"DGRPECE",1,0)="ATTENTION ADT SUPERVISORS:"
"RTN","DGRPECE1",91,0)
 S ^TMP($J,"DGRPECE",2,0)=" "
"RTN","DGRPECE1",92,0)
 S ^TMP($J,"DGRPECE",3,0)="You are receiving this message along with a potential catastrophic edit alert"
"RTN","DGRPECE1",93,0)
 S ^TMP($J,"DGRPECE",4,0)="because there are no users holding the DG CATASTROPHIC EDIT key."
"RTN","DGRPECE1",94,0)
 S ^TMP($J,"DGRPECE",5,0)=" "
"RTN","DGRPECE1",95,0)
 S ^TMP($J,"DGRPECE",6,0)="Please see that an appropriate Supervisor and ADPAC are given this key."
"RTN","DGRPECE1",96,0)
 S ^TMP($J,"DGRPECE",7,0)="Documentation on these catastrophic edits can be found in patch DG*5.3*638."
"RTN","DGRPECE1",97,0)
 S ^TMP($J,"DGRPECE",8,0)=" "
"RTN","DGRPECE1",98,0)
 S ^TMP($J,"DGRPECE",9,0)="This message has been forwarded to the National Data Quality mailgroup."
"RTN","DGRPECE1",99,0)
 S ^TMP($J,"DGRPECE",10,0)="Station name: "_$P($$SITE^VASITE(),U,2)_" ("_$P($$SITE^VASITE(),U)_")"
"RTN","DGRPECE1",100,0)
 S XMTEXT="^TMP("_$J_",""DGRPECE""," D ^XMD S DA=XMZ,DIE=3.9,DR="1.7///P;1.97///Y" D ^DIE
"RTN","DGRPECE1",101,0)
 K ^TMP($J,"DGRPECE"),DIE,DA,DR,XMY,XMDUZ,XMSUB,XMTEXT,XMZ Q
"RTN","DGRPECE1",102,0)
DATE4(X) ;return date in DD/MM/YYYY format
"RTN","DGRPECE1",103,0)
 S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_(1700+$E(X,1,3))
"RTN","DGRPECE1",104,0)
 Q X
"RTN","DGRPECE1",105,0)
 ;
"RTN","DGRPECE1",106,0)
XQADATA ;XQADATA =
"RTN","DGRPECE1",107,0)
 ;1=before snapshot name^                  (31 chars = 30 chars+'^')
"RTN","DGRPECE1",108,0)
 ;2=before snapshot ssn^                   (11)
"RTN","DGRPECE1",109,0)
 ;3=before snapshot dob^                   ( 8)
"RTN","DGRPECE1",110,0)
 ;4=before snapshot sex^                   ( 2)
"RTN","DGRPECE1",111,0)
 ;5=before snapshot mother's maiden name^  (18)
"RTN","DGRPECE1",112,0)
 ;6=before snapshot pob city^              (16)
"RTN","DGRPECE1",113,0)
 ;7=before snapshot pob state^             ( 3) a guess, its a pointer
"RTN","DGRPECE1",114,0)
 ;8=after snapshot name^                   (31)
"RTN","DGRPECE1",115,0)
 ;9=after snapshot ssn^                    (11)
"RTN","DGRPECE1",116,0)
 ;10=after snapshot dob^                   ( 8)
"RTN","DGRPECE1",117,0)
 ;11=after snapshot sex^                   ( 2)
"RTN","DGRPECE1",118,0)
 ;12=patient ien^                          (11) a guess, its a pointer
"RTN","DGRPECE1",119,0)
 ;13=station#^                             ( 6) a guess, its a pointer
"RTN","DGRPECE1",120,0)
 ;14=user menu pointer^                    ( 5) a guess, its a pointer
"RTN","DGRPECE1",121,0)
 ;15=reviewer duz^                         (11) a guess, its a pointer
"RTN","DGRPECE1",122,0)
 ;16=CE edit (y/n)                         ( 2)
"RTN","DGRPECE1",123,0)
 ;                                 total = 176 chars.
"RTN","DGRPECE2")
0^7^B34049720
"RTN","DGRPECE2",1,0)
DGRPECE2 ;ALB/MRY - REGISTRATION CATASTROPHIC EDITS REPORT ; 11/16/04 9:00am
"RTN","DGRPECE2",2,0)
 ;;5.3;Registration;**638**;Aug 13, 1993
"RTN","DGRPECE2",3,0)
 ;
"RTN","DGRPECE2",4,0)
 N DIR,DGFMT,DGFMTD
"RTN","DGRPECE2",5,0)
FMT K DIR S DIR("A")="Select report format",DIR(0)="S^D:DETAILED;S:SUMMARY"
"RTN","DGRPECE2",6,0)
 S DIR("?",1)="DETAILED format allows the selected listing of all processed alerts, alerts"
"RTN","DGRPECE2",7,0)
 S DIR("?",2)="not reviewed, or alerts determined to be catastrophic alerts.  SUMMARY format"
"RTN","DGRPECE2",8,0)
 S DIR("?",3)="allows the cummulative totals of processed alerts, alerts reviewed, and alerts"
"RTN","DGRPECE2",9,0)
 S DIR("?")="determined to be catastrophic edits."
"RTN","DGRPECE2",10,0)
 S DIR("B")="SUMMARY" D ^DIR Q:$D(DIRUT)
"RTN","DGRPECE2",11,0)
 S DGFMT=Y,DGFMTD=""
"RTN","DGRPECE2",12,0)
 I DGFMT="D" D
"RTN","DGRPECE2",13,0)
 . K DIR S DIR("A")="Select detailed category",DIR(0)="S^1:ALL;2:NOT REVIEWED;3:CATASTROPHIC EDIT ONLY"
"RTN","DGRPECE2",14,0)
 . S DIR("?",1)="ALL category will display all alerts in unreviewed, reviewed catastrophic."
"RTN","DGRPECE2",15,0)
 . S DIR("?",2)="NOT REVIEWED will display all alerts that have not been reviewed."
"RTN","DGRPECE2",16,0)
 . S DIR("?",3)="CATASTROPHIC EDIT ONLY category will display those alerts that were deemed"
"RTN","DGRPECE2",17,0)
 . S DIR("?",4)="to be a catastrophic edit."
"RTN","DGRPECE2",18,0)
 . S DIR("B")="ALL" D ^DIR
"RTN","DGRPECE2",19,0)
 . S DGFMTD=Y
"RTN","DGRPECE2",20,0)
 ;
"RTN","DGRPECE2",21,0)
FDT W !!,"***CATASTROPHIC EDIT ALERTS ARE ONLY RETAINED FOR 365 DAYS.***"
"RTN","DGRPECE2",22,0)
FDT1 S %DT="AEPX",%DT("A")="Beginning Date: " D ^%DT I X=U!($D(DTOUT)) Q
"RTN","DGRPECE2",23,0)
 G:Y<1 FDT1 S DGS1=Y X ^DD("DD") S DGBEG=DGS1_U_Y
"RTN","DGRPECE2",24,0)
LDT W ! S %DT("A")="   Ending Date: " D ^%DT I X=U!($D(DTOUT)) Q
"RTN","DGRPECE2",25,0)
 I Y<$P(DGBEG,U) W !!,$C(7),"Ending date must be after beginning date!" G LDT
"RTN","DGRPECE2",26,0)
 S DGS1=Y X ^DD("DD") S DGEND=DGS1_U_Y
"RTN","DGRPECE2",27,0)
 S DGTAG=$S(DGFMT="S":"SUMMARY",1:"DETAIL")
"RTN","DGRPECE2",28,0)
 S DGVAR="DGBEG^DGEND^DGFMT^DGFMTD",DGPGM="START^DGRPECE2" W ! D ZIS^DGUTQ I 'POP U IO G START^DGRPECE2
"RTN","DGRPECE2",29,0)
 K %DT,DGBEG,DGEND,DGVAR,DGPGM,DGTAG,DGFMT,DGS1,DGFMTD,DIR,POP,X,Y D CLOSE^DGUTQ Q
"RTN","DGRPECE2",30,0)
 ;
"RTN","DGRPECE2",31,0)
START ;
"RTN","DGRPECE2",32,0)
 N DGICN,DGADT,DGIEN,DGDT,HDR,HDR2,HDRS,DGSDT,DGEDT,DGTA,DGTR,DGTC,DGPG,DGDATA,DIR,DGT,DGQUIT,XQAID,DGA
"RTN","DGRPECE2",33,0)
 D NOW^%DTC S Y=$E(%,1,12) S DGDT=$$FMTE^XLFDT(Y,1)
"RTN","DGRPECE2",34,0)
 S HDR="POTENTIAL CATASTROPHIC EDIT OF PATIENT IDENTIFYING DATA"
"RTN","DGRPECE2",35,0)
 I DGFMT="S" S HDR=HDR_" SUMMARY REPORT"
"RTN","DGRPECE2",36,0)
 I DGFMT="D" S HDR=HDR_" DETAILED REPORT"
"RTN","DGRPECE2",37,0)
 I DGFMT="D" S HDR2="(Category: "_$S(DGFMTD=1:"ALL",DGFMTD=2:"NOT REVIEWED",DGFMTD=3:"CATASTROPHIC EDITS",1:"")_")"
"RTN","DGRPECE2",38,0)
 ;
"RTN","DGRPECE2",39,0)
 S DGSDT=+DGBEG-.0001,DGEDT=+DGEND_.9999
"RTN","DGRPECE2",40,0)
 S (DGTA,DGTR,DGTC,DGPG)=0 K ^TMP($J,"DGRPECE")
"RTN","DGRPECE2",41,0)
 F  S DGSDT=$O(^XTV(8992.1,"D",DGSDT)) Q:'DGSDT!(DGSDT>DGEDT)  S DGIEN=0 F  S DGIEN=$O(^(DGSDT,DGIEN)) Q:'DGIEN  D
"RTN","DGRPECE2",42,0)
 . I $$GET1^DIQ(8992.1,+DGIEN_",",1.04)'="DGRPECE1" Q
"RTN","DGRPECE2",43,0)
 . S DGTA=DGTA+1
"RTN","DGRPECE2",44,0)
 . S DGDATA=$$GET1^DIQ(8992.1,+DGIEN_",",2)
"RTN","DGRPECE2",45,0)
 . S DGTR=DGTR+$S($P(DGDATA,U,15)'="":1,1:0)
"RTN","DGRPECE2",46,0)
 . S DGTC=DGTC+$S($P(DGDATA,U,16)=1:1,1:0)
"RTN","DGRPECE2",47,0)
 . S DGICN=$$GETICN^MPIF001($P($P(DGDATA,U,12),";"))
"RTN","DGRPECE2",48,0)
 . I DGFMTD=1 D
"RTN","DGRPECE2",49,0)
 .. S ^TMP($J,"DGRPECE",DGICN,DGSDT,+DGIEN)=""
"RTN","DGRPECE2",50,0)
 . I DGFMTD=2,$P(DGDATA,U,15)="" D
"RTN","DGRPECE2",51,0)
 .. S ^TMP($J,"DGRPECE",DGICN,DGSDT,+DGIEN)=""
"RTN","DGRPECE2",52,0)
 . I DGFMTD=3,$P(DGDATA,U,16)=1 D
"RTN","DGRPECE2",53,0)
 .. S ^TMP($J,"DGRPECE",DGICN,DGSDT,+DGIEN)=""
"RTN","DGRPECE2",54,0)
 ;
"RTN","DGRPECE2",55,0)
 D HEAD
"RTN","DGRPECE2",56,0)
SUMMARY ;print summary
"RTN","DGRPECE2",57,0)
 W !!,"TOTAL 'POTENTIAL CATASTROPHIC EDIT' ALERTS POSTED: ",DGTA
"RTN","DGRPECE2",58,0)
 W !,"TOTAL 'POTENTIAL CATASTROPHIC EDIT' ALERTS REVIEWED: ",DGTR
"RTN","DGRPECE2",59,0)
 W !,"TOTAL 'POTENTIAL CATASTROPHIC EDIT' ALERTS DETERMINED TO BE CATASTROPHIC: ",DGTC
"RTN","DGRPECE2",60,0)
 I $O(^TMP($J,"DGRPECE",""))=""!(DGFMT="S") D  G QUIT
"RTN","DGRPECE2",61,0)
 . K DIR I IOST?1"C-".E S DIR(0)="E" D ^DIR K DIR(0)
"RTN","DGRPECE2",62,0)
 ;
"RTN","DGRPECE2",63,0)
DETAIL ;Print detail
"RTN","DGRPECE2",64,0)
 W !!,$TR($J("",IOM)," ","*")
"RTN","DGRPECE2",65,0)
 S HDRS="***** <POTENTIAL CATASTROPHIC EDIT OF IDENTIFYING DATA> *****"
"RTN","DGRPECE2",66,0)
 W !?(IOM-$L(HDRS)/2),HDRS,!
"RTN","DGRPECE2",67,0)
 S DGICN=0 F  S DGICN=$O(^TMP($J,"DGRPECE",DGICN)) Q:DGICN=""  D  Q:DGQUIT
"RTN","DGRPECE2",68,0)
 . S DGADT=0 F  S DGADT=$O(^TMP($J,"DGRPECE",DGICN,DGADT)) Q:'DGADT  D  Q:DGQUIT
"RTN","DGRPECE2",69,0)
 .. S DGIEN=0 F  S DGIEN=$O(^TMP($J,"DGRPECE",DGICN,DGADT,DGIEN)) Q:'DGIEN  D  Q:DGQUIT
"RTN","DGRPECE2",70,0)
 ... S XQAID=$$GET1^DIQ(8992.1,+DGIEN_",",.01)
"RTN","DGRPECE2",71,0)
 ... D ALERTDAT^XQALBUTL(XQAID,"DGA")
"RTN","DGRPECE2",72,0)
 ... W ! D CHKL Q:DGQUIT
"RTN","DGRPECE2",73,0)
 ... W !,"Patient: "_$P($P(DGA(2),U,8),";")_" (ICN: "_DGICN_")",?60,"Station: ",$P(DGA(2),U,13) D CHKL Q:DGQUIT
"RTN","DGRPECE2",74,0)
 ... W !,$TR($J("",IOM)," ","-") D CHKL Q:DGQUIT
"RTN","DGRPECE2",75,0)
 ... W !?3,"Patient Identification (before edit)" D CHKL Q:DGQUIT
"RTN","DGRPECE2",76,0)
 ... W !?4,"Name: ",$P(DGA(2),U),?45,"Soc. Security Number: ",$P(DGA(2),U,2) D CHKL Q:DGQUIT
"RTN","DGRPECE2",77,0)
 ... W !?4,"Date of Birth: ",$$DATE4^DGRPECE1($P(DGA(2),U,3)),?45,"Gender: ",$S($P(DGA(2),U,4)="M":"MALE",$P(DGA(2),U,4)="F":"FEMALE",1:"") D CHKL Q:DGQUIT
"RTN","DGRPECE2",78,0)
 ... W !?4,"Mother's Maiden Name: ",$P(DGA(2),U,5) D CHKL Q:DGQUIT
"RTN","DGRPECE2",79,0)
 ... W !?4,"Place of Birth [city]: ",$P(DGA(2),U,6) D CHKL Q:DGQUIT
"RTN","DGRPECE2",80,0)
 ... W !?4,"Place of Birth [state]: " I $P(DGA(2),U,7) W $P(^DIC(5,$P(DGA(2),U,7),0),U) D CHKL Q:DGQUIT
"RTN","DGRPECE2",81,0)
 ... W ! D CHKL Q:DGQUIT
"RTN","DGRPECE2",82,0)
 ... W !?3,"Patient Identification fields (after edit)" D CHKL Q:DGQUIT
"RTN","DGRPECE2",83,0)
 ... W !?3 W:$P($P(DGA(2),U,8),";",2)="*" "*" W ?4,"Name: ",$P($P(DGA(2),U,8),";") W ?44 W:$P($P(DGA(2),U,9),";",2)="*" "*" W ?45,"Soc. Security Number: ",$P($P(DGA(2),U,9),";")
"RTN","DGRPECE2",84,0)
 ... D CHKL Q:DGQUIT
"RTN","DGRPECE2",85,0)
 ... W !?3 W:$P($P(DGA(2),U,10),";",2)="*" "*" W ?4,"Date of Birth: ",$$DATE4^DGRPECE1($P($P(DGA(2),U,10),";"))
"RTN","DGRPECE2",86,0)
 ... W ?44 W:$P($P(DGA(2),U,11),";",2)="*" "*" W ?45,"Gender: ",$S($P($P(DGA(2),U,11),";")="M":"MALE",$P($P(DGA(2),U,11),";")="F":"FEMALE",1:"")
"RTN","DGRPECE2",87,0)
 ... D CHKL Q:DGQUIT
"RTN","DGRPECE2",88,0)
 ... W ! D CHKL Q:DGQUIT
"RTN","DGRPECE2",89,0)
 ... W !?3,"Edited by:  ",$P(DGA(.05),U,2),?45,"Generated: ",$P(DGA(.02),U,2) D CHKL Q:DGQUIT
"RTN","DGRPECE2",90,0)
 ... W !?3,"With Option: ",$$GET1^DIQ(19,+$P(DGA(2),U,14)_",",.01) D CHKL Q:DGQUIT
"RTN","DGRPECE2",91,0)
 ... W !?3,"Reviewed by: " W:$P(DGA(2),U,15) $P(^VA(200,$P(DGA(2),U,15),0),U)
"RTN","DGRPECE2",92,0)
 ... W:$P(DGA(2),U,15) ?45,"Catastrophic Edit: ",$S($P(DGA(2),U,16)=1:"YES",1:"NO")
"RTN","DGRPECE2",93,0)
 ... D CHKL Q:DGQUIT
"RTN","DGRPECE2",94,0)
 ... W ! D CHKL Q:DGQUIT
"RTN","DGRPECE2",95,0)
QUIT K DIRUT,DTOUT D CLOSE^DGUTQ Q
"RTN","DGRPECE2",96,0)
 ;
"RTN","DGRPECE2",97,0)
HEAD S DGPG=DGPG+1 W @IOF,?(IOM-($L(DGDT)+7+$L(DGPG))),DGDT,"  PAGE ",DGPG,!
"RTN","DGRPECE2",98,0)
 W ?(IOM-$L(HDR)/2),HDR,!
"RTN","DGRPECE2",99,0)
 S DGT=$S(DGBEG=DGEND:"FOR ",1:"FROM ") S DGT=DGT_$$FMTE^XLFDT(DGBEG,"1D") I DGEND'=DGBEG S DGT=DGT_" TO "_$$FMTE^XLFDT(DGEND,"1D")
"RTN","DGRPECE2",100,0)
 W ?(IOM-$L(DGT)/2),DGT
"RTN","DGRPECE2",101,0)
 I $D(HDR2) W !?(IOM-$L(HDR2)/2),HDR2
"RTN","DGRPECE2",102,0)
 W !,$TR($J("",IOM-$X)," ","*") Q
"RTN","DGRPECE2",103,0)
CHKL S DGQUIT=0 I $Y>(IOSL-4) D RET:(IOST?1"C-".E) Q:DGQUIT  D HEAD
"RTN","DGRPECE2",104,0)
 Q
"RTN","DGRPECE2",105,0)
RET K DIR S DIR(0)="E" D ^DIR K DIR(0) I $D(DIRUT) S DGQUIT=1
"RTN","DGRPECE2",106,0)
 Q
"RTN","DGRPH")
0^8^B27007485
"RTN","DGRPH",1,0)
DGRPH ;ALB/MRL - REGISTRATION HELP ROUTINE ;06 JUN 88@2300
"RTN","DGRPH",2,0)
 ;;5.3;Registration;**114,343,397,415,489,545,638**;Aug 13, 1993
"RTN","DGRPH",3,0)
 S DGRPH="" D H^DGRPU K DGRPH W !,"Enter '^' to stop the display ",$S(DGRPV:"",1:"and edit "),"of data, '^N' to jump to screen #N (see",!,"listing below), <RET> to continue on to the next available screen" I DGRPV W "." G M
"RTN","DGRPH",4,0)
 W " or enter",!,"the field group number(s) you wish to edit using commas and dashes as",!,"delimiters.  Those groups enclosed in brackets ""[]"" are editable while those",!,"enclosed in arrows ""<>"" are not."
"RTN","DGRPH",5,0)
 W "  Enter 'ALL' to edit all editable data",!,"elements on the screen."
"RTN","DGRPH",6,0)
M I DGRPS=9,DGRPSEL="V" W !!,"You may precede your selection with 'V' to denote veteran."
"RTN","DGRPH",7,0)
 I DGRPS=9,DGRPSEL]"V" W !!,"To edit a specific column, enter 'V'",$S($D(DGREL("S")):", 'S'",1:""),$S($D(DGREL("D")):", 'D'",1:"")," in front of the selected items."
"RTN","DGRPH",8,0)
 S Z="DATA GROUPS ON SCREEN "_DGRPS,DGRPCM=1 W ! D WW^DGRPV S DGRPCM=0 D:DGRPS=1.1 A1 D:DGRPS'=1.1 @DGRPS D:$S(DGRPS<11:1,DGRPS=14:1,1:0) W D S W ! F I=$Y:1:20 W !
"RTN","DGRPH",9,0)
 ;S Z="Press RETURN key",DGRPCM=1 D WW^DGRPV S DGRPCM=0 W " to EXIT Screen ",DGRPS," HELP " R X:DTIME S X="" Q
"RTN","DGRPH",10,0)
 S DGRPW=0 W "Press " S Z="<RETURN>",DGRPCM=1 D WW^DGRPV W " KEY " S Z="TO EXIT" D WW^DGRPV W " SCREEN ",DGRPS," " S Z="HELP" D WW^DGRPV W " " R X:DTIME S (DGRPCM,DGRPW)=0 Q
"RTN","DGRPH",11,0)
1 S X="Name, SSN, DOB, Sex^Alias Name & SSN (if applicable)^Remarks concerning this patient^Home Address, Phone & Work Phone^Temporary Address, Dates, Phone" Q
"RTN","DGRPH",12,0)
A1 S X="Confidential Address,Dates and Types" Q
"RTN","DGRPH",13,0)
2 S X="POB, Parents, etc.^Dates/Locations of Previous Care^Race and Ethnicity^Date of Death Information" Q
"RTN","DGRPH",14,0)
3 S X="Primary Next-of-Kin^Secondary Next-of-Kin^Primary Emergency Contact^Secondary Emergency Contact^Designee to receive personal effects" Q
"RTN","DGRPH",15,0)
4 S X="Applicant Employer, Address^Spouses Employer, Address" Q
"RTN","DGRPH",16,0)
5 S X="Unexpired Insurance Policies^Eligibile for Medicaid" Q
"RTN","DGRPH",17,0)
6 S X="Service History^Prisoner of War^Combat^Vietnam Service^Agent Orange Exposure^IONizing Radiation Exposure^"
"RTN","DGRPH",18,0)
 S X=X_"Lebanon Service^Grenada Service^Panama Service^Persian Gulf Service^Somalia Service^Environmental Contaminants Exposure^Military Retirement/Disability^Dental History^Yugoslavia Service^Purple Heart Recipient^"
"RTN","DGRPH",19,0)
 S X=X_"Nose/Throat Radium Treatment"
"RTN","DGRPH",20,0)
 Q
"RTN","DGRPH",21,0)
7 S X="Patient Type, SC Data, Claim Info^VA Monetary Benefits^POS, Eligibility Code(s)^SC Conditions relayed by applicant" Q
"RTN","DGRPH",22,0)
8 S X="Spouse's Demographic Info^Dependents' Demographic Info" Q
"RTN","DGRPH",23,0)
9 S X="Social Security^U.S. Civil Service^U.S. Railroad Retirement^Military Retirement^Unemployment^Other Retirement^Total Employment Income^Interest,Dividend,Annuity^Workers Comp or Black Lung^Other Income" Q
"RTN","DGRPH",24,0)
10 S X="Ineligible Patient Information^Missing Patient Information" Q
"RTN","DGRPH",25,0)
11 S X="Eligibility Verification^Monetary Benefits Verification^Service Record Verification^Rated Disabilities (VA)" Q
"RTN","DGRPH",26,0)
12 W !,"Four most recent admission episodes on file for this applicant are displayed",!,"in inverse order." Q
"RTN","DGRPH",27,0)
13 W !,"Four most recent applications for care (registrations) are displayed in",!,"inverse order." Q
"RTN","DGRPH",28,0)
14 S X="Clinics in which actively enrolled^Pending (future) appointments" Q
"RTN","DGRPH",29,0)
15 W !,"Sponsor information is displayed for patients." Q
"RTN","DGRPH",30,0)
S W ! S Z="AVAILABLE SCREENS",DGRPCM=1 D WW^DGRPV S DGRPCM=0
"RTN","DGRPH",31,0)
 S X="Demographic^Confidential Address^Patient^Contact^Employment^Insurance^Service Record^Eligibility^Family Demographic^Income Screening^Missing/Ineligible^Eligibility Verification^"
"RTN","DGRPH",32,0)
 S X=X_"Admission Info^Application Info^Appointment Info^Sponsor Demograhics"
"RTN","DGRPH",33,0)
 ;S C=0 F I=1:1 S J=$P(X,"^",I) Q:J=""  I '$E(DGRPVV,I) S C=C+1,Z="^"_I,DGRPW=(C#2) D WW^DGRPV S Z=$S(I?1N:"  ",1:" ")_J_" Data",Z1=$S((C#2)&(I?1N):36,(C#2):35,1:1) D WW1^DGRPV:(C#2) I '(C#2) W Z
"RTN","DGRPH",34,0)
 N DGJ
"RTN","DGRPH",35,0)
 S DGJ=""
"RTN","DGRPH",36,0)
 S C=0 F I=1:1 S DGJ=$O(DGRPVV(DGJ)) Q:DGJ=""  I '$E(DGRPVV,DGJ) D
"RTN","DGRPH",37,0)
 .S C=C+1,Z="^"_DGJ,DGRPW=(C#2)
"RTN","DGRPH",38,0)
 .D WW^DGRPV
"RTN","DGRPH",39,0)
 .S Z1=$S((C#2)&(DGJ?1N):36,(C#2):35,1:1)
"RTN","DGRPH",40,0)
 .S Z=$S(DGJ?1N:"  ",1:" ")_$P(X,U,I)_" Data"
"RTN","DGRPH",41,0)
 .D WW1^DGRPV:(C#2)
"RTN","DGRPH",42,0)
 .I '(C#2) W Z
"RTN","DGRPH",43,0)
 Q
"RTN","DGRPH",44,0)
W F I=1:1 S J=$P(X,"^",I) Q:J=""  S Z=I,DGRPW=(I#2) D WW^DGRPV S Z=$S(I<10:"  ",1:" ")_J,Z1=$S((I#2)&(I>10):36,(I#2):37,1:1) D WW1^DGRPV
"RTN","DGRPH",45,0)
 W:'((I-1)#2) ! Q
"VER")
8.0^22
**END**
**END**
