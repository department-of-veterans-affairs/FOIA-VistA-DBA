Released XU*8*62 SEQ #53
Extracted from mail message
**KIDS**:XU*8.0*62^

**INSTALL NAME**
XU*8.0*62
"BLD",424,0)
XU*8.0*62^KERNEL^0^2970807^y
"BLD",424,1,0)
^^18^18^2970807^^^^
"BLD",424,1,1,0)
Enhancements to Unwinder routines (XQOR*) in support of CPRS 1.0
"BLD",424,1,2,0)
These enhancements include:
"BLD",424,1,3,0)
 
"BLD",424,1,4,0)
  1) A new parameter which may be passed to XQORM - XQORM("ALT")
"BLD",424,1,5,0)
     This allows the calling routine to supply an alternative lookup
"BLD",424,1,6,0)
     to be used if the user types something that does not appear on
"BLD",424,1,7,0)
     the menu.
"BLD",424,1,8,0)
 
"BLD",424,1,9,0)
  2) Fixed a bug that caused the menu to be exited if numeric ranges
"BLD",424,1,10,0)
     were allowed, the user erroneously entered something like 1-4B,
"BLD",424,1,11,0)
     and then typed a return at 'For entry 1-4B enter: ".
"BLD",424,1,12,0)
 
"BLD",424,1,13,0)
  3) Added "E" as a flag for XQORM(0).  It will allow ambiguous lookups
"BLD",424,1,14,0)
     to be resolved interactively when XQORM is called without XQORM(0)
"BLD",424,1,15,0)
     containing an "A".
"BLD",424,1,16,0)
 
"BLD",424,1,17,0)
  4) Made a change that sets full screen earlier when being called by
"BLD",424,1,18,0)
     list manager so that selection lists are properly displayed.
"BLD",424,4,0)
^9.64PA^^
"BLD",424,"KRN",0)
^9.67PA^19^18
"BLD",424,"KRN",.4,0)
.4
"BLD",424,"KRN",.401,0)
.401
"BLD",424,"KRN",.402,0)
.402
"BLD",424,"KRN",.403,0)
.403
"BLD",424,"KRN",.5,0)
.5
"BLD",424,"KRN",.84,0)
.84
"BLD",424,"KRN",3.6,0)
3.6
"BLD",424,"KRN",3.8,0)
3.8
"BLD",424,"KRN",9.2,0)
9.2
"BLD",424,"KRN",9.8,0)
9.8
"BLD",424,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",424,"KRN",9.8,"NM",1,0)
XQORM2^^0^B14189614
"BLD",424,"KRN",9.8,"NM",2,0)
XQORM3^^0^B9317503
"BLD",424,"KRN",9.8,"NM",3,0)
XQORM4^^0^B6389266
"BLD",424,"KRN",9.8,"NM",4,0)
XQOR4^^0^B7499848
"BLD",424,"KRN",9.8,"NM","B","XQOR4",4)

"BLD",424,"KRN",9.8,"NM","B","XQORM2",1)

"BLD",424,"KRN",9.8,"NM","B","XQORM3",2)

"BLD",424,"KRN",9.8,"NM","B","XQORM4",3)

"BLD",424,"KRN",19,0)
19
"BLD",424,"KRN",19.1,0)
19.1
"BLD",424,"KRN",101,0)
101
"BLD",424,"KRN",409.61,0)
409.61
"BLD",424,"KRN",771,0)
771
"BLD",424,"KRN",869.2,0)
869.2
"BLD",424,"KRN",870,0)
870
"BLD",424,"KRN",8994,0)
8994
"BLD",424,"KRN","B",.4,.4)

"BLD",424,"KRN","B",.401,.401)

"BLD",424,"KRN","B",.402,.402)

"BLD",424,"KRN","B",.403,.403)

"BLD",424,"KRN","B",.5,.5)

"BLD",424,"KRN","B",.84,.84)

"BLD",424,"KRN","B",3.6,3.6)

"BLD",424,"KRN","B",3.8,3.8)

"BLD",424,"KRN","B",9.2,9.2)

"BLD",424,"KRN","B",9.8,9.8)

"BLD",424,"KRN","B",19,19)

"BLD",424,"KRN","B",19.1,19.1)

"BLD",424,"KRN","B",101,101)

"BLD",424,"KRN","B",409.61,409.61)

"BLD",424,"KRN","B",771,771)

"BLD",424,"KRN","B",869.2,869.2)

"BLD",424,"KRN","B",870,870)

"BLD",424,"KRN","B",8994,8994)

"BLD",424,"QUES",0)
^9.62^^
"BLD",424,"REQB",0)
^9.611^^
"PKG",1,-1)
1^1
"PKG",1,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^XUDOCV7 NEW FEATURES
"PKG",1,22,0)
^9.49I^1^1
"PKG",1,22,1,0)
8.0^2950703^2950906^10
"PKG",1,22,1,"PAH",1,0)
62^2970807^1212
"PKG",1,22,1,"PAH",1,1,0)
^^18^18^2980107
"PKG",1,22,1,"PAH",1,1,1,0)
Enhancements to Unwinder routines (XQOR*) in support of CPRS 1.0
"PKG",1,22,1,"PAH",1,1,2,0)
These enhancements include:
"PKG",1,22,1,"PAH",1,1,3,0)
 
"PKG",1,22,1,"PAH",1,1,4,0)
  1) A new parameter which may be passed to XQORM - XQORM("ALT")
"PKG",1,22,1,"PAH",1,1,5,0)
     This allows the calling routine to supply an alternative lookup
"PKG",1,22,1,"PAH",1,1,6,0)
     to be used if the user types something that does not appear on
"PKG",1,22,1,"PAH",1,1,7,0)
     the menu.
"PKG",1,22,1,"PAH",1,1,8,0)
 
"PKG",1,22,1,"PAH",1,1,9,0)
  2) Fixed a bug that caused the menu to be exited if numeric ranges
"PKG",1,22,1,"PAH",1,1,10,0)
     were allowed, the user erroneously entered something like 1-4B,
"PKG",1,22,1,"PAH",1,1,11,0)
     and then typed a return at 'For entry 1-4B enter: ".
"PKG",1,22,1,"PAH",1,1,12,0)
 
"PKG",1,22,1,"PAH",1,1,13,0)
  3) Added "E" as a flag for XQORM(0).  It will allow ambiguous lookups
"PKG",1,22,1,"PAH",1,1,14,0)
     to be resolved interactively when XQORM is called without XQORM(0)
"PKG",1,22,1,"PAH",1,1,15,0)
     containing an "A".
"PKG",1,22,1,"PAH",1,1,16,0)
 
"PKG",1,22,1,"PAH",1,1,17,0)
  4) Made a change that sets full screen earlier when being called by
"PKG",1,22,1,"PAH",1,1,18,0)
     list manager so that selection lists are properly displayed.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","XQOR4")
0^4^B7499848
"RTN","XQOR4",1,0)
XQOR4 ; SLC/KCM - Process "^^" jump ;11/18/92  09:53 ;
"RTN","XQOR4",2,0)
 ;;8.0;KERNEL;**56,62**;Jul 10, 1995
"RTN","XQOR4",3,0)
DJMP ;From: STAK^XQOR1
"RTN","XQOR4",4,0)
 Q:'$D(^TMP("XQORS",$J,XQORS,"ITM",^TMP("XQORS",$J,XQORS,"ITM"),"IN"))
"RTN","XQOR4",5,0)
 I $D(VALMCC) N XQORLMGR S XQORLMGR="" D FULL^VALM1 ; List Mgr Running?
"RTN","XQOR4",6,0)
 S X=^TMP("XQORS",$J,XQORS,"ITM",^TMP("XQORS",$J,XQORS,"ITM"),"IN")
"RTN","XQOR4",7,0)
 I '$L($P(X,"^",3)) W !!,"For entry ""^^",$P(X,"^",4),""" -"
"RTN","XQOR4",8,0)
 S X=$P(X,"^",4,99) D EAT^XQORM1 ;Q:$E(X,1,2)'="^^"
"RTN","XQOR4",9,0)
 S X=$P(X,"=",1),D="K.ORWARD",DIC="^ORD(101,",DIC(0)="SE" D IX^DIC K DIC,D
"RTN","XQOR4",10,0)
 I Y<0!('$D(^ORD(101,+Y,0))) W:(X'["^")&(X'["?") !!,">>>  ",X," not found or selected.  No action taken." D:(X'["^")&(X'["?") READ S X="" G DJMPX
"RTN","XQOR4",11,0)
 S ORNSV=+Y
"RTN","XQOR4",12,0)
 K X F I=1:1:XQORS I $P(^TMP("XQORS",$J,XQORS,"VPT"),";",2)="ORD(101,",$D(^ORD(101,+^TMP("XQORS",$J,XQORS,"VPT"),21)) D DJMP1
"RTN","XQOR4",13,0)
 S X="" F I=0:0 S X=$O(X(X)) Q:X=""  N @X
"RTN","XQOR4",14,0)
 S X=ORNSV_";ORD(101," K ORNSV
"RTN","XQOR4",15,0)
 D EN^XQOR
"RTN","XQOR4",16,0)
DJMPX I $D(XQORLMGR) S VALMBCK="R"                       ; Refresh List Mgr
"RTN","XQOR4",17,0)
 Q
"RTN","XQOR4",18,0)
DJMP1 F J=0:0 S J=$O(^ORD(101,+^TMP("XQORS",$J,XQORS,"VPT"),21,J)) Q:J'>0  I $D(^ORD(101,+^TMP("XQORS",$J,XQORS,"VPT"),21,J,0)) S X=^(0) I X?1A.ANP!(X?1"%".ANP) S X(X)=""
"RTN","XQOR4",19,0)
 Q
"RTN","XQOR4",20,0)
SHDR ;Display sub-header
"RTN","XQOR4",21,0)
 Q:'$D(@(^TMP("XQORS",$J,XQORS,"REF")_"0)"))  S X=$P(^(0),"^",2) W:X'?1." " !!?(36-($L(X)\2)),"--- "_X_" ---"
"RTN","XQOR4",22,0)
 Q
"RTN","XQOR4",23,0)
READ W !,"Press RETURN to continue: " R X:$S($D(DTIME):DTIME,1:300)
"RTN","XQOR4",24,0)
 Q
"RTN","XQOR4",25,0)
C19 N X0 S X0=@(^TMP("XQORS",$J,XQORS,"REF")_"0)"),X=$P(X0,"^",6) I $L(X),'$D(^XUSEC(X,DUZ)) W !!,"This option "_$P(X0,"^")_" is locked.",! D READ S Y=-1 Q
"RTN","XQOR4",26,0)
 S ORNSV=$P(X0,"^",9),X="NOW",%DT="T" D ^%DT S X=$P(Y,".",2) I X>$P(ORNSV,"-"),X<$P(ORNSV,"-",2) W !!,"Not Available: ",ORNSV,! K ORNSV D READ S Y=-1 Q
"RTN","XQOR4",27,0)
 K ORNSV I "QMOXALDT"'[$P(^TMP("XQORS",$J,XQORS,"FLG"),"^") W !!,"This option type not supported by 'unwinder' routines.",! D READ S Y=-1 Q
"RTN","XQOR4",28,0)
 S Y=1 Q
"RTN","XQORM2")
0^1^B14189614
"RTN","XQORM2",1,0)
XQORM2 ; SLC/KCM - Lookup for Menu Utility ;11/18/92  15:23
"RTN","XQORM2",2,0)
 ;;8.0;KERNEL;**56,62**;Jul 10, 1995
"RTN","XQORM2",3,0)
EN ;From: XQORM  Entry: X,XQORM  Exit: X,Y,XQORM
"RTN","XQORM2",4,0)
 N K K Y,OROTHER I X=" " D  Q:'$L(X)
"RTN","XQORM2",5,0)
 . I $D(^DISV(DUZ,"XQORM",XQORM,"ALT")),$D(XQORM("ALT")) D  S X="" Q
"RTN","XQORM2",6,0)
 . . N XQORMERR,XQORMSAV,XQORMRCL
"RTN","XQORM2",7,0)
 . . S (X,XQORMSAV)=^DISV(DUZ,"XQORM",XQORM,"ALT"),XQORMRCL=""
"RTN","XQORM2",8,0)
 . . X XQORM("ALT") S Y=0
"RTN","XQORM2",9,0)
 . . I $D(XQORMERR) S Y=-1 I XQORM(0)["A" W "??" W:XQORM(0)["\" !
"RTN","XQORM2",10,0)
 . S XQORM(0)=XQORM(0)_"X" D LAST^XQORM4
"RTN","XQORM2",11,0)
 . I '$L(X) S Y=-1 W:XQORM(0)["A" "??" W:XQORM(0)["A"&(XQORM(0)["\") !
"RTN","XQORM2",12,0)
 D UP^XQORM1 K ORUX S ORUX=X,(ORUT,ORUER,Y)=0,XQORMSF=""
"RTN","XQORM2",13,0)
 F J=1:1:$L(ORUX,",") S X=$P(ORUX,",",J) D EAT,SET D:X["-" RNG^XQORM3 Q:ORUER  F K=1:1:$L(X,",") I $L($P(X,",",K)) S ORUT=ORUT+1,ORUX(ORUT)=$P(X,",",K) S:$L(ORUFG) ORUX(ORUT,"=")=ORUFG S:ORUSB ORUX(ORUT,"'")=""
"RTN","XQORM2",14,0)
 I 'ORUER S (ORUSQ,ORUT)=0 F I=0:0 S ORUT=$O(ORUX(ORUT)) Q:ORUT=""  S X=ORUX(ORUT) D SPCL I $L(X) D LOOK^XQORM3,CHAL Q:ORUER
"RTN","XQORM2",15,0)
 I 'ORUER,+XQORM(0),+Y>XQORM(0) D:XQORM(0)["A" NE^XQORM4 S ORUER=1,Y=-1
"RTN","XQORM2",16,0)
 I 'ORUER S ORUB=0 F I=0:0 S ORUB=$O(Y(ORUB)) Q:ORUB'>0  D SCRN I 'ORUFG D:ORUX["ALL" SUB I ORUX'["ALL" D:XQORM(0)["A" NS^XQORM4 S ORUER=1
"RTN","XQORM2",17,0)
 I 'ORUER,Y>0 W:XQORM(0)["A" "   " S ORUFG=$S($X>(IOM-30):9,1:$X) K:XQORM(0)'["F" ^DISV(DUZ,"XQORM",XQORM) F I=0:0 S I=$O(Y(I)) Q:I'>0  D:XQORM(0)["A" ECHO D:XQORM(0)'["F" DISV
"RTN","XQORM2",18,0)
 S X=ORUX I ORUER K Y S Y=-1 I $D(XQORM("ALT")) D
"RTN","XQORM2",19,0)
 . N XQORMERR,XQORMSAV S XQORMSAV=X X XQORM("ALT")
"RTN","XQORM2",20,0)
 . S Y=0 I $D(XQORMERR) S Y=-1 D:XQORM(0)["A" UR^XQORM4
"RTN","XQORM2",21,0)
 . I '$D(XQORMERR),(XQORM(0)'["F") D
"RTN","XQORM2",22,0)
 . . K ^DISV(DUZ,"XQORM",XQORM)
"RTN","XQORM2",23,0)
 . . S ^DISV(DUZ,"XQORM",XQORM,"ALT")=XQORMSAV
"RTN","XQORM2",24,0)
KILL K ORUX,ORUFG,ORUSB,ORUT,ORUER,ORUFD,ORUB,ORUDA,ORUW,ORUSQ,XQORMSF,J,Y("B"),Y("#") Q
"RTN","XQORM2",25,0)
SCRN S ORUFG=1 I $D(XQORM("S"))'[0,$L(XQORM("S")) N DA S DA(1)=+XQORM,DA=+Y(ORUB) I DA N Y X XQORM("S") S ORUFG=$T
"RTN","XQORM2",26,0)
 Q
"RTN","XQORM2",27,0)
SET S ORUSB=0 I $E(X)="-",$L(X)>1 S ORUSB=1,X=$P(X,"-",2,99)
"RTN","XQORM2",28,0)
 S ORUFG="" I $E(X)'="=" S ORUFG=$P(X,"=",2,99),X=$P(X,"=",1)
"RTN","XQORM2",29,0)
 Q
"RTN","XQORM2",30,0)
SPCL S:'$D(XQORSPEW) XQORSPEW=0 I $E(X)="*" S XQORSPEW=$S(XQORSPEW:0,1:1),X=$E(X,2,255) W $S(XQORSPEW:" -RAPID MODE-",1:" -NORMAL MODE-")
"RTN","XQORM2",31,0)
 ;I $D(XQORM("KEY",$P(X," "))) S ORUX(ORUT,"=")=$P(X," ",2,99)_"="_$G(ORUX(ORUT,"=")),X="^^`"_XQORM("KEY",$P(X," "))
"RTN","XQORM2",32,0)
 I '$D(XQORM("NO^^")),$E(X,1,2)="^^" S Y=Y+1,ORUSQ=ORUSQ+1,Y(ORUSQ)="^"_X,X="" S:$D(ORUX(ORUT,"=")) $P(Y(ORUSQ),"=",2)=ORUX(ORUT,"=") Q
"RTN","XQORM2",33,0)
 I XQORM(0)["+","+-"[X S Y=Y+1,ORUSQ=ORUSQ+1,Y(ORUSQ)=X,X="" Q
"RTN","XQORM2",34,0)
 I $E(X)=";" D SC^XQORM4 S X="",ORUER=1 Q
"RTN","XQORM2",35,0)
 S X=$P(X,";",1) D EAT
"RTN","XQORM2",36,0)
 Q
"RTN","XQORM2",37,0)
CHAL ; Q:ORUER  I ORUDA,'$D(ORUDA("KEY")),'$D(XQORM("#")) D UPD^XQORM3 Q
"RTN","XQORM2",38,0)
 Q:ORUER  I ORUDA?1.N1"."1.N D UPD^XQORM3 Q
"RTN","XQORM2",39,0)
 I $D(XQORM("KEY",$P(ORUDA," "))) D  Q
"RTN","XQORM2",40,0)
 . S Y=Y+1,ORUSQ=ORUSQ+1,Y(ORUSQ)="^^"_ORUDA_"^`"_+XQORM("KEY",$P(ORUDA," "))_"="_$P(ORUDA," ",2,99)_"="_$G(ORUX(ORUT,"="))
"RTN","XQORM2",41,0)
 . I $P(XQORM("KEY",$P(ORUDA," ")),"^",2) S $P(Y(ORUSQ),"^",2)=+XQORM("KEY",$P(ORUDA," "))
"RTN","XQORM2",42,0)
 . K ORUDA("KEY")
"RTN","XQORM2",43,0)
 . Q
"RTN","XQORM2",44,0)
 I $D(XQORM("#")),ORUDA?1.N,ORUDA D  Q
"RTN","XQORM2",45,0)
 . I '$D(Y("#")) S Y=Y+1,ORUSQ=ORUSQ+1,Y(ORUSQ)="^"_+XQORM("#")_"^^=",Y("#")=ORUSQ
"RTN","XQORM2",46,0)
 . S Y(Y("#"))=Y(Y("#"))_ORUDA_","
"RTN","XQORM2",47,0)
 . Q
"RTN","XQORM2",48,0)
 I ORUDA="ALL" S X="ALL",ORUER=0 D ALL^XQORM4 Q
"RTN","XQORM2",49,0)
 Q
"RTN","XQORM2",50,0)
EAT F I=0:0 Q:$E(X)]" "  Q:'$L(X)  S X=$E(X,2,999)
"RTN","XQORM2",51,0)
 F I=0:0 Q:$E(X,$L(X))]" "  Q:'$L(X)  S X=$E(X,1,$L(X)-1)
"RTN","XQORM2",52,0)
 Q
"RTN","XQORM2",53,0)
ECHO W:($X+$L($P(Y(I),"^",3))+4)>IOM !,?ORUFG W $P(Y(I),"^",3),"  " Q
"RTN","XQORM2",54,0)
DISV I +Y(I) S ^DISV(DUZ,"XQORM",XQORM,I)=$P(Y(I),"^",3) Q
"RTN","XQORM2",55,0)
 I XQORM(0)["R",$L($P(Y(I),"^",3)) S ^DISV(DUZ,"XQORM",XQORM,I)=$P(Y(I),"^",3) Q
"RTN","XQORM2",56,0)
 I XQORM(0)["r",'$L($P(Y(I),"^",3)) S ^DISV(DUZ,"XQORM",XQORM,I)="^^"_$P(Y(I),"^",4)
"RTN","XQORM2",57,0)
 Q
"RTN","XQORM2",58,0)
SUB K Y(ORUB) S Y=Y-1 Q
"RTN","XQORM3")
0^2^B9317503
"RTN","XQORM3",1,0)
XQORM3 ; SLC/KCM - Lookup (cont.) ;11/12/92  11:28
"RTN","XQORM3",2,0)
 ;;8.0;KERNEL;**56,62**;Jul 10, 1995
"RTN","XQORM3",3,0)
LOOK ;From: XQORM2
"RTN","XQORM3",4,0)
 K ORUFD,ORUDA S ORUFD=0,ORUW=X
"RTN","XQORM3",5,0)
 I $D(^XUTL("XQORM",XQORM,"B",X)) S ORUDA=0 F I=0:0 S ORUDA=$O(^XUTL("XQORM",XQORM,"B",X,ORUDA)) Q:ORUDA=""  I '$D(ORUDA(ORUDA)) D LOOK1 Q:ORUER
"RTN","XQORM3",6,0)
 S:$E(X,$L(X),1)'=" " X=$E(X,1,$L(X)-1)_$C($A($E(X,$L(X)))-1)_"~"
"RTN","XQORM3",7,0)
 F I=0:0 S X=$O(^XUTL("XQORM",XQORM,"B",X)) Q:X=""!($E(X,1,$L(ORUW))'=ORUW)!(XQORM(0)["X"&(X'=ORUW))  S ORUDA=0 F I=0:0 S ORUDA=$O(^XUTL("XQORM",XQORM,"B",X,ORUDA)) Q:ORUDA=""  I '$D(ORUDA(ORUDA)) D LOOK1
"RTN","XQORM3",8,0)
 S ORUDA=0 Q:ORUER  I ORUFD=1 S ORUDA=ORUFD(1) Q
"RTN","XQORM3",9,0)
 I 'ORUFD,$D(XQORM("#")),ORUW?1.12N D  Q:ORUDA
"RTN","XQORM3",10,0)
 . N X S X=$P(XQORM("#"),"^",2)
"RTN","XQORM3",11,0)
 . I X[":" Q:(ORUW<X)!(ORUW>$P(X,":",2))
"RTN","XQORM3",12,0)
 . I $L(X),X'[":" Q:(","_X_",")'[(","_ORUW_",")
"RTN","XQORM3",13,0)
 . S ORUDA=ORUW
"RTN","XQORM3",14,0)
 I 'ORUFD,$L($P(ORUW," ")),(($D(XQORM("KEY",$P(ORUW," ")))&('$D(XQORM("NO^^"))))!(ORUW="ALL")) S ORUDA=ORUW,ORUDA("KEY")="" Q
"RTN","XQORM3",15,0)
 I 'ORUFD,$D(XQORM("ALT")) S ORUER=1 Q
"RTN","XQORM3",16,0)
 I 'ORUFD,XQORM(0)["A" S ORUER=1 D NF^XQORM4 I (ORUX[",")!(ORUX["-") S ORUER=0 D PICK
"RTN","XQORM3",17,0)
 D:ORUFD>1 PICK ;S:'ORUFD ORUER=1
"RTN","XQORM3",18,0)
 Q
"RTN","XQORM3",19,0)
LOOK1 S ORUFD=ORUFD+1,ORUFD(ORUFD)=ORUDA,ORUDA(ORUDA)=""
"RTN","XQORM3",20,0)
 Q
"RTN","XQORM3",21,0)
PICK I (XQORM(0)'["A")&(XQORM(0)'["E") S ORUFD=0 Q
"RTN","XQORM3",22,0)
 I ORUFD F J=1:1:ORUFD W:$D(^XUTL("XQORM",XQORM,ORUFD(J),0)) !,$J(J,6),?9,$P(^(0),"^",3)
"RTN","XQORM3",23,0)
 F I=0:0 D PICK1 I $L(X)'>80,X?.ANP S:'$T X="^" Q:X'["?"  D HELP3^XQORM5
"RTN","XQORM3",24,0)
 I X="" D
"RTN","XQORM3",25,0)
 . N J,C S (J,C)=0 F  S J=$O(ORUX(J)) Q:'J  S C=C+1
"RTN","XQORM3",26,0)
 . I C=1 S X="^" W ! ; reprompt if 1 selection
"RTN","XQORM3",27,0)
 S:X="^" ORUER=1 S:X="^^" (ORUER,DIROUT)=1 S ORUFD=0 Q:ORUER
"RTN","XQORM3",28,0)
 I $L(X),$D(ORUFD(X)) S ORUDA=ORUFD(X),ORUFD=1 Q
"RTN","XQORM3",29,0)
 D:$L(X)&(X'["^") LOOK
"RTN","XQORM3",30,0)
 Q
"RTN","XQORM3",31,0)
PICK1 W !,$S(ORUX[","!(ORUX["-"):"For entry """_ORUW_""" ",1:""),$S(ORUFD:"CHOOSE 1-"_ORUFD_": ",1:"re-enter: ")
"RTN","XQORM3",32,0)
 R X:$S($D(DTIME):DTIME,1:"") D:X'?.ANP CC^XQORM4 D:$L(X)>80 LL^XQORM4 D UP^XQORM1
"RTN","XQORM3",33,0)
 Q
"RTN","XQORM3",34,0)
UPD ;from XQORM2
"RTN","XQORM3",35,0)
 S X="",ORUSQ=ORUSQ+1 S:$D(^XUTL("XQORM",XQORM,ORUDA,0)) X=^(0) I '$L(X) S ORUER=1 Q
"RTN","XQORM3",36,0)
 I $D(ORUX(ORUT,"'")) S X=$O(Y("B",ORUDA,"")) K:$L(X) Y(X),Y("B",ORUDA,X) S:$L(X) Y=Y-1 Q
"RTN","XQORM3",37,0)
 S Y=Y+1,Y(ORUSQ)=$P(X,"^",1,3),Y("B",ORUDA,ORUSQ)="",$P(Y(ORUSQ),"^",4)=ORUX(ORUT) S:$D(ORUX(ORUT,"=")) Y(ORUSQ)=Y(ORUSQ)_"="_ORUX(ORUT,"=")
"RTN","XQORM3",38,0)
 Q
"RTN","XQORM3",39,0)
RNG ;From: XQORM2
"RTN","XQORM3",40,0)
 N K Q:X'?1.12N1"-"1.12N
"RTN","XQORM3",41,0)
 I $P(X,"-",1)'<$P(X,"-",2) D:XQORM(0)["A" IR^XQORM4 S ORUER=1 Q
"RTN","XQORM3",42,0)
 S ORUB="" F K=$P(X,"-",1):1:$P(X,"-",2) S ORUB=ORUB_K_"," I $L(ORUB)>225 D:XQORM(0)["A" LR^XQORM4 S ORUER=1 Q
"RTN","XQORM3",43,0)
 S X=ORUB
"RTN","XQORM3",44,0)
 Q
"RTN","XQORM4")
0^3^B6389266
"RTN","XQORM4",1,0)
XQORM4 ; SLC/KCM - Menu Messages ;10/19/90  14:31 ;
"RTN","XQORM4",2,0)
 ;;8.0;KERNEL;**62**;Jul 10, 1995
"RTN","XQORM4",3,0)
HELP ;From: XQORM1
"RTN","XQORM4",4,0)
 Q:XQORM(0)'["A"
"RTN","XQORM4",5,0)
 I $D(XQORM("??")) X:$L(XQORM("??")) XQORM("??") Q
"RTN","XQORM4",6,0)
 I X="?" D:XQORM(0)'["D" DISP^XQORM1 D HELP1^XQORM5 Q
"RTN","XQORM4",7,0)
 D HELP1^XQORM5,HELP2^XQORM5 F I=0:0 W !!,$S(XQORM(0)["D":"Red",1:"D"),"isplay items" S %=1 D YN^DICN Q:%  W !!?4,"Enter a ""Y"" or ""N""."
"RTN","XQORM4",8,0)
 D:%=1 DISP^XQORM1 W !
"RTN","XQORM4",9,0)
 Q
"RTN","XQORM4",10,0)
 ;Error messages  From: XQORM routines
"RTN","XQORM4",11,0)
CC W !!,">>>  Control characters and function keys may not be entered.",! Q
"RTN","XQORM4",12,0)
LL W !!,">>>  Entry is too long.",! Q
"RTN","XQORM4",13,0)
NE W !!,">>>  Only "_+XQORM(0)_$S(+XQORM(0)=1:" entry",1:" entries")_" allowed.",! Q
"RTN","XQORM4",14,0)
IR W !!,">>>  Range entered improperly: ",X,".",! Q
"RTN","XQORM4",15,0)
LR W !!,">>>  Range too large: ",X,".",! Q
"RTN","XQORM4",16,0)
NS W !!,">>>  ",$P(Y(ORUB),"^",3)," may not be selected at this point.",! Q
"RTN","XQORM4",17,0)
NN W !!,">>>  The ""-"" may not be used with " D SHO W ".",! Q
"RTN","XQORM4",18,0)
NF W !!,ORUW," is not a valid selection.",! Q
"RTN","XQORM4",19,0)
SC W !!,">>>  Semi-colon may not be at the front of an item.  To jump, use '^^'.",! Q
"RTN","XQORM4",20,0)
NU I $L(XQORM("NO^")),XQORM("NO^")'="OUTOK" W !!,">>>  ",@XQORM("NO^"),! Q
"RTN","XQORM4",21,0)
 W !!,">>>  Up-arrow not allowed.",!
"RTN","XQORM4",22,0)
 Q
"RTN","XQORM4",23,0)
UR W !!,">>>  Unable to resolve ",XQORMSAV,".",! Q
"RTN","XQORM4",24,0)
SHO I $D(^XUTL("XQORM",XQORM,ORUDA,0)) W $P(^(0),"^",3)
"RTN","XQORM4",25,0)
 Q
"RTN","XQORM4",26,0)
ALL ;From: XQORM2
"RTN","XQORM4",27,0)
 N X K ^TMP("XQORM",$J)
"RTN","XQORM4",28,0)
 S ORUDA=0 F I=0:0 S ORUDA=$O(^XUTL("XQORM",XQORM,ORUDA)) Q:ORUDA'>0  I $D(^(ORUDA,0)),+^(0) S ORUB=1000*$P(ORUDA,".",2)+$P(ORUDA,".",1),^TMP("XQORM",$J,ORUB)=ORUDA
"RTN","XQORM4",29,0)
 S ORUB=0 F I=0:0 S ORUB=$O(^TMP("XQORM",$J,ORUB)) Q:ORUB'>0  S ORUDA=+^(ORUB) D UPD^XQORM3
"RTN","XQORM4",30,0)
 K ^TMP("XQORM",$J) Q
"RTN","XQORM4",31,0)
LAST ;From: XQORM2
"RTN","XQORM4",32,0)
 S X="" F I=0:0 S I=$O(^DISV(DUZ,"XQORM",XQORM,I)) Q:I'>0  S X=X_^DISV(DUZ,"XQORM",XQORM,I)_"," I $L(X)>160 K ^DISV(DUZ,"XQORM",XQORM) S X="" Q
"RTN","XQORM4",33,0)
 S X=$E(X,1,$L(X)-1) ;I $L(X) W:XQORM(0)["A" X
"RTN","XQORM4",34,0)
 Q
"VER")
8.0^21.0
**END**
**END**
