Released FH*5*40 SEQ #39
Extracted from mail message
**KIDS**:FH*5.0*40^

**INSTALL NAME**
FH*5.0*40
"BLD",4664,0)
FH*5.0*40^DIETETICS^0^3031027^y
"BLD",4664,1,0)
^^1^1^3030916^
"BLD",4664,1,1,0)
Patch FH*5.0*40
"BLD",4664,4,0)
^9.64PA^119.9^2
"BLD",4664,4,117,0)
117
"BLD",4664,4,117,2,0)
^9.641^117.06^1
"BLD",4664,4,117,2,117.06,0)
COMM OFFICE  (sub-file)
"BLD",4664,4,117,2,117.06,1,0)
^9.6411^33^7
"BLD",4664,4,117,2,117.06,1,27,0)
# PATIENTS STATUS I
"BLD",4664,4,117,2,117.06,1,28,0)
# PATIENTS STATUS II
"BLD",4664,4,117,2,117.06,1,29,0)
# PATIENTS STATUS III
"BLD",4664,4,117,2,117.06,1,30,0)
# PATIENTS STATUS IV
"BLD",4664,4,117,2,117.06,1,31,0)
# PATIENTS STATUS UNC
"BLD",4664,4,117,2,117.06,1,32,0)
# DAILY MODIFIED DIETS
"BLD",4664,4,117,2,117.06,1,33,0)
# OF TOTAL DIETS
"BLD",4664,4,117,222)
y^y^p^^^^n^^n
"BLD",4664,4,117,224)

"BLD",4664,4,119.9,0)
119.9
"BLD",4664,4,119.9,2,0)
^9.641^119.9^1
"BLD",4664,4,119.9,2,119.9,0)
FH SITE PARAMETERS  (File-top level)
"BLD",4664,4,119.9,2,119.9,1,0)
^9.6411^22^1
"BLD",4664,4,119.9,2,119.9,1,22,0)
MULTIDIVISIONAL SITE?
"BLD",4664,4,119.9,222)
y^y^p^^^^n^^n
"BLD",4664,4,119.9,224)

"BLD",4664,4,"APDD",117,117.06)

"BLD",4664,4,"APDD",117,117.06,27)

"BLD",4664,4,"APDD",117,117.06,28)

"BLD",4664,4,"APDD",117,117.06,29)

"BLD",4664,4,"APDD",117,117.06,30)

"BLD",4664,4,"APDD",117,117.06,31)

"BLD",4664,4,"APDD",117,117.06,32)

"BLD",4664,4,"APDD",117,117.06,33)

"BLD",4664,4,"APDD",119.9,119.9)

"BLD",4664,4,"APDD",119.9,119.9,22)

"BLD",4664,4,"B",117,117)

"BLD",4664,4,"B",119.9,119.9)

"BLD",4664,"INID")
^y
"BLD",4664,"INIT")
FHPST40
"BLD",4664,"KRN",0)
^9.67PA^8989.52^19
"BLD",4664,"KRN",.4,0)
.4
"BLD",4664,"KRN",.401,0)
.401
"BLD",4664,"KRN",.402,0)
.402
"BLD",4664,"KRN",.402,"NM",0)
^9.68A^6^6
"BLD",4664,"KRN",.402,"NM",1,0)
FHADM2    FILE #117^117^0
"BLD",4664,"KRN",.402,"NM",2,0)
FHMADM2    FILE #117^117^0
"BLD",4664,"KRN",.402,"NM",3,0)
FHADM4    FILE #117.1^117.1^0
"BLD",4664,"KRN",.402,"NM",4,0)
FHMADM4    FILE #117.1^117.1^0
"BLD",4664,"KRN",.402,"NM",5,0)
FHASE    FILE #115.7^115.7^0
"BLD",4664,"KRN",.402,"NM",6,0)
FHMASE    FILE #115.7^115.7^0
"BLD",4664,"KRN",.402,"NM","B","FHADM2    FILE #117",1)

"BLD",4664,"KRN",.402,"NM","B","FHADM4    FILE #117.1",3)

"BLD",4664,"KRN",.402,"NM","B","FHASE    FILE #115.7",5)

"BLD",4664,"KRN",.402,"NM","B","FHMADM2    FILE #117",2)

"BLD",4664,"KRN",.402,"NM","B","FHMADM4    FILE #117.1",4)

"BLD",4664,"KRN",.402,"NM","B","FHMASE    FILE #115.7",6)

"BLD",4664,"KRN",.403,0)
.403
"BLD",4664,"KRN",.5,0)
.5
"BLD",4664,"KRN",.84,0)
.84
"BLD",4664,"KRN",3.6,0)
3.6
"BLD",4664,"KRN",3.8,0)
3.8
"BLD",4664,"KRN",9.2,0)
9.2
"BLD",4664,"KRN",9.8,0)
9.8
"BLD",4664,"KRN",9.8,"NM",0)
^9.68A^31^30
"BLD",4664,"KRN",9.8,"NM",1,0)
FHORT5D^^0^B11710172
"BLD",4664,"KRN",9.8,"NM",3,0)
FHASN^^0^B4668207
"BLD",4664,"KRN",9.8,"NM",4,0)
FHASM1^^0^B18566049
"BLD",4664,"KRN",9.8,"NM",5,0)
FHADM2^^0^B3956794
"BLD",4664,"KRN",9.8,"NM",6,0)
FHADM21^^0^B11163428
"BLD",4664,"KRN",9.8,"NM",7,0)
FHADM2A^^0^B3231538
"BLD",4664,"KRN",9.8,"NM",8,0)
FHADM3^^0^B8659464
"BLD",4664,"KRN",9.8,"NM",9,0)
FHADM4^^0^B15416996
"BLD",4664,"KRN",9.8,"NM",10,0)
FHASE^^0^B19929165
"BLD",4664,"KRN",9.8,"NM",11,0)
FHASE1^^0^B6349078
"BLD",4664,"KRN",9.8,"NM",12,0)
FHASE1A^^0^B20025721
"BLD",4664,"KRN",9.8,"NM",13,0)
FHASE3^^0^B2086750
"BLD",4664,"KRN",9.8,"NM",14,0)
FHMADM2^^0^B5214994
"BLD",4664,"KRN",9.8,"NM",15,0)
FHMADM21^^0^B34931110
"BLD",4664,"KRN",9.8,"NM",16,0)
FHMADM2A^^0^B4879631
"BLD",4664,"KRN",9.8,"NM",17,0)
FHMADM3^^0^B23111413
"BLD",4664,"KRN",9.8,"NM",18,0)
FHMADM4^^0^B36293844
"BLD",4664,"KRN",9.8,"NM",19,0)
FHMASE^^0^B20961149
"BLD",4664,"KRN",9.8,"NM",20,0)
FHMASE1^^0^B10848521
"BLD",4664,"KRN",9.8,"NM",21,0)
FHMASE1A^^0^B41020024
"BLD",4664,"KRN",9.8,"NM",22,0)
FHMMBRPT^^0^B17340121
"BLD",4664,"KRN",9.8,"NM",23,0)
FHMMNADM^^0^B28721298
"BLD",4664,"KRN",9.8,"NM",24,0)
FHMMNPRT^^0^B34894053
"BLD",4664,"KRN",9.8,"NM",25,0)
FHMMNREP^^0^B19403047
"BLD",4664,"KRN",9.8,"NM",26,0)
FHMNADM^^0^B9206960
"BLD",4664,"KRN",9.8,"NM",27,0)
FHMNBRPT^^0^B5403322
"BLD",4664,"KRN",9.8,"NM",28,0)
FHMNPRT^^0^B16366448
"BLD",4664,"KRN",9.8,"NM",29,0)
FHMNREP^^0^B11954964
"BLD",4664,"KRN",9.8,"NM",30,0)
FHSYSP^^0^B2588663
"BLD",4664,"KRN",9.8,"NM",31,0)
FHPST40^^0^B3317708
"BLD",4664,"KRN",9.8,"NM","B","FHADM2",5)

"BLD",4664,"KRN",9.8,"NM","B","FHADM21",6)

"BLD",4664,"KRN",9.8,"NM","B","FHADM2A",7)

"BLD",4664,"KRN",9.8,"NM","B","FHADM3",8)

"BLD",4664,"KRN",9.8,"NM","B","FHADM4",9)

"BLD",4664,"KRN",9.8,"NM","B","FHASE",10)

"BLD",4664,"KRN",9.8,"NM","B","FHASE1",11)

"BLD",4664,"KRN",9.8,"NM","B","FHASE1A",12)

"BLD",4664,"KRN",9.8,"NM","B","FHASE3",13)

"BLD",4664,"KRN",9.8,"NM","B","FHASM1",4)

"BLD",4664,"KRN",9.8,"NM","B","FHASN",3)

"BLD",4664,"KRN",9.8,"NM","B","FHMADM2",14)

"BLD",4664,"KRN",9.8,"NM","B","FHMADM21",15)

"BLD",4664,"KRN",9.8,"NM","B","FHMADM2A",16)

"BLD",4664,"KRN",9.8,"NM","B","FHMADM3",17)

"BLD",4664,"KRN",9.8,"NM","B","FHMADM4",18)

"BLD",4664,"KRN",9.8,"NM","B","FHMASE",19)

"BLD",4664,"KRN",9.8,"NM","B","FHMASE1",20)

"BLD",4664,"KRN",9.8,"NM","B","FHMASE1A",21)

"BLD",4664,"KRN",9.8,"NM","B","FHMMBRPT",22)

"BLD",4664,"KRN",9.8,"NM","B","FHMMNADM",23)

"BLD",4664,"KRN",9.8,"NM","B","FHMMNPRT",24)

"BLD",4664,"KRN",9.8,"NM","B","FHMMNREP",25)

"BLD",4664,"KRN",9.8,"NM","B","FHMNADM",26)

"BLD",4664,"KRN",9.8,"NM","B","FHMNBRPT",27)

"BLD",4664,"KRN",9.8,"NM","B","FHMNPRT",28)

"BLD",4664,"KRN",9.8,"NM","B","FHMNREP",29)

"BLD",4664,"KRN",9.8,"NM","B","FHORT5D",1)

"BLD",4664,"KRN",9.8,"NM","B","FHPST40",31)

"BLD",4664,"KRN",9.8,"NM","B","FHSYSP",30)

"BLD",4664,"KRN",19,0)
19
"BLD",4664,"KRN",19.1,0)
19.1
"BLD",4664,"KRN",101,0)
101
"BLD",4664,"KRN",409.61,0)
409.61
"BLD",4664,"KRN",771,0)
771
"BLD",4664,"KRN",870,0)
870
"BLD",4664,"KRN",8989.51,0)
8989.51
"BLD",4664,"KRN",8989.52,0)
8989.52
"BLD",4664,"KRN",8994,0)
8994
"BLD",4664,"KRN","B",.4,.4)

"BLD",4664,"KRN","B",.401,.401)

"BLD",4664,"KRN","B",.402,.402)

"BLD",4664,"KRN","B",.403,.403)

"BLD",4664,"KRN","B",.5,.5)

"BLD",4664,"KRN","B",.84,.84)

"BLD",4664,"KRN","B",3.6,3.6)

"BLD",4664,"KRN","B",3.8,3.8)

"BLD",4664,"KRN","B",9.2,9.2)

"BLD",4664,"KRN","B",9.8,9.8)

"BLD",4664,"KRN","B",19,19)

"BLD",4664,"KRN","B",19.1,19.1)

"BLD",4664,"KRN","B",101,101)

"BLD",4664,"KRN","B",409.61,409.61)

"BLD",4664,"KRN","B",771,771)

"BLD",4664,"KRN","B",870,870)

"BLD",4664,"KRN","B",8989.51,8989.51)

"BLD",4664,"KRN","B",8989.52,8989.52)

"BLD",4664,"KRN","B",8994,8994)

"BLD",4664,"QUES",0)
^9.62^^
"BLD",4664,"REQB",0)
^9.611^1^1
"BLD",4664,"REQB",1,0)
FH*5.0*39^1
"BLD",4664,"REQB","B","FH*5.0*39",1)

"FIA",117)
MEALS SERVED
"FIA",117,0)
^FH(117,
"FIA",117,0,0)
117D
"FIA",117,0,1)
y^y^p^^^^n^^n
"FIA",117,0,10)

"FIA",117,0,11)

"FIA",117,0,"RLRO")

"FIA",117,0,"VR")
5.0^FH
"FIA",117,117)
1
"FIA",117,117.06)
1
"FIA",117,117.06,27)

"FIA",117,117.06,28)

"FIA",117,117.06,29)

"FIA",117,117.06,30)

"FIA",117,117.06,31)

"FIA",117,117.06,32)

"FIA",117,117.06,33)

"FIA",119.9)
FH SITE PARAMETERS
"FIA",119.9,0)
^FH(119.9,
"FIA",119.9,0,0)
119.9
"FIA",119.9,0,1)
y^y^p^^^^n^^n
"FIA",119.9,0,10)

"FIA",119.9,0,11)

"FIA",119.9,0,"RLRO")

"FIA",119.9,0,"VR")
5.0^FH
"FIA",119.9,119.9)
1
"FIA",119.9,119.9,22)

"INIT")
FHPST40
"KRN",.402,297,-1)
0^1
"KRN",.402,297,0)
FHADM2^3031009.1119^^117^^^3031021
"KRN",.402,297,"%D",0)
^.4021^2^2^3031006^^^^
"KRN",.402,297,"%D",1,0)
This template is used to enter served meals data which is used
"KRN",.402,297,"%D",2,0)
to complete the worksheet for AMIS segment 224.
"KRN",.402,297,"DR",1,117)
S DIE("NO^")="" S:'$D(FHN("D")) Y="@1";1//^S X=FHN("D",0);2//^S X=FHN("D",1);@1;S:'$D(FHN("N")) Y="@2";4//^S X=FHN("N",0);5//^S X=FHN("N",1);@2;S:'$D(FHN("H")) Y="@3";7//^S X=FHN("H",0);8//^S X=FHN("H",1);@3;K DIE("NO^");30;31;32;
"KRN",.402,297,"DR",1,117,1)
33;34;35;36;37;38;39;40;41;42;43;44;45;46;47;50;51;
"KRN",.402,629,-1)
0^5
"KRN",.402,629,0)
FHASE^3031014.1531^^115.7^^^3031023
"KRN",.402,629,"%D",0)
^.4021^2^2^3030602^^^^
"KRN",.402,629,"%D",1,0)
This template is used to enter data relating to a dietetic
"KRN",.402,629,"%D",2,0)
encounter.
"KRN",.402,629,"DR",1,115.7)
2//^S X=$P(^VA(200,DUZ,0),"^",1);3//^S X="",DIC("S")="I Y>2";K DIC("S") S FHX1=$S($D(^FH(115.6,+X,0)):^(0),1:"") I $P(FHX1,"^",5)'="Y" S Y="@1";4;@1;S FHX2=$P(FHX1,"^",3) I '$P(FHX1,"^",4) S Y=6;5;I X="F" S FHX2=$P(FHX1,"^",4);
"KRN",.402,629,"DR",1,115.7,1)
6//^S X=FHX2;S FHX2=$P(FHX1,"^",6) I FHX2'="B" S Y="@3";7;S FHX2=X,Y="@4";@3;7///^S X=FHX2;@4;10;S FHX3="" I $P(FHX1,"^",7)'="Y" S Y=8 S:FHX2="I" FHX3=1;@5;20;D CNT^FHASE I $P(FHX4,"^",10)'="",FHX3 S $P(^FHEN(ASE,0),U,10)="";
"KRN",.402,629,"DR",1,115.7,2)
I FHX2="I",FHX3<1 W *7,!?5,"Must select a patient." S Y="@5";@8;8//^S X=FHX3;I X<FHX3 W *7,!?5,"Group Size cannot be less than total person count (default)" S $P(^FHEN(ASE,0),U,10)="",Y="@8";I $P(FHX4,"^",13)'="" S Y="@9";
"KRN",.402,629,"DR",1,115.7,3)
101////^S X=DUZ;@9;I $P(FHX4,"^",14)'="" S Y="@10";102///^S X="NOW";@10;S:'FHN Y=0;103///^S X="NOW";104////^S X=DUZ;
"KRN",.402,629,"DR",2,115.701)
.01;S DFN=X,DGT=DTE D ^DGPMSTAT S X9=$G(^DIC(42,+DG1,44));1////^S X=X9;I $P(FHX1,"^",8)'="Y" S Y="@6";2;@6;I $P(FHX1,"^",9)'="Y" S Y="@7";3;@7;I FHX2="I" S DI(1)=+DI(1),Y=0;
"KRN",.402,630,-1)
0^3
"KRN",.402,630,0)
FHADM4^3031010.1131^^117.1^^^3031016
"KRN",.402,630,"%D",0)
^.4021^2^2^3030423^^^^
"KRN",.402,630,"%D",1,0)
This template is used to input daily data into the Staffing
"KRN",.402,630,"%D",2,0)
Guidelines file (117.1).
"KRN",.402,630,"DR",1,117.1)
1//^S X=$P(FHX1,"^",1);2//^S X=$P(FHX1,"^",2);3//^S X=$P(FHX1,"^",3);4//^S X=$P(FHX1,"^",4);5//^S X=$P(FHX1,"^",5);6;7;8;9;10;11;12;13;14;15;16;17;18;19;
"KRN",.402,2138,-1)
0^2
"KRN",.402,2138,0)
FHMADM2^3031009.1127^@^117^^@^3031023
"KRN",.402,2138,"DR",1,117)
6;
"KRN",.402,2138,"DR",2,117.06)
.01;S FHCOMM=X;D C1^FHMADM2;S DIE("NO^")="" S:'$D(FHN("D")) Y="@1";21//^S X=FHN("D",0);22//^S X=FHN("D",1);@1;S:'$D(FHN("N")) Y="@2";23//^S X=FHN("N",0);24//^S X=FHN("N",1);@2;S:'$D(FHN("H")) Y="@3";25//^S X=FHN("H",0);
"KRN",.402,2138,"DR",2,117.06,1)
26//^S X=FHN("H",1);@3;K DIE("NO^");1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;
"KRN",.402,2139,-1)
0^4
"KRN",.402,2139,0)
FHMADM4^3031010.1122^@^117.1^^@^3031015
"KRN",.402,2139,"DR",1,117.1)
20;
"KRN",.402,2139,"DR",2,117.11)
2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;
"KRN",.402,2140,-1)
0^6
"KRN",.402,2140,0)
FHMASE^3031014.1532^@^115.7^^@^3031023
"KRN",.402,2140,"DR",1,115.7)
2//^S X=$P(^VA(200,DUZ,0),"^",1);11;3//^S X="",DIC("S")="I Y>2";K DIC("S") S FHX1=$S($D(^FH(115.6,+X,0)):^(0),1:"") I $P(FHX1,"^",5)'="Y" S Y="@1";4;@1;S FHX2=$P(FHX1,"^",3) I '$P(FHX1,"^",4) S Y=6;5;I X="F" S FHX2=$P(FHX1,"^",4);
"KRN",.402,2140,"DR",1,115.7,1)
6//^S X=FHX2;S FHX2=$P(FHX1,"^",6) I FHX2'="B" S Y="@3";7;S FHX2=X,Y="@4";@3;7///^S X=FHX2;@4;10;S FHX3="" I $P(FHX1,"^",7)'="Y" S Y=8 S:FHX2="I" FHX3=1;@5;20;D CNT^FHMASE I $P(FHX4,"^",10)'="",FHX3 S $P(^FHEN(ASE,0),U,10)="";
"KRN",.402,2140,"DR",1,115.7,2)
I FHX2="I",FHX3<1 W *7,!?5,"Must select a patient." S Y="@5";@8;8//^S X=FHX3;I X<FHX3 W *7,!?5,"Group Size cannot be less than total person count (default)" S $P(^FHEN(ASE,0),U,10)="",Y="@8";I $P(FHX4,"^",13)'="" S Y="@9";
"KRN",.402,2140,"DR",1,115.7,3)
101////^S X=DUZ;@9;I $P(FHX4,"^",14)'="" S Y="@10";102///^S X="NOW";@10;S:'FHN Y=0;103///^S X="NOW";104////^S X=DUZ;
"KRN",.402,2140,"DR",2,115.701)
.01;S DFN=X,DGT=DTE D ^DGPMSTAT S X9=$G(^DIC(42,+DG1,44));1////^S X=X9;I $P(FHX1,"^",8)'="Y" S Y="@6";2;@6;I $P(FHX1,"^",9)'="Y" S Y="@7";3;@7;I FHX2="I" S DI(1)=+DI(1),Y=0;
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",29,-1)
1^1
"PKG",29,0)
DIETETICS^FH^Dietetics System
"PKG",29,20,0)
^9.402P^^
"PKG",29,22,0)
^9.49I^1^1
"PKG",29,22,1,0)
5.0^2951011^2951130
"PKG",29,22,1,"PAH",1,0)
40^3031027
"PKG",29,22,1,"PAH",1,1,0)
^^1^1^3031027
"PKG",29,22,1,"PAH",1,1,1,0)
Patch FH*5.0*40
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
30
"RTN","FHADM2")
0^5^B3956794
"RTN","FHADM2",1,0)
FHADM2 ; HISC/REL/NCA - Enter/Edit Served Meals ;5/4/93  09:53
"RTN","FHADM2",2,0)
 ;;5.0;Dietetics;**39,40**;Oct 11, 1995
"RTN","FHADM2",3,0)
EN1 ; Enter/Edit Served Meals
"RTN","FHADM2",4,0)
 ; Check for multidivisional site
"RTN","FHADM2",5,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D ^FHMADM2 Q
"RTN","FHADM2",6,0)
 D NOW^%DTC S DT=%\1 K %,%H,%I
"RTN","FHADM2",7,0)
E1 S %DT="AEPX",%DT("A")="SERVED MEALS Date: " W ! D ^%DT G KIL^FHADM21:"^"[X!$D(DTOUT),E1:Y<1
"RTN","FHADM2",8,0)
 S DA=+Y I DA'<DT W *7,!!,"** Input must be for a date before today in order to collect ADT data!",! G E1
"RTN","FHADM2",9,0)
 K DIC,DIE S DIE="^FH(117," I '$D(^FH(117,DA,0)) S ^FH(117,DA,0)=DA,^FH(117,"B",DA,DA)="",X0=^FH(117,0),$P(^FH(117,0),"^",3,4)=DA_"^"_($P(X0,"^",4)+1)
"RTN","FHADM2",10,0)
 S DA=+Y K FHN W !!,"Calculating Census Values ...",!
"RTN","FHADM2",11,0)
 F W1=0:0 S W1=$O(^DG(41.9,W1)) Q:W1<1  I $D(^DG(41.9,W1,"C",DA,0)) D C1
"RTN","FHADM2",12,0)
 S ^FH(117,DA,0)=DA
"RTN","FHADM2",13,0)
 S DR="[FHADM2]" D ^DIE G EN1
"RTN","FHADM2",14,0)
C1 S X0=^DG(41.9,W1,"C",DA,0),X1=$G(^(1))
"RTN","FHADM2",15,0)
 S TYP=$P(^DIC(42,W1,0),"^",3),TYP=$S(TYP="D":"D",TYP="NH":"N",1:"H")
"RTN","FHADM2",16,0)
 I '$D(FHN(TYP)) S FHN(TYP,0)=0,FHN(TYP,1)=0
"RTN","FHADM2",17,0)
 S Y0=$P(X0,"^",2),Y1=$P(X1,"^",5)
"RTN","FHADM2",18,0)
 S FHN(TYP,0)=FHN(TYP,0)+Y0 S:Y1 FHN(TYP,1)=FHN(TYP,1)+Y1 Q
"RTN","FHADM2",19,0)
DT ; Get From/To Dates
"RTN","FHADM2",20,0)
D1 S %DT="AEPX",%DT("A")="Starting Date: " W ! D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D1 S SDT=+Y
"RTN","FHADM2",21,0)
 I SDT'<DT W *7,"  [Must Start before Today!] " G D1
"RTN","FHADM2",22,0)
D2 S %DT="AEPX",%DT("A")=" Ending Date: " D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D2 S EDT=+Y
"RTN","FHADM2",23,0)
 I EDT'<DT W *7,"  [Must End before Today!] " G D2
"RTN","FHADM2",24,0)
 I EDT<SDT W *7,"  [End before Start?] " G D1
"RTN","FHADM2",25,0)
 Q
"RTN","FHADM21")
0^6^B11163428
"RTN","FHADM21",1,0)
FHADM21 ; HISC/REL/NCA - Served Meals Report ;1/23/98  16:07
"RTN","FHADM21",2,0)
 ;;5.0;Dietetics;**13,39,40**;Oct 11, 1995
"RTN","FHADM21",3,0)
EN2 ; Print Meals Report
"RTN","FHADM21",4,0)
 ; Check for multidivisional site
"RTN","FHADM21",5,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D ^FHMADM21 Q
"RTN","FHADM21",6,0)
 D NOW^%DTC S DT=%\1 D DT^FHADM2 G:"^"[X KIL
"RTN","FHADM21",7,0)
 W !!,"The report requires a 132 column printer.",!
"RTN","FHADM21",8,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHADM21",9,0)
 I $D(IO("Q")) S FHPGM="Q1^FHADM21",FHLST="EDT^SDT" D EN2^FH G KIL
"RTN","FHADM21",10,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHADM21",11,0)
Q1 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP
"RTN","FHADM21",12,0)
 S X=SDT D DOW^%DTC S DOW=Y+1
"RTN","FHADM21",13,0)
 D NOW^%DTC S DTP=% D DTP^FH S HDT=DTP,PG=0 D HDR
"RTN","FHADM21",14,0)
 K S F K=1:1:21 S S(K)=0
"RTN","FHADM21",15,0)
 S D1=SDT,(ND,TD)=0 F L1=0:0 D N1 S X1=D1,X2=1 D C^%DTC Q:X>EDT  S D1=X,DOW=DOW+1 S:DOW=8 DOW=1
"RTN","FHADM21",16,0)
 F K=1:1:18 S N(K)=$J($S(ND:S(K)/ND,1:0),0,0),N(K)=$J($S(N(K)<1:"",1:N(K)),5)_" ",S(K)=$S(S(K)<1:$J("",6),S(K)<100000:$J(S(K),5)_" ",1:$J(S(K),6))
"RTN","FHADM21",17,0)
 F K=19:1:21 S N(K)=$J($S(TD:S(K)/TD,1:0),0,0),N(K)=$J($S(N(K)<1:"",1:N(K)),5)_" ",S(K)=$S(S(K)<1:$J("",6),S(K)<100000:$J(S(K),5)_" ",1:$J(S(K),6))
"RTN","FHADM21",18,0)
 D LN W !?4,"Total",?15,"|",S(1),S(2),S(3),"|",S(4),S(5),S(6),"|",S(7),S(8),S(9),"|",S(10),"|",S(11),S(13),S(16),"|",S(17),"|",S(18),"|",S(19),S(20),S(21),!
"RTN","FHADM21",19,0)
 W:ND ?4,"Avg. ",?15,"|",N(1),N(2),N(3),"|",N(4),N(5),N(6),"|",N(7),N(8),N(9),"|",N(10),"|",N(11),N(13),N(16),"|",N(17),"|",N(18),"|",N(19),N(20),N(21),!
"RTN","FHADM21",20,0)
 Q
"RTN","FHADM21",21,0)
HDR W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !,HDT,?44,"S E R V E D   M E A L S   W O R K S H E E T",?125,"Page ",PG
"RTN","FHADM21",22,0)
 W !!?(131-$L(DTE)\2),DTE
"RTN","FHADM21",23,0)
 W !!,?15,"|",?32,"MEALS SERVED ON INPATIENT BASIS",?79,"|",?82,"MEALS SERVED TO OTHERS",?105,"| TOTAL| SERVED TRAYS DATA"
"RTN","FHADM21",24,0)
 W !,?15,"|",?19,"DOMICILIARY",?34,"| NURSING HOME CU",?53,"|",?59,"HOSPITAL",?72,"| TOTAL|",?98,"| TOTAL| MEALS|"
"RTN","FHADM21",25,0)
 W !,?15,"|  Inp.  Abs.  Meal|  Inp.  Abs.  Meal|  Inp.  Abs.  Meal|      | Outp.  Paid Grat.|      |      |  Cafe   NPO Trays"
"RTN","FHADM21",26,0)
 W !,?15,"|   A     B     C  |   D     E     F  |   G     H     I  |   J  |   K     M    Q   |      |   R  |   T      U    V"
"RTN","FHADM21",27,0)
LN W ! F K=1:1:131 W "-"
"RTN","FHADM21",28,0)
 Q
"RTN","FHADM21",29,0)
N1 S Y0=$G(^FH(117,D1,0)),Y1=$G(^(1))
"RTN","FHADM21",30,0)
 K N S K=1 F L=1,2,4,5,7,8 S K=K+1,N(L)=$P(Y0,"^",K)
"RTN","FHADM21",31,0)
 S K=10 F L=1:3:16 S K=K+1,N(K)=$P(Y1,"^",L)+$P(Y1,"^",L+1)+$P(Y1,"^",L+2)
"RTN","FHADM21",32,0)
 S N(19)=$P(Y1,"^",19),N(20)=$P(Y1,"^",20)
"RTN","FHADM21",33,0)
 S N(3)=N(1)-N(2)*3,N(6)=N(4)-N(5)*3,N(9)=N(7)-N(8)*3,N(10)=N(3)+N(6)+N(9)
"RTN","FHADM21",34,0)
 S N(16)=N(14)+N(15)+N(16),N(13)=N(12)+N(13),N(17)=N(11)+N(13)+N(16),N(18)=N(10)+N(17),N(19)=N(19)+N(17),N(21)=N(18)-N(19)-N(20) S:N(18) ND=ND+1 S:N(20) TD=TD+1
"RTN","FHADM21",35,0)
 F K=1:1:21 S S(K)=S(K)+N(K)
"RTN","FHADM21",36,0)
 F K=1:1:21 S N(K)=$J($S(N(K)<1:"",1:N(K)),5)_" "
"RTN","FHADM21",37,0)
 S DTP=D1 D DTP^FH D:$Y>(IOSL-8) HDR
"RTN","FHADM21",38,0)
 W !,$P("Sun Mon Tue Wed Thu Fri Sat"," ",DOW)," ",DTP
"RTN","FHADM21",39,0)
 W ?15,"|",N(1),N(2),N(3),"|",N(4),N(5),N(6),"|",N(7),N(8),N(9),"|",N(10),"|",N(11),N(13),N(16),"|",N(17),"|",N(18),"|",N(19),N(20),N(21) Q
"RTN","FHADM21",40,0)
KIL ; Kill all used Variables
"RTN","FHADM21",41,0)
 G KILL^XUSCLEAN
"RTN","FHADM2A")
0^7^B3231538
"RTN","FHADM2A",1,0)
FHADM2A ; HISC/REL/NCA - Calculate NPO/Trays for Served Meals ;6/18/93  14:03
"RTN","FHADM2A",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHADM2A",3,0)
EN1 ; Calculate NPO/Trays
"RTN","FHADM2A",4,0)
 ; Check for multidivisional site
"RTN","FHADM2A",5,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D ^FHMADM2A Q
"RTN","FHADM2A",6,0)
 D NOW^%DTC S NOW=%,DT=NOW\1,(TP,TC,TE,N,R)=0 F K=1:1:5 S S(K)=0
"RTN","FHADM2A",7,0)
 F WRD=0:0 S WRD=$O(^FH(119.6,WRD)) Q:WRD'>0  F DFN=0:0 S DFN=$O(^FHPT("AW",WRD,DFN)) Q:DFN=""  S ADM=^(DFN) D CNT
"RTN","FHADM2A",8,0)
 I '$D(^FH(117,DT,0)) S ^FH(117,DT,0)=DT,^FH(117,"B",DT,DT)="",X0=^FH(117,0),$P(^FH(117,0),"^",3,4)=DT_"^"_($P(X0,"^",4)+1)
"RTN","FHADM2A",9,0)
 S MD=N-R
"RTN","FHADM2A",10,0)
 S $P(^FH(117,DT,1),"^",19,27)=(3*TC)_"^"_(TP-TE*3)_"^"_S(1)_"^"_S(2)_"^"_S(3)_"^"_S(4)_"^"_S(5)_"^"_MD_"^"_N
"RTN","FHADM2A",11,0)
 K %,%H,%I,A1,ADM,DFN,FHORD,K,MD,N,NOW,R,S,TC,TE,TP,TYP,WRD,X0,X1,Y0,ZZ Q
"RTN","FHADM2A",12,0)
CNT Q:'ADM  S TP=TP+1 Q:'$D(^FHPT(DFN,"A",ADM,0))
"RTN","FHADM2A",13,0)
 S X5=$O(^FHPT(DFN,"S",0)) I X5 S X5=$G(^(X5,0))
"RTN","FHADM2A",14,0)
 I  I $P(X5,"^",1)<$P($G(^FHPT(DFN,"A",ADM,0)),"^",1) S X5=5,S(X5)=S(X5)+1 G C1
"RTN","FHADM2A",15,0)
 S X5=$P(X5,"^",2) S:X5=""!(X5>4) X5=5 S S(X5)=S(X5)+1
"RTN","FHADM2A",16,0)
C1 S X0=^FHPT(DFN,"A",ADM,0)
"RTN","FHADM2A",17,0)
 S FHORD=$P(X0,"^",2),X1=$P(X0,"^",3),ZZ=$P(X0,"^",5) Q:'FHORD
"RTN","FHADM2A",18,0)
 S Y0=$G(^FHPT(DFN,"A",ADM,"DI",FHORD,0)) Q:Y0=""
"RTN","FHADM2A",19,0)
 S FHOR=$P(Y0,"^",2,6),FHLD=$P(Y0,"^",7)
"RTN","FHADM2A",20,0)
 I FHLD'="" Q:ZZ=""  S N=N+1 Q
"RTN","FHADM2A",21,0)
 S Z=$P(Y0,"^",13) Q:Z=""  S TE=TE+1,TYP=$P(Y0,"^",8) S:TYP="C" TC=TC+1 S N=N+1
"RTN","FHADM2A",22,0)
 I "1^^^^"[FHOR S R=R+1
"RTN","FHADM2A",23,0)
 Q
"RTN","FHADM3")
0^8^B8659464
"RTN","FHADM3",1,0)
FHADM3 ; HISC/REL - Additional Meals Report ;1/23/98  16:07
"RTN","FHADM3",2,0)
 ;;5.0;Dietetics;**13,39,40**;Oct 11, 1995
"RTN","FHADM3",3,0)
EN1 ; Print Meal Report
"RTN","FHADM3",4,0)
 ; Check for multidivisional site
"RTN","FHADM3",5,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D ^FHMADM3 Q
"RTN","FHADM3",6,0)
 D DT G:"^"[X KIL
"RTN","FHADM3",7,0)
 W !!,"The report requires a 132 column printer.",!
"RTN","FHADM3",8,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHADM3",9,0)
 I $D(IO("Q")) S FHPGM="Q1^FHADM3",FHLST="EDT^SDT" D EN2^FH G KIL
"RTN","FHADM3",10,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHADM3",11,0)
Q1 ; Process Printing the Meal Report
"RTN","FHADM3",12,0)
 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP
"RTN","FHADM3",13,0)
 S X=SDT D DOW^%DTC S DOW=Y+1
"RTN","FHADM3",14,0)
 D NOW^%DTC S DTP=% D DTP^FH S HDT=DTP,PG=0 D HDR
"RTN","FHADM3",15,0)
 K S F K=1:1:22 S S(K)=0
"RTN","FHADM3",16,0)
 S D1=SDT F L1=0:0 D N1 S X1=D1,X2=1 D C^%DTC Q:X>EDT  S D1=X,DOW=DOW+1 S:DOW=8 DOW=1
"RTN","FHADM3",17,0)
 F K=1:1:22 S Z=$S(K<19:5,1:6),S(K)=$S(S(K)<1:$J("",Z),S(K)<10000:$J(S(K),Z-1)_" ",1:$J(S(K),Z))
"RTN","FHADM3",18,0)
 D LN W !,"  Total",?10,"|",S(1),S(2),S(3),S(4),S(5),S(6),S(19)," |",S(7),S(8),S(9),S(10),S(11),S(12),S(20)," |",S(13),S(14),S(15),S(16),S(17),S(18),S(21)," |",S(22),! Q
"RTN","FHADM3",19,0)
HDR W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !,HDT,?50,"A D D I T I O N A L   M E A L S",?125,"Page ",PG
"RTN","FHADM3",20,0)
 W !!?(131-$L(DTE)\2),DTE
"RTN","FHADM3",21,0)
 W !!,?10,"|",?21,"B R E A K F A S T",?48,"|",?64,"N O O N",?86,"|",?99,"E V E N I N G",?124,"| TOTAL"
"RTN","FHADM3",22,0)
 W !,?10,"| Opt. Emp. Paid OOD  Vol. Grt. Total | Opt. Emp. Paid OOD  Vol. Grt. Total | Opt. Emp. Paid OOD  Vol. Grt. Total |"
"RTN","FHADM3",23,0)
LN W !,"-----------------------------------------------------------------------------------------------------------------------------------" Q
"RTN","FHADM3",24,0)
N1 S Y1=$G(^FH(117,D1,1)) F L1=19:1:22 S N(L1)=0
"RTN","FHADM3",25,0)
 S K=0 F L1=1:1:6 F L2=1:1:3 S K=K+1,N=L2-1*6+L1,Z=$P(Y1,"^",K),N(N)=Z,N(18+L2)=N(18+L2)+Z
"RTN","FHADM3",26,0)
 S N(22)=N(19)+N(20)+N(21)
"RTN","FHADM3",27,0)
 F K=1:1:22 S S(K)=S(K)+N(K),N(K)=$J($S(N(K)<1:"",1:N(K)),$S(K<19:4,1:5))_" "
"RTN","FHADM3",28,0)
 S DTP=D1 D DTP^FH D:$Y>(IOSL-8) HDR
"RTN","FHADM3",29,0)
 W !,$P("Sun Mon Tue Wed Thu Fri Sat"," ",DOW)," ",$E(DTP,1,6)
"RTN","FHADM3",30,0)
 W "|",N(1),N(2),N(3),N(4),N(5),N(6),N(19)," |",N(7),N(8),N(9),N(10),N(11),N(12),N(20)," |",N(13),N(14),N(15),N(16),N(17),N(18),N(21)," |",N(22) Q
"RTN","FHADM3",31,0)
DT ; Get From/To Dates
"RTN","FHADM3",32,0)
D1 S %DT="AEPX",%DT("A")="Starting Date: " W ! D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D1 S SDT=+Y
"RTN","FHADM3",33,0)
 I SDT'<DT W *7,"  [Must Start before Today!] " G D1
"RTN","FHADM3",34,0)
D2 S %DT="AEPX",%DT("A")=" Ending Date: " D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D2 S EDT=+Y
"RTN","FHADM3",35,0)
 I EDT'<DT W *7,"  [Must End before Today!] " G D2
"RTN","FHADM3",36,0)
 I EDT<SDT W *7,"  [End before Start?] " G D1
"RTN","FHADM3",37,0)
 Q
"RTN","FHADM3",38,0)
KIL G KILL^XUSCLEAN
"RTN","FHADM4")
0^9^B15416996
"RTN","FHADM4",1,0)
FHADM4 ; HISC/REL/NCA - Staffing Data Report ;1/23/98  16:08
"RTN","FHADM4",2,0)
 ;;5.0;Dietetics;**13,39,40**;Oct 11, 1995
"RTN","FHADM4",3,0)
EN1 ; Enter/Edit Staffing Data
"RTN","FHADM4",4,0)
 ; Check for multidivisional site
"RTN","FHADM4",5,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D EN1^FHMADM4 Q
"RTN","FHADM4",6,0)
 D NOW^%DTC S DT=%\1
"RTN","FHADM4",7,0)
E1 S %DT="AEPX",%DT("A")="STAFFING DATA Date: " W ! D ^%DT G KIL:"^"[X!$D(DTOUT),E1:Y<1
"RTN","FHADM4",8,0)
 S DA=+Y I DA>DT W *7,!!,"** Date must not be in the future!",! G E1
"RTN","FHADM4",9,0)
 K DIC,DIE S DIE="^FH(117.1," I '$D(^FH(117.1,DA,0)) S ^FH(117.1,DA,0)=DA,^FH(117.1,"B",DA,DA)="",X0=^FH(117.1,0),$P(^FH(117.1,0),"^",3,4)=DA_"^"_($P(X0,"^",4)+1)
"RTN","FHADM4",10,0)
 S X1=DA,X2=-1 D C^%DTC S DM1=X,FHX1=$P($G(^FH(117.1,DM1,0)),"^",2,6)
"RTN","FHADM4",11,0)
 S DR="[FHADM4]" D ^DIE G EN1
"RTN","FHADM4",12,0)
EN2 ; Print Staffing Data Report
"RTN","FHADM4",13,0)
 ; Check for multidivisional site
"RTN","FHADM4",14,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D EN2^FHMADM4 Q
"RTN","FHADM4",15,0)
 D DT^FHADM2 G:"^"[X KIL
"RTN","FHADM4",16,0)
 W !!,"The report requires a 132 column printer.",!
"RTN","FHADM4",17,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHADM4",18,0)
 I $D(IO("Q")) S FHPGM="Q1^FHADM4",FHLST="EDT^SDT" D EN2^FH G KIL
"RTN","FHADM4",19,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHADM4",20,0)
Q1 ; Process Printing Staffing Report
"RTN","FHADM4",21,0)
 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP
"RTN","FHADM4",22,0)
 S X=SDT D DOW^%DTC S DOW=Y+1
"RTN","FHADM4",23,0)
 D NOW^%DTC S DTP=% D DTP^FH S HDT=DTP,PG=0 D HDR
"RTN","FHADM4",24,0)
 K S,AV F K=1:1:23 S S(K)=0
"RTN","FHADM4",25,0)
 S SIZ="61 51 51 51 51 50 30 30 30 30 30 30 30 30 30 30 30 30 30 51 50 50 50"
"RTN","FHADM4",26,0)
 S D1=SDT,(ND,FHTOT,TO1,TOT)=0 F L1=0:0 D N1 S X1=D1,X2=1 D C^%DTC Q:X>EDT  S D1=X,DOW=DOW+1 S:DOW=8 DOW=1
"RTN","FHADM4",27,0)
 D LN G:ND>62 Q2
"RTN","FHADM4",28,0)
 W !?7,"Total",?15 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(S(K),$E(X,1)+1,$E(X,2))
"RTN","FHADM4",29,0)
Q2 I ND W !?7,"Avg.",?15 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(S(K)/ND,$E(X,1)+1,$E(X,2))
"RTN","FHADM4",30,0)
 I S(22) W !?7,"% Paid",?68 F K=8,9,10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(S(K)/S(22)*100,$E(X,1)+1,0)
"RTN","FHADM4",31,0)
 I TOT W !!?7,"Adjustment for Unscheduled and Intermittent",!!?7,"UNS/INT Total " S TOT=TOT/8 W $J(TOT,5,1)," FTEE",!?7,"Adjusted Measured FTEE " S TOT=TOT+TO1 W $J(TOT,6,1) I ND W !?7,"Avg Measured FTEE       ",$J(TOT/ND,5,1)
"RTN","FHADM4",32,0)
 I FHTOT S MAN=S(22)*60 W !!?7,"Man Minutes/Meal:    ",$J(MAN/FHTOT,0,0)
"RTN","FHADM4",33,0)
 W ! Q
"RTN","FHADM4",34,0)
HDR W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !?4,HDT,?44,"S T A F F I N G   D A T A   W O R K S H E E T",?122,"Page ",PG
"RTN","FHADM4",35,0)
 W !!?(132-$L(DTE)\2),DTE
"RTN","FHADM4",36,0)
 W !!?15,"| DAILY| CLIN|ADMIN| SUPP| SUPV| MEAS| POT | OFF |WOP| OT|UNS|INT| PAID|COP| AL| SL|OTH|LND|CMP|TRN|VOL|BOR|TOTAL"
"RTN","FHADM4",37,0)
 W !?15,"|  FTEE| FTEE| FTEE| FTEE| FTEE| FTEE| HRS | HRS |HRS|HRS|HRS|HRS| HRS |HRS|HRS|HRS|HRS|HRS|HRS|HRS|HRS|HRS| HRS"
"RTN","FHADM4",38,0)
LN W !?4,"----------------------------------------------------------------------------------------------------------------------------" Q
"RTN","FHADM4",39,0)
N1 S Y0=$G(^FH(117.1,D1,0)),ND=ND+1
"RTN","FHADM4",40,0)
 S DTP=D1 D DTP^FH D:$Y>(IOSL-8) HDR
"RTN","FHADM4",41,0)
 K N F L=2:1:20 S N(L-1)=$P(Y0,"^",L)
"RTN","FHADM4",42,0)
 S N(20)=N(1)-N(2)-N(3)-N(4)-N(5),N(21)=N(20)*8
"RTN","FHADM4",43,0)
 S N(22)=N(21)-N(6)-N(7)+N(8)+N(9)+N(10),N(23)=N(22)-N(11)-N(12)-N(13)-N(14)-N(15)+N(16)+N(17)+N(18)+N(19),TOT=TOT+N(9)+N(10),TO1=TO1+N(20)
"RTN","FHADM4",44,0)
 W !?4,$P("Sun Mon Tue Wed Thu Fri Sat"," ",DOW)," ",$E(DTP,1,6)," "
"RTN","FHADM4",45,0)
 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S S(K)=S(K)+N(K),X=$P(SIZ," ",K),N(K)=$S('N(K):$J("",$E(X,1)),1:$J(N(K),$E(X,1),$E(X,2))) W "|",N(K)
"RTN","FHADM4",46,0)
 D M1
"RTN","FHADM4",47,0)
 Q
"RTN","FHADM4",48,0)
M1 ; Get total Meals
"RTN","FHADM4",49,0)
 S Y1=$G(^FH(117,D1,0)) Q:Y1=""  S Y2=$G(^FH(117,D1,1))
"RTN","FHADM4",50,0)
 K M S K=1 F L=1,2,4,5,7,8 S K=K+1,M(L)=$P(Y1,"^",K)
"RTN","FHADM4",51,0)
 S K=10 F L=1:3:16 S K=K+1,M(K)=$P(Y2,"^",L)+$P(Y2,"^",L+1)+$P(Y2,"^",L+2)
"RTN","FHADM4",52,0)
 S M(3)=M(1)-M(2)*3,M(6)=M(4)-M(5)*3,M(9)=M(7)-M(8)*3
"RTN","FHADM4",53,0)
 S M(10)=M(3)+M(6)+M(9)
"RTN","FHADM4",54,0)
 S M(16)=M(14)+M(15)+M(16),M(13)=M(12)+M(13),M(17)=M(11)+M(13)+M(16),M(18)=M(10)+M(17)
"RTN","FHADM4",55,0)
 S FHTOT=FHTOT+M(18) Q
"RTN","FHADM4",56,0)
KIL G KILL^XUSCLEAN
"RTN","FHASE")
0^10^B19929165
"RTN","FHASE",1,0)
FHASE ; HISC/REL/NCA - Dietetic Encounters ;7/22/96  13:17
"RTN","FHASE",2,0)
 ;;5.0;Dietetics;**5,7,39,40**;Jun 07, 1995
"RTN","FHASE",3,0)
EN1 ; Enter/Edit Encounter Types
"RTN","FHASE",4,0)
 S (DIC,DIE)="^FH(115.6,",DIC(0)="AEQLM",DIC("DR")=".01",DLAYGO=115.6 W ! D ^DIC K DIC,DLAYGO G KIL:"^"[X!$D(DTOUT),EN1:Y<1
"RTN","FHASE",5,0)
 S DA=+Y,DR=$S(DA=1:2,DA=2:"2;3",1:".01;1:4;10;5:6;I X'=""Y"" S Y=99;7;8;99") S:$D(^XUSEC("FHMGR",DUZ)) DIDEL=115.6 D ^DIE,KIL G EN1
"RTN","FHASE",6,0)
EN2 ; List Encounter Types
"RTN","FHASE",7,0)
 W ! S L=0,DIC="^FH(115.6,",FLDS=".01,2,3,4,10,5,6,7,8,99",BY=".01"
"RTN","FHASE",8,0)
 S (FR,TO)="",DHD="ENCOUNTER TYPES" D EN1^DIP,RSET Q
"RTN","FHASE",9,0)
EN3 ; Enter Dietetic Encounter
"RTN","FHASE",10,0)
 ; Check for multidivisional site
"RTN","FHASE",11,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D EN3^FHMASE Q
"RTN","FHASE",12,0)
 W ! K DIR S FHN=0,DIR(0)="YAO",DIR("A")="Enter a NEW Encounter (Y/N)? " D ^DIR G:$D(DIROUT)!($D(DIRUT)) KIL K DIR,DIROUT,DIRUT
"RTN","FHASE",13,0)
 I 'Y S FHN=1 G EN4
"RTN","FHASE",14,0)
EN30 ; Enter/Edit a Encounter
"RTN","FHASE",15,0)
 D EN31 G:Y<1 KIL G EN3
"RTN","FHASE",16,0)
EN31 ; Enter a Encounter
"RTN","FHASE",17,0)
 K %DT S %DT="AETPX",%DT("A")="DATE/TIME OF ENCOUNTER: ",%DT("B")="TODAY",%DT(0)="-NOW" W ! D ^%DT K %DT S:$D(DTOUT) Y=0 Q:Y<1  S DTE=Y
"RTN","FHASE",18,0)
 K DIC,DD,DO S DIC="^FHEN(",DIC(0)="L",DIC("DR")="1////^S X=DTE",DLAYGO=115.7
"RTN","FHASE",19,0)
A L +^FHEN(0) S DA=$P(^FHEN(0),"^",3)+1 I $D(^FHEN(DA)) S $P(^FHEN(0),"^",3)=DA L -^FHEN(0) G A
"RTN","FHASE",20,0)
 S (X,DINUM)=DA D FILE^DICN L -^FHEN(0) S ASE=+Y,FHX4="" K DIC,DLAYGO,DINUM
"RTN","FHASE",21,0)
 D EDIT Q
"RTN","FHASE",22,0)
EN4 ; Process Edit Encounter
"RTN","FHASE",23,0)
 W ! K ^TMP($J,"ECTR"),%DT S %DT="AEPX",%DT("A")="Enter Date of Encounter you want to edit: " D ^%DT K %DT S:$D(DTOUT) Y=0 G:Y<1 KIL S X1=Y,(TIM,X1)=X1-.0001,(EDT,X2)=Y\1+.3,CTR=0
"RTN","FHASE",24,0)
A0 W !! K DIR S DIR(0)="SO^C:CLINICIAN;P:PATIENT",DIR("A")="CHOOSE CLINICIAN or PATIENT" D ^DIR K DIR G:$D(DIROUT)!($D(DIRUT)) KIL I Y?1"P" D PAT G:'DFN KIL D PR G:Y<1 KIL D ASK G KIL:Y<1,EN4
"RTN","FHASE",25,0)
A1 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),A1:Y<1 S NAM=+Y D CLIN,PR G:Y<1 KIL D ASK G KIL:Y<1,EN4
"RTN","FHASE",26,0)
PR W ! S K1="" F CTR=0:0 S CTR=$O(^TMP($J,"ECTR",CTR)) Q:CTR<1  S X=$G(^(CTR,0)),K1=CTR W !,CTR,"  " S Y=$P(X,"^",2) X ^DD("DD") W Y,"  ",$P(X,"^",3) K Y
"RTN","FHASE",27,0)
 I 'K1 W !?5,"No encounter on file on this date" S Y=0 Q
"RTN","FHASE",28,0)
 W !!,"Select number you want: " R X:DTIME I '$T!("^"[X) S Y=0 Q
"RTN","FHASE",29,0)
 I X'?1.N!(X<1)!(X>K1) W *7,!!,"Select only a number no greater than ",K1," or press ""^"" or a return to exit." G PR
"RTN","FHASE",30,0)
 S ASE=$P($G(^TMP($J,"ECTR",+X,0)),"^",1),FHX4=$G(^FHEN(ASE,0))
"RTN","FHASE",31,0)
 S FHCLK=$P($G(^TMP($J,"ECTR",+X,0)),"^",4) W !
"RTN","FHASE",32,0)
EDIT N FHX1 S DA=ASE K DIC,DIE S DIE="^FHEN(",DR="[FHASE]" D ^DIE K DIC,DIE,DR
"RTN","FHASE",33,0)
 S DA=ASE,X=^FHEN(DA,0)
"RTN","FHASE",34,0)
 I '$P(X,"^",3)!('$P(X,"^",4)) S DIK="^FHEN(" D ^DIK W *7,!,"<encounter deleted>" K DIK,DA
"RTN","FHASE",35,0)
 S Y=1 Q
"RTN","FHASE",36,0)
PAT ; Get Patient
"RTN","FHASE",37,0)
 S ALL=1 D ^FHDPA Q:'DFN
"RTN","FHASE",38,0)
 I $P($G(^DPT(DFN,.35)),"^",1) W *7,!!?5,"Patient has expired." G PAT
"RTN","FHASE",39,0)
 I '$D(^FHEN("AP",DFN)) W !!,"No Encounter on file for this patient." G PAT
"RTN","FHASE",40,0)
 F DTE=TIM:0 S DTE=$O(^FHEN("AP",DFN,DTE)) Q:DTE<1!(DTE>EDT)  F ASE=0:0 S ASE=$O(^FHEN("AP",DFN,DTE,ASE)) Q:ASE<1  S Y=$P($G(^FHEN(ASE,0)),"^",4) I Y>2 D
"RTN","FHASE",41,0)
 .S CTR=CTR+1,^TMP($J,"ECTR",CTR,0)=ASE_"^"_DTE_"^"_$P($G(^FH(115.6,+Y,0)),"^",1)_"^"_$P($G(^FHEN(ASE,0)),"^",13) Q
"RTN","FHASE",42,0)
 Q
"RTN","FHASE",43,0)
CLIN ; Get Clinician
"RTN","FHASE",44,0)
 S X1=$O(^FHEN("AT",X1)) Q:X1<1!(X1>X2)
"RTN","FHASE",45,0)
 S ASE=0
"RTN","FHASE",46,0)
R1 S ASE=$O(^FHEN("AT",X1,ASE)) G:ASE="" CLIN
"RTN","FHASE",47,0)
 S Y=$G(^FHEN(ASE,0)),E1=$P(Y,"^",3) I $P(Y,"^",4)>2,E1,E1=NAM S CTR=CTR+1,^TMP($J,"ECTR",CTR,0)=ASE_"^"_$P(Y,"^",2)_"^"_$P($G(^FH(115.6,+$P(Y,"^",4),0)),"^",1)_"^"_$P(Y,"^",13),DTE=$P(Y,"^",2)
"RTN","FHASE",48,0)
 G R1
"RTN","FHASE",49,0)
ASK R !!,"Is this correct? Y// ",YN:DTIME I '$T!(YN["^") S Y=0 Q
"RTN","FHASE",50,0)
 S:YN="" YN="Y" S X=YN D TR^FH S YN=X
"RTN","FHASE",51,0)
 I $P("YES",YN,1)'="",$P("NO",YN,1)'="" W *7," Answer YES or NO" G ASK
"RTN","FHASE",52,0)
 Q:YN?1"Y".E
"RTN","FHASE",53,0)
 I FHCLK'=DUZ W !!,"You can ONLY DELETE an encounter that is entered by you.",! G EDIT
"RTN","FHASE",54,0)
E5 R !,"Want to delete encounter? N// ",YN:DTIME I '$T!(YN["^") S Y=0 Q
"RTN","FHASE",55,0)
 S:YN="" YN="N" S X=YN D TR^FH S YN=X
"RTN","FHASE",56,0)
 I $P("YES",YN,1)'="",$P("NO",YN,1)'="" W *7," Answer YES or NO" G E5
"RTN","FHASE",57,0)
 Q:YN?1"N".E
"RTN","FHASE",58,0)
 S DIK="^FHEN(",DA=ASE D ^DIK W *7,!,"<encounter deleted>" K DA,DIK S Y=1 Q
"RTN","FHASE",59,0)
CNT S FHX3=FHX3+$P($G(^FHEN(ASE,"P",0)),"^",4)
"RTN","FHASE",60,0)
 S ST="" F LP=0:0 S LP=$O(^FHEN(ASE,"P",LP)) Q:LP<1  S ST=$G(^(LP,0)) I $P(ST,"^",3)'<1 S FHX3=FHX3+$P(ST,"^",3)
"RTN","FHASE",61,0)
 Q
"RTN","FHASE",62,0)
RSET K %ZIS S IOP="" D ^%ZIS
"RTN","FHASE",63,0)
KIL K ^TMP($J,"ECTR") G KILL^XUSCLEAN
"RTN","FHASE1")
0^11^B6349078
"RTN","FHASE1",1,0)
FHASE1 ; HISC/REL/NCA - Encounter Statistics ;3/6/95  11:57
"RTN","FHASE1",2,0)
 ;;5.0;Dietetics;**39,40**;Oct 11, 1995
"RTN","FHASE1",3,0)
 ; Check for multidivisional site
"RTN","FHASE1",4,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D ^FHMASE1 Q
"RTN","FHASE1",5,0)
 D DT G:U[X KIL G A0
"RTN","FHASE1",6,0)
IND ; List Encounters for a clinician
"RTN","FHASE1",7,0)
 ; Check for multidivisional site
"RTN","FHASE1",8,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D IND^FHMASE1 Q
"RTN","FHASE1",9,0)
 D DT G:U[X KIL S FHX1=DUZ,FHX2=0 G F1
"RTN","FHASE1",10,0)
A0 R !!,"Statistics for ALL Clinicians? Y// ",X:DTIME G:'$T!(X["^") KIL S:X="" X="Y" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7," Answer YES or NO" G A0
"RTN","FHASE1",11,0)
 I X?1"Y".E G F0
"RTN","FHASE1",12,0)
A1 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),A1:Y<1 S FHX1=+Y,FHX2=1 G F2
"RTN","FHASE1",13,0)
F0 R !!,"Break-down by Clinician? Y// ",X:DTIME G:'$T!(X=U) KIL S:X="" X="Y" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7," Answer YES or NO" G F0
"RTN","FHASE1",14,0)
 S FHX1=X?1"Y".E-1,FHX2=0
"RTN","FHASE1",15,0)
F1 I FHX1'<0 R !!,"List Individual Patient Encounters? N// ",X:DTIME G:'$T!(X=U) KIL S:X="" X="N" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7," Answer YES or NO" G F1
"RTN","FHASE1",16,0)
 S:FHX1'<0 FHX2=X?1"Y".E
"RTN","FHASE1",17,0)
F2 W !!,"The report requires a 132 column printer.",!
"RTN","FHASE1",18,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHASE1",19,0)
 I $D(IO("Q")) S FHPGM="Q1^FHASE1A",FHLST="EDT^SDT^FHX1^FHX2" D EN2^FH G KIL
"RTN","FHASE1",20,0)
 U IO D Q1^FHASE1A D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHASE1",21,0)
KIL K ^TMP($J) G KILL^XUSCLEAN
"RTN","FHASE1",22,0)
DT ; Get From/To Dates
"RTN","FHASE1",23,0)
D1 S %DT="AEPX",%DT("A")="Starting Date: " W ! D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D1 S SDT=+Y
"RTN","FHASE1",24,0)
 I SDT>DT W *7,"  [Cannot Start after Today!] " G D1
"RTN","FHASE1",25,0)
D2 S %DT="AEPX",%DT("A")=" Ending Date: " D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D2 S EDT=+Y
"RTN","FHASE1",26,0)
 I EDT<SDT W *7,"  [End before Start?] " G D1
"RTN","FHASE1",27,0)
 I EDT>DT W *7,"  [Must Not enter date greater than Today!] " G D1
"RTN","FHASE1",28,0)
 Q
"RTN","FHASE1A")
0^12^B20025721
"RTN","FHASE1A",1,0)
FHASE1A ; HISC/REL/NCA - Encounter Statistics (cont.) ;9/6/94  13:13 
"RTN","FHASE1A",2,0)
 ;;5.0;Dietetics;**39,40**;Oct 11, 1995
"RTN","FHASE1A",3,0)
Q1 ; Calculate the Encounters
"RTN","FHASE1A",4,0)
 K ^TMP($J) S X1=SDT\1-.0001,X2=EDT\1+.3
"RTN","FHASE1A",5,0)
 S TIT=";"_$P(^DD(115.6,10,0),"^",3)
"RTN","FHASE1A",6,0)
R1 S X1=$O(^FHEN("AT",X1)) I X1<1!(X1>X2) G P1
"RTN","FHASE1A",7,0)
 S E1=0
"RTN","FHASE1A",8,0)
R2 S E1=$O(^FHEN("AT",X1,E1)) G:E1="" R1
"RTN","FHASE1A",9,0)
 S Y=$G(^FHEN(E1,0))
"RTN","FHASE1A",10,0)
 S D1=$P(Y,"^",3),D2=$P(Y,"^",4) G:'D2 R2 I FHX1>0,D1'=FHX1 G R2
"RTN","FHASE1A",11,0)
 S D6=$P(Y,"^",7),D3=$P(Y,"^",8),D9=$P(Y,"^",9),D5=$P(Y,"^",11) D CNT
"RTN","FHASE1A",12,0)
 S D2=$P($G(^FH(115.6,D2,0)),"^",1,2) G:"^"[D2 R2
"RTN","FHASE1A",13,0)
 S Z1=$P(D2,"^",2),D2=$P(D2,"^",1)
"RTN","FHASE1A",14,0)
 S D8=$F(TIT,";"_Z1_":") G:D8<0 R2
"RTN","FHASE1A",15,0)
 S:D6="F" D2=D2_"~F"
"RTN","FHASE1A",16,0)
 S S1=$G(^TMP($J,0,D8,D2)) D UPD S ^TMP($J,0,D8,D2)=S1
"RTN","FHASE1A",17,0)
 G R2:FHX1<0,R2:'D1 I '$D(^TMP($J,D1)) S NAM=$P(^VA(200,D1,0),"^",1),^TMP($J,$E(NAM,1,30),D1)=""
"RTN","FHASE1A",18,0)
 S S1=$G(^TMP($J,D1,D8,D2)) D UPD S ^TMP($J,D1,D8,D2)=S1 G:'FHX2 R2
"RTN","FHASE1A",19,0)
 S (DTP,W1)=$P(Y,"^",2)\1 D DTP^FH I '$D(^TMP($J,D1,D8,D2,W1)) S ^TMP($J,D1,D8,D2,W1)=DTP,^(W1,0)=0
"RTN","FHASE1A",20,0)
 I '$D(^FHEN(E1,"P")) G R4
"RTN","FHASE1A",21,0)
 F DFN=0:0 S DFN=$O(^FHEN(E1,"P",DFN)) Q:DFN<1  D R3
"RTN","FHASE1A",22,0)
 G R2
"RTN","FHASE1A",23,0)
R3 S L=^TMP($J,D1,D8,D2,W1,0)+1,^(0)=L
"RTN","FHASE1A",24,0)
 S ^TMP($J,D1,D8,D2,W1,L)=DFN Q
"RTN","FHASE1A",25,0)
R4 S DFN="^"_D5 D R3 G R2
"RTN","FHASE1A",26,0)
CNT S C(8)=$P(Y,"^",10),(C(1),C(2),C(3),C(4),C(5),C(6),C(7))=0
"RTN","FHASE1A",27,0)
 F DFN=0:0 S DFN=$O(^FHEN(E1,"P",DFN)) Q:DFN<1  S X=^(DFN,0) D C1
"RTN","FHASE1A",28,0)
 S C(7)=C(8)-C(1)-C(2)-C(4)-C(5) S:C(7)<1 C(7)=0
"RTN","FHASE1A",29,0)
 I D9'="I" S TM=C(1)+C(4)+C(7) I TM S TM=D3/TM,C(3)=TM*C(1),C(6)=TM*C(4),C(3)=$J(C(3),0,1),C(6)=$J(C(6),0,1) Q
"RTN","FHASE1A",30,0)
 Q
"RTN","FHASE1A",31,0)
C1 S Z=$P(X,"^",2) G:Z<1 C2 S Z=$P($G(^SC(+Z,0)),"^",3) G:Z'="W" C2
"RTN","FHASE1A",32,0)
 S C(1)=C(1)+1,C(2)=C(2)+$P(X,"^",3) S:D9="I" C(3)=C(3)+D3 Q
"RTN","FHASE1A",33,0)
C2 S C(4)=C(4)+1,C(5)=C(5)+$P(X,"^",3) S:D9="I" C(6)=C(6)+D3 Q
"RTN","FHASE1A",34,0)
UPD S $P(S1,"^",1)=$P(S1,"^",1)+1,$P(S1,"^",2)=$P(S1,"^",2)+D3
"RTN","FHASE1A",35,0)
 F K=1:1:8 I C(K) S $P(S1,"^",K+2)=$P(S1,"^",K+2)+C(K)
"RTN","FHASE1A",36,0)
 Q
"RTN","FHASE1A",37,0)
P1 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP,PG=0 D HEAD I FHX1>0 G D0
"RTN","FHASE1A",38,0)
 S D8="",CT=0 F K=1:1:11 S (I(K),J(K))=0
"RTN","FHASE1A",39,0)
 F KK=0:0 S D8=$O(^TMP($J,0,D8)) Q:D8=""  S CT=CT+1 D:CT'=1 STOT W ! D PR S NX="" F K=0:0 S NX=$O(^TMP($J,0,D8,NX)) Q:NX=""  S X1=$P(NX,"~",1)_$S($P(NX,"~",2)="F":"  (F)",1:"") Q:X1=""  S S1=^TMP($J,0,D8,NX) D PP
"RTN","FHASE1A",40,0)
 D STOT W ! S X="T O T A L" D TOT W ! Q:FHX1<0  D HEAD
"RTN","FHASE1A",41,0)
D0 S NX=":" F K=0:0 S NX=$O(^TMP($J,NX)) Q:NX=""  F D1=0:0 S D1=$O(^TMP($J,NX,D1)) Q:D1<1  D P2
"RTN","FHASE1A",42,0)
 W ! Q
"RTN","FHASE1A",43,0)
P2 D:$Y>55 HEAD W !!,NX S D8="",CT=0 F K=1:1:11 S (I(K),J(K))=0
"RTN","FHASE1A",44,0)
 F L=0:0 S D8=$O(^TMP($J,D1,D8)) Q:D8=""  S CT=CT+1 D:CT'=1 STOT W ! D PR S D2="" F L1=0:0 S D2=$O(^TMP($J,D1,D8,D2)) Q:D2=""  S S1=^(D2),X1=$P(D2,"~",1)_$S($P(D2,"~",2)="F":"  (F)",1:"") D PP I FHX2 D P3
"RTN","FHASE1A",45,0)
 D STOT W ! S X="TOTAL ENCOUNTERS" D TOT Q
"RTN","FHASE1A",46,0)
P3 S DTP=""
"RTN","FHASE1A",47,0)
P4 S DTP=$O(^TMP($J,D1,D8,D2,DTP)) Q:DTP=""  S S1=^(DTP),W1=0
"RTN","FHASE1A",48,0)
P5 S W1=$O(^TMP($J,D1,D8,D2,DTP,W1)) G:W1="" P4 S DFN=^(W1) G:DFN<1 P6
"RTN","FHASE1A",49,0)
 S Y=$G(^DPT(DFN,0)) G:Y="" P5 D PID^FHDPA
"RTN","FHASE1A",50,0)
 W !?7,S1,?17,BID,?26,$P(Y,"^",1) G P5
"RTN","FHASE1A",51,0)
P6 W !?7,S1,?17,$P(DFN,"^",2) G P5
"RTN","FHASE1A",52,0)
PP D:$Y>58 HEAD W !?5,X1,?47,$J($P(S1,"^",1),6,0) S I(1)=I(1)+$P(S1,"^",1),J(1)=J(1)+$P(S1,"^",1)
"RTN","FHASE1A",53,0)
 F K=1:1:6 S Z=$P(S1,"^",K+2),I(K+2)=I(K+2)+Z,J(K+2)=J(K+2)+Z W $S(K=3!(K=6):$S(Z:$J(Z,8,1),1:$J("",8)),1:$J($S(Z:Z,1:""),6))
"RTN","FHASE1A",54,0)
 S Z=$P(S1,"^",9),I(9)=I(9)+$S(Z'<1:Z,1:0),J(9)=J(9)+$S(Z'<1:Z,1:0) W ?97,$J($S(Z'<1:Z,1:""),6)
"RTN","FHASE1A",55,0)
 I Z S Z=$P(S1,"^",2)-$P(S1,"^",5)-$P(S1,"^",8),I(10)=I(10)+$S(Z'<1:Z,1:0),J(10)=J(10)+$S(Z'<1:Z,1:0)
"RTN","FHASE1A",56,0)
 W $S(Z'<1:$J(Z,8,1),1:$J("",8))
"RTN","FHASE1A",57,0)
 S Z=$P(S1,"^",10),I(11)=I(11)+Z,J(11)=J(11)+Z W ?113,$J($S(Z'<1:Z,1:""),6)
"RTN","FHASE1A",58,0)
 I $P(S1,"^",2) W $J($P(S1,"^",2),8,1) S I(2)=I(2)+$P(S1,"^",2),J(2)=J(2)+$P(S1,"^",2)
"RTN","FHASE1A",59,0)
 Q
"RTN","FHASE1A",60,0)
PR S X=$P($E(TIT,D8,999),";",1)
"RTN","FHASE1A",61,0)
 D:$Y>55 HEAD W !?3,X Q
"RTN","FHASE1A",62,0)
STOT W !?5,"Subtotal",?47,$J(J(1),6) F K=1:1:6 W $S(K=3!(K=6):$S(J(K+2):$J(J(K+2),8,1),1:$J("",8)),1:$J($S(J(K+2):J(K+2),1:""),6))
"RTN","FHASE1A",63,0)
 W ?97,$S(J(9):$J(J(9),6),1:$J("",6)),$S(J(10):$J(J(10),8,1),1:$J("",8))
"RTN","FHASE1A",64,0)
 W ?113,$S(J(11):$J(J(11),6),1:$J("",6)),$S(J(2):$J(J(2),8,1),1:$J("",8))
"RTN","FHASE1A",65,0)
 F K=1:1:11 S J(K)=0
"RTN","FHASE1A",66,0)
 Q
"RTN","FHASE1A",67,0)
TOT W !?3,X,?47,$J(I(1),6) F K=1:1:6 W $S(K=3!(K=6):$S(I(K+2):$J(I(K+2),8,1),1:$J("",8)),1:$J($S(I(K+2):I(K+2),1:""),6))
"RTN","FHASE1A",68,0)
 W ?97,$S(I(9):$J(I(9),6),1:$J("",6)),$S(I(10):$J(I(10),8,1),1:$J("",8))
"RTN","FHASE1A",69,0)
 W ?113,$S(I(11):$J(I(11),6),1:$J("",6)),$S(I(2):$J(I(2),8,1),1:$J("",8)) Q
"RTN","FHASE1A",70,0)
HEAD W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !?30,"D I E T E T I C   E N C O U N T E R   S T A T I S T I C S",?120,"Page ",PG
"RTN","FHASE1A",71,0)
 W !!?(114-$L(DTE)\2),DTE,!?47,"Number      Inpatients         Outpatients            Others           Total"
"RTN","FHASE1A",72,0)
 W !?56,"Pat   Col   Units   Pat   Col   Units",?98,"Persn   Units   Persn   Units",! Q
"RTN","FHASE3")
0^13^B2086750
"RTN","FHASE3",1,0)
FHASE3 ; HISC/REL - Encounter Utilities ;5/7/92  08:46
"RTN","FHASE3",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHASE3",3,0)
FIL ; File encounter - DTE date/time   S1 enc. ident   S2 I/F   S3 comment
"RTN","FHASE3",4,0)
 S S1=$O(^FH(115.6,"AX",S1,"")) Q:S1<1
"RTN","FHASE3",5,0)
 K DIC,DD,DO S DIC="^FHEN(",DIC(0)="L",DLAYGO=115.7
"RTN","FHASE3",6,0)
F1 L +^FHEN(0) S DA=$P(^FHEN(0),"^",3)+1 I $D(^FHEN(DA)) S $P(^FHEN(0),"^",3)=DA L -^FHEN(0) G F1
"RTN","FHASE3",7,0)
 ;
"RTN","FHASE3",8,0)
 S (X,FHDA,DINUM)=DA D FILE^DICN L -^FHEN(0) S ASE=+Y K DIC,DLAYGO,DINUM
"RTN","FHASE3",9,0)
 S DTE=+DTE,S4=$S(S2="I":3,1:4),S4=$S($D(^FH(115.6,S1,0)):$P(^(0),"^",S4),1:0)
"RTN","FHASE3",10,0)
 S S5=$G(^DPT(DFN,.1)) S:S5'="" S5=$O(^DIC(42,"B",S5,0)) S S5=$G(^DIC(42,+S5,44))
"RTN","FHASE3",11,0)
 S ^FHEN(ASE,0)=ASE_"^"_DTE_"^"_DUZ_"^"_S1_"^^^"_S2_"^"_S4_"^I^1^^^"_DUZ_"^"_NOW
"RTN","FHASE3",12,0)
 S ^FHEN(ASE,"P",0)="^115.701P^"_DFN_"^1"
"RTN","FHASE3",13,0)
 S ^FHEN(ASE,"P",DFN,0)=DFN_"^"_S5_"^^"_S3
"RTN","FHASE3",14,0)
 S ^FHEN(ASE,"P","B",DFN,DFN)="",^FHEN("AP",DFN,DTE,ASE)="",^FHEN("AT",DTE,ASE)=""
"RTN","FHASE3",15,0)
 ;
"RTN","FHASE3",16,0)
 ; IF MULTIDIVISIONAL SITE STORE COMMUNICATIONS OFFICE CODE
"RTN","FHASE3",17,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D
"RTN","FHASE3",18,0)
 .S DA=FHDA,DIE="^FHEN(",DR="11////^S X=FHCOMM"
"RTN","FHASE3",19,0)
 .D ^DIE
"RTN","FHASE3",20,0)
 ;
"RTN","FHASE3",21,0)
 K ASE,DTE,S1,S2,S3,S4,S5 Q
"RTN","FHASM1")
0^4^B18566049
"RTN","FHASM1",1,0)
FHASM1 ; HISC/REL - Nutrition Assessment ;1/25/00  12:08
"RTN","FHASM1",2,0)
 ;;5.0;Dietetics;**2,4,22,24,40**;Oct 11, 1995
"RTN","FHASM1",3,0)
 W @IOF,!!?20,"N U T R I T I O N   A S S E S S M E N T",!! S X="T",%DT="X" D ^%DT S DT=+Y
"RTN","FHASM1",4,0)
F1 ; Select Patient
"RTN","FHASM1",5,0)
 S ALL=1 D ^FHDPA G PAT:X="*",KIL:'DFN S Y(0)=^DPT(DFN,0),NAM=$P(Y(0),U,1),SEX=$P(Y(0),U,2),AGE=$P(Y(0),U,3)
"RTN","FHASM1",6,0)
 I $P($G(^DPT(DFN,.35)),"^",1) W *7,!!?5,"  [ Patient has expired. ]" G KIL
"RTN","FHASM1",7,0)
 I AGE'="" S AGE=$E(DT,1,3)-$E(AGE,1,3)-($E(DT,4,7)<$E(AGE,4,7))
"RTN","FHASM1",8,0)
 I SEX=""!(AGE="") G P1
"RTN","FHASM1",9,0)
F2 S X="NOW",%DT="XT" D ^%DT S ADT=Y
"RTN","FHASM1",10,0)
F3 I DFN,$D(^FHPT(DFN,"N",9999999-ADT)) S ADT=$$FMADD^XLFDT(ADT,,,1) G F3
"RTN","FHASM1",11,0)
 S FHAP=$G(^FH(119.9,1,3)),FHU=$P(FHAP,"^",1)
"RTN","FHASM1",12,0)
 S (TSF,TSFP,SCA,SCAP,ACIR,ACIRP,CCIR,CCIRP,BFAMA,BFAMAP,BMI,BMIP,X1,X2)=""
"RTN","FHASM1",13,0)
 G:'DFN F4 S XX=$O(^FHPT(DFN,"N",0)) G:XX="" F4 S XX=$G(^(XX,0)),HGT=$P(XX,"^",4),HGP=$P(XX,"^",5)
"RTN","FHASM1",14,0)
 I HGP'="S" S X1=$S(HGT\12:HGT\12_"'",1:"")_$S(HGT#12:" "_(HGT#12)_"""",1:""),X2=+$J(HGT*2.54,0,0)_"CM",X1=$S(FHU'="M":X1,1:X2)
"RTN","FHASM1",15,0)
F4 ; If Multidivisional site Select Communications Office
"RTN","FHASM1",16,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D
"RTN","FHASM1",17,0)
 .K DIC S DIC="^FH(119.73," S DIC(0)="AEMQ" D ^DIC
"RTN","FHASM1",18,0)
 .I Y=-1 Q
"RTN","FHASM1",19,0)
 .S FHCOMM=+Y
"RTN","FHASM1",20,0)
 ;
"RTN","FHASM1",21,0)
F4A S (KNEE,EXT)="" W !!,"Height: " W:X1'="" X1,"// " R X:DTIME G:'$T!(X["^") KIL I X="",X1'="" S Y0=$J(HGT,0,0),H1=Y0 G F5
"RTN","FHASM1",22,0)
 D TR,HGT I Y<1 D HGP G F4A
"RTN","FHASM1",23,0)
 S HGT=Y,H1=Y0,HGP=Y1
"RTN","FHASM1",24,0)
F5 R !!,"Weight: ",X:DTIME S:X="" X="?" G:'$T!(X["^") KIL
"RTN","FHASM1",25,0)
 S:X="a" X="A"
"RTN","FHASM1",26,0)
 I X="A",AGE>39 D A^FHASM2D G:Y<1 F5 S WGT=Y,WGP="A" G F6
"RTN","FHASM1",27,0)
 D WGT I Y<1 D WGP W:AGE>39 !,"You may enter an A to calculate weight anthropometrically." G F5
"RTN","FHASM1",28,0)
 S WGT=Y,WGP=Y1
"RTN","FHASM1",29,0)
F6 S %DT="AEP",%DT("A")="Date Weight Taken: ",%DT("B")="TODAY",%DT(0)="-T" W ! D ^%DT K %DT G KIL:X["^"!$D(DTOUT),F6:Y<1
"RTN","FHASM1",30,0)
 S DWGT=Y
"RTN","FHASM1",31,0)
F7 R !!,"Usual Weight: ",X:DTIME G:'$T!(X["^") KIL I X="" S UWGT="" G F8
"RTN","FHASM1",32,0)
 D WGT S UWGT=Y I Y<1 D WGP G F7
"RTN","FHASM1",33,0)
F8 K %DT,A1,K,X,Y G ^FHASM2
"RTN","FHASM1",34,0)
HGT ; Convert Height to inches
"RTN","FHASM1",35,0)
 S A1=+X I 'A1 S Y=-1 Q
"RTN","FHASM1",36,0)
 S X=$P(X,A1,2,99) S:$E(X,1)=" " X=$E(X,2,99) I "SMK"[$E(X,1) S Y=A1 S:FHU="M" Y=Y/2.54 G H1
"RTN","FHASM1",37,0)
 I """I"[$E(X,1) S Y=A1 G H1
"RTN","FHASM1",38,0)
 I $E(X,1)="C" S Y=A1/2.54 G H1
"RTN","FHASM1",39,0)
 I "'F"'[$E(X,1) S Y=-1 G H2
"RTN","FHASM1",40,0)
 S Y=A1*12 F K=1:1 Q:$E(X,K)?.N
"RTN","FHASM1",41,0)
 I $E(X,K,99)="" G H1
"RTN","FHASM1",42,0)
 S A1=+$E(X,K,99),X=$P(X,A1,2,99) S:$E(X,1)=" " X=$E(X,2,99)
"RTN","FHASM1",43,0)
 I """I"'[$E(X,1) S Y=-1 G H2
"RTN","FHASM1",44,0)
 S Y=Y+A1
"RTN","FHASM1",45,0)
H1 I X["K" D K^FHASM2D
"RTN","FHASM1",46,0)
H2 I Y<12!(Y>96) S Y=-1
"RTN","FHASM1",47,0)
 S:Y>0 Y0=+$J(Y,0,0),Y=+$J(Y,0,1) S Y1=$S(X["K":"K",X["S":"S",1:"") Q
"RTN","FHASM1",48,0)
HGP ; Height Help
"RTN","FHASM1",49,0)
 W !!,"Enter height as: 6' 2"" or 74"" or 74IN or 6FT 2 IN or 30CM"
"RTN","FHASM1",50,0)
 W !,"Add an S if height is stated rather than measured."
"RTN","FHASM1",51,0)
 W !,"Add a K if value is a Knee Height measurement."
"RTN","FHASM1",52,0)
 W !,"Height should be between 12"" and 96"" (8')." Q
"RTN","FHASM1",53,0)
WGT ; Convert Weight to lbs.
"RTN","FHASM1",54,0)
 D TR S A1=+X I 'A1 S Y=-1 Q
"RTN","FHASM1",55,0)
 S X=$P(X,A1,2,99) S:$E(X,1)=" " X=$E(X,2,99) I "SM"[$E(X,1) S Y=A1 S:FHU="M" Y=Y*2.2 G W1
"RTN","FHASM1",56,0)
 I $E(X,1)="O" S Y=A1/16 G W1
"RTN","FHASM1",57,0)
 I $E(X,1)="G" S Y=A1/1000*2.2 G W1
"RTN","FHASM1",58,0)
 I $E(X,1)="K" S Y=A1*2.2 G W1
"RTN","FHASM1",59,0)
 I "L#"'[$E(X,1) S Y=-1 G W1
"RTN","FHASM1",60,0)
 S Y=A1 F K=1:1 Q:$E(X,K)?.N
"RTN","FHASM1",61,0)
 I $E(X,K,99)="" G W1
"RTN","FHASM1",62,0)
 S A1=+$E(X,K,99),X=$P(X,A1,2,99) S:$E(X,1)=" " X=$E(X,2,99)
"RTN","FHASM1",63,0)
 I $E(X,1)'="O" S Y=-1 G W1
"RTN","FHASM1",64,0)
 S Y=A1/16+Y
"RTN","FHASM1",65,0)
W1 I Y<0!(Y>750) S Y=-1
"RTN","FHASM1",66,0)
 S:Y>0 Y0=+$J(Y,0,0),Y=+$J(Y,0,1) S Y1="" S:X["S" Y1="S" Q
"RTN","FHASM1",67,0)
WGP ; Weight help
"RTN","FHASM1",68,0)
 W !!,"Enter Weight as 150# or 150# 6OZ or 800G or 70KG"
"RTN","FHASM1",69,0)
 W !,"Add an S if weight is stated rather than measured."
"RTN","FHASM1",70,0)
 W !,"Enter an A to determine weight anthropometrically."
"RTN","FHASM1",71,0)
 W !,"Weight should be between 0 Lbs and 750 Lbs." Q
"RTN","FHASM1",72,0)
TR ; Translate Lower to Upper Case
"RTN","FHASM1",73,0)
 D TR^FH
"RTN","FHASM1",74,0)
 Q
"RTN","FHASM1",75,0)
KIL ; Final variable kill
"RTN","FHASM1",76,0)
 G KILL^XUSCLEAN
"RTN","FHASM1",77,0)
PAT S (DFN,SEX,AGE,PID)="" R !!,"Enter Patient's Name: ",NAM:DTIME G:'$T!(NAM["^") KIL
"RTN","FHASM1",78,0)
 I NAM["?"!(NAM'?.ANP)!(NAM="") W *7,!?5,"Enter Patient's Name to be printed on the report." G PAT
"RTN","FHASM1",79,0)
P1 I SEX="" R !,"Sex: ",SEX:DTIME S:SEX="" SEX="?" G:'$T!(SEX["^") KIL S X=SEX D TR S SEX=X I $P("FEMALE",SEX,1)'="",$P("MALE",SEX,1)'="" W *7,"  Enter M or F" S SEX="" G P1
"RTN","FHASM1",80,0)
 S SEX=$E(SEX,1)
"RTN","FHASM1",81,0)
P2 I AGE="" R !,"Age: ",AGE:DTIME S:AGE="" AGE="?" G:'$T!(AGE["^") KIL S X=AGE D TR S AGE=X
"RTN","FHASM1",82,0)
 S:AGE["M" AGE=+$J($P(AGE,"M",1)/12,0,2) I AGE'>0!(AGE>124) W !?5,"Enter Age Less Than 124 in Years or Months (followed by M) but Not Both" S AGE="" G P2
"RTN","FHASM1",83,0)
 G F2
"RTN","FHASN")
0^3^B4668207
"RTN","FHASN",1,0)
FHASN ; HISC/REL - Nutrition Status ;10/29/93  08:55
"RTN","FHASN",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHASN",3,0)
EN4 ; List Nutrition Statuses
"RTN","FHASN",4,0)
 W ! S L=0,DIC="^FH(115.4,",FLDS=".01,1",BY=".01"
"RTN","FHASN",5,0)
 S (FR,TO)="",DHD="NUTRITION STATUS" D EN1^DIP,RSET Q
"RTN","FHASN",6,0)
EN5 ; If Multidivisional site Select Communications Office
"RTN","FHASN",7,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D
"RTN","FHASN",8,0)
 .W ! K DIC S DIC="^FH(119.73," S DIC(0)="AEMQ" D ^DIC
"RTN","FHASN",9,0)
 .I Y=-1 Q
"RTN","FHASN",10,0)
 .S FHCOMM=+Y
"RTN","FHASN",11,0)
 ; Enter Nutrition Status for Patient
"RTN","FHASN",12,0)
 S ALL=1 D ^FHDPA G:'DFN KIL
"RTN","FHASN",13,0)
 I $P($G(^DPT(DFN,.35)),"^",1) W *7,!!?5,"  [ Patient has expired. ]" G EN5
"RTN","FHASN",14,0)
 D DID^FHDPA,GET
"RTN","FHASN",15,0)
 K DIC S DIC="^FH(115.4,",DIC(0)="AEQM",DIC("S")="I $P(^(0),U,2)'=""""" S:Y'="" DIC("B")=Y W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),EN5:Y<1 I +Y'=OLD S S2="I" G C2
"RTN","FHASN",16,0)
C1 R !!,"Is this a re-screen (Y/N)? ",X:DTIME G KIL:'$T,EN5:X["^" S:X="" X="^" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7,!,"  Answer YES or NO" G C1
"RTN","FHASN",17,0)
 S S2=$S(X?1"Y".E:"F",1:"I")
"RTN","FHASN",18,0)
C2 S S1=+Y D NOW^%DTC S NOW=%
"RTN","FHASN",19,0)
 I '$D(^FHPT(DFN,0)) S ^(0)=DFN
"RTN","FHASN",20,0)
 I '$D(^FHPT(DFN,"S",0)) S ^(0)="^115.012D^^"
"RTN","FHASN",21,0)
 K DIC,DD,DO S DIC="^FHPT(DFN,""S"",",DIC(0)="L",DLAYGO=115,DA(1)=DFN,X=NOW,DINUM=9999999-NOW D FILE^DICN S ASE=+Y
"RTN","FHASN",22,0)
 S $P(^FHPT(DFN,"S",ASE,0),"^",2,3)=S1_"^"_DUZ S:FHWRD $P(^(0),"^",6)=FHWRD
"RTN","FHASN",23,0)
 S DTE=+$E(NOW,1,12),S3="Nutrition Status: "_$P(^FH(115.4,S1,0),"^",2),S1=2
"RTN","FHASN",24,0)
 D FIL^FHASE3 G EN5
"RTN","FHASN",25,0)
GET ; Get Nutrition Status for current admission
"RTN","FHASN",26,0)
 S Y="",OLD="",X5=$O(^FHPT(DFN,"S",0)) Q:X5=""  S X5=^(X5,0)
"RTN","FHASN",27,0)
 I WARD'="" Q:$P(X5,"^",1)<$P($G(^FHPT(DFN,"A",ADM,0)),"^",1)
"RTN","FHASN",28,0)
 S OLD=+$P(X5,"^",2),Y=$P($G(^FH(115.4,OLD,0)),"^",2) K X5 Q
"RTN","FHASN",29,0)
RSET K %ZIS S IOP="" D ^%ZIS K %ZIS,IOP
"RTN","FHASN",30,0)
KIL G KILL^XUSCLEAN
"RTN","FHMADM2")
0^14^B5214994
"RTN","FHMADM2",1,0)
FHMADM2 ; HISC/AAC - Multidivisional Enter/Edit Served Meals ;10/9/03  09:53
"RTN","FHMADM2",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMADM2",3,0)
EN1 ; Enter/Edit Served Meals
"RTN","FHMADM2",4,0)
 D NOW^%DTC S DT=%\1 K %,%H,%I
"RTN","FHMADM2",5,0)
 S (ZZOUT,COMM)=0,ZOUT=$P($G(^FH(119.6,0)),"^",4)
"RTN","FHMADM2",6,0)
 ;
"RTN","FHMADM2",7,0)
E1 S %DT="AEPX",%DT("A")="SERVED MEALS Date: " W ! D ^%DT G KIL^FHMADM21:"^"[X!$D(DTOUT),E1:Y<1
"RTN","FHMADM2",8,0)
 ;
"RTN","FHMADM2",9,0)
 S DA=+Y I DA'<DT W *7,!!,"** Input must be for a date before today in order to collect ADT data!",! G E1
"RTN","FHMADM2",10,0)
 ;
"RTN","FHMADM2",11,0)
 ;Enter Communications Office 
"RTN","FHMADM2",12,0)
 K DIC,DIE S DIE="^FH(117," I '$D(^FH(117,DA,0)) S ^FH(117,DA,0)=DA,^FH(117,"B",DA,DA)="",X0=^FH(117,0),$P(^FH(117,0),"^",3,4)=DA_"^"_($P(X0,"^",4)+1)
"RTN","FHMADM2",13,0)
 S DA=+Y I $G(^FH(117,DA,"I"))="Y" W !," ** INACTIVE COMM OFFICE **" Q
"RTN","FHMADM2",14,0)
 S ^FH(117,DA,0)=DA
"RTN","FHMADM2",15,0)
 S DR="[FHMADM2]" D ^DIE
"RTN","FHMADM2",16,0)
 Q
"RTN","FHMADM2",17,0)
 ;
"RTN","FHMADM2",18,0)
C1 ;
"RTN","FHMADM2",19,0)
 K FHN W !!,"Calculating Census Values ...",!
"RTN","FHMADM2",20,0)
 F W1=0:0 S W1=$O(^DG(41.9,W1)) Q:W1'>0  D C2
"RTN","FHMADM2",21,0)
 Q
"RTN","FHMADM2",22,0)
C2 ;
"RTN","FHMADM2",23,0)
 I '$D(^DG(41.9,W1,"C",DA(1))) Q
"RTN","FHMADM2",24,0)
 S X0=^DG(41.9,W1,"C",DA(1),0),X1=$G(^(1)) I $D(^DIC(42,W1,0)) S FHWARD=$O(^FH(119.6,"AW",W1,"")) Q:FHWARD=""
"RTN","FHMADM2",25,0)
 S FHCOM19=$P($G(^FH(119.6,FHWARD,0)),"^",8) Q:FHCOMM'=FHCOM19
"RTN","FHMADM2",26,0)
 S TYP=$P(^DIC(42,W1,0),"^",3),TYP=$S(TYP="D":"D",TYP="NH":"N",1:"H")
"RTN","FHMADM2",27,0)
 I '$D(FHN(TYP)) S FHN(TYP,0)=0,FHN(TYP,1)=0
"RTN","FHMADM2",28,0)
 S Y0=$P(X0,"^",2),Y1=$P(X1,"^",5)
"RTN","FHMADM2",29,0)
 S:Y0 FHN(TYP,0)=FHN(TYP,0)+Y0 S:Y1 FHN(TYP,1)=FHN(TYP,1)+Y1 Q
"RTN","FHMADM2",30,0)
 Q
"RTN","FHMADM2",31,0)
DT ; Get From/To Dates
"RTN","FHMADM2",32,0)
D1 S %DT="AEPX",%DT("A")="Starting Date: " W ! D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D1 S SDT=+Y
"RTN","FHMADM2",33,0)
 I SDT'<DT W *7,"  [Must Start before Today!] " G D1
"RTN","FHMADM2",34,0)
D2 S %DT="AEPX",%DT("A")=" Ending Date: " D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D2 S EDT=+Y
"RTN","FHMADM2",35,0)
 I EDT'<DT W *7,"  [Must End before Today!] " G D2
"RTN","FHMADM2",36,0)
 I EDT<SDT W *7,"  [End before Start?] " G D1
"RTN","FHMADM2",37,0)
 Q
"RTN","FHMADM21")
0^15^B34931110
"RTN","FHMADM21",1,0)
FHMADM21 ; HISC/AAC - Multidivisional Served Meals Report ;10/9/03  16:07
"RTN","FHMADM21",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMADM21",3,0)
 ;
"RTN","FHMADM21",4,0)
 ;This program is being modified for Multidivisional Reports
"RTN","FHMADM21",5,0)
 ;Project ID 4QNFR03 - 2003
"RTN","FHMADM21",6,0)
 ;
"RTN","FHMADM21",7,0)
EN2 ; Print Meals Report
"RTN","FHMADM21",8,0)
 ;
"RTN","FHMADM21",9,0)
 D NOW^%DTC S DT=%\1 D DT^FHMADM2 G:"^"[X KIL
"RTN","FHMADM21",10,0)
 ;
"RTN","FHMADM21",11,0)
 ;Declare variables,determine total # of comm offices - alc 02-26-03
"RTN","FHMADM21",12,0)
 ;
"RTN","FHMADM21",13,0)
 S CONAME="",CO="",ZCO="",L=0,CONUM="",CONUMZ="",COUNT=0,COX="",COXX="",Y00=""
"RTN","FHMADM21",14,0)
 ;S ZZOUT=$G(^FH(119.73,0)),ZOUT=$P(ZZOUT,"^",4)
"RTN","FHMADM21",15,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHMADM21",16,0)
 F K=1:1:21 S S(K)="",SS(K)="",NN(K)=0
"RTN","FHMADM21",17,0)
 ;
"RTN","FHMADM21",18,0)
 R !,"Print report for all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y") I ZCO="Y" G PRINT
"RTN","FHMADM21",19,0)
 ;
"RTN","FHMADM21",20,0)
EN3 ;Enter/Edit data - alc 02-26-03
"RTN","FHMADM21",21,0)
 ;
"RTN","FHMADM21",22,0)
 S DIC=119.73,DIC(0)="AEQ"
"RTN","FHMADM21",23,0)
 D ^DIC I (Y=-1)&(CO="") G KIL Q
"RTN","FHMADM21",24,0)
 I (Y=-1) G PRINT Q
"RTN","FHMADM21",25,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME G EN3
"RTN","FHMADM21",26,0)
 I Y=-1 K DIC Q     ;quit if lookup fails
"RTN","FHMADM21",27,0)
 ;
"RTN","FHMADM21",28,0)
PRINT W !!,"The report requires a 132 column printer.",!
"RTN","FHMADM21",29,0)
 S NAMENO=$L(CONAME,"^"),CONUMX=$L(CO,"^")
"RTN","FHMADM21",30,0)
 I ZCO="Y" S CONUMZ=$G(^FH(119.73,0)),CONUMZ=$P(CONUMZ,"^",4)
"RTN","FHMADM21",31,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHMADM21",32,0)
 I $D(IO("Q")) S FHPGM="Q1^FHMADM21",FHLST="EDT^SDT^ZCO^CONUMX^CO^CONAM^CONAME^COUNT^CONUMZ^ZOUT^S(^SS(" D EN2^FH G KIL
"RTN","FHMADM21",33,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHMADM21",34,0)
 ;
"RTN","FHMADM21",35,0)
Q1 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP
"RTN","FHMADM21",36,0)
 S X=SDT D DOW^%DTC S DOW=Y+1
"RTN","FHMADM21",37,0)
 D NOW^%DTC S DTP=% D DTP^FH S HDT=DTP,PG=0
"RTN","FHMADM21",38,0)
 ;
"RTN","FHMADM21",39,0)
Q2 ;Drivers for individual Comm Off report - alc 02-26-03
"RTN","FHMADM21",40,0)
 ;
"RTN","FHMADM21",41,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX=0 QUIT  S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX) G:$D(^FH(119.73,COXX,"I")) Q2 G:'$D(^FH(119.73,COXX,0)) Q2
"RTN","FHMADM21",42,0)
 I ZCO="Y" S COUNT=COUNT+1 G:COUNT>ZOUT QUIT  S NAME=$G(^FH(119.73,COUNT,0)),NAME=$P(NAME,"^") G:$D(^FH(119.73,COUNT,"I")) Q2 G:'$D(^FH(119.73,COUNT,0)) Q2
"RTN","FHMADM21",43,0)
 ;W @IOF
"RTN","FHMADM21",44,0)
 D HDR
"RTN","FHMADM21",45,0)
 S DOW=Y+1 D Q3
"RTN","FHMADM21",46,0)
 I CONUMX>0  G Q2
"RTN","FHMADM21",47,0)
 Q
"RTN","FHMADM21",48,0)
 ;
"RTN","FHMADM21",49,0)
QUIT ;Drivers for report final totals/average - alc 02-26-03
"RTN","FHMADM21",50,0)
 ;
"RTN","FHMADM21",51,0)
 ;W @IOF
"RTN","FHMADM21",52,0)
 S NAME="Total All Communications Offices "
"RTN","FHMADM21",53,0)
 D HDR
"RTN","FHMADM21",54,0)
 ;
"RTN","FHMADM21",55,0)
 F K=1:1:18 S NN(K)=$J($S(NDX:SS(K)/NDX,1:0),0,0),NN(K)=$J($S(NN(K)<1:"",1:NN(K)),5)_" ",SS(K)=$S(SS(K)<1:$J("",6),SS(K)<100000:$J(SS(K),5)_" ",1:$J(SS(K),6))
"RTN","FHMADM21",56,0)
 F K=19:1:21 S NN(K)=$J($S(NDX:SS(K)/NDX,1:0),0,0),NN(K)=$J($S(NN(K)<1:"",1:NN(K)),5)_" ",SS(K)=$S(SS(K)<1:$J("",6),SS(K)<100000:$J(SS(K),5)_" ",1:$J(SS(K),6))
"RTN","FHMADM21",57,0)
 ;BREAK
"RTN","FHMADM21",58,0)
 D FTOTALS
"RTN","FHMADM21",59,0)
 Q
"RTN","FHMADM21",60,0)
 ;
"RTN","FHMADM21",61,0)
Q3 ;Looping thru dates/comm off load data buckets - alc 02-26-03
"RTN","FHMADM21",62,0)
 ;
"RTN","FHMADM21",63,0)
 S D1=SDT,(ND,TD,NDX,TDX)=0 F L1=0:0 D N1 S X1=D1,X2=1 D C^%DTC Q:(X>EDT)  S D1=X,DOW=DOW+1 S:DOW=8 DOW=1
"RTN","FHMADM21",64,0)
 ;
"RTN","FHMADM21",65,0)
 F K=1:1:18 S N(K)=$J($S(ND:S(K)/ND,1:0),0,0),N(K)=$J($S(N(K)<1:"",1:N(K)),5)_" ",S(K)=$S(S(K)<1:$J("",6),S(K)<100000:$J(S(K),5)_" ",1:$J(S(K),6))
"RTN","FHMADM21",66,0)
 ;
"RTN","FHMADM21",67,0)
 F K=19:1:21 S N(K)=$J($S(TD:S(K)/TD,1:0),0,0),N(K)=$J($S(N(K)<1:"",1:N(K)),5)_" ",S(K)=$S(S(K)<1:$J("",6),S(K)<100000:$J(S(K),5)_" ",1:$J(S(K),6))
"RTN","FHMADM21",68,0)
 ;
"RTN","FHMADM21",69,0)
 ;Print daily totals - alc 02-26-03
"RTN","FHMADM21",70,0)
 ;
"RTN","FHMADM21",71,0)
 D LN W !?4,"Total",?15,"|",S(1),S(2),S(3),"|",S(4),S(5),S(6),"|",S(7),S(8),S(9),"|",S(10),"|",S(11),S(13),S(16),"|",S(17),"|",S(18),"|",S(19),S(20),S(21),!
"RTN","FHMADM21",72,0)
 ;
"RTN","FHMADM21",73,0)
 W:ND ?4,"Avg. ",?15,"|",N(1),N(2),N(3),"|",N(4),N(5),N(6),"|",N(7),N(8),N(9),"|",N(10),"|",N(11),N(13),N(16),"|",N(17),"|",N(18),"|",N(19),N(20),N(21),!
"RTN","FHMADM21",74,0)
 ;
"RTN","FHMADM21",75,0)
 Q
"RTN","FHMADM21",76,0)
 ;
"RTN","FHMADM21",77,0)
FTOTALS ;PRINT FINAL TOTALS - alc 02-26-03
"RTN","FHMADM21",78,0)
 ;
"RTN","FHMADM21",79,0)
 D LN W !?4,"ALL Total",?15,"|",SS(1),SS(2),SS(3),"|",SS(4),SS(5),SS(6),"|",SS(7),SS(8),SS(9),"|",SS(10),"|",SS(11),SS(13),SS(16),"|",SS(17),"|",SS(18),"|",SS(19),SS(20),SS(21),!
"RTN","FHMADM21",80,0)
 ;
"RTN","FHMADM21",81,0)
 W:ND ?4,"Avg. ",?15,"|",NN(1),NN(2),NN(3),"|",NN(4),NN(5),NN(6),"|",NN(7),NN(8),NN(9),"|",NN(10),"|",NN(11),NN(13),NN(16),"|",NN(17),"|",NN(18),"|",NN(19),NN(20),NN(21),!
"RTN","FHMADM21",82,0)
 ;
"RTN","FHMADM21",83,0)
 Q
"RTN","FHMADM21",84,0)
 ;
"RTN","FHMADM21",85,0)
HDR ;Print report headings - alc 02-26-03
"RTN","FHMADM21",86,0)
 ;
"RTN","FHMADM21",87,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !,HDT,?44,"S E R V E D   M E A L S   W O R K S H E E T",?123,"Page ",PG
"RTN","FHMADM21",88,0)
 ;
"RTN","FHMADM21",89,0)
 ;S NAMENO=NAMENO-1,NAME=$P(CONAME,"^",NAMENO) 
"RTN","FHMADM21",90,0)
 W !!,?1,NAME
"RTN","FHMADM21",91,0)
 ;
"RTN","FHMADM21",92,0)
 W ?(131-$L(DTE)\2),DTE
"RTN","FHMADM21",93,0)
 W !!,?15,"|",?32,"MEALS SERVED ON INPATIENT BASIS",?79,"|",?82,"MEALS SERVED TO OTHERS",?105,"| TOTAL| SERVED TRAYS DATA"
"RTN","FHMADM21",94,0)
 W !,?15,"|",?19,"DOMICILIARY",?34,"| NURSING HOME CU",?53,"|",?59,"HOSPITAL",?72,"| TOTAL|",?98,"| TOTAL| MEALS|"
"RTN","FHMADM21",95,0)
 W !,?15,"|  Inp.  Abs.  Meal|  Inp.  Abs.  Meal|  Inp.  Abs.  Meal|      | Outp.  Paid Grat.|      |      |  Cafe   NPO Trays"
"RTN","FHMADM21",96,0)
 W !,?15,"|   A     B     C  |   D     E     F  |   G     H     I  |   J  |   K     M    Q   |      |   R  |   T      U    V"
"RTN","FHMADM21",97,0)
LN W ! F K=1:1:131 W "-"
"RTN","FHMADM21",98,0)
 Q
"RTN","FHMADM21",99,0)
 ;
"RTN","FHMADM21",100,0)
N1 ;Get data from approp date/comm office globals - alc 02-26-03
"RTN","FHMADM21",101,0)
 ;
"RTN","FHMADM21",102,0)
 I ZCO="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y0=$G(^FH(117,D1,2,CONUM,0)),Y2=$P(Y0,"^"),Y1=($P(Y0,"^",2,99)),Y00=$G(^FH(117,D1,2,CONUM,1)),Y11=($P(Y00,"^",1,99))  Q:COUNT=Y2 
"RTN","FHMADM21",103,0)
 ;
"RTN","FHMADM21",104,0)
N2 I ZCO'="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y0=$G(^FH(117,D1,2,CONUM,0)),Y2=$P(Y0,"^"),Y1=($P(Y0,"^",2,99)),Y00=$G(^FH(117,D1,2,CONUM,1)),Y11=($P(Y00,"^",1,99))  Q:COXX=Y2
"RTN","FHMADM21",105,0)
 ;
"RTN","FHMADM21",106,0)
 K N S K=0 F L=1,2,4,5,7,8 S K=K+1,N(L)=$P(Y11,"^",K)
"RTN","FHMADM21",107,0)
 S K=10 F L=1:3:16 S K=K+1,N(K)=$P(Y1,"^",L)+$P(Y1,"^",L+1)+$P(Y1,"^",L+2)
"RTN","FHMADM21",108,0)
 ;
"RTN","FHMADM21",109,0)
 ;Calcs - alc 02-26-03
"RTN","FHMADM21",110,0)
 ;
"RTN","FHMADM21",111,0)
 S N(19)=$P(Y1,"^",19),N(20)=$P(Y1,"^",20)
"RTN","FHMADM21",112,0)
 S N(3)=N(1)-N(2)*3,N(6)=N(4)-N(5)*3,N(9)=N(7)-N(8)*3,N(10)=N(3)+N(6)+N(9)
"RTN","FHMADM21",113,0)
 ;
"RTN","FHMADM21",114,0)
 ;
"RTN","FHMADM21",115,0)
 S N(16)=N(14)+N(15)+N(16),N(13)=N(12)+N(13),N(17)=N(11)+N(13)+N(16),N(18)=N(10)+N(17),N(19)=N(19)+N(17),N(21)=N(18)-N(19)-N(20) S:N(18) (ND,NDX)=ND+1 S:N(20) (TD,TDX)=TD+1
"RTN","FHMADM21",116,0)
 ;
"RTN","FHMADM21",117,0)
 ;Summarizing detail report data into totals - alc 02-26-03
"RTN","FHMADM21",118,0)
 ;
"RTN","FHMADM21",119,0)
 F K=1:1:21 S S(K)=S(K)+N(K),SS(K)=SS(K)+N(K)
"RTN","FHMADM21",120,0)
 ;
"RTN","FHMADM21",121,0)
 F K=1:1:21 S N(K)=$J($S(N(K)<1:"",1:N(K)),5)_" "
"RTN","FHMADM21",122,0)
 ;
"RTN","FHMADM21",123,0)
 ;Prints detail line by date - alc 02-26-03
"RTN","FHMADM21",124,0)
 ;
"RTN","FHMADM21",125,0)
 S DTP=D1 D DTP^FH D:$Y>(IOSL-8) HDR
"RTN","FHMADM21",126,0)
 W !,$P("Sun Mon Tue Wed Thu Fri Sat"," ",DOW)," ",DTP
"RTN","FHMADM21",127,0)
 W ?15,"|",N(1),N(2),N(3),"|",N(4),N(5),N(6),"|",N(7),N(8),N(9),"|",N(10),"|",N(11),N(13),N(16),"|",N(17),"|",N(18),"|",N(19),N(20),N(21)  Q
"RTN","FHMADM21",128,0)
KIL ; Kill all used Variables
"RTN","FHMADM21",129,0)
 G KILL^XUSCLEAN
"RTN","FHMADM2A")
0^16^B4879631
"RTN","FHMADM2A",1,0)
FHMADM2A ; HISC/RTK - Calculate Multidiv NPO/Trays for Served Meals ;10/15/03  14:03
"RTN","FHMADM2A",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMADM2A",3,0)
EN1 ; Calculate NPO/Trays
"RTN","FHMADM2A",4,0)
 F FHCOMM=0:0 S FHCOMM=$O(^FH(119.73,FHCOMM)) Q:FHCOMM'>0  D FHMULT
"RTN","FHMADM2A",5,0)
 Q
"RTN","FHMADM2A",6,0)
FHMULT ;
"RTN","FHMADM2A",7,0)
 D NOW^%DTC S NOW=%,DT=NOW\1,(TP,TC,TE,N,R)=0 F K=1:1:5 S S(K)=0
"RTN","FHMADM2A",8,0)
 I $G(^FH(119.73,FHCOMM,"I"))="Y" Q
"RTN","FHMADM2A",9,0)
 S FHZZ=$O(^FH(117,DT,2,"B",FHCOMM,"")) I FHZZ="" D
"RTN","FHMADM2A",10,0)
 .S Y=FHCOMM K DIC,DO S DA(1)=DT,DIC="^FH(117,"_DA(1)_",2,"
"RTN","FHMADM2A",11,0)
 .S DIC(0)="L",DIC("P")=$P(^DD(117,6,0),U,2),X=+Y
"RTN","FHMADM2A",12,0)
 .D FILE^DICN I Y=-1 Q
"RTN","FHMADM2A",13,0)
 S FHZZ=$O(^FH(117,DT,2,"B",FHCOMM,"")) I FHZZ="" Q
"RTN","FHMADM2A",14,0)
 F WRD=0:0 S WRD=$O(^FH(119.6,WRD)) Q:WRD'>0  S FHWRDCM=$P($G(^FH(119.6,WRD,0)),U,8) Q:FHWRDCM'=FHCOMM  F DFN=0:0 S DFN=$O(^FHPT("AW",WRD,DFN)) Q:DFN=""  S ADM=^(DFN) D CNT
"RTN","FHMADM2A",15,0)
 I '$D(^FH(117,DT,0)) S ^FH(117,DT,0)=DT,^FH(117,"B",DT,DT)="",X0=^FH(117,0),$P(^FH(117,0),"^",3,4)=DT_"^"_($P(X0,"^",4)+1)
"RTN","FHMADM2A",16,0)
 S MD=N-R
"RTN","FHMADM2A",17,0)
 S $P(^FH(117,DT,2,FHZZ,0),"^",20,28)=(3*TC)_"^"_(TP-TE*3)_"^"_S(1)_"^"_S(2)_"^"_S(3)_"^"_S(4)_"^"_S(5)_"^"_MD_"^"_N
"RTN","FHMADM2A",18,0)
 K %,%H,%I,A1,ADM,DFN,FHORD,K,MD,N,NOW,R,S,TC,TE,TP,TYP,WRD,X0,X1,Y0,ZZ Q
"RTN","FHMADM2A",19,0)
CNT ;
"RTN","FHMADM2A",20,0)
 Q:'ADM  S TP=TP+1 Q:'$D(^FHPT(DFN,"A",ADM,0))
"RTN","FHMADM2A",21,0)
 S X5=$O(^FHPT(DFN,"S",0)) I X5 S X5=$G(^(X5,0))
"RTN","FHMADM2A",22,0)
 I  I $P(X5,"^",1)<$P($G(^FHPT(DFN,"A",ADM,0)),"^",1) S X5=5,S(X5)=S(X5)+1 G C1
"RTN","FHMADM2A",23,0)
 S X5=$P(X5,"^",2) S:X5=""!(X5>4) X5=5 S S(X5)=S(X5)+1
"RTN","FHMADM2A",24,0)
C1 S X0=^FHPT(DFN,"A",ADM,0)
"RTN","FHMADM2A",25,0)
 S FHORD=$P(X0,"^",2),X1=$P(X0,"^",3),ZZ=$P(X0,"^",5) Q:'FHORD
"RTN","FHMADM2A",26,0)
 S Y0=$G(^FHPT(DFN,"A",ADM,"DI",FHORD,0)) Q:Y0=""
"RTN","FHMADM2A",27,0)
 S FHOR=$P(Y0,"^",2,6),FHLD=$P(Y0,"^",7)
"RTN","FHMADM2A",28,0)
 I FHLD'="" Q:ZZ=""  S N=N+1 Q
"RTN","FHMADM2A",29,0)
 S Z=$P(Y0,"^",13) Q:Z=""  S TE=TE+1,TYP=$P(Y0,"^",8) S:TYP="C" TC=TC+1 S N=N+1
"RTN","FHMADM2A",30,0)
 I "1^^^^"[FHOR S R=R+1
"RTN","FHMADM2A",31,0)
 Q
"RTN","FHMADM3")
0^17^B23111413
"RTN","FHMADM3",1,0)
FHMADM3 ; HISC/REL/AAC - Additional Meals Report ;10/9/03  16:07
"RTN","FHMADM3",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMADM3",3,0)
EN1 ; Print Meal Report
"RTN","FHMADM3",4,0)
 D DT G:"^"[X KIL
"RTN","FHMADM3",5,0)
 ;
"RTN","FHMADM3",6,0)
 ;Get Communication Offices data
"RTN","FHMADM3",7,0)
 F K=1:1:22 S SS(K)=0,S(K)=0
"RTN","FHMADM3",8,0)
 S CONUM="",ZCO="",COXX="",CO="",CONAME="",CONAM="",COUNT=0
"RTN","FHMADM3",9,0)
 ;S ZZOUT=$G(^FH(119.73,0)),ZOUT=$P(ZZOUT,"^",4)
"RTN","FHMADM3",10,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHMADM3",11,0)
 ;
"RTN","FHMADM3",12,0)
 R !,"Print report for all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y") I ZCO'="Y" D N2 G KIL Q
"RTN","FHMADM3",13,0)
 ;
"RTN","FHMADM3",14,0)
PRINT W !!,"The report requires a 132 column printer.",!
"RTN","FHMADM3",15,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHMADM3",16,0)
 I $D(IO("Q")) S FHPGM="Q1^FHMADM3",FHLST="CONAME^CO^CONUMX^EDT^SDT^ZCO^COUNT^ZOUT^S(^SS(" D EN2^FH G KIL
"RTN","FHMADM3",17,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHMADM3",18,0)
 ;
"RTN","FHMADM3",19,0)
Q1 ; Process Printing the Meal Report
"RTN","FHMADM3",20,0)
 ;
"RTN","FHMADM3",21,0)
 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP
"RTN","FHMADM3",22,0)
 S X=SDT D DOW^%DTC S DOW=Y+1
"RTN","FHMADM3",23,0)
 D NOW^%DTC S DTP=% D DTP^FH S HDT=DTP,PG=0
"RTN","FHMADM3",24,0)
 ;
"RTN","FHMADM3",25,0)
Q2 ;
"RTN","FHMADM3",26,0)
 ;Get Specific Communication Offices
"RTN","FHMADM3",27,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX=0 QUIT  S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX) G:$D(^FH(119.73,COXX,"I")) Q2 G:'$D(^FH(119.73,COXX,0)) Q2
"RTN","FHMADM3",28,0)
 I ZCO="Y" S COUNT=COUNT+1 G:COUNT>ZOUT QUIT  S NAME=$G(^FH(119.73,COUNT,0)),NAME=$P(NAME,"^") G:$D(^FH(119.73,COUNT,"I")) Q2 G:'$D(^FH(119.73,COUNT,0)) Q2
"RTN","FHMADM3",29,0)
 ;W @IOF
"RTN","FHMADM3",30,0)
 D HDR
"RTN","FHMADM3",31,0)
 S DOW=Y+1 D Q3
"RTN","FHMADM3",32,0)
 I ZCO'="Y" I CONUMX>0  G Q2
"RTN","FHMADM3",33,0)
 I ZCO="Y" G Q2
"RTN","FHMADM3",34,0)
 Q
"RTN","FHMADM3",35,0)
 ;
"RTN","FHMADM3",36,0)
QUIT ;
"RTN","FHMADM3",37,0)
 ;W @IOF
"RTN","FHMADM3",38,0)
 S NAME="Total All Communications Offices "
"RTN","FHMADM3",39,0)
 D HDR
"RTN","FHMADM3",40,0)
 D FTOTALS
"RTN","FHMADM3",41,0)
 D LN,LN
"RTN","FHMADM3",42,0)
 Q
"RTN","FHMADM3",43,0)
 ;
"RTN","FHMADM3",44,0)
Q3 F L1=19:1:22 S N(L1)=0
"RTN","FHMADM3",45,0)
 S D1=SDT F L1=0:0 D N1 S X1=D1,X2=1 D C^%DTC  Q:X>EDT  S D1=X,DOW=DOW+1 S:DOW=8 DOW=1
"RTN","FHMADM3",46,0)
 ;
"RTN","FHMADM3",47,0)
TOTALS ;
"RTN","FHMADM3",48,0)
 ;Print Totals
"RTN","FHMADM3",49,0)
 F K=1:1:22 S Z=$S(K<19:5,1:6),S(K)=$S(S(K)<1:$J("",Z),S(K)<10000:$J(S(K),Z-1)_" ",1:$J(S(K),Z))
"RTN","FHMADM3",50,0)
 ;
"RTN","FHMADM3",51,0)
 D LN W !,"  Total",?10,"|",S(1),S(2),S(3),S(4),S(5),S(6),S(19)," |",S(7),S(8),S(9),S(10),S(11),S(12),S(20)," |",S(13),S(14),S(15),S(16),S(17),S(18),S(21)," |",S(22),!
"RTN","FHMADM3",52,0)
 Q
"RTN","FHMADM3",53,0)
 ;
"RTN","FHMADM3",54,0)
FTOTALS ; Final Totals
"RTN","FHMADM3",55,0)
 ;
"RTN","FHMADM3",56,0)
 F K=1:1:22 S Z=$S(K<19:5,1:6),SS(K)=$S(SS(K)<1:$J("",Z),SS(K)<10000:$J(SS(K),Z-1)_" ",1:$J(SS(K),Z))
"RTN","FHMADM3",57,0)
 ;
"RTN","FHMADM3",58,0)
 W !,"ALL Total",?10,"|",SS(1),SS(2),SS(3),SS(4),SS(5),SS(6),SS(19)," |",SS(7),SS(8),SS(9),SS(10),SS(11),SS(12),SS(20)," |",SS(13),SS(14),SS(15),SS(16),SS(17),SS(18),SS(21)," |",SS(22),!
"RTN","FHMADM3",59,0)
 Q
"RTN","FHMADM3",60,0)
 ;
"RTN","FHMADM3",61,0)
HDR ;Print page headers
"RTN","FHMADM3",62,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !,HDT,?50,"A D D I T I O N A L   M E A L S",?125,"Page ",PG
"RTN","FHMADM3",63,0)
 W !!,?1,NAME
"RTN","FHMADM3",64,0)
 W !!?(131-$L(DTE)\2),DTE
"RTN","FHMADM3",65,0)
 W !!,?10,"|",?21,"B R E A K F A S T",?48,"|",?64,"N O O N",?86,"|",?99,"E V E N I N G",?124,"| TOTAL"
"RTN","FHMADM3",66,0)
 W !,?10,"| Opt. Emp. Paid OOD  Vol. Grt. Total | Opt. Emp. Paid OOD  Vol. Grt. Total | Opt. Emp. Paid OOD  Vol. Grt. Total |"
"RTN","FHMADM3",67,0)
LN W !,"-----------------------------------------------------------------------------------------------------------------------------------"
"RTN","FHMADM3",68,0)
 Q
"RTN","FHMADM3",69,0)
 ;
"RTN","FHMADM3",70,0)
N1 ;Get specific records based on Communications Offices,Start/End Dates, etc
"RTN","FHMADM3",71,0)
 I ZCO'="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y0=$G(^FH(117,D1,2,CONUM,0)),Y2=$P(Y0,"^"),Y1=$P(Y0,"^",2,99)  Q:COXX=Y2
"RTN","FHMADM3",72,0)
 ;
"RTN","FHMADM3",73,0)
 I ZCO="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y0=$G(^FH(117,D1,2,CONUM,0)),Y2=$P(Y0,"^"),Y1=$P(Y0,"^",2,99)  Q:COUNT=Y2
"RTN","FHMADM3",74,0)
 ;
"RTN","FHMADM3",75,0)
 S K=0 F L1=1:1:6 F L2=1:1:3 S K=K+1,N=L2-1*6+L1,Z=$P(Y1,"^",K),N(N)=Z,N(18+L2)=N(18+L2)+Z
"RTN","FHMADM3",76,0)
 S N(22)=N(19)+N(20)+N(21)
"RTN","FHMADM3",77,0)
 ;
"RTN","FHMADM3",78,0)
 F K=1:1:22 S S(K)=S(K)+N(K),SS(K)=SS(K)+N(K),N(K)=$J($S(N(K)<1:"",1:N(K)),$S(K<19:4,1:5))_" "
"RTN","FHMADM3",79,0)
 ;
"RTN","FHMADM3",80,0)
 S DTP=D1 D DTP^FH D:$Y>(IOSL-8) HDR
"RTN","FHMADM3",81,0)
 W !,$P("Sun Mon Tue Wed Thu Fri Sat"," ",DOW)," ",$E(DTP,1,6)
"RTN","FHMADM3",82,0)
 W "|",N(1),N(2),N(3),N(4),N(5),N(6),N(19)," |",N(7),N(8),N(9),N(10),N(11),N(12),N(20)," |",N(13),N(14),N(15),N(16),N(17),N(18),N(21)," |",N(22) Q
"RTN","FHMADM3",83,0)
 ;
"RTN","FHMADM3",84,0)
N2 ;Get Communciation Offices
"RTN","FHMADM3",85,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHMADM3",86,0)
 D ^DIC I (Y=-1)&(CO="") Q
"RTN","FHMADM3",87,0)
 I Y=-1 G PRINT Q
"RTN","FHMADM3",88,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME S CONUMX=$L(CO,"^") G N2 Q
"RTN","FHMADM3",89,0)
 I Y=-1 K DIC Q
"RTN","FHMADM3",90,0)
 ;
"RTN","FHMADM3",91,0)
DT ; Get From/To Dates
"RTN","FHMADM3",92,0)
D1 S %DT="AEPX",%DT("A")="Starting Date: " W ! D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D1 S SDT=+Y
"RTN","FHMADM3",93,0)
 I SDT'<DT W *7,"  [Must Start before Today!] " G D1
"RTN","FHMADM3",94,0)
 ;
"RTN","FHMADM3",95,0)
D2 ;
"RTN","FHMADM3",96,0)
 S %DT="AEPX",%DT("A")=" Ending Date: " D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D2 S EDT=+Y
"RTN","FHMADM3",97,0)
 I EDT'<DT W *7,"  [Must End before Today!] " G D2
"RTN","FHMADM3",98,0)
 I EDT<SDT W *7,"  [End before Start?] " G D1
"RTN","FHMADM3",99,0)
 Q
"RTN","FHMADM3",100,0)
 ;
"RTN","FHMADM3",101,0)
KIL G KILL^XUSCLEAN Q
"RTN","FHMADM3",102,0)
EXIT Q
"RTN","FHMADM4")
0^18^B36293844
"RTN","FHMADM4",1,0)
FHMADM4 ; HISC/AAC - Multidivisional Staffing Data Report ;10/10/03  16:08
"RTN","FHMADM4",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMADM4",3,0)
EN1 ; Enter/Edit Staffing Data
"RTN","FHMADM4",4,0)
 D NOW^%DTC S DT=%\1
"RTN","FHMADM4",5,0)
 ;
"RTN","FHMADM4",6,0)
 ;
"RTN","FHMADM4",7,0)
E1 S %DT="AEPX",%DT("A")="STAFFING DATA Date: " W ! D ^%DT G KIL:"^"[X!$D(DTOUT),E1:Y<1
"RTN","FHMADM4",8,0)
 S DA=+Y I DA>DT W *7,!!,"** Date must not be in the future!",! G E1
"RTN","FHMADM4",9,0)
 K DIC,DIE S DIE="^FH(117.1," I '$D(^FH(117.1,DA,0)) S ^FH(117.1,DA,0)=DA,^FH(117.1,"B",DA,DA)="",X0=^FH(117.1,0),$P(^FH(117.1,0),"^",3,4)=DA_"^"_($P(X0,"^",4)+1)
"RTN","FHMADM4",10,0)
 S X1=DA,X2=-1 D C^%DTC S DM1=X,FHX1=$P($G(^FH(117.1,DM1,0)),"^",2,6)
"RTN","FHMADM4",11,0)
 S DR="[FHMADM4]" D ^DIE G EN1
"RTN","FHMADM4",12,0)
 ;
"RTN","FHMADM4",13,0)
EN2 ; Print Staffing Data Report
"RTN","FHMADM4",14,0)
 D DT^FHMADM2 G:"^"[X KIL
"RTN","FHMADM4",15,0)
 ;
"RTN","FHMADM4",16,0)
 S (CONUM,ZCO,COXX,CO,CONAME,CONAM)="",(COUNT,SSND,SSTOT,SSTO1,SMAN)=0
"RTN","FHMADM4",17,0)
 F K=1:1:23 S SS(K)=0
"RTN","FHMADM4",18,0)
 ;S ZZOUT=$G(^FH(119.73,0)),(CONUMX,ZOUT)=$P(ZZOUT,"^",4)
"RTN","FHMADM4",19,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHMADM4",20,0)
 R !,"Print report all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y") I ZCO'="Y"  D N2 Q
"RTN","FHMADM4",21,0)
 ;
"RTN","FHMADM4",22,0)
PRINT W !!,"The report requires a 132 column printer.",!
"RTN","FHMADM4",23,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHMADM4",24,0)
 I $D(IO("Q")) S FHPGM="Q1^FHMADM4",FHLST="EDT^SDT^ZCO^CONUMX^COUNT^ZOUT^SSND^SSTOT^CO^CONAME^SMAN^SSTO1^SS(" D EN2^FH G KIL
"RTN","FHMADM4",25,0)
 U IO D Q1 D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHMADM4",26,0)
 ;
"RTN","FHMADM4",27,0)
Q1 ; Process Printing Staffing Report
"RTN","FHMADM4",28,0)
 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP
"RTN","FHMADM4",29,0)
 S X=SDT D DOW^%DTC S DOW=Y+1
"RTN","FHMADM4",30,0)
 D NOW^%DTC S DTP=% D DTP^FH S HDT=DTP,PG=0
"RTN","FHMADM4",31,0)
 K S,AV F K=1:1:23 S S(K)=0
"RTN","FHMADM4",32,0)
 S SIZ="61 51 51 51 51 50 30 30 30 30 30 30 30 30 30 30 30 30 30 51 50 50 50"
"RTN","FHMADM4",33,0)
 ;
"RTN","FHMADM4",34,0)
Q3 ;
"RTN","FHMADM4",35,0)
 ;Get Communication Office data drivers
"RTN","FHMADM4",36,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX=0 QUIT  S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX) G:$D(^FH(119.73,COXX,"I")) Q3 G:'$D(^FH(119.73,COXX,0)) Q3
"RTN","FHMADM4",37,0)
 I ZCO="Y" S COUNT=COUNT+1 G:COUNT>ZOUT QUIT  S NAME=$G(^FH(119.73,COUNT,0)),NAME=$P(NAME,"^") G:$D(^FH(119.73,COUNT,"I")) Q3 G:'$D(^FH(119.73,COUNT,0)) Q3
"RTN","FHMADM4",38,0)
 ;W @IOF
"RTN","FHMADM4",39,0)
 D HDR
"RTN","FHMADM4",40,0)
 D Q4
"RTN","FHMADM4",41,0)
 I ZCO'="Y" I CONUM>0 G Q3
"RTN","FHMADM4",42,0)
 I ZCO="Y" G Q3
"RTN","FHMADM4",43,0)
 Q
"RTN","FHMADM4",44,0)
 ;
"RTN","FHMADM4",45,0)
QUIT ;
"RTN","FHMADM4",46,0)
 ;End of routine drivers
"RTN","FHMADM4",47,0)
 ;W @IOF
"RTN","FHMADM4",48,0)
 S NAME="Total all Communications Offices "
"RTN","FHMADM4",49,0)
 D HDR
"RTN","FHMADM4",50,0)
 D FTOTALS
"RTN","FHMADM4",51,0)
 D LN
"RTN","FHMADM4",52,0)
 D LN
"RTN","FHMADM4",53,0)
 Q
"RTN","FHMADM4",54,0)
Q4 ;
"RTN","FHMADM4",55,0)
 ;Get detail information for Communciation Office, Start/End dates, etc.
"RTN","FHMADM4",56,0)
 F K=1:1:23 S S(K)=0
"RTN","FHMADM4",57,0)
 S D1=SDT,(ND,FHTOT,TO1,TOT,SFHTOT,MAN)=0 F L1=0:0 D N1 S X1=D1,X2=1 D C^%DTC Q:X>EDT  S D1=X,DOW=DOW+1 S:DOW=8 DOW=1
"RTN","FHMADM4",58,0)
 D LN G:ND>62 Q2
"RTN","FHMADM4",59,0)
 W !?7,"Total",?15 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S X=$P(SIZ," ",K),SS(K)=SS(K)+S(K) W $J(S(K),$E(X,1)+1,$E(X,2))
"RTN","FHMADM4",60,0)
 ;
"RTN","FHMADM4",61,0)
Q2 ;Print Averages
"RTN","FHMADM4",62,0)
 I ND W !?7,"Avg.",?15 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(S(K)/ND,$E(X,1)+1,$E(X,2))
"RTN","FHMADM4",63,0)
 I S(22) W !?7,"% Paid",?68 F K=8,9,10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(S(K)/S(22)*100,$E(X,1)+1,0)
"RTN","FHMADM4",64,0)
 I TOT W !!?7,"Adjustment for Unscheduled and Intermittent",!!?7,"UNS/INT Total " S TOT=TOT/8 W $J(TOT,5,1)," FTEE",!?7,"Adjusted Measured FTEE " S TOT=TOT+TO1 W $J(TOT,6,1) ;I ND W !?7,"Avg Measured FTEE       ",$J(TOT/ND,5,1)
"RTN","FHMADM4",65,0)
 I FHTOT S MAN=S(22)*60 W !!?7,"Man Minutes/Meal:    ",$J(MAN/FHTOT,0,0) S SFHTOT=SFHTOT+FHTOT,SMAN=SMAN+MAN
"RTN","FHMADM4",66,0)
 W ! Q
"RTN","FHMADM4",67,0)
 ;
"RTN","FHMADM4",68,0)
FTOTALS ;Print Final Totals
"RTN","FHMADM4",69,0)
 ;
"RTN","FHMADM4",70,0)
 W !?6,"All Total",?13 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(SS(K),$E(X,1)+1,$E(X,2))
"RTN","FHMADM4",71,0)
 ;
"RTN","FHMADM4",72,0)
 ;I ND W !?6,"All Avg.",?15 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(SS(K)/SSND,$E(X,1)+1,$E(X,2))
"RTN","FHMADM4",73,0)
 I SS(22) W !?6,"All % Paid",?68 F K=8,9,10,22,11:1:19,23 S X=$P(SIZ," ",K) W $J(SS(K)/SS(22)*100,$E(X,1)+1,0)
"RTN","FHMADM4",74,0)
 I SSTOT W !!?6,"All Adjustment for Unscheduled and Intermittent",!!?6,"All UNS/INT Total " S SSTOT=SSTOT/8 W $J(TOT,5,1)," FTEE",!?6,"All Adjusted Measured FTEE "
"RTN","FHMADM4",75,0)
 S SSTOT=SSTOT+SSTO1 W $J(SSTOT,6,1) ;I ND W !?6,"All Avg Measured FTEE       ",$J(SSTOT/ND,5,1)
"RTN","FHMADM4",76,0)
 I SFHTOT S SMAN=SS(22)*60 W !!?6,"Man Minutes/Meal:    ",$J(SMAN/SFHTOT,0,0)
"RTN","FHMADM4",77,0)
 W ! Q
"RTN","FHMADM4",78,0)
 ;
"RTN","FHMADM4",79,0)
HDR ;Print page headers
"RTN","FHMADM4",80,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !?4,HDT,?44,"S T A F F I N G   D A T A   W O R K S H E E T",?122,"Page ",PG
"RTN","FHMADM4",81,0)
 W !!,?1,NAME
"RTN","FHMADM4",82,0)
 W !!?(132-$L(DTE)\2),DTE
"RTN","FHMADM4",83,0)
 W !!?15,"| DAILY| CLIN|ADMIN| SUPP| SUPV| MEAS| POT | OFF |WOP| OT|UNS|INT| PAID|COP| AL| SL|OTH|LND|CMP|TRN|VOL|BOR|TOTAL"
"RTN","FHMADM4",84,0)
 W !?15,"|  FTEE| FTEE| FTEE| FTEE| FTEE| FTEE| HRS | HRS |HRS|HRS|HRS|HRS| HRS |HRS|HRS|HRS|HRS|HRS|HRS|HRS|HRS|HRS| HRS"
"RTN","FHMADM4",85,0)
LN W !?4,"----------------------------------------------------------------------------------------------------------------------------" Q
"RTN","FHMADM4",86,0)
 ;
"RTN","FHMADM4",87,0)
N1 ;Get specific records
"RTN","FHMADM4",88,0)
 I ZCO'="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y3=$G(^FH(117.1,D1,1,CONUM,0)),Y5=$P(Y3,"^"),Y4=$P(Y3,"^",2,99)  Q:COXX=Y5
"RTN","FHMADM4",89,0)
 I ZCO="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y3=$G(^FH(117.1,D1,1,CONUM,0)),Y5=$P(Y3,"^"),Y4=$P(Y3,"^",2,99)  Q:COUNT=Y5
"RTN","FHMADM4",90,0)
 ;
"RTN","FHMADM4",91,0)
 S ND=ND+1,SSND=SSND+1
"RTN","FHMADM4",92,0)
 S DTP=D1 D DTP^FH D:$Y>(IOSL-8) HDR
"RTN","FHMADM4",93,0)
 K N F L=1:1:20 S N(L)=$P(Y4,"^",L)
"RTN","FHMADM4",94,0)
 S N(20)=N(1)-N(2)-N(3)-N(4)-N(5),N(21)=N(20)*8
"RTN","FHMADM4",95,0)
 S N(22)=N(21)-N(6)-N(7)+N(8)+N(9)+N(10),N(23)=N(22)-N(11)-N(12)-N(13)-N(14)-N(15)+N(16)+N(17)+N(18)+N(19),TOT=TOT+N(9)+N(10),TO1=TO1+N(20),SSTOT=SSTOT+TOT,SSTO1=SSTO1+TO1
"RTN","FHMADM4",96,0)
 W !?4,$P("Sun Mon Tue Wed Thu Fri Sat"," ",DOW)," ",$E(DTP,1,6)," "
"RTN","FHMADM4",97,0)
 F K=1:1:5,20,21,6:1:10,22,11:1:19,23 S S(K)=S(K)+N(K),X=$P(SIZ," ",K),N(K)=$S('N(K):$J("",$E(X,1)),1:$J(N(K),$E(X,1),$E(X,2))) W "|",N(K)
"RTN","FHMADM4",98,0)
 D M1
"RTN","FHMADM4",99,0)
 Q
"RTN","FHMADM4",100,0)
 ;
"RTN","FHMADM4",101,0)
M1 ; Get total Meals
"RTN","FHMADM4",102,0)
 ; S Y1=$G(^FH(117,D1,0)) Q:Y1=""  I '$D(^FH(117,D1,1)) Q  S Y2=$G(^FH(117,D1,1)) Q
"RTN","FHMADM4",103,0)
 ;
"RTN","FHMADM4",104,0)
 ;I ZCO'="Y" F CONUM=1:1  Q:CONUM>ZOUT  S Y1=$G(^FH(117,D1,2,CONUM,1)) S Y0=$G(^FH(117,D1,2,CONUM,0)),Y2=$P(Y0,"^",2,99) Q:COXX=CONUM 
"RTN","FHMADM4",105,0)
 ;BREAK  I ZCO="Y" F CONUM=1:1 Q:CONUM>ZOUT  S Y1=$G(^FH(117,D1,2,CONUM,1)) Q:Y1=""  S Y0=$G(^FH(117,D1,2,CONUM,0)),Y6=$P(Y0,U,1),Y2=$P(Y0,U,2,99) Q:COUNT=CONUM
"RTN","FHMADM4",106,0)
 ;
"RTN","FHMADM4",107,0)
 ;S Y1=$G(^FH(117,D1,0)) Q:Y1=""  S Y2=$G(^FH(117,D1,1))
"RTN","FHMADM4",108,0)
 Q:$G(^FH(117,D1,2,0))=""  S Y1=$G(^FH(117,D1,2,CONUM,1)),Y2=$G(^FH(117,D1,2,CONUM,0))
"RTN","FHMADM4",109,0)
 K M S K=0 F L=1,2,4,5,7,8 S K=K+1,M(L)=$P(Y1,"^",K)
"RTN","FHMADM4",110,0)
 S K=10 F L=2:3:17 S K=K+1,M(K)=$P(Y2,"^",L)+$P(Y2,"^",L+1)+$P(Y2,"^",L+2)
"RTN","FHMADM4",111,0)
 S M(3)=M(1)-M(2)*3,M(6)=M(4)-M(5)*3,M(9)=M(7)-M(8)*3
"RTN","FHMADM4",112,0)
 S M(10)=M(3)+M(6)+M(9)
"RTN","FHMADM4",113,0)
 S M(16)=M(14)+M(15)+M(16),M(13)=M(12)+M(13),M(17)=M(11)+M(13)+M(16),M(18)=M(10)+M(17)
"RTN","FHMADM4",114,0)
 S FHTOT=FHTOT+M(18) Q
"RTN","FHMADM4",115,0)
 ;
"RTN","FHMADM4",116,0)
N2 ;Get Communications Offices
"RTN","FHMADM4",117,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHMADM4",118,0)
 D ^DIC I (Y=-1)&(CO="") Q
"RTN","FHMADM4",119,0)
 I Y=-1 G PRINT Q
"RTN","FHMADM4",120,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME,CONUMX=$L(CO,"^") G N2
"RTN","FHMADM4",121,0)
 I Y=-1 K DIC Q
"RTN","FHMADM4",122,0)
 Q
"RTN","FHMADM4",123,0)
 ;
"RTN","FHMADM4",124,0)
KIL G KILL^XUSCLEAN
"RTN","FHMASE")
0^19^B20961149
"RTN","FHMASE",1,0)
FHMASE ; HISC/AAC - Multidivisional Dietetic Encounters ;10/14/03  13:17
"RTN","FHMASE",2,0)
 ;;5.0;Dietetics;**40**;Jun 07, 1995
"RTN","FHMASE",3,0)
EN1 ; Enter/Edit Encounter Types
"RTN","FHMASE",4,0)
 S (DIC,DIE)="^FH(115.6,",DIC(0)="AEQLM",DIC("DR")=".01",DLAYGO=115.6 W ! D ^DIC K DIC,DLAYGO G KIL:"^"[X!$D(DTOUT),EN1:Y<1
"RTN","FHMASE",5,0)
 S DA=+Y,DR=$S(DA=1:2,DA=2:"2;3",1:".01;1:4;10;5:6;I X'=""Y"" S Y=99;7;8;99") S:$D(^XUSEC("FHMGR",DUZ)) DIDEL=115.6 D ^DIE,KIL G EN1
"RTN","FHMASE",6,0)
 ;
"RTN","FHMASE",7,0)
EN2 ; List Encounter Types
"RTN","FHMASE",8,0)
 W ! S L=0,DIC="^FH(115.6,",FLDS=".01,2,3,4,10,5,6,7,8,99",BY=".01"
"RTN","FHMASE",9,0)
 S (FR,TO)="",DHD="ENCOUNTER TYPES" D EN1^DIP,RSET Q
"RTN","FHMASE",10,0)
 ;
"RTN","FHMASE",11,0)
EN3 ; Enter Dietetic Encounter
"RTN","FHMASE",12,0)
 W ! K DIR S DIR(0)="YAO",DIR("A")="Enter a NEW Encounter (Y/N)? " D ^DIR G:$D(DIROUT)!($D(DIRUT)) KIL K DIR,DIROUT,DIRUT
"RTN","FHMASE",13,0)
 I 'Y S FHN=1 G EN4
"RTN","FHMASE",14,0)
 ;
"RTN","FHMASE",15,0)
EN30 ; Enter/Edit a Encounter
"RTN","FHMASE",16,0)
 D EN31 G:Y<1 KIL G EN3
"RTN","FHMASE",17,0)
 ;
"RTN","FHMASE",18,0)
EN31 ; Enter a Encounter
"RTN","FHMASE",19,0)
 S FHN=0 K %DT S %DT="AETPX",%DT("A")="DATE/TIME OF ENCOUNTER: ",%DT("B")="TODAY",%DT(0)="-NOW" W ! D ^%DT K %DT S:$D(DTOUT) Y=0 Q:Y<1  S DTE=Y
"RTN","FHMASE",20,0)
 K DIC,DD,DO S DIC="^FHEN(",DIC(0)="L",DIC("DR")="1////^S X=DTE",DLAYGO=115.7
"RTN","FHMASE",21,0)
A L +^FHEN(0) S DA=$P(^FHEN(0),"^",3)+1 I $D(^FHEN(DA)) S $P(^FHEN(0),"^",3)=DA L -^FHEN(0) G A
"RTN","FHMASE",22,0)
 S (X,DINUM)=DA D FILE^DICN L -^FHEN(0) S ASE=+Y,FHX4="" K DIC,DLAYGO,DINUM
"RTN","FHMASE",23,0)
 D EDIT Q
"RTN","FHMASE",24,0)
 ;
"RTN","FHMASE",25,0)
EN4 ; Process Edit Encounter
"RTN","FHMASE",26,0)
 ;
"RTN","FHMASE",27,0)
 W ! K ^TMP($J,"ECTR"),%DT S %DT="AEPX",%DT("A")="Enter Date of Encounter you want to edit: " D ^%DT K %DT S:$D(DTOUT) Y=0 G:Y<1 KIL S X1=Y,(TIM,X1)=X1-.0001,(EDT,X2)=Y\1+.3,CTR=0
"RTN","FHMASE",28,0)
A0 W !! K DIR S DIR(0)="SO^C:CLINICIAN;P:PATIENT",DIR("A")="CHOOSE CLINICIAN or PATIENT" D ^DIR K DIR G:$D(DIROUT)!($D(DIRUT)) KIL I Y?1"P" D PAT G:'DFN KIL D PR G:Y<1 KIL D ASK G KIL:Y<1,EN4
"RTN","FHMASE",29,0)
A1 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),A1:Y<1 S NAM=+Y D CLIN,PR G:Y<1 KIL D ASK G KIL:Y<1,EN4
"RTN","FHMASE",30,0)
PR W ! S K1="" F CTR=0:0 S CTR=$O(^TMP($J,"ECTR",CTR)) Q:CTR<1  S X=$G(^(CTR,0)),K1=CTR W !,CTR,"  " S Y=$P(X,"^",2) X ^DD("DD") W Y,"  ",$P(X,"^",3) K Y
"RTN","FHMASE",31,0)
 I 'K1 W !?5,"No encounter on file on this date" S Y=0 Q
"RTN","FHMASE",32,0)
 W !!,"Select number you want: " R X:DTIME I '$T!("^"[X) S Y=0 Q
"RTN","FHMASE",33,0)
 I X'?1.N!(X<1)!(X>K1) W *7,!!,"Select only a number no greater than ",K1," or press ""^"" or a return to exit." G PR
"RTN","FHMASE",34,0)
 S ASE=$P($G(^TMP($J,"ECTR",+X,0)),"^",1),FHX4=$G(^FHEN(ASE,0))
"RTN","FHMASE",35,0)
 S FHCLK=$P($G(^TMP($J,"ECTR",+X,0)),"^",4) W !
"RTN","FHMASE",36,0)
 ;
"RTN","FHMASE",37,0)
EDIT N FHX1 S DA=ASE K DIC,DIE S DIE="^FHEN(",DR="[FHMASE]" D ^DIE K DIC,DIE,DR
"RTN","FHMASE",38,0)
 S DA=ASE,X=^FHEN(DA,0)
"RTN","FHMASE",39,0)
 I '$P(X,"^",3)!('$P(X,"^",4)) S DIK="^FHEN(" D ^DIK W *7,!,"<encounter deleted>" K DIK,DA
"RTN","FHMASE",40,0)
 S Y=1 Q
"RTN","FHMASE",41,0)
 ;
"RTN","FHMASE",42,0)
PAT ; Get Patient
"RTN","FHMASE",43,0)
 S ALL=1 D ^FHDPA Q:'DFN
"RTN","FHMASE",44,0)
 I $P($G(^DPT(DFN,.35)),"^",1) W *7,!!?5,"Patient has expired." G PAT
"RTN","FHMASE",45,0)
 I '$D(^FHEN("AP",DFN)) W !!,"No Encounter on file for this patient." G PAT
"RTN","FHMASE",46,0)
 F DTE=TIM:0 S DTE=$O(^FHEN("AP",DFN,DTE)) Q:DTE<1!(DTE>EDT)  F ASE=0:0 S ASE=$O(^FHEN("AP",DFN,DTE,ASE)) Q:ASE<1  S Y=$P($G(^FHEN(ASE,0)),"^",4) I Y>2 D
"RTN","FHMASE",47,0)
 .S CTR=CTR+1,^TMP($J,"ECTR",CTR,0)=ASE_"^"_DTE_"^"_$P($G(^FH(115.6,+Y,0)),"^",1)_"^"_$P($G(^FHEN(ASE,0)),"^",13) Q
"RTN","FHMASE",48,0)
 Q
"RTN","FHMASE",49,0)
CLIN ; Get Clinician
"RTN","FHMASE",50,0)
 S X1=$O(^FHEN("AT",X1)) Q:X1<1!(X1>X2)
"RTN","FHMASE",51,0)
 S ASE=0
"RTN","FHMASE",52,0)
 ;
"RTN","FHMASE",53,0)
R1 S ASE=$O(^FHEN("AT",X1,ASE)) G:ASE="" CLIN
"RTN","FHMASE",54,0)
 S Y=$G(^FHEN(ASE,0)),E1=$P(Y,"^",3) I $P(Y,"^",4)>2,E1,E1=NAM S CTR=CTR+1,^TMP($J,"ECTR",CTR,0)=ASE_"^"_$P(Y,"^",2)_"^"_$P($G(^FH(115.6,+$P(Y,"^",4),0)),"^",1)_"^"_$P(Y,"^",13),DTE=$P(Y,"^",2)
"RTN","FHMASE",55,0)
 G R1
"RTN","FHMASE",56,0)
 ;
"RTN","FHMASE",57,0)
ASK R !!,"Is this correct? Y// ",YN:DTIME I '$T!(YN["^") S Y=0 Q
"RTN","FHMASE",58,0)
 S:YN="" YN="Y" S X=YN D TR^FH S YN=X
"RTN","FHMASE",59,0)
 I $P("YES",YN,1)'="",$P("NO",YN,1)'="" W *7," Answer YES or NO" G ASK
"RTN","FHMASE",60,0)
 Q:YN?1"Y".E
"RTN","FHMASE",61,0)
 I FHCLK'=DUZ W !!,"You can ONLY DELETE an encounter that is entered by you.",! G EDIT
"RTN","FHMASE",62,0)
 ;
"RTN","FHMASE",63,0)
E5 R !,"Want to delete encounter? N// ",YN:DTIME I '$T!(YN["^") S Y=0 Q
"RTN","FHMASE",64,0)
 S:YN="" YN="N" S X=YN D TR^FH S YN=X
"RTN","FHMASE",65,0)
 I $P("YES",YN,1)'="",$P("NO",YN,1)'="" W *7," Answer YES or NO" G E5
"RTN","FHMASE",66,0)
 Q:YN?1"N".E
"RTN","FHMASE",67,0)
 S DIK="^FHEN(",DA=ASE D ^DIK W *7,!,"<encounter deleted>" K DA,DIK S Y=1 Q
"RTN","FHMASE",68,0)
 ;
"RTN","FHMASE",69,0)
CNT S FHX3=FHX3+$P($G(^FHEN(ASE,"P",0)),"^",4)
"RTN","FHMASE",70,0)
 S ST="" F LP=0:0 S LP=$O(^FHEN(ASE,"P",LP)) Q:LP<1  S ST=$G(^(LP,0)) I $P(ST,"^",3)'<1 S FHX3=FHX3+$P(ST,"^",3)
"RTN","FHMASE",71,0)
 Q
"RTN","FHMASE",72,0)
 ;
"RTN","FHMASE",73,0)
RSET K %ZIS S IOP="" D ^%ZIS
"RTN","FHMASE",74,0)
 ;
"RTN","FHMASE",75,0)
KIL K ^TMP($J,"ECTR") G KILL^XUSCLEAN
"RTN","FHMASE",76,0)
 ;
"RTN","FHMASE1")
0^20^B10848521
"RTN","FHMASE1",1,0)
FHMASE1 ; HISC/AAC - Multidivisional Encounter Statistics ;10/14/03  11:57
"RTN","FHMASE1",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMASE1",3,0)
 ;
"RTN","FHMASE1",4,0)
 ;Encounter Statistic
"RTN","FHMASE1",5,0)
 ;
"RTN","FHMASE1",6,0)
 S HEADER="S T A T I S T I C S"
"RTN","FHMASE1",7,0)
 S (Y,CO)=""
"RTN","FHMASE1",8,0)
 D COM
"RTN","FHMASE1",9,0)
 I (Y=-1)&(CO="") Q
"RTN","FHMASE1",10,0)
 D DT G:U[X KIL
"RTN","FHMASE1",11,0)
 D A0
"RTN","FHMASE1",12,0)
 Q
"RTN","FHMASE1",13,0)
 ;
"RTN","FHMASE1",14,0)
IND ;List Encounters
"RTN","FHMASE1",15,0)
 ;
"RTN","FHMASE1",16,0)
 S HEADER="V I S I T S "
"RTN","FHMASE1",17,0)
 S (Y,CO)=""
"RTN","FHMASE1",18,0)
 D COM
"RTN","FHMASE1",19,0)
 I (Y=-1)&(CO="") Q
"RTN","FHMASE1",20,0)
 D DT G:U[X KIL S FHX1=DUZ,FHX2=0
"RTN","FHMASE1",21,0)
 D F1
"RTN","FHMASE1",22,0)
 Q
"RTN","FHMASE1",23,0)
 ;
"RTN","FHMASE1",24,0)
COM ; List Encounters for a clinician
"RTN","FHMASE1",25,0)
 S (ZCO,CO,COXX,CONAME,CONAM)=""
"RTN","FHMASE1",26,0)
 R !!,"Print report for all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y")
"RTN","FHMASE1",27,0)
 I ZCO'="Y" D N2 Q
"RTN","FHMASE1",28,0)
 Q 
"RTN","FHMASE1",29,0)
 ;
"RTN","FHMASE1",30,0)
A0 R !!,"Statistics for ALL Clinicians? Y// ",X:DTIME G:'$T!(X["^") KIL S:X="" X="Y" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7," Answer YES or NO" G A0
"RTN","FHMASE1",31,0)
 I X?1"Y".E G F0
"RTN","FHMASE1",32,0)
 ;
"RTN","FHMASE1",33,0)
A1 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " W ! D ^DIC K DIC G KIL:"^"[X!$D(DTOUT),A1:Y<1 S FHX1=+Y,FHX2=1 G F1
"RTN","FHMASE1",34,0)
 ;
"RTN","FHMASE1",35,0)
F0 R !!,"Break-down by Clinician? Y// ",X:DTIME G:'$T!(X=U) KIL S:X="" X="Y" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7," Answer YES or NO" G F0
"RTN","FHMASE1",36,0)
 S FHX1=X?1"Y".E-1,FHX2=0
"RTN","FHMASE1",37,0)
 ;
"RTN","FHMASE1",38,0)
F1 I FHX1'<0 R !!,"List Individual Patient Encounters? N// ",X:DTIME G:'$T!(X=U) KIL S:X="" X="N" D TR^FH I $P("YES",X,1)'="",$P("NO",X,1)'="" W *7," Answer YES or NO" G F1
"RTN","FHMASE1",39,0)
 S:FHX1'<0 FHX2=X?1"Y".E
"RTN","FHMASE1",40,0)
 ;
"RTN","FHMASE1",41,0)
F2 W !!,"The report requires a 132 column printer.",!
"RTN","FHMASE1",42,0)
 K IOP,%ZIS S %ZIS("A")="Print on Device: ",%ZIS="MQ" W ! D ^%ZIS K %ZIS,IOP G:POP KIL
"RTN","FHMASE1",43,0)
 I $D(IO("Q")) S FHPGM="Q1^FHMASE1A",FHLST="HEADER^EDT^SDT^FHX1^FHX2^ZCO^NAME^CONUMX^CO^CONAME" D EN2^FH Q 
"RTN","FHMASE1",44,0)
 U IO D Q1^FHMASE1A D ^%ZISC K %ZIS,IOP G KIL
"RTN","FHMASE1",45,0)
 ;
"RTN","FHMASE1",46,0)
KIL ;
"RTN","FHMASE1",47,0)
 K ^TMP($J) G KILL^XUSCLEAN Q
"RTN","FHMASE1",48,0)
 Q
"RTN","FHMASE1",49,0)
 ;
"RTN","FHMASE1",50,0)
DT ; Get From/To Dates
"RTN","FHMASE1",51,0)
D1 S %DT="AEPX",%DT("A")="Starting Date: " W ! D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D1 S SDT=+Y
"RTN","FHMASE1",52,0)
 I SDT>DT W *7,"  [Cannot Start after Today!] " G D1
"RTN","FHMASE1",53,0)
 ;
"RTN","FHMASE1",54,0)
D2 S %DT="AEPX",%DT("A")=" Ending Date: " D ^%DT S:$D(DTOUT) X="^" Q:U[X  G:Y<1 D2 S EDT=+Y
"RTN","FHMASE1",55,0)
 I EDT<SDT W *7,"  [End before Start?] " G D1
"RTN","FHMASE1",56,0)
 I EDT>DT W *7,"  [Must Not enter date greater than Today!] " G D1
"RTN","FHMASE1",57,0)
 Q
"RTN","FHMASE1",58,0)
N2 ;Get Communications Office
"RTN","FHMASE1",59,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHMASE1",60,0)
 D ^DIC I (Y=-1)&(CO="") Q
"RTN","FHMASE1",61,0)
 I Y=-1 Q
"RTN","FHMASE1",62,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME S CONUMX=$L(CO,"^") G N2
"RTN","FHMASE1",63,0)
 I Y=-1 K DIC Q
"RTN","FHMASE1",64,0)
 Q
"RTN","FHMASE1",65,0)
QUIT ;
"RTN","FHMASE1",66,0)
 Q
"RTN","FHMASE1A")
0^21^B41020024
"RTN","FHMASE1A",1,0)
FHMASE1A ; HISC/AAC - Multidiv Encounter Stats (cont.) ;10/14/03  13:13 
"RTN","FHMASE1A",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMASE1A",3,0)
Q1 ; Calculate the Encounters
"RTN","FHMASE1A",4,0)
 K ^TMP($J)
"RTN","FHMASE1A",5,0)
 S YX1=SDT\1-.0001,YX2=EDT\1+.3
"RTN","FHMASE1A",6,0)
 S TIT=";"_$P(^DD(115.6,10,0),"^",3)
"RTN","FHMASE1A",7,0)
 S D1XX="FHMASE1A"
"RTN","FHMASE1A",8,0)
 S XX1=YX1
"RTN","FHMASE1A",9,0)
 S (XXX,XX2,XX3,X3,XY,YY1)="",(COUNT,LL,L,D1F,D1CNTX,NUMBER)=0
"RTN","FHMASE1A",10,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHMASE1A",11,0)
 F K=1:1:11 S II(K)=0,JJ(K)=0
"RTN","FHMASE1A",12,0)
 ;
"RTN","FHMASE1A",13,0)
Q2 ;Get Communications Offices
"RTN","FHMASE1A",14,0)
 D DEL S (SS1,DD1,DD2,DD3,DD4,E1,COXX1,D1X,DIF,D1CNTX)=0,(NX,WW1)=""
"RTN","FHMASE1A",15,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX<1 ALLTOT S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX)
"RTN","FHMASE1A",16,0)
 I ZCO="Y" S COUNT=COUNT+1 G:COUNT>ZOUT ALLTOT S REC=$G(^FH(119.73,COUNT,0)),NAME=$P(REC,"^",1)
"RTN","FHMASE1A",17,0)
 ;
"RTN","FHMASE1A",18,0)
R2 ;Find Patient records within parameters
"RTN","FHMASE1A",19,0)
 I ZCO'="Y" G:$D(^FH(119.73,COXX,"I")) Q2 G:'$D(^FH(119.73,COXX,0)) Q2
"RTN","FHMASE1A",20,0)
 I ZCO="Y" G:$D(^FH(119.73,COUNT,"I")) Q2 G:'$D(^FH(119.73,COUNT,0)) Q2
"RTN","FHMASE1A",21,0)
 ;
"RTN","FHMASE1A",22,0)
 S YX1=SDT\1-.0001,YX2=EDT\1+.3,XX1=YX1
"RTN","FHMASE1A",23,0)
 ;
"RTN","FHMASE1A",24,0)
R1 F  S XX1=$O(^FHEN("AT",XX1)) G:XX1'>0 P1 G:XX1>YX2 P1  D 
"RTN","FHMASE1A",25,0)
R11 .S XXX=XX1 F E1=0:0 S E1=$O(^FHEN("AT",XXX,E1)) Q:E1'>0  D 
"RTN","FHMASE1A",26,0)
 ..I XX1>YX2 Q
"RTN","FHMASE1A",27,0)
 ..S XX2=$G(^FHEN(E1,0))
"RTN","FHMASE1A",28,0)
 ..I ZCO'="Y" S XY=$P(XX2,"^",6) Q:COXX'=XY
"RTN","FHMASE1A",29,0)
 ..I ZCO="Y" S XY=$P(XX2,"^",6) Q:COUNT'=XY
"RTN","FHMASE1A",30,0)
 ..S Y=$G(^FHEN(E1,0))
"RTN","FHMASE1A",31,0)
 ..S D1=$P(Y,"^",3) S D2=$P(Y,"^",4),D4=$P(Y,"^",6) Q:'D2  Q:'D4
"RTN","FHMASE1A",32,0)
 ..I FHX1>0,D1'=FHX1 Q
"RTN","FHMASE1A",33,0)
 ..I $D(^FH(119.73,D4,"I")) Q
"RTN","FHMASE1A",34,0)
 ..S D6=$P(Y,"^",7),D3=$P(Y,"^",8),D9=$P(Y,"^",9),D5=$P(Y,"^",11) D C0
"RTN","FHMASE1A",35,0)
 ..S D2=$P($G(^FH(115.6,D2,0)),"^",1,2) Q:"^"[D2
"RTN","FHMASE1A",36,0)
 ..S Z1=$P(D2,"^",2),D2=$P(D2,"^",1)
"RTN","FHMASE1A",37,0)
 ..S D8=$F(TIT,";"_Z1_":") Q:D8<0
"RTN","FHMASE1A",38,0)
 ..S:D6="F" D2=D2_"~F"
"RTN","FHMASE1A",39,0)
 ..S S1=$G(^TMP($J,0,D8,D2,D4)) D UPD S ^TMP($J,0,D8,D2,D4)=S1
"RTN","FHMASE1A",40,0)
 ..S S1=$G(^TMP($J,D1,D8,D2,D4)) D UPD S ^TMP($J,D1,D8,D2,D4)=S1 S DD1=D1,DD8=D8,DD2=D2,DD4=D4 Q:'FHX2
"RTN","FHMASE1A",41,0)
 ..S (DTP,W1)=$P(Y,"^",2)\1 D DTP^FH I '$D(^TMP($J,D1,D8,D2,D4,W1)) S ^TMP($J,D1,D8,D2,D4,W1)=DTP,^(W1,0)=0 S D2=DD2,D3=DD3,D4=DD4 I '$D(^FHEN(E1,"P")) S DFN="^"_D5 D R3 Q
"RTN","FHMASE1A",42,0)
 ..F DFN=0:0 S DFN=$O(^FHEN(E1,"P",DFN)) Q:DFN<1  D R3
"RTN","FHMASE1A",43,0)
 ..Q
"RTN","FHMASE1A",44,0)
 .Q
"RTN","FHMASE1A",45,0)
 Q
"RTN","FHMASE1A",46,0)
 G R11
"RTN","FHMASE1A",47,0)
 ;
"RTN","FHMASE1A",48,0)
R3 ;
"RTN","FHMASE1A",49,0)
 S L=^TMP($J,D1,D8,D2,D4,W1,0)+1,^(0)=L S WW1=W1
"RTN","FHMASE1A",50,0)
 S ^TMP($J,D1,D8,D2,D4,W1,L)=DFN Q
"RTN","FHMASE1A",51,0)
 ;
"RTN","FHMASE1A",52,0)
R4 ;
"RTN","FHMASE1A",53,0)
 S DFN="^"_D5 D R3 G R2
"RTN","FHMASE1A",54,0)
 ;
"RTN","FHMASE1A",55,0)
C0 ;
"RTN","FHMASE1A",56,0)
 S C(8)=$P(Y,"^",10),(C(1),C(2),C(3),C(4),C(5),C(6),C(7))=0
"RTN","FHMASE1A",57,0)
 F DFN=0:0 S DFN=$O(^FHEN(E1,"P",DFN)) Q:DFN<1  S X=^(DFN,0) D C1
"RTN","FHMASE1A",58,0)
 S C(7)=C(8)-C(1)-C(2)-C(4)-C(5) S:C(7)<1 C(7)=0
"RTN","FHMASE1A",59,0)
 I D9'="I" S TM=C(1)+C(4)+C(7) I TM S TM=D3/TM,C(3)=TM*C(1),C(6)=TM*C(4),C(3)=$J(C(3),0,1),C(6)=$J(C(6),0,1) Q
"RTN","FHMASE1A",60,0)
 Q
"RTN","FHMASE1A",61,0)
 ;
"RTN","FHMASE1A",62,0)
C1 ;
"RTN","FHMASE1A",63,0)
 S Z=$P(X,"^",2) G:Z<1 C2 S Z=$P($G(^SC(+Z,0)),"^",3) G:Z'="W" C2
"RTN","FHMASE1A",64,0)
 S C(1)=C(1)+1,C(2)=C(2)+$P(X,"^",3) S:D9="I" C(3)=C(3)+D3 Q
"RTN","FHMASE1A",65,0)
 ;
"RTN","FHMASE1A",66,0)
C2 ;
"RTN","FHMASE1A",67,0)
 S C(4)=C(4)+1,C(5)=C(5)+$P(X,"^",3) S:D9="I" C(6)=C(6)+D3 Q
"RTN","FHMASE1A",68,0)
 ;
"RTN","FHMASE1A",69,0)
UPD ;Update S1 record
"RTN","FHMASE1A",70,0)
 S $P(S1,"^",1)=$P(S1,"^",1)+1,$P(S1,"^",2)=$P(S1,"^",2)+D3
"RTN","FHMASE1A",71,0)
 F K=1:1:8 I C(K) S $P(S1,"^",K+2)=$P(S1,"^",K+2)+C(K)
"RTN","FHMASE1A",72,0)
 Q
"RTN","FHMASE1A",73,0)
 ;
"RTN","FHMASE1A",74,0)
P1 ;load data by paramters/totals for each Communication Office
"RTN","FHMASE1A",75,0)
 S DTP=SDT\1 D DTP^FH S DTE=DTP_" to " S DTP=EDT\1 D DTP^FH S DTE=DTE_DTP,PG=0 D HEAD I FHX1>0 S NAM="" D D0
"RTN","FHMASE1A",76,0)
 S (NX,D8)="",CT=0 F K=1:1:11 S (I(K),J(K))=0
"RTN","FHMASE1A",77,0)
 ;
"RTN","FHMASE1A",78,0)
 F KK=0:0 S D8=$O(^TMP($J,0,D8)) Q:D8=""  S CT=CT+1 D:CT'=1 STOT W ! D PR F K=0:0 S NX=$O(^TMP($J,0,D8,NX)) Q:NX=""  S X1=$P(NX,"~",1)_$S($P(NX,"~",2)="F":"  (F)",1:"") Q:X1=""  S S1=$G(^TMP($J,0,D8,NX,D4)) D PP
"RTN","FHMASE1A",79,0)
 D STOT W ! S X=" T O T A L" D PX D TOT W ! F K=1:1:11 S (I(K),J(K))=0 I FHX1<0 G Q2 D HEAD I FHX2<0 D Q2
"RTN","FHMASE1A",80,0)
 ;
"RTN","FHMASE1A",81,0)
P2 ;load data for each clinician
"RTN","FHMASE1A",82,0)
 D:$Y>55 HEAD S (D8,NAM)="",CT=0
"RTN","FHMASE1A",83,0)
 S D8=0
"RTN","FHMASE1A",84,0)
 F D1=0:0 S D1=$O(^TMP($J,D1)) G:D1="" P2A S CT=CT+1 D:CT'=1 STOT W ! F D8=0:0 S D8=$O(^TMP($J,D1,D8)) Q:D8'>0  D PR,D0 S D2="" F L1=0:0 S D2=$O(^TMP($J,D1,D8,D2)) Q:D2=""  S S1=$G(^TMP($J,D1,D8,D2,D4)) Q:S1=""   D SETX1,PP I FHX2 D P3
"RTN","FHMASE1A",85,0)
 D STOT G P2
"RTN","FHMASE1A",86,0)
P2A D STOT W ! S X=" TOTAL ENCOUNTERS" D TOT W @IOF D DEL S X1=SDT G Q2
"RTN","FHMASE1A",87,0)
 ;
"RTN","FHMASE1A",88,0)
SETX1 ;
"RTN","FHMASE1A",89,0)
 S X1=$P(D2,"~",1)_$S($P(D2,"~",2)="F":"  (F)",1:"")
"RTN","FHMASE1A",90,0)
 Q
"RTN","FHMASE1A",91,0)
D0 ;Get Clinician Name
"RTN","FHMASE1A",92,0)
 I FHX1>0 S D1=FHX1
"RTN","FHMASE1A",93,0)
 S NAM=$P(^VA(200,D1,0),"^",1),NAM=$E(NAM,1,30) W !,NAM Q
"RTN","FHMASE1A",94,0)
 ;
"RTN","FHMASE1A",95,0)
P3 ;
"RTN","FHMASE1A",96,0)
 S DTP=""
"RTN","FHMASE1A",97,0)
 ;
"RTN","FHMASE1A",98,0)
P4 ;
"RTN","FHMASE1A",99,0)
 S DTP=$O(^TMP($J,D1,D8,D2,D4,DTP)) Q:DTP=""  S S1=^(DTP),W1=0
"RTN","FHMASE1A",100,0)
 ;
"RTN","FHMASE1A",101,0)
P5 ;
"RTN","FHMASE1A",102,0)
 S W1=$O(^TMP($J,D1,D8,D2,D4,DTP,W1)) G:W1="" P4 S DFN=^(W1) G:DFN<1 P6
"RTN","FHMASE1A",103,0)
 S Y=$G(^DPT(DFN,0)) G:Y="" P5 D PID^FHDPA
"RTN","FHMASE1A",104,0)
 W !?7,S1,?17,BID,?26,$P(Y,"^",1) G P5
"RTN","FHMASE1A",105,0)
 ;
"RTN","FHMASE1A",106,0)
P6 ;
"RTN","FHMASE1A",107,0)
 W !?7,S1,?17,$P(DFN,"^",2) G P5
"RTN","FHMASE1A",108,0)
 ;
"RTN","FHMASE1A",109,0)
PP ;Print totals for Communications Offices
"RTN","FHMASE1A",110,0)
 D:$Y>58 HEAD W !?5,X1,?47,$J($P(S1,"^",1),6,0) S I(1)=I(1)+$P(S1,"^",1),J(1)=J(1)+$P(S1,"^",1)  ;)
"RTN","FHMASE1A",111,0)
 F K=1:1:6 S Z=$P(S1,"^",K+2),I(K+2)=I(K+2)+Z,J(K+2)=J(K+2)+Z W $S(K=3!(K=6):$S(Z:$J(Z,8,1),1:$J("",8)),1:$J($S(Z:Z,1:""),6))
"RTN","FHMASE1A",112,0)
 S Z=$P(S1,"^",9),I(9)=I(9)+$S(Z'<1:Z,1:0),J(9)=J(9)+$S(Z'<1:Z,1:0) W ?97,$J($S(Z'<1:Z,1:""),6)
"RTN","FHMASE1A",113,0)
 ;
"RTN","FHMASE1A",114,0)
 I Z S Z=$P(S1,"^",2)-$P(S1,"^",5)-$P(S1,"^",8),I(10)=I(10)+$S(Z'<1:Z,1:0),J(10)=J(10)+$S(Z'<1:Z,1:0)
"RTN","FHMASE1A",115,0)
 ;
"RTN","FHMASE1A",116,0)
 W $S(Z'<1:$J(Z,8,1),1:$J("",8))
"RTN","FHMASE1A",117,0)
 S Z=$P(S1,"^",10),I(11)=I(11)+Z,J(11)=J(11)+Z W ?113,$J($S(Z'<1:Z,1:""),6)
"RTN","FHMASE1A",118,0)
 I $P(S1,"^",2) W $J($P(S1,"^",2),8,1) S I(2)=I(2)+$P(S1,"^",2),J(2)=J(2)+$P(S1,"^",2)
"RTN","FHMASE1A",119,0)
 ;
"RTN","FHMASE1A",120,0)
 Q
"RTN","FHMASE1A",121,0)
 ;
"RTN","FHMASE1A",122,0)
PX ;Accumulate amount for final total
"RTN","FHMASE1A",123,0)
 S II(1)=II(1)+I(1)  ;,II(3)=II(3)+I(3),II(6)=II(6)+I(6)
"RTN","FHMASE1A",124,0)
 F K=1:1:6 S II(K+2)=II(K+2)+I(K+2) ;,II(K+2)=II(K+2)+I(K+2)
"RTN","FHMASE1A",125,0)
 S II(9)=II(9)+I(9),II(10)=II(10)+I(10),II(11)=II(11)+I(11)
"RTN","FHMASE1A",126,0)
 Q
"RTN","FHMASE1A",127,0)
 ;
"RTN","FHMASE1A",128,0)
PR ;
"RTN","FHMASE1A",129,0)
 S X=$P($E(TIT,D8,999),";",1)
"RTN","FHMASE1A",130,0)
 D:$Y>55 HEAD W !?3,X Q
"RTN","FHMASE1A",131,0)
 Q
"RTN","FHMASE1A",132,0)
 ;
"RTN","FHMASE1A",133,0)
STOT ;Print sub-totals for Communications Office and Clinician
"RTN","FHMASE1A",134,0)
 W !?5,"Subtotal",?47,$J(J(1),6) F K=1:1:6 W $S(K=3!(K=6):$S(J(K+2):$J(J(K+2),8,1),1:$J("",8)),1:$J($S(J(K+2):J(K+2),1:""),6))
"RTN","FHMASE1A",135,0)
 W ?97,$S(J(9):$J(J(9),6),1:$J("",6)),$S(J(10):$J(J(10),8,1),1:$J("",8))
"RTN","FHMASE1A",136,0)
 W ?113,$S(J(11):$J(J(11),6),1:$J("",6)),$S(J(2):$J(J(2),8,1),1:$J("",8)) W !
"RTN","FHMASE1A",137,0)
 F K=1:1:11 S J(K)=0
"RTN","FHMASE1A",138,0)
 Q
"RTN","FHMASE1A",139,0)
 ;
"RTN","FHMASE1A",140,0)
TOT ;
"RTN","FHMASE1A",141,0)
 ;Totals by Communications Offices
"RTN","FHMASE1A",142,0)
 W !?3,NAME,X,?47,$J(I(1),6) F K=1:1:6 W $S(K=3!(K=6):$S(I(K+2):$J(I(K+2),8,1),1:$J("",8)),1:$J($S(I(K+2):I(K+2),1:""),6))
"RTN","FHMASE1A",143,0)
 W ?97,$S(I(9):$J(I(9),6),1:$J("",6)),$S(I(10):$J(I(10),8,1),1:$J("",8))
"RTN","FHMASE1A",144,0)
 W ?113,$S(I(11):$J(I(11),6),1:$J("",6)),$S(I(2):$J(I(2),8,1),1:$J("",8))
"RTN","FHMASE1A",145,0)
 F K=1:1:11 S I(K)=0
"RTN","FHMASE1A",146,0)
 Q
"RTN","FHMASE1A",147,0)
 ;
"RTN","FHMASE1A",148,0)
ALLTOT ; 
"RTN","FHMASE1A",149,0)
 ;Final Totals - all Communication Offices
"RTN","FHMASE1A",150,0)
 S XS="ALL COMMUNICATIONS OFFICES " W !,XS,?47,$J(II(1),6) F K=1:1:6 W $S(K=3!(K=6):$S(II(K+2):$J(II(K+2),8,1),1:$J("",8)),1:$J($S(II(K+2):II(K+2),1:""),6))
"RTN","FHMASE1A",151,0)
 W ?97,$S(II(9):$J(I(9),6),1:$J("",6)),$S(II(10):$J(II(10),8,1),1:$J("",8))
"RTN","FHMASE1A",152,0)
 W ?113,$S(II(11):$J(II(11),6),1:$J("",6)) W $S(II(5):$J(II(5),8,1),1:$J("",6))
"RTN","FHMASE1A",153,0)
 D DEL Q
"RTN","FHMASE1A",154,0)
 ;
"RTN","FHMASE1A",155,0)
HEAD ;Print page headers
"RTN","FHMASE1A",156,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1 W !?30,"D I E T E T I C   E N C O U N T E R  ",?69,HEADER,?120,"Page ",PG
"RTN","FHMASE1A",157,0)
 W !?2,NAME,?(114-$L(DTE)\2),DTE,!?47,"Number      Inpatients         Outpatients            Others           Total"
"RTN","FHMASE1A",158,0)
 W !?56,"Pat   Col   Units   Pat   Col   Units",?98,"Persn   Units   Persn   Units",! Q
"RTN","FHMASE1A",159,0)
 ;
"RTN","FHMASE1A",160,0)
DEL ;DELETE RECORDS FROM ^TMP
"RTN","FHMASE1A",161,0)
 K ^TMP($J)
"RTN","FHMASE1A",162,0)
 W !!
"RTN","FHMASE1A",163,0)
 Q
"RTN","FHMASE1A",164,0)
Q ;
"RTN","FHMASE1A",165,0)
QUIT ;
"RTN","FHMASE1A",166,0)
 Q
"RTN","FHMMBRPT")
0^22^B17340121
"RTN","FHMMBRPT",1,0)
FHMMBRPT ;Hines OIFO/JT,RTK,AAC - Multidiv Monitor Brief ;10/10/03  11:49
"RTN","FHMMBRPT",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMMBRPT",3,0)
 ;
"RTN","FHMMBRPT",4,0)
COM ;get Communication Offices
"RTN","FHMMBRPT",5,0)
 S (ZCO,CO,CONAME,CONAM,WARD,FHCOMM,ZZOUT,ZOUT,CONUMX)="",(COXX,ALLMON,ALLADM,ALLFHPER)=0
"RTN","FHMMBRPT",6,0)
 ;S ZZOUT=$G(^FH(119.73,0)),CONUMX=$P(ZZOUT,"^",4),ZOUT=CONUMX
"RTN","FHMMBRPT",7,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHMMBRPT",8,0)
 R !!,"Print report for all Communication Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y")
"RTN","FHMMBRPT",9,0)
 I ZCO'="Y" D N2 I (Y=-1)&(CO="") Q
"RTN","FHMMBRPT",10,0)
 ;
"RTN","FHMMBRPT",11,0)
DATE ;sets date
"RTN","FHMMBRPT",12,0)
 W ! S %DT="AEPT",%DT("A")="Enter beginning date: " D ^%DT Q:Y<0
"RTN","FHMMBRPT",13,0)
 S FHSDT=Y,%DT(0)=FHSDT,%DT("A")="Enter ending date: " D ^%DT K %DT(0)
"RTN","FHMMBRPT",14,0)
 S PG=0,EX=""
"RTN","FHMMBRPT",15,0)
 I Y<0 D END Q
"RTN","FHMMBRPT",16,0)
 S FHEDT=Y
"RTN","FHMMBRPT",17,0)
 D DEV Q
"RTN","FHMMBRPT",18,0)
 ;D END
"RTN","FHMMBRPT",19,0)
 ;
"RTN","FHMMBRPT",20,0)
EN ;get admission/monitor information
"RTN","FHMMBRPT",21,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX=0 THEND  S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX)
"RTN","FHMMBRPT",22,0)
 I ZCO="Y" S COXX=COXX+1 G:COXX>ZOUT THEND  S NAME=$G(^FH(119.73,COXX,0)),NAME=$P(NAME,"^")
"RTN","FHMMBRPT",23,0)
 I $D(^FH(119.73,COXX,"I"))!'$D(^FH(119.73,COXX,0)) G EN
"RTN","FHMMBRPT",24,0)
 ;
"RTN","FHMMBRPT",25,0)
 D NOW^%DTC S Y=X D DD^%DT S FHNDT=Y D PG
"RTN","FHMMBRPT",26,0)
 S ADMTOT=0,MONTOT=0
"RTN","FHMMBRPT",27,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT1",I)) Q:'I!(I>FHEDT)  D
"RTN","FHMMBRPT",28,0)
 .S J=0 F  S J=$O(^DGPM("ATT1",I,J)) Q:'J!(EX=U)  S REC=$G(^DGPM(J,0)) S WARD=$P(REC,"^",6) Q:WARD=""  D COFF Q:FHCOMM=""  Q:$D(^FH(119.73,FHCOMM,"I"))  Q:FHCOMM'=COXX  D
"RTN","FHMMBRPT",29,0)
 ..S DFN=$P(^DGPM(J,0),U,3) I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMBRPT",30,0)
 ..S Y=$P(I,".") X ^DD("DD") W !,Y,?13,$E($P($G(^DPT(DFN,0)),U,1),1,23)
"RTN","FHMMBRPT",31,0)
 ..W ?39,$E($P($G(^DPT(DFN,0)),U,9),6,9) S ADMTOT=ADMTOT+1
"RTN","FHMMBRPT",32,0)
 ..I $D(^FHPT(DFN,"A",J,"MO","B")) W ?48,"Yes" S MONTOT=MONTOT+1
"RTN","FHMMBRPT",33,0)
 ..S Y=$P($P($G(^FHPT(DFN,"A",J,0)),U,14),".",1) I Y X ^DD("DD") W ?56,Y
"RTN","FHMMBRPT",34,0)
 ..Q
"RTN","FHMMBRPT",35,0)
 .Q
"RTN","FHMMBRPT",36,0)
 I EX=U D THEND Q
"RTN","FHMMBRPT",37,0)
 W !!,"TOTAL ADMISSIONS: ",?22,ADMTOT S ALLADM=ALLADM+ADMTOT I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMBRPT",38,0)
 W !,"TOTAL WITH MONITORS:",?22,MONTOT S ALLMON=ALLMON+MONTOT I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMBRPT",39,0)
 W !,"Percentage of Admissions with Monitors: "
"RTN","FHMMBRPT",40,0)
 I ADMTOT=0!(MONTOT=0) W "0.0%" D EN Q
"RTN","FHMMBRPT",41,0)
 S FHPER=(MONTOT/ADMTOT)*100
"RTN","FHMMBRPT",42,0)
 I $L($P(FHPER,".",2))>2 S FHPER=$P(FHPER,".",1)_"."_$E($P(FHPER,".",2),1,2)
"RTN","FHMMBRPT",43,0)
 W FHPER,"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMBRPT",44,0)
 G EN
"RTN","FHMMBRPT",45,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR
"RTN","FHMMBRPT",46,0)
 Q
"RTN","FHMMBRPT",47,0)
 ;
"RTN","FHMMBRPT",48,0)
COFF ;get Communications Offices
"RTN","FHMMBRPT",49,0)
 Q:'$D(^FH(119.6,"AW",WARD))
"RTN","FHMMBRPT",50,0)
 S FHWARD=$O(^FH(119.6,"AW",WARD,""))
"RTN","FHMMBRPT",51,0)
 S FHCOMM=$P($G(^FH(119.6,FHWARD,0)),"^",8)
"RTN","FHMMBRPT",52,0)
 Q
"RTN","FHMMBRPT",53,0)
 ;
"RTN","FHMMBRPT",54,0)
DEV ;get device and set up queue
"RTN","FHMMBRPT",55,0)
 W ! K %ZIS,IOP S %ZIS="Q" D ^%ZIS Q:POP
"RTN","FHMMBRPT",56,0)
 I '$D(IO("Q")) U IO D EN,^%ZISC,END Q
"RTN","FHMMBRPT",57,0)
 S ZTRTN="EN^FHMMBRPT",ZTSAVE("FHSDT")="",ZTSAVE("FHEDT")=""
"RTN","FHMMBRPT",58,0)
 S ZTSAVE=("FHNDT")="",ZTSAVE=("FHPER")="",ZTSAVE("ZCO")=""
"RTN","FHMMBRPT",59,0)
 S ZTSAVE("CO")="",ZTSAVE("ALLMON")="",ZTSAVE("PG")="",ZTSAVE("EX")=""
"RTN","FHMMBRPT",60,0)
 S ZTSAVE("ZOUT")="",ZTSAVE("ALLADM")="",ZTSAVE("ALLFHPER")=""
"RTN","FHMMBRPT",61,0)
 S ZTSAVE("COXX")="",ZTSAVE("CONUMX")="",ZTSAVE("FHCOMM")=""
"RTN","FHMMBRPT",62,0)
 S ZTSAVE("CONAME")=""
"RTN","FHMMBRPT",63,0)
 S ZTDESC="Dietetics Monitor Report" D ^%ZTLOAD
"RTN","FHMMBRPT",64,0)
 D ^%ZISC K %ZIS,IOP
"RTN","FHMMBRPT",65,0)
 ;D END Q
"RTN","FHMMBRPT",66,0)
 ;
"RTN","FHMMBRPT",67,0)
END ;kill and quit
"RTN","FHMMBRPT",68,0)
 K I,J,DFN,SSN,ADMTOT,MONTOT,FHPER,FHSDT,FHEDT,FHNDT,X,Y,PG
"RTN","FHMMBRPT",69,0)
 Q
"RTN","FHMMBRPT",70,0)
 ;
"RTN","FHMMBRPT",71,0)
THEND ;
"RTN","FHMMBRPT",72,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR
"RTN","FHMMBRPT",73,0)
 S NAME="ALL COMMUNICATION OFFICES " D HDR
"RTN","FHMMBRPT",74,0)
 W !!,"ALL TOTAL ADMISSIONS: ",?22,ALLADM
"RTN","FHMMBRPT",75,0)
 W !,"TOTAL WITH MONITORS:",?22,ALLMON
"RTN","FHMMBRPT",76,0)
 W !,"Percentage of Admissions with Monitors: "
"RTN","FHMMBRPT",77,0)
 I ALLADM=0!(ALLMON=0) W "0.0%" D END Q
"RTN","FHMMBRPT",78,0)
 S ALLFHPER=(ALLMON/ALLADM)*100
"RTN","FHMMBRPT",79,0)
 I $L($P(ALLFHPER,".",2))>2 S ALLFHPER=$P(ALLFHPER,".",1)_"."_$E($P(ALLFHPER,".",2),1,2)
"RTN","FHMMBRPT",80,0)
 W ALLFHPER,"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMBRPT",81,0)
 G END Q
"RTN","FHMMBRPT",82,0)
 ;
"RTN","FHMMBRPT",83,0)
N2 ;find Communications Office
"RTN","FHMMBRPT",84,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHMMBRPT",85,0)
 D ^DIC I (Y=-1)&(CO="") Q
"RTN","FHMMBRPT",86,0)
 I Y=-1 Q
"RTN","FHMMBRPT",87,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME S CONUMX=$L(CO,"^") G N2
"RTN","FHMMBRPT",88,0)
 I Y=-1 K DIC Q
"RTN","FHMMBRPT",89,0)
 Q
"RTN","FHMMBRPT",90,0)
 ;
"RTN","FHMMBRPT",91,0)
PG ;
"RTN","FHMMBRPT",92,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","FHMMBRPT",93,0)
 D HDR Q
"RTN","FHMMBRPT",94,0)
HDR ;Header
"RTN","FHMMBRPT",95,0)
 W:$Y @IOF W !,NAME,?30,"MONITOR BRIEF REPORT" W !,FHNDT,?60,"Page: " S PG=PG+1 W PG,!!
"RTN","FHMMBRPT",96,0)
 W "Admission",?13,"Patient",?39,"SSN",?45,"Monitor?",?56,"Discharge"
"RTN","FHMMBRPT",97,0)
 W ! F Z=1:1:79 W "="
"RTN","FHMMBRPT",98,0)
 Q
"RTN","FHMMNADM")
0^23^B28721298
"RTN","FHMMNADM",1,0)
FHMMNADM ;Hines OIFO/JT,RTK,AAC - Multidiv Adm/Disc Monitor Report ;10/10/03  10:34
"RTN","FHMMNADM",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMMNADM",3,0)
 ;
"RTN","FHMMNADM",4,0)
COM ;Get Communication Offices
"RTN","FHMMNADM",5,0)
 ;
"RTN","FHMMNADM",6,0)
 S (XX,ZCO,CO,COXX,CNAME,CONAME,CONAM,WARD,FHCOMM)="",(ALLMON,ALLMV)=0
"RTN","FHMMNADM",7,0)
 ;S ZZOUT=$G(^FH(119.73,0)),(CONUMX,ZOUT)=$P(ZZOUT,"^",4)
"RTN","FHMMNADM",8,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHMMNADM",9,0)
 R !!,"Print report for all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y")
"RTN","FHMMNADM",10,0)
 I ZCO'="Y" D N2 I (Y=-1)&(CO="") Q
"RTN","FHMMNADM",11,0)
 ;
"RTN","FHMMNADM",12,0)
DATE ;sets date
"RTN","FHMMNADM",13,0)
 ;
"RTN","FHMMNADM",14,0)
 K %DT(0) S %DT="AEPT",%DT("A")="Enter beginning date: " D ^%DT Q:Y<0
"RTN","FHMMNADM",15,0)
 S FHSDT=Y,%DT(0)=FHSDT,%DT("A")="Enter ending date: " D ^%DT Q:Y<0
"RTN","FHMMNADM",16,0)
 S FHEDT=Y
"RTN","FHMMNADM",17,0)
 S DIR(0)="SA^A:Admissions;D:Discharges"
"RTN","FHMMNADM",18,0)
 S DIR("A")="Select type of movement for this report: " D ^DIR
"RTN","FHMMNADM",19,0)
 Q:Y["^"!(Y="")  S TYP=Y
"RTN","FHMMNADM",20,0)
 D DEV Q
"RTN","FHMMNADM",21,0)
 ;
"RTN","FHMMNADM",22,0)
EN ;get admission/monitor information
"RTN","FHMMNADM",23,0)
 Q:XX="*"
"RTN","FHMMNADM",24,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX=0 THEND  S COXX=$P(CO,"^",CONUMX),CNAME=$P(CONAME,"^",CONUMX)
"RTN","FHMMNADM",25,0)
 I ZCO="Y" S COXX=COXX+1 G:COXX>ZOUT THEND  S CNAME=$G(^FH(119.73,COXX,0)),CNAME=$P(CNAME,"^")
"RTN","FHMMNADM",26,0)
 I $D(^FH(119.73,COXX,"I"))!'$D(^FH(119.73,COXX,0)) G EN
"RTN","FHMMNADM",27,0)
 ;
"RTN","FHMMNADM",28,0)
 I TYP'="A" G EN1 Q
"RTN","FHMMNADM",29,0)
 S PG=0,EX="",Y=DT X ^DD("DD") S FHNDT=Y D HDR
"RTN","FHMMNADM",30,0)
 S MVTOT=0,MONTOT=0
"RTN","FHMMNADM",31,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT1",I)) Q:'I!(I>FHEDT)!(EX=U)  D 
"RTN","FHMMNADM",32,0)
 .S J=0 F  S J=$O(^DGPM("ATT1",I,J)) Q:'J!(EX=U)  S REC=$G(^DGPM(J,0)) S WARD=$P(REC,"^",6) Q:WARD=""  D COFF2 Q:FHCOMM=""  Q:$D(^FH(119.73,FHCOMM,"I"))  Q:FHCOMM'=COXX  D
"RTN","FHMMNADM",33,0)
 ..S ADM=J,ADMD=I D WRT
"RTN","FHMMNADM",34,0)
 .Q
"RTN","FHMMNADM",35,0)
 Q:XX="*"
"RTN","FHMMNADM",36,0)
 D END
"RTN","FHMMNADM",37,0)
 D EN
"RTN","FHMMNADM",38,0)
 Q
"RTN","FHMMNADM",39,0)
 ;
"RTN","FHMMNADM",40,0)
COFF ;get communication offices
"RTN","FHMMNADM",41,0)
 Q:'$D(^DIC(42,"B",WARD))
"RTN","FHMMNADM",42,0)
 S WARDIEN=$O(^DIC(42,"B",WARD,""))
"RTN","FHMMNADM",43,0)
 Q:'$D(^FH(119.6,"AW",WARDIEN))
"RTN","FHMMNADM",44,0)
 S FHWARD=$O(^FH(119.6,"AW",WARDIEN,""))
"RTN","FHMMNADM",45,0)
 S FHCOMM=$P($G(^FH(119.6,FHWARD,0)),"^",8)
"RTN","FHMMNADM",46,0)
 Q
"RTN","FHMMNADM",47,0)
 ;
"RTN","FHMMNADM",48,0)
COFF2 ;
"RTN","FHMMNADM",49,0)
 Q:'$D(^FH(119.6,"AW",WARD))
"RTN","FHMMNADM",50,0)
 S FHWARD=$O(^FH(119.6,"AW",WARD,""))
"RTN","FHMMNADM",51,0)
 S FHCOMM=$P($G(^FH(119.6,FHWARD,0)),"^",8)
"RTN","FHMMNADM",52,0)
 Q
"RTN","FHMMNADM",53,0)
 ;
"RTN","FHMMNADM",54,0)
WRT ;write info
"RTN","FHMMNADM",55,0)
 ; 
"RTN","FHMMNADM",56,0)
 S DFN=$P(^DGPM(J,0),U,3) I $Y>(IOSL-4) D PG I EX=U S XX="*" Q
"RTN","FHMMNADM",57,0)
 S Y=$P(ADMD,".") X ^DD("DD") W !,Y,?13,$E($P($G(^DPT(DFN,0)),U,1),U,23)
"RTN","FHMMNADM",58,0)
 W ?39,$E($P($G(^DPT(DFN,0)),U,9),6,9) S MVTOT=MVTOT+1
"RTN","FHMMNADM",59,0)
 I $D(^FHPT(DFN,"A",ADM,"MO","B")) W ?48,"Yes" S MONTOT=MONTOT+1
"RTN","FHMMNADM",60,0)
 S Y=$P($P($G(^FHPT(DFN,"A",ADM,0)),U,14),".",1) I Y X ^DD("DD") W ?56,Y
"RTN","FHMMNADM",61,0)
 I $Y>(IOSL-4) D PG I EX=U S XX="*" Q
"RTN","FHMMNADM",62,0)
 Q
"RTN","FHMMNADM",63,0)
 ;
"RTN","FHMMNADM",64,0)
EN1 ;discharges
"RTN","FHMMNADM",65,0)
 S PG=0,EX="",Y=DT X ^DD("DD") S FHNDT=Y D HDR I EX=U S XX="*" Q
"RTN","FHMMNADM",66,0)
 S MVTOT=0,MONTOT=0
"RTN","FHMMNADM",67,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT3",I)) Q:'I!(I>FHEDT)!(EX=U)  D
"RTN","FHMMNADM",68,0)
 .S J=0 F  S J=$O(^DGPM("ATT3",I,J)) Q:'J!(EX=U)  S D0=J D WARD^DGPMUTL S WARD=X Q:WARD=""  D COFF Q:FHCOMM=""  Q:$D(^FH(119.73,FHCOMM,"I"))  Q:FHCOMM'=COXX  D
"RTN","FHMMNADM",69,0)
 ..S ADM=$P(^DGPM(J,0),U,14)
"RTN","FHMMNADM",70,0)
 ..S ADMD=$P(^DGPM(ADM,0),U,1) D WRT
"RTN","FHMMNADM",71,0)
 .Q
"RTN","FHMMNADM",72,0)
 D END
"RTN","FHMMNADM",73,0)
 D EN Q
"RTN","FHMMNADM",74,0)
 ;
"RTN","FHMMNADM",75,0)
END ;end/kill/quit
"RTN","FHMMNADM",76,0)
 ;
"RTN","FHMMNADM",77,0)
 I EX=U Q
"RTN","FHMMNADM",78,0)
 W !!,"TOTAL "_$S(TYP="A":"ADMISSIONS",TYP="D":"DISCHARGES")_": ",?22,MVTOT S ALLMV=ALLMV+MVTOT
"RTN","FHMMNADM",79,0)
 W !,"TOTAL WITH MONITORS:",?22,MONTOT S ALLMON=ALLMON+MONTOT
"RTN","FHMMNADM",80,0)
 S FHPER=0 I MONTOT>0,MVTOT>0 S FHPER=(MONTOT/MVTOT)*100
"RTN","FHMMNADM",81,0)
 I $L($P(FHPER,".",2))>2 S FHPER=$P(FHPER,".",1)_"."_$E($P(FHPER,".",2),1,2)
"RTN","FHMMNADM",82,0)
 W !,"Percentage of "
"RTN","FHMMNADM",83,0)
 W $S(TYP="A":"Admissions",TYP="D":"Discharges")
"RTN","FHMMNADM",84,0)
 W " with Monitors: ",FHPER,"%"
"RTN","FHMMNADM",85,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR
"RTN","FHMMNADM",86,0)
 Q
"RTN","FHMMNADM",87,0)
 ;
"RTN","FHMMNADM",88,0)
THEND ;end/kill/quit
"RTN","FHMMNADM",89,0)
 ;
"RTN","FHMMNADM",90,0)
 I EX=U Q
"RTN","FHMMNADM",91,0)
 S CNAME="ALL "
"RTN","FHMMNADM",92,0)
 D HDR
"RTN","FHMMNADM",93,0)
 W !!,"ALL TOTAL "_$S(TYP="A":"ADMISSIONS",TYP="D":"DISCHARGES")_": ",?22,ALLMV
"RTN","FHMMNADM",94,0)
 W !,"TOTAL WITH MONITORS:",?22,ALLMON
"RTN","FHMMNADM",95,0)
 S ALLFHPER=0 I ALLMON>0,ALLMV>0 S ALLFHPER=(ALLMON/ALLMV)*100
"RTN","FHMMNADM",96,0)
 I $L($P(ALLFHPER,".",2))>2 S ALLFHPER=$P(ALLFHPER,".",1)_"."_$E($P(ALLFHPER,".",2),1,2)
"RTN","FHMMNADM",97,0)
 W !,"Percentage of "
"RTN","FHMMNADM",98,0)
 W $S(TYP="A":"Admissions",TYP="D":"Discharges")
"RTN","FHMMNADM",99,0)
 W " with Monitors: ",ALLFHPER,"%"
"RTN","FHMMNADM",100,0)
 Q
"RTN","FHMMNADM",101,0)
 ;
"RTN","FHMMNADM",102,0)
 ;
"RTN","FHMMNADM",103,0)
DEV ;get device and set up queue
"RTN","FHMMNADM",104,0)
 S TAG=$S(TYP="A":"EN",TYP="D":"EN")
"RTN","FHMMNADM",105,0)
 K %ZIS,IOP S %ZIS="Q" D ^%ZIS Q:POP
"RTN","FHMMNADM",106,0)
 I '$D(IO("Q")) U IO D @TAG,^%ZISC Q
"RTN","FHMMNADM",107,0)
 S ZTRTN=TAG_"^FHMMNADM",ZTSAVE("FHSDT")="",ZTSAVE("FHEDT")=""
"RTN","FHMMNADM",108,0)
 S ZTSAVE("ZCO")="",ZTSAVE("COXX")="",ZTSAVE("CONUMX")="",ZTSAVE("ZOUT")="",ZTSAVE("XX")=""
"RTN","FHMMNADM",109,0)
 S ZTSAVE("CNAME")="",ZTSAVE("FHCOMM")="",ZTSAVE("CO")="",ZTSAVE("CONAME")=""
"RTN","FHMMNADM",110,0)
 S ZTSAVE("ALLMV")="",ZTSAVE("ALLMON")="",ZTSAVE("ALLFHPER")=""
"RTN","FHMMNADM",111,0)
 S ZTSAVE("TYP")="",ZTDESC="Dietetics Monitor Report" D ^%ZTLOAD
"RTN","FHMMNADM",112,0)
 W !,"Task #",ZTSK
"RTN","FHMMNADM",113,0)
 D ^%ZISC K %ZIS,IOP Q
"RTN","FHMMNADM",114,0)
 Q
"RTN","FHMMNADM",115,0)
 ;
"RTN","FHMMNADM",116,0)
KL ;
"RTN","FHMMNADM",117,0)
 K I,J,DFN,SSN,MVTOT,MONTOT,FHPER,X,Y,PG,FHNDT,ADM,CO,CONAME,CONAM,WARD,FHCOMM,ALLMON,ALLMV
"RTN","FHMMNADM",118,0)
 K TAG,DIR,%DT,ADDT Q
"RTN","FHMMNADM",119,0)
 Q
"RTN","FHMMNADM",120,0)
 ;
"RTN","FHMMNADM",121,0)
N2 ;Find Communications Office
"RTN","FHMMNADM",122,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHMMNADM",123,0)
 D ^DIC I (Y=-1)&(CO="") Q
"RTN","FHMMNADM",124,0)
 I Y=-1 Q
"RTN","FHMMNADM",125,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME S CONUMX=$L(CO,"^") G N2
"RTN","FHMMNADM",126,0)
 I Y=-1 K DIC Q
"RTN","FHMMNADM",127,0)
 Q
"RTN","FHMMNADM",128,0)
 ;
"RTN","FHMMNADM",129,0)
PG ;
"RTN","FHMMNADM",130,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","FHMMNADM",131,0)
 D HDR Q
"RTN","FHMMNADM",132,0)
HDR ;Header
"RTN","FHMMNADM",133,0)
 ;
"RTN","FHMMNADM",134,0)
 W:$Y @IOF
"RTN","FHMMNADM",135,0)
 W !,"DIETETIC MONITOR REPORT (Monitoring "
"RTN","FHMMNADM",136,0)
 W $S(TYP="A":"Admissions",TYP="D":"Discharges")_")"
"RTN","FHMMNADM",137,0)
 W !,FHNDT,?60,"Page: " S PG=PG+1 W PG,!
"RTN","FHMMNADM",138,0)
 W !,?5,"Communication Offices: ",CNAME,!!
"RTN","FHMMNADM",139,0)
 W "Admission",?13,"Patient",?39,"SSN",?45,"Monitor?",?56,"Discharge"
"RTN","FHMMNADM",140,0)
 W ! F Z=1:1:79 W "="
"RTN","FHMMNADM",141,0)
 Q
"RTN","FHMMNPRT")
0^24^B34894053
"RTN","FHMMNPRT",1,0)
FHMMNPRT ;Hines OIFO/RTK,AAC - Mult Monitor Report Print ;10/10/03  10:29
"RTN","FHMMNPRT",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMMNPRT",3,0)
 ;
"RTN","FHMMNPRT",4,0)
 S (COUNT,COMM,CTCOMM,MON,ALLMON,ALLMON1,M1,M2,M3,M4,M5)=0
"RTN","FHMMNPRT",5,0)
 S PG=0,(EX,XX)="" D NOW^%DTC S Y=X D DD^%DT S FHNDT=Y
"RTN","FHMMNPRT",6,0)
 K FHMNTT
"RTN","FHMMNPRT",7,0)
 ;
"RTN","FHMMNPRT",8,0)
PRINT ;
"RTN","FHMMNPRT",9,0)
 S (MM1,MM2,MM3,MM4,MM5)=0
"RTN","FHMMNPRT",10,0)
 D MNAME
"RTN","FHMMNPRT",11,0)
 Q:XX="*"
"RTN","FHMMNPRT",12,0)
 I FHNXIEN'="ALL" I '$D(^TMP($J,"FHDATA",COMM,FHNXIEN)) D MESSAGE Q
"RTN","FHMMNPRT",13,0)
 I FHNXIEN'="ALL" S ZZ=FHNXIEN D DISP,D1END Q
"RTN","FHMMNPRT",14,0)
 I FHNXIEN="ALL" S ZZ="" F  S ZZ=$O(^TMP($J,"FHDATA",COMM,ZZ)) Q:ZZ=""!(EX=U)  D
"RTN","FHMMNPRT",15,0)
 .D PG
"RTN","FHMMNPRT",16,0)
 .D DISP
"RTN","FHMMNPRT",17,0)
 .S ALLMON=ALLMON+MON
"RTN","FHMMNPRT",18,0)
 .S ALLMON1=ALLMON1+MON
"RTN","FHMMNPRT",19,0)
 .S M1=M1+MON1,M2=M2+MON2,M3=M3+MON3,M4=M4+MON4,M5=M5+MON5
"RTN","FHMMNPRT",20,0)
 .S MM1=MM1+MON1,MM2=MM2+MON2,MM3=MM3+MON3,MM4=MM4+MON4,MM5=MM5+MON5
"RTN","FHMMNPRT",21,0)
 .Q
"RTN","FHMMNPRT",22,0)
 I FHNXIEN'="ALL"!(EX=U) G END Q
"RTN","FHMMNPRT",23,0)
 I ALLMON=0 W !!?5,"NO PATIENTS WITH MONITORS IN GIVEN DATE RANGE" D END Q
"RTN","FHMMNPRT",24,0)
 ;
"RTN","FHMMNPRT",25,0)
 W !!,"** TOTAL COMMUNICATIONS OFFICE - Admissions.....: ",NAME I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",26,0)
 ;
"RTN","FHMMNPRT",27,0)
 W !!?16,"Totals for ALL ",$S(FHSORT="C":"Clinicians.......: ",1:"Wards............: "),$J(ALLMON1,3) I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",28,0)
 ;I ZCO'="Y",ALLMON1=0 G PRINT
"RTN","FHMMNPRT",29,0)
 I ALLMON>0 W !?16,"Monitor: Albumin < 3.2..........: ",$J(MM1,3),"   ",$J(((MM1/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",30,0)
 I ALLMON>0 W !?16,"Monitor: BMI < 21...............: ",$J(MM2,3),"   ",$J(((MM2/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",31,0)
 I ALLMON>0 W !?16,"Monitor: NPO+Clr Liq > 3 days...: ",$J(MM3,3),"   ",$J(((MM3/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",32,0)
 I ALLMON>0 W !?16,"Monitor: On Hyperals............: ",$J(MM4,3),"   ",$J(((MM4/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",33,0)
 I ALLMON>0 W !?16,"Monitor: On Tubefeeding.........: ",$J(MM5,3),"   ",$J(((MM5/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",34,0)
 ;
"RTN","FHMMNPRT",35,0)
 ;
"RTN","FHMMNPRT",36,0)
 S (MM1,MM2,MM3,MM4,MM5,ALLMON1)=0
"RTN","FHMMNPRT",37,0)
 G PRINT Q
"RTN","FHMMNPRT",38,0)
 Q
"RTN","FHMMNPRT",39,0)
 ;
"RTN","FHMMNPRT",40,0)
THEND ;
"RTN","FHMMNPRT",41,0)
 S NAME="ALL COMMUNICATION OFFICES " D PG I EX=U Q
"RTN","FHMMNPRT",42,0)
 W !!,"*** TOTAL PATIENTS WITH MONITORS ALL COMMUNICATION OFFICES....: ",CTCOMM
"RTN","FHMMNPRT",43,0)
 ;
"RTN","FHMMNPRT",44,0)
 W !!?16,"Totals for ALL ",$S(FHSORT="C":"Clinicians.......: ",1:"Wards............: "),$J(ALLMON,3)
"RTN","FHMMNPRT",45,0)
 I ALLMON>0 W !?16,"Monitor: Albumin < 3.2..........: ",$J(M1,3),"   ",$J(((M1/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",46,0)
 I ALLMON>0 W !?16,"Monitor: BMI < 21...............: ",$J(M2,3),"   ",$J(((M2/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",47,0)
 I ALLMON>0 W !?16,"Monitor: NPO+Clr Liq > 3 days...: ",$J(M3,3),"   ",$J(((M3/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",48,0)
 I ALLMON>0 W !?16,"Monitor: On Hyperals............: ",$J(M4,3),"   ",$J(((M4/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",49,0)
 I ALLMON>0 W !?16,"Monitor: On Tubefeeding.........: ",$J(M5,3),"   ",$J(((M5/ALLMON)*100),1,2),"%" I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",50,0)
 ;
"RTN","FHMMNPRT",51,0)
 ;W !!!,"TOTAL ADMISSIONS....:",?23,FHTADM
"RTN","FHMMNPRT",52,0)
 ;W !,"TOTAL MONITORS......:",?23,ALLMON
"RTN","FHMMNPRT",53,0)
 ;I FHTADM>0 W !,"PERCENTAGE..........:",?23,$J(((ALLMON/FHTADM)*100),1,2),"%"
"RTN","FHMMNPRT",54,0)
 D LINE
"RTN","FHMMNPRT",55,0)
 S XX="*"
"RTN","FHMMNPRT",56,0)
 Q
"RTN","FHMMNPRT",57,0)
 ;I $Y>(IOSL-4)
"RTN","FHMMNPRT",58,0)
 ;
"RTN","FHMMNPRT",59,0)
D1END W ! K DIR Q:EX'=U  S DIR(0)="E" D ^DIR  ;I IOST?1"C".E,EX'=U 
"RTN","FHMMNPRT",60,0)
 D END Q
"RTN","FHMMNPRT",61,0)
 Q
"RTN","FHMMNPRT",62,0)
DISP ;
"RTN","FHMMNPRT",63,0)
 S (TOT,MON,MON1,MON2,MON3,MON4,MON5)=0
"RTN","FHMMNPRT",64,0)
 F YY=0:0 S YY=$O(^TMP($J,"FHDATA",COMM,ZZ,YY)) Q:YY'>0  D
"RTN","FHMMNPRT",65,0)
DISP2 .F HH=0:0 S HH=$O(^TMP($J,"FHDATA",COMM,ZZ,YY,HH)) Q:HH'>0!(EX=U)  D
"RTN","FHMMNPRT",66,0)
 ..I $Y>(IOSL-4) I EX=U Q  W ! D HDR
"RTN","FHMMNPRT",67,0)
 ..S CTCOMM=CTCOMM+1
"RTN","FHMMNPRT",68,0)
 ..S DFN=$P(^TMP($J,"FHDATA",COMM,ZZ,YY,HH),U,5)
"RTN","FHMMNPRT",69,0)
 ..S Y=YY X ^DD("DD") W !,Y
"RTN","FHMMNPRT",70,0)
 ..W ?13,$P(^TMP($J,"FHDATA",COMM,ZZ,YY,HH),U,2)
"RTN","FHMMNPRT",71,0)
 ..W ?39,$P(^TMP($J,"FHDATA",COMM,ZZ,YY,HH),U,3)
"RTN","FHMMNPRT",72,0)
 ..W ?47,$P(^TMP($J,"FHDATA",COMM,ZZ,YY,HH),U,6)
"RTN","FHMMNPRT",73,0)
 ..I $P(^TMP($J,"FHDATA",COMM,ZZ,YY,HH),U,7)="Yes"  D
"RTN","FHMMNPRT",74,0)
 ...F NUM=0:0 S NUM=$O(FHMON(DFN,HH,NUM)) Q:NUM'>0!(EX=U)  D
"RTN","FHMMNPRT",75,0)
 ....I NUM'=1 W !
"RTN","FHMMNPRT",76,0)
 ....S MON=MON+1,MONTYP=$P($P(FHMON(DFN,HH,NUM),U,1),": ",2)
"RTN","FHMMNPRT",77,0)
 ....S PC=$S(MONTYP["Albumin":1,MONTYP["BMI":2,MONTYP["NPO+Clr":3,MONTYP["Hyper":4,1:5)
"RTN","FHMMNPRT",78,0)
 ....I $G(FHMNTT(COMM,ZZ))="" S FHMNTT(COMM,ZZ)=""
"RTN","FHMMNPRT",79,0)
 ....S $P(FHMNTT(COMM,ZZ),U,PC)=$P(FHMNTT(COMM,ZZ),U,PC)+1
"RTN","FHMMNPRT",80,0)
 ....W ?56,MONTYP I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",81,0)
 ....Q
"RTN","FHMMNPRT",82,0)
 ...Q
"RTN","FHMMNPRT",83,0)
 ..S TOT=TOT+1
"RTN","FHMMNPRT",84,0)
 ..Q
"RTN","FHMMNPRT",85,0)
 .Q
"RTN","FHMMNPRT",86,0)
 I MON=0!(EX=U) Q
"RTN","FHMMNPRT",87,0)
 I FHSORT="C" W !!,"*  CLINICIAN: ",ZZ
"RTN","FHMMNPRT",88,0)
 I FHSORT="W" W !!,"*  WARD: ",ZZ
"RTN","FHMMNPRT",89,0)
 W !?16,"Total Number of Monitors........: ",$J(MON,3) I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",90,0)
 S PCE=$P(FHMNTT(COMM,ZZ),U,1) I PCE>0 W !?16,"Monitor: Albumin < 3.2..........: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON1=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",91,0)
 S PCE=$P(FHMNTT(COMM,ZZ),U,2) I PCE>0 W !?16,"Monitor: BMI < 21...............: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON2=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",92,0)
 S PCE=$P(FHMNTT(COMM,ZZ),U,3) I PCE>0 W !?16,"Monitor: NPO+Clr Liq > 3 days...: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON3=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",93,0)
 S PCE=$P(FHMNTT(COMM,ZZ),U,4) I PCE>0 W !?16,"Monitor: On Hyperals............: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON4=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMMNPRT",94,0)
 S PCE=$P(FHMNTT(COMM,ZZ),U,5) I PCE>0 W !?16,"Monitor: On Tubefeeding.........: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON5=PCE
"RTN","FHMMNPRT",95,0)
 W !
"RTN","FHMMNPRT",96,0)
 Q
"RTN","FHMMNPRT",97,0)
 ;
"RTN","FHMMNPRT",98,0)
MESSAGE ;
"RTN","FHMMNPRT",99,0)
 W !!?5,"NO PATIENTS WITH MONITORS IN GIVEN DATE RANGE"
"RTN","FHMMNPRT",100,0)
 W !?10,"FOR THIS ",$S(FHSORT="C":"CLINICIAN",1:"WARD"),": ",FHNXIEN
"RTN","FHMMNPRT",101,0)
 Q
"RTN","FHMMNPRT",102,0)
END K FHMNTT,HH,M1,M2,M3,M4,M5,MON,MON1,MON2,MON3,MON4,MON5,MONTYP
"RTN","FHMMNPRT",103,0)
 K NUM,PC,PCE,PG,PER,TOT,YY
"RTN","FHMMNPRT",104,0)
 QUIT
"RTN","FHMMNPRT",105,0)
 Q
"RTN","FHMMNPRT",106,0)
 ;
"RTN","FHMMNPRT",107,0)
PG ;
"RTN","FHMMNPRT",108,0)
 I IOST?1"C".E  W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","FHMMNPRT",109,0)
 D HDR Q
"RTN","FHMMNPRT",110,0)
 Q
"RTN","FHMMNPRT",111,0)
HDR ;Header
"RTN","FHMMNPRT",112,0)
 W:$Y @IOF W !,FHNDT,?60,"Page: " S PG=PG+1 W PG,!
"RTN","FHMMNPRT",113,0)
 W !,?25,"Nutrition Monitor Statistic Report"
"RTN","FHMMNPRT",114,0)
 W !,NAME,!
"RTN","FHMMNPRT",115,0)
 W "Admission",?13,"Patient",?39,"SSN",?45,"Status",?56,"Monitor(s)"
"RTN","FHMMNPRT",116,0)
LINE W ! F Z=1:1:79 W "="
"RTN","FHMMNPRT",117,0)
 Q
"RTN","FHMMNPRT",118,0)
MNAME ;
"RTN","FHMMNPRT",119,0)
 I ZCO'="Y" S CONUMX=CONUMX-1 G:CONUMX<1 THEND  S COXX=$P(CO,"^",CONUMX),NAME=$P(CONAME,"^",CONUMX) S COMM=COXX Q
"RTN","FHMMNPRT",120,0)
 I ZCO="Y" S COUNT=COUNT+1 G:COUNT>ZOUT THEND  S NAME=$G(^FH(119.73,COUNT,0)),NAME=$P(NAME,"^") S COMM=COUNT
"RTN","FHMMNPRT",121,0)
 I $D(^FH(119.73,COUNT,"I"))!'$D(^FH(119.73,COUNT,0)) G MNAME
"RTN","FHMMNPRT",122,0)
 Q
"RTN","FHMMNPRT",123,0)
QUIT ;
"RTN","FHMMNPRT",124,0)
 W !
"RTN","FHMMNPRT",125,0)
 Q
"RTN","FHMMNREP")
0^25^B19403047
"RTN","FHMMNREP",1,0)
FHMMNREP ;Hines OIFO/RTK,AAC - Multidiv Monitor Report ;10/10/03  11:49
"RTN","FHMMNREP",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHMMNREP",3,0)
 ;
"RTN","FHMMNREP",4,0)
COM ;Get Communication Offices
"RTN","FHMMNREP",5,0)
 S (ZCO,CO,COXX,CONAME,CONAM,WARD,FHCOMM)="",(ZCOMM,CONUMX,ALLCOMM)=0
"RTN","FHMMNREP",6,0)
 ;S ZZOUT=$G(^FH(119.73,0)),ZOUT=$P(ZZOUT,"^",4)
"RTN","FHMMNREP",7,0)
 S ZZCOUNT=0 F ZZCOUNT=0:0 S ZZCOUNT=$O(^FH(119.73,ZZCOUNT)) Q:ZZCOUNT'>0  S ZOUT=ZZCOUNT
"RTN","FHMMNREP",8,0)
 R !!,"Print report for all Communications Offices Y or N: ",ZCO:DTIME W ! S ZCO=$TR(ZCO,"y","Y")
"RTN","FHMMNREP",9,0)
 Q:ZCO="^"
"RTN","FHMMNREP",10,0)
 I ZCO'="Y" D N2 I (Y=-1)&(CO="") Q
"RTN","FHMMNREP",11,0)
 ;
"RTN","FHMMNREP",12,0)
DATE ;sets date
"RTN","FHMMNREP",13,0)
 S (FHTADM,FHTMON)=0
"RTN","FHMMNREP",14,0)
 W ! S %DT="AEPT",%DT("A")="Enter beginning date: " D ^%DT Q:Y<0
"RTN","FHMMNREP",15,0)
 S FHSDT=Y,%DT(0)=FHSDT,%DT("A")="Enter ending date: " D ^%DT K %DT(0)
"RTN","FHMMNREP",16,0)
 S FHEDT=Y I Y<0 D END Q
"RTN","FHMMNREP",17,0)
 D SORTCR S FHSORT=Y I Y="^" D END Q
"RTN","FHMMNREP",18,0)
 I FHSORT="C" D FHCL Q:'$D(FHCLIEN)  S FHNXIEN=CLNAM
"RTN","FHMMNREP",19,0)
 I FHSORT="W" D FHWA Q:'$D(FHWRIEN)  S FHNXIEN=WRDNAM
"RTN","FHMMNREP",20,0)
 D DEV,END Q
"RTN","FHMMNREP",21,0)
 ;
"RTN","FHMMNREP",22,0)
FHCL ;
"RTN","FHMMNREP",23,0)
 K DIR S DIR(0)="Y",DIR("A")="Select ALL Clinicians",DIR("B")="Y" D ^DIR
"RTN","FHMMNREP",24,0)
 I Y=1 S (FHCLIEN,CLNAM)="ALL"
"RTN","FHMMNREP",25,0)
 I Y=0 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " D ^DIC S FHCLIEN=$P(Y,U,1),CLNAM=$P($G(^VA(200,FHCLIEN,0)),U,1)
"RTN","FHMMNREP",26,0)
 I (Y=-1)!($D(DUOUT))!($D(DTOUT)) D END Q
"RTN","FHMMNREP",27,0)
 Q
"RTN","FHMMNREP",28,0)
FHWA ;
"RTN","FHMMNREP",29,0)
 K DIR S DIR(0)="Y",DIR("A")="Select ALL Wards",DIR("B")="Y" D ^DIR
"RTN","FHMMNREP",30,0)
 I Y=1 S (FHWRIEN,WRDNAM)="ALL"
"RTN","FHMMNREP",31,0)
 I Y=0 K DIC S DIC="^FH(119.6,",DIC(0)="AEQM" D ^DIC S FHWRIEN=$P(Y,U,1),WRDNAM=$P($G(^FH(119.6,FHWRIEN,0)),U,1)
"RTN","FHMMNREP",32,0)
 I (Y=-1)!($D(DUOUT))!($D(DTOUT)) D END Q
"RTN","FHMMNREP",33,0)
 Q
"RTN","FHMMNREP",34,0)
EN ;
"RTN","FHMMNREP",35,0)
 ;^TMP($J,"FHDATA") SUBSCRIPTS (CLINIC OR WARD NAME,DGPM DATE,DGPM ENTRY)
"RTN","FHMMNREP",36,0)
 ;^TMP($J,"FHDATA") PIECES="PatName^SSN^Monitors?^DischargeDt^DFN^Status"
"RTN","FHMMNREP",37,0)
 ;
"RTN","FHMMNREP",38,0)
 K ^TMP($J,"FHDATA"),FHMON
"RTN","FHMMNREP",39,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT1",I)) Q:'I!(I>FHEDT)  D
"RTN","FHMMNREP",40,0)
 .S J=0 F  S J=$O(^DGPM("ATT1",I,J)) Q:'J  D
"RTN","FHMMNREP",41,0)
 ..S ZCOMM=ZCOMM+1
"RTN","FHMMNREP",42,0)
 ..S DFN=$P($G(^DGPM(J,0)),U,3) I '$D(^FHPT(DFN,"A",J,"MO","B")) Q
"RTN","FHMMNREP",43,0)
 ..S II=$P(I,".")
"RTN","FHMMNREP",44,0)
 ..S FHWARD=$P($G(^DGPM(J,0)),U,6)
"RTN","FHMMNREP",45,0)
 ..Q:'$D(^FH(119.6,"AW",FHWARD))
"RTN","FHMMNREP",46,0)
 ..S WRD=$O(^FH(119.6,"AW",FHWARD,""))
"RTN","FHMMNREP",47,0)
 ..S FHCOMM=$P($G(^FH(119.6,WRD,0)),"^",8),CLN=$P($G(^FH(119.6,WRD,0)),"^",2)
"RTN","FHMMNREP",48,0)
 ..Q:FHCOMM=""  Q:$D(^FH(119.73,FHCOMM,"I"))
"RTN","FHMMNREP",49,0)
 ..S FHTADM=FHTADM+1
"RTN","FHMMNREP",50,0)
 ..S ALLCOMM=ALLCOMM+1
"RTN","FHMMNREP",51,0)
 ..;S CLN=$P($G(^DGPM(J,0)),U,19),WRD=$P($G(^DGPM(J,0)),U,6)
"RTN","FHMMNREP",52,0)
 ..S INDX=$S(FHSORT="C":CLN,1:WRD) I INDX="" Q
"RTN","FHMMNREP",53,0)
 ..S INDX=$S(FHSORT="C":$P($G(^VA(200,CLN,0)),U,1),1:$P($G(^FH(119.6,WRD,0)),U,1))
"RTN","FHMMNREP",54,0)
 ..S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,1)=FHCOMM
"RTN","FHMMNREP",55,0)
 ..S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,2)=$E($P($G(^DPT(DFN,0)),U,1),1,23)
"RTN","FHMMNREP",56,0)
 ..S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,5)=DFN
"RTN","FHMMNREP",57,0)
 ..S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,3)=$E($P($G(^DPT(DFN,0)),U,9),6,9)
"RTN","FHMMNREP",58,0)
 ..I $D(^FHPT(DFN,"A",J,"MO","B")) S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,7)="Yes",FHTMON=FHTMON+1,MCNT=0  D
"RTN","FHMMNREP",59,0)
 ...F FHMN=0:0 S FHMN=$O(^FHPT(DFN,"A",J,"MO",FHMN)) Q:FHMN'>0  S MCNT=MCNT+1,FHMON(DFN,J,MCNT)=$P($G(^FHPT(DFN,"A",J,"MO",FHMN,0)),"^",1)
"RTN","FHMMNREP",60,0)
 ..S Y=$P($P($G(^FHPT(DFN,"A",J,0)),U,14),".",1) I Y X ^DD("DD") S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,4)=Y
"RTN","FHMMNREP",61,0)
 ..I $D(^FHPT(DFN,"S",0)) S NS=$O(^FHPT(DFN,"S",0)),STAT=$P($G(^FHPT(DFN,"S",NS,0)),U,2) S $P(^TMP($J,"FHDATA",FHCOMM,INDX,II,J),U,6)=$P($G(^FH(115.4,STAT,0)),U,1)
"RTN","FHMMNREP",62,0)
 ..Q
"RTN","FHMMNREP",63,0)
 .Q
"RTN","FHMMNREP",64,0)
 D ^FHMMNPRT
"RTN","FHMMNREP",65,0)
 Q
"RTN","FHMMNREP",66,0)
 ;
"RTN","FHMMNREP",67,0)
THEND ;Q
"RTN","FHMMNREP",68,0)
 ;
"RTN","FHMMNREP",69,0)
DEV ;get device and set up queue
"RTN","FHMMNREP",70,0)
 W ! K %ZIS,IOP S %ZIS="Q" D ^%ZIS Q:POP
"RTN","FHMMNREP",71,0)
 I '$D(IO("Q")) U IO D EN,^%ZISC,END Q
"RTN","FHMMNREP",72,0)
 S ZTRTN="EN^FHMMNREP",ZTSAVE("FHSDT")="",ZTSAVE("FHEDT")="",ZTSAVE("ZCOMM")=""
"RTN","FHMMNREP",73,0)
 S ZTSAVE("FHNDT")="",ZTSAVE("FHPER")="",ZTSAVE("FHSORT")=""
"RTN","FHMMNREP",74,0)
 S ZTSAVE("FHNXIEN")="",ZTSAVE("FHTADM")="",ZTSAVE("FHTMON")=""
"RTN","FHMMNREP",75,0)
 S ZTSAVE("ALLCOMM")="",ZTSAVE("ZCO")="",ZTSAVE("COXX")="",ZTSAVE("ZOUT")=""
"RTN","FHMMNREP",76,0)
 S ZTSAVE("CONUMX")="",ZTSAVE("CO")="",ZTSAVE("CONAME")=""
"RTN","FHMMNREP",77,0)
 S ZTDESC="Dietetics Monitor Report" D ^%ZTLOAD
"RTN","FHMMNREP",78,0)
 D ^%ZISC K %ZIS,IOP
"RTN","FHMMNREP",79,0)
 D END Q
"RTN","FHMMNREP",80,0)
 ;
"RTN","FHMMNREP",81,0)
N2 ;Find Communication Office
"RTN","FHMMNREP",82,0)
 S DIC=119.73,DIC(0)="AEQ",DIC("A")="Select Communication Offices: "
"RTN","FHMMNREP",83,0)
 D ^DIC I Y=-1&(CO="") Q
"RTN","FHMMNREP",84,0)
 I Y=-1 Q
"RTN","FHMMNREP",85,0)
 S CON=$P(Y,"^",1),CO=CON_"^"_CO,CONAM=$P(Y,"^",2),CONAME=CONAM_"^"_CONAME S CONUMX=$L(CO,"^") G N2
"RTN","FHMMNREP",86,0)
 I Y=-1 K DIC Q
"RTN","FHMMNREP",87,0)
 Q
"RTN","FHMMNREP",88,0)
 ;
"RTN","FHMMNREP",89,0)
SORTCR ;
"RTN","FHMMNREP",90,0)
 K DIR S DIR(0)="SB^C:CLINICIAN;W:WARD",DIR("A")="Sort by Clinician/Ward"
"RTN","FHMMNREP",91,0)
 D ^DIR
"RTN","FHMMNREP",92,0)
 Q
"RTN","FHMMNREP",93,0)
END ;kill and quit
"RTN","FHMMNREP",94,0)
 K CLN,CLNAM,DFN,I,II,INDX,J,SSN,MCNT
"RTN","FHMMNREP",95,0)
 K FHCLIEN,FHEDT,FHMN,FHNDT,FHNXIEN,FHTADM,FHTMON
"RTN","FHMMNREP",96,0)
 K FHPER,FHSDT,FHSORT,FHWRIEN,WRD,WRDNAM,X,Y,Z
"RTN","FHMMNREP",97,0)
 Q
"RTN","FHMNADM")
0^26^B9206960
"RTN","FHMNADM",1,0)
FHMNADM ;Hines OIFO/JT,RTK - Dietetics Adm/Disc Monitor Report ;06/12/02  10:34
"RTN","FHMNADM",2,0)
 ;;5.0;Dietetics;**37,39,40**;Oct 11, 1995
"RTN","FHMNADM",3,0)
 ;
"RTN","FHMNADM",4,0)
DATE ;sets date
"RTN","FHMNADM",5,0)
 ;
"RTN","FHMNADM",6,0)
 ; Check for multidivisional site
"RTN","FHMNADM",7,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D ^FHMMNADM Q
"RTN","FHMNADM",8,0)
 K %DT(0) S %DT="AEPT",%DT("A")="Enter beginning date: " D ^%DT Q:Y<0
"RTN","FHMNADM",9,0)
 S FHSDT=Y,%DT(0)=FHSDT,%DT("A")="Enter ending date: " D ^%DT Q:Y<0
"RTN","FHMNADM",10,0)
 S FHEDT=Y
"RTN","FHMNADM",11,0)
 S DIR(0)="SA^A:Admissions;D:Discharges"
"RTN","FHMNADM",12,0)
 S DIR("A")="Select type of movement for this report: " D ^DIR
"RTN","FHMNADM",13,0)
 Q:Y["^"!(Y="")  S TYP=Y
"RTN","FHMNADM",14,0)
 G DEV
"RTN","FHMNADM",15,0)
 ;
"RTN","FHMNADM",16,0)
EN ;get admission/monitor information
"RTN","FHMNADM",17,0)
 S PG=0,EX="",Y=DT X ^DD("DD") S FHNDT=Y D HDR
"RTN","FHMNADM",18,0)
 S MVTOT=0,MONTOT=0
"RTN","FHMNADM",19,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT1",I)) Q:'I!(I>FHEDT)!(EX=U)  D
"RTN","FHMNADM",20,0)
 .S J=0 F  S J=$O(^DGPM("ATT1",I,J)) Q:'J!(EX=U)  D
"RTN","FHMNADM",21,0)
 ..S ADM=J,ADMD=I D WRT Q
"RTN","FHMNADM",22,0)
 .Q
"RTN","FHMNADM",23,0)
 D END Q
"RTN","FHMNADM",24,0)
 ;
"RTN","FHMNADM",25,0)
WRT ;write info
"RTN","FHMNADM",26,0)
 ; 
"RTN","FHMNADM",27,0)
 S DFN=$P(^DGPM(J,0),U,3) I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNADM",28,0)
 S Y=$P(ADMD,".") X ^DD("DD") W !,Y,?13,$E($P(^DPT(DFN,0),U,1),U,23)
"RTN","FHMNADM",29,0)
 W ?39,$E($P(^(0),U,9),6,9) S MVTOT=MVTOT+1
"RTN","FHMNADM",30,0)
 I $D(^FHPT(DFN,"A",ADM,"MO"))>9 W ?48,"Yes" S MONTOT=MONTOT+1
"RTN","FHMNADM",31,0)
 S Y=$P($P($G(^FHPT(DFN,"A",ADM,0)),U,14),".",1) I Y X ^DD("DD") W ?56,Y
"RTN","FHMNADM",32,0)
 Q
"RTN","FHMNADM",33,0)
 ;
"RTN","FHMNADM",34,0)
EN1 ;discharges
"RTN","FHMNADM",35,0)
 S PG=0,EX="",Y=DT X ^DD("DD") S FHNDT=Y D HDR
"RTN","FHMNADM",36,0)
 S MVTOT=0,MONTOT=0
"RTN","FHMNADM",37,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT3",I)) Q:'I!(I>FHEDT)!(EX=U)  D
"RTN","FHMNADM",38,0)
 .S J=0 F  S J=$O(^DGPM("ATT3",I,J)) Q:'J!(EX=U)  D
"RTN","FHMNADM",39,0)
 ..S ADM=$P(^DGPM(J,0),U,14)
"RTN","FHMNADM",40,0)
 ..S ADMD=$P(^DGPM(ADM,0),U,1) D WRT Q
"RTN","FHMNADM",41,0)
 .Q
"RTN","FHMNADM",42,0)
 ;
"RTN","FHMNADM",43,0)
END ;end/kill/quit
"RTN","FHMNADM",44,0)
 ; 
"RTN","FHMNADM",45,0)
 I EX=U D KL Q
"RTN","FHMNADM",46,0)
 W !!,"TOTAL "_$S(TYP="A":"ADMISSIONS",TYP="D":"DISCHARGES")_": ",?22,MVTOT
"RTN","FHMNADM",47,0)
 W !,"TOTAL WITH MONITORS:",?22,MONTOT
"RTN","FHMNADM",48,0)
 S FHPER=0 I MONTOT>0,MVTOT>0 S FHPER=(MONTOT/MVTOT)*100
"RTN","FHMNADM",49,0)
 I $L($P(FHPER,".",2))>2 S FHPER=$P(FHPER,".",1)_"."_$E($P(FHPER,".",2),1,2)
"RTN","FHMNADM",50,0)
 W !,"Percentage of "
"RTN","FHMNADM",51,0)
 W $S(TYP="A":"Admissions",TYP="D":"Discharges")
"RTN","FHMNADM",52,0)
 W " with Monitors: ",FHPER,"%"
"RTN","FHMNADM",53,0)
KL K I,J,DFN,SSN,MVTOT,MONTOT,FHPER,FHSDT,FHEDT,X,Y,PG,FHNDT,ADM
"RTN","FHMNADM",54,0)
 K TAG,TYP,DIR,%DT,ADDT Q
"RTN","FHMNADM",55,0)
 ;
"RTN","FHMNADM",56,0)
DEV ;get device and set up queue
"RTN","FHMNADM",57,0)
 S TAG=$S(TYP="A":"EN",TYP="D":"EN1")
"RTN","FHMNADM",58,0)
 K %ZIS,IOP S %ZIS="Q" D ^%ZIS Q:POP
"RTN","FHMNADM",59,0)
 I '$D(IO("Q")) U IO D @TAG,^%ZISC Q
"RTN","FHMNADM",60,0)
 S ZTRTN=TAG_"^FHMNADM",ZTSAVE("FHSDT")="",ZTSAVE("FHEDT")=""
"RTN","FHMNADM",61,0)
 S ZTSAVE("TYP")="",ZTDESC="Dietetics Monitor Report" D ^%ZTLOAD
"RTN","FHMNADM",62,0)
 W !,"Task #",ZTSK
"RTN","FHMNADM",63,0)
 D ^%ZISC K %ZIS,IOP,FHSDT,FHEDT Q
"RTN","FHMNADM",64,0)
PG ;
"RTN","FHMNADM",65,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","FHMNADM",66,0)
 D HDR Q
"RTN","FHMNADM",67,0)
HDR ;Header
"RTN","FHMNADM",68,0)
 ;
"RTN","FHMNADM",69,0)
 W:$Y @IOF
"RTN","FHMNADM",70,0)
 W !,"DIETETIC MONITOR REPORT (Monitoring "
"RTN","FHMNADM",71,0)
 W $S(TYP="A":"Admissions",TYP="D":"Discharges")_")"
"RTN","FHMNADM",72,0)
 W !,FHNDT,?60,"Page: " S PG=PG+1 W PG,!!
"RTN","FHMNADM",73,0)
 W "Admission",?13,"Patient",?39,"SSN",?45,"Monitor?",?56,"Discharge"
"RTN","FHMNADM",74,0)
 W ! F Z=1:1:79 W "="
"RTN","FHMNADM",75,0)
 Q
"RTN","FHMNBRPT")
0^27^B5403322
"RTN","FHMNBRPT",1,0)
FHMNBRPT ;Hines OIFO/JT,RTK - Dietetics Monitor Brief ;07/26/01  11:49
"RTN","FHMNBRPT",2,0)
 ;;5.0;Dietetics;**36,39,40**;Oct 11, 1995
"RTN","FHMNBRPT",3,0)
 ;
"RTN","FHMNBRPT",4,0)
DATE ;sets date
"RTN","FHMNBRPT",5,0)
 ; Check for multidivisional site
"RTN","FHMNBRPT",6,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D ^FHMMBRPT Q
"RTN","FHMNBRPT",7,0)
 W ! S %DT="AEPT",%DT("A")="Enter beginning date: " D ^%DT Q:Y<0
"RTN","FHMNBRPT",8,0)
 S FHSDT=Y,%DT(0)=FHSDT,%DT("A")="Enter ending date: " D ^%DT K %DT(0)
"RTN","FHMNBRPT",9,0)
 I Y<0 D END Q
"RTN","FHMNBRPT",10,0)
 S FHEDT=Y D DEV
"RTN","FHMNBRPT",11,0)
 D END Q
"RTN","FHMNBRPT",12,0)
 ;
"RTN","FHMNBRPT",13,0)
EN ;get admission/monitor information
"RTN","FHMNBRPT",14,0)
 S PG=0,EX="" D NOW^%DTC S Y=X D DD^%DT S FHNDT=Y D HDR
"RTN","FHMNBRPT",15,0)
 S ADMTOT=0,MONTOT=0
"RTN","FHMNBRPT",16,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT1",I)) Q:'I!(I>FHEDT)  D
"RTN","FHMNBRPT",17,0)
 .S J=0 F  S J=$O(^DGPM("ATT1",I,J)) Q:'J!(EX=U)  D
"RTN","FHMNBRPT",18,0)
 ..S DFN=$P(^DGPM(J,0),U,3) I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNBRPT",19,0)
 ..S Y=$P(I,".") X ^DD("DD") W !,Y,?13,$E($P(^DPT(DFN,0),U,1),1,23)
"RTN","FHMNBRPT",20,0)
 ..W ?39,$E($P(^DPT(DFN,0),U,9),6,9) S ADMTOT=ADMTOT+1
"RTN","FHMNBRPT",21,0)
 ..I $D(^FHPT(DFN,"A",J,"MO","B")) W ?48,"Yes" S MONTOT=MONTOT+1
"RTN","FHMNBRPT",22,0)
 ..S Y=$P($P($G(^FHPT(DFN,"A",J,0)),U,14),".",1) I Y X ^DD("DD") W ?56,Y
"RTN","FHMNBRPT",23,0)
 ..Q
"RTN","FHMNBRPT",24,0)
 .Q
"RTN","FHMNBRPT",25,0)
 I EX=U D END Q
"RTN","FHMNBRPT",26,0)
 W !!,"TOTAL ADMISSIONS: ",?22,ADMTOT
"RTN","FHMNBRPT",27,0)
 W !,"TOTAL WITH MONITORS:",?22,MONTOT
"RTN","FHMNBRPT",28,0)
 W !,"Percentage of Admissions with Monitors: "
"RTN","FHMNBRPT",29,0)
 I ADMTOT=0!(MONTOT=0) W "0.0%" D END Q
"RTN","FHMNBRPT",30,0)
 S FHPER=(MONTOT/ADMTOT)*100
"RTN","FHMNBRPT",31,0)
 I $L($P(FHPER,".",2))>2 S FHPER=$P(FHPER,".",1)_"."_$E($P(FHPER,".",2),1,2)
"RTN","FHMNBRPT",32,0)
 W FHPER,"%"
"RTN","FHMNBRPT",33,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR
"RTN","FHMNBRPT",34,0)
 D END Q
"RTN","FHMNBRPT",35,0)
DEV ;get device and set up queue
"RTN","FHMNBRPT",36,0)
 W ! K %ZIS,IOP S %ZIS="Q" D ^%ZIS Q:POP
"RTN","FHMNBRPT",37,0)
 I '$D(IO("Q")) U IO D EN,^%ZISC,END Q
"RTN","FHMNBRPT",38,0)
 S ZTRTN="EN^FHMNBRPT",ZTSAVE("FHSDT")="",ZTSAVE("FHEDT")=""
"RTN","FHMNBRPT",39,0)
 S ZTSAVE=("FHNDT"),ZTSAVE=("FHPER")
"RTN","FHMNBRPT",40,0)
 S ZTDESC="Dietetics Monitor Report" D ^%ZTLOAD
"RTN","FHMNBRPT",41,0)
 D ^%ZISC K %ZIS,IOP
"RTN","FHMNBRPT",42,0)
 D END Q
"RTN","FHMNBRPT",43,0)
END ;kill and quit
"RTN","FHMNBRPT",44,0)
 K I,J,DFN,SSN,ADMTOT,MONTOT,FHPER,FHSDT,FHEDT,FHNDT,X,Y,PG
"RTN","FHMNBRPT",45,0)
 Q
"RTN","FHMNBRPT",46,0)
PG ;
"RTN","FHMNBRPT",47,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","FHMNBRPT",48,0)
 D HDR Q
"RTN","FHMNBRPT",49,0)
HDR ;Header
"RTN","FHMNBRPT",50,0)
 W:$Y @IOF W !,FHNDT,?60,"Page: " S PG=PG+1 W PG,!!
"RTN","FHMNBRPT",51,0)
 W "Admission",?13,"Patient",?39,"SSN",?45,"Monitor?",?56,"Discharge"
"RTN","FHMNBRPT",52,0)
 W ! F Z=1:1:79 W "="
"RTN","FHMNBRPT",53,0)
 Q
"RTN","FHMNPRT")
0^28^B16366448
"RTN","FHMNPRT",1,0)
FHMNPRT ;Hines OIFO/RTK - Dietetics Monitor Report Print ;10/23/01  10:29
"RTN","FHMNPRT",2,0)
 ;;5.0;Dietetics;**34,35,36,39,40**;Oct 11, 1995
"RTN","FHMNPRT",3,0)
 ;
"RTN","FHMNPRT",4,0)
PRINT ;
"RTN","FHMNPRT",5,0)
 K FHMNTT S PG=0,EX="" D NOW^%DTC S Y=X D DD^%DT S FHNDT=Y D HDR
"RTN","FHMNPRT",6,0)
 S (ALLMON,M1,M2,M3,M4,M5)=0
"RTN","FHMNPRT",7,0)
 I FHNXIEN'="ALL",'$D(FHDATA(FHNXIEN)) D MESSAGE Q
"RTN","FHMNPRT",8,0)
 I FHNXIEN'="ALL" S ZZ=FHNXIEN D DISP,D1END Q
"RTN","FHMNPRT",9,0)
 I FHNXIEN="ALL" S ZZ="" F  S ZZ=$O(FHDATA(ZZ)) Q:ZZ=""!(EX=U)  D
"RTN","FHMNPRT",10,0)
 .D DISP
"RTN","FHMNPRT",11,0)
 .S ALLMON=ALLMON+MON
"RTN","FHMNPRT",12,0)
 .S M1=M1+MON1,M2=M2+MON2,M3=M3+MON3,M4=M4+MON4,M5=M5+MON5
"RTN","FHMNPRT",13,0)
 .Q
"RTN","FHMNPRT",14,0)
 I FHNXIEN'="ALL"!(EX=U) D END Q
"RTN","FHMNPRT",15,0)
 I ALLMON=0 W !!?5,"NO PATIENTS WITH MONITORS IN GIVEN DATE RANGE" D END Q
"RTN","FHMNPRT",16,0)
 W !!?16,"Totals for ALL ",$S(FHSORT="C":"Clinicians.......: ",1:"Wards............: "),$J(ALLMON,3)
"RTN","FHMNPRT",17,0)
 W !?16,"Monitor: Albumin < 3.2..........: ",$J(M1,3),"   ",$J(((M1/ALLMON)*100),1,2),"%"
"RTN","FHMNPRT",18,0)
 W !?16,"Monitor: BMI < 21...............: ",$J(M2,3),"   ",$J(((M2/ALLMON)*100),1,2),"%"
"RTN","FHMNPRT",19,0)
 W !?16,"Monitor: NPO+Clr Liq > 3 days...: ",$J(M3,3),"   ",$J(((M3/ALLMON)*100),1,2),"%"
"RTN","FHMNPRT",20,0)
 W !?16,"Monitor: On Hyperals............: ",$J(M4,3),"   ",$J(((M4/ALLMON)*100),1,2),"%"
"RTN","FHMNPRT",21,0)
 W !?16,"Monitor: On Tubefeeding.........: ",$J(M5,3),"   ",$J(((M5/ALLMON)*100),1,2),"%"
"RTN","FHMNPRT",22,0)
 I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",23,0)
 W !!!,"TOTAL ADMISSIONS....:",?23,FHTADM
"RTN","FHMNPRT",24,0)
 W !,"TOTAL MONITORS......:",?23,ALLMON
"RTN","FHMNPRT",25,0)
 I FHTADM>0 W !,"PERCENTAGE..........:",?23,$J(((ALLMON/FHTADM)*100),1,2),"%"
"RTN","FHMNPRT",26,0)
 ;
"RTN","FHMNPRT",27,0)
D1END I IOST?1"C".E,EX'=U W ! K DIR S DIR(0)="E" D ^DIR
"RTN","FHMNPRT",28,0)
 D END Q
"RTN","FHMNPRT",29,0)
DISP ;
"RTN","FHMNPRT",30,0)
 I FHSORT="C" W !!?25,"CLINICIAN: ",ZZ
"RTN","FHMNPRT",31,0)
 I FHSORT="W" W !!?25,"WARD: ",ZZ
"RTN","FHMNPRT",32,0)
 S (TOT,MON,MON1,MON2,MON3,MON4,MON5)=0
"RTN","FHMNPRT",33,0)
 F YY=0:0 S YY=$O(FHDATA(ZZ,YY)) Q:YY'>0  D
"RTN","FHMNPRT",34,0)
 .F HH=0:0 S HH=$O(FHDATA(ZZ,YY,HH)) Q:HH'>0!(EX=U)  D
"RTN","FHMNPRT",35,0)
 ..I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",36,0)
 ..S DFN=$P(FHDATA(ZZ,YY,HH),U,5)
"RTN","FHMNPRT",37,0)
 ..S Y=YY X ^DD("DD") W !,Y
"RTN","FHMNPRT",38,0)
 ..W ?13,$P(FHDATA(ZZ,YY,HH),U,1)
"RTN","FHMNPRT",39,0)
 ..W ?39,$P(FHDATA(ZZ,YY,HH),U,2)
"RTN","FHMNPRT",40,0)
 ..W ?47,$P(FHDATA(ZZ,YY,HH),U,6)
"RTN","FHMNPRT",41,0)
 ..I $P(FHDATA(ZZ,YY,HH),U,3)="Yes" D
"RTN","FHMNPRT",42,0)
 ...F NUM=0:0 S NUM=$O(FHMON(DFN,HH,NUM)) Q:NUM'>0!(EX=U)  D
"RTN","FHMNPRT",43,0)
 ....I NUM'=1 W !
"RTN","FHMNPRT",44,0)
 ....S MON=MON+1,MONTYP=$P($P(FHMON(DFN,HH,NUM),U,1),": ",2)
"RTN","FHMNPRT",45,0)
 ....S PC=$S(MONTYP["Albumin":1,MONTYP["BMI":2,MONTYP["NPO+Clr":3,MONTYP["Hyper":4,1:5)
"RTN","FHMNPRT",46,0)
 ....I $G(FHMNTT(ZZ))="" S FHMNTT(ZZ)=""
"RTN","FHMNPRT",47,0)
 ....S $P(FHMNTT(ZZ),U,PC)=$P(FHMNTT(ZZ),U,PC)+1
"RTN","FHMNPRT",48,0)
 ....W ?56,MONTYP I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",49,0)
 ....Q
"RTN","FHMNPRT",50,0)
 ...Q
"RTN","FHMNPRT",51,0)
 ..S TOT=TOT+1
"RTN","FHMNPRT",52,0)
 ..Q
"RTN","FHMNPRT",53,0)
 .Q
"RTN","FHMNPRT",54,0)
 I EX=U Q
"RTN","FHMNPRT",55,0)
 W !!?16,"Total Number of Monitors........: ",$J(MON,3) I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",56,0)
 S PCE=$P(FHMNTT(ZZ),U,1) I PCE>0 W !?16,"Monitor: Albumin < 3.2..........: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON1=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",57,0)
 S PCE=$P(FHMNTT(ZZ),U,2) I PCE>0 W !?16,"Monitor: BMI < 21...............: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON2=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",58,0)
 S PCE=$P(FHMNTT(ZZ),U,3) I PCE>0 W !?16,"Monitor: NPO+Clr Liq > 3 days...: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON3=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",59,0)
 S PCE=$P(FHMNTT(ZZ),U,4) I PCE>0 W !?16,"Monitor: On Hyperals............: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON4=PCE I $Y>(IOSL-4) D PG I EX=U Q
"RTN","FHMNPRT",60,0)
 S PCE=$P(FHMNTT(ZZ),U,5) I PCE>0 W !?16,"Monitor: On Tubefeeding.........: ",$J(PCE,3),"   ",$J(((PCE/MON)*100),1,2),"%" S MON5=PCE
"RTN","FHMNPRT",61,0)
 W ! Q
"RTN","FHMNPRT",62,0)
 ;
"RTN","FHMNPRT",63,0)
MESSAGE ;
"RTN","FHMNPRT",64,0)
 W !!?5,"NO PATIENTS WITH MONITORS IN GIVEN DATE RANGE"
"RTN","FHMNPRT",65,0)
 W !?10,"FOR THIS ",$S(FHSORT="C":"CLINICIAN",1:"WARD"),": ",FHNXIEN
"RTN","FHMNPRT",66,0)
 Q
"RTN","FHMNPRT",67,0)
END K FHMNTT,HH,M1,M2,M3,M4,M5,MON,MON1,MON2,MON3,MON4,MON5,MONTYP
"RTN","FHMNPRT",68,0)
 K NUM,PC,PCE,PG,PER,TOT,YY
"RTN","FHMNPRT",69,0)
 Q
"RTN","FHMNPRT",70,0)
PG ;
"RTN","FHMNPRT",71,0)
 I IOST?1"C".E W ! K DIR S DIR(0)="E" D ^DIR I 'Y S EX=U Q
"RTN","FHMNPRT",72,0)
 D HDR Q
"RTN","FHMNPRT",73,0)
HDR ;Header
"RTN","FHMNPRT",74,0)
 W:$Y @IOF W !,FHNDT,?60,"Page: " S PG=PG+1 W PG,!!
"RTN","FHMNPRT",75,0)
 W "Admission",?13,"Patient",?39,"SSN",?45,"Status",?56,"Monitor(s)"
"RTN","FHMNPRT",76,0)
 W ! F Z=1:1:79 W "="
"RTN","FHMNPRT",77,0)
 Q
"RTN","FHMNREP")
0^29^B11954964
"RTN","FHMNREP",1,0)
FHMNREP ;Hines OIFO/RTK - Dietetics Monitor Report ;10/18/01  11:49
"RTN","FHMNREP",2,0)
 ;;5.0;Dietetics;**33,34,35,39,40**;Oct 11, 1995
"RTN","FHMNREP",3,0)
 ;
"RTN","FHMNREP",4,0)
DATE ;sets date
"RTN","FHMNREP",5,0)
 ; Check for multidivisional site
"RTN","FHMNREP",6,0)
 I $P($G(^FH(119.9,1,0)),U,20)'="N" D ^FHMMNREP Q
"RTN","FHMNREP",7,0)
 S (FHTADM,FHTMON)=0
"RTN","FHMNREP",8,0)
 W ! S %DT="AEPT",%DT("A")="Enter beginning date: " D ^%DT Q:Y<0
"RTN","FHMNREP",9,0)
 S FHSDT=Y,%DT(0)=FHSDT,%DT("A")="Enter ending date: " D ^%DT K %DT(0)
"RTN","FHMNREP",10,0)
 S FHEDT=Y I Y<0 D END Q
"RTN","FHMNREP",11,0)
 D SORTCR S FHSORT=Y I Y="^" D END Q
"RTN","FHMNREP",12,0)
 I FHSORT="C" D FHCL Q:'$D(FHCLIEN)  S FHNXIEN=CLNAM
"RTN","FHMNREP",13,0)
 I FHSORT="W" D FHWA Q:'$D(FHWRIEN)  S FHNXIEN=WRDNAM
"RTN","FHMNREP",14,0)
 D DEV,END Q
"RTN","FHMNREP",15,0)
 ;
"RTN","FHMNREP",16,0)
FHCL ;
"RTN","FHMNREP",17,0)
 K DIR S DIR(0)="Y",DIR("A")="Select ALL Clinicians",DIR("B")="Y" D ^DIR
"RTN","FHMNREP",18,0)
 I Y=1 S (FHCLIEN,CLNAM)="ALL"
"RTN","FHMNREP",19,0)
 I Y=0 K DIC S DIC="^VA(200,",DIC(0)="AEQM",DIC("A")="Select CLINICIAN: " D ^DIC S FHCLIEN=$P(Y,U,1),CLNAM=$P($G(^VA(200,FHCLIEN,0)),U,1)
"RTN","FHMNREP",20,0)
 I (Y=-1)!($D(DUOUT))!($D(DTOUT)) D END Q
"RTN","FHMNREP",21,0)
 Q
"RTN","FHMNREP",22,0)
FHWA ;
"RTN","FHMNREP",23,0)
 K DIR S DIR(0)="Y",DIR("A")="Select ALL Wards",DIR("B")="Y" D ^DIR
"RTN","FHMNREP",24,0)
 I Y=1 S (FHWRIEN,WRDNAM)="ALL"
"RTN","FHMNREP",25,0)
 I Y=0 K DIC S DIC="^FH(119.6,",DIC(0)="AEQM" D ^DIC S FHWRIEN=$P(Y,U,1),WRDNAM=$P($G(^FH(119.6,FHWRIEN,0)),U,1)
"RTN","FHMNREP",26,0)
 I (Y=-1)!($D(DUOUT))!($D(DTOUT)) D END Q
"RTN","FHMNREP",27,0)
 Q
"RTN","FHMNREP",28,0)
EN ;
"RTN","FHMNREP",29,0)
 ;FHDATA SUBSCRIPTS(CLINIC OR WARD NAME,DGPM DATE,DGPM ENTRY)
"RTN","FHMNREP",30,0)
 ;FHDATA ARRAY="PatName^SSN^Monitors?^DischargeDt^DFN^Status"
"RTN","FHMNREP",31,0)
 ;
"RTN","FHMNREP",32,0)
 K FHDATA,FHMON
"RTN","FHMNREP",33,0)
 S I=FHSDT F  S I=$O(^DGPM("ATT1",I)) Q:'I!(I>FHEDT)  D
"RTN","FHMNREP",34,0)
 .S J=0 F  S J=$O(^DGPM("ATT1",I,J)) Q:'J  D
"RTN","FHMNREP",35,0)
 ..S FHTADM=FHTADM+1
"RTN","FHMNREP",36,0)
 ..S DFN=$P($G(^DGPM(J,0)),U,3) I '$D(^FHPT(DFN,"A",J,"MO","B")) Q
"RTN","FHMNREP",37,0)
 ..S II=$P(I,".")
"RTN","FHMNREP",38,0)
 ..S WRD=$P($G(^FHPT(DFN,"A",J,0)),U,8),CLN=""
"RTN","FHMNREP",39,0)
 ..I WRD'="" S CLN=$P($G(^FH(119.6,WRD,0)),"^",2)
"RTN","FHMNREP",40,0)
 ..;S CLN=$P($G(^DGPM(J,0)),U,19),WRD=$P($G(^DGPM(J,0)),U,6)
"RTN","FHMNREP",41,0)
 ..S INDX=$S(FHSORT="C":CLN,1:WRD) I INDX="" Q
"RTN","FHMNREP",42,0)
 ..S INDX=$S(FHSORT="C":$P($G(^VA(200,CLN,0)),U,1),1:$P($G(^FH(119.6,WRD,0)),U,1))
"RTN","FHMNREP",43,0)
 ..S $P(FHDATA(INDX,II,J),U,1)=$E($P(^DPT(DFN,0),U,1),1,23)
"RTN","FHMNREP",44,0)
 ..S $P(FHDATA(INDX,II,J),U,5)=DFN
"RTN","FHMNREP",45,0)
 ..S $P(FHDATA(INDX,II,J),U,2)=$E($P(^DPT(DFN,0),U,9),6,9)
"RTN","FHMNREP",46,0)
 ..I $D(^FHPT(DFN,"A",J,"MO","B")) S $P(FHDATA(INDX,II,J),U,3)="Yes",FHTMON=FHTMON+1,MCNT=0 D
"RTN","FHMNREP",47,0)
 ...F FHMN=0:0 S FHMN=$O(^FHPT(DFN,"A",J,"MO",FHMN)) Q:FHMN'>0  S MCNT=MCNT+1,FHMON(DFN,J,MCNT)=$P($G(^FHPT(DFN,"A",J,"MO",FHMN,0)),"^",1)
"RTN","FHMNREP",48,0)
 ..S Y=$P($P($G(^FHPT(DFN,"A",J,0)),U,14),".",1) I Y X ^DD("DD") S $P(FHDATA(INDX,II,J),U,4)=Y
"RTN","FHMNREP",49,0)
 ..I $D(^FHPT(DFN,"S",0)) S NS=$O(^FHPT(DFN,"S",0)),STAT=$P($G(^FHPT(DFN,"S",NS,0)),U,2) S $P(FHDATA(INDX,II,J),U,6)=$P($G(^FH(115.4,STAT,0)),U,1)
"RTN","FHMNREP",50,0)
 ..Q
"RTN","FHMNREP",51,0)
 .Q
"RTN","FHMNREP",52,0)
 D PRINT^FHMNPRT
"RTN","FHMNREP",53,0)
 Q
"RTN","FHMNREP",54,0)
DEV ;get device and set up queue
"RTN","FHMNREP",55,0)
 W ! K %ZIS,IOP S %ZIS="Q" D ^%ZIS Q:POP
"RTN","FHMNREP",56,0)
 I '$D(IO("Q")) U IO D EN,^%ZISC,END Q
"RTN","FHMNREP",57,0)
 S ZTRTN="EN^FHMNREP",ZTSAVE("FHSDT")="",ZTSAVE("FHEDT")=""
"RTN","FHMNREP",58,0)
 S ZTSAVE("FHNDT")="",ZTSAVE("FHPER")="",ZTSAVE("FHSORT")=""
"RTN","FHMNREP",59,0)
 S ZTSAVE("FHNXIEN")="",ZTSAVE("FHTADM")="",ZTSAVE("FHTMON")=""
"RTN","FHMNREP",60,0)
 S ZTDESC="Dietetics Monitor Report" D ^%ZTLOAD
"RTN","FHMNREP",61,0)
 D ^%ZISC K %ZIS,IOP
"RTN","FHMNREP",62,0)
 D END Q
"RTN","FHMNREP",63,0)
SORTCR ;
"RTN","FHMNREP",64,0)
 K DIR S DIR(0)="SB^C:CLINICIAN;W:WARD",DIR("A")="Sort by Clinician/Ward"
"RTN","FHMNREP",65,0)
 D ^DIR
"RTN","FHMNREP",66,0)
 Q
"RTN","FHMNREP",67,0)
END ;kill and quit
"RTN","FHMNREP",68,0)
 K CLN,CLNAM,DFN,I,II,INDX,J,SSN,MCNT
"RTN","FHMNREP",69,0)
 K FHCLIEN,FHEDT,FHMN,FHNDT,FHNXIEN,FHTADM,FHTMON
"RTN","FHMNREP",70,0)
 K FHPER,FHSDT,FHSORT,FHWRIEN,WRD,WRDNAM,X,Y,Z
"RTN","FHMNREP",71,0)
 Q
"RTN","FHORT5D")
0^1^B11710172
"RTN","FHORT5D",1,0)
FHORT5D ; HISC/REL/NCA - Tubefeeding Reports (cont) ;5/4/93  10:52 
"RTN","FHORT5D",2,0)
 ;;5.0;Dietetics;**38,39,40**;Oct 11, 1995
"RTN","FHORT5D",3,0)
CST ; Print Cost Report for Tubefeeding
"RTN","FHORT5D",4,0)
 S NAM="" F  S NAM=$O(^FH(118.2,"B",NAM)) Q:NAM=""  F LL=0:0 S LL=$O(^FH(118.2,"B",NAM,LL)) Q:LL<1  S ^TMP($J,"P",NAM_"~"_LL)=LL
"RTN","FHORT5D",5,0)
 I SUM S CNOD="0" D C2 Q
"RTN","FHORT5D",6,0)
 S CNOD="0" F  S CNOD=$O(^TMP($J,"C",CNOD)) Q:CNOD=""  D C2
"RTN","FHORT5D",7,0)
 Q
"RTN","FHORT5D",8,0)
C2 S D2=0,NAM="" D HD4 S X0=$G(^TMP($J,"C",CNOD,0))
"RTN","FHORT5D",9,0)
 F  S NAM=$O(^TMP($J,"P",NAM)) Q:NAM=""  S LL=^(NAM) I $D(^TMP($J,"C",CNOD,LL)) S X1=$G(^(LL,0)),TU=$P(X1,"^",1),TP=$P(X1,"^",2) D
"RTN","FHORT5D",10,0)
 .I $Y>(IOSL-8) D HD4
"RTN","FHORT5D",11,0)
 .S Y0=^FH(118.2,LL,0),TU=TU+.95\1,PR=$P($G(^FH(114,+$P(Y0,"^",7),0)),"^",13),D2=TU*PR+D2
"RTN","FHORT5D",12,0)
 .W !,$P(Y0,"^",1),?31,$J($S(TP:TP,1:0),5),?41,$P(Y0,"^",2),?53,$J(TU,5),?62,$J(PR,7,2),?72,$J(TU*PR,7,2) Q
"RTN","FHORT5D",13,0)
 W !!,"Total: ",?71,$J(D2,8,2),!!!,"No. of Patients on TF: ",?33,$J($P(X0,"^",1),6)
"RTN","FHORT5D",14,0)
 W !,"No. of Patients on TF and Tray: ",?33,$J($P(X0,"^",2),6),!,"No. of Patients on TF and SF: ",?33,$J($P(X0,"^",3),6)
"RTN","FHORT5D",15,0)
 W !,"No. of Patients on ALL Three: ",?33,$J($P(X0,"^",4),6),!,"Cost/Patient: ",?33 S X=$P(X0,"^",1) W $J($S(X:D2/X,1:""),6,2),! Q
"RTN","FHORT5D",16,0)
LAB ; Print Labels
"RTN","FHORT5D",17,0)
 S LAB=$P($G(^FH(119.9,1,"D",IOS,0)),"^",2) S:'LAB LAB=1 S S1=$S(LAB=1:6,1:9),S2=LAB=2*5+33
"RTN","FHORT5D",18,0)
 S COUNT=0,LINE=1
"RTN","FHORT5D",19,0)
 S TNOD="" F  S TNOD=$O(^TMP($J,"T",TNOD)) Q:TNOD=""  D L1
"RTN","FHORT5D",20,0)
 I LAB>2 D DPLL^FHLABEL Q
"RTN","FHORT5D",21,0)
 W !!!!!!!!!!!!!!!!!! Q
"RTN","FHORT5D",22,0)
L1 S PNOD="" F  S PNOD=$O(^TMP($J,"T",TNOD,PNOD)) Q:PNOD=""  S X0=^(PNOD,0) D L2
"RTN","FHORT5D",23,0)
 Q
"RTN","FHORT5D",24,0)
L2 S NAM=$P(X0,"^",1),WARD=$P(X0,"^",3),RM=$P(X0,"^",4),X3=3
"RTN","FHORT5D",25,0)
 F TF2=0:0 S TF2=$O(^TMP($J,"T",TNOD,PNOD,TF2)) Q:'TF2  S X1=^(TF2,0),X3=X3+3 D L3
"RTN","FHORT5D",26,0)
 Q
"RTN","FHORT5D",27,0)
L3 S Y0=$P(X1,"^",1),STR=$P(X1,"^",7),Y1="" I STR<4 S Y1=$S(STR=1:"1/4",STR=2:"1/2",1:"3/4")_" Str, "
"RTN","FHORT5D",28,0)
 S Y1=Y1_$P(X1,"^",8),Y0=Y0_", "_$S('MUL:$P(X1,"^",6),1:1)_" "_$P(X1,"^",2) I 'MUL,$P(X1,"^",6)>1 S Y0=Y0_"S"
"RTN","FHORT5D",29,0)
 I LAB>2 D LL Q
"RTN","FHORT5D",30,0)
 I 'MUL D LHDR W !,Y0,!,Y1,! W:LAB=2 !!! Q
"RTN","FHORT5D",31,0)
 F X2=1:1:+$P(X1,"^",6) D LHDR W !,Y0,!,Y1,! W:LAB=2 !!!
"RTN","FHORT5D",32,0)
 Q
"RTN","FHORT5D",33,0)
LHDR ; Label Header
"RTN","FHORT5D",34,0)
 W !,NAM,?(S2-$L(WARD)),WARD,!,$P(X0,"^",2),?8,$E(DTP,1,9),?(S2-$L(RM)),RM,! Q
"RTN","FHORT5D",35,0)
HD4 ; Cost Report Header
"RTN","FHORT5D",36,0)
 W:'($E(IOST,1,2)'="C-"&'PG) @IOF S PG=PG+1
"RTN","FHORT5D",37,0)
 W !,$E(DTP,1,9),?17,"T U B E F E E D I N G   C O S T   R E P O R T",?73,"Page ",PG
"RTN","FHORT5D",38,0)
 S Y=$S(SUM:"CONSOLIDATED",1:$P(CNOD,"~",2)) W !!?(80-$L(Y)\2),Y
"RTN","FHORT5D",39,0)
 W !!,"Product",?30,"# Patient",?41,"Unit",?53,"# Units",?62,"Cost/Unit",?74,"Total",! Q
"RTN","FHORT5D",40,0)
 Q
"RTN","FHORT5D",41,0)
LL ;
"RTN","FHORT5D",42,0)
 S FHCOL=$S(LAB=3:3,1:2)
"RTN","FHORT5D",43,0)
 I LABSTART>1 F FHLABST=1:1:(LABSTART-1)*FHCOL D  S LABSTART=1
"RTN","FHORT5D",44,0)
 .I LAB=3 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6)="" D LL3^FHLABEL
"RTN","FHORT5D",45,0)
 .I LAB=4 S (PCL1,PCL2,PCL3,PCL4,PCL5,PCL6,PCL7,PCL8)="" D LL4^FHLABEL
"RTN","FHORT5D",46,0)
 .Q
"RTN","FHORT5D",47,0)
 S FHTAB=$S(LAB=3:24,1:37)
"RTN","FHORT5D",48,0)
 S NAM=$E(NAM,1,FHTAB-$L(WARD)),X02P=$P(X0,U,2),DTP=$E(DTP,1,9)
"RTN","FHORT5D",49,0)
 S X0DTP=X02P_$E("        ",1,7-$L(X02P))_DTP
"RTN","FHORT5D",50,0)
 S LNA=NAM_$J(WARD,FHTAB+1-$L(NAM))
"RTN","FHORT5D",51,0)
 S LNB=X0DTP_$J($E(RM,1,8),FHTAB+1-$L(X0DTP))
"RTN","FHORT5D",52,0)
 I 'MUL D LLB Q
"RTN","FHORT5D",53,0)
 I MUL F X2=1:1:+$P(X1,"^",6) D LLB
"RTN","FHORT5D",54,0)
 Q
"RTN","FHORT5D",55,0)
LLB ;
"RTN","FHORT5D",56,0)
 S FHST=$S(LAB=3:25,1:38)
"RTN","FHORT5D",57,0)
 S FHN=FHST F CN=FHST:-1:FHST-5 S Y0X=$E(Y0,CN) I Y0X="," S FHN=CN Q
"RTN","FHORT5D",58,0)
 I LAB=3 S PCL1="",PCL2=LNA,PCL3=LNB,PCL4=$E(Y0,1,FHN),PCL5=$E(Y0,FHN+1,99),PCL6=Y1
"RTN","FHORT5D",59,0)
 I LAB=4 S (PCL1,PCL2,PCL8)="",PCL3=LNA,PCL4=LNB,PCL5=$E(Y0,1,FHN),PCL6=$E(Y0,FHN+1,99),PCL7=Y1
"RTN","FHORT5D",60,0)
 D:LAB=3 LL3^FHLABEL D:LAB=4 LL4^FHLABEL
"RTN","FHORT5D",61,0)
 Q
"RTN","FHPST40")
0^31^B3317708
"RTN","FHPST40",1,0)
FHPST40 ;Hines OIFO/RTK PATCH 40 POST-INIT ;10/23/03 7:15
"RTN","FHPST40",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHPST40",3,0)
 ;
"RTN","FHPST40",4,0)
 D CONVMS,CONVSD
"RTN","FHPST40",5,0)
 Q
"RTN","FHPST40",6,0)
 ;
"RTN","FHPST40",7,0)
CONVMS ; Convert data in Meals Served (#117) file back to old fields
"RTN","FHPST40",8,0)
 W !,"RESTORING MEALS SERVED DATA..."
"RTN","FHPST40",9,0)
 S STDT=3030901
"RTN","FHPST40",10,0)
 F FHMIEN=STDT:0 S FHMIEN=$O(^FH(117,FHMIEN)) Q:FHMIEN'>0  D
"RTN","FHPST40",11,0)
 .I $D(^FH(117,FHMIEN,1)) Q
"RTN","FHPST40",12,0)
 .I '$D(^FH(117,FHMIEN,2)) Q
"RTN","FHPST40",13,0)
 .S FHMS1="",FHMS0=""
"RTN","FHPST40",14,0)
 .F FHMULT=0:0 S FHMULT=$O(^FH(117,FHMIEN,2,FHMULT)) Q:FHMULT'>0  D
"RTN","FHPST40",15,0)
 ..S FHNODE1=$P($G(^FH(117,FHMIEN,2,FHMULT,0)),U,2,21)
"RTN","FHPST40",16,0)
 ..S FHNODE0=$P($G(^FH(117,FHMIEN,2,FHMULT,1)),U,1,6)
"RTN","FHPST40",17,0)
 ..D COUNTMS
"RTN","FHPST40",18,0)
 ..Q
"RTN","FHPST40",19,0)
 .S FHNODE1=FHMS1,FHNODE0=FHMS0 D SETMS
"RTN","FHPST40",20,0)
 .Q
"RTN","FHPST40",21,0)
 Q
"RTN","FHPST40",22,0)
COUNTMS ;
"RTN","FHPST40",23,0)
 F PCE=1:1:20 S $P(FHMS1,U,PCE)=$P(FHMS1,U,PCE)+$P(FHNODE1,U,PCE)
"RTN","FHPST40",24,0)
 F PCE=1:1:6 S $P(FHMS0,U,PCE)=$P(FHMS0,U,PCE)+$P(FHNODE0,U,PCE)
"RTN","FHPST40",25,0)
 Q
"RTN","FHPST40",26,0)
SETMS ;
"RTN","FHPST40",27,0)
 S ^FH(117,FHMIEN,0)=FHMIEN_"^"_FHNODE0
"RTN","FHPST40",28,0)
 S ^FH(117,FHMIEN,1)=FHNODE1
"RTN","FHPST40",29,0)
 Q
"RTN","FHPST40",30,0)
CONVSD ; Convert data in Staffing Data (#117.1) file back to old fields
"RTN","FHPST40",31,0)
 W !!,"RESTORING STAFFING DATA..."
"RTN","FHPST40",32,0)
 S STDT=3030901
"RTN","FHPST40",33,0)
 F FHSIEN=STDT:0 S FHSIEN=$O(^FH(117.1,FHSIEN)) Q:FHSIEN'>0  D
"RTN","FHPST40",34,0)
 .I $P($G(^FH(117.1,FHSIEN,0)),U,2)'="" Q
"RTN","FHPST40",35,0)
 .I '$D(^FH(117.1,FHSIEN,1)) Q
"RTN","FHPST40",36,0)
 .S FHSD0=""
"RTN","FHPST40",37,0)
 .F FHMULT=0:0 S FHMULT=$O(^FH(117.1,FHSIEN,1,FHMULT)) Q:FHMULT'>0  D
"RTN","FHPST40",38,0)
 ..S FHNODE=$P($G(^FH(117.1,FHSIEN,1,FHMULT,0)),U,2,20)
"RTN","FHPST40",39,0)
 ..F PCE=1:1:19 S $P(FHSD0,U,PCE)=$P(FHSD0,U,PCE)+$P(FHNODE,U,PCE)
"RTN","FHPST40",40,0)
 ..Q
"RTN","FHPST40",41,0)
 .S FHNODE=FHSD0
"RTN","FHPST40",42,0)
 .S ^FH(117.1,FHSIEN,0)=FHSIEN_"^"_FHNODE
"RTN","FHPST40",43,0)
 .Q
"RTN","FHPST40",44,0)
 Q
"RTN","FHSYSP")
0^30^B2588663
"RTN","FHSYSP",1,0)
FHSYSP ; HISC/REL - Site Parameter Edit ;3/20/95  07:53
"RTN","FHSYSP",2,0)
 ;;5.0;Dietetics;**40**;Oct 11, 1995
"RTN","FHSYSP",3,0)
 S DA=1,DIE="^FH(119.9,"
"RTN","FHSYSP",4,0)
 I '$D(^FH(119.9,DA,0)) S DR=".01///"_DA D ^DIE
"RTN","FHSYSP",5,0)
 W ! S DR="3;22;100//Y;I X'=""Y"" S Y="""";99" D ^DIE G KIL
"RTN","FHSYSP",6,0)
EN1 ; Display Selected Lab Tests
"RTN","FHSYSP",7,0)
 W ! S L=0,DIC="^FH(119.9,",FLDS="[FHSYP1]",BY="@SITE"
"RTN","FHSYSP",8,0)
 S (FR,TO)=1,DHD="SELECTED LABORATORY TESTS" D EN1^DIP,RSET Q
"RTN","FHSYSP",9,0)
EN2 ; Display Selected Drug Classifications
"RTN","FHSYSP",10,0)
 W ! S L=0,DIC="^FH(119.9,",FLDS="[FHSYP2]",BY="@SITE"
"RTN","FHSYSP",11,0)
 S (FR,TO)=1,DHD="SELECTED DRUG CLASSIFICATIONS" D EN1^DIP,RSET Q
"RTN","FHSYSP",12,0)
EN3 ; Clinical Site Parameters
"RTN","FHSYSP",13,0)
 S DA=1,DIE="^FH(119.9,",DR="[FHSITEC1]" W ! D ^DIE G KIL
"RTN","FHSYSP",14,0)
RSET K %ZIS S IOP="" D ^%ZIS
"RTN","FHSYSP",15,0)
KIL G KILL^XUSCLEAN
"RTN","FHSYSP",16,0)
TIM ; Convert to printable time
"RTN","FHSYSP",17,0)
 I $L(X)>6!($L(X)<2) G ERR
"RTN","FHSYSP",18,0)
 I X'["A",X'["P" G ERR
"RTN","FHSYSP",19,0)
 S:$L(X)<4 X=$E(X,1,$L(X)-1)_"00"_$E(X,$L(X))
"RTN","FHSYSP",20,0)
 I X[":",X?1.2N1":"2N1"A"!(X?1.2N1":"2N1"P") S X=+$P(X,":",1)_$P(X,":",2) G 1
"RTN","FHSYSP",21,0)
 I X'[":",X?3.4N1"A"!(X?3.4N1"P") G 1
"RTN","FHSYSP",22,0)
ERR W *7,"  Enter time as 8:15A or 12:30P" K X Q
"RTN","FHSYSP",23,0)
1 I X#100>59!(X>1259)!(X<1) G ERR
"RTN","FHSYSP",24,0)
 I X<1000 S:$E(X,1) X="0"_X
"RTN","FHSYSP",25,0)
 S X=+$E(X,1,2)_":"_$E(X,3,4)_$S(X["A":"A",1:"P") Q
"RTN","FHSYSP",26,0)
MIL ; Check for AM or PM
"RTN","FHSYSP",27,0)
 S X1=$P(X,":",1)_$P(X,":",2),X1=+X1
"RTN","FHSYSP",28,0)
 I X["P",X1<1200 S X1=X1+1200
"RTN","FHSYSP",29,0)
 I X["A",X1>1200 S X1=X1-1200
"RTN","FHSYSP",30,0)
 Q
"RTN","FHSYSP",31,0)
MIP ; Get the printable time
"RTN","FHSYSP",32,0)
 S Z=$S(Y<1200:"A",1:"P") I Z="P",Y>1259 S Y=Y-1200
"RTN","FHSYSP",33,0)
 S Y=$E("000"_Y,$L(Y),$L(Y)+3),Y=+$E(Y,1,2)_":"_$E(Y,3,4)_Z Q
"UP",117,117.06,-1)
117^2
"UP",117,117.06,0)
117.06
"VER")
8.0^22
"^DD",117,117.06,27,0)
# PATIENTS STATUS I^NJ4,0^^0;22^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,27,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,27,"DT")
3031014
"^DD",117,117.06,28,0)
# PATIENTS STATUS II^NJ4,0^^0;23^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,28,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,28,"DT")
3031014
"^DD",117,117.06,29,0)
# PATIENTS STATUS III^NJ4,0^^0;24^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,29,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,29,"DT")
3031014
"^DD",117,117.06,30,0)
# PATIENTS STATUS IV^NJ4,0^^0;25^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,30,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,30,"DT")
3031014
"^DD",117,117.06,31,0)
# PATIENTS STATUS UNC^NJ4,0^^0;26^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,31,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",117,117.06,31,"DT")
3031014
"^DD",117,117.06,32,0)
# DAILY MODIFIED DIETS^NJ9,0^^0;27^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,32,3)
Type a Number between 0 and 999999999, 0 Decimal Digits
"^DD",117,117.06,32,"DT")
3031014
"^DD",117,117.06,33,0)
# OF TOTAL DIETS^NJ9,0^^0;28^K:+X'=X!(X>999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",117,117.06,33,3)
Type a Number between 0 and 999999999, 0 Decimal Digits
"^DD",117,117.06,33,"DT")
3031014
"^DD",119.9,119.9,22,0)
MULTIDIVISIONAL SITE?^S^Y:YES;N:NO;^0;20^Q
"^DD",119.9,119.9,22,21,0)
^^4^4^3031009^
"^DD",119.9,119.9,22,21,1,0)
This field will be used to determine if a site is multidivisional or not.
"^DD",119.9,119.9,22,21,2,0)
If set to YES, the multidivisional enhancements released in patch FH*5.0*39
"^DD",119.9,119.9,22,21,3,0)
will be used, which involves prompting for Communication Office.  If set to
"^DD",119.9,119.9,22,21,4,0)
NO, then the non-multidivisional routines, fields and files will be used.
"^DD",119.9,119.9,22,"DT")
3031009
**END**
**END**
