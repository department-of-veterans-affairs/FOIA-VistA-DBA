$TXT Created by GREENE,LYFORD K. at MNTVBB.FO-WASH.MED.VA.GOV  (KIDS) on Wednesday, 08/10/05 at 10:21
=============================================================================
Run Date: OCT 19, 2005                     Designation: PRC*5.1*63
Package : PRC - IFCAP                         Priority: Mandatory
Version : 5.1        SEQ #72                    Status: Released
                  Compliance Date: NOV 19, 2005
=============================================================================

Associated patches: (v)PRC*5.1*1   <<= must be installed BEFORE `PRC*5.1*63'
                    (v)PRC*5.1*28  <<= must be installed BEFORE `PRC*5.1*63'
                    (v)PRC*5.1*39  <<= must be installed BEFORE `PRC*5.1*63'
                    (v)PRC*5.1*52  <<= must be installed BEFORE `PRC*5.1*63'
                    (v)PRC*5.1*81  <<= must be installed BEFORE `PRC*5.1*63'

Subject: NATIONAL ITEM FILE - PHASE 1

Category: 
  - Data Dictionary
  - Routine
  - Enhancement (Mandatory)

Description:
============

 This software enhancement was developed in response to Information 
 Technology (IT) Service Request #20020708, submitted by OA&MM.  
 (Reference: 
 http://vista.med.va.gov/pas/ViewTrackingRecord.asp?RequestID=20020708)  
  
 The main objectives are to create an interface between the National Item
 File (NIF) database and local Item Master files of IFCAP (enabling the
 population of fields with national values) and to add the NIF's Item
 Number (at the line item level) to the Procurement History Activity (PHA)
 transaction sent from IFCAP to the Office of Acquisition and Materiel 
 Management's (OA&MM) procurement history database.  The requirements and
 design documents for this enhancement may currently be found at:
 http://tspr.vista.med.va.gov/warboard/anotebk.asp?proj=708&Type=Active.
  
 In May 2002, the Department of Veterans Affairs' (VA) Procurement Reform
 Task Force recommended the creation of a NIF database implementing
 standardized naming conventions by January 31, 2003.  This facilitates the
 Department's ability to identify, track, and evaluate purchases; thereby,
 supporting the establishment of national and Veterans Integrated Service
 Network(s) (VISN)-wide procurement contracts, and monitoring compliance in
 their use.
  
 The NIF database may also be of use in the event of a national disaster to
 help identify the locations of critical items.  Currently, each of about
 141 stations has an independent ITEM MASTER (#441) file, maintained within
 the IFCAP application.  Across the system, descriptions of items are
 inconsistent, and entries have a locally assigned, but not nationally
 assigned, item number identifier.  When items are ordered, the item
 description is sent from the station to a centralized Procurement History
 database at the Austin Automation Center, Austin, TX.  With inconsistent
 descriptions and the lack of national identifiers, it is difficult for
 OA&MM staff to effectively monitor procurement patterns.
  
 Already underway is an OA&MM awarded contract to develop the initial 
 NIF on the basis of item submissions from IFCAP installations at the 
 Veterans Affairs Medical Centers (VAMC) in Columbia, SC and Minneapolis,
 MN; and the VAMCs in VISN 2, and VISN 8, as well as, from some national
 databases (including the Procurement History database with records
 submitted from all IFCAP stations).  The NIF database will subsequently be
 enhanced on the basis of extracts from additional IFCAP installations.
  
 New software distributed with this patch extracts values for the national 
 short description, national extended description, and NIF Item Number from
 a standards-based, X12 Item Maintenance 888 transaction received from the 
 NIF database and files them into the local ITEM MASTER (#441) file at the
 station.  The site's current long description is saved to a new PRE_NIF
 LONG DESCRIPTION (#50) field so that the site has a historical reference.
  
 Additionally, the current value of the site's short description is saved
 to the new PRE-NIF SHORT DESCRIPTION (#52) field prior to being
 overwritten with the national value.  The first 36 characters of this
 current short description are also added to the SYNONYM (#441.05) multiple
 if the value is not already present as a synonym.  Thus, users will still
 be able to lookup the item by the initial portion of the original short
 description.  As in option Item File Edit [PRCHPC ITEM EDIT], changes to
 the short description of an entry in ITEM MASTER (#441) file are sent to
 any PYXIS Supply Station where that item is an inventory item.
  
 In order to facilitate the review of applied description changes, this
 patch installs the new report option Item Descriptions After NIF Update
 [PRCH NIF UPDATE REPORT], which is attached to the Display/Print Menu
 option [PRCH DISPLAY] of the Purchasing Agent's menu [PRCHUSER PA].
  
 Data Dictionary changes have added the NIF Item Number as a write
 identifier displayed during item lookups.  The NIF Item Number also shows
 in the option Item Display [PRCH DISPLAY ITEM].  In addition, an item may
 now be selected by entering the NIF Item Number.  Finally, the NIF's Item
 Number is now sent in the 'IT' segment of the PHA transaction, when a
 Purchase Order is obligated.
  
 To prevent corruption of the nationalized values, editing of the SHORT 
 DESCRIPTION (#.05) field and DESCRIPTION (#.1) field of entries with
 assigned values in NIF ITEM NUMBER (#51) field is now restricted to those
 individuals assigned the new Security Key PRCHITEM MASTER.  These fields
 are available for editing on newly created item entries, since they have
 not yet been assigned a NIF Item Number.  The NIF ITEM NUMBER (#51) field
 is not presented in any IFCAP option for editing.
  
 As a result of this project, OA&MM personnel will be able to see the NIF
 Item Number and NIF Item Description in subsequently created records for
 the Procurement History database.  As well, future conversions of IFCAP
 purchasing and inventory documents into other centralized databases will
 be facilitated by the national NIF Item Number.
  
  
 This patch addresses the following New Service Request (NSR):
 ------------------------------------------------------------- 
    #20020708 (described in the Patch Description)
  
  
 This patch addresses the following NOIS/Remedy Ticket(s):
 --------------------------------------------------------- 
 There are no NOIS/Remedy tickets associated with this patch.
  
  
 Test Sites:
 -----------
 VISN 9 sites
 San Francisco
  
 COMPONENTS SENT WITH PATCH 
 --------------------------
 The following is a list of the routines included in this patch.  
 The second line of each of these routines now looks like: 
   
       ;;5.1;IFCAP;**[patch list]**;Oct 20, 2000 
   
             Old checksum CHECK^XTSUMBLD results
  
 Routine          Before Patch     After Patch   Patch List 
 -------          ------------     -----------    ----------
 PRC5163P         N/A              deleted        63
 PRCHE            17810484         19429925       1,28,39,81,63
 PRCHITM          N/A              21567424       63
 PRCHITM2         N/A              5786012        63
 PRCHQ4           12817761         13105476       63
 PRCOE2           6739762          6809041        63
 PRCPHLFM         11595135         11663354       1,24,52,63
   
             New checksum CHECK1^XTSUMBLD results 
  
 Routine          Before Patch     After Patch    Patch List
 -------          -------------    ------------   ----------
 PRC5163P         N/A              deleted        63
 PRCHE            42437164         48972338       1,28,39,81,63
 PRCHITM          N/A              50914708       63
 PRCHITM2         N/A              8168070        63
 PRCHQ4           41260299         41778600       63          
 PRCOE2           28834697         29096792       63
 PRCPHLFM         37124882         37336873       1,24,52,63 
  
 Total number of routines: 7
  
 Total number of routines modified: 4
 Total number of new routines: 2*
  
 * Routine PRC5163P is deleted after patch installation.
  
  
 The following is a list of fields included in this patch:
  
 Field Name (Number)                        File Name (Number)
 -------------------------------            ------------------
 PRE_NIF LONG DESCRIPTION (#50)             ITEM MASTER (#441)
 NIF ITEM NUMBER (#51)                      ITEM MASTER (#441)
 PRE_NIF SHORT DESCRIPTION (#52)            ITEM MASTER (#441)
 write identifier ^DD(441,0,"ID","Z") node  ITEM MASTER (#441)
 that adds NIF Item Number   (DBIA #3875)
  
 The following is a list of templates included in this patch:
  
 Template Name            Type               File Name (Number)
 -------------            ------             ------------------
 PRCHITEM                 Input              ITEM MASTER (#441)     
 PRCHITEM2                Input              ITEM MASTER (#441)
  
  
 The following is a list of options included in this patch:
  
 Option Name:               Type
 ------------------------   -----------
 PRCH NIF UPDATE REPORT     Run Routine      SEND TO SITE
 PRCHITEM_UPDATE            Server           SEND TO SITE
  
  
 The following is the list of Security Keys included in this patch:
  
 Security Key
 ------------
 PRCHITEM MASTER                             SEND TO SITE
  
  
          ================INSTALLATION INSTRUCTIONS =================
  
 If installed during the normal workday it is recommended that the
 following menus in the OPTION (#19) file and all of their descendants be
 disabled to prevent possible conflicts while running the KIDS Install.
 Other VISTA users will not be affected.
  
   Document Processing Menu               [PRCFA DOCUMENT PROCESSING]
   Delivery Orders Menu                   [PRCH DELIVERY ORDER MENU]
   Process Purchase Card Menu             [PRCH PROCESS PC]
   Purchase Orders Menu                   [PRCHPC PO]
   P&C Utilities Menu                     [PRCHPC UTL]
   Requisition Processing                 [PRCHPM RQ MENU]
   PPM Utility Menu                       [PRCHPM UTILITIES]
   Request for Quotation Main Menu        [PRCHQM]
   IFCAP Application Coordinator Menu     [PRCHUSER COORDINATOR]
   Warehouse                              [PRCHUSER WHSE]
   Copy Primary to Secondary              [PRCP COPY PRIMARY TO SECONDARY]
   Copy Secondary to Secondary            [PRCP COPY SECOND TO SECOND]
   Enter/Edit Inventory Item Data         [PRCP EDIT INVENTORY ITEMS]
   Enter/Edit Items on Distribution Point [PRCP EDIT DISTR PT ITEMS] 
   Posted Stock Management                [PRCP PPM MENU]
   Supply Station Item Update             [PRCP UPDATE SUPPLY STA ITEMS]
  
  
 Install Time: Approximately 25 minutes
  
 ************** PRE-INSTALLATION INSTRUCTIONS **************
  
   1.   CREATE RESOURCE DEVICE PRCHITEM
        -------------------------------
        Select Systems Manager Menu Option: DEVICE Management
  
  
          Change Device's Terminal Type
          Device Edit
          Terminal Type Edit
          Hunt Group Manager ...
          Display Device Data
          List Terminal Types
          Clear Terminal
          Loopback Test of Device Port
          Send Test Pattern to Terminal
          Out of Service Set/Clear
          Clear all resources
          Clear one Resource
          Current Line/Port Address
          DA Return Code Edit
          Edit Devices by Specific Types ...
          Edit Line/Port Addresses
          Line/Port Address report
  
        Select Device Management Option: EDIT DEVICES BY SPECIFIC Types
  
  
          CHAN   Network Channel Device Edit
          HFS    Host File Server Device Edit
          MT     Magtape Device Edit
          RES    Resource Device Edit
          SDP    SDP Device Edit
          SPL    Spool Device Edit
          
        Select Edit Devices by Specific Types Option: RES  Resource Device Edit
  
          Select Resource Device: PRCHITEM
          Are you adding 'PRCHITEM' as a new DEVICE? No// Y  (Yes)
          DEVICE LOCATION OF TERMINAL: NA
          DEVICE $I: PRCHITEM
          DEVICE VOLUME SET(CPU): 
          DEVICE TYPE: R  RESOURCES
          NAME: PRCHITEM// 
          $I: PRCHITEM// 
          VOLUME SET(CPU): 
          RESOURCE SLOTS: 1// 
  
          Select Resource Device:
  
          NOTE: The appropriate value for the RESOURCE SLOTS (#35) field
                is 1. The use of the resource device is to limit the number
                of concurrently running filers for the item update
                interface, so that computer activities supporting patient
                care will not be adversely impacted.  As the Server Action
                of option PRCHITEM_UPDATE is QUEUE SERVER ROUTINE, a 
                subsequent instance of the filer will not begin until the
                prior instance releases the device.
  
          NOTE: Alternately, this device can also be entered directly using
                VA FileMan, if you prefer.
  
          MNT>D Q^DI
  
          VA FileMan 22.0
  
          Select OPTION: ENTER OR EDIT FILE ENTRIES  
  
          INPUT TO WHAT FILE: DEVICE// 
          EDIT WHICH FIELD: ALL// .01  NAME
          THEN EDIT FIELD: LOCATION OF TERMINAL  
          THEN EDIT FIELD: $I  
          THEN EDIT FIELD: VOLUME SET(CPU)  
          THEN EDIT FIELD: TYPE
               1   TYPE  
               2   TYPE-AHEAD  
          CHOOSE 1-2: 1  TYPE
          THEN EDIT FIELD: 
          STORE THESE FIELDS IN TEMPLATE: 
  
          Select DEVICE NAME: PRCHITEM
         
          Are you adding 'PRCHITEM' as a new DEVICE (the 59TH)? No// Y  
          (Yes)
             DEVICE LOCATION OF TERMINAL: NA
             DEVICE $I: PRCHITEM
             DEVICE VOLUME SET(CPU): 
             DEVICE TYPE: R  RESOURCES
          LOCATION OF TERMINAL: NA// 
          $I: PRCHITEM// 
          VOLUME SET(CPU): 
          TYPE: RESOURCES// 
  
          Select DEVICE NAME: 
  
          Select OPTION: INQUIRE TO FILE ENTRIES  
  
          OUTPUT FROM WHAT FILE: DEVICE// 
          Select DEVICE NAME: PRCHITEM      NA     PRCHITEM     
          ANOTHER ONE: 
          STANDARD CAPTIONED OUTPUT? Yes//   (Yes)
          Include COMPUTED fields:  (N/Y/R/B): NO//  - No record number
          (IEN), no Computed Fields
          DISPLAY AUDIT TRAIL? No//   NO
  
          NAME: PRCHITEM                         $I: PRCHITEM
            LOCATION OF TERMINAL: NA              RESOURCE SLOTS: 1
            TYPE: RESOURCES
  
          Select DEVICE NAME: 
  
  
   2.   CHECK ISM MAIL GROUP
        --------------------
        You should already have Mail Group entry ISM on your system. Please
        check that it has at least one active member.  Upon encountering an
        error, the item update server sends a message to this Mail Group.
  
 **************************************************************
  
   1.   LOAD TRANSPORT GLOBAL 
        ---------------------
        Choose the PackMan message containing this patch and invoke the 
        INSTALL/CHECK MESSAGE PackMan option.  
   
   2.   START UP KIDS 
        -------------
        Start up the Kernel Installation and Distribution System Menu 
        [XPD MAIN]: 
    
             Edits and Distribution ...  
             Utilities ...  
             Installation ...  
    
   Select Kernel Installation & Distribution System Option: INStallation 
                                                            ---
             Load a Distribution 
             Print Transport Global 
             Compare Transport Global to Current System 
             Verify Checksums in Transport Global 
             Install Package(s) 
             Restart Install of Package(s) 
             Unload a Distribution 
             Backup a Transport Global 
    
   Select Installation Option: 
    
   3.   Select Installation Option: 
        ---------------------------
        NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
               NAME, enter PRC*5.1*63):
       
        a.  Backup a Transport Global - This option will create a backup
            message of any routines exported with this patch. It will not
            backup any other changes such as DD's or templates.
        b.  Compare Transport Global to Current System - This option will
            allow you to view all changes that will be made when this patch
            is installed.  It compares all components of this patch
            (routines, DD's, templates, etc.).
        c.  Verify Checksums in Transport Global - This option will allow
            you to ensure the integrity of the routines that are in the
            transport global.
      
   4.   Select Installation Option: Install Package(s) 
                                    ----------------
        **This is the step to start the installation of this KIDS patch: 
    
        a.  Choose the Install Package(s) option to start the patch install.
  
            When prompted 'Want KIDS to Rebuild Menu Trees Upon Completion
            of Install? YES//' answer YES.
        b.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? 
            YES//' answer NO.
        c.  When prompted 'Want to DISABLE Scheduled Options, Menu 
            Options, and Protocols? YES//' answer YES.
        d.  When prompted 'Enter options you wish to mark as 'Out Of
            Order':'  Enter the following options:
        
  
   Document Processing Menu               [PRCFA DOCUMENT PROCESSING]
   Delivery Orders Menu                   [PRCH DELIVERY ORDER MENU]
   Process Purchase Card Menu             [PRCH PROCESS PC]
   Purchase Orders Menu                   [PRCHPC PO]
   P&C Utilities Menu                     [PRCHPC UTL]
   Requisition Processing                 [PRCHPM RQ MENU]
   PPM Utility Menu                       [PRCHPM UTILITIES]
   Request for Quotation Main Menu        [PRCHQM]
   IFCAP Application Coordinator Menu     [PRCHUSER COORDINATOR]
   Warehouse                              [PRCHUSER WHSE]
   Copy Primary to Secondary              [PRCP COPY PRIMARY TO SECONDARY]
   Copy Secondary to Secondary            [PRCP COPY SECOND TO SECOND]
   Enter/Edit Inventory Item Data         [PRCP EDIT INVENTORY ITEMS]
   Enter/Edit Items on Distribution Point [PRCP EDIT DISTR PT ITEMS] 
   Posted Stock Management                [PRCP PPM MENU]
   Supply Station Item Update             [PRCP UPDATE SUPPLY STA ITEMS]
  
        e.  When prompted 'Enter protocols you wish to mark as 'Out Of
            Order': ' press <return>.
  
 ************** POST-INSTALLATION INSTRUCTIONS **************
  
   1.   ASSIGN SECURITY KEY
        -------------------
        Assign the PRCHITEM MASTER security key according to instructions
        from the VHA Office of Clinical Logistics. The idea is that only a
        restricted subset of item editors will be able to edit the SHORT
        DESCRIPTION (#.05) field and DESCRIPTION (#.1) field for ITEM
        MASTER (#441) file entries with an assigned NIF Item Number, to
        prevent deviation from national values.

Routine Information:
====================
Routine Name: PRC5163P
    Checksum:
  See patch description.
 Description of Changes:
  This routine contains the Environmental Check and the Post-Init After 
  User Commit software for KIDS Build PRC*5.1*63.
   
  Applicable Database Integration Agreements:
   
   #3875  ID Write identifier node File #441: MUMPS Set to create the node 
  in Post-Init.
   
   #3878  Resource device filing in server option: Use of VA FileMan APIs 
  to link resource device to server option in Post-Init.

Routine Name: PRCHE
    Checksum:
  See patch description.
 Description of Changes:
  The logic for option Item File Edit [PRCHPC ITEM EDIT] was changed to 
  restrict the editing of the SHORT DESCRIPTION and DESCRIPTION fields of 
  the ITEM MASTER file for those entries assigned a National Item File's 
  Item Number.

Routine Name: PRCHITM
    Checksum:
  See patch description.
 Description of Changes:
  This routine unpacks the X12 Item Master 888 transaction and files the 
  national item short description, national item extended description and 
  national item number into the local IFCAP's ITEM MASTER file (#441).
   
  Through a call to the BLDSEG^PRCPHLFM() API, the short description is 
  sent to automated supply stations like those from PYXIS.

Routine Name: PRCHITM2
    Checksum:
  See patch description.
 Description of Changes:
  The report generated by this routine displays the pre-NIF and current 
  values of each item's short and long descriptions plus the short 
  description's last edit date.  It also indicates whether the item is
  currently inactive.

Routine Name: PRCHQ4
    Checksum:
  See patch description.
 Description of Changes:
  The IT module was edited to add a field separator (the caret character
  '^') before the segment terminator (the pipe character '|') to create
  the field for the National Item File's Item Number.  This makes the
  'IT' segment definitions for the RFQ and PHA consistent.  In the RFQ,
  however, this field will never be populated.
   
  In addition, the FSC (Federal Supply Classification) reference in the
  'IT' segment was changed from the entry's internal entry number (ien) to
  the entry's .01 field's value, in response to the initiative to add
  alphanumeric Product Service Codes to file #441.2.

Routine Name: PRCOE2
    Checksum:
  See patch description.
 Description of Changes:
  The value of the NIF Item Number was added to the 'IT' segment of the PHA
  transaction.

Routine Name: PRCPHLFM
    Checksum:
  See patch description.
 Description of Changes:
  In API BLDSEG^PRCPHLFM(), MUMPS Write statements have been replaced by 
  calls to EN^DDIOL() to prevent  'no device' errors when the API is 
  executed in background, as in the case when invoked by the PRCHITM filer.


=============================================================================
User Information:
Entered By  : GREENE,LYFORD                 Date Entered  : NOV 26, 2002
Completed By: BURGESS,PATRICIA              Date Completed: OCT 19, 2005
Released By : NELSON,VICKI M                Date Released : OCT 19, 2005
=============================================================================


Packman Mail Message:
=====================

$END TXT
