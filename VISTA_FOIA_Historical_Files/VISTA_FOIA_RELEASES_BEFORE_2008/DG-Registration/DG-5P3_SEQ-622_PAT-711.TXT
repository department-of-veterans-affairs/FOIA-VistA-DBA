$TXT Created by DAVIS,PAULETTE T at DEVCRN.FO-ALBANY.MED.VA.GOV  (KIDS) on Monday, 06/12/06 at 11:54
=============================================================================
Run Date: JUN 14, 2006                     Designation: DG*5.3*711
Package : DG - REGISTRATION                   Priority: EMERGENCY
Version : 5.3       SEQ #622                    Status: Released
                  Compliance Date: JUN 16, 2006
=============================================================================

Associated patches: (v)DG*5.3*307  <<= must be installed BEFORE `DG*5.3*711'
                    (v)DG*5.3*698  <<= must be installed BEFORE `DG*5.3*711'

Subject: FIX FOR MASTER PATIENT INDEX NAME SYNCHRONIZATION ISSUE

Category: 
  - Routine

Description:
============

  DG*5.3*711 is being distributed as an EMERGENCY patch, and should be
  installed within 48 hours of patch release.
   
  DG*5.3*307 and DG*5.3*698 are required builds for patch DG*5.3*711.
   
  Problem:
  --------
  Issue #1:
  Prior to patch DG*5.3*698, the patient name on the Master Patient Index
  (MPI) was only updated with information from the VistA PATIENT (#2)
  file's NAME (.01) field.  This 30 character free-text field is defined
  to contain LAST,FIRST MIDDLE SUFFIX.  This approach does not populate
  PREFIX or DEGREE.
   
  In patch DG*5.3*698, a change was made to populate all name components
  on the MPI.  This was done via HL7 messaging.  A Patient Name
  Standardization API was used to build the name components into the PID
  segment.  The API pulls the name information from the NAME COMPONENTS
  (#20) file.  A Remedy Ticket reports that the name component fields in
  VistA are being filed incorrectly.  The components may appear to be
  correct at the Coordinating Master of Record (CMOR) facility, but
  when the fields are propagated to the shared Treating Facilities via
  HL7 messaging, they are not filed into the correct component.  For
  example, 'MR' entered into the PREFIX field at the CMOR site is being
  filed into the SUFFIX field at the shared Treating Facilities.
   
  Issue #2
  Use of the Patient Name Standardization API has also been backed
  out for MOTHER'S MAIDEN NAME and ALIAS.  This data is again pulled
  from the MOTHER'S MAIDEN NAME (#.2403) and ALIAS multiple (#2.01)
  in the PATIENT (#2) file.
   
  The naming portion of DG*5.3*698 is being backed out in DG*5.3*711,
  and will revert to pulling the information from the PATIENT (#2)
  file's NAME (.01), MOTHER'S MAIDEN NAME (#.2403), and ALIAS multiple
  (#2.01) fields.  When DG*5.3*711 has been installed at ALL facilities,
  the incorrect component propagation will no longer occur.
     
  Issue #3
  A problem was reported that Z07 messages to the HEC fail when the
  record has an ALIAS.  A minor code change was added to the ALIAS
  subroutine in VAFCQRY1 to add a missing HL7 repeater.
     
  Issue #4:
  It is possible for the INTEGRATION CONTROL NUMBER (#991.01) and the
  ICN CHECKSUM (#991.02) fields in the PATIENT (#2) file to be updated
  at the same time that the Health Level Seven (HL7) PID segment is being
  built.  If this occurred, the Integration Control Number (ICN) could
  be placed in the PID segment with the checksum from the previous ICN.
  That issue will be corrected in patch MPIF*1.0*45.  It could also
  impact the storage and retrieval of the ICN CHECKSUM (#1) in the ICN
  HISTORY (#992).  Routines VAFCHIS and VAFCQRY1 have been modified to
  address this issue.
   
  Issue #5:
  MPI is currently using a KERNEL API to standardize patient name.
  The API is called while building the HL7 message to transmit data
  to the Master Patient Index.  The API does not function correctly
  for those patients who have a space in the last name.  The API
  strips out the space.  The end result after message propagation, is
  that the CMOR site has the PATIENT (#2) file's NAME (.01) field and
  the value in the NAME COMPONENTS (#20) file with the space, but the
  MPI and all shared treating facilities have the value without the
  space.  For example, a last name of 'MC BRIDE' becomes 'MCBRIDE',
  which is legibly the same name.  However, a last name of 'ST ORES'
  becomes 'STORES', which could cause downstream identification issues.
  A code change has been made to remove the use of HLNAME^XLFNAME to
  build the HL7 message, and instead use an internal application call
  to the VAFCPID2 API.  The KERNEL team will be releasing a patch to
  correct the HLNAME^XLFNAME API.  When available, we will use that
  API in the future.
   
  The defect with the Patient Name Standardization functionality still
  must be addressed.  The VistA Maintenance Project (VMP) team is
  investigating this and has a couple of patches in various stages
  of development.
   
  IMPORTANT NOTE:
  On the Master Patient Index (MPI), a routine will be run to identify
  all records that contain prefix data (e.g., MR, MRS, MS, DR, etc.)
  in the suffix field.  This information will be stored in an ^XTMP
  global.  When all facilities have installed emergency patch DG*5.3*711,
  a routine will be run on the MPI to automatically clean up as many of
  these records as possible.  If the data for the record is correct at
  the CMOR site (e.g., does NOT contain prefix data in the suffix field),
  then an update will be triggered to propagate the correct information
  to all shared treating facilities.  A PATIENT NAME CHANGED bulletin
  occurs for each corrected record, as is standard within PIMS.
   
  For some records, it is possible that the data at the CMOR site is
  incorrect (e.g., it actually contains prefix values in the suffix field.)
  For these records, the automatic correction process will not work.
  These records will be identified and made available on a report for the
  Identity Management Data Quality (IMDQ) team.  IMDQ will pass this
  information along to the relevant facilities for manual correction
  via Load/Edit Patient Data [DG LOAD PATIENT DATA].  At that point,
  when the CMOR site corrects the record at their facility, all shared
  treating facilities are also updated.
   
  This patch addresses the following New Service Request (NSR):
  -------------------------------------------------------------
  There is no NSR associated with this patch.
    
  Associated Remedy Ticket(s):
  ============================
  HD0000000138353
     
  Test Sites:
  ===========
  Altoona, PA
  Bay Pines, FL
  Birmingham, AL
  Central Alabama HCS
  Pittsburgh HCS (through v.3)
   
  Routine Summary:
  ================
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
   
  <TAB>;;5.3;Registration;**[Patch List]**;Aug 13, 1993
   
  Using old logic: CHECK^XTSUMBLD results
  Routine       Before Patch       After Patch       Patch List
  --------      ------------       ------------      ----------
  VAFCHIS          1636336            4444532        149,255,307,711
  VAFCQRY1        31953430           28523792        428,474,477,575,
                                                     627,648,698,711
     
  Using new logic: CHECK1^XTSUMBLD results
  Routine       Before Patch       After Patch       Patch List
  --------      ------------       ------------      ----------
  VAFCHIS          4546709           12925674        149,255,307,711
  VAFCQRY1        69367143           64681125        428,474,477,575,
                                                     627,648,698,711
     
  Installation Instructions:
  ==========================
  This patch takes less than 2 minutes to install.  This patch should
  be loaded during non-peak hours to minimize disruption to the users.
   
  1.  Users can remain on the system during patch installation.
   
  2.  Use the INSTALL/CHECK MESSAGE option on the PackMan menu.
      Note:  TEXT PRINT/DISPLAY option in the PackMan menu will display
      the patch text only.
     
  3.  In order to eliminate the failure of VDEF messaging during the patch
      installation it is required that you suspend VDEF messaging
      (see instructions below).
    
      Select OPTION NAME: VDEF CONFIGURATION MENU   VDEF Configuration
        and Status
   
        Site   Site-Wide Parameters
        Req    Request Queue Parameters
        ActR   Activate/Inactivate Requestor
     -->SusR   Suspend/Run Request Queue
        Cust   VDEF Custodial Package Activate/Inactivate
        API    VDEF Event API Activate/Inactivate
        Stat   Status of VDEF components
        Sch    Request Processor Schedule
    
      Select VDEF Configuration and Status Option: SUS  Suspend/Run
        Request Queue
   
      Select Request Queue: MAINTENANCE
      SUSPENDED FLAG: RUNNING// S  SUSPENDED
   
      Note:  If you are a PFSS test site you will need to repeat step 4 to 
             suspend the PFSS OUTBOUND QUEUE.
    
  4.  From the Kernel Installation and Distribution System menu, select
      the Installation menu.
   
  5.  From this menu, you may elect to use the following options:
      (a)  Backup a Transport Global.
      (b)  Compare Transport Global to Current System.
      (c)  Verify Checksums in Transport Global.
      (d)  Print Transport Global.
   
  6.  Use the Install Package(s) option and select the package DG*5.3*711.
   
  7.  When prompted 'Want to DISABLE Scheduled Options, Menu Options,
      and Protocols? YES//', respond Yes and enter the following
      options:
    
         Register a Patient             [DG REGISTER PATIENT]
         Load/Edit Patient Data         [DG LOAD PATIENT DATA]
         Electronic 10-10EZ Processing  [EAS EZ 1010EZ PROCESSING]
         UPDATE BATCH JOB FOR HL7 v2.3  [VAFC BATCH UPDATE]
         Coordinating Master of Record (CMOR) Request   [MPIF CMOR MGR]
         Display Only Query    [MPIF DISPLAY ONLY QUERY TO MPI]
         Local/Missing ICN Resolution Background Job
                               [MPIF LOC/MIS ICN RES]
         MPI/PD Exception Handling      [RG EXCEPTION HANDLING]
    
  8.  When installation has completed, restart the VDEF queues (see
      instructions below).
   
      Select OPTION NAME: VDEF CONFIGURATION MENU    VDEF Configuration
        and Status
   
        Site   Site-Wide Parameters
        Req    Request Queue Parameters
        ActR   Activate/Inactivate Requestor
     -->SusR   Suspend/Run Request Queue
        Cust   VDEF Custodial Package Activate/Inactivate
        API    VDEF Event API Activate/Inactivate
        Stat   Status of VDEF components
        Sch    Request Processor Schedule
    
      Select VDEF Configuration and Status Option: SUS  Suspend/Run
         Request Queue
    
      Select Request Queue: MAINTENANCE
      SUSPENDED FLAG: SUSPENDED // R  RUNNING
    
      Note: If you are a PFSS test site you will need to repeat step 8 to
            run the PFSS OUTBOUND QUEUE.

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: VAFCHIS
    Before:  B4546709  After: B12925674  **149,255,307,711**
Routine Name: VAFCQRY1
    Before: B69367143  After: B64681125  **428,474,477,575,627,648,698,711**

=============================================================================
User Information:
Entered By  : DAVIS,PAULETTE                Date Entered  : APR 10, 2006
Completed By: ALDERMAN,MATT S               Date Completed: JUN 14, 2006
Released By : FRANCE,KATHI                  Date Released : JUN 14, 2006
=============================================================================


Packman Mail Message:
=====================

$END TXT
