Released RMPR*3*92 SEQ #75
Extracted from mail message
**KIDS**:RMPR*3.0*92^

**INSTALL NAME**
RMPR*3.0*92
"BLD",5203,0)
RMPR*3.0*92^PROSTHETICS^0^3041103^y
"BLD",5203,1,0)
^^2^2^3040901^
"BLD",5203,1,1,0)
Code Set Versionsing for ICD9.  Replace all direct calls to ICD9 with API 
"BLD",5203,1,2,0)
IDDX^ICDCODE.
"BLD",5203,4,0)
^9.64PA^^
"BLD",5203,"KRN",0)
^9.67PA^8989.52^19
"BLD",5203,"KRN",.4,0)
.4
"BLD",5203,"KRN",.401,0)
.401
"BLD",5203,"KRN",.402,0)
.402
"BLD",5203,"KRN",.403,0)
.403
"BLD",5203,"KRN",.5,0)
.5
"BLD",5203,"KRN",.84,0)
.84
"BLD",5203,"KRN",3.6,0)
3.6
"BLD",5203,"KRN",3.8,0)
3.8
"BLD",5203,"KRN",9.2,0)
9.2
"BLD",5203,"KRN",9.8,0)
9.8
"BLD",5203,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",5203,"KRN",9.8,"NM",1,0)
RMPRBIL^^0^B36019778
"BLD",5203,"KRN",9.8,"NM",2,0)
RMPRPAT3^^0^B36433256
"BLD",5203,"KRN",9.8,"NM",3,0)
RMPOPAT3^^0^B35299812
"BLD",5203,"KRN",9.8,"NM",4,0)
RMPRSE21^^0^B29197111
"BLD",5203,"KRN",9.8,"NM",5,0)
RMPR9S4E^^0^B41504578
"BLD",5203,"KRN",9.8,"NM","B","RMPOPAT3",3)

"BLD",5203,"KRN",9.8,"NM","B","RMPR9S4E",5)

"BLD",5203,"KRN",9.8,"NM","B","RMPRBIL",1)

"BLD",5203,"KRN",9.8,"NM","B","RMPRPAT3",2)

"BLD",5203,"KRN",9.8,"NM","B","RMPRSE21",4)

"BLD",5203,"KRN",19,0)
19
"BLD",5203,"KRN",19.1,0)
19.1
"BLD",5203,"KRN",101,0)
101
"BLD",5203,"KRN",409.61,0)
409.61
"BLD",5203,"KRN",771,0)
771
"BLD",5203,"KRN",870,0)
870
"BLD",5203,"KRN",8989.51,0)
8989.51
"BLD",5203,"KRN",8989.52,0)
8989.52
"BLD",5203,"KRN",8994,0)
8994
"BLD",5203,"KRN","B",.4,.4)

"BLD",5203,"KRN","B",.401,.401)

"BLD",5203,"KRN","B",.402,.402)

"BLD",5203,"KRN","B",.403,.403)

"BLD",5203,"KRN","B",.5,.5)

"BLD",5203,"KRN","B",.84,.84)

"BLD",5203,"KRN","B",3.6,3.6)

"BLD",5203,"KRN","B",3.8,3.8)

"BLD",5203,"KRN","B",9.2,9.2)

"BLD",5203,"KRN","B",9.8,9.8)

"BLD",5203,"KRN","B",19,19)

"BLD",5203,"KRN","B",19.1,19.1)

"BLD",5203,"KRN","B",101,101)

"BLD",5203,"KRN","B",409.61,409.61)

"BLD",5203,"KRN","B",771,771)

"BLD",5203,"KRN","B",870,870)

"BLD",5203,"KRN","B",8989.51,8989.51)

"BLD",5203,"KRN","B",8989.52,8989.52)

"BLD",5203,"KRN","B",8994,8994)

"BLD",5203,"QUES",0)
^9.62^^
"BLD",5203,"REQB",0)
^9.611^5^5
"BLD",5203,"REQB",1,0)
RMPR*3.0*86^1
"BLD",5203,"REQB",2,0)
RMPR*3.0*69^1
"BLD",5203,"REQB",3,0)
RMPR*3.0*70^1
"BLD",5203,"REQB",4,0)
RMPR*3.0*77^1
"BLD",5203,"REQB",5,0)
RMPR*3.0*59^1
"BLD",5203,"REQB","B","RMPR*3.0*59",5)

"BLD",5203,"REQB","B","RMPR*3.0*69",2)

"BLD",5203,"REQB","B","RMPR*3.0*70",3)

"BLD",5203,"REQB","B","RMPR*3.0*77",4)

"BLD",5203,"REQB","B","RMPR*3.0*86",1)

"MBREQ")
0
"PKG",101,-1)
1^1
"PKG",101,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",101,20,0)
^9.402P^^
"PKG",101,22,0)
^9.49I^1^1
"PKG",101,22,1,0)
3.0^2960209^2960214
"PKG",101,22,1,"PAH",1,0)
92^3041103^560
"PKG",101,22,1,"PAH",1,1,0)
^^2^2^3041103
"PKG",101,22,1,"PAH",1,1,1,0)
Code Set Versionsing for ICD9.  Replace all direct calls to ICD9 with API 
"PKG",101,22,1,"PAH",1,1,2,0)
IDDX^ICDCODE.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
5
"RTN","RMPOPAT3")
0^3^B35299812
"RTN","RMPOPAT3",1,0)
RMPOPAT3 ;HINES-CIOFO/RVD-Detail Display Patient 10-2319 Transaction ;9/17/02
"RTN","RMPOPAT3",2,0)
 ;;3.0;PROSTHETICS;**70,92**;Feb 09, 1996
"RTN","RMPOPAT3",3,0)
 ;
"RTN","RMPOPAT3",4,0)
 ; RVD 7/8/02 patch #70 - this routine is a copy of RMPRPAT3.
"RTN","RMPOPAT3",5,0)
 ;                      - For Read Only 2319.
"RTN","RMPOPAT3",6,0)
 ; AAC 08/03/04 Patch 92 - Code Set Versioning (CSV) 
"RTN","RMPOPAT3",7,0)
 ;                       - Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80).
"RTN","RMPOPAT3",8,0)
 ;
"RTN","RMPOPAT3",9,0)
 ;DBIA # 10082 - file #80, global read.
"RTN","RMPOPAT3",10,0)
 ;DBIA # 3990 - for routine ICDDX^ICDCODE for Patch 92
"RTN","RMPOPAT3",11,0)
 ;                        
"RTN","RMPOPAT3",12,0)
 ;expect ANS,IT(ANS)
"RTN","RMPOPAT3",13,0)
 ;          +IT(ANS)=ien of file 660
"RTN","RMPOPAT3",14,0)
 ;expect variables from GETPAT^RMPRUTIL
"RTN","RMPOPAT3",15,0)
 ;    RMPRSSNE (external form of SSN)
"RTN","RMPOPAT3",16,0)
 ;    RMPRNAM (name of patient)
"RTN","RMPOPAT3",17,0)
 ;    RMPRDOB
"RTN","RMPOPAT3",18,0)
 ;display detailed record
"RTN","RMPOPAT3",19,0)
PRINT ;called from RMPOPAT2
"RTN","RMPOPAT3",20,0)
 ;get 2319 transaction
"RTN","RMPOPAT3",21,0)
 ;
"RTN","RMPOPAT3",22,0)
 N DIC,DIQ,DR,DA,RMPRV,RMPRDA,RV
"RTN","RMPOPAT3",23,0)
 S DIC=660,DIQ="R19",DR=".01:96",DIQ(0)="EN"
"RTN","RMPOPAT3",24,0)
 S (RMPRDA,DA)=+IT(ANS)
"RTN","RMPOPAT3",25,0)
 D EN^DIQ1
"RTN","RMPOPAT3",26,0)
 S DIQ="R19",DR=72,DIQ(0)="I" D EN^DIQ1
"RTN","RMPOPAT3",27,0)
 ;get vendor info
"RTN","RMPOPAT3",28,0)
 S DA=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPOPAT3",29,0)
 I DA D
"RTN","RMPOPAT3",30,0)
 .S DIC=440,DIQ="RV",DR=".01:6",DIQ(0)="EN"
"RTN","RMPOPAT3",31,0)
 .S (RMPRV,DA)=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPOPAT3",32,0)
 .D EN^DIQ1
"RTN","RMPOPAT3",33,0)
 ;
"RTN","RMPOPAT3",34,0)
 ;array defined for record in following format:
"RTN","RMPOPAT3",35,0)
 ;R19(filenumber,ien,field,E)=external form of data
"RTN","RMPOPAT3",36,0)
 ;RV(filenumber,ien,field,E)=external form of data
"RTN","RMPOPAT3",37,0)
 ;example
"RTN","RMPOPAT3",38,0)
 ;R19(660,100,.01,"E")=APR 27, 1995
"RTN","RMPOPAT3",39,0)
 ;R19(660,100,.02,"E")=FUDGE,CHOCOLATE
"RTN","RMPOPAT3",40,0)
 ;RV(440,131,.01,"E")=ORTHOTIC LAB
"RTN","RMPOPAT3",41,0)
 ;
"RTN","RMPOPAT3",42,0)
 D HDR
"RTN","RMPOPAT3",43,0)
 W !,"TYPE OF FORM: ",$G(R19(660,RMPRDA,11,"E"))
"RTN","RMPOPAT3",44,0)
 W ?25,"INITIATOR: ",$G(R19(660,RMPRDA,27,"E"))
"RTN","RMPOPAT3",45,0)
 W ?55,"DATE: ",$G(R19(660,RMPRDA,1,"E"))
"RTN","RMPOPAT3",46,0)
 W !,"DELIVER TO: ",$G(R19(660,RMPRDA,25,"E"))
"RTN","RMPOPAT3",47,0)
 W !,"TYPE TRANS: ",$G(R19(660,RMPRDA,2,"E"))
"RTN","RMPOPAT3",48,0)
 W ?30,"QTY: ",$G(R19(660,RMPRDA,5,"E"))
"RTN","RMPOPAT3",49,0)
 W:$G(R19(660,RMPRDA,29,"E")) ?40,"INVENTORY POINT: ",R19(660,RMPRDA,29,"E"),!
"RTN","RMPOPAT3",50,0)
 W ?40,"SOURCE: ",$G(R19(660,RMPRDA,12,"E"))
"RTN","RMPOPAT3",51,0)
 ;vendor tracking number
"RTN","RMPOPAT3",52,0)
 I $G(R19(660,RMPRDA,11,"E"))="VISA" D
"RTN","RMPOPAT3",53,0)
 .W !,"VENDOR TRACKING: ",$G(R19(660,RMPRDA,4.2,"E"))
"RTN","RMPOPAT3",54,0)
 .W ?38,"BANK AUTHORIZATION: ",$G(R19(660,RMPRDA,4.3,"E"))
"RTN","RMPOPAT3",55,0)
 W !,"VENDOR: ",?15,$G(R19(660,RMPRDA,7,"E"))
"RTN","RMPOPAT3",56,0)
 I $D(RV) D
"RTN","RMPOPAT3",57,0)
 .W !?15,$G(RV(440,RMPRV,1,"E"))
"RTN","RMPOPAT3",58,0)
 .W !?15,$G(RV(440,RMPRV,4.2,"E")),","
"RTN","RMPOPAT3",59,0)
 .W ?$X+3,$G(RV(440,RMPRV,4.4,"E")),?$X+5,$G(RV(440,RMPRV,4.6,"E"))
"RTN","RMPOPAT3",60,0)
 W !,"DELIVERY DATE: "
"RTN","RMPOPAT3",61,0)
 I $D(R19(660,RMPRDA,10,"E")) W R19(660,RMPRDA,10,"E")
"RTN","RMPOPAT3",62,0)
 W !
"RTN","RMPOPAT3",63,0)
 I '$P(IT(AN),U,3) D
"RTN","RMPOPAT3",64,0)
 .W "TOTAL COST: "
"RTN","RMPOPAT3",65,0)
 .I $G(R19(660,RMPRDA,14,"E"))'="" W "$"_$J(R19(660,RMPRDA,14,"E"),2)
"RTN","RMPOPAT3",66,0)
 .I $G(R19(660,RMPRDA,14,"E"))="" W $S($G(R19(660,RMPRDA,6,"E"))'="":"$"_$J(R19(660,RMPRDA,6,"E"),2),$G(R19(660,RMPRDA,48,"E"))'="":"$"_$J(R19(660,RMPRDA,48,"E"),2),1:"")
"RTN","RMPOPAT3",67,0)
 ;
"RTN","RMPOPAT3",68,0)
 ;lab data
"RTN","RMPOPAT3",69,0)
 I $D(^RMPR(660,RMPRDA,"LB")) D
"RTN","RMPOPAT3",70,0)
 .N DIC,DIQ,DR,L19,DA
"RTN","RMPOPAT3",71,0)
 .S (DA,RMPRLA)=$P(^RMPR(660,RMPRDA,"LB"),U,10)
"RTN","RMPOPAT3",72,0)
 .Q:DA=""
"RTN","RMPOPAT3",73,0)
 .S DIC=664.1,DIQ="L19",DR="15",DIQ(0)="E"
"RTN","RMPOPAT3",74,0)
 .D EN^DIQ1
"RTN","RMPOPAT3",75,0)
 .W !,"WORK ORDER: ",$G(R19(660,RMPRDA,71,"E"))
"RTN","RMPOPAT3",76,0)
 .W ?40,"RECEIVING STATION: ",$G(R19(660,RMPRDA,70,"E"))
"RTN","RMPOPAT3",77,0)
 .W !,"TECHNICIAN: ",$G(L19(664.1,RMPRLA,15,"E"))
"RTN","RMPOPAT3",78,0)
 .W !,"TOTAL LABOR HOURS: ",$G(R19(660,RMPRDA,45,"E"))
"RTN","RMPOPAT3",79,0)
 .W ?40,"TOTAL LABOR COST: ",$G(R19(660,RMPRDA,46,"E"))
"RTN","RMPOPAT3",80,0)
 .W !,"TOTAL MATERIAL COST: ",$G(R19(660,RMPRDA,47,"E"))
"RTN","RMPOPAT3",81,0)
 .W ?40,"TOTAL LAB COST: ",$G(R19(660,RMPRDA,48,"E"))
"RTN","RMPOPAT3",82,0)
 .W !,"COMPLETION DATE: ",$G(R19(660,RMPRDA,50,"E"))
"RTN","RMPOPAT3",83,0)
 .W ?40,"LAB REMARKS: ",$G(R19(660,RMPRDA,51,"E"))
"RTN","RMPOPAT3",84,0)
 W !,"REMARKS: ",?15,$G(R19(660,RMPRDA,16,"E"))
"RTN","RMPOPAT3",85,0)
 I $G(R19(660,RMPRDA,17.5,"E")) W ?40,"RETURN STATUS: ",R19(660,RMPRDA,17.5,"E")
"RTN","RMPOPAT3",86,0)
 ;
"RTN","RMPOPAT3",87,0)
 ;historical data
"RTN","RMPOPAT3",88,0)
 I $G(R19(660,RMPRDA,15,"E"))["*" D
"RTN","RMPOPAT3",89,0)
 .;include records that have been merged
"RTN","RMPOPAT3",90,0)
 .W !!,"HISTORICAL DATA",!
"RTN","RMPOPAT3",91,0)
 .Q:'$D(R19(660,RMPRDA,89))
"RTN","RMPOPAT3",92,0)
 .W !,?15,"ITEM: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPOPAT3",93,0)
 .W !,?15,"STATION: ",$G(R19(660,RMPRDA,90,"E"))
"RTN","RMPOPAT3",94,0)
 .W !,?15,"VENDOR: ",$G(R19(660,RMPRDA,91,"E"))
"RTN","RMPOPAT3",95,0)
 .W !,?23,$G(R19(660,RMPRDA,93,"E")),!,?23,$G(R19(660,RMPRDA,94,"E"))
"RTN","RMPOPAT3",96,0)
 .W "   ",$G(R19(660,RMPRDA,95,"E")),"  ",$G(R19(660,RMPRDA,96,"E"))
"RTN","RMPOPAT3",97,0)
 ;put in lab display here fields 45,46,47,48 and 51
"RTN","RMPOPAT3",98,0)
 ;lab amis
"RTN","RMPOPAT3",99,0)
 I $G(R19(660,RMPRDA,73,"E")) D
"RTN","RMPOPAT3",100,0)
 .W ?40,"ORTHOTICS LAB CODE: "
"RTN","RMPOPAT3",101,0)
 .W $S($D(R19(660,RMPRDA,74,"E")):R19(660,RMPRDA,74,"E"),$D(R19(660,RMPRDA,75,"E")):R19(660,RMPRDA,75,"E"),1:"")
"RTN","RMPOPAT3",102,0)
 .W !?40,"RESTORATIONS LAB CODE: "
"RTN","RMPOPAT3",103,0)
 .W $S($D(R19(660,RMPRDA,76,"E")):R19(660,RMPRDA,76,"E"),$D(R19(660,RMPRDA,77,"E")):R19(660,RMPRDA,77,"E"),1:"")
"RTN","RMPOPAT3",104,0)
 ;purchasing and issue from stock amis
"RTN","RMPOPAT3",105,0)
 W !,"DISABILITY SERVED: ",$G(R19(660,RMPRDA,62,"E"))
"RTN","RMPOPAT3",106,0)
 ;appliance/item information
"RTN","RMPOPAT3",107,0)
 W !,"APPLIANCE: ",$G(R19(660,RMPRDA,4,"E"))
"RTN","RMPOPAT3",108,0)
 W !,"PSAS HCPCS: ",$G(R19(660,RMPRDA,4.5,"E"))
"RTN","RMPOPAT3",109,0)
 I $P($G(^RMPR(660,RMPRDA,1)),U,4) W ?22,$P($G(^RMPR(661.1,$P(^RMPR(660,RMPRDA,1),U,4),0)),U,2)
"RTN","RMPOPAT3",110,0)
 ;added by #69
"RTN","RMPOPAT3",111,0)
 ;
"RTN","RMPOPAT3",112,0)
 ; PATCH 92 - Code Set Versioning (CSV) changes below
"RTN","RMPOPAT3",113,0)
 ; AAC-08/03/04
"RTN","RMPOPAT3",114,0)
 ;
"RTN","RMPOPAT3",115,0)
 S (RMPRICD,RMPRIC9,RMPRCOD)="" S RMPRERR=0
"RTN","RMPOPAT3",116,0)
 S RMPRDAT=$P($G(^RMPR(660,RMPRDA,0)),U,1)
"RTN","RMPOPAT3",117,0)
 I $D(^RMPR(660,RMPRDA,10)) S RMPRIC9=$P(^RMPR(660,RMPRDA,10),U,8)
"RTN","RMPOPAT3",118,0)
 I RMPRIC9'=""  D
"RTN","RMPOPAT3",119,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPOPAT3",120,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPOPAT3",121,0)
 .I RMPRERR<0 W !,"ICD-9 Message: ",$P(RMPRICD,U,2)
"RTN","RMPOPAT3",122,0)
 W !,"ICD-9 Code: "
"RTN","RMPOPAT3",123,0)
 I $G(RMPRICD)'="" W $P(RMPRICD,U,2),?19,$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 W " ","** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT W Y
"RTN","RMPOPAT3",124,0)
 ;
"RTN","RMPOPAT3",125,0)
 ; End Patch 92
"RTN","RMPOPAT3",126,0)
 ;
"RTN","RMPOPAT3",127,0)
 W !,"CPT MODIFIER: ",$G(R19(660,RMPRDA,4.7,"E"))
"RTN","RMPOPAT3",128,0)
 W !,"DESCRIPTION: ",$G(R19(660,RMPRDA,24,"E"))
"RTN","RMPOPAT3",129,0)
 W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPOPAT3",130,0)
 I $D(R19(660,RMPRDA,28)) D  G:$D(DUOUT)!$D(DTOUT) EX1
"RTN","RMPOPAT3",131,0)
 .N R28
"RTN","RMPOPAT3",132,0)
 .;command part of new standards
"RTN","RMPOPAT3",133,0)
 .MERGE R28=R19(660,RMPRDA,28)
"RTN","RMPOPAT3",134,0)
 .I $P($G(^RMPR(660,RMPRDA,"DES",0)),U,3)>1 N DIR S DIR(0)="E" D ^DIR Q:$D(DUOUT)!$D(DTOUT)  D HDR W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPOPAT3",135,0)
 .D EN^DDIOL(.R28)
"RTN","RMPOPAT3",136,0)
 ;NPPD key items consolidated, example L5300 limb order
"RTN","RMPOPAT3",137,0)
 I $P(IT(AN),U,3) W !!,"*** Return For DETAIL REPORT ***" N DIR S DIR(0)="E" D ^DIR G:$D(DUOUT)!$D(DTOUT) EX1  W @IOF D HDR,^RMPRPAT7
"RTN","RMPOPAT3",138,0)
 ;display work order if it is a 2529-3 form
"RTN","RMPOPAT3",139,0)
 ;must pass ien to file 664.1 NOT 664.2
"RTN","RMPOPAT3",140,0)
 I $G(R19(660,RMPRDA,72,"I"))'="" D  G EX1
"RTN","RMPOPAT3",141,0)
 .S DIR(0)="E" D ^DIR Q:$D(DTOUT)!$D(DUOUT)
"RTN","RMPOPAT3",142,0)
 .S RMPRBCK=RMPRDA
"RTN","RMPOPAT3",143,0)
 .N DIC
"RTN","RMPOPAT3",144,0)
 .S RMPRDA=R19(660,RMPRBCK,72,"I")
"RTN","RMPOPAT3",145,0)
 .D DISP^RMPR293(RMPRDA)
"RTN","RMPOPAT3",146,0)
 .S RMPRDA=RMPRBCK K RMPRBCK
"RTN","RMPOPAT3",147,0)
 ;return from work order
"RTN","RMPOPAT3",148,0)
 G EXIT
"RTN","RMPOPAT3",149,0)
 ;
"RTN","RMPOPAT3",150,0)
HDR ;display heading
"RTN","RMPOPAT3",151,0)
 W @IOF,RMPRNAM,?30," SSN: "
"RTN","RMPOPAT3",152,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10),?50
"RTN","RMPOPAT3",153,0)
 W $G(R19(660,RMPRDA,8,"E")),?70,"DOB: "
"RTN","RMPOPAT3",154,0)
 W $S(RMPRDOB:$E(RMPRDOB,4,5)_"-"_$E(RMPRDOB,6,7)_"-"_(1700+$E(RMPRDOB,1,3)),1:"Unknown")
"RTN","RMPOPAT3",155,0)
 W !?20,"APPLIANCE/REPAIR LINE ITEM DETAIL ",?70,"<4-",ANS,">",!
"RTN","RMPOPAT3",156,0)
 Q
"RTN","RMPOPAT3",157,0)
EXIT ;common exit point
"RTN","RMPOPAT3",158,0)
 I $Y>(IOSL-4) F  W ! Q:$Y>(IOSL-3)
"RTN","RMPOPAT3",159,0)
 N DIR S DIR(0)="E" D ^DIR
"RTN","RMPOPAT3",160,0)
 S RMOXY=Y
"RTN","RMPOPAT3",161,0)
 ;duout,dtout is evaluated in dis+1^rmpopat2
"RTN","RMPOPAT3",162,0)
EX1 ;back out through that point to clean up
"RTN","RMPOPAT3",163,0)
 K R19,RV,RMPRICC,RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT,RMPRERR,Y W @IOF
"RTN","RMPOPAT3",164,0)
 Q
"RTN","RMPOPAT3",165,0)
 ;end
"RTN","RMPR9S4E")
0^5^B41504578
"RTN","RMPR9S4E",1,0)
RMPR9S4E ;HOIFO/SPS-GUI 2319 Extended Display Transaction screen 4 ;12/17/02  09:35
"RTN","RMPR9S4E",2,0)
 ;;3.0;PROSTHETICS;**59,92**;Feb 09, 1996
"RTN","RMPR9S4E",3,0)
 ;
"RTN","RMPR9S4E",4,0)
 ;         (IEN)=ien of file 660
"RTN","RMPR9S4E",5,0)
 ;
"RTN","RMPR9S4E",6,0)
 ;AAC Patch 92 08/04/04 - Code Set Versioning (CSV)
"RTN","RMPR9S4E",7,0)
 ;Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80)
"RTN","RMPR9S4E",8,0)
 ;
"RTN","RMPR9S4E",9,0)
 ;DBIA # 3990 - for routine ICDDX^ICDCODE for Patch 92
"RTN","RMPR9S4E",10,0)
 ;
"RTN","RMPR9S4E",11,0)
 ;display detailed record
"RTN","RMPR9S4E",12,0)
A1(IEN) G A2
"RTN","RMPR9S4E",13,0)
EN(RESULTS,IEN) ;Broker
"RTN","RMPR9S4E",14,0)
A2 ;
"RTN","RMPR9S4E",15,0)
 I +IEN'>0 S RESULTS(0)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S4E",16,0)
 I '$D(^RMPR(660,IEN)) S RESULTS(0)="NOTHING TO REPORT" G EXIT
"RTN","RMPR9S4E",17,0)
 N DIC,DIQ,DR,DA,RMPRV,RMPRDA,RV
"RTN","RMPR9S4E",18,0)
 S DIC=660,DIQ="R19",DR=".01:96",DIQ(0)="EN"
"RTN","RMPR9S4E",19,0)
 S (RMPRDA,DA)=(IEN)
"RTN","RMPR9S4E",20,0)
 D EN^DIQ1
"RTN","RMPR9S4E",21,0)
 S DIQ="R19",DR=72,DIQ(0)="I" D EN^DIQ1
"RTN","RMPR9S4E",22,0)
 ;get vendor info
"RTN","RMPR9S4E",23,0)
 S DA=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPR9S4E",24,0)
 I DA D
"RTN","RMPR9S4E",25,0)
 .S DIC=440,DIQ="RV",DR=".01:6",DIQ(0)="EN"
"RTN","RMPR9S4E",26,0)
 .S (RMPRV,DA)=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPR9S4E",27,0)
 .D EN^DIQ1
"RTN","RMPR9S4E",28,0)
 ;
"RTN","RMPR9S4E",29,0)
 ;array defined for record in following format:
"RTN","RMPR9S4E",30,0)
 ;R19(filenumber,ien,field,E)=external form of data
"RTN","RMPR9S4E",31,0)
 ;RV(filenumber,ien,field,E)=external form of data
"RTN","RMPR9S4E",32,0)
 ;example:
"RTN","RMPR9S4E",33,0)
 ;R19(660,100,.01,"E")=APR 27, 1995
"RTN","RMPR9S4E",34,0)
 ;R19(660,100,.02,"E")=NAME,PATIENT
"RTN","RMPR9S4E",35,0)
 ;RV(440,131,.01,"E")=ORTHOTIC LAB
"RTN","RMPR9S4E",36,0)
 S RMPRDFN=$P(^RMPR(660,RMPRDA,0),U,2)
"RTN","RMPR9S4E",37,0)
 S RMPRNAM=$P(^DPT(RMPRDFN,0),U),RMPRSSN=$P(^(0),U,9),RMPRDOB=$P(^(0),U,3)
"RTN","RMPR9S4E",38,0)
 ;
"RTN","RMPR9S4E",39,0)
 D HDR
"RTN","RMPR9S4E",40,0)
 ; "TYPE OF FORM: ",
"RTN","RMPR9S4E",41,0)
 S RESULTS(5)=$G(R19(660,RMPRDA,11,"E"))
"RTN","RMPR9S4E",42,0)
 ; "INITIATOR: ",
"RTN","RMPR9S4E",43,0)
 S RESULTS(6)=$G(R19(660,RMPRDA,27,"E"))
"RTN","RMPR9S4E",44,0)
 ; "DATE: ",
"RTN","RMPR9S4E",45,0)
 S RESULTS(7)=$G(R19(660,RMPRDA,1,"E"))
"RTN","RMPR9S4E",46,0)
 ; "DELIVER TO: ",
"RTN","RMPR9S4E",47,0)
 S RESULTS(8)=$G(R19(660,RMPRDA,25,"E"))
"RTN","RMPR9S4E",48,0)
 ; "TYPE TRANS: ",
"RTN","RMPR9S4E",49,0)
 S RESULTS(9)=$G(R19(660,RMPRDA,2,"E"))
"RTN","RMPR9S4E",50,0)
 ; "QTY: ",
"RTN","RMPR9S4E",51,0)
 S RESULTS(10)=$G(R19(660,RMPRDA,5,"E"))
"RTN","RMPR9S4E",52,0)
 ; "INVENTORY POINT: "
"RTN","RMPR9S4E",53,0)
 S RESULTS(11)=$G(R19(660,RMPRDA,29,"E"))
"RTN","RMPR9S4E",54,0)
 ; "SOURCE: ",
"RTN","RMPR9S4E",55,0)
 S RESULTS(12)=$G(R19(660,RMPRDA,12,"E"))
"RTN","RMPR9S4E",56,0)
 ;vendor tracking number
"RTN","RMPR9S4E",57,0)
 S (RESULTS(13),RESULTS(14))=""
"RTN","RMPR9S4E",58,0)
 I $G(R19(660,RMPRDA,11,"E"))="VISA" D
"RTN","RMPR9S4E",59,0)
 .; "VENDOR TRACKING: ",
"RTN","RMPR9S4E",60,0)
 .S RESULTS(13)=$G(R19(660,RMPRDA,4.2,"E"))
"RTN","RMPR9S4E",61,0)
 .; "BANK AUTHORIZATION: ",
"RTN","RMPR9S4E",62,0)
 .S RESULTS(14)=$G(R19(660,RMPRDA,4.3,"E"))
"RTN","RMPR9S4E",63,0)
 ; "VENDOR: ",
"RTN","RMPR9S4E",64,0)
 S RESULTS(15)=$G(R19(660,RMPRDA,7,"E"))
"RTN","RMPR9S4E",65,0)
 ; VENDOR PHONE AND ADDRESS INFO
"RTN","RMPR9S4E",66,0)
 F I=16:1:20 S RESULTS(I)=""
"RTN","RMPR9S4E",67,0)
 I $D(RV) D
"RTN","RMPR9S4E",68,0)
 .; "VENDOR PHONE: and Address ",
"RTN","RMPR9S4E",69,0)
 .S RESULTS(16)=$G(RV(440,RMPRV,5,"E"))
"RTN","RMPR9S4E",70,0)
 .S RESULTS(17)=$G(RV(440,RMPRV,1,"E"))
"RTN","RMPR9S4E",71,0)
 .S RESULTS(18)=$G(RV(440,RMPRV,4.2,"E"))
"RTN","RMPR9S4E",72,0)
 .S RESULTS(19)=$G(RV(440,RMPRV,4.4,"E"))
"RTN","RMPR9S4E",73,0)
 .S RESULTS(20)=$G(RV(440,RMPRV,4.6,"E"))
"RTN","RMPR9S4E",74,0)
 ; "DELIVERY DATE: "
"RTN","RMPR9S4E",75,0)
 S RESULTS(21)=$G(R19(660,RMPRDA,10,"E"))
"RTN","RMPR9S4E",76,0)
 ; "TOTAL COST: "
"RTN","RMPR9S4E",77,0)
 S RESULTS(22)=0.00
"RTN","RMPR9S4E",78,0)
 I $G(R19(660,RMPRDA,14,"E"))'="" S RESULTS(22)="$"_$FN(R19(660,RMPRDA,14,"E"),"T",2)
"RTN","RMPR9S4E",79,0)
 I $G(R19(660,RMPRDA,14,"E"))="" S RESULTS(22)=$S($G(R19(660,RMPRDA,6,"E"))'="":"$"_$FN(R19(660,RMPRDA,6,"E"),"T",2),$G(R19(660,RMPRDA,48,"E"))'="":"$"_$FN(R19(660,RMPRDA,48,"E"),"T",2),1:"")
"RTN","RMPR9S4E",80,0)
 ; "OBL: ",
"RTN","RMPR9S4E",81,0)
 S RESULTS(23)=$G(R19(660,RMPRDA,23,"E"))
"RTN","RMPR9S4E",82,0)
 ;
"RTN","RMPR9S4E",83,0)
 ;lab data
"RTN","RMPR9S4E",84,0)
 F I=24:1:32 S RESULTS(I)=""
"RTN","RMPR9S4E",85,0)
 I $D(^RMPR(660,RMPRDA,"LB")) D
"RTN","RMPR9S4E",86,0)
 .N DIC,DIQ,DR,L19,DA
"RTN","RMPR9S4E",87,0)
 .S (DA,RMPRLA)=$P(^RMPR(660,RMPRDA,"LB"),U,10)
"RTN","RMPR9S4E",88,0)
 .Q:DA=""
"RTN","RMPR9S4E",89,0)
 .S DIC=664.1,DIQ="L19",DR="15",DIQ(0)="E"
"RTN","RMPR9S4E",90,0)
 .D EN^DIQ1
"RTN","RMPR9S4E",91,0)
 .; "WORK ORDER: ",
"RTN","RMPR9S4E",92,0)
 .S RESULTS(24)=$G(R19(660,RMPRDA,71,"E"))
"RTN","RMPR9S4E",93,0)
 .; "RECEIVING STATION: ",
"RTN","RMPR9S4E",94,0)
 .S RESULTS(25)=$G(R19(660,RMPRDA,70,"E"))
"RTN","RMPR9S4E",95,0)
 .; "TECHNICIAN: ",
"RTN","RMPR9S4E",96,0)
 .S RESULTS(26)=$G(L19(664.1,RMPRLA,15,"E"))
"RTN","RMPR9S4E",97,0)
 .; "TOTAL LABOR HOURS: ",
"RTN","RMPR9S4E",98,0)
 .S RESULTS(27)=$G(R19(660,RMPRDA,45,"E"))
"RTN","RMPR9S4E",99,0)
 .; "TOTAL LABOR COST: ",
"RTN","RMPR9S4E",100,0)
 .S RESULTS(28)=$G(R19(660,RMPRDA,46,"E"))
"RTN","RMPR9S4E",101,0)
 .; "TOTAL MATERIAL COST: ",
"RTN","RMPR9S4E",102,0)
 .S RESULTS(29)=$G(R19(660,RMPRDA,47,"E"))
"RTN","RMPR9S4E",103,0)
 .; "TOTAL LAB COST: ",
"RTN","RMPR9S4E",104,0)
 .S RESULTS(30)=$G(R19(660,RMPRDA,48,"E"))
"RTN","RMPR9S4E",105,0)
 .; "COMPLETION DATE: ",
"RTN","RMPR9S4E",106,0)
 .S RESULTS(31)=$G(R19(660,RMPRDA,50,"E"))
"RTN","RMPR9S4E",107,0)
 .; "LAB REMARKS: ",
"RTN","RMPR9S4E",108,0)
 .S RESULTS(32)=$G(R19(660,RMPRDA,51,"E"))
"RTN","RMPR9S4E",109,0)
 ; "REMARKS: ",
"RTN","RMPR9S4E",110,0)
 S RESULTS(33)=$G(R19(660,RMPRDA,16,"E"))
"RTN","RMPR9S4E",111,0)
 ; "RETURN STATUS: ",
"RTN","RMPR9S4E",112,0)
 S RESULTS(34)=$G(R19(660,RMPRDA,17.5,"E"))
"RTN","RMPR9S4E",113,0)
 ;
"RTN","RMPR9S4E",114,0)
 ; CoreFLS Data used to be/and same as historical data
"RTN","RMPR9S4E",115,0)
 F I=35:1:42 S RESULTS(I)=""
"RTN","RMPR9S4E",116,0)
 I $G(R19(660,RMPRDA,15,"E"))["*" D
"RTN","RMPR9S4E",117,0)
 .;include records that have been merged
"RTN","RMPR9S4E",118,0)
 .; "COREFLS/HISTORICAL DATA",!
"RTN","RMPR9S4E",119,0)
 .Q:'$D(R19(660,RMPRDA,89))
"RTN","RMPR9S4E",120,0)
 .; "ITEM: ",
"RTN","RMPR9S4E",121,0)
 .S RESULTS(35)=$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPR9S4E",122,0)
 .; "STATION: ",
"RTN","RMPR9S4E",123,0)
 .S RESULTS(36)=$G(R19(660,RMPRDA,90,"E"))
"RTN","RMPR9S4E",124,0)
 .; "VENDOR: ",
"RTN","RMPR9S4E",125,0)
 .S RESULTS(37)=$G(R19(660,RMPRDA,91,"E"))
"RTN","RMPR9S4E",126,0)
 .; "   PHONE: ",
"RTN","RMPR9S4E",127,0)
 .S RESULTS(38)=$G(R19(660,RMPRDA,92,"E"))
"RTN","RMPR9S4E",128,0)
 .; " STREET
"RTN","RMPR9S4E",129,0)
 .S RESULTS(39)=$G(R19(660,RMPRDA,93,"E"))
"RTN","RMPR9S4E",130,0)
 .; CITY
"RTN","RMPR9S4E",131,0)
 .S RESULTS(40)=$G(R19(660,RMPRDA,94,"E"))
"RTN","RMPR9S4E",132,0)
 .; STATE
"RTN","RMPR9S4E",133,0)
 .S RESULTS(41)=$G(R19(660,RMPRDA,95,"E"))
"RTN","RMPR9S4E",134,0)
 .; ZIP
"RTN","RMPR9S4E",135,0)
 .S RESULTS(42)=$G(R19(660,RMPRDA,96,"E"))
"RTN","RMPR9S4E",136,0)
 ;put in lab display here fields 45,46,47,48 and 51
"RTN","RMPR9S4E",137,0)
 ;lab amis
"RTN","RMPR9S4E",138,0)
 F I=43:1:44 S RESULTS(I)=""
"RTN","RMPR9S4E",139,0)
 I $G(R19(660,RMPRDA,73,"E")) D
"RTN","RMPR9S4E",140,0)
 .; "ORTHOTICS LAB CODE: "
"RTN","RMPR9S4E",141,0)
 .S RESULTS(43)=$S($D(R19(660,RMPRDA,74,"E")):R19(660,RMPRDA,74,"E"),$D(R19(660,RMPRDA,75,"E")):R19(660,RMPRDA,75,"E"),1:"")
"RTN","RMPR9S4E",142,0)
 .; "RESTORATIONS LAB CODE: "
"RTN","RMPR9S4E",143,0)
 .S RESULTS(44)=$S($D(R19(660,RMPRDA,76,"E")):R19(660,RMPRDA,76,"E"),$D(R19(660,RMPRDA,77,"E")):R19(660,RMPRDA,77,"E"),1:"")
"RTN","RMPR9S4E",144,0)
 ;purchasing and issue from stock amis
"RTN","RMPR9S4E",145,0)
 ; "DISABILITY SERVED: ",
"RTN","RMPR9S4E",146,0)
 S RESULTS(45)=$G(R19(660,RMPRDA,62,"E"))
"RTN","RMPR9S4E",147,0)
 ;appliance/item information
"RTN","RMPR9S4E",148,0)
 ; "APPLIANCE: ",
"RTN","RMPR9S4E",149,0)
 S RESULTS(46)=$G(R19(660,RMPRDA,4,"E"))
"RTN","RMPR9S4E",150,0)
 ; "PSAS HCPCS: ",
"RTN","RMPR9S4E",151,0)
 S RESULTS(47)=$G(R19(660,RMPRDA,4.5,"E"))
"RTN","RMPR9S4E",152,0)
 ; "PSAS HCPCS DESC.
"RTN","RMPR9S4E",153,0)
 S RESULTS(48)=""
"RTN","RMPR9S4E",154,0)
 I $P($G(^RMPR(660,RMPRDA,1)),U,4) S RESULTS(48)=$P($G(^RMPR(661.1,$P(^RMPR(660,RMPRDA,1),U,4),0)),U,2)
"RTN","RMPR9S4E",155,0)
 ;added by #69
"RTN","RMPR9S4E",156,0)
 ;
"RTN","RMPR9S4E",157,0)
 ; Patch 92 - Code Set Versioning (CSV) changes below inserted afer the line above for #69
"RTN","RMPR9S4E",158,0)
 ; AAC - 08/04/04
"RTN","RMPR9S4E",159,0)
 ;
"RTN","RMPR9S4E",160,0)
 S (RMPRICD,RMPRIC0,RMPRCOD,RMPRIC9,RESULTS(49))="" S RMPRERR=0
"RTN","RMPR9S4E",161,0)
 S RMPRDAT=$G(R19(660,RMPRDA,.01,"E"))
"RTN","RMPR9S4E",162,0)
 I $D(^RMPR(660,RMPRDA,10)) S RMPRIC9=$P(^RMPR(660,RMPRDA,10),U,8)
"RTN","RMPR9S4E",163,0)
 I RMPRIC9'=""  D
"RTN","RMPR9S4E",164,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPR9S4E",165,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPR9S4E",166,0)
 .I RMPRERR<0 S RESULTS(49)=$P(RMPRICD,U,2)
"RTN","RMPR9S4E",167,0)
ZZ ;
"RTN","RMPR9S4E",168,0)
 I RMPRERR>0 S RESULTS(49)=$P(RMPRICD,U,2)_" "_$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 S RESULTS(49)=RESULTS(49)_" "_"** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT S RESULTS(49)=RESULTS(49)_" "_Y
"RTN","RMPR9S4E",169,0)
 ; "ICD-9 Code: ",
"RTN","RMPR9S4E",170,0)
 ; S RESULTS(49)=RMPRICC_"    "_$E($G(^ICD9(RMPRIC9,1)),1,55)
"RTN","RMPR9S4E",171,0)
 ;
"RTN","RMPR9S4E",172,0)
 ; End Patch 92
"RTN","RMPR9S4E",173,0)
 ;
"RTN","RMPR9S4E",174,0)
 ; "CPT MODIFIER: ",
"RTN","RMPR9S4E",175,0)
 S RESULTS(50)=$G(R19(660,RMPRDA,4.7,"E"))
"RTN","RMPR9S4E",176,0)
 ; "DESCRIPTION: ",
"RTN","RMPR9S4E",177,0)
 S RESULTS(51)=$G(R19(660,RMPRDA,24,"E"))
"RTN","RMPR9S4E",178,0)
 ; ,"EXTENDED DESCRIPTION: ",!
"RTN","RMPR9S4E",179,0)
 N R28
"RTN","RMPR9S4E",180,0)
 I $D(R19(660,RMPRDA,28)) D
"RTN","RMPR9S4E",181,0)
 .;command part of new standards
"RTN","RMPR9S4E",182,0)
 .MERGE R28=R19(660,RMPRDA,28)
"RTN","RMPR9S4E",183,0)
 S LN=0,CNT=52
"RTN","RMPR9S4E",184,0)
 F  S LN=$O(R28(LN)) Q:LN'>0  D
"RTN","RMPR9S4E",185,0)
 .S RESULTS(CNT)=R28(LN)
"RTN","RMPR9S4E",186,0)
 .S CNT=CNT+1
"RTN","RMPR9S4E",187,0)
 G EXIT
"RTN","RMPR9S4E",188,0)
 ;
"RTN","RMPR9S4E",189,0)
HDR ;display heading
"RTN","RMPR9S4E",190,0)
 S RESULTS(1)=RMPRNAM
"RTN","RMPR9S4E",191,0)
 ; " SSN: "
"RTN","RMPR9S4E",192,0)
 S RESULTS(2)=$E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10)
"RTN","RMPR9S4E",193,0)
 S RESULTS(3)=$G(R19(660,RMPRDA,8,"E"))
"RTN","RMPR9S4E",194,0)
 ; "DOB: "
"RTN","RMPR9S4E",195,0)
 S RESULTS(4)=$S(RMPRDOB:$E(RMPRDOB,4,5)_"-"_$E(RMPRDOB,6,7)_"-"_(1700+$E(RMPRDOB,1,3)),1:"Unknown")
"RTN","RMPR9S4E",196,0)
 Q
"RTN","RMPR9S4E",197,0)
EXIT ;common exit point
"RTN","RMPR9S4E",198,0)
 I '$D(RESULTS) S RESULTS(0)="NOTHING TO REPORT"
"RTN","RMPR9S4E",199,0)
 K R19,RV,RMPRICC,RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT,RMPRERR,RMPRIC0,Y
"RTN","RMPR9S4E",200,0)
 Q
"RTN","RMPR9S4E",201,0)
 ;end
"RTN","RMPRBIL")
0^1^B36019778
"RTN","RMPRBIL",1,0)
RMPRBIL ;PHX/RFM/JLT-PROSTHETIC BILLINGS ;8/29/1994
"RTN","RMPRBIL",2,0)
 ;;3.0;PROSTHETICS;**44,55,69,86,92**;Feb 09, 1996
"RTN","RMPRBIL",3,0)
 ;
"RTN","RMPRBIL",4,0)
 ;WLC 3/02/2004 patch #86 - Encapsulation of IB
"RTN","RMPRBIL",5,0)
 ;
"RTN","RMPRBIL",6,0)
 ;RVD 4/29/02 patch #69 - add HCPCS and Short Description in the report.
"RTN","RMPRBIL",7,0)
 ;                        add ICD-9 and description.
"RTN","RMPRBIL",8,0)
 ;                        screen report for station.
"RTN","RMPRBIL",9,0)
 ;
"RTN","RMPRBIL",10,0)
 ;AAC 08/04/04 Patch 92 - Code Set Versioning (CSV)
"RTN","RMPRBIL",11,0)
 ;                      - Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80)
"RTN","RMPRBIL",12,0)
 ;
"RTN","RMPRBIL",13,0)
 ;DBIA # 3990 - for routine ICDDX^ICDCODE for Patch 92
"RTN","RMPRBIL",14,0)
 ;DBIA # 3823 - for routine INSUR^IBBAPI for Patch 92
"RTN","RMPRBIL",15,0)
 ;
"RTN","RMPRBIL",16,0)
 K ^TMP($J)
"RTN","RMPRBIL",17,0)
 N RMI,HDR2 S HDR2=0
"RTN","RMPRBIL",18,0)
 D HOME^%ZIS,DIV4^RMPRSIT G:$D(X) EXIT W !! S %DT("A")="Start With Delivery Date: ",%DT="AEPX" D ^%DT S RMPRBDT=Y G:Y<0 EXIT
"RTN","RMPRBIL",19,0)
 S %DT("A")="End With Delivery Date: ",%DT="AEX" D ^%DT I RMPRBDT>Y W !,$C(7),"Invalid Date Range Selection!!" G RMPRBIL
"RTN","RMPRBIL",20,0)
 S RMPREDT=Y G:Y<0 EXIT S Y=RMPRBDT D DD^%DT S RMPRX=Y,Y=RMPREDT D DD^%DT S RMPRY=Y
"RTN","RMPRBIL",21,0)
 S %ZIS="MQ" K IOP D ^%ZIS G:POP EXIT
"RTN","RMPRBIL",22,0)
 I '$D(IO("Q")) U IO G PRINT
"RTN","RMPRBIL",23,0)
 K IO("Q") S ZTRTN="PRINT^RMPRBIL",ZTIO=ION,ZTSAVE("RMPRBDT")="",ZTSAVE("RMPREDT")="",ZTSAVE("RMPRX")="",ZTSAVE("RMPRY")="",ZTSAVE("RMPR(""STA"")")="",ZTDESC="PRINT MAS BILLING" D ^%ZTLOAD W:$D(ZTSK) !,"REQUEST QUEUED!" H 1 G EXIT
"RTN","RMPRBIL",24,0)
PRINT S X1=RMPRBDT,X2=-1 D C^%DTC S RO=X,RP=0,PAGE=1,RMPRCOUN=0 I IOST["C-" D WAIT^DICD W !,"...PREPARING TO PRINT PROSTHETIC BILLING..." H 1
"RTN","RMPRBIL",25,0)
 F  S RO=$O(^RMPR(660,"CT",RO)) Q:RO'>0!(RO>RMPREDT)  F  S RP=$O(^RMPR(660,"CT",RO,RP)) Q:RP'>0  D CK
"RTN","RMPRBIL",26,0)
 S RMPT="",RMPREND="" F  S FL=1 S RMPT=$O(^TMP($J,RMPT)) Q:RMPT=""!(RMPREND=1)  F RP=0:0 S RP=$O(^TMP($J,RMPT,RP)) Q:RMPREND=1!(RP'>0)  D WRI
"RTN","RMPRBIL",27,0)
 I $D(RMPREDT)&(RMPRCOUN=0) W @IOF D HDR W !!,"NO SELECTIONS MADE DURING THIS DATE RANGE!!"
"RTN","RMPRBIL",28,0)
 I $D(RMPREDT),RMPRCOUN>0,'$D(RMPREND) W !!?32,"END OF REPORT" H 1
"RTN","RMPRBIL",29,0)
EXIT S:'$D(RMPREND) RMPREND="" I $E(IOST)["C"&($Y<20) F  W ! Q:$Y>20
"RTN","RMPRBIL",30,0)
 I $D(RMPREDT),RMPREND'=1,'$D(DTOUT),'$D(DUOUT),$E(IOST)["C",'$D(RMPRFLL) S DIR(0)="E" D ^DIR
"RTN","RMPRBIL",31,0)
EX K ROI,RMPRFLL,IBINS,J,RMPREND,DFN,DGCRINS,DGCRDD,DGCROUTP,DGCRINDT,DUOUT,DIR,RO,RP,RR,RMPRFLAG,FL,IZ,PAGE,RMPRY,RMPRITEM,RMPRCOUN,RMPRX,RMPRBDT,RMPREDT,RMPT,%DT,X,Y,IT,ZTSK,^TMP($J)
"RTN","RMPRBIL",32,0)
 K RMHCIEN,RMHCPCS,RMHCDES,RMPRICC,RMPRICD,RMPRIC9,RMPRA,RMPRCOD,RMPRDAT,RMPRERR,RMPRERZ
"RTN","RMPRBIL",33,0)
 D ^%ZISC,KVAR^VADPT Q
"RTN","RMPRBIL",34,0)
CK ;
"RTN","RMPRBIL",35,0)
 ; Patch 92 - line below modified from original
"RTN","RMPRBIL",36,0)
 S RMPRERZ=$S('$D(^RMPR(660,RP,"AM")):1,$P(^RMPR(660,RP,0),U,9)="":1,$P(^(0),U,12)="":1,$P(^(0),U,6)="":1,$P(^(0),U,14)="V":1,$P(^(0),U,2)="":1,$P(^(0),U,15)="*":1,$P(^("AM"),U,3)'=4:1,1:0) Q:RMPRERZ'>0
"RTN","RMPRBIL",37,0)
 ;patch #69 (screen for station).
"RTN","RMPRBIL",38,0)
 I $P($G(^RMPR(660,RP,0)),U,10)'=RMPR("STA") Q
"RTN","RMPRBIL",39,0)
 K RMI S DFN=$P(^RMPR(660,RP,0),U,2) K RMI Q:'$$INSUR^IBBAPI(DFN,RO,"RB",.RMI,"*")
"RTN","RMPRBIL",40,0)
 S RMPRCOUN=RMPRCOUN+1,RMPT=$P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,1),^TMP($J,RMPT,RP)=""
"RTN","RMPRBIL",41,0)
 Q
"RTN","RMPRBIL",42,0)
WRI I PAGE=1,'$D(RMPRFLG),$E(IOST)["C" W @IOF D HDR1
"RTN","RMPRBIL",43,0)
 I $Y>(IOSL-8),$E(IOST)["C",$D(RMPRFLAG) W ! S DIR(0)="E" D ^DIR S:Y=""!(Y=0) RMPREND=1 Q:Y=""  S:Y<1 RMPRFLL=1 Q:Y=0  D HDR
"RTN","RMPRBIL",44,0)
 I $Y>(IOSL-8) D HDR
"RTN","RMPRBIL",45,0)
 W ! I FL W !,$E(RMPT,1,20),?22,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,9),6,9) S DFN=$P(^RMPR(660,RP,0),U,2) K RMI S X=$$INSUR^IBBAPI(DFN,,"RBA",.RMI,"*") I X>0 D DISP E  D ERRORD S FL=0 W !!
"RTN","RMPRBIL",46,0)
 S RMPRA=^RMPR(660,RP,0)
"RTN","RMPRBIL",47,0)
 W $$DAT1^RMPRUTL1($P($P(RMPRA,U,1),".",1))
"RTN","RMPRBIL",48,0)
 ;DELIVERY DATE SORT ON CT X-REF
"RTN","RMPRBIL",49,0)
 W ?9,$$DAT1^RMPRUTL1($P($P(RMPRA,U,12),".",1))
"RTN","RMPRBIL",50,0)
 I $P(RMPRA,U,4)="X" W ?17,"*"
"RTN","RMPRBIL",51,0)
 ;
"RTN","RMPRBIL",52,0)
ITE ;
"RTN","RMPRBIL",53,0)
 ;added by patch #69
"RTN","RMPRBIL",54,0)
HCPCS S (RMHCPCS,RMHCDES)="" K RMHCIEN
"RTN","RMPRBIL",55,0)
 I $D(^RMPR(660,RP,1)) S RMHCIEN=$P(^RMPR(660,RP,1),U,4) D
"RTN","RMPRBIL",56,0)
 .I $G(RMHCIEN) S RMHCPCS=$P($G(^RMPR(661.1,RMHCIEN,0)),U,1),RMHCDES=$P($G(^RMPR(661.1,RMHCIEN,0)),U,2)
"RTN","RMPRBIL",57,0)
 ;
"RTN","RMPRBIL",58,0)
 ; Patch 92 - Code Set Versioning changes below
"RTN","RMPRBIL",59,0)
 ; AAC - 08/04/04
"RTN","RMPRBIL",60,0)
 ;
"RTN","RMPRBIL",61,0)
ICD9 ;
"RTN","RMPRBIL",62,0)
 I $P(^RMPR(660,RP,0),U,4)'="X" D
"RTN","RMPRBIL",63,0)
 .W ?19,$E($P(^PRC(441,$P(^RMPR(661,$P(^RMPR(660,RP,0),U,6),0),U,1),0),U,2),1,30)
"RTN","RMPRBIL",64,0)
 .W ?52,"QTY: ",$P(^RMPR(660,RP,0),U,7),?59,"TOTAL COST: ",?70,$J($FN($P(^RMPR(660,RP,0),U,16),"P",2),9)
"RTN","RMPRBIL",65,0)
 .W !,"HCPCS: ",RMHCPCS,?19,RMHCDES
"RTN","RMPRBIL",66,0)
 .;
"RTN","RMPRBIL",67,0)
 E  D
"RTN","RMPRBIL",68,0)
 .S RMPRITEM=$E($P(^PRC(441,$P(^RMPR(661,$P(^RMPR(660,RP,0),U,6),0),U,1),0),U,2),1,30)
"RTN","RMPRBIL",69,0)
 .I $D(^RMPR(660,RP,1)) W ?19,$E($P(^(1),U,2),1,30)
"RTN","RMPRBIL",70,0)
 .I $D(^RMPR(660,RP,1)),$P(^(1),U,2)="" W ?19,RMPRITEM
"RTN","RMPRBIL",71,0)
 .W ?52,"QTY: ",$P(^RMPR(660,RP,0),U,7),?59,"TOTAL COST: ",?70,$J($FN($P(^RMPR(660,RP,0),U,16),"P",2),9)
"RTN","RMPRBIL",72,0)
 .I '$D(^RMPR(660,RP,1)) W ?19,RMPRITEM
"RTN","RMPRBIL",73,0)
 .W !,"HCPCS: ",RMHCPCS,?19,RMHCDES
"RTN","RMPRBIL",74,0)
 ;
"RTN","RMPRBIL",75,0)
 S (RMPRICD,RMPRIC9,RMPRCOD)="" S RMPRERR=0
"RTN","RMPRBIL",76,0)
 S RMPRDAT=$P($G(^RMPR(660,RP,0)),U,1)
"RTN","RMPRBIL",77,0)
 I $D(^RMPR(660,RP,10)) S RMPRIC9=$P(^RMPR(660,RP,10),U,8)
"RTN","RMPRBIL",78,0)
 ;
"RTN","RMPRBIL",79,0)
 ; RMPRIC9 = Suspense ICD9 Code used in API parameter
"RTN","RMPRBIL",80,0)
 ; RMPRDAT = Entry Date used in API parameter
"RTN","RMPRBIL",81,0)
 ;
"RTN","RMPRBIL",82,0)
 I RMPRIC9'=""  D
"RTN","RMPRBIL",83,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPRBIL",84,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPRBIL",85,0)
 .I RMPRERR<0 W !,"ICD-9 Message: ",$P(RMPRICD,U,2)
"RTN","RMPRBIL",86,0)
 W !,"ICD-9 Code: "
"RTN","RMPRBIL",87,0)
 I $G(RMPRICD)'="" W $P(RMPRICD,U,2),?19,$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 W " ","** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT W Y
"RTN","RMPRBIL",88,0)
 ; Above Patch 92 code  
"RTN","RMPRBIL",89,0)
 ; End of Patch 92
"RTN","RMPRBIL",90,0)
 ;
"RTN","RMPRBIL",91,0)
 ; I $D(^RMPR(660,RP,"DES",0)) S RR=0 F  S RR=$O(^RMPR(660,RP,"DES",RR)) Q:RR'>0  W !,?4,$P(^RMPR(660,RP,"DES",RR,0),U)
"RTN","RMPRBIL",92,0)
 W !
"RTN","RMPRBIL",93,0)
 Q
"RTN","RMPRBIL",94,0)
HDR W:$Y>(IOSL-8) @IOF
"RTN","RMPRBIL",95,0)
HDR1 W !,?5,"PATIENT NAME",?22,"SSN",?38," " S Y=RMPRBDT D DD^%DT W Y,"-" S Y=RMPREDT D DD^%DT W Y,?64,"STA ",$$STA^RMPRUTIL,?73,"PAGE ",PAGE
"RTN","RMPRBIL",96,0)
 S HDR2=0,PAGE=PAGE+1,FL=1,$P(IZ,"-",IOM)="",RMPRFLAG=1 W !,IZ
"RTN","RMPRBIL",97,0)
 Q
"RTN","RMPRBIL",98,0)
 ;
"RTN","RMPRBIL",99,0)
ERRORD ; network error message
"RTN","RMPRBIL",100,0)
 I $D(RMI("IBBAPI","INSUR","ERROR")) D HDR W !!,"AN ERROR WITH INSURANCE RETRIEVAL HAS CAUSED THIS OPTION TO BE TERMINATED.  PLEASE TRY THIS REPORT AT A LATER TIME."
"RTN","RMPRBIL",101,0)
 Q
"RTN","RMPRBIL",102,0)
 ;
"RTN","RMPRBIL",103,0)
DISP ; mimics DISP^IBCNS
"RTN","RMPRBIL",104,0)
 Q:'$D(DFN)  D:'$D(IOF) HOME^%ZIS
"RTN","RMPRBIL",105,0)
 D HDR2
"RTN","RMPRBIL",106,0)
 I '$D(RMI) W !,"    No Insurance Information" Q
"RTN","RMPRBIL",107,0)
 ;
"RTN","RMPRBIL",108,0)
 S X="" F  S X=$O(RMI("IBBAPI","INSUR",X)) Q:'X  D D1
"RTN","RMPRBIL",109,0)
 W !
"RTN","RMPRBIL",110,0)
 Q
"RTN","RMPRBIL",111,0)
 ;
"RTN","RMPRBIL",112,0)
D1 N J,Y,Z,CAT,DAT,DAT1 Q:'$D(RMI("IBBAPI","INSUR",X,1))
"RTN","RMPRBIL",113,0)
 W !?3,$E($P(RMI("IBBAPI","INSUR",X,1),U,2),1,10)
"RTN","RMPRBIL",114,0)
 ; extract COB indicator
"RTN","RMPRBIL",115,0)
 S Z="",J=$P(RMI("IBBAPI","INSUR",X,7),U,2)
"RTN","RMPRBIL",116,0)
 S Y=+(RMI("IBBAPI","INSUR",X,7)) W ?16,$P("p^s^t",U,+(RMI("IBBAPI","INSUR",X,7)))
"RTN","RMPRBIL",117,0)
 W ?19,$E(RMI("IBBAPI","INSUR",X,14),1,16)
"RTN","RMPRBIL",118,0)
 S Y=$$GET1^DIQ(355.3,+RMI("IBBAPI","INSUR",X,8)_",",.04)
"RTN","RMPRBIL",119,0)
 W ?37,$E(Y,1,10)
"RTN","RMPRBIL",120,0)
 W ?49,$P(RMI("IBBAPI","INSUR",X,12),U,2)
"RTN","RMPRBIL",121,0)
 S DAT=RMI("IBBAPI","INSUR",X,10)
"RTN","RMPRBIL",122,0)
 W:DAT'="" ?57,$E(DAT,4,5)_"/"_$E(DAT,6,7)_"/"_$E(DAT,2,3)
"RTN","RMPRBIL",123,0)
 S DAT1=RMI("IBBAPI","INSUR",X,11)
"RTN","RMPRBIL",124,0)
 W:DAT1'="" ?67,$E(DAT1,4,5)_"/"_$E(DAT1,6,7)_"/"_$E(DAT1,2,3)
"RTN","RMPRBIL",125,0)
 I +RMI("IBBAPI","INSUR",X,9)=0 W ?75," *WNR*"
"RTN","RMPRBIL",126,0)
 ; removed for date parameter.
"RTN","RMPRBIL",127,0)
 ;S Z="" F Y=15:1:17 D
"RTN","RMPRBIL",128,0)
 ;. S CAT=$P("r^o^i",U,(Y-14))
"RTN","RMPRBIL",129,0)
 ;. S:+RMI("IBBAPI","INSUR",X,Y)=1 Z=Z_CAT
"RTN","RMPRBIL",130,0)
 ;W ?75,Z
"RTN","RMPRBIL",131,0)
 Q
"RTN","RMPRBIL",132,0)
HDR2 ;
"RTN","RMPRBIL",133,0)
 W !,?2,"Insurance",?15,"COB",?19,"Subscriber ID",?37,"Group",?49,"Holder",?57,"Effective",?67,"Expires"
"RTN","RMPRBIL",134,0)
 N Z S $P(Z,"=",78)="" W !?2,Z
"RTN","RMPRBIL",135,0)
 S HDR2=0
"RTN","RMPRBIL",136,0)
 Q
"RTN","RMPRBIL",137,0)
 ;
"RTN","RMPRPAT3")
0^2^B36433256
"RTN","RMPRPAT3",1,0)
RMPRPAT3 ;HINES-CIOFO/HNC,RVD-Detail Display Patient 10-2319 Transaction ;12/16/02  10:57
"RTN","RMPRPAT3",2,0)
 ;;3.0;PROSTHETICS;**3,12,25,28,32,41,69,92**;Feb 09, 1996
"RTN","RMPRPAT3",3,0)
 ;
"RTN","RMPRPAT3",4,0)
 ; RVD 4/30/02 patch #69 - add ICD-9 CODE and description in the display.
"RTN","RMPRPAT3",5,0)
 ;                         add HCPCS and Short Description.
"RTN","RMPRPAT3",6,0)
 ;AAC 08/03/04 Patch 92 - Code Set Versioning (CSV)
"RTN","RMPRPAT3",7,0)
 ;- Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80)
"RTN","RMPRPAT3",8,0)
 ;
"RTN","RMPRPAT3",9,0)
 ;DBIA # 3990 - for routine ICDDX^ICDCODE for Patch 92
"RTN","RMPRPAT3",10,0)
 ;
"RTN","RMPRPAT3",11,0)
 ;expect ANS,IT(ANS)
"RTN","RMPRPAT3",12,0)
 ;          +IT(ANS)=ien of file 660
"RTN","RMPRPAT3",13,0)
 ;expect variables from GETPAT^RMPRUTIL
"RTN","RMPRPAT3",14,0)
 ;    RMPRSSNE (external form of SSN)
"RTN","RMPRPAT3",15,0)
 ;    RMPRNAM (name of patient)
"RTN","RMPRPAT3",16,0)
 ;    RMPRDOB
"RTN","RMPRPAT3",17,0)
 ;display detailed record
"RTN","RMPRPAT3",18,0)
PRINT ;called from RMPRPAT2
"RTN","RMPRPAT3",19,0)
 ;get 2319 transaction
"RTN","RMPRPAT3",20,0)
 ;
"RTN","RMPRPAT3",21,0)
 N DIC,DIQ,DR,DA,RMPRV,RMPRDA,RV
"RTN","RMPRPAT3",22,0)
 S DIC=660,DIQ="R19",DR=".01:96",DIQ(0)="EN"
"RTN","RMPRPAT3",23,0)
 S (RMPRDA,DA)=+IT(ANS)
"RTN","RMPRPAT3",24,0)
 D EN^DIQ1
"RTN","RMPRPAT3",25,0)
 S DIQ="R19",DR=72,DIQ(0)="I" D EN^DIQ1
"RTN","RMPRPAT3",26,0)
 ;get vendor info
"RTN","RMPRPAT3",27,0)
 S DA=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPRPAT3",28,0)
 I DA D
"RTN","RMPRPAT3",29,0)
 .S DIC=440,DIQ="RV",DR=".01:6",DIQ(0)="EN"
"RTN","RMPRPAT3",30,0)
 .S (RMPRV,DA)=$P(^RMPR(660,RMPRDA,0),U,9)
"RTN","RMPRPAT3",31,0)
 .D EN^DIQ1
"RTN","RMPRPAT3",32,0)
 ;
"RTN","RMPRPAT3",33,0)
 ;array defined for record in following format:
"RTN","RMPRPAT3",34,0)
 ;R19(filenumber,ien,field,E)=external form of data
"RTN","RMPRPAT3",35,0)
 ;RV(filenumber,ien,field,E)=external form of data
"RTN","RMPRPAT3",36,0)
 ;example:
"RTN","RMPRPAT3",37,0)
 ;R19(660,100,.01,"E")=APR 27, 1995
"RTN","RMPRPAT3",38,0)
 ;R19(660,100,.02,"E")=FUDGE,CHOCOLATE
"RTN","RMPRPAT3",39,0)
 ;RV(440,131,.01,"E")=ORTHOTIC LAB
"RTN","RMPRPAT3",40,0)
 ;
"RTN","RMPRPAT3",41,0)
 D HDR
"RTN","RMPRPAT3",42,0)
 W !,"TYPE OF FORM: ",$G(R19(660,RMPRDA,11,"E"))
"RTN","RMPRPAT3",43,0)
 W ?25,"INITIATOR: ",$G(R19(660,RMPRDA,27,"E"))
"RTN","RMPRPAT3",44,0)
 W ?55,"DATE: ",$G(R19(660,RMPRDA,1,"E"))
"RTN","RMPRPAT3",45,0)
 W !,"DELIVER TO: ",$G(R19(660,RMPRDA,25,"E"))
"RTN","RMPRPAT3",46,0)
 W !,"TYPE TRANS: ",$G(R19(660,RMPRDA,2,"E"))
"RTN","RMPRPAT3",47,0)
 W ?30,"QTY: ",$G(R19(660,RMPRDA,5,"E"))
"RTN","RMPRPAT3",48,0)
 W:$G(R19(660,RMPRDA,29,"E")) ?40,"INVENTORY POINT: ",R19(660,RMPRDA,29,"E"),!
"RTN","RMPRPAT3",49,0)
 W ?40,"SOURCE: ",$G(R19(660,RMPRDA,12,"E"))
"RTN","RMPRPAT3",50,0)
 ;vendor tracking number
"RTN","RMPRPAT3",51,0)
 I $G(R19(660,RMPRDA,11,"E"))="VISA" D
"RTN","RMPRPAT3",52,0)
 .W !,"VENDOR TRACKING: ",$G(R19(660,RMPRDA,4.2,"E"))
"RTN","RMPRPAT3",53,0)
 .W ?38,"BANK AUTHORIZATION: ",$G(R19(660,RMPRDA,4.3,"E"))
"RTN","RMPRPAT3",54,0)
 W !,"VENDOR: ",?15,$G(R19(660,RMPRDA,7,"E"))
"RTN","RMPRPAT3",55,0)
 I $D(RV) D
"RTN","RMPRPAT3",56,0)
 .W !,"VENDOR PHONE: ",?15,$G(RV(440,RMPRV,5,"E"))
"RTN","RMPRPAT3",57,0)
 .W !?15,$G(RV(440,RMPRV,1,"E"))
"RTN","RMPRPAT3",58,0)
 .W !?15,$G(RV(440,RMPRV,4.2,"E")),","
"RTN","RMPRPAT3",59,0)
 .W ?$X+3,$G(RV(440,RMPRV,4.4,"E")),?$X+5,$G(RV(440,RMPRV,4.6,"E"))
"RTN","RMPRPAT3",60,0)
 W !,"DELIVERY DATE: "
"RTN","RMPRPAT3",61,0)
 I $D(R19(660,RMPRDA,10,"E")) W R19(660,RMPRDA,10,"E")
"RTN","RMPRPAT3",62,0)
 W !
"RTN","RMPRPAT3",63,0)
 I '$P(IT(AN),U,3) D
"RTN","RMPRPAT3",64,0)
 .W "TOTAL COST: "
"RTN","RMPRPAT3",65,0)
 .I $G(R19(660,RMPRDA,14,"E"))'="" W "$"_$J(R19(660,RMPRDA,14,"E"),2)
"RTN","RMPRPAT3",66,0)
 .I $G(R19(660,RMPRDA,14,"E"))="" W $S($G(R19(660,RMPRDA,6,"E"))'="":"$"_$J(R19(660,RMPRDA,6,"E"),2),$G(R19(660,RMPRDA,48,"E"))'="":"$"_$J(R19(660,RMPRDA,48,"E"),2),1:"")
"RTN","RMPRPAT3",67,0)
 W ?30,"OBL: ",$G(R19(660,RMPRDA,23,"E"))
"RTN","RMPRPAT3",68,0)
 ;
"RTN","RMPRPAT3",69,0)
 ;lab data
"RTN","RMPRPAT3",70,0)
 I $D(^RMPR(660,RMPRDA,"LB")) D
"RTN","RMPRPAT3",71,0)
 .N DIC,DIQ,DR,L19,DA
"RTN","RMPRPAT3",72,0)
 .S (DA,RMPRLA)=$P(^RMPR(660,RMPRDA,"LB"),U,10)
"RTN","RMPRPAT3",73,0)
 .Q:DA=""
"RTN","RMPRPAT3",74,0)
 .S DIC=664.1,DIQ="L19",DR="15",DIQ(0)="E"
"RTN","RMPRPAT3",75,0)
 .D EN^DIQ1
"RTN","RMPRPAT3",76,0)
 .W !,"WORK ORDER: ",$G(R19(660,RMPRDA,71,"E"))
"RTN","RMPRPAT3",77,0)
 .W ?40,"RECEIVING STATION: ",$G(R19(660,RMPRDA,70,"E"))
"RTN","RMPRPAT3",78,0)
 .W !,"TECHNICIAN: ",$G(L19(664.1,RMPRLA,15,"E"))
"RTN","RMPRPAT3",79,0)
 .W !,"TOTAL LABOR HOURS: ",$G(R19(660,RMPRDA,45,"E"))
"RTN","RMPRPAT3",80,0)
 .W ?40,"TOTAL LABOR COST: ",$G(R19(660,RMPRDA,46,"E"))
"RTN","RMPRPAT3",81,0)
 .W !,"TOTAL MATERIAL COST: ",$G(R19(660,RMPRDA,47,"E"))
"RTN","RMPRPAT3",82,0)
 .W ?40,"TOTAL LAB COST: ",$G(R19(660,RMPRDA,48,"E"))
"RTN","RMPRPAT3",83,0)
 .W !,"COMPLETION DATE: ",$G(R19(660,RMPRDA,50,"E"))
"RTN","RMPRPAT3",84,0)
 .W ?40,"LAB REMARKS: ",$G(R19(660,RMPRDA,51,"E"))
"RTN","RMPRPAT3",85,0)
 W !,"REMARKS: ",?15,$G(R19(660,RMPRDA,16,"E"))
"RTN","RMPRPAT3",86,0)
 I $G(R19(660,RMPRDA,17.5,"E")) W ?40,"RETURN STATUS: ",R19(660,RMPRDA,17.5,"E")
"RTN","RMPRPAT3",87,0)
 ;
"RTN","RMPRPAT3",88,0)
 ;historical data
"RTN","RMPRPAT3",89,0)
 I $G(R19(660,RMPRDA,15,"E"))["*" D
"RTN","RMPRPAT3",90,0)
 .;include records that have been merged
"RTN","RMPRPAT3",91,0)
 .W !!,"HISTORICAL DATA",!
"RTN","RMPRPAT3",92,0)
 .Q:'$D(R19(660,RMPRDA,89))
"RTN","RMPRPAT3",93,0)
 .W !,?15,"ITEM: ",$G(R19(660,RMPRDA,89,"E"))
"RTN","RMPRPAT3",94,0)
 .W !,?15,"STATION: ",$G(R19(660,RMPRDA,90,"E"))
"RTN","RMPRPAT3",95,0)
 .W !,?15,"VENDOR: ",$G(R19(660,RMPRDA,91,"E")),"   PHONE: ",$G(R19(660,RMPRDA,92,"E"))
"RTN","RMPRPAT3",96,0)
 .W !,?23,$G(R19(660,RMPRDA,93,"E")),!,?23,$G(R19(660,RMPRDA,94,"E"))
"RTN","RMPRPAT3",97,0)
 .W "   ",$G(R19(660,RMPRDA,95,"E")),"  ",$G(R19(660,RMPRDA,96,"E"))
"RTN","RMPRPAT3",98,0)
 ;put in lab display here fields 45,46,47,48 and 51
"RTN","RMPRPAT3",99,0)
 ;lab amis
"RTN","RMPRPAT3",100,0)
 I $G(R19(660,RMPRDA,73,"E")) D
"RTN","RMPRPAT3",101,0)
 .W ?40,"ORTHOTICS LAB CODE: "
"RTN","RMPRPAT3",102,0)
 .W $S($D(R19(660,RMPRDA,74,"E")):R19(660,RMPRDA,74,"E"),$D(R19(660,RMPRDA,75,"E")):R19(660,RMPRDA,75,"E"),1:"")
"RTN","RMPRPAT3",103,0)
 .W !?40,"RESTORATIONS LAB CODE: "
"RTN","RMPRPAT3",104,0)
 .W $S($D(R19(660,RMPRDA,76,"E")):R19(660,RMPRDA,76,"E"),$D(R19(660,RMPRDA,77,"E")):R19(660,RMPRDA,77,"E"),1:"")
"RTN","RMPRPAT3",105,0)
 ;purchasing and issue from stock amis
"RTN","RMPRPAT3",106,0)
 W !,"DISABILITY SERVED: ",$G(R19(660,RMPRDA,62,"E"))
"RTN","RMPRPAT3",107,0)
 ;appliance/item information
"RTN","RMPRPAT3",108,0)
 W !,"APPLIANCE: ",$G(R19(660,RMPRDA,4,"E"))
"RTN","RMPRPAT3",109,0)
 W !,"PSAS HCPCS: ",$G(R19(660,RMPRDA,4.5,"E"))
"RTN","RMPRPAT3",110,0)
 I $P($G(^RMPR(660,RMPRDA,1)),U,4) W ?22,$P($G(^RMPR(661.1,$P(^RMPR(660,RMPRDA,1),U,4),0)),U,2)
"RTN","RMPRPAT3",111,0)
 ;added by #69
"RTN","RMPRPAT3",112,0)
 ;
"RTN","RMPRPAT3",113,0)
 ;PATCH 92 - Code Set Versioning (CSV) changes below
"RTN","RMPRPAT3",114,0)
 ;AAC - 08/03/04
"RTN","RMPRPAT3",115,0)
 ;
"RTN","RMPRPAT3",116,0)
 S (RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT)="" S RMPRERR=0
"RTN","RMPRPAT3",117,0)
 S RMPRDAT=$P($G(^RMPR(660,RMPRDA,0)),U,1)
"RTN","RMPRPAT3",118,0)
 I $D(^RMPR(660,RMPRDA,10)) S RMPRIC9=$P(^RMPR(660,RMPRDA,10),U,8)
"RTN","RMPRPAT3",119,0)
 I RMPRIC9'=""  D
"RTN","RMPRPAT3",120,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPRPAT3",121,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPRPAT3",122,0)
 .I RMPRERR<0 W !,"ICD-9 Message: ",$P(RMPRICD,U,2)
"RTN","RMPRPAT3",123,0)
 W !,"ICD-9 CODE: "
"RTN","RMPRPAT3",124,0)
 I $G(RMPRICD)'="" W $P(RMPRICD,U,2),?19,$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 W " ","** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT W Y
"RTN","RMPRPAT3",125,0)
 ;
"RTN","RMPRPAT3",126,0)
 ; End of Patch 92
"RTN","RMPRPAT3",127,0)
 ;
"RTN","RMPRPAT3",128,0)
 W !,"CPT MODIFIER: ",$G(R19(660,RMPRDA,4.7,"E"))
"RTN","RMPRPAT3",129,0)
 W !,"DESCRIPTION: ",$G(R19(660,RMPRDA,24,"E"))
"RTN","RMPRPAT3",130,0)
 W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPRPAT3",131,0)
 I $D(R19(660,RMPRDA,28)) D  G:$D(DUOUT)!$D(DTOUT) EX1
"RTN","RMPRPAT3",132,0)
 .N R28
"RTN","RMPRPAT3",133,0)
 .;command part of new standards
"RTN","RMPRPAT3",134,0)
 .MERGE R28=R19(660,RMPRDA,28)
"RTN","RMPRPAT3",135,0)
 .I $P($G(^RMPR(660,RMPRDA,"DES",0)),U,3)>1 N DIR S DIR(0)="E" D ^DIR Q:$D(DUOUT)!$D(DTOUT)  D HDR W !,"EXTENDED DESCRIPTION: ",!
"RTN","RMPRPAT3",136,0)
 .D EN^DDIOL(.R28)
"RTN","RMPRPAT3",137,0)
 ;NPPD key items consolidated, example L5300 limb order
"RTN","RMPRPAT3",138,0)
 I $P(IT(AN),U,3) W !!,"*** Return For DETAIL REPORT ***" N DIR S DIR(0)="E" D ^DIR G:$D(DUOUT)!$D(DTOUT) EX1  W @IOF D HDR,^RMPRPAT7
"RTN","RMPRPAT3",139,0)
 ;display work order if it is a 2529-3 form
"RTN","RMPRPAT3",140,0)
 ;must pass ien to file 664.1 NOT 664.2
"RTN","RMPRPAT3",141,0)
 I $G(R19(660,RMPRDA,72,"I"))'="" D  G EX1
"RTN","RMPRPAT3",142,0)
 .S DIR(0)="E" D ^DIR Q:$D(DTOUT)!$D(DUOUT)
"RTN","RMPRPAT3",143,0)
 .S RMPRBCK=RMPRDA
"RTN","RMPRPAT3",144,0)
 .N DIC
"RTN","RMPRPAT3",145,0)
 .S RMPRDA=R19(660,RMPRBCK,72,"I")
"RTN","RMPRPAT3",146,0)
 .D DISP^RMPR293(RMPRDA)
"RTN","RMPRPAT3",147,0)
 .S RMPRDA=RMPRBCK K RMPRBCK
"RTN","RMPRPAT3",148,0)
 ;return from work order
"RTN","RMPRPAT3",149,0)
 G EXIT
"RTN","RMPRPAT3",150,0)
 ;
"RTN","RMPRPAT3",151,0)
HDR ;display heading
"RTN","RMPRPAT3",152,0)
 W @IOF,RMPRNAM,?30," SSN: "
"RTN","RMPRPAT3",153,0)
 W $E(RMPRSSN,1,3)_"-"_$E(RMPRSSN,4,5)_"-"_$E(RMPRSSN,6,10),?50
"RTN","RMPRPAT3",154,0)
 W $G(R19(660,RMPRDA,8,"E")),?70,"DOB: "
"RTN","RMPRPAT3",155,0)
 W $S(RMPRDOB:$E(RMPRDOB,4,5)_"-"_$E(RMPRDOB,6,7)_"-"_(1700+$E(RMPRDOB,1,3)),1:"Unknown")
"RTN","RMPRPAT3",156,0)
 W !?20,"APPLIANCE/REPAIR LINE ITEM DETAIL ",?70,"<4-",ANS,">",!
"RTN","RMPRPAT3",157,0)
 Q
"RTN","RMPRPAT3",158,0)
EXIT ;common exit point
"RTN","RMPRPAT3",159,0)
 I $Y>(IOSL-4) F  W ! Q:$Y>(IOSL-3)
"RTN","RMPRPAT3",160,0)
 N DIR S DIR(0)="E" D ^DIR
"RTN","RMPRPAT3",161,0)
 ;duout,dtout is evaluated in dis+1^rmprpat2
"RTN","RMPRPAT3",162,0)
EX1 ;back out through that point to clean up
"RTN","RMPRPAT3",163,0)
 K R19,RV,RMPRICD,RMPRIC9,RMPRICD,RMPRIC9,MSGICD,RMPRCOD,RMPRERR,RMPRDAT,Y W @IOF
"RTN","RMPRPAT3",164,0)
 Q
"RTN","RMPRPAT3",165,0)
 ;end
"RTN","RMPRSE21")
0^4^B29197111
"RTN","RMPRSE21",1,0)
RMPRSE21 ;HINES CIOFO/HNB-SEARCH FILE 660 ENTRIES PSAS HCPCS HISTORY;1/23/1998
"RTN","RMPRSE21",2,0)
 ;;3.0;PROSTHETICS;**36,62,77,92**;Feb 09, 1996
"RTN","RMPRSE21",3,0)
 ; RVD patch #62 - add ICD9 code and Description in the output
"RTN","RMPRSE21",4,0)
 ; RVD patch #77 3/17/03 - use RMPR("STA") instead of $$STA^RMPRUTIL
"RTN","RMPRSE21",5,0)
 ;
"RTN","RMPRSE21",6,0)
 ; AAC Patch 92 08/03/04 - Code Set Versioning (CSV)
"RTN","RMPRSE21",7,0)
 ;                       - Used API=ICDDX^ICDCODE to replace direct calls to global ICD9(80).
"RTN","RMPRSE21",8,0)
 ;
"RTN","RMPRSE21",9,0)
 ; DBIA # 3990 - for routine ICDDX^ICDCODE for Patch 92
"RTN","RMPRSE21",10,0)
 ;
"RTN","RMPRSE21",11,0)
EN S (ITEM,RMPRARR,RMPRI,RMPRDA)=""
"RTN","RMPRSE21",12,0)
 K KILL
"RTN","RMPRSE21",13,0)
 D HOME^%ZIS,DIV4^RMPRSIT G:$D(X) EXIT1
"RTN","RMPRSE21",14,0)
 W !!!
"RTN","RMPRSE21",15,0)
 S DIC="^RMPR(661.1,",DIC(0)="AEQM"
"RTN","RMPRSE21",16,0)
 F ITEM=1:1 S DIC("A")="Select PSAS HCPCS ("_ITEM_"): " D ^DIC G:$D(DTOUT)!(X["^")!(X=""&(ITEM=1)) EXIT1 Q:X=""  D
"RTN","RMPRSE21",17,0)
 .I $D(RMPRI(+Y)) W !,$C(7)," ??",?40,"..Duplicate PSAS HCPCS" S ITEM=ITEM-1 Q
"RTN","RMPRSE21",18,0)
 .S RMPRARR(ITEM)=+Y,RMPRI(+Y)=""
"RTN","RMPRSE21",19,0)
 S RMPRCOUN=0 W !! S %DT("A")="Beginning Date: ",%DT="AEPX",%DT("B")="T-30" D ^%DT S RMPRBDT=Y G:Y<0 EXIT1
"RTN","RMPRSE21",20,0)
ENDATE S %DT("A")="Ending Date: ",%DT="AEX",%DT("B")="TODAY"
"RTN","RMPRSE21",21,0)
 D ^%DT G:Y<0 EXIT1
"RTN","RMPRSE21",22,0)
 I RMPRBDT>Y W !,$C(7),"Invalid Date Range Selection!!" G ENDATE
"RTN","RMPRSE21",23,0)
 G:Y<0 EXIT
"RTN","RMPRSE21",24,0)
 S RMPREDT=Y,Y=RMPRBDT D DD^%DT S RMPRX=Y,Y=RMPREDT  D DD^%DT S RMPRY=Y
"RTN","RMPRSE21",25,0)
 S %ZIS="MQ" K IOP D ^%ZIS G:POP EXIT
"RTN","RMPRSE21",26,0)
 I '$D(IO("Q")) U IO G PRINT
"RTN","RMPRSE21",27,0)
 K IO("Q") S ZTDESC="SEARCH FOR PSAS HCPCS",ZTRTN="PRINT^RMPRSE21",ZTIO=ION,ZTSAVE("RMPRBDT")="",ZTSAVE("RMPREDT")="",ZTSAVE("RMPRI(")="",ZTSAVE("RMPRX")="",ZTSAVE("RMPRY")="",ZTSAVE("RMPR(""STA"")")="",ZTSAVE("RMPRARR(")=""
"RTN","RMPRSE21",28,0)
 S ZTSAVE("RMPR(")="",ZTSAVE("RMPRSITE")=""
"RTN","RMPRSE21",29,0)
 D ^%ZTLOAD W:$D(ZTSK) !,"REQUEST QUEUED!" H 1 G EXIT1
"RTN","RMPRSE21",30,0)
PRINT ;ENTRY POINT FOR PRINTING REPORT
"RTN","RMPRSE21",31,0)
 S PAGE=1,(RMPRCOUN,RP,QTYT,COSTT)=0
"RTN","RMPRSE21",32,0)
 S RQ=0
"RTN","RMPRSE21",33,0)
 F  S RQ=$O(RMPRARR(RQ)) Q:RQ'>0!($D(KILL))  D  D REST
"RTN","RMPRSE21",34,0)
 .S RO=$P(RMPRARR(RQ),U,1),RO=RO-1
"RTN","RMPRSE21",35,0)
 .F  S RO=$O(^RMPR(660,"H",RO)) Q:RO'>0  D
"RTN","RMPRSE21",36,0)
 . .Q:RO=""!(RO'=$P(RMPRARR(RQ),U))!($D(KILL))
"RTN","RMPRSE21",37,0)
 . .K ENDD
"RTN","RMPRSE21",38,0)
 . .F  S RP=$O(^RMPR(660,"H",RO,RP)) Q:RP=""!($D(KILL))  D CK
"RTN","RMPRSE21",39,0)
 G EXIT
"RTN","RMPRSE21",40,0)
 Q
"RTN","RMPRSE21",41,0)
EXIT ;EXIT FROM REPORT HERE
"RTN","RMPRSE21",42,0)
 I RMPRCOUN>0,$D(RMPREDT),'$D(KILL) W !!?32,"END OF REPORT"
"RTN","RMPRSE21",43,0)
 I $E(IOST)["C"&($Y<22),'$D(ENDD) F  W ! Q:$Y>20
"RTN","RMPRSE21",44,0)
 I $D(RMPREDT),$E(IOST)["C",'$D(RMPRFLL),'$D(KILL),'$D(DUOUT),'$D(DTOUT),'$D(ENDD) K DIR S DIR(0)="E" D ^DIR
"RTN","RMPRSE21",45,0)
EXIT1 K RMPRARR,%DT,GOTO,QTYT,ITEM,KILL,ENDD,RQ,RP,RO,ITEM,RMPRI,COSTT,DIC,DIR,PAGE,RO,RMPRCOUN,RMPRSE,RMPRBDT,RMPREDT,RMPRX,RMPRY,RMPRCOD,RMPRDA,RMPRDAT,RMPRERR D ^%ZISC
"RTN","RMPRSE21",46,0)
 Q
"RTN","RMPRSE21",47,0)
CK Q:'$D(^RMPR(660,RP,0))
"RTN","RMPRSE21",48,0)
 ;hcpcs
"RTN","RMPRSE21",49,0)
 I ('$P(^RMPR(660,RP,1),U,4))!($P(^(0),U,3)<RMPRBDT)!($P(^(0),U,3)>RMPREDT)  Q
"RTN","RMPRSE21",50,0)
 I $P(^RMPR(660,RP,0),U,10)'=RMPR("STA") Q
"RTN","RMPRSE21",51,0)
 ;
"RTN","RMPRSE21",52,0)
 I $P(RMPRARR(RQ),U,1)=$P(^RMPR(660,RP,1),U,4) D CON
"RTN","RMPRSE21",53,0)
 Q
"RTN","RMPRSE21",54,0)
 ;
"RTN","RMPRSE21",55,0)
CON I $Y>(IOSL-6),PAGE=1,'RMPRCOUN W @IOF
"RTN","RMPRSE21",56,0)
 D HEAD S RMPRCOUN=RMPRCOUN+1
"RTN","RMPRSE21",57,0)
 S (RMPRDA,Y)=$P(^RMPR(660,RP,0),U,3) D DD^%DT
"RTN","RMPRSE21",58,0)
 W !,Y,?15,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,1),1,13),?30,$E($P(^DPT($P(^RMPR(660,RP,0),U,2),0),U,9),6,9)
"RTN","RMPRSE21",59,0)
 W:$P(^RMPR(660,RP,0),U,9)'="" ?36,$E($P(^PRC(440,$P(^RMPR(660,RP,0),U,9),0),U,1),1,35)
"RTN","RMPRSE21",60,0)
 W !,"ITEM: " S ITMP=$P(^RMPR(660,RP,0),U,6)
"RTN","RMPRSE21",61,0)
 W:ITMP'="" $E($P(^PRC(441,$P(^RMPR(661,ITMP,0),U,1),0),U,2),1,20)
"RTN","RMPRSE21",62,0)
 K ITMP
"RTN","RMPRSE21",63,0)
 I $P(^RMPR(660,RP,0),U,13)=4 D
"RTN","RMPRSE21",64,0)
 .W ?27,"QTY: ",$J($P(^RMPR(660,RP,0),U,7),4),?38,"TOTAL COST: ",$J($FN($P(^("LB"),U,9),"P",2),8) S QTYT=QTYT+$P(^(0),U,7),COSTT=COSTT+$P(^("LB"),U,9)
"RTN","RMPRSE21",65,0)
 I $P(^RMPR(660,RP,0),U,13)'=4 W ?27,"QTY: ",$J($P(^RMPR(660,RP,0),U,7),4),?38,"TOTAL COST: ",$J($FN($P(^(0),U,16),"P",2),8) S QTYT=QTYT+$P(^(0),U,7),COSTT=COSTT+$P(^(0),U,16)
"RTN","RMPRSE21",66,0)
 W ?60,$S($P(^RMPR(660,RP,0),U,4)="I":"INITIAL ISSUE",$P(^(0),U,4)="R":"REPLACEMENT",$P(^(0),U,4)="S":"SPARE",$P(^(0),U,4)="X":"REPAIR",1:"UNK"),!,"INITIATOR: " I $P(^(0),U,27),$D(^VA(200,$P(^(0),U,27),0)) W ?15,$P(^(0),U)
"RTN","RMPRSE21",67,0)
 ;
"RTN","RMPRSE21",68,0)
 ; Patch 92 - Code Set Versioning (CSV) changes below
"RTN","RMPRSE21",69,0)
 ; AAC - 08/03/04
"RTN","RMPRSE21",70,0)
 ;
"RTN","RMPRSE21",71,0)
 S (RMPRICD,RMPRIC9,RMPRCOD,RMPRDAT)="" S RMPRERR=0
"RTN","RMPRSE21",72,0)
 S RMPRDAT=$P($G(^RMPR(660,RP,0)),U,1)
"RTN","RMPRSE21",73,0)
 I $D(^RMPR(660,RP,10)) S RMPRIC9=$P(^RMPR(660,RP,10),U,8)
"RTN","RMPRSE21",74,0)
 I RMPRIC9'=""  D
"RTN","RMPRSE21",75,0)
 .S RMPRICD=$$ICDDX^ICDCODE(RMPRIC9,RMPRDAT)
"RTN","RMPRSE21",76,0)
 .S RMPRERR=$P(RMPRICD,U,1)
"RTN","RMPRSE21",77,0)
 .I RMPRERR<0 W !,"ICD-9 Message: ",$P(RMPRICD,U,2)
"RTN","RMPRSE21",78,0)
 W !,"ICD-9 Code: "
"RTN","RMPRSE21",79,0)
 I $G(RMPRICD)'="" W $P(RMPRICD,U,2),?19,$E($P(RMPRICD,U,4),1,55) I $P(RMPRICD,U,10)'>0 W " ","** Inactive ** Date: " S Y=$P(RMPRICD,U,12) D DD^%DT W Y
"RTN","RMPRSE21",80,0)
 W !
"RTN","RMPRSE21",81,0)
 ;
"RTN","RMPRSE21",82,0)
 ; END PATCH 92
"RTN","RMPRSE21",83,0)
 ;
"RTN","RMPRSE21",84,0)
 I $E(IOST)["C"&($Y>(IOSL-6)) S DIR(0)="E" D ^DIR S:Y<1 KILL=1 Q:Y<1  K DIR W @IOF D HEAD Q
"RTN","RMPRSE21",85,0)
 I $Y>(IOSL-6) W @IOF D HEAD
"RTN","RMPRSE21",86,0)
 Q
"RTN","RMPRSE21",87,0)
 ;
"RTN","RMPRSE21",88,0)
HEAD I $Y<2!(PAGE=1) D
"RTN","RMPRSE21",89,0)
 .W !,"PSAS HCPCS HISTORY:",?15
"RTN","RMPRSE21",90,0)
 .W $E($P(^RMPR(661.1,$P(^RMPR(660,RP,1),U,4),0),U,1),1,39)
"RTN","RMPRSE21",91,0)
 .W ?63,"STA ",RMPR("STA"),?72,"PAGE ",PAGE S PAGE=PAGE+1
"RTN","RMPRSE21",92,0)
 .W !!,"REQUEST DATE",?15,"PATIENT NAME",?30,"SSN",?36,"VENDOR"
"RTN","RMPRSE21",93,0)
 .S Y=RMPRBDT D DD^%DT W ?55,Y,"-" S Y=RMPREDT D DD^%DT W Y
"RTN","RMPRSE21",94,0)
 .W ! F BH=1:1:IOM W "="
"RTN","RMPRSE21",95,0)
 Q
"RTN","RMPRSE21",96,0)
 ;
"RTN","RMPRSE21",97,0)
REST D:'RMPRCOUN NONE Q:$D(KILL)!('RMPRCOUN)  W !,"TOTAL DOLLARS SPENT ON THIS HCPCS: ","$"_$J($FN(COSTT,"P",2),9),?45,"TOTAL QUANTITY ISSUED: ",$J(QTYT,4)
"RTN","RMPRSE21",98,0)
 I $O(RMPRARR(RQ)),$E(IOST)["C" W ! K DIR S DIR(0)="E" D ^DIR S:Y<1 KILL=1 W:'$D(KILL) @IOF
"RTN","RMPRSE21",99,0)
 I $E(IOST)'["C",$O(RMPRARR(RQ)) W @IOF
"RTN","RMPRSE21",100,0)
 S (COSTT,QTYT,RMPRCOUN)=""
"RTN","RMPRSE21",101,0)
 Q
"RTN","RMPRSE21",102,0)
 ;
"RTN","RMPRSE21",103,0)
NONE W @IOF,!!,"No '",$P(^RMPR(661.1,RMPRARR(RQ),0),U,1),"' PSAS HCPCS History for this date range.",!
"RTN","RMPRSE21",104,0)
 ;,$P(^PRC(441,$P(^RMPR(661,$P(RMPRARR(RQ),U),0),U),0),U,2)
"RTN","RMPRSE21",105,0)
 I $E(IOST)["C" K DIR S DIR(0)="E" W !!!! D ^DIR W @IOF S:Y<1 KILL=1 S ENDD=1
"RTN","RMPRSE21",106,0)
 Q
"RTN","RMPRSE21",107,0)
XREF ;set new x-ref for the field HCPCS in 660
"RTN","RMPRSE21",108,0)
 ;fix HCPCS VA117, REMOVE BLANK SPACE IN R90
"RTN","RMPRSE21",109,0)
 S $P(^RMPR(661.1,2801,0),U,6)="R90"
"RTN","RMPRSE21",110,0)
 W !!,"New Cross Reference for HCPCS..."
"RTN","RMPRSE21",111,0)
 S DIK="^RMPR(660,",DIK(1)="4.5^H" D ENALL^DIK
"RTN","RMPRSE21",112,0)
 W !!,"Done"
"RTN","RMPRSE21",113,0)
 Q
"RTN","RMPRSE21",114,0)
 ;END
"VER")
8.0^22
**END**
**END**
