Released OR*3*263 SEQ #251
Extracted from mail message
**KIDS**:OR*3.0*263^

**INSTALL NAME**
OR*3.0*263
"BLD",6921,0)
OR*3.0*263^ORDER ENTRY/RESULTS REPORTING^0^3070910^y
"BLD",6921,1,0)
^^17^17^3070625^
"BLD",6921,1,1,0)
 
"BLD",6921,1,2,0)
This patch will address a few issues:
"BLD",6921,1,3,0)
1.  When using the Search orders by nature or status option, if the user 
"BLD",6921,1,4,0)
entere a start date of T-1 and an end date of T, the search will return 
"BLD",6921,1,5,0)
no results.
"BLD",6921,1,6,0)
 
"BLD",6921,1,7,0)
2. In the option 'Search orders by nature or status', the help text for
"BLD",6921,1,8,0)
the date ranges state that the start date must be older than the end
"BLD",6921,1,9,0)
date. But the option will allow the user to enter an end date older than
"BLD",6921,1,10,0)
the start date.
"BLD",6921,1,11,0)
 
"BLD",6921,1,12,0)
3. Creating a new menu by copying an existing menu is resulting in an 
"BLD",6921,1,13,0)
error.
"BLD",6921,1,14,0)
 
"BLD",6921,1,15,0)
4. If a patient has only clinical procedures reports in the Procedures 
"BLD",6921,1,16,0)
(local only) section of the CPRS reports tab, the reports will not print 
"BLD",6921,1,17,0)
to a printer.
"BLD",6921,4,0)
^9.64PA^^
"BLD",6921,6.3)
9
"BLD",6921,"ABPKG")
n
"BLD",6921,"KRN",0)
^9.67PA^8989.52^19
"BLD",6921,"KRN",.4,0)
.4
"BLD",6921,"KRN",.401,0)
.401
"BLD",6921,"KRN",.402,0)
.402
"BLD",6921,"KRN",.403,0)
.403
"BLD",6921,"KRN",.5,0)
.5
"BLD",6921,"KRN",.84,0)
.84
"BLD",6921,"KRN",3.6,0)
3.6
"BLD",6921,"KRN",3.8,0)
3.8
"BLD",6921,"KRN",9.2,0)
9.2
"BLD",6921,"KRN",9.8,0)
9.8
"BLD",6921,"KRN",9.8,"NM",0)
^9.68A^5^4
"BLD",6921,"KRN",9.8,"NM",1,0)
ORCMEDIT^^0^B36080041
"BLD",6921,"KRN",9.8,"NM",2,0)
ORSNAST^^0^B24821393
"BLD",6921,"KRN",9.8,"NM",4,0)
ORWRPP1^^0^B23307424
"BLD",6921,"KRN",9.8,"NM",5,0)
ORCHTAB5^^0^B1112113
"BLD",6921,"KRN",9.8,"NM","B","ORCHTAB5",5)

"BLD",6921,"KRN",9.8,"NM","B","ORCMEDIT",1)

"BLD",6921,"KRN",9.8,"NM","B","ORSNAST",2)

"BLD",6921,"KRN",9.8,"NM","B","ORWRPP1",4)

"BLD",6921,"KRN",19,0)
19
"BLD",6921,"KRN",19,"NM",0)
^9.68A^^
"BLD",6921,"KRN",19.1,0)
19.1
"BLD",6921,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",6921,"KRN",101,0)
101
"BLD",6921,"KRN",101,"NM",0)
^9.68A^^
"BLD",6921,"KRN",409.61,0)
409.61
"BLD",6921,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",6921,"KRN",771,0)
771
"BLD",6921,"KRN",870,0)
870
"BLD",6921,"KRN",8989.51,0)
8989.51
"BLD",6921,"KRN",8989.51,"NM",0)
^9.68A^^0
"BLD",6921,"KRN",8989.52,0)
8989.52
"BLD",6921,"KRN",8994,0)
8994
"BLD",6921,"KRN","B",.4,.4)

"BLD",6921,"KRN","B",.401,.401)

"BLD",6921,"KRN","B",.402,.402)

"BLD",6921,"KRN","B",.403,.403)

"BLD",6921,"KRN","B",.5,.5)

"BLD",6921,"KRN","B",.84,.84)

"BLD",6921,"KRN","B",3.6,3.6)

"BLD",6921,"KRN","B",3.8,3.8)

"BLD",6921,"KRN","B",9.2,9.2)

"BLD",6921,"KRN","B",9.8,9.8)

"BLD",6921,"KRN","B",19,19)

"BLD",6921,"KRN","B",19.1,19.1)

"BLD",6921,"KRN","B",101,101)

"BLD",6921,"KRN","B",409.61,409.61)

"BLD",6921,"KRN","B",771,771)

"BLD",6921,"KRN","B",870,870)

"BLD",6921,"KRN","B",8989.51,8989.51)

"BLD",6921,"KRN","B",8989.52,8989.52)

"BLD",6921,"KRN","B",8994,8994)

"BLD",6921,"QUES",0)
^9.62^^
"BLD",6921,"REQB",0)
^9.611^5^5
"BLD",6921,"REQB",1,0)
OR*3.0*95^2
"BLD",6921,"REQB",2,0)
OR*3.0*215^2
"BLD",6921,"REQB",3,0)
OR*3.0*50^2
"BLD",6921,"REQB",4,0)
OR*3.0*192^2
"BLD",6921,"REQB",5,0)
OR*3.0*25^2
"BLD",6921,"REQB","B","OR*3.0*192",4)

"BLD",6921,"REQB","B","OR*3.0*215",2)

"BLD",6921,"REQB","B","OR*3.0*25",5)

"BLD",6921,"REQB","B","OR*3.0*50",3)

"BLD",6921,"REQB","B","OR*3.0*95",1)

"MBREQ")
0
"PKG",167,-1)
1^1
"PKG",167,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",167,20,0)
^9.402P^^
"PKG",167,22,0)
^9.49I^1^1
"PKG",167,22,1,0)
3.0^2971217^2980417^1271
"PKG",167,22,1,"PAH",1,0)
263^3070910
"PKG",167,22,1,"PAH",1,1,0)
^^17^17^3070910
"PKG",167,22,1,"PAH",1,1,1,0)
 
"PKG",167,22,1,"PAH",1,1,2,0)
This patch will address a few issues:
"PKG",167,22,1,"PAH",1,1,3,0)
1.  When using the Search orders by nature or status option, if the user 
"PKG",167,22,1,"PAH",1,1,4,0)
entere a start date of T-1 and an end date of T, the search will return 
"PKG",167,22,1,"PAH",1,1,5,0)
no results.
"PKG",167,22,1,"PAH",1,1,6,0)
 
"PKG",167,22,1,"PAH",1,1,7,0)
2. In the option 'Search orders by nature or status', the help text for
"PKG",167,22,1,"PAH",1,1,8,0)
the date ranges state that the start date must be older than the end
"PKG",167,22,1,"PAH",1,1,9,0)
date. But the option will allow the user to enter an end date older than
"PKG",167,22,1,"PAH",1,1,10,0)
the start date.
"PKG",167,22,1,"PAH",1,1,11,0)
 
"PKG",167,22,1,"PAH",1,1,12,0)
3. Creating a new menu by copying an existing menu is resulting in an 
"PKG",167,22,1,"PAH",1,1,13,0)
error.
"PKG",167,22,1,"PAH",1,1,14,0)
 
"PKG",167,22,1,"PAH",1,1,15,0)
4. If a patient has only clinical procedures reports in the Procedures 
"PKG",167,22,1,"PAH",1,1,16,0)
(local only) section of the CPRS reports tab, the reports will not print 
"PKG",167,22,1,"PAH",1,1,17,0)
to a printer.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","ORCHTAB5")
0^5^B1112113^B913656
"RTN","ORCHTAB5",1,0)
ORCHTAB5 ;SLC/dcm - Add item to tab listing ;4/17/97  11:08
"RTN","ORCHTAB5",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**25,263**;Dec 17, 1997;Build 9
"RTN","ORCHTAB5",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","ORCHTAB5",4,0)
 ;
"RTN","ORCHTAB5",5,0)
MED ; -- Medicine Summary of Patient Procedures
"RTN","ORCHTAB5",6,0)
 K ^TMP("MCAR",$J)
"RTN","ORCHTAB5",7,0)
 ;I '$D(^MCAR(690,"AC",+ORVP)) Q
"RTN","ORCHTAB5",8,0)
 D EN^MCARPS2(+ORVP)
"RTN","ORCHTAB5",9,0)
 N MCARID,J
"RTN","ORCHTAB5",10,0)
 S MCARID=0 F  S MCARID=$O(^TMP("OR",$J,"MCAR","OT",MCARID)) Q:MCARID<1  S X=^(MCARID) D
"RTN","ORCHTAB5",11,0)
 . S X1=$P(X,"^") S:$L(X1)'>ORMAX ORTX=1,ORTX(1)=X1 I $L(X1)>ORMAX D TXT^ORCHTAB
"RTN","ORCHTAB5",12,0)
 . S ID=ORVP,DATA(1)=$$PAD^ORCHTAB($P(X,"^",6),16),DATA=1,ORIFN="MED~"_MCARID
"RTN","ORCHTAB5",13,0)
 . D ADD^ORCHTAB
"RTN","ORCHTAB5",14,0)
 Q
"RTN","ORCMEDIT")
0^1^B36080041^B35442976
"RTN","ORCMEDIT",1,0)
ORCMEDIT ;SLC/MKB-Menu Editor ;4/19/01  11:27
"RTN","ORCMEDIT",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**8,46,95,263**;Dec 17, 1997;Build 9
"RTN","ORCMEDIT",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","ORCMEDIT",4,0)
EN ; -- start here
"RTN","ORCMEDIT",5,0)
 S ORMENU=$$MENU D:ORMENU EN^VALM("OR MENU EDITOR")
"RTN","ORCMEDIT",6,0)
 Q
"RTN","ORCMEDIT",7,0)
 ;
"RTN","ORCMEDIT",8,0)
NEW ; -- Change menu
"RTN","ORCMEDIT",9,0)
 D FULL^VALM1 S VALMBCK="R",VALMBG=1
"RTN","ORCMEDIT",10,0)
 N X S X=$$MENU(ORMENU)
"RTN","ORCMEDIT",11,0)
 I X,+X'=+ORMENU S ORMENU=X D INIT,HDR
"RTN","ORCMEDIT",12,0)
 Q
"RTN","ORCMEDIT",13,0)
 ;
"RTN","ORCMEDIT",14,0)
MENU(OROLD) ; -- Select/edit [new] menu
"RTN","ORCMEDIT",15,0)
 N DIC,X,Y,DLAYGO,ORNEW,DA,DIK
"RTN","ORCMEDIT",16,0)
MN1 S DIC="^ORD(101.41,",DIC(0)="AEQL",DLAYGO=101.41,DIC("DR")="4///^S X=""M"""
"RTN","ORCMEDIT",17,0)
 S DIC("A")="Select ORDER MENU: ",DIC("S")="I $P(^(0),U,4)=""M"""
"RTN","ORCMEDIT",18,0)
 S:$G(OROLD) DIC("B")=$P(OROLD,U,2) D ^DIC I Y'>0 Q "^"
"RTN","ORCMEDIT",19,0)
 L +^ORD(101.41,+Y,0):1 I '$T W !!,"Another user is currently editing this menu!",! G MN1
"RTN","ORCMEDIT",20,0)
 L +^XUTL("XQORM",+Y_";ORD(101.41,","XQORM PROTECT",$J):1 E  W !!,"Cannot access menu at this time - try again later.",! G MN1
"RTN","ORCMEDIT",21,0)
 S ORNEW=Y I $P(ORNEW,U,3),$$COPY("M") D
"RTN","ORCMEDIT",22,0)
 . K DLAYGO,DIC("B") S DIC(0)="AEQZ",DIC("A")="Select MENU TO COPY: "
"RTN","ORCMEDIT",23,0)
 . D ^DIC Q:Y'>0  W !,"Copying menu items ..."
"RTN","ORCMEDIT",24,0)
 . M ^ORD(101.41,+ORNEW,10)=^ORD(101.41,+Y,10) ; menu items
"RTN","ORCMEDIT",25,0)
 . M ^ORD(101.41,+ORNEW,2)=^ORD(101.41,+Y,2) ; description
"RTN","ORCMEDIT",26,0)
 . S:$D(^ORD(101.41,+Y,5)) ^ORD(101.41,+ORNEW,5)=^ORD(101.41,+Y,5)
"RTN","ORCMEDIT",27,0)
 . S X=$P(Y(0),U,2),$P(^ORD(101.41,+ORNEW,0),U,2)=X S:X'="" ^ORD(101.41,"C",$$UP^XLFSTR(X),+ORNEW)="" ; display text
"RTN","ORCMEDIT",28,0)
 . S DA(1)=+ORNEW,DIK="^ORD(101.41,"_+ORNEW_",10,",DIK(1)="2^AD" D ENALL^DIK
"RTN","ORCMEDIT",29,0)
 I $P(ORNEW,U,3) S DA=+ORNEW,DIE="^ORD(101.41,",DR="2;20;51;52;53"_$S($G(DUZ(0))="@":";30;40",1:"") D ^DIE
"RTN","ORCMEDIT",30,0)
 I $G(OROLD) L -^ORD(101.41,+OROLD,0),-^XUTL("XQORM",+OROLD_";ORD(101.41,","XQORM PROTECT",$J)
"RTN","ORCMEDIT",31,0)
 Q ORNEW
"RTN","ORCMEDIT",32,0)
 ;
"RTN","ORCMEDIT",33,0)
COPY(TYPE) ; -- Returns 1 or 0, if new item is to be a copy
"RTN","ORCMEDIT",34,0)
 N X,Y,DIR,ITEM S ITEM=$S(TYPE="M":"menu",TYPE="Q":"quick order",TYPE="O":"order set",1:"order dialog")
"RTN","ORCMEDIT",35,0)
 S DIR(0)="YA",DIR("A")="Do you wish to copy an existing "_ITEM_"? "
"RTN","ORCMEDIT",36,0)
 S DIR("?")="Enter YES to copy the items from an existing "_ITEM_" into this one",DIR("B")="YES"
"RTN","ORCMEDIT",37,0)
 D ^DIR
"RTN","ORCMEDIT",38,0)
 Q +Y
"RTN","ORCMEDIT",39,0)
 ;
"RTN","ORCMEDIT",40,0)
EDIT ; -- Edit menu fields
"RTN","ORCMEDIT",41,0)
 N DA,DR,DIE,OR0,OR5,ORNAME D FULL^VALM1 S VALMBCK="R"
"RTN","ORCMEDIT",42,0)
 S ORNAME=$$NAME^ORCMEDT4(+ORMENU) Q:ORNAME="^"
"RTN","ORCMEDIT",43,0)
 I ORNAME="@" S VALMBCK="Q" Q  ;deleted - quit ListMgr
"RTN","ORCMEDIT",44,0)
 S OR0=$G(^ORD(101.41,+ORMENU,0)),OR5=$G(^(5))
"RTN","ORCMEDIT",45,0)
 S DR=".01///^S X=ORNAME;2;20;51;52;53"_$S($G(DUZ(0))="@":";30;40",1:"")
"RTN","ORCMEDIT",46,0)
 S DIE="^ORD(101.41,",DA=+ORMENU D ^DIE
"RTN","ORCMEDIT",47,0)
 I OR0=$G(^ORD(101.41,+ORMENU,0)),OR5=$G(^(5)) Q  ; no change
"RTN","ORCMEDIT",48,0)
 W !!,"Rebuilding menu display ..." D INIT,HDR
"RTN","ORCMEDIT",49,0)
 Q
"RTN","ORCMEDIT",50,0)
 ;
"RTN","ORCMEDIT",51,0)
VIEW ; -- Toggle display between Name and Display Text
"RTN","ORCMEDIT",52,0)
 N OR0 S OR0=$G(^TMP("ORMENU",$J,0))
"RTN","ORCMEDIT",53,0)
 S OR0=$P(OR0,U,1,4)_U_$S($P(OR0,U,5)="I":"E",1:"I")
"RTN","ORCMEDIT",54,0)
 S ^TMP("ORMENU",$J,0)=OR0,VALMBCK="R"
"RTN","ORCMEDIT",55,0)
 W !!,"Rebuilding menu display ..." D INIT
"RTN","ORCMEDIT",56,0)
 Q
"RTN","ORCMEDIT",57,0)
 ;
"RTN","ORCMEDIT",58,0)
INIT ; -- init variables and list array
"RTN","ORCMEDIT",59,0)
 N X,ROWS,ROW,COL,CW,MW,POS,CNT,ITEM,IFN,MNEM,TEXT,FLAG,LINE,XQORM,I,NAME,INT,DA,TS
"RTN","ORCMEDIT",60,0)
 S INT=$P($G(^TMP("ORMENU",$J,0)),U,5) ; int/ext flag
"RTN","ORCMEDIT",61,0)
 D CLEAN^VALM10,KILL(+ORMENU) ; kill array for rebuilding
"RTN","ORCMEDIT",62,0)
 S ROWS=$P($O(^ORD(101.41,+ORMENU,10,"B",""),-1),".")
"RTN","ORCMEDIT",63,0)
 S VALMCNT=$S(ROWS>51:ROWS,1:51) ; 3 full screens of row #
"RTN","ORCMEDIT",64,0)
 F ROW=1:1:VALMCNT D  ; set-up grid
"RTN","ORCMEDIT",65,0)
 . S X=$S((ROW/10)=(ROW\10):ROW/10,(ROW/5)=(ROW\5):"+",1:"|")
"RTN","ORCMEDIT",66,0)
 . S ^TMP("ORMENU",$J,ROW,0)=X_$$REPEAT^XLFSTR(" ",79)
"RTN","ORCMEDIT",67,0)
 S CW=$P($G(^ORD(101.41,+ORMENU,5)),U),MW=$P($G(^(5)),U,2)
"RTN","ORCMEDIT",68,0)
 S:'CW CW=80 S:'MW MW=5 S XQORM=+ORMENU_";"_$J
"RTN","ORCMEDIT",69,0)
 S CNT=0 G:'$O(^ORD(101.41,+ORMENU,10,0)) INQ ; new menu, no items yet
"RTN","ORCMEDIT",70,0)
IN1 S POS=0 F  S POS=$O(^ORD(101.41,+ORMENU,10,"B",POS)) Q:POS'>0  S DA=0 F  S DA=$O(^ORD(101.41,+ORMENU,10,"B",POS,DA)) Q:'DA  D
"RTN","ORCMEDIT",71,0)
 . S ROW=$P(POS,"."),COL=$$COLUMN($P(POS,".",2),CW)
"RTN","ORCMEDIT",72,0)
 . S ITEM=$G(^ORD(101.41,+ORMENU,10,DA,0)),IFN=$P(ITEM,U,2)
"RTN","ORCMEDIT",73,0)
 . S MNEM=$P(ITEM,U,3),FLAG=$P(ITEM,U,5) S:IFN ITM=$G(^ORD(101.41,IFN,0))
"RTN","ORCMEDIT",74,0)
 . I INT="I" S TEXT=$S(IFN:$P(ITM,U),1:"")
"RTN","ORCMEDIT",75,0)
 . I INT'="I" S TEXT=$P(ITEM,U,4) I '$L(TEXT),IFN S TEXT=$P(ITM,U,2)
"RTN","ORCMEDIT",76,0)
 . Q:'$L(TEXT)  I FLAG=2 S TEXT=$E(TEXT,1,CW),X=TEXT D SETVIDEO(ROW,COL+1,$L($G(TEXT)),IOUON,IOUOFF)
"RTN","ORCMEDIT",77,0)
 . I FLAG<2 S X=MNEM_$E("         ",1,MW-$L(MNEM))_$E(TEXT,1,CW-MW) D SETVIDEO(ROW,COL+1,MW,IOINHI,IOINORM)
"RTN","ORCMEDIT",78,0)
 . S LINE=$G(^TMP("ORMENU",$J,ROW,0)),^TMP("ORMENU",$J,ROW,0)=$$SETSTR^VALM1(X,LINE,COL+1,CW),CNT=CNT+1,TEXT=$$STRIP(TEXT) Q:'$L(TEXT)
"RTN","ORCMEDIT",79,0)
 . S ^TMP("ORMENU",$J,"B",$$UP(TEXT))=DA S:$L(MNEM) ^($$UP(MNEM))=DA
"RTN","ORCMEDIT",80,0)
 . S ^XUTL("XQORM",XQORM,POS,0)=DA_U_IFN_U_TEXT_U_MNEM,^XUTL("XQORM",XQORM,"B",$$UP(TEXT),POS)="" S:$L(MNEM) ^XUTL("XQORM",XQORM,"B",$$UP(MNEM),POS)=1
"RTN","ORCMEDIT",81,0)
 . I IFN,INT'="I" S NAME=$P(ITM,U) S:$L(NAME) ^XUTL("XQORM",XQORM,"B",$$UP(NAME),POS)=1
"RTN","ORCMEDIT",82,0)
INQ S ^TMP("ORMENU",$J,0)=ROWS_U_CNT_U_CW_U_MW_U_INT ;,VALMBG=1
"RTN","ORCMEDIT",83,0)
 M ^TMP("VALM VIDEO",$J,VALMEVL)=^TMP("ORMENU",$J,"VIDEO")
"RTN","ORCMEDIT",84,0)
 S X="" F I=1:1 S COL=(I-1)*CW+1 Q:COL>80  S $E(X,COL)=I,ORCOL=I
"RTN","ORCMEDIT",85,0)
 D CHGCAP^VALM("LINE",X) S TS=$G(^ORD(101.41,+ORMENU,99)) ; set caption heading
"RTN","ORCMEDIT",86,0)
 S:$D(^XUTL("XQORM",XQORM)) ^(XQORM,"COL")=ORCOL,^(0)=TS
"RTN","ORCMEDIT",87,0)
 Q
"RTN","ORCMEDIT",88,0)
 ;
"RTN","ORCMEDIT",89,0)
SETVIDEO(ROW,COL,WIDTH,ON,OFF) ; -- Set video attributes
"RTN","ORCMEDIT",90,0)
 S ^TMP("ORMENU",$J,"VIDEO",ROW,COL,WIDTH)=ON
"RTN","ORCMEDIT",91,0)
 S ^TMP("ORMENU",$J,"VIDEO",ROW,COL+WIDTH,0)=OFF
"RTN","ORCMEDIT",92,0)
 Q
"RTN","ORCMEDIT",93,0)
 ;
"RTN","ORCMEDIT",94,0)
UP(X) ; -- Convert X to uppercase
"RTN","ORCMEDIT",95,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","ORCMEDIT",96,0)
 ;
"RTN","ORCMEDIT",97,0)
STRIP(X) ; -- Strip leading spaces from text X
"RTN","ORCMEDIT",98,0)
 N I,Y S Y=""
"RTN","ORCMEDIT",99,0)
 F I=1:1:$L(X) I $E(X,I)'=" " S Y=$E(X,I,999) Q
"RTN","ORCMEDIT",100,0)
 Q Y
"RTN","ORCMEDIT",101,0)
 ;
"RTN","ORCMEDIT",102,0)
COLUMN(NUM,WIDTH) ; -- Returns position for column NUM per WIDTH
"RTN","ORCMEDIT",103,0)
 N Y S:'$G(NUM) NUM=1 S:'$G(WIDTH) WIDTH=80
"RTN","ORCMEDIT",104,0)
 S Y=(NUM-1)*WIDTH+1
"RTN","ORCMEDIT",105,0)
 Q Y
"RTN","ORCMEDIT",106,0)
 ;
"RTN","ORCMEDIT",107,0)
HDR ; -- header code
"RTN","ORCMEDIT",108,0)
 N X,Y S X="Menu: "_$P(ORMENU,U,2)
"RTN","ORCMEDIT",109,0)
 S Y="Column Width: "_$P($G(^TMP("ORMENU",$J,0)),U,3)
"RTN","ORCMEDIT",110,0)
 S VALMHDR(1)=X_$$REPEAT^XLFSTR(" ",79-$L(X)-$L(Y))_Y
"RTN","ORCMEDIT",111,0)
 Q
"RTN","ORCMEDIT",112,0)
 ;
"RTN","ORCMEDIT",113,0)
HELP ; -- help code
"RTN","ORCMEDIT",114,0)
 N X D FULL^VALM1 S VALMBCK="R"
"RTN","ORCMEDIT",115,0)
 W !,"  This is how this menu will appear to the user in the Add New Orders"
"RTN","ORCMEDIT",116,0)
 W !,"  option.  Select ADD, REMOVE, or EDIT to make changes to this menu, or"
"RTN","ORCMEDIT",117,0)
 W !,"  ASSIGN to set it as the default for users.  Use the ORDER DIALOGS option"
"RTN","ORCMEDIT",118,0)
 W !,"  to change or create quick orders for this menu."
"RTN","ORCMEDIT",119,0)
 W !,"Press <return> to continue ..." R X:DTIME
"RTN","ORCMEDIT",120,0)
 Q
"RTN","ORCMEDIT",121,0)
 ;
"RTN","ORCMEDIT",122,0)
MSG() ; -- Msg bar
"RTN","ORCMEDIT",123,0)
 Q "+ Next Screen  - Prev Screen  ?? More Actions"
"RTN","ORCMEDIT",124,0)
 ;
"RTN","ORCMEDIT",125,0)
EXIT ; -- exit code
"RTN","ORCMEDIT",126,0)
 L -^ORD(101.41,+ORMENU,0),-^XUTL("XQORM",+ORMENU_";ORD(101.41,","XQORM PROTECT",$J)
"RTN","ORCMEDIT",127,0)
 D KILL(+ORMENU) K VALMHDR,VALMCNT,VALMBG,ORMENU,ORCOL,^TMP("ORMENU",$J)
"RTN","ORCMEDIT",128,0)
 Q
"RTN","ORCMEDIT",129,0)
 ;
"RTN","ORCMEDIT",130,0)
KILL(DA) ; -- Cleanup compiled menu from editor
"RTN","ORCMEDIT",131,0)
 K ^XUTL("XQORM",DA_";"_$J)
"RTN","ORCMEDIT",132,0)
 Q
"RTN","ORSNAST")
0^2^B24821393^B21819774
"RTN","ORSNAST",1,0)
ORSNAST ;SLC/RAF - Policy order search  ;06/25/2007
"RTN","ORSNAST",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**50,263**;Dec 17, 1997;Build 9
"RTN","ORSNAST",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","ORSNAST",4,0)
 ;
"RTN","ORSNAST",5,0)
 ;this utility will allow the user to enter a date range to search
"RTN","ORSNAST",6,0)
 ;the orders file, 100, looking for orders with a specific nature
"RTN","ORSNAST",7,0)
 ;of order or status
"RTN","ORSNAST",8,0)
 ;
"RTN","ORSNAST",9,0)
 ;
"RTN","ORSNAST",10,0)
EN ;
"RTN","ORSNAST",11,0)
 S U="^" K ^TMP("ORNS",$J),^TMP("ORSERV",$J)
"RTN","ORSNAST",12,0)
 W @IOF,!!?18,"Nature of Order or Order Status Search.",!?15,"This report is formatted for 132 column output."
"RTN","ORSNAST",13,0)
 N DASH,DATE,DFN,DIR,DTOUT,DUOUT,EDATE,FORMAT,HDR,HDR1,IEN
"RTN","ORSNAST",14,0)
 N LOC,LONER,ORIGVIEW,PAGE,PNM,PROV,QUIT,REF,RPDT,SDATE,SER,SERVICE,STOP,TEXT,TEXTSUB
"RTN","ORSNAST",15,0)
 N SINGLE,SIGNED,SNAME,SSN,STATUS,SORT,SEARCH,SUB
"RTN","ORSNAST",16,0)
 N VA,VADM,WHEN,WHO,Y
"RTN","ORSNAST",17,0)
SORT S DIR(0)="SX^1:Nature of order;2:Order Status"
"RTN","ORSNAST",18,0)
 S DIR("A")="Enter the search criteria"
"RTN","ORSNAST",19,0)
 S DIR("?")="Enter a 1 to search orders by the Nature of order or a 2 to search orders by the Order Status. Enter an ^ to exit the option."
"RTN","ORSNAST",20,0)
 D ^DIR S:+Y>0 SORT=+Y K DIR I $D(DTOUT)!($D(DUOUT)) G EXIT
"RTN","ORSNAST",21,0)
 S DIR(0)=$S(SORT=1:"PA^100.02:AEMQ",SORT=2:"PA^100.01:AEMQ")
"RTN","ORSNAST",22,0)
 S DIR("A")="Select "_$S(SORT=1:"Nature of order: ",1:"Order Status: ")
"RTN","ORSNAST",23,0)
 D ^DIR S:+Y>0 SEARCH=+Y,SNAME=$P(Y,U,2) K DIR I $D(DTOUT)!($D(DUOUT)) G EXIT
"RTN","ORSNAST",24,0)
 D SDATE I $D(DTOUT)!$D(DUOUT) G EXIT
"RTN","ORSNAST",25,0)
 D EDATE I $D(DTOUT)!$D(DUOUT) G EXIT
"RTN","ORSNAST",26,0)
 D CKDATE I $D(DTOUT)!$D(DUOUT) G EXIT
"RTN","ORSNAST",27,0)
FORMAT ;allows choice of formats for evaluation purpose
"RTN","ORSNAST",28,0)
 S DIR(0)="SX^1:Detailed format;2:Columnar format"
"RTN","ORSNAST",29,0)
 S DIR("A")="Select output format"
"RTN","ORSNAST",30,0)
 S DIR("?")="Enter a 1 for a Detailed format and a 2 for a Columnar format. Enter an ^ to exit the option."
"RTN","ORSNAST",31,0)
 D ^DIR S:+Y>0 FORMAT=+Y K DIR I $D(DTOUT)!$D(DUOUT) G EXIT
"RTN","ORSNAST",32,0)
SERV ;sets the variable SERVICE equal to 1 if the user wants to sort by
"RTN","ORSNAST",33,0)
 ;service, or sets it to 0 if not
"RTN","ORSNAST",34,0)
 I FORMAT=2 D  I $D(DTOUT)!($D(DUOUT)) G EXIT
"RTN","ORSNAST",35,0)
 .S DIR(0)="Y"
"RTN","ORSNAST",36,0)
 .S DIR("A")="Would you like to sort the output by service"
"RTN","ORSNAST",37,0)
 .S DIR("?")="If you answer yes, the output will be sorted by service. Enter an ^ to exit the option."
"RTN","ORSNAST",38,0)
 .S DIR("B")="NO"
"RTN","ORSNAST",39,0)
 .D ^DIR S SERVICE=+Y K DIR
"RTN","ORSNAST",40,0)
SINGLE ;sets variable SINGLE to set up a search of a single service
"RTN","ORSNAST",41,0)
 I FORMAT=2&($G(SERVICE)) D  I $D(DTOUT)!($D(DUOUT)) G EXIT
"RTN","ORSNAST",42,0)
 .S DIR(0)="Y",DIR("B")="NO"
"RTN","ORSNAST",43,0)
 .S DIR("A")="Would you like to search for specific SERVICE/SECTIONS"
"RTN","ORSNAST",44,0)
 .S DIR("?")="Enter a YES to search by a single SERVICE/SECTION. You may either press enter without selecting a SERVICE/SECTION or enter an ^ to exit the option,"
"RTN","ORSNAST",45,0)
 .D ^DIR S:+Y>0 SINGLE=+Y K DIR
"RTN","ORSNAST",46,0)
LONER ;sets DIR call to allow the user to select a single service/section
"RTN","ORSNAST",47,0)
 I FORMAT=2&($G(SERVICE))&($G(SINGLE)) D  I $D(QUIT)!('$D(LONER)) G EXIT
"RTN","ORSNAST",48,0)
 .F  D  I $D(QUIT)!(Y=-1) Q
"RTN","ORSNAST",49,0)
 ..S DIR(0)="PAO^49:AEQM"
"RTN","ORSNAST",50,0)
 ..S DIR("A")="Select Service/Section: "
"RTN","ORSNAST",51,0)
 ..D ^DIR S:+Y>0 LONER($P(Y,U,2))=+Y K DIR I $D(DTOUT)!($D(DUOUT)) S QUIT=1
"RTN","ORSNAST",52,0)
TASK ;
"RTN","ORSNAST",53,0)
 S %ZIS="Q" D ^%ZIS I POP Q
"RTN","ORSNAST",54,0)
 I $D(IO("Q")) D  K IO("Q") Q
"RTN","ORSNAST",55,0)
 .S ZTIO=ION,ZTDESC="File 100 order status search"
"RTN","ORSNAST",56,0)
 .S ZTRTN="EN^ORSNAST1",ZTSAVE("SORT")="",ZTSAVE("FORMAT")=""
"RTN","ORSNAST",57,0)
 .S ZTSAVE("SDATE")="",ZTSAVE("EDATE")="",ZTSAVE("SEARCH")=""
"RTN","ORSNAST",58,0)
 .S ZTSAVE("SNAME")="",ZTSAVE("SERVICE")="",ZTSAVE("SD1")=""
"RTN","ORSNAST",59,0)
 .S ZTSAVE("ED1")="",ZTSAVE("LONER*")="",ZTSAVE("SINGLE")=""
"RTN","ORSNAST",60,0)
 .D ^%ZTLOAD I $D(ZTSK) W !,?32,"REQUEST QUEUED"
"RTN","ORSNAST",61,0)
 U IO D EN^ORSNAST1
"RTN","ORSNAST",62,0)
 G EXIT
"RTN","ORSNAST",63,0)
 ;
"RTN","ORSNAST",64,0)
SDATE ;sets DIR call to ask the user for a starting date
"RTN","ORSNAST",65,0)
 S DIR(0)="DA^::ETX"
"RTN","ORSNAST",66,0)
 S DIR("A")="Enter a starting date: "
"RTN","ORSNAST",67,0)
 S DIR("?")="Enter the date that you wish to start searching with. This date needs to be older than the ending date. For example: If you enter a start date of T-3, the Stop date should be T-2 or less. Enter an ^ to exit the option."
"RTN","ORSNAST",68,0)
 D ^DIR S:+Y>0 SDATE=+Y K DIR I $D(DTOUT)!($D(DUOUT)) Q
"RTN","ORSNAST",69,0)
 I SDATE'["." S SDATE=SDATE_.0001
"RTN","ORSNAST",70,0)
 Q
"RTN","ORSNAST",71,0)
EDATE ;sets DIR call to ask the user for an ending date (optional)
"RTN","ORSNAST",72,0)
 S DIR(0)="DA^::ETX"
"RTN","ORSNAST",73,0)
 S DIR("A")="Enter a ending date: "
"RTN","ORSNAST",74,0)
 S DIR("?")="Enter the date that you would like the search to end with. This date needs to be more recent than the start date. For example: If you entered a T-3 for the start date, enter a T-2 or less here. Enter an ^ to exit the option."
"RTN","ORSNAST",75,0)
 D ^DIR S:+Y>0 EDATE=+Y K DIR I $D(DTOUT)!($D(DUOUT)) Q
"RTN","ORSNAST",76,0)
 I EDATE'["." S EDATE=EDATE_.2359
"RTN","ORSNAST",77,0)
 Q
"RTN","ORSNAST",78,0)
CKDATE ; Make sure the end date is not older than the start date.
"RTN","ORSNAST",79,0)
 I EDATE>SDATE Q
"RTN","ORSNAST",80,0)
 W !!,?10,"The starting date must be older than the ending date.",!,?10,"Please re-enter start and end dates.",!!
"RTN","ORSNAST",81,0)
 D SDATE I $D(DTOUT)!$D(DUOUT) Q
"RTN","ORSNAST",82,0)
 D EDATE I $D(DTOUT)!$D(DUOUT) Q
"RTN","ORSNAST",83,0)
 G CKDATE
"RTN","ORSNAST",84,0)
EXIT ;
"RTN","ORSNAST",85,0)
 K ^TMP("ORNS",$J),^TMP("ORSERV",$J)
"RTN","ORSNAST",86,0)
 D ^%ZISC
"RTN","ORSNAST",87,0)
 Q
"RTN","ORWRPP1")
0^4^B23307424^B22861977
"RTN","ORWRPP1",1,0)
ORWRPP1 ; slc/dcm - Background Report Prints (cont.) ; 12/05/02  11:02
"RTN","ORWRPP1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**109,160,192,263**;Dec 17, 1997;Build 9
"RTN","ORWRPP1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","ORWRPP1",4,0)
MEDB(ROOT,ORDFN,OREXAMID,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)  ;Print Medicine report
"RTN","ORWRPP1",5,0)
 K ^TMP("MCAR",$J)
"RTN","ORWRPP1",6,0)
 ;I '$D(^MCAR(690,"AC",ORDFN)) Q
"RTN","ORWRPP1",7,0)
 N ORHFS,%,%I,DA,DILCT,DISTP,S1,S2,S4,S6,TY,WH
"RTN","ORWRPP1",8,0)
 S ORHFS=1
"RTN","ORWRPP1",9,0)
 D EN^MCARPS2(ORDFN)
"RTN","ORWRPP1",10,0)
 D MEDB^ORWRP1(.ROOT,.ORDFN,.OREXAMID,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",11,0)
 K ^TMP("MCAR",$J)
"RTN","ORWRPP1",12,0)
 Q
"RTN","ORWRPP1",13,0)
HSB(ROOT,ORDFN,ORHSTYPE,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)   ;Print Health Summary report
"RTN","ORWRPP1",14,0)
 IF $O(ORCOMP(0)) D SITE^ORWRPP($G(STATION)),PREPORT^ORWRP2(.ROOT,.ORCOMP,.ORDFN) Q
"RTN","ORWRPP1",15,0)
 D SITE^ORWRPP($G(STATION)),HSB^ORWRP1(.ROOT,.ORDFN,.ORHSTYPE,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",16,0)
 Q
"RTN","ORWRPP1",17,0)
HSTYPEB(ROOT,ORDFN,ORHSTYPE,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)       ;Print Health Summary type report
"RTN","ORWRPP1",18,0)
 D HSTYPEB^ORWRP1(.ROOT,.ORDFN,$P(ORHSTYPE,";",3),.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",19,0)
 Q
"RTN","ORWRPP1",20,0)
LSB(ROOT,ORDFN,ORHSTYPE,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)   ;Print Lab Status Report        
"RTN","ORWRPP1",21,0)
 N ORY,PAGE,ORVP,TEXT
"RTN","ORWRPP1",22,0)
 S ORVP=ORDFN_";DPT("
"RTN","ORWRPP1",23,0)
 D EN1^LR7OSOS1(.ORY,ORVP,.ORALPHA,.OROMEGA,.ORDTRNG)
"RTN","ORWRPP1",24,0)
 Q:'$L(ORY)
"RTN","ORWRPP1",25,0)
 S PAGE=1,TEXT="PATIENT LAB ORDER STATUS REPORT ("_$$FMTE^XLFDT(ORALPHA)_" - "_$$FMTE^XLFDT(OROMEGA)_")"
"RTN","ORWRPP1",26,0)
 D HEAD(ORDFN,PAGE,TEXT)
"RTN","ORWRPP1",27,0)
 D HURL(.ORY,ORDFN,TEXT)
"RTN","ORWRPP1",28,0)
 Q
"RTN","ORWRPP1",29,0)
BCMA2B(ROOT,ORDFN,OREXAMID,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)        ;Print BCMA Med Hist
"RTN","ORWRPP1",30,0)
 N ORY,PAGE,TEXT
"RTN","ORWRPP1",31,0)
 D
"RTN","ORWRPP1",32,0)
 . N IO
"RTN","ORWRPP1",33,0)
 . D BCMA2^ORWRP1A(.ORY,.ORDFN,.OREXAMID,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",34,0)
 U IO
"RTN","ORWRPP1",35,0)
 Q:'$L(ORY)
"RTN","ORWRPP1",36,0)
 S PAGE=1,TEXT="PATIENT BCMA MEDICATION HISTORY BCMA ("_$$FMTE^XLFDT(ORALPHA)_" - "_$$FMTE^XLFDT(OROMEGA)_")"
"RTN","ORWRPP1",37,0)
 D HEAD(ORDFN,PAGE,TEXT,$G(STATION))
"RTN","ORWRPP1",38,0)
 D HURL(.ORY,ORDFN,TEXT,1)
"RTN","ORWRPP1",39,0)
 I $L($G(ORY)) K @ORY
"RTN","ORWRPP1",40,0)
 Q
"RTN","ORWRPP1",41,0)
BCMA1B(ROOT,ORDFN,OREXAMID,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE)        ;Print BCMA Med Log
"RTN","ORWRPP1",42,0)
 N ORY,PAGE,TEXT
"RTN","ORWRPP1",43,0)
 D
"RTN","ORWRPP1",44,0)
 . N IO
"RTN","ORWRPP1",45,0)
 . D BCMA1^ORWRP1A(.ORY,.ORDFN,.OREXAMID,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",46,0)
 U IO
"RTN","ORWRPP1",47,0)
 Q:'$L(ORY)
"RTN","ORWRPP1",48,0)
 S PAGE=1,TEXT="PATIENT MEDICATION LOG BCMA ("_$$FMTE^XLFDT(ORALPHA)_" - "_$$FMTE^XLFDT(OROMEGA)_")"
"RTN","ORWRPP1",49,0)
 D HEAD(ORDFN,PAGE,TEXT,$G(STATION))
"RTN","ORWRPP1",50,0)
 D HURL(.ORY,ORDFN,TEXT,1)
"RTN","ORWRPP1",51,0)
 I $L($G(ORY)) K @ORY
"RTN","ORWRPP1",52,0)
 Q
"RTN","ORWRPP1",53,0)
PROBB(ROOT,ORDFN,OREXAMID,ORALPHA,OROMEGA,ORDTRNG,REMOTE,ORMAX,ORFHIE) ;Print Problem List (Problem Tab)
"RTN","ORWRPP1",54,0)
 D SITE^ORWRPP($G(STATION)),PROBB^ORWRP1(.ORY,.ORDFN,.ID,.ORALPHA,.OROMEGA,.ORDTRNG,.REMOTE,.ORMAX,.ORFHIE)
"RTN","ORWRPP1",55,0)
 Q
"RTN","ORWRPP1",56,0)
GETVTYPE        ;Print V Type reports
"RTN","ORWRPP1",57,0)
 S PAGE=1,ORY="ORRPT"
"RTN","ORWRPP1",58,0)
 D HEAD(ORDFN,PAGE,ORHEAD,$G(STATION))
"RTN","ORWRPP1",59,0)
 D HURL(.ORY,ORDFN,ORHEAD,1)
"RTN","ORWRPP1",60,0)
 Q
"RTN","ORWRPP1",61,0)
PRINTV(ORY,ORIO,ORDFN,ORHEAD,ORRPT) ;Print data for remote sites
"RTN","ORWRPP1",62,0)
 ;  RPC: ORWRP PRINT V REPORT
"RTN","ORWRPP1",63,0)
 N ZTDTH,ZTRTN,ZTSK,ZTDESC,ZTSAVE,I,ORHSTAG
"RTN","ORWRPP1",64,0)
 ;S ORHSTAG=$P($G(ORRPTID),"~",2),ORRPTID=$P($G(ORRPTID),"~"),ORRPTID=$P($P(ORRPTID,";"),":")
"RTN","ORWRPP1",65,0)
 S ZTIO=ORIO,ZTDTH=$H
"RTN","ORWRPP1",66,0)
 S ZTDESC="Remote V Report Print"
"RTN","ORWRPP1",67,0)
 S ZTRTN="GETVTYPE^ORWRPP1"
"RTN","ORWRPP1",68,0)
 F I="ORDFN","ORHEAD","ORRPT(" S ZTSAVE(I)=""
"RTN","ORWRPP1",69,0)
 D ^%ZTLOAD
"RTN","ORWRPP1",70,0)
 I $D(ZTSK) D
"RTN","ORWRPP1",71,0)
 . S ORY="0^Report queued. (Task #"_ZTSK_")"
"RTN","ORWRPP1",72,0)
 E  D
"RTN","ORWRPP1",73,0)
 . S ORY="99^Task Rejected."
"RTN","ORWRPP1",74,0)
 Q
"RTN","ORWRPP1",75,0)
HEAD(ORDFN,PAGE,TITLE,STATION) ;Print a patient header
"RTN","ORWRPP1",76,0)
 Q:'$G(ORDFN)
"RTN","ORWRPP1",77,0)
 N %,%H,%I,DISYS,ORAGE,ORDOB,ORHLINE,ORL,ORNP,ORPNM,ORPV,ORSEX,ORSSN,ORTS,ORWARD,VA,X,ORI
"RTN","ORWRPP1",78,0)
 S:'$L($G(TITLE)) TITLE="PATIENT REPORT"
"RTN","ORWRPP1",79,0)
 D PAT^ORPR03(ORDFN)
"RTN","ORWRPP1",80,0)
 D SITE^ORWRPP($G(STATION))
"RTN","ORWRPP1",81,0)
 W !,TITLE,?(IOM-$L("Page "_PAGE)),"Page "_PAGE
"RTN","ORWRPP1",82,0)
 S X=ORDOB_" ("_ORAGE_")"
"RTN","ORWRPP1",83,0)
 W !,ORPNM_"   "_ORSSN,?39,$G(ORL(0))_$S($L($G(ORL(1))):"/"_ORL(1),1:""),?(79-$L(X)),X
"RTN","ORWRPP1",84,0)
 S $P(ORHLINE,"=",IOM+1)=""
"RTN","ORWRPP1",85,0)
 W !,ORHLINE
"RTN","ORWRPP1",86,0)
 S X="Printed: "_$$DATE^ORU($$NOW^XLFDT,"MM/DD/CCYY HR:MIN")
"RTN","ORWRPP1",87,0)
 W !?27,"*** WORK COPY ONLY ***",?(IOM-($L(X))-1),X
"RTN","ORWRPP1",88,0)
 Q
"RTN","ORWRPP1",89,0)
HURL(Y,ORDFN,TITLE,FORMAT,STATION,READ) ;Write out the file
"RTN","ORWRPP1",90,0)
 ;FORMAT tells me which node to go after
"RTN","ORWRPP1",91,0)
 N L,NOHURL,A,OUT
"RTN","ORWRPP1",92,0)
 S OUT=0,L="",NOHURL=0
"RTN","ORWRPP1",93,0)
 F  S L=$O(@Y@(L)) Q:L=""  Q:OUT  D
"RTN","ORWRPP1",94,0)
 . I $Y+4>IOSL D
"RTN","ORWRPP1",95,0)
 .. S PAGE=PAGE+1
"RTN","ORWRPP1",96,0)
 .. W !?27,"*** WORK COPY ONLY ***     (continued...)"
"RTN","ORWRPP1",97,0)
 .. I $G(READ),$G(IOT)'["HFS" R !,"^ TO STOP: ",A:DTIME I A["^" S OUT=1 Q
"RTN","ORWRPP1",98,0)
 .. W @IOF
"RTN","ORWRPP1",99,0)
 .. I $G(IOT)["HFS" S $Y=0
"RTN","ORWRPP1",100,0)
 .. D HEAD(ORDFN,PAGE,$G(TITLE),$G(STATION))
"RTN","ORWRPP1",101,0)
 .. W !,"(...continued)"
"RTN","ORWRPP1",102,0)
 . I $G(FORMAT) D  Q
"RTN","ORWRPP1",103,0)
 .. Q:'$D(@Y@(L))
"RTN","ORWRPP1",104,0)
 .. I NOHURL,$P(@Y@(L),"^")'="[REPORT TEXT]" Q
"RTN","ORWRPP1",105,0)
 .. I NOHURL,$P(@Y@(L),"^")="[REPORT TEXT]" S NOHURL=0 Q
"RTN","ORWRPP1",106,0)
 .. I $P(@Y@(L),"^")="[HIDDEN TEXT]" S NOHURL=1 Q
"RTN","ORWRPP1",107,0)
 .. I @Y@(L)["**PAGE BREAK**" Q
"RTN","ORWRPP1",108,0)
 .. W !,@Y@(L)
"RTN","ORWRPP1",109,0)
 . Q:'$D(@Y@(L,0))
"RTN","ORWRPP1",110,0)
 . I NOHURL,$P(@Y@(L,0),"^")'="[REPORT TEXT]" Q
"RTN","ORWRPP1",111,0)
 . I NOHURL,$P(@Y@(L,0),"^")="[REPORT TEXT]" S NOHURL=0 Q
"RTN","ORWRPP1",112,0)
 . I $P(@Y@(L,0),"^")="[HIDDEN TEXT]" S NOHURL=1 Q
"RTN","ORWRPP1",113,0)
 . I @Y@(L,0)["**PAGE BREAK**" Q
"RTN","ORWRPP1",114,0)
 . W !,@Y@(L,0)
"RTN","ORWRPP1",115,0)
 W !?27,"*** WORK COPY ONLY ***"
"RTN","ORWRPP1",116,0)
 Q
"VER")
8.0^22.0
"BLD",6921,6)
^251
**END**
**END**
