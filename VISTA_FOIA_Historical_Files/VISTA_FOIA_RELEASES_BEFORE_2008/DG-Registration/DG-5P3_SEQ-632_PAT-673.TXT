
=============================================================================
Run Date: SEP 13, 2006                     Designation: DG*5.3*673
Package : DG - REGISTRATION                   Priority: EMERGENCY
Version : 5.3       SEQ #632                    Status: Released
                  Compliance Date: SEP 15, 2006
=============================================================================

Associated patches: (v)DG*5.3*363      install with patch       `DG*5.3*673'
                    (v)DG*5.3*625      install with patch       `DG*5.3*673'
                    (v)DG*5.3*626      install with patch       `DG*5.3*673'
                    (v)DG*5.3*628      install with patch       `DG*5.3*673'
                    (v)DG*5.3*632      install with patch       `DG*5.3*673'
                    (v)DG*5.3*672      install with patch       `DG*5.3*673'
                    (v)DG*5.3*700      install with patch       `DG*5.3*673'

Subject: Operation Enduring & Iraqi Freedom Phase I

Category: 
  - Enhancement ()
  - Data Dictionary
  - Routine

Description:
============

 I. OVERVIEW
  
 This patch introduces Phase I of changes and enhancements to the
 Registration V. 5.3 package in support of the Operation Enduring & Iraqi
 Freedom (OEF/OIF) initiative.
  
                          I M P O R T A N T 
  *************************************************************************
  This patch, DG*5.3*673, along with Income Verification Match patch
  IVM*2*114, is being released in a single KIDS software distribution
  (host file). This patch only includes the informational portion of
  DG*5.3*673.
  
  In order to coordinate this new initiative with the Health Eligibility 
  Center (HEC) so that the data can be seeded nationally, a 3 day window 
  for compliance has been approved
  
  Please refer to the "Software and Documentation Retrieval" and
  "Installation Instructions" sections of this patch description for the
  instructions on how to acquire, install, and implement the patch
  software.
  *************************************************************************
  
 The management at the Health Eligibility Center (HEC) has requested
 that VistA be enhanced to identify the combat periods for veterans who
 were deployed to the areas covered under Operation Enduring Freedom (OEF)
 and Operation Iraqi Freedom (OIF).  To accomplish this and to provide the
 VistA sites with as much 'seeded' information related to OEF and OIF as
 possible, this patch will modify VistA to enable it to receive OEF and OIF
 data from the HEC.  The source of this data to be seeded into VistA 
 is the OEF/OIF data registry that is present at the HEC.
   
 There will be very few obvious changes to VistA when this patch is
 installed as the changes are primarily being made to the filing of HL7 
 Z11 message data in the background.  After the seeding is complete, 
 another patch will be released (DG*5.3*689) that will allow VistA users to
 see and to enter/edit OEF and OIF information as it is received from the 
 veteran and/or HEC.  This new data will be used in the calculation of
 combat vet (CV) end date, so until patch DG*5.3*689 is released, there
 will be a short period of time where the CV end date may be based on this
 OEF/OIF information, even though it is not yet visible to the VistA user.
 Patch DG*5.3*689 will also contain the editing capabilities for the new 
 service component fields.
  
  
 II. ASSOCIATED REMEDY TICKETS & NEW SERVICE REQUESTS
  
 The following section lists the Remedy tickets and/or New Service Requests
 associated with this patch.
  
 1. Associated Remedy Tickets:
    -----------------------------------------
    NONE
  
 2. Associated New Service Request(s):
    -----------------------------------------
    * NSR 20050603: ADD OPERATION IRAQI FREEDOM AND AFGHANISTAN TO FILE
      #21 AND AND FILE #22
    * NSR 20050506: Adding Combat Location to Inpatient/Outpatient Austin 
      Workload Files
  
  
 III. FUNCTIONAL OVERVIEW
  
 The following is an overview of the primary functionality that will be
 delivered in this patch.
  
 1. There are two new specific conflict service locations and one new 
    non-specific service location being defined for veterans, although 
    none of these will be visible to the VistA user until the initial
    seeding from HEC sources has been completed and the follow-up patch
    DG*5.3*689 is installed.
  
      OEF - Operation Enduring Freedom
      OIF - Operation Iraqi Freedom
      UNKNOWN OEF/OIF - Veteran has been determined to have served in
            either OEF or OIF, but the specific service location is still
            being determined. Only HEC will be able to enter/edit/delete
            this location.
  
 2. An initial seeding of this new OEF/ OIF/ UNKNOWN OEF/OIF data into 
    VistA will be automatically performed by HEC once all the sites have
    installed this patch.  The seeding will be run using the existing HL7
    messaging functionality with new data added to the messages, and will
    require several days to complete.
  
      a.  The filer for the Z11 HL7 message that is received from HEC has
          been modified to include filing of OEF/OIF data into the
          veteran's record.  This data received on the Z11 will initially
          consist of the conflict location, conflict from date and a
          conflict to date.  It will also eventually contain the site # of
          the initiating site if the data was entered in VistA and shared
          with all sites of record. During the filing, VistA will add the
          date/time the record was filed on the VistA system along with a
          lock flag. The DATA LOCKED field value 'YES' will mean that the 
          source of data was 'CEV'(Centralized Eligibility Verification -
          aka HEC) and no site-entered edits will be permitted.
  
      b.  When the OEF/OIF data is loaded into VistA from the Z11 HL7
          message, the registration consistency checks for overlapping
          dates with other conflicts and the requirement that a conflict
          date must be within the veteran's military service episodes will
          be ignored. Any data inconsistencies generated as a result will
          be resolved in a future registration patch.
  
     c.  The OEF/OIF data will be stored in a new multiple field in
         the PATIENT file (#2), SERVICE [OEF OR OIF] (#.3215).  Note this 
         is the first time VistA will allow conflict locations to have
         more than one period recorded.  Only these three new conflict 
         locations will have this multiple instance capability.
  
     d.  When the new data is filed in VistA, a Z07 message will be
         generated back to HEC for the veteran so the file identifying 
         site data at HEC can be kept current.
    
     e.  OEF/OIF data received into a VistA system via a Z11 upload from
         HEC will not be used in checking for inconsistencies at the end 
         of registration EXCEPT for the following:
            An inconsistency will be generated if the OEF/OIF data does not
            fall within the military service dates on file for the veteran.
            This is the same inconsistency check that currently exists 
            for the other conflict/combat instances.  If this inconsistency
            should occur, and there are no other conflicts that seem to be
            causing the inconsistency, the user must contact HEC to find
            out the appropriate military service data to add to the
            veteran's record to remove the inconsistency. Not being able to
            view the seeded OEF/OIF data is a temporary situation that will
            only occur until the follow up patch DG*5.3*689 is installed
            and the OEF/OIF data becomes visible to the user.
  
 3. If the new OEF/OIF/UNKNOWN OEF/OIF episodes have precise 'to' dates,
    they will be used in addition to the other conflict 'to' dates in the
    calculation of CV end date for the veteran when the military service
    separation date is missing or is less than the OEF/OIF/UNKNOWN
    OEF/OIF TO DATE.
  
    ** Note: Because the new OEF/OIF data is not available for display with
       patch DG*5.3*673, if a CV end date appears not to be based on the
       displayable conflict/combat data, the users should contact HEC to
       verify the CV end date is being calculated correctly (i.e. using
       unseen OEF/OIF data) before assuming the CV end date data is in
       error.  This is a temporary situation that will only occur until the
       follow up patch DG*5.3*689 is installed and the OEF/OIF data becomes
       visible.
  
 4.  In addition to the new OEF/OIF fields, three new fields are being
     added to the Patient file (#2) related to the veteran's period of
     military service.  These fields will not be available for entering or
     editing on VistA until the second OEF/OIF patch (DG*5.3*689) is
     released.  These fields are the service component (REGULAR, NATIONAL
     GUARD or ACTIVATED RESERVE) for the branch of service that the veteran
     was associated with during each period of military service.
     Information on displaying and editing these fields will be included in
     the patch documentation for DG*5.3*689. They are being included here
     because the Z11 HL7 message filer and the Z07 HL7 message builder are
     being modified to include and seed this data, even though there will
     be no data from facility edits to share until the second patch
     (DG*5.3*689) is installed.
   
  
 IV. TECHNICAL COMPONENTS
  
 The following section describes the technical components being 
 exported with this patch.
  
 1. The following FILES will be modified.
  
  a. PATIENT (#2) file
     New Field:
     =========
           FIELD #: .3215 
        FIELD NAME: SERVICE [OEF OR OIF] 
      MODIFICATION: New multiple field stored at node .3215, subfile 
                    number 2.3215 containing OEF/OIF related data.
  
  b. SERVICE [OEF or OIF] (#2.3215) subfile 
     New Field:
     =========
           FIELD #: .01 
        FIELD NAME: LOCATION OF SERVICE
      MODIFICATION: New field (set of codes) records the location of
                    service. Stored at node 0;1.
                    Valid entries are:
                      1 = OIF: Operation Iraqi Freedom
                      2 = OEF: Operation Enduring Freedom
                      3 = Unknown OEF/OIF: Either OEF or OIF
                    Stored at location 0;1.
  
  c. SERVICE [OEF or OIF] (#2.3215) subfile
     New Field:
     =========
           FIELD #: .02
        FIELD NAME: OEF/OIF FROM DATE
      MODIFICATION: New field to record the start date of the deployment
                    for this episode.  Format: DATE. Stored at location
                    0;2.
  
  d. SERVICE [OIF or OEF] (#2.3215) subfile
     New Field:
     =========
           FIELD #: .03
        FIELD NAME: OEF/OIF TO DATE
      MODIFICATION: New field to record the start date of the deployment
                    for this episode.  Format: DATE. Stored at location 
                    0;3.
  
  e. SERVICE [OIF or OEF] (#2.3215) subfile
     New Field:
     =========
           FIELD #: .04
        FIELD NAME: DATA LOCKED
      MODIFICATION: New field that is a flag that indicates the data is
                    'locked' at the site and can't be changed or deleted.  
                    This flag is set to 1 if the source of the data is
                    the HEC system (CEV) and is stored at 0;4
                    Format: set of codes, valid entries: 0=No  1=Yes
  
  f. SERVICE [OEF or OIF] (#2.3215) subfile
     New Field:
     =========
           FIELD #: .05
        FIELD NAME: RECORDED DATE/TIME
      MODIFICATION: New field that is a time stamp for when the data was
                    last added/updated on the VistA system.
                    Format: DATE/TIME  Stored at 0;5
  
  g. SERVICE [OEF or OIF] (#2.3215) subfile
     New Field:
     =========
           FIELD #: .06
        FIELD NAME: ENTERED BY SITE
      MODIFICATION: New field that is the facility where the data was 
                    originally entered.  If the data's source was not from
                    a facility, it will be assumed to be generated from HEC
                    (CEV) and this field will be blank.  Format: pointer to
                    INSTITUTION file.  Stored at 0;6
  
  h.  SERVICE [OEF or OIF] (#2.3215) subfile INDEX
             INDEX: ALOEIF
            FIELDS: OEF/OIF TO DATE (#.02), OEF/OIF FROM DATE (#.03),
                    SERVICE LOCATION (#.01)
       DESCRIPTION: The cross reference identifies the one LATEST OIF, OEF
                    OR UNKNOWN OEF/OIF conflict episode for any veteran.  
                    (There should only be a maximum of 1 record per DFN in
                     this cross reference)
  
   ^DPT("ALOEIF",TO DATE,FROM DATE,OIF/ OEF/ UNKNOWN OEF/OIF indicator,
        DFN,DA)=""
  
   Subscripts are:
   - TO DATE = latest conflict 'to date' for any OIF/ OEF/ UNKNOWN OEF/OIF 
               conflicts 
   - FROM DATE = corresponding 'from date' for TO DATE value
   - OIF/ OEF/ UNKNOWN OEF/OIF indicator = "OIF" "OEF" "UNK"
   - DFN = entry in patient file
   - DA = entry in OEF/OIF subfile
  
          This index can be used by clinical reminders (with a newly
          requested integration agreement) to aid them in identifying
          OEF/OIF veterans.
  
  i. PATIENT (#2) file
     Modified Field:
     ==============
           FIELD #: .325  
        FIELD NAME: SERVICE BRANCH [LAST]
      MODIFICATION: Added a trigger to delete SERVICE COMPONENT [LAST] if
                    BRANCH OF SERVICE [LAST] changes.
  
  j. PATIENT (#2) file
     Modified Field:
     ==============
           FIELD #: .3291  
        FIELD NAME: SERVICE BRANCH [NTL]
      MODIFICATION: Added a trigger to delete SERVICE COMPONENT [NTL] if
                    BRANCH OF SERVICE [NTL] changes.
  
  k. PATIENT (#2) file
     New Field:
     ==========
           FIELD #: .32911
        FIELD NAME: SERVICE COMPONENT [LAST]  
      MODIFICATION: New field stored at .3291;1 used to store new military
                    service component associated with the last military 
                    service episode.
  
  l. PATIENT (#2) file
     New Field:
     ==========
           FIELD #: .32912  
        FIELD NAME: SERVICE COMPONENT [NTL] 
      MODIFICATION: New field.  Stored at .3291;2 used to store new 
                    military service component associated with the next
                    to last military service episode.
  
  m. PATIENT (#2) file
     New Field:
     ==========
           FIELD #: .32913
        FIELD NAME: SERVICE COMPONENT [NNTL] 
      MODIFICATION: New field.  Stored at .3291;3 used to store new 
                    military service component associated with the next
                    to next to last military service episode.
  
  n. PATIENT (#2) file
     Modified Field:
     ==============
           FIELD #: .3296  
        FIELD NAME: SERVICE BRANCH [NNTL]
      MODIFICATION: Added a trigger to delete SERVICE COMPONENT [NNTL] if
                    BRANCH OF SERVICE [NNTL] changes.
  
  
 2. The following ROUTINE(s) will be added/modified.
  
  
                   ***************************************
                   **              NOTE                 **
                   ** The second line of routine DGRPMS **
                   ** is being released with patch 689  **
                   ** referenced in the patch list.     **
                   ** Patch DG*5.3*689 is currently not **
                   ** released, but will be released    **
                   ** very shortly and will remedy this **
                   ** situation.                         **
                   *************************************** 
  ROUTINE SUMMARY:
  ================
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
  
      <tab>;;5.3;Registration;**[patch list]**;Aug 13, 1993
  
 NEW CHECKSUM METHOD RESULTS:
                             CHECK1^XTSUMBLD results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  DGCLAPI1                   N/A              7444234             673
  DGCV                  29768290             35316058       528,576,564,673
  DGDDC                  8687243              8871543        89,244,527,700
                                                                  673     
  DGENOEIF                   N/A             14972188             673
  DGENUPL1              31372596             32216917     147,222,232,314,397
                                                            379,407,363,673
  DGENUPL2              61657350             66821493     147,222,232,310,314
                                                          367,397,677,631,675
                                                                672,673
  DGENUPL4              65181451             66292292     147,177,232,253,327
                                                          367,377,514,451,625
                                                                  673
  DGENUPL7              28314140             29468363     232,367,397,417,379
                                                            431,513,628,673
  DGLOCK                28148924             28314268     108,161,247,485,672
                                                                  673
  DGRPC3                16200328             18322459         451,632,673
  DGRPDT                49558820             69102930       562,603,626,673
  DGRPMS                35374783             48037248       451,626,646,673
                                                                  689
  VAFHLZM1              48235551             66971868           314,673
  VAFHLZM2                   N/A              3676248             673
  VAFHLZMH              14591607             17707490         190,314,673
  
                # of new routines:  3
            # of routines changed: 12
 total # of routines in the patch: 15
  
 ========
  
 OLD CHECKSUM METHOD RESULTS:
                             CHECK^XTSUMBLD results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  DGCLAPI1                   N/A              3619685             673
  DGCV                   5335653              6339363       528,576,564,673
  DGDDC                  6215604              6261755       489,244,527,700
                                                                  673
  DGENOEIF                   N/A              4530157             673
  DGENUPL1               6082317              6157888     147,222,232,314,397
                                                            379,407,363,673
  DGENUPL2              15120786             15945780     147,222,232,310,314
                                                          367,397,677,631,675
                                                              672,673
  DGENUPL4              16454165             16805441     147,177,232,253,327
                                                          367,377,514,451,625
                                                                  673
  DGENUPL7               9980481             10352681     232,367,397,417,379
                                                            431,513,628,673
  DGLOCK                17317298             17319234     108,161,247,485,672
                                                                  673
  DGRPC3                 7841364              8505965         451,632,673 
  DGRPDT                15682627             21671780       562,603,626,673
  DGRPMS                 9483547             10933466       451,626,646,673
                                                                  689
  VAFHLZM1              13276791             15535931           314,673
  VAFHLZM2                   N/A              1771016             673
  VAFHLZMH               4411396              5062873         190,314,673
  
                # of new routines:  3
            # of routines changed: 12
 total # of routines in the patch: 15
  
  
 V. SOFTWARE AND DOCUMENTATION RETRIEVAL
  
 The software for this patch is not being distributed through the National
 Patch Module. This patch, DG*5.3*673, along with Income Verification Match
 patch IVM*2*114, is being released in a single KIDS software distribution
 (host file).
  
   Host file name: DG_53_P673.KID
         Build(s): DG*5.3*673
                   IVM*2.0*114
  
 Sites may retrieve the host file and documentation directly via FTP.  The
 preferred method is to FTP the files from:
  
      download.vista.med.va.gov
  
 This transmits the files from the first available FTP server.  Sites may 
 also elect to retrieve software directly from the ANONYMOUS.SOFTWARE 
 directory from a specific server as follows:
  
   OIFO               FTP ADDRESS                  DIRECTORY
   ------------       ------------------------     -------------
   Albany             ftp.fo-albany.med.va.gov     anonymous.software
   Hines              ftp.fo-hines.med.va.gov      anonymous.software
   Salt Lake City     ftp.fo-slc.med.va.gov        anonymous.software
  
   The following files will be available:
  
   FILE NAME             DESCRIPTION
   -----------------     -------------------------------
   DG_53_P673.KID        Host file containing KIDS software distribution
   IVM_2_P114_TM.PDF     Revised IVM V. 2.0 Technical Manual 
  
   * Note:  Use ASCII mode when transferring the .KID file.
            Use Binary mode when transferring the .PDF files.
  
   VistA Intranet
   --------------
   Upon release of this patch to the field, the Operation Enduring & 
   Iraqi Freedom (OEF/OIF) documentation will also be available through
   the VistA Documentation Library (VDL) at the following address:
  
      http://www.va.gov/vdl/
  
  
  
 VI. INSTALLATION INSTRUCTIONS
  
  Pre-Installation Items:
  =======================
  
  * Environment Check:
  
     Programmer access is required for installing this patch.  Prior to 
     installation, the installer must ensure the DUZ(0) node of the DUZ
     array is set to the "@" symbol.
  
  * Users On the System: 
  
     This patch may be installed with users on the system, but should be
     loaded during non-peak hours to minimize disruption to users and to
     reduce the possibility of errors when the routines are updated.
  
  * Software Installation Time:
  
     The estimated installation time is less than 5 minutes during off peak
     hours.
  
  * Required Builds:
  
     The following is a list of REQUIRED builds for this KIDS
     distribution.  KIDS will not allow the installation of this patch
     without their prior installation.
  
     Required Build(s):
     ------------------ 
     DG*5.3*363
     DG*5.3*527
     DG*5.3*625
     DG*5.3*626
     DG*5.3*628
     DG*5.3*632
     DG*5.3*672
     IVM*2.0*109    
  
  
  Installation Steps:
  ===================
  
 Before starting the load of this patch, you may wish to stop the HL7 
 filers prior to the install to prevent possible 'No Source Errors' from
 occurring.  No transmissions will be lost if the filers are not stopped
 first as those encountering an error will be reprocessed once the filers
 are restarted.
  
  
   1. Download the KIDS file DG_53_P673.KID from the ANONYMOUS.SOFTWARE
      directory of either Albany, Hines or the Salt Lake OIFO to the
      appropriate directory on your system.
  
   2. Use LOAD A DISTRIBUTION option on the KIDS INSTALLATION menu, and
      enter: DG_53_P673.KID
  
   3. From the 'Kernel Installation & Distribution System' menu, select the
      Installation menu.
  
   4. From this menu, you may now elect to use the following options (when
      prompted for INSTALL NAME, enter DG*5.3*673).
  
      a. Backup a Transport Global - This option will create a backup
         message of any routines exported with the patch.  It will NOT
         backup any changes such as DDs or templates.
  
      b. Compare Transport Global to Current System - This option will
         allow you to view all changes that will be made when the patch is
         installed.  It compares all components of the patch (routines,
         DDs, templates, etc.).
  
      c. Verify Checksums in Transport Global - This option will allow you
         to ensure the integrity of the routines that are in the transport
         global.
  
      d. Print Transport Global - this option will allow you to view the
         components of the KIDS build.
  
   5. Use the Install Package(s) option and select package DG*5.3*673.
  
   6. When prompted 'Want KIDS to Rebuild Menu Trees Upon Completion of
      Install? YES//', respond NO.
  
   7. When prompted 'Want KIDS to INHIBIT LOGONs during the install?
      YES//', it is recommended you answer NO.
  
   8. When prompted to 'Want to DISABLE Scheduled Options, Menu Options,
      and Protocols? YES//', respond YES.  When prompted to select the
      options you would like to place out of order, enter the following:
  
        DG REGISTER PATIENT        Register a Patient
        DG LOAD PATIENT DATA       Load/Edit Patient Data
  
 When the patch has been completely installed, be sure to re-start the HL7
 filers if you chose to stop them.
  
  
 VII. IMPLEMENTATION STEPS
  
 There are no special implementation steps to take after the 
 successful installation of the software for Phase I of the Operation
 Enduring & Iraqi Freedom (OEF/OIF). However, in order to coordinate this 
 new initiative with the Health Eligibility Center (HEC) so that the data
 can be seeded nationally, a 3 day window for compliance has been approved.
  
 A waiver was granted for testing to be conducted in site and HEC test
 accounts only to prevent production data from becoming inconsistent with
 HEC and other sites during the testing phase.
  
 VIII. TEST SITES
                          
 The following sites participated in the testing of the DG*5.3*673 
 software.
  
  Test Site                             Alpha              Beta
  ------------------------------        -----              ----
  North Texas (Large/Integrated)          X
  Washington, D.C.                        X
  Indianapolis                            X

Routine Information:
====================
Routine Name: DGCLAPI1
Routine Name: DGCV
Routine Name: DGDDC
Routine Name: DGENOEIF
Routine Name: DGENUPL1
Routine Name: DGENUPL2
Routine Name: DGENUPL4
Routine Name: DGENUPL7
Routine Name: DGLOCK
Routine Name: DGRPC3
Routine Name: DGRPDT
Routine Name: DGRPMS
Routine Name: VAFHLZM1
Routine Name: VAFHLZM2
Routine Name: VAFHLZMH

=============================================================================
User Information:
Entered By  : LOUCK,KEVIN                   Date Entered  : JUL 13, 2005
Completed By: KOPP,TERRY M                  Date Completed: SEP 12, 2006
Released By : HEUER,CINDY                   Date Released : SEP 13, 2006
=============================================================================


Packman Mail Message:
=====================

No routines included
