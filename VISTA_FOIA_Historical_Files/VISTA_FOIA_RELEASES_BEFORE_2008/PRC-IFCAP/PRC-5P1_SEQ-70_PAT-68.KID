Released PRC*5.1*68 SEQ #70
Extracted from mail message
**KIDS**:PRC*5.1*68^

**INSTALL NAME**
PRC*5.1*68
"BLD",5534,0)
PRC*5.1*68^IFCAP^0^3050728^y
"BLD",5534,1,0)
^^1^1^3041210^
"BLD",5534,1,1,0)
Prosthetics to IFCAP interface routines.
"BLD",5534,4,0)
^9.64PA^^
"BLD",5534,"ABPKG")
n
"BLD",5534,"KRN",0)
^9.67PA^8989.52^19
"BLD",5534,"KRN",.4,0)
.4
"BLD",5534,"KRN",.401,0)
.401
"BLD",5534,"KRN",.402,0)
.402
"BLD",5534,"KRN",.403,0)
.403
"BLD",5534,"KRN",.5,0)
.5
"BLD",5534,"KRN",.84,0)
.84
"BLD",5534,"KRN",3.6,0)
3.6
"BLD",5534,"KRN",3.8,0)
3.8
"BLD",5534,"KRN",9.2,0)
9.2
"BLD",5534,"KRN",9.8,0)
9.8
"BLD",5534,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",5534,"KRN",9.8,"NM",1,0)
PRCH7PA1^^0^B25195366
"BLD",5534,"KRN",9.8,"NM",2,0)
PRCH7PA4^^0^B10859749
"BLD",5534,"KRN",9.8,"NM",3,0)
PRCH7PUC^^0^B7873930
"BLD",5534,"KRN",9.8,"NM",4,0)
PRCUESIG^^0^B2863718
"BLD",5534,"KRN",9.8,"NM","B","PRCH7PA1",1)

"BLD",5534,"KRN",9.8,"NM","B","PRCH7PA4",2)

"BLD",5534,"KRN",9.8,"NM","B","PRCH7PUC",3)

"BLD",5534,"KRN",9.8,"NM","B","PRCUESIG",4)

"BLD",5534,"KRN",19,0)
19
"BLD",5534,"KRN",19.1,0)
19.1
"BLD",5534,"KRN",101,0)
101
"BLD",5534,"KRN",409.61,0)
409.61
"BLD",5534,"KRN",771,0)
771
"BLD",5534,"KRN",870,0)
870
"BLD",5534,"KRN",8989.51,0)
8989.51
"BLD",5534,"KRN",8989.52,0)
8989.52
"BLD",5534,"KRN",8994,0)
8994
"BLD",5534,"KRN","B",.4,.4)

"BLD",5534,"KRN","B",.401,.401)

"BLD",5534,"KRN","B",.402,.402)

"BLD",5534,"KRN","B",.403,.403)

"BLD",5534,"KRN","B",.5,.5)

"BLD",5534,"KRN","B",.84,.84)

"BLD",5534,"KRN","B",3.6,3.6)

"BLD",5534,"KRN","B",3.8,3.8)

"BLD",5534,"KRN","B",9.2,9.2)

"BLD",5534,"KRN","B",9.8,9.8)

"BLD",5534,"KRN","B",19,19)

"BLD",5534,"KRN","B",19.1,19.1)

"BLD",5534,"KRN","B",101,101)

"BLD",5534,"KRN","B",409.61,409.61)

"BLD",5534,"KRN","B",771,771)

"BLD",5534,"KRN","B",870,870)

"BLD",5534,"KRN","B",8989.51,8989.51)

"BLD",5534,"KRN","B",8989.52,8989.52)

"BLD",5534,"KRN","B",8994,8994)

"BLD",5534,"QUES",0)
^9.62^^
"BLD",5534,"REQB",0)
^9.611^^
"MBREQ")
0
"PKG",15,-1)
1^1
"PKG",15,0)
IFCAP^PRC^IFCAP System Files
"PKG",15,20,0)
^9.402P^^
"PKG",15,22,0)
^9.49I^1^1
"PKG",15,22,1,0)
5.1^3001012^3001029^10364
"PKG",15,22,1,"PAH",1,0)
68^3050728^3685
"PKG",15,22,1,"PAH",1,1,0)
^^1^1^3050728
"PKG",15,22,1,"PAH",1,1,1,0)
Prosthetics to IFCAP interface routines.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","PRCH7PA1")
0^1^B25195366
"RTN","PRCH7PA1",1,0)
PRCH7PA1 ;Hines IOFO/RVD - PROS IFCAP GUI ADD PO ;8/13/03  07:58
"RTN","PRCH7PA1",2,0)
 ;;5.1;IFCAP;**68**;Oct 20, 2000
"RTN","PRCH7PA1",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCH7PA1",4,0)
 ;
"RTN","PRCH7PA1",5,0)
 ;This routine will take the next Common Numbering Series and update
"RTN","PRCH7PA1",6,0)
 ;file 442.6 for the next number.  It will also create an entry in
"RTN","PRCH7PA1",7,0)
 ;file 442 (PO) to be used in obligation.
"RTN","PRCH7PA1",8,0)
 ;Line label AD1 is to be used for MUMPS entry point.
"RTN","PRCH7PA1",9,0)
 ;Line label ADDPO is an entry point for Remote Procedure Call.
"RTN","PRCH7PA1",10,0)
 ;
"RTN","PRCH7PA1",11,0)
 ; DUZ      - User
"RTN","PRCH7PA1",12,0)
 ; PRCSITE  - Station Number IEN
"RTN","PRCH7PA1",13,0)
 ; RMPRSITE - IEN of 669.9
"RTN","PRCH7PA1",14,0)
 ; PRCHXXX  - IEN of 440.5 Purchase Card
"RTN","PRCH7PA1",15,0)
 ; PRCHVEN  - IEN of 440 Vendor
"RTN","PRCH7PA1",16,0)
 ; PRC4426  - Common Numbering Series
"RTN","PRCH7PA1",17,0)
 ; RESULTS(0) = IEN of 442 ^ PO NUMBER
"RTN","PRCH7PA1",18,0)
 Q
"RTN","PRCH7PA1",19,0)
AD1(DUZ,PRCSITE,RMPRSITE,PRCHXXX,PRCHVEN,PRC4425) G AD2
"RTN","PRCH7PA1",20,0)
 ;
"RTN","PRCH7PA1",21,0)
ADDPO(RESULTS,DUZ,PRCSITE,RMPRSITE,PRCHXXX,PRCHVEN,PRC4426) ;create the next PAT number.
"RTN","PRCH7PA1",22,0)
 ;
"RTN","PRCH7PA1",23,0)
AD2 ;
"RTN","PRCH7PA1",24,0)
 Q:'$D(PRCSITE)
"RTN","PRCH7PA1",25,0)
EN1 ;
"RTN","PRCH7PA1",26,0)
 I '$D(^PRC(411,PRCSITE,0)) S RESULTS(0)="^IFCAP Station Not Defined in file # 411." Q
"RTN","PRCH7PA1",27,0)
 I PRC4426="" S RESULTS(0)="Common Numbering Series was not passed see your Supervisor." Q
"RTN","PRCH7PA1",28,0)
 L +^PRC(442.6,PRC4426,0):1 I '$T S RESULTS(0)="^Unable to Access IFCAP file (#442.6), Try Later." Q
"RTN","PRCH7PA1",29,0)
 D GETS^DIQ(442.6,PRC4426,".01;3;2;1","","PRCN")
"RTN","PRCH7PA1",30,0)
 S PRCLO=$G(PRCN(442.6,PRC4426_",",1))
"RTN","PRCH7PA1",31,0)
 S PRCNEXT=$G(PRCN(442.6,PRC4426_",",3))
"RTN","PRCH7PA1",32,0)
 S PRCSTPO=$G(PRCN(442.6,PRC4426_",",.01))
"RTN","PRCH7PA1",33,0)
 S PRCPO=$P(PRCSTPO,"-",2)
"RTN","PRCH7PA1",34,0)
 S PRCUPBO=$G(PRCN(442.6,PRC4426_",",2))
"RTN","PRCH7PA1",35,0)
 I PRCNEXT="" S RESULTS(0)="^The Common Numbering Series is Null."
"RTN","PRCH7PA1",36,0)
 S PRCNEXT=PRCNEXT+1
"RTN","PRCH7PA1",37,0)
 I PRCNEXT>PRCUPBO S RESULTS(0)="^The Common Numbering Series Exceeds the limit, please use a different Common Numbering Series." Q
"RTN","PRCH7PA1",38,0)
 ;calculate PO to be 6 places.
"RTN","PRCH7PA1",39,0)
 D NUM
"RTN","PRCH7PA1",40,0)
 S PRCNEXT=+PRCNEXT
"RTN","PRCH7PA1",41,0)
 S DIE="^PRC(442.6,"
"RTN","PRCH7PA1",42,0)
 S DA=PRC4426
"RTN","PRCH7PA1",43,0)
 S DR="3////^S X=PRCNEXT"
"RTN","PRCH7PA1",44,0)
 D ^DIE
"RTN","PRCH7PA1",45,0)
 L -^PRC(442.6,PRC4426,0)
"RTN","PRCH7PA1",46,0)
 K DIE,DA,DR
"RTN","PRCH7PA1",47,0)
 ;
"RTN","PRCH7PA1",48,0)
 I $D(^PRC(442,"B",PRCROBL)) S RESULTS(0)="^P.O. "_PRCROBL_" already exist, please use a different PO number." Q
"RTN","PRCH7PA1",49,0)
 ;
"RTN","PRCH7PA1",50,0)
PO ;PO must be defined in PRCROBL.
"RTN","PRCH7PA1",51,0)
 ;Create a PO entry in 442.
"RTN","PRCH7PA1",52,0)
 S X=PRCROBL
"RTN","PRCH7PA1",53,0)
 K DIC("S") S PRCHNEW="",DIC="^PRC(442,",DLAYGO=442,DIC(0)="L" D ^DIC
"RTN","PRCH7PA1",54,0)
 I +(Y)'>0 S RESULTS(0)="^UNABLE to Create a Purchase Order, Please Try Later." Q
"RTN","PRCH7PA1",55,0)
 S (DA,PRCHPO,PRC442)=+Y,%DT="T",X="NOW" D ^%DT S $P(^PRC(442,PRCHPO,12),U,4,5)=DUZ_U_Y
"RTN","PRCH7PA1",56,0)
 S (X,Y)=1,PRCHX=X,DIE="^PRC(442,",DR=".5////1" D ^DIE K DIE,DR
"RTN","PRCH7PA1",57,0)
 S $P(^PRC(442,PRCHPO,1),U,10)=DUZ
"RTN","PRCH7PA1",58,0)
 S PRCA=PRCSITE_"^"_PRCHVEN
"RTN","PRCH7PA1",59,0)
 S RESULTS(0)=PRCHPO_"^"_PRCROBL
"RTN","PRCH7PA1",60,0)
 S PRCRI(420)=+PRCA,PRC("SITE")=$P(PRCA,"^"),PRCRI(440)=$P(PRCA,"^",2)
"RTN","PRCH7PA1",61,0)
 S X="" S:$D(PRC("SITE")) PRC("PARAM")=^PRC(411,PRC("SITE"),0)
"RTN","PRCH7PA1",62,0)
 S (PRCPROST,PRCHPC)=1
"RTN","PRCH7PA1",63,0)
 S (PRCHN("SVC"),PRCHN("CC"),PRCHN("SC"),PRCHN("INV"))="",PRCHN("SFC")=+$P(^PRC(442,DA,0),U,19),PRCHN("FOB")=$S($D(^(1)):$P(^(1),U,6),1:""),PRCHN(12)=$S($D(^PRC(442,DA,12)):^(12),1:"")
"RTN","PRCH7PA1",64,0)
 S PRCHPONO=$P(^PRC(442,DA,0),U,1),PRCHSTN=$P(PRCHPONO,"-") S PRCHIEN=DA
"RTN","PRCH7PA1",65,0)
 S PRCX=$O(^PRC(411,PRC("SITE"),1,0)) S:$G(PRCX)]"" PRCY=$P($G(^PRC(411,PRC("SITE"),1,PRCX,0)),U) K PRCX
"RTN","PRCH7PA1",66,0)
 S DA=PRCHPO
"RTN","PRCH7PA1",67,0)
 D DOCID
"RTN","PRCH7PA1",68,0)
 S PRC31=PRCSITE
"RTN","PRCH7PA1",69,0)
 S DA=PRCHPO
"RTN","PRCH7PA1",70,0)
 S DIE="^PRC(442,"
"RTN","PRCH7PA1",71,0)
 S PRC48="S"
"RTN","PRCH7PA1",72,0)
 S PRC54="N"
"RTN","PRCH7PA1",73,0)
 S PRC5="SIMPLIFIED"
"RTN","PRCH7PA1",74,0)
 S PRC1="T"
"RTN","PRCH7PA1",75,0)
 S PRCHP=^PRC(440.5,PRCHXXX,0),PRCHFCP=$P(PRCHP,U,2),PRCHCC=$P(PRCHP,U,3),PRCHBOC1=$P(PRCHP,U,4),PRCHDLOC=$P(PRCHP,U,7),PRCHCD=$P(PRCHP,U),PRCHCDNO=PRCHXXX,PRCHHLDR=$P(PRCHP,U,8)
"RTN","PRCH7PA1",76,0)
TST S DR="16////^S X=DUZ;56////^S X=DUZ;.02///^S X=25;48///^S X=PRC48;63///^S X=1;54///^S X=PRC54;31////^S X=PRC31;S SUB=X" D ^DIE
"RTN","PRCH7PA1",77,0)
 I $D(SUB) S PRCX=$O(^PRC(411,SUB,1,0)) S:$G(PRCX)]"" PRCY=$P($G(^PRC(411,SUB,1,PRCX,0)),U) K PRCX
"RTN","PRCH7PA1",78,0)
 S DR="46////^S X=PRCHXXX;61////^S X=PRCHHLDR" D ^DIE
"RTN","PRCH7PA1",79,0)
 S PRCHCDNO=$P($G(^PRC(442,DA,23)),U,8)
"RTN","PRCH7PA1",80,0)
 S DR="55///^S X=PRCHCD;.1///^S X=PRC1;53////^S X=PRCHVEN;5////^S X=PRCHVEN" D ^DIE
"RTN","PRCH7PA1",81,0)
 S TDATE=$$DATE^PRC0C($P($G(^PRC(442,DA,1)),"^",15),"I"),PRC("FY")=$E(TDATE,3,4)
"RTN","PRCH7PA1",82,0)
 S PRCBBFY=$$BBFY^PRCSUT(PRCSITE,PRC("FY"),PRCHFCP,1),PRC("BBFY")=PRCBBFY
"RTN","PRCH7PA1",83,0)
 S DR="1///^S X=PRCHFCP" D ^DIE
"RTN","PRCH7PA1",84,0)
 S PRCHN("SFC")=$P(^PRC(442,DA,0),U,19)
"RTN","PRCH7PA1",85,0)
 S DR="26///^S X=PRCBBFY;2///^S X=PRCHCC;5.4///^S X=PRC5"
"RTN","PRCH7PA1",86,0)
 D ^DIE
"RTN","PRCH7PA1",87,0)
 S PRCPROST=1.9
"RTN","PRCH7PA1",88,0)
 L -^PRC(442,PRC442)
"RTN","PRCH7PA1",89,0)
 K DIE,DA,DLAYGO,DR,PRCBBFY,PRCHCC,PRCHCD,PRCHCDNO,PRCHDLOC,PRCHFCP,PRCHHLDR,PRCHIEN,PRCHNEW,PRCHP,PRCHPONO,PRCHSTN,PRCHX,PRCLO,PRCN,PRCNEXT,PRCNEXT1
"RTN","PRCH7PA1",90,0)
 K PRCPO,PRCY,PRX,PRZ,RMPRCIEN,RMPRFCP,X,PRCSTPO,PRCUPBO,PRC1,PRC442,PRC4426,PRC5,PRC54,PRC48,PRC31,SUB,TDATE,PRCROBL
"RTN","PRCH7PA1",91,0)
 Q
"RTN","PRCH7PA1",92,0)
 ;
"RTN","PRCH7PA1",93,0)
NUM ;check next number and set the PO to 6 places.
"RTN","PRCH7PA1",94,0)
 ;
"RTN","PRCH7PA1",95,0)
 S PRCX="",$P(PRCX,"0",6)="",PRCNEXT1=PRCX_PRCNEXT
"RTN","PRCH7PA1",96,0)
 S PRCNEXT=$E(PRCNEXT1,$L(PRCNEXT)+$L(PRCPO),$L(PRCNEXT1))
"RTN","PRCH7PA1",97,0)
 S PRCROBL=PRCSTPO_PRCNEXT
"RTN","PRCH7PA1",98,0)
 Q
"RTN","PRCH7PA1",99,0)
 ;
"RTN","PRCH7PA1",100,0)
DOCID S PRZ=$P($P(^PRC(442,PRCHPO,0),U,1),"-",2) Q:$L(PRZ)'=6  F I=1:1:6 S PRX=$E(PRZ,I,I) Q:+PRX=PRX
"RTN","PRCH7PA1",101,0)
 I +PRX=PRX S $P(^PRC(442,PRCHPO,18),"^",3)=$S(I=1:$E(PRZ,2,6),1:$E(PRZ,1,I-1)_$E(PRZ,I+1,6))
"RTN","PRCH7PA1",102,0)
 Q
"RTN","PRCH7PA4")
0^2^B10859749
"RTN","PRCH7PA4",1,0)
PRCH7PA4 ;Hines IOFO/RVD - RPC FOR 440.5 420 420.1 420.2 440 ;8/13/03  12:07
"RTN","PRCH7PA4",2,0)
 ;;5.1;IFCAP;**68**;Oct 20,2000
"RTN","PRCH7PA4",3,0)
 ;
"RTN","PRCH7PA4",4,0)
 ;This routine is use for RPC call to list all Purchase Card for a user.
"RTN","PRCH7PA4",5,0)
 ;DUZ - user
"RTN","PRCH7PA4",6,0)
 ;RESULTS - array of all Purchase Card available to a user whether
"RTN","PRCH7PA4",7,0)
 ;as a (Card Holder or Surrogate User)
"RTN","PRCH7PA4",8,0)
 ;RESULTS array contains the ff:
"RTN","PRCH7PA4",9,0)
 ;PURCHASE CARD NUMBER = pc1
"RTN","PRCH7PA4",10,0)
 ;FUND CONTROL POINT   = pc2
"RTN","PRCH7PA4",11,0)
 ;COST CENTER NAME     = pc3
"RTN","PRCH7PA4",12,0)
 ;COST CENTER 420.1IEN = pc4
"RTN","PRCH7PA4",13,0)
 ;BUDGET OBJECT CODE   = pc5
"RTN","PRCH7PA4",14,0)
 ;PC USER SINGLE PURCHASE LIMIT = pc6
"RTN","PRCH7PA4",15,0)
 ;MONTHLY PURCHASE LIMIT  = pc7
"RTN","PRCH7PA4",16,0)
 ;CARD HOLDER          = pc8
"RTN","PRCH7PA4",17,0)
 ;APPROVING OFFICIAL   = pc9
"RTN","PRCH7PA4",18,0)
 ;PURCHASE CARD NAME   = pc10
"RTN","PRCH7PA4",19,0)
 ;INACTIVE CARD        = pc11
"RTN","PRCH7PA4",20,0)
 ;STATION NUMBER       = pc12
"RTN","PRCH7PA4",21,0)
 ;EXPIRATION DATE      = pc13
"RTN","PRCH7PA4",22,0)
 ;
"RTN","PRCH7PA4",23,0)
 ;list all available Purchase card Number for a user.
"RTN","PRCH7PA4",24,0)
A1(DUZ,PRCSITE) G A2 ;entry point for roll and scroll
"RTN","PRCH7PA4",25,0)
 ;
"RTN","PRCH7PA4",26,0)
ENA(RESULTS,DUZ,PRCSITE) ;broker entry point
"RTN","PRCH7PA4",27,0)
 ;
"RTN","PRCH7PA4",28,0)
A2 ;
"RTN","PRCH7PA4",29,0)
 I DUZ="" S RESULTS(0)="User Is Undefined" G EXIT
"RTN","PRCH7PA4",30,0)
 I '$D(^PRC(411,PRCSITE,0)) S RESULTS(0)="IFCAP Station Not Defined in file # 411." G EXIT
"RTN","PRCH7PA4",31,0)
 ;new code
"RTN","PRCH7PA4",32,0)
 K PR S PRCNT=0
"RTN","PRCH7PA4",33,0)
 ;H x-ref is for Card Holder
"RTN","PRCH7PA4",34,0)
 F I=0:0 S I=$O(^PRC(440.5,"H",DUZ,I)) Q:I'>0  D
"RTN","PRCH7PA4",35,0)
 .D GETS^DIQ(440.5,I,".01;1;2;3;4;5;7;8;10;14;15;16","","PR")
"RTN","PRCH7PA4",36,0)
 .D SET
"RTN","PRCH7PA4",37,0)
 ;C x-ref is for Surrogate user.
"RTN","PRCH7PA4",38,0)
 F I=0:0 S I=$O(^PRC(440.5,"C",DUZ,I)) Q:I'>0  D
"RTN","PRCH7PA4",39,0)
 .D GETS^DIQ(440.5,I,".01;1;2;3;4;5;7;8;10;14;15;16","","PR")
"RTN","PRCH7PA4",40,0)
 .Q:$D(PRCCARD(I))
"RTN","PRCH7PA4",41,0)
 .D SET
"RTN","PRCH7PA4",42,0)
 ;
"RTN","PRCH7PA4",43,0)
EXIT ;common exit point
"RTN","PRCH7PA4",44,0)
 I '$D(RESULTS) S RESULTS(0)="NOTHING FOUND"
"RTN","PRCH7PA4",45,0)
 K PR,PRCNT,PRCCARD,I
"RTN","PRCH7PA4",46,0)
 Q
"RTN","PRCH7PA4",47,0)
SET ;
"RTN","PRCH7PA4",48,0)
 Q:$G(PR(440.5,I_",",15))'=PRCSITE
"RTN","PRCH7PA4",49,0)
 S RMPRFCP=$G(PR(440.5,I_",",1))
"RTN","PRCH7PA4",50,0)
 ;I '$D(^PRC(420,"C",DUZ,PRCSITE,RMPRFCP)) S RESULTS="1^You are not authorized for fund Control Point"_RMPRFCP_".  Please resolve the problem and try again." Q
"RTN","PRCH7PA4",51,0)
 S PRCNT=PRCNT+1
"RTN","PRCH7PA4",52,0)
 S RESULTS(PRCNT)=PR(440.5,I_",",.01)_U
"RTN","PRCH7PA4",53,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",1))_U
"RTN","PRCH7PA4",54,0)
 S RMPRCIEN=$G(PR(440.5,I_",",2))
"RTN","PRCH7PA4",55,0)
 I RMPRCIEN="" S RESULTS(PRCNT)=RESULTS(PRCNT)_RMPRCIEN_U
"RTN","PRCH7PA4",56,0)
 E  S RESULTS(PRCNT)=RESULTS(PRCNT)_$P(^PRCD(420.1,RMPRCIEN,0),U,1)_U
"RTN","PRCH7PA4",57,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",2))_U
"RTN","PRCH7PA4",58,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",3))_U
"RTN","PRCH7PA4",59,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",4))_U
"RTN","PRCH7PA4",60,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",5))_U
"RTN","PRCH7PA4",61,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",7))_U
"RTN","PRCH7PA4",62,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",8))_U
"RTN","PRCH7PA4",63,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",10))_U
"RTN","PRCH7PA4",64,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",14))_U
"RTN","PRCH7PA4",65,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",15))_U
"RTN","PRCH7PA4",66,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_$G(PR(440.5,I_",",16))_U
"RTN","PRCH7PA4",67,0)
 S RESULTS(PRCNT)=RESULTS(PRCNT)_I
"RTN","PRCH7PA4",68,0)
 S PRCCARD(I)=""
"RTN","PRCH7PA4",69,0)
 Q
"RTN","PRCH7PA4",70,0)
 ;
"RTN","PRCH7PA4",71,0)
 ;Fund Control Point Check for a user.
"RTN","PRCH7PA4",72,0)
D1(DUZ,PRCSITE,PRCFCP) G D2 ;entry point for roll and scroll
"RTN","PRCH7PA4",73,0)
 ;
"RTN","PRCH7PA4",74,0)
END(RESULTS,DUZ,PRCSITE,PRCFCP) ;broker entry point
"RTN","PRCH7PA4",75,0)
 ;
"RTN","PRCH7PA4",76,0)
D2 S ^TMP("FCP",0)=DUZ_"^"_PRCSITE_"^"_PRCFCP
"RTN","PRCH7PA4",77,0)
 ;
"RTN","PRCH7PA4",78,0)
 S PRCFCP=+PRCFCP
"RTN","PRCH7PA4",79,0)
 I DUZ="" S RESULTS(0)="1^User Is Undefined" Q
"RTN","PRCH7PA4",80,0)
 I $D(^PRC(420,"C",DUZ,PRCSITE,PRCFCP)) S RESULTS(0)="0^FCP OK" Q
"RTN","PRCH7PA4",81,0)
 S RESULTS(0)="1^You are not set up for this fund control point "_PRCFCP_" check with your supervisor or Ficsal Service." Q
"RTN","PRCH7PA4",82,0)
 Q
"RTN","PRCH7PA4",83,0)
 ;END
"RTN","PRCH7PUC")
0^3^B7873930
"RTN","PRCH7PUC",1,0)
PRCH7PUC ;Hines OIFO/RVD - GUI PURCHASE CARD PROS ORDER INTERFACE ;8/13/03  09:50
"RTN","PRCH7PUC",2,0)
 ;;5.1;IFCAP;**68**;Oct 20, 2000
"RTN","PRCH7PUC",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCH7PUC",4,0)
 ;
"RTN","PRCH7PUC",5,0)
 ;This routine is for Obligating and canceling a PO using a GUI interface.
"RTN","PRCH7PUC",6,0)
 ;Line label UP1 is for MUMPS entry point.
"RTN","PRCH7PUC",7,0)
 ;
"RTN","PRCH7PUC",8,0)
 ; PRCSITE     - station number
"RTN","PRCH7PUC",9,0)
 ; PRCVEN      - vendor
"RTN","PRCH7PUC",10,0)
 ; RESULTS     - return variable
"RTN","PRCH7PUC",11,0)
 ; PRCA        - IEN of Prosthetics Order file 664
"RTN","PRCH7PUC",12,0)
 ; PRCB        - IEN of file 442
"RTN","PRCH7PUC",13,0)
 ; PRCC        - Total Cost
"RTN","PRCH7PUC",14,0)
 ; PRCRMPR   - Variable to quit in IFCAP E-Sig routine PRCUESIG
"RTN","PRCH7PUC",15,0)
UP1(X,PRCA,PRCB,PRCC,PRCSITE,PRCVEN,PRCRMPR) ;ENTRY FOR GUI PURCHASING
"RTN","PRCH7PUC",16,0)
 ;
"RTN","PRCH7PUC",17,0)
 N PRCPROST,PRCHPC,PRCRI,A,B,Y,DIE
"RTN","PRCH7PUC",18,0)
 N PRCHPO,PRCHTOT,PRCHBOCC,PRCHBOC1,PRCHN
"RTN","PRCH7PUC",19,0)
 S PRC("PER")=+DUZ
"RTN","PRCH7PUC",20,0)
 K X S X=$S('$D(^VA(200,+PRC("PER"),20)):"",1:^VA(200,+PRC("PER"),20))
"RTN","PRCH7PUC",21,0)
 I $P(X,"^",2)="" S %X=$P(^VA(200,+PRC("PER"),0),"^"),%X=$P(%X,",",2)_" "_$P(%X,",")_$P(%X,",",3),$P(^VA(200,+PRC("PER"),20),"^",2)=%X,X=%X K %X
"RTN","PRCH7PUC",22,0)
 S $P(PRC("PER"),"^",2,4)=$P(X,"^",2)_"^"_$P(X,"^",3)_"^"_$S($D(^VA(200,+PRC("PER"),.13)):$P(^(.13),"^",2),1:"")
"RTN","PRCH7PUC",23,0)
 S PRCHVEN=PRCVEN
"RTN","PRCH7PUC",24,0)
 S PRCPROST=3,PRCHPC=1
"RTN","PRCH7PUC",25,0)
 S PRCRI(442)=PRCB
"RTN","PRCH7PUC",26,0)
 S PRCHPO=PRCRI(442),PRCHTOT=PRCC
"RTN","PRCH7PUC",27,0)
 S A=^PRC(440.5,$P(^PRC(442,PRCRI(442),23),"^",8),0),PRCHBOC1=$P(A,U,4)
"RTN","PRCH7PUC",28,0)
 S DIE="^PRC(442,",DA=PRCHPO,DR="60////"_PRCHTOT_";91////"_PRCHTOT_";65////RMPR" D ^DIE K DR
"RTN","PRCH7PUC",29,0)
 S PRCHN("SFC")=+$P(^PRC(442,PRCRI(442),0),U,19)
"RTN","PRCH7PUC",30,0)
 S:'$D(^PRC(442,PRCHPO,2,0)) $P(^PRC(442,PRCHPO,2,0),U,2)=$P(^DD(442,40,0),U,2)
"RTN","PRCH7PUC",31,0)
 S DA(1)=PRCHPO,DIE="^PRC(442,"_DA(1)_",2,",DA=1
"RTN","PRCH7PUC",32,0)
 S DR=".01///^S X=1;1///Prosthetic Order;2///^S X=1;3///^S X=""EA"";5////^S X=PRCHTOT;3.1///^S X=1;9.7///^S X=1;9///^S X="""";8///^S X=9999;K PRCHBOCC;"
"RTN","PRCH7PUC",33,0)
 S DR(1,442.01,1)="I PRCHN(""SFC"")=2 S PRCHBOCC=2696;I '$G(PRCHBOCC) S Y=""@87"";"
"RTN","PRCH7PUC",34,0)
 S DR(1,442.01,2)="S PRCHBOCC=$P($G(^PRCD(420.2,PRCHBOCC,0)),U);3.5////^S X=PRCHBOCC;S Y=""@89"";@87;3.5////^S X=PRCHBOC1;@89;K PRCHBOCC"
"RTN","PRCH7PUC",35,0)
 D ^DIE
"RTN","PRCH7PUC",36,0)
 I '$D(Y) D PROS^PRCHNPO
"RTN","PRCH7PUC",37,0)
 S X="" I PRCPROST=3 D CANIC(PRCRI(442)) S X="^"
"RTN","PRCH7PUC",38,0)
 QUIT
"RTN","PRCH7PUC",39,0)
 ;
"RTN","PRCH7PUC",40,0)
CANIC(PRCA) ;cancel order, prca=ri of prosthetic order, prcb=ri file 442
"RTN","PRCH7PUC",41,0)
 N PRCPROST,PRCHPC,A,B,X,Y
"RTN","PRCH7PUC",42,0)
 S PRCPROST=99,PRCHPC=1
"RTN","PRCH7PUC",43,0)
 D EDIT^PRC0B(.X,"442;^PRC(442,;"_PRCA,".5///^S X=45")
"RTN","PRCH7PUC",44,0)
 S DA=PRCA D C2237^PRCH442A K DA,%A,%B,%
"RTN","PRCH7PUC",45,0)
 QUIT
"RTN","PRCH7PUC",46,0)
 ;
"RTN","PRCH7PUC",47,0)
 ;PRCPONO - IEN of file #442
"RTN","PRCH7PUC",48,0)
 ;PRCA    - IEN of file #664
"RTN","PRCH7PUC",49,0)
 ;RESULTS  - a return value
"RTN","PRCH7PUC",50,0)
 ;
"RTN","PRCH7PUC",51,0)
 ;cancel a PO.  Call by Prosthetics GUI.
"RTN","PRCH7PUC",52,0)
C1(PRCA) G C2
"RTN","PRCH7PUC",53,0)
CAN(RESULTS,PRCPONO) ;broker entry point.
"RTN","PRCH7PUC",54,0)
C2 ;
"RTN","PRCH7PUC",55,0)
 N PRCPROST,PRCHPC,A,B,X,Y
"RTN","PRCH7PUC",56,0)
 S PRCPROST=99,PRCHPC=1
"RTN","PRCH7PUC",57,0)
 L +^PRC(442,PRCA):1
"RTN","PRCH7PUC",58,0)
 I '$T S RESULTS="Unable to Access P.O. in IFCAP." Q
"RTN","PRCH7PUC",59,0)
 D EDIT^PRC0B(.X,"442;^PRC(442,;"_PRCA,".5///^S X=45")
"RTN","PRCH7PUC",60,0)
 S DA=PRCA D C2237^PRCH442A K DA,%A,%B,%
"RTN","PRCH7PUC",61,0)
 S RESULTS(0)="P.O. has been cancelled."
"RTN","PRCH7PUC",62,0)
 Q
"RTN","PRCH7PUC",63,0)
 ;END
"RTN","PRCUESIG")
0^4^B2863718
"RTN","PRCUESIG",1,0)
PRCUESIG ;WISC@ALTOONA/CTB/TEN-ROUTINE TO ENTER OR CHANGE ELECTRONIC SIGNATURE CODE (IFCAP) ;5/4/93  8:31 AM
"RTN","PRCUESIG",2,0)
V ;;5.1;IFCAP;**68**;Oct 20, 2000
"RTN","PRCUESIG",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCUESIG",4,0)
ENCODE(X,X1,X2) D EN^XUSHSHP Q X
"RTN","PRCUESIG",5,0)
DECODE(X,X1,X2) D DE^XUSHSHP Q X
"RTN","PRCUESIG",6,0)
HASH(X) D HASH^XUSHSHP Q X
"RTN","PRCUESIG",7,0)
SUM(X) ;CREATE CHECKSUM VALUE FOR STRING
"RTN","PRCUESIG",8,0)
 N I,Y
"RTN","PRCUESIG",9,0)
 S Y=0 F I=1:1:$L(X) S Y=$A(X,I)*I+Y
"RTN","PRCUESIG",10,0)
 Q Y
"RTN","PRCUESIG",11,0)
ESIG(USERNUM,MESSAGE) ;interogate user for electronic signature code
"RTN","PRCUESIG",12,0)
 ;1= valid code entered
"RTN","PRCUESIG",13,0)
 ;0= invalid code entered
"RTN","PRCUESIG",14,0)
 ;-1= user up arrowed out
"RTN","PRCUESIG",15,0)
 ;-2= signature read time out
"RTN","PRCUESIG",16,0)
 ;-3= no signature on file
"RTN","PRCUESIG",17,0)
 NEW X,SIGCODE,ZZI,OUT
"RTN","PRCUESIG",18,0)
 I $G(PRCRMPR) S MESSAGE=1 Q
"RTN","PRCUESIG",19,0)
 S SIGCODE=$P($G(^VA(200,USERNUM,20)),"^",4)
"RTN","PRCUESIG",20,0)
 I SIGCODE="" W !,"You have no signature code on file.  Please contact your IRM staff for assistance.",$C(7),! S MESSAGE=-3 QUIT
"RTN","PRCUESIG",21,0)
 F ZZI=1:1:3 D  Q:OUT]""
"RTN","PRCUESIG",22,0)
 . K OUT
"RTN","PRCUESIG",23,0)
 . W !,"Enter ELECTRONIC SIGNATURE CODE: "
"RTN","PRCUESIG",24,0)
 . X ^%ZOSF("EOFF") R X:60 X ^%ZOSF("EON")
"RTN","PRCUESIG",25,0)
 . I '$T S OUT=-2 QUIT
"RTN","PRCUESIG",26,0)
 . I $E(X)="^" S OUT=-1 QUIT
"RTN","PRCUESIG",27,0)
 . S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","PRCUESIG",28,0)
 . I $$HASH(X)=SIGCODE W ?60,"Thank you." S OUT=1 QUIT
"RTN","PRCUESIG",29,0)
 . W !,"Sorry, but that's not your correct electronic signature code."
"RTN","PRCUESIG",30,0)
 . S OUT=""
"RTN","PRCUESIG",31,0)
 . QUIT
"RTN","PRCUESIG",32,0)
 S MESSAGE=+$G(OUT)
"RTN","PRCUESIG",33,0)
 Q
"RTN","PRCUESIG",34,0)
 ;
"RTN","PRCUESIG",35,0)
NOW() ;Extrinsic function to return current time
"RTN","PRCUESIG",36,0)
 N %,%I,%H,X
"RTN","PRCUESIG",37,0)
 D NOW^%DTC
"RTN","PRCUESIG",38,0)
 QUIT %
"RTN","PRCUESIG",39,0)
 ;
"VER")
8.0^22.0
"BLD",5534,6)
^SEQ #70
**END**
**END**
