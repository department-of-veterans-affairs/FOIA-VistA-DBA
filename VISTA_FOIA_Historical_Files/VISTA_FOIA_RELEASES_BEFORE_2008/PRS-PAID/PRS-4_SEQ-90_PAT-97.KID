Released PRS*4*97 SEQ #90
Extracted from mail message
**KIDS**:PRS*4.0*97^

**INSTALL NAME**
PRS*4.0*97
"BLD",5210,0)
PRS*4.0*97^PAID^0^3050131^y
"BLD",5210,1,0)
^^5^5^3050131^^^
"BLD",5210,1,1,0)
This patch contains the fix necessary to correct the queuing of the reports
"BLD",5210,1,2,0)
from the Employee Inquiry [PRSD 04 EMPLOYEE INQUIRY] option and the reports
"BLD",5210,1,3,0)
from the Payrun Data Inquiry [PRSD 04 PAYRUN DATA INQUIRY] option. After this
"BLD",5210,1,4,0)
patch is installed, the queued reports will include all applicable data
"BLD",5210,1,5,0)
instead of just the header without data.
"BLD",5210,4,0)
^9.64PA^^
"BLD",5210,"ABPKG")
n
"BLD",5210,"KRN",0)
^9.67PA^8989.52^19
"BLD",5210,"KRN",.4,0)
.4
"BLD",5210,"KRN",.401,0)
.401
"BLD",5210,"KRN",.402,0)
.402
"BLD",5210,"KRN",.403,0)
.403
"BLD",5210,"KRN",.5,0)
.5
"BLD",5210,"KRN",.84,0)
.84
"BLD",5210,"KRN",3.6,0)
3.6
"BLD",5210,"KRN",3.8,0)
3.8
"BLD",5210,"KRN",9.2,0)
9.2
"BLD",5210,"KRN",9.8,0)
9.8
"BLD",5210,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",5210,"KRN",9.8,"NM",1,0)
PRSDV459^^0^B35641317
"BLD",5210,"KRN",9.8,"NM","B","PRSDV459",1)

"BLD",5210,"KRN",19,0)
19
"BLD",5210,"KRN",19,"NM",0)
^9.68A^^0
"BLD",5210,"KRN",19.1,0)
19.1
"BLD",5210,"KRN",101,0)
101
"BLD",5210,"KRN",409.61,0)
409.61
"BLD",5210,"KRN",771,0)
771
"BLD",5210,"KRN",870,0)
870
"BLD",5210,"KRN",8989.51,0)
8989.51
"BLD",5210,"KRN",8989.52,0)
8989.52
"BLD",5210,"KRN",8994,0)
8994
"BLD",5210,"KRN","B",.4,.4)

"BLD",5210,"KRN","B",.401,.401)

"BLD",5210,"KRN","B",.402,.402)

"BLD",5210,"KRN","B",.403,.403)

"BLD",5210,"KRN","B",.5,.5)

"BLD",5210,"KRN","B",.84,.84)

"BLD",5210,"KRN","B",3.6,3.6)

"BLD",5210,"KRN","B",3.8,3.8)

"BLD",5210,"KRN","B",9.2,9.2)

"BLD",5210,"KRN","B",9.8,9.8)

"BLD",5210,"KRN","B",19,19)

"BLD",5210,"KRN","B",19.1,19.1)

"BLD",5210,"KRN","B",101,101)

"BLD",5210,"KRN","B",409.61,409.61)

"BLD",5210,"KRN","B",771,771)

"BLD",5210,"KRN","B",870,870)

"BLD",5210,"KRN","B",8989.51,8989.51)

"BLD",5210,"KRN","B",8989.52,8989.52)

"BLD",5210,"KRN","B",8994,8994)

"BLD",5210,"QUES",0)
^9.62^^
"BLD",5210,"REQB",0)
^9.611^1^1
"BLD",5210,"REQB",1,0)
PRS*4.0*73^2
"BLD",5210,"REQB","B","PRS*4.0*73",1)

"MBREQ")
0
"PKG",369,-1)
1^1
"PKG",369,0)
PAID^PRS^PAID
"PKG",369,20,0)
^9.402P^^
"PKG",369,22,0)
^9.49I^1^1
"PKG",369,22,1,0)
4.0^2950912^2960126
"PKG",369,22,1,"PAH",1,0)
97^3050131^123456811
"PKG",369,22,1,"PAH",1,1,0)
^^5^5^3050131
"PKG",369,22,1,"PAH",1,1,1,0)
This patch contains the fix necessary to correct the queuing of the reports
"PKG",369,22,1,"PAH",1,1,2,0)
from the Employee Inquiry [PRSD 04 EMPLOYEE INQUIRY] option and the reports
"PKG",369,22,1,"PAH",1,1,3,0)
from the Payrun Data Inquiry [PRSD 04 PAYRUN DATA INQUIRY] option. After this
"PKG",369,22,1,"PAH",1,1,4,0)
patch is installed, the queued reports will include all applicable data
"PKG",369,22,1,"PAH",1,1,5,0)
instead of just the header without data.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PRSDV459")
0^1^B35641317
"RTN","PRSDV459",1,0)
PRSDV459 ;HISC/MGD-VIEW PAID PAYRUN DATA ;09/09/04
"RTN","PRSDV459",2,0)
 ;;4.0;PAID;**78,83,82,86,73,97**;Sep 21, 1995
"RTN","PRSDV459",3,0)
 K CHOICE F LOOP=1:1:5 S CHOICE(LOOP)=$T(TABLE+LOOP)
"RTN","PRSDV459",4,0)
PP ;select pay period
"RTN","PRSDV459",5,0)
 K DIC S DIC="^PRST(459,",DIC(0)="AEMQZ" D ^DIC I Y'>0 D KILL1,KILL2 Q
"RTN","PRSDV459",6,0)
 S PP=+Y,PPNAME=$P(^PRST(459,PP,0),U,1)
"RTN","PRSDV459",7,0)
EMP K DASHES S $P(DASHES,"-",80)="-"
"RTN","PRSDV459",8,0)
 K DIC,^UTILITY("DIQ1",$J) S DIC="^PRST(459,"_PP_",""P"",",DIC(0)="AEMQZ" D ^DIC K DIC G:Y'>0 PP
"RTN","PRSDV459",9,0)
 S EMP=+Y,ZERO=^PRST(459,PP,"P",EMP,0),NAME=$P(^PRSPC(EMP,0),U,1)
"RTN","PRSDV459",10,0)
 S SSN=$P(ZERO,U,2),SSN=$E(SSN,1,3)_"-"_$E(SSN,4,5)_"-"_$E(SSN,6,9)
"RTN","PRSDV459",11,0)
 S TLU=$P(ZERO,U,13),STATION=$P(^PRSPC(EMP,0),U,7)
"RTN","PRSDV459",12,0)
 S Y=$P(^PRSPC(EMP,0),U,49) X ^DD(450,458,2.1) S CCORG=Y
"RTN","PRSDV459",13,0)
 S DS=$P($G(^PRSPC(EMP,1)),U,42)
"RTN","PRSDV459",14,0)
CAT S CLNGTH=$L(CCORG),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSDV459",15,0)
 W @IOF,!,NAME,?TAB,CCORG,?62,"DUTY STATION: ",STATION_DS
"RTN","PRSDV459",16,0)
 W !,SSN,?71,"T&L: ",TLU,!,DASHES,!,"PAY PERIOD: ",PPNAME
"RTN","PRSDV459",17,0)
 W !! F LOOP=1:1:5 W !,?20,$P(CHOICE(LOOP),";",3),?23,$P(CHOICE(LOOP),";",4)
"RTN","PRSDV459",18,0)
SAN W ! K DIR,DIRUT,DIROUT,DTOUT,DUOUT
"RTN","PRSDV459",19,0)
 S DIR(0)="NAO^1:5:0",DIR("A")="Select a number: "
"RTN","PRSDV459",20,0)
 S DIR("?")="Type a number between 1 and 5"
"RTN","PRSDV459",21,0)
 D ^DIR I $D(DTOUT)!($D(DUOUT))!($D(DIROUT)) D KILL1 G EMP
"RTN","PRSDV459",22,0)
 I X="@" W !!,*7,DIR("?")_"." G SAN
"RTN","PRSDV459",23,0)
 G:X="" EMP
"RTN","PRSDV459",24,0)
 N L,LAB,NOL
"RTN","PRSDV459",25,0)
 S CATEGORY=$P(CHOICE(+Y),";",4),LAB=$P(CHOICE(+Y),";",5)
"RTN","PRSDV459",26,0)
 S NOL=$P(CHOICE(+Y),";",6),PAGE=0
"RTN","PRSDV459",27,0)
 F L=1:1:NOL S (DRSUB(L),PRNTORDR(L))=$P($T(@LAB+L^PRSDV459),";",3) D
"RTN","PRSDV459",28,0)
 . F  Q:DRSUB(L)'[","  D
"RTN","PRSDV459",29,0)
 . . S DRSUB(L)=$P(DRSUB(L),",")_";"_$P(DRSUB(L),",",2,999)
"RTN","PRSDV459",30,0)
 . F  Q:DRSUB(L)'[":1:"  D
"RTN","PRSDV459",31,0)
 . . S DRSUB(L)=$P(DRSUB(L),":1:")_":"_$P(DRSUB(L),":1:",2,999)
"RTN","PRSDV459",32,0)
 . F  Q:DRSUB(L)'[":.01:"  D
"RTN","PRSDV459",33,0)
 . . S DRSUB(L)=$P(DRSUB(L),":.01:")_":"_$P(DRSUB(L),":.01:",2,999)
"RTN","PRSDV459",34,0)
 S IOFSAV=IOF
"RTN","PRSDV459",35,0)
 K %ZIS,IOP S %ZIS="MQ",%ZIS("B")="" D ^%ZIS I POP D KILL1,KILL2 Q
"RTN","PRSDV459",36,0)
 S IOF=IOFSAV
"RTN","PRSDV459",37,0)
 F LOOP="CATEGORY","CCORG","CLNGTH","DASHES","DS","EMP","DRSUB(","NAME","PAGE","PP","PPNAME","PRNTORDR(","SSN","STATION","TAB","TLU" S ZTSAVE(LOOP)=""
"RTN","PRSDV459",38,0)
 I $D(IO("Q")) S ZTIO=ION,ZTDESC="DISPLAY PAYRUN DATA",ZTRTN="DISPLAY^PRSDV459",ZTREQ="@",ZTSAVE("ZTREQ")="" D ^%ZTLOAD W:$D(ZTSK) !,"Request Queued!" D KILL1 G CAT
"RTN","PRSDV459",39,0)
 D:$E(IOST,1)="C" WAIT^DICD
"RTN","PRSDV459",40,0)
 U IO D DISPLAY G:PRTC=0 CAT
"RTN","PRSDV459",41,0)
 I $E(IOST,1)="C" D:PRTC="" PRTC G:PRTC=0 CAT
"RTN","PRSDV459",42,0)
 D:$E(IOST,1)'="C" ^%ZISC
"RTN","PRSDV459",43,0)
 W @IOF G CAT
"RTN","PRSDV459",44,0)
DISPLAY ;display payrun data
"RTN","PRSDV459",45,0)
 N DRIEN
"RTN","PRSDV459",46,0)
 S DRIEN=0
"RTN","PRSDV459",47,0)
 F  S DRIEN=$O(DRSUB(DRIEN)) Q:DRIEN=""  D
"RTN","PRSDV459",48,0)
 . S DIQ(0)="EIN",DIC=459,DR=1,DR(459.01)=DRSUB(DRIEN),DA(459.01)=EMP,DA=PP
"RTN","PRSDV459",49,0)
 . D EN^DIQ1
"RTN","PRSDV459",50,0)
 W:$E(IOST,1)="C" @IOF D HEADER S FIELDN=0
"RTN","PRSDV459",51,0)
 I CATEGORY="LABOR DISTRIBUTION" D
"RTN","PRSDV459",52,0)
 . S PRTC=0
"RTN","PRSDV459",53,0)
 . D LD
"RTN","PRSDV459",54,0)
 . I $E(IOST,1)="C" D CHECK
"RTN","PRSDV459",55,0)
 . I $E(IOST,1)'="C" D ^%ZISC
"RTN","PRSDV459",56,0)
 I CATEGORY'="LABOR DISTRIBUTION" D
"RTN","PRSDV459",57,0)
 . S PRTC="",DRIEN=0
"RTN","PRSDV459",58,0)
 . F  S DRIEN=$O(PRNTORDR(DRIEN)) Q:DRIEN=""  D
"RTN","PRSDV459",59,0)
 . . S PRNTVALS="F FIELDN="_PRNTORDR(DRIEN)_" D WRITE^PRSDV459 Q:PRTC=0"
"RTN","PRSDV459",60,0)
 . . X PRNTVALS
"RTN","PRSDV459",61,0)
KILL1 ;kill most variables and close the device
"RTN","PRSDV459",62,0)
 K D0,DIC,DIQ,DIQ2,DIR,DIRUT,DIROUT,DR,DRSUB,DTOUT,DUOUT,FIELDN,IOFSAV,IOP,LOOP,POP,PRNTORDR,PRNTVALS,X,Y,ZERO,ZTDESC,ZTIO,ZTRTN,ZTSAVE,ZTSK,%ZIS,^UTILITY("DIQ1",$J)
"RTN","PRSDV459",63,0)
 Q
"RTN","PRSDV459",64,0)
KILL2 ;kill the remaining variables
"RTN","PRSDV459",65,0)
 K CATEGORY,CCORG,CHOICE,CLNGTH,DA,DS,DASHES,EMP,NAME,PAGE,PP,PPNAME,PRTC,SSN,STATION,TAB,TLU,ZTREQ Q
"RTN","PRSDV459",66,0)
WRITE ;write the data
"RTN","PRSDV459",67,0)
 S NODEDD=^DD(459.01,FIELDN,0),DESC=$G(^UTILITY("DIQ1",$J,459.01,EMP,FIELDN,"E"))
"RTN","PRSDV459",68,0)
 I (DESC="")!(DESC="NA") K NODEDD,DESC Q
"RTN","PRSDV459",69,0)
 S INTERNAL=^UTILITY("DIQ1",$J,459.01,EMP,FIELDN,"I")
"RTN","PRSDV459",70,0)
 I $P(NODEDD,U,2)["NJ",+INTERNAL=0 K NODEDD,DESC Q
"RTN","PRSDV459",71,0)
 I PRTC=1 D HEADER S PRTC=""
"RTN","PRSDV459",72,0)
 W !,$P(NODEDD,U,1)
"RTN","PRSDV459",73,0)
 W ?30,$S($P(NODEDD,U,5)["""$""":$J($FN(INTERNAL,",",2),14),$P(NODEDD,U,2)["NJ":$J(INTERNAL,14,2),$P(NODEDD,U,2)["D":$J(DESC,14),1:$J(INTERNAL,14))
"RTN","PRSDV459",74,0)
 I $P(NODEDD,U,2)'["D",INTERNAL'=DESC D DESC
"RTN","PRSDV459",75,0)
 K DESC,INTERNAL,NODEDD
"RTN","PRSDV459",76,0)
 D CHECK
"RTN","PRSDV459",77,0)
 Q
"RTN","PRSDV459",78,0)
CHECK I $E(IOST,1)="C",$Y>(IOSL-4) D PRTC
"RTN","PRSDV459",79,0)
 Q
"RTN","PRSDV459",80,0)
PRTC ;press return to continue
"RTN","PRSDV459",81,0)
 W ! K DIR,DIRUT,DIROUT,DTOUT,DUOUT S DIR(0)="E",DIR("A")="Press RETURN to continue" D ^DIR S PRTC=Y S:$D(DIRUT) PRTC=0
"RTN","PRSDV459",82,0)
 Q
"RTN","PRSDV459",83,0)
HEADER ;print header
"RTN","PRSDV459",84,0)
 W:$Y>0 @IOF S PAGE=PAGE+1
"RTN","PRSDV459",85,0)
 S CLNGTH=$L(CCORG),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSDV459",86,0)
 W !,NAME,?TAB,CCORG,?62,"DUTY STATION: ",STATION_DS
"RTN","PRSDV459",87,0)
 W !,SSN,?71,"T&L: ",TLU,!,DASHES
"RTN","PRSDV459",88,0)
 S CLNGTH=$L(CATEGORY),TAB=(80-CLNGTH)\2,TAB=TAB-1
"RTN","PRSDV459",89,0)
 W !,"PAY PERIOD: ",PPNAME,?TAB,CATEGORY,?73,"PAGE ",PAGE
"RTN","PRSDV459",90,0)
 W !,DASHES
"RTN","PRSDV459",91,0)
 K CLNGTH,TAB
"RTN","PRSDV459",92,0)
 Q
"RTN","PRSDV459",93,0)
LD ; Display Labor Distribution codes
"RTN","PRSDV459",94,0)
 Q:'$G(DA)
"RTN","PRSDV459",95,0)
 N PRSLD,LDCNT,LDDATA,Y
"RTN","PRSDV459",96,0)
 F PRSLD=1:1:4 D
"RTN","PRSDV459",97,0)
 . S DIC=459,DR=1,DA=PP ; Specify Pay Period 
"RTN","PRSDV459",98,0)
 . S DR(459.01)=173,DA(459.01)=EMP ; Specify Employee
"RTN","PRSDV459",99,0)
 . S DR(459.1173)="1;2;3;4",DA(459.1173)=PRSLD ; Specify LD multiple
"RTN","PRSDV459",100,0)
 . S DIQ(0)="IE",DIQ="LDDATA"
"RTN","PRSDV459",101,0)
 . D EN^DIQ1
"RTN","PRSDV459",102,0)
 . F LDCNT=1:1:4 D
"RTN","PRSDV459",103,0)
 . . S NODEDD=^DD(459.1173,LDCNT,0)
"RTN","PRSDV459",104,0)
 . . S INTERNAL=$G(LDDATA(459.1173,PRSLD,LDCNT,"I"))
"RTN","PRSDV459",105,0)
 . . I LDCNT'=3 S DESC=$G(LDDATA(459.1173,PRSLD,LDCNT,"E"))
"RTN","PRSDV459",106,0)
 . . I LDCNT=3 D
"RTN","PRSDV459",107,0)
 . . . S Y=INTERNAL,SUB454="CC"
"RTN","PRSDV459",108,0)
 . . . D OT^PRSDUTIL K SUB454
"RTN","PRSDV459",109,0)
 . . . S DESC=Y
"RTN","PRSDV459",110,0)
 . . W !,"LABOR DIST CODE-",PRSLD," ",$P(NODEDD,U,1)
"RTN","PRSDV459",111,0)
 . . W ?30,$S($P(NODEDD,U,5)["""$""":$J($FN(INTERNAL,",",2),14),$P(NODEDD,U,2)["NJ":$J(INTERNAL,14,2),$P(NODEDD,U,2)["D":$J(DESC,14),1:$J(INTERNAL,14))
"RTN","PRSDV459",112,0)
 . . I $P(NODEDD,U,2)'["D",INTERNAL'=DESC D DESC^PRSDW450
"RTN","PRSDV459",113,0)
 Q
"RTN","PRSDV459",114,0)
 ;
"RTN","PRSDV459",115,0)
DESC ;write description
"RTN","PRSDV459",116,0)
 I $L(DESC)<33 W ?47,DESC Q
"RTN","PRSDV459",117,0)
 S COLUMN=47,LGTH=0
"RTN","PRSDV459",118,0)
 F LOOP1=1:1 Q:LGTH=$L(DESC)!(LGTH>($L(DESC)))  W:$L($P(DESC," ",LOOP1))>(80-COLUMN) ! S:$L($P(DESC," ",LOOP1))>(80-COLUMN) COLUMN=47 W ?COLUMN,$P(DESC," ",LOOP1) S COLUMN=COLUMN+$L($P(DESC," ",LOOP1))+1,LGTH=LGTH+$L($P(DESC," ",LOOP1))+1
"RTN","PRSDV459",119,0)
 K COLUMN,LGTH,LOOP1 Q
"RTN","PRSDV459",120,0)
TABLE ;set subfile dr variable
"RTN","PRSDV459",121,0)
 ;;1;GENERAL INFORMATION;P1;1
"RTN","PRSDV459",122,0)
 ;;2;EARNINGS;P2;2
"RTN","PRSDV459",123,0)
 ;;3;DEDUCTIONS;P3;4
"RTN","PRSDV459",124,0)
 ;;4;LEAVE;P4;1
"RTN","PRSDV459",125,0)
 ;;5;LABOR DISTRIBUTION;
"RTN","PRSDV459",126,0)
 ;
"RTN","PRSDV459",127,0)
P1 ;;1;GENERAL INFORMATION;P1;1
"RTN","PRSDV459",128,0)
 ;;2,3,4,5,6,11,13,110,122,123,112,118,111,7,8,9,10,115,116,117,171,160
"RTN","PRSDV459",129,0)
P2 ;;2;EARNINGS;P2;2
"RTN","PRSDV459",130,0)
 ;;81,82,83,73,85,124,149,86,87,94,95,101,90,91,97,99,100,88,89,92
"RTN","PRSDV459",131,0)
 ;;93,98,96,102,103,104,104.1,172,105,109,113,114,108,106,107,74
"RTN","PRSDV459",132,0)
P3 ;;3;DEDUCTIONS;P3;4
"RTN","PRSDV459",133,0)
 ;;20,21,22,23,24,27,28,29,25,26,39,40,56,57,60,63,66,59,62,65,58,61
"RTN","PRSDV459",134,0)
 ;;64,33,34,35,30,31,32,36,37,41:1:48,55,53,54,67.1,67,68.1,68,68.3
"RTN","PRSDV459",135,0)
 ;;68.2,68.5,68.4,69,70,71,72,38,84,49,50,51,52,150,151,178,179
"RTN","PRSDV459",136,0)
 ;;152,153,180,181,167,168,175,174,177,176,159
"RTN","PRSDV459",137,0)
P4 ;;4;LEAVE;P4;1
"RTN","PRSDV459",138,0)
 ;;75,76,77,78,79,80,80.1,80.2,106,107,154,155,156,157,158
"RTN","PRSDV459",139,0)
P5 ;;5;LABOR DISTRIBUTION;
"VER")
8.0^22.0
**END**
**END**
