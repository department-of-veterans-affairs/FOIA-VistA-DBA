Released SD*5.3*303 SEQ #278
Extracted from mail message
**KIDS**:SD*5.3*303^

**INSTALL NAME**
SD*5.3*303
"BLD",4966,0)
SD*5.3*303^SCHEDULING^0^3030804^y
"BLD",4966,1,0)
^^11^11^3030804^
"BLD",4966,1,1,0)
This patch addresses the ENDOFILE error message received in 'Cancel Clinic
"BLD",4966,1,2,0)
Availability' [SDCANCEL] when queuing the print job is not performed. It 
"BLD",4966,1,3,0)
also addresses 'Restore Clinic Availability' [SDRESTORE] when an 
"BLD",4966,1,4,0)
undefined variable (DH) occurs due to missing appointment patterns for 
"BLD",4966,1,5,0)
that day of week.
"BLD",4966,1,6,0)
 
"BLD",4966,1,7,0)
 
"BLD",4966,1,8,0)
This patch addresses the following NOIS message(s):
"BLD",4966,1,9,0)
---------------------------------------------------
"BLD",4966,1,10,0)
CMO-0600-41899   CANCEL CLINIC AVAILABILITY GIVES END OF FILE ERROR
"BLD",4966,1,11,0)
MAC-0200-60343   UNDEFINED SYMBOL, DH IN SDUNC ROUTINE.
"BLD",4966,4,0)
^9.64PA^^
"BLD",4966,"ABPKG")
n
"BLD",4966,"KRN",0)
^9.67PA^8989.52^19
"BLD",4966,"KRN",.4,0)
.4
"BLD",4966,"KRN",.401,0)
.401
"BLD",4966,"KRN",.402,0)
.402
"BLD",4966,"KRN",.403,0)
.403
"BLD",4966,"KRN",.5,0)
.5
"BLD",4966,"KRN",.84,0)
.84
"BLD",4966,"KRN",3.6,0)
3.6
"BLD",4966,"KRN",3.8,0)
3.8
"BLD",4966,"KRN",9.2,0)
9.2
"BLD",4966,"KRN",9.8,0)
9.8
"BLD",4966,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",4966,"KRN",9.8,"NM",1,0)
SDC0^^0^B18822147
"BLD",4966,"KRN",9.8,"NM",2,0)
SDUNC^^0^B21489786
"BLD",4966,"KRN",9.8,"NM","B","SDC0",1)

"BLD",4966,"KRN",9.8,"NM","B","SDUNC",2)

"BLD",4966,"KRN",19,0)
19
"BLD",4966,"KRN",19.1,0)
19.1
"BLD",4966,"KRN",101,0)
101
"BLD",4966,"KRN",409.61,0)
409.61
"BLD",4966,"KRN",771,0)
771
"BLD",4966,"KRN",870,0)
870
"BLD",4966,"KRN",8989.51,0)
8989.51
"BLD",4966,"KRN",8989.52,0)
8989.52
"BLD",4966,"KRN",8994,0)
8994
"BLD",4966,"KRN","B",.4,.4)

"BLD",4966,"KRN","B",.401,.401)

"BLD",4966,"KRN","B",.402,.402)

"BLD",4966,"KRN","B",.403,.403)

"BLD",4966,"KRN","B",.5,.5)

"BLD",4966,"KRN","B",.84,.84)

"BLD",4966,"KRN","B",3.6,3.6)

"BLD",4966,"KRN","B",3.8,3.8)

"BLD",4966,"KRN","B",9.2,9.2)

"BLD",4966,"KRN","B",9.8,9.8)

"BLD",4966,"KRN","B",19,19)

"BLD",4966,"KRN","B",19.1,19.1)

"BLD",4966,"KRN","B",101,101)

"BLD",4966,"KRN","B",409.61,409.61)

"BLD",4966,"KRN","B",771,771)

"BLD",4966,"KRN","B",870,870)

"BLD",4966,"KRN","B",8989.51,8989.51)

"BLD",4966,"KRN","B",8989.52,8989.52)

"BLD",4966,"KRN","B",8994,8994)

"BLD",4966,"QUES",0)
^9.62^^
"BLD",4966,"REQB",0)
^9.611^1^1
"BLD",4966,"REQB",1,0)
DG*5.3*539^1
"BLD",4966,"REQB","B","DG*5.3*539",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
303^3030804
"PKG",16,22,1,"PAH",1,1,0)
^^11^11^3030804
"PKG",16,22,1,"PAH",1,1,1,0)
This patch addresses the ENDOFILE error message received in 'Cancel Clinic
"PKG",16,22,1,"PAH",1,1,2,0)
Availability' [SDCANCEL] when queuing the print job is not performed. It 
"PKG",16,22,1,"PAH",1,1,3,0)
also addresses 'Restore Clinic Availability' [SDRESTORE] when an 
"PKG",16,22,1,"PAH",1,1,4,0)
undefined variable (DH) occurs due to missing appointment patterns for 
"PKG",16,22,1,"PAH",1,1,5,0)
that day of week.
"PKG",16,22,1,"PAH",1,1,6,0)
 
"PKG",16,22,1,"PAH",1,1,7,0)
 
"PKG",16,22,1,"PAH",1,1,8,0)
This patch addresses the following NOIS message(s):
"PKG",16,22,1,"PAH",1,1,9,0)
---------------------------------------------------
"PKG",16,22,1,"PAH",1,1,10,0)
CMO-0600-41899   CANCEL CLINIC AVAILABILITY GIVES END OF FILE ERROR
"PKG",16,22,1,"PAH",1,1,11,0)
MAC-0200-60343   UNDEFINED SYMBOL, DH IN SDUNC ROUTINE.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","SDC0")
0^1^B18822147
"RTN","SDC0",1,0)
SDC0 ;MAN/GRR,ALB/TMP/LDB - Continuation of SDC (cancel a clinic) ; 16 JUL 2003  1:27 pm
"RTN","SDC0",2,0)
 ;;5.3;Scheduling;**303**;Aug 13, 1993
"RTN","SDC0",3,0)
CHKEND G:NOAP END
"RTN","SDC0",4,0)
 S %=1,DTOUT=0 W !,"WANT TO AUTO-REBOOK APPOINTMENTS NOW" D YN^DICN I '% W !,"REPLY YES (Y) OR NO (N)" G CHKEND
"RTN","SDC0",5,0)
 S ANS=$S('(%-1):"Y",1:"N") I %<0 W " NO" Q:'DTOUT
"RTN","SDC0",6,0)
ASKL S SDLT1="",%=1,(SDLET,SDFORM)="" W !,"WANT LETTERS PRINTED NOW" D YN^DICN I '% W !,"REPLY YES (Y) OR NO (N)" G ASKL
"RTN","SDC0",7,0)
 W:%<0 " NO" S ALS=$S('(%-1):"Y",1:"N") G:ALS'["Y" AOR
"RTN","SDC0",8,0)
EN Q:($P(^SC(SC,0),"^",3)'="C")!($D(SDVAUTC(+SC)))  S SDIV=$P(^SC(SC,0),"^",15),SDIV=$S(SDIV:SDIV,1:$N(^DG(40.8,0))) I $D(SDLT),SDIV'=SDV1 Q
"RTN","SDC0",9,0)
 K SDRE,SDIN I $D(SDLT)&($D(^SC(SC,"I"))) S SDIN=+^("I"),SDRE=+$P(^("I"),"^",2) I $D(SDIN),SDIN,SDIN'>SDBD&('$D(SDRE)!('SDRE)!(SDRE>SDED)) Q
"RTN","SDC0",10,0)
 S:'SDLT1 SDLET=$S($D(^SC(SC,"LTR")):$P(^("LTR"),"^",3),1:"") S ALS=$S(SDLET:"Y",1:"N")
"RTN","SDC0",11,0)
 I ALS="N" W !,"NO LETTERS ARE ASSIGNED TO THE ",$P(^SC(SC,0),"^")," CLINIC" Q:$D(SDLT)
"RTN","SDC0",12,0)
 I SDFORM="",$D(^DG(40.8,SDIV,"LTR")),^("LTR") S SDFORM=^("LTR")
"RTN","SDC0",13,0)
 I $D(SDLT),(ALS'="N") D CHK Q
"RTN","SDC0",14,0)
 Q:$D(SDLT)
"RTN","SDC0",15,0)
AOR G:ANS'["Y"&(ALS'["Y") END
"RTN","SDC0",16,0)
 I '$D(SDLT) S DGPGM="START^SDC0",DGVAR="SC^SI^CDATE^ALS^ANS^SDLET^SDTIME"_$S($D(SDIN):"^SDIN^SDRE",1:"")_"^SDFORM^SDV1"
"RTN","SDC0",17,0)
 I '$D(SDLT) D FZIS^DGUTQ G:POP END
"RTN","SDC0",18,0)
START U IO I ANS'["Y"&('$D(SDLT)) D:ALS["Y" APP D END Q
"RTN","SDC0",19,0)
BEG1 I $D(SDLT) S SDARRAY=$S('VAUTC:"VAUTC",1:"^SC"),ANS="N",ALS="Y" F SC=0:0 S SC=$N(@(SDARRAY_"("_SC_")")) Q:SC'>0  K SDOK1 D EN I $D(SDOK1),SDLET F SD=(SDBD-.1):0 S SD=$N(^SC(SC,"S",SD)) S CDATE=SD Q:SD>(SDED+.999999)!(SD'>0)  D ^SDC3
"RTN","SDC0",20,0)
 I $D(SDLT),$D(^UTILITY("SDLT")) D PR^SDC3,END Q
"RTN","SDC0",21,0)
 Q:$D(SDLT)  D ^SDAUT1
"RTN","SDC0",22,0)
 I MAX=0 W !,"AUTO-REBOOKING NOT ALLOWED FOR THIS CLINIC" G APP:ALS["Y",END
"RTN","SDC0",23,0)
 F GDATE=CDATE:0 S GDATE=$N(^SC(SC,"S",GDATE)) Q:GDATE<0!(GDATE>(CDATE+1))  F L=0:0 S L=$N(^SC(SC,"S",GDATE,1,L)) Q:L<0  S A=^(L,0) I $D(^DPT(+A,"S",GDATE,0)),$P(^(0),"^",2)="C",$P(^(0),"^",14)=SDTIME D ^SDAUT2,^SDCCP
"RTN","SDC0",24,0)
 D:ALS["Y" APP
"RTN","SDC0",25,0)
END K %,%DT,%H,%I,%DT,%IS,%ZIS,A,ALS,ANS,BY,CDATE,CHAR,DA,DFN,DH,DHD,DIC,DIS,DO,DOW,FLDS,FR,GDATE,I,L,LET,MAX,NOAP,P,POP,SI,SL,SS,ST,SDSTRTDT,TO,X,Y,ADDR,B,CLIN,HX,L0,L1,L2,LL,PDAT,S,TIME,Z,D,ENDATE,J,SM,STIME,X1,X2,SDX1,SDX2,SDRE,SDRE1,SDIN,FSW
"RTN","SDC0",26,0)
 K SC,SD,Z0,Z5,DGPGM,DUPE,J2,MESS,NDATE,SDDIF,SDFORM,SDINP,SDFORM,SDLET,SDLT1,SDNODE,SDRT,SDSOH,SDST,SDV1,DGVAR,SD1,SD8,SD81,SDANS,SDCNT,SDERR,SDHTO,SDJ,SDTIME,SDZ,STARTDAY,SD82,SDOK,SDOK1,SDLE,SDZ,SDOK1,TST,W,^UTILITY("SD")
"RTN","SDC0",27,0)
 K DIW,DIWF,DIWL,DIWR,DIWT,DN,DUPE,J2,MESS,NDATE,SDADD,SDC,SDCL,SDDAT,SDDIF,SDFORM,SDHX,SDINP,SDIV,SDLET,SDNODE,SDRT,SDSOH,SDST,SDT0,TST,SDV1 D CLOSE^DGUTQ Q
"RTN","SDC0",28,0)
CHK K SDOK1 I $D(^SC(SC,"SL")) S SL=^("SL"),%=$P(SL,"^",6),SI=$S(%="":4,%<3:4,%:%,1:4) S SDOK1=1 K SL,% E  W $P(^SC(SC,0),"^")," does not have an appointment length indicated."
"RTN","SDC0",29,0)
 Q
"RTN","SDC0",30,0)
APP F GDATE=CDATE:0 S GDATE=$N(^SC(+SC,"S",GDATE)) Q:GDATE<0!(GDATE>(CDATE+1))  F L=0:0 S L=$N(^SC(+SC,"S",GDATE,1,L)) Q:L<0  S A=^(L,0) D CHECK
"RTN","SDC0",31,0)
 Q
"RTN","SDC0",32,0)
CHK1 S (SDX,X)=GDATE D WRAPP^SDLT
"RTN","SDC0",33,0)
 I $P(S,"^",2)'["A" D REST^SDLT Q
"RTN","SDC0",34,0)
 S SDX=$P(S,"^",10) I '$D(^DPT(+A,"S",SDX,0)) D REST^SDLT Q
"RTN","SDC0",35,0)
 W !!,"The cancelled appointment(s) were rescheduled as follows:",!
"RTN","SDC0",36,0)
 S S=^DPT(+A,"S",SDX,0) D WRAPP^SDLT,REST^SDLT
"RTN","SDC0",37,0)
 Q
"RTN","SDC0",38,0)
CHECK I $S('$D(^DPT(+A,.35)):1,$P(^DPT(+A,.35),"^",1)']"":1,1:0),$D(^DPT(+A,"S",GDATE)),$P(^DPT(+A,"S",GDATE,0),"^",2)["C",$P(^(0),"^",14)=SDTIME!(SDTIME="*") S S=^DPT(+A,"S",GDATE,0) D ^SDLT,CHK1
"RTN","SDC0",39,0)
 Q
"RTN","SDUNC")
0^2^B21489786
"RTN","SDUNC",1,0)
SDUNC ;MAN/GRR - RESTORE CLINIC AVAILABILITY ; 24 JUL 2003  10:08 am
"RTN","SDUNC",2,0)
 ;;5.3;Scheduling;**79,303**;Aug 13, 1993
"RTN","SDUNC",3,0)
 D DT^DICRW S DIC=44,DIC(0)="MEQA",DIC("S")="I $P(^(0),""^"",3)=""C"",'$G(^(""OOS""))",DIC("A")="Select CLINIC NAME: " D ^DIC K DIC("S"),DIC("A") Q:"^"[X  G:Y<0 SDUNC Q:'$D(^SC(+Y,"SL"))
"RTN","SDUNC",4,0)
 S SC=+Y,SL=^("SL"),%DT="AEXF",%DT("A")="RESTORE '"_$P(Y,U,2)_"' FOR WHAT DATE: " D ^%DT K %DT Q:Y<0  ;NAKED REFERENCE - ^SC(IFN,"SL")
"RTN","SDUNC",5,0)
 S (SD,CDATE)=Y,%=$P(SL,U,6),SI=$S(%="":4,%<3:4,%:%,1:4),%=$P(SL,U,3),STARTDAY=$S(%:%,1:8)
"RTN","SDUNC",6,0)
 K SDIN,SDIN1,SDRE,SDRE1 I $D(^SC(SC,"I")) S SDIN=+^("I"),SDRE=+$P(^("I"),"^",2),Y=SDIN D DTS^SDUTL S SDIN1=Y,Y=SDRE D DTS^SDUTL S SDRE1=Y
"RTN","SDUNC",7,0)
 I $S('$D(SDIN):0,'SDIN:0,SDIN>CDATE:0,SDRE'>CDATE&(SDRE):0,1:1) W !,*7,"Clinic is inactive ",$S(SDRE:"from ",1:"as of "),SDIN1,$S(SDRE:" to "_SDRE1,1:"") G SDUNC
"RTN","SDUNC",8,0)
 K SDIN,SDIN1,SDRE,SDRE1 G:'$D(^SC(SC,"ST",SD,1)) NOWAY
"RTN","SDUNC",9,0)
 I $D(^SC(SC,"ST",SD,1)),^(1)'["CANCELLED"&(^(1)'["X") G NOWAY
"RTN","SDUNC",10,0)
 I $D(^SC(SC,"ST",SD,9)) I $D(^SC(SC,"OST",SD,1)) D FIX Q:^SC(SC,"ST",SD,1)["X"&('$D(SDFR1))  S ^SC(SC,"ST",SD,1)=HOLD K:^(1)'["X" ^SC(SC,"ST",SD,"CAN") W !,"RESTORED!",*7 D CHK Q
"RTN","SDUNC",11,0)
 I $D(^SC(SC,"ST",SD,9)),'$D(^SC(SC,"OST",SD,1)) G ERRM^SDUNC1
"RTN","SDUNC",12,0)
 D B I '$D(DH) G NOPAT
"RTN","SDUNC",13,0)
 Q:^SC(SC,"ST",SD,1)["X"&('$D(SDFR1))  S ^SC(SC,"ST",SD,0)=SD,^SC(SC,"ST",SD,1)=DH G N
"RTN","SDUNC",14,0)
NOWAY W !,*7,"CLINIC HAS NOT BEEN CANCELLED FOR THAT DATE, SO IT CANNOT BE RESTORED",*7 G SDUNC
"RTN","SDUNC",15,0)
NOPAT W !,*7,"NO UPCOMING OR INDEFINITE APPOINTMENT PATTERN EXISTS FOR DAY OF WEEK,",!,"CREATE 'AVAILABILITY' PATTERN THRU 'CLINIC SETUP', THEN RESTORE AGAIN",*7 G SDUNC
"RTN","SDUNC",16,0)
B S X=SD D DOW^SDM0 S DOW=Y,SS=$N(^SC(SC,"T"_Y,X)) I $D(^(SS,1)),^(1)]"" S DH=$P("SU^MO^TU^WE^TH^FR^SA","^",DOW+1)_" "_$E(SD,6,7)_$J("",SI+SI-6)_^(1),DO=X+1,DA(1)=SC,HOLD=DH D FIX2
"RTN","SDUNC",17,0)
 Q
"RTN","SDUNC",18,0)
N I '$F(^SC(SC,"ST",SD,1),"[") K ^SC(SC,"ST",SD) W !,*7,"CLINIC DOES NOT MEET ON THAT DAY" G SDUNC
"RTN","SDUNC",19,0)
 K:^SC(SC,"ST",SD,1)'["X" ^SC(SC,"ST",SD,"CAN") W !,"RESTORED!",*7 D CHK Q
"RTN","SDUNC",20,0)
FIX I ^SC(SC,"ST",SD,1)["X" S SDREST=^SC(SC,"OST",SD,1) D SEL Q
"RTN","SDUNC",21,0)
 S HOLD=^SC(SC,"OST",SD,1)
"RTN","SDUNC",22,0)
 Q
"RTN","SDUNC",23,0)
CHK F N1=SD:0 S N1=$N(^SC(SC,"S",N1)) Q:N1<0!(N1\1-SD)  I $D(^SC(SC,"S",N1,"MES")) D KMES I $D(SDFR1),'$D(^("MES")) Q
"RTN","SDUNC",24,0)
 Q
"RTN","SDUNC",25,0)
FIX2 Q:^SC(SC,"ST",SD,1)'["X"
"RTN","SDUNC",26,0)
 S SDREST=DH D SEL Q:'$D(SDFR1)  S DH=HOLD
"RTN","SDUNC",27,0)
 Q
"RTN","SDUNC",28,0)
SEL K SDFR1 Q:'$D(^SC(SC,"SL"))  S SL=^("SL"),%=$P(SL,U,6),SI=$S(%="":4,%<3:4,%:%,1:4),%=$P(SL,U,3),STARTDAY=$S(%:%,1:8)
"RTN","SDUNC",29,0)
 W !,"Clinic has been cancelled for the following periods:",!
"RTN","SDUNC",30,0)
 K SDTEMP,SDZZ S SDZZ=0 F I=SD:0 S I=$N(^SC(SC,"SDCAN",I)) Q:I'>0!(I\1-SD)  S SDZZ=SDZZ+1,X=I D TM S SDFR=X,SDFRX=X1,X="."_$P(^(I,0),"^",2) D TM S SDTO=X,SDTEMP(SDFRX_"-"_X1)=SDFR_"^"_SDTO,SDZZ(SDZZ)=SDFRX_"-"_X1
"RTN","SDUNC",31,0)
 F I=SD:0 S I=$N(^SC(SC,"S",I)) Q:I'>0!(I\1-SD)  I $D(^SC(SC,"S",I,"MES")),'$D(^SC(SC,"SDCAN",I)) S X=I D TM S SDFRX=X1,SDFR=X,X="."_$E(^SC(SC,"S",I,"MES"),17,20) D TM S SDZZ=SDZZ+1,SDTEMP(SDFRX_"-"_X1)=SDFR_"^"_X,SDZZ(SDZZ)=SDFRX_"-"_X1
"RTN","SDUNC",32,0)
 F I1=0:0 S I1=$N(SDZZ(I1)) Q:I1'>0  S I=SDTEMP(SDZZ(I1)) W !,?9,"(",$J(I1,2),") ","From: ",$J($P(I,"^",1),8),"   To: ",$J($P(I,"^",2),8)
"RTN","SDUNC",33,0)
A K SDFRX,X1,SDFR,SDTO R !!,"RESTORE WHICH PERIOD?: ",X:DTIME Q:"^"[X
"RTN","SDUNC",34,0)
 I X?1"?".E W !,"Enter the # that precedes the time period you want to restore." G A
"RTN","SDUNC",35,0)
 S SDR=X I $D(SDZZ(SDR)),$D(SDTEMP(SDZZ(SDR))) W "      ",$P(SDTEMP(SDZZ(SDR)),"^",1)," - ",$P(SDTEMP(SDZZ(SDR)),"^",2) G ROK
"RTN","SDUNC",36,0)
 W !,*7,"INVALID CHOICE, TRY AGAIN" G A
"RTN","SDUNC",37,0)
ROK S X=$P(SDZZ(SDR),"-",1) D TC S FR=X,SDBEG=%+SI+SI,X=$P(SDZZ(SDR),"-",2) D TC S TO=X,SDEND=%+SI+SI
"RTN","SDUNC",38,0)
 S SDFR1=CDATE+(FR/10000) K SDTEMP,SDZZ,SDR
"RTN","SDUNC",39,0)
 S HOLD=^SC(SC,"ST",SD,1),HOLD=$E(HOLD,1,SDBEG-1)_$E(SDREST,SDBEG,SDEND)_$E(HOLD,SDEND+1,80) K ^SC(SC,"SDCAN",SDFR1) I $D(^SC(SC,"SDCAN",0)) S CNT=$P(^(0),U,4),CNT=$S(CNT>0:CNT-1,1:0),^(0)=$P(^(0),U,1,3)_U_CNT K CNT
"RTN","SDUNC",40,0)
 K SDBEG,SDEND,SDANS,SI,STARTDAY,FR,TO Q
"RTN","SDUNC",41,0)
KMES I '$D(SDFR1) K ^("MES") Q  ;NAKED REFERENCE - ^SC(IFN,"S",DATE,"MES")
"RTN","SDUNC",42,0)
 I $D(SDFR1),N1=SDFR1 K ^("MES") Q  ;NAKED REFERENCE - ^SC(IFN,"S",DATE,"MES")
"RTN","SDUNC",43,0)
 Q
"RTN","SDUNC",44,0)
TC S %=$E(X,3,4),%=X\100-STARTDAY*SI+(%*SI\60)*2
"RTN","SDUNC",45,0)
 Q
"RTN","SDUNC",46,0)
TM S X=$E($P(X,".",2)_"0000",1,4),X1=X,%=X>1159 S:X>1259 X=X-1200 S X=X\100_":"_$E(X#100+100,2,3)_" "_$E("AP",%+1)_"M" Q
"VER")
8.0^22
**END**
**END**
