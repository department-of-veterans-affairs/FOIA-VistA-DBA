KIDS Distribution saved on Apr 24, 2007@09:46:08
PXRM*2*9/ICD*18*28/ICPT*6*34/LEX*2*49
**KIDS**:PXRM*2.0*9^ICD*18.0*28^ICPT*6.0*34^LEX*2.0*49^

**INSTALL NAME**
PXRM*2.0*9
"BLD",6552,0)
PXRM*2.0*9^CLINICAL REMINDERS^0^3070424^y
"BLD",6552,1,0)
^^2^2^3070213^
"BLD",6552,1,1,0)
Please see the National Patch Module for details of the enhancements
"BLD",6552,1,2,0)
included in this patch.
"BLD",6552,4,0)
^9.64PA^^
"BLD",6552,6.3)
4
"BLD",6552,"KRN",0)
^9.67PA^8989.52^19
"BLD",6552,"KRN",.4,0)
.4
"BLD",6552,"KRN",.401,0)
.401
"BLD",6552,"KRN",.402,0)
.402
"BLD",6552,"KRN",.403,0)
.403
"BLD",6552,"KRN",.5,0)
.5
"BLD",6552,"KRN",.84,0)
.84
"BLD",6552,"KRN",3.6,0)
3.6
"BLD",6552,"KRN",3.8,0)
3.8
"BLD",6552,"KRN",9.2,0)
9.2
"BLD",6552,"KRN",9.8,0)
9.8
"BLD",6552,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",6552,"KRN",9.8,"NM",1,0)
PXRMCSD^^0^B79007362
"BLD",6552,"KRN",9.8,"NM",2,0)
PXRMCSTX^^0^B33328998
"BLD",6552,"KRN",9.8,"NM",3,0)
PXRMP9E^^0^B21025349
"BLD",6552,"KRN",9.8,"NM","B","PXRMCSD",1)

"BLD",6552,"KRN",9.8,"NM","B","PXRMCSTX",2)

"BLD",6552,"KRN",9.8,"NM","B","PXRMP9E",3)

"BLD",6552,"KRN",19,0)
19
"BLD",6552,"KRN",19.1,0)
19.1
"BLD",6552,"KRN",101,0)
101
"BLD",6552,"KRN",409.61,0)
409.61
"BLD",6552,"KRN",771,0)
771
"BLD",6552,"KRN",870,0)
870
"BLD",6552,"KRN",8989.51,0)
8989.51
"BLD",6552,"KRN",8989.52,0)
8989.52
"BLD",6552,"KRN",8994,0)
8994
"BLD",6552,"KRN","B",.4,.4)

"BLD",6552,"KRN","B",.401,.401)

"BLD",6552,"KRN","B",.402,.402)

"BLD",6552,"KRN","B",.403,.403)

"BLD",6552,"KRN","B",.5,.5)

"BLD",6552,"KRN","B",.84,.84)

"BLD",6552,"KRN","B",3.6,3.6)

"BLD",6552,"KRN","B",3.8,3.8)

"BLD",6552,"KRN","B",9.2,9.2)

"BLD",6552,"KRN","B",9.8,9.8)

"BLD",6552,"KRN","B",19,19)

"BLD",6552,"KRN","B",19.1,19.1)

"BLD",6552,"KRN","B",101,101)

"BLD",6552,"KRN","B",409.61,409.61)

"BLD",6552,"KRN","B",771,771)

"BLD",6552,"KRN","B",870,870)

"BLD",6552,"KRN","B",8989.51,8989.51)

"BLD",6552,"KRN","B",8989.52,8989.52)

"BLD",6552,"KRN","B",8994,8994)

"BLD",6552,"PRE")
PXRMP9E
"BLD",6552,"QUES",0)
^9.62^^
"BLD",6552,"REQB",0)
^9.611^1^1
"BLD",6552,"REQB",1,0)
PXRM*2.0*4^2
"BLD",6552,"REQB","B","PXRM*2.0*4",1)

"MBREQ")
0
"PKG",364,-1)
1^1
"PKG",364,0)
CLINICAL REMINDERS^PXRM^Clinical Reminders^^^3030115
"PKG",364,20,0)
^9.402P^^
"PKG",364,22,0)
^9.49I^1^1
"PKG",364,22,1,0)
2.0^3050204^3060119^1119
"PKG",364,22,1,"PAH",1,0)
9^3070424^1118
"PKG",364,22,1,"PAH",1,1,0)
^^2^2^3070424
"PKG",364,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements
"PKG",364,22,1,"PAH",1,1,2,0)
included in this patch.
"PRE")
PXRMP9E
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","PXRMCSD")
0^1^B79007362
"RTN","PXRMCSD",1,0)
PXRMCSD ; SLC/JVS - Code Set Version-dialog file ; 02/22/2007
"RTN","PXRMCSD",2,0)
 ;;2.0;CLINICAL REMINDERS;**9**;Feb 04, 2005;Build 4
"RTN","PXRMCSD",3,0)
 ;Variable List
"RTN","PXRMCSD",4,0)
 ;TMP        =Mail message array
"RTN","PXRMCSD",5,0)
 ;DLGNAME    =Dialogue Name .01 field
"RTN","PXRMCSD",6,0)
 ;EFFDATE    =Effective Date
"RTN","PXRMCSD",7,0)
 ;FILE       =Name of the Glpbal (ie ICPT or ICD9)
"RTN","PXRMCSD",8,0)
 ;VAR,VAR3   =Variable Pointer
"RTN","PXRMCSD",9,0)
 ;VARIEN     =Ien from Variable Pointer
"RTN","PXRMCSD",10,0)
 ;VRSTATUS   =Status of Code in form 1 or 0
"RTN","PXRMCSD",11,0)
 ;VARDESC    =Code Text Description
"RTN","PXRMCSD",12,0)
 ;STATUS     =External form of Code Status
"RTN","PXRMCSD",13,0)
 ;NUM        =Line Number
"RTN","PXRMCSD",14,0)
 ;
"RTN","PXRMCSD",15,0)
 Q
"RTN","PXRMCSD",16,0)
TASKALL ;TASK for all codes
"RTN","PXRMCSD",17,0)
 S ZTRTN="DLG^PXRMCSD(""ALL"")"
"RTN","PXRMCSD",18,0)
 S ZTDESC="Finding Inactive Codes in Dialog file"
"RTN","PXRMCSD",19,0)
 S ZTIO=""
"RTN","PXRMCSD",20,0)
 S ZTDTH=$H
"RTN","PXRMCSD",21,0)
 D ^%ZTLOAD
"RTN","PXRMCSD",22,0)
 Q
"RTN","PXRMCSD",23,0)
TASKCPT ;TASK for Icpt codes Diagnosis
"RTN","PXRMCSD",24,0)
 S ZTRTN="DLG^PXRMCSD(""ICPT"")"
"RTN","PXRMCSD",25,0)
 S ZTDESC="Finding Inactive Codes in Dialog file"
"RTN","PXRMCSD",26,0)
 S ZTIO=""
"RTN","PXRMCSD",27,0)
 S ZTDTH=$H
"RTN","PXRMCSD",28,0)
 D ^%ZTLOAD
"RTN","PXRMCSD",29,0)
 Q
"RTN","PXRMCSD",30,0)
TASKICD ;TASK for ICD codes
"RTN","PXRMCSD",31,0)
 S ZTRTN="DLG^PXRMCSD(""ICD9"")"
"RTN","PXRMCSD",32,0)
 S ZTDESC="Finding Inactive Codes in Dialog file"
"RTN","PXRMCSD",33,0)
 S ZTIO=""
"RTN","PXRMCSD",34,0)
 S ZTDTH=$H
"RTN","PXRMCSD",35,0)
 D ^%ZTLOAD
"RTN","PXRMCSD",36,0)
 Q
"RTN","PXRMCSD",37,0)
OPTION ;Option entry point for dir call
"RTN","PXRMCSD",38,0)
 N X,Y,%,%H,X
"RTN","PXRMCSD",39,0)
 K DIR,Y,%I
"RTN","PXRMCSD",40,0)
 S DIR(0)="SX^1:ICPT Codes;2:ICD9 Codes;3:ALL Codes"
"RTN","PXRMCSD",41,0)
 S DIR("A")="Select Codes or All of the codes or ""^"" to exit"
"RTN","PXRMCSD",42,0)
 S DIR("?",1)="This option is use to evaluate the various codes"
"RTN","PXRMCSD",43,0)
 S DIR("?",2)="used in the reminder dialogs as Finding Items and"
"RTN","PXRMCSD",44,0)
 S DIR("?",3)="Additonal Finding Items. It will report by mail message"
"RTN","PXRMCSD",45,0)
 S DIR("?",4)="which codes are now inactive or are set to become"
"RTN","PXRMCSD",46,0)
 S DIR("?",5)="in the future."
"RTN","PXRMCSD",47,0)
 S DIR("B")="3"
"RTN","PXRMCSD",48,0)
 S DIR("?")="Select a code set to be evaluated"
"RTN","PXRMCSD",49,0)
 D ^DIR
"RTN","PXRMCSD",50,0)
 I Y=1 W !,"Check Mail for results....." S ZTRTN="DLG^PXRMCSD(""ICPT"",1)"
"RTN","PXRMCSD",51,0)
 I Y=2 W !,"Check Mail for results....." S ZTRTN="DLG^PXRMCSD(""ICD9"",1)"
"RTN","PXRMCSD",52,0)
 I Y=3 W !,"Check Mail for results....." S ZTRTN="DLG^PXRMCSD(""ALL"",1)"
"RTN","PXRMCSD",53,0)
 S ZTDESC="Finding Inactive Codes in Dialog file"
"RTN","PXRMCSD",54,0)
 S ZTIO=""
"RTN","PXRMCSD",55,0)
 D NOW^%DTC S ZTDTH=%H
"RTN","PXRMCSD",56,0)
 D ^%ZTLOAD
"RTN","PXRMCSD",57,0)
 K DIR,Y,%I,X
"RTN","PXRMCSD",58,0)
 Q
"RTN","PXRMCSD",59,0)
 ;
"RTN","PXRMCSD",60,0)
DLG(GLOBAL,OPTION) ;ENTRY POINT
"RTN","PXRMCSD",61,0)
 ;Test entry point to $O through dialogues
"RTN","PXRMCSD",62,0)
 ;GLOBAL = Which code set to check out.
"RTN","PXRMCSD",63,0)
 ;GLOBAL ="ICPT" OR "ICD9" OR "ALL"
"RTN","PXRMCSD",64,0)
 ;OPTION = From and option 1=yes null=no
"RTN","PXRMCSD",65,0)
 ;^PXRMD(801.41,IEN,1) 5TH PIECE
"RTN","PXRMCSD",66,0)
 Q:'$D(GLOBAL)
"RTN","PXRMCSD",67,0)
 N IEN,VAR,STATUS,NUM,ITEM,FILE,VARDIS,LINE,VARTYP
"RTN","PXRMCSD",68,0)
 N VARIEN,VRSTATUS,VARDESC,DLGNAME,VARIENX,ARRY,VARDIS
"RTN","PXRMCSD",69,0)
 N TMP,TYPE,XMDUN,XMSUB,XMUSB
"RTN","PXRMCSD",70,0)
 ;=====Set variables====================================
"RTN","PXRMCSD",71,0)
 S TMP="^TMP(""PXRMXMZ"",$J,NUM,0)"
"RTN","PXRMCSD",72,0)
 S NUM=0
"RTN","PXRMCSD",73,0)
 S LINE="S NUM=NUM+1"
"RTN","PXRMCSD",74,0)
 D TEXT
"RTN","PXRMCSD",75,0)
 S IEN=0 F  S IEN=$O(^PXRMD(801.41,IEN)) Q:IEN'>0  D
"RTN","PXRMCSD",76,0)
 .S VAR=$P($G(^PXRMD(801.41,IEN,1)),"^",5) ;varable pointer
"RTN","PXRMCSD",77,0)
 .S DLGNAME=$P($G(^PXRMD(801.41,IEN,0)),"^",1)
"RTN","PXRMCSD",78,0)
 .S TYPE=$P($G(^PXRMD(801.41,IEN,0)),"^",4)
"RTN","PXRMCSD",79,0)
 .I +VAR'=0 S ITEM=" FI" D
"RTN","PXRMCSD",80,0)
 ..;============ICPT(=================================
"RTN","PXRMCSD",81,0)
 ..N VARIEN,CPTDATA,IADATE,VARCODE,VARDESC,VARPAST,VARTYP,VARDIS,VART
"RTN","PXRMCSD",82,0)
 ..I $P(VAR,";",2)="ICPT(",((GLOBAL="ICPT")!(GLOBAL="ALL")) D
"RTN","PXRMCSD",83,0)
 ...S FILE=" CPT"
"RTN","PXRMCSD",84,0)
 ...S VARIEN=$P(VAR,";",1) ;Ien from variable pointer
"RTN","PXRMCSD",85,0)
 ...S CPTDATA=$$CPTA^PXRMCSU(VARIEN) ;ALL Cpt data
"RTN","PXRMCSD",86,0)
 ...I ($P(CPTDATA,"^",7)=0) D
"RTN","PXRMCSD",87,0)
 ....S IADATE=$$CONV^PXRMCSU($P(CPTDATA,"^",8)) ;Convert Inactive date
"RTN","PXRMCSD",88,0)
 ....S VARCODE=$$CPT^PXRMCSU(VARIEN) ;Code value
"RTN","PXRMCSD",89,0)
 ....S VARDESC=$$CPTD^PXRMCSU(VARIEN) ;Description
"RTN","PXRMCSD",90,0)
 ....S VARPAST=$P(CPTDATA,"^",11)
"RTN","PXRMCSD",91,0)
 ....D GETS^DIQ(801.41,IEN,"3;4","E","VART") S VARIENX=IEN_"," D
"RTN","PXRMCSD",92,0)
 .....S VARTYP=$G(VART(801.41,VARIENX,4,"E")) ;element type
"RTN","PXRMCSD",93,0)
 .....S VARDIS=$G(VART(801.41,VARIENX,3,"E")) ;element disabled
"RTN","PXRMCSD",94,0)
 ....D TMP
"RTN","PXRMCSD",95,0)
 ..;============ICD9(=================================
"RTN","PXRMCSD",96,0)
 ..N VARIEN,ICD9DATA,IADATE,VARCODE,VARDESC,VARPAST,VARTYP,VARDIS,VART
"RTN","PXRMCSD",97,0)
 ..I $P(VAR,";",2)="ICD9(",((GLOBAL="ICD9")!(GLOBAL="ALL")) D
"RTN","PXRMCSD",98,0)
 ...S FILE="ICD9"
"RTN","PXRMCSD",99,0)
 ...S VARIEN=$P(VAR,";",1) ;Ien from variable pointer
"RTN","PXRMCSD",100,0)
 ...S ICD9DATA=$$ICD9A^PXRMCSU(VARIEN) ;All ICD9 data
"RTN","PXRMCSD",101,0)
 ...I ($P(ICD9DATA,"^",10)=0) D
"RTN","PXRMCSD",102,0)
 ....S IADATE=$$CONV^PXRMCSU($P(ICD9DATA,"^",12)) ;Conver Inact date
"RTN","PXRMCSD",103,0)
 ....S VARCODE=$$ICD9^PXRMCSU(VARIEN) ;Code
"RTN","PXRMCSD",104,0)
 ....S VARDESC=$$ICD9D^PXRMCSU(VARIEN) ;Description
"RTN","PXRMCSD",105,0)
 ....S VARPAST=$P(ICD9DATA,"^",19)
"RTN","PXRMCSD",106,0)
 ....D GETS^DIQ(801.41,IEN,"3;4","E","VART") S VARIENX=IEN_"," D
"RTN","PXRMCSD",107,0)
 .....S VARTYP=$G(VART(801.41,VARIENX,4,"E")) ;element type
"RTN","PXRMCSD",108,0)
 .....S VARDIS=$G(VART(801.41,VARIENX,3,"E")) ;element description
"RTN","PXRMCSD",109,0)
 ....D TMP
"RTN","PXRMCSD",110,0)
 .D DLG3
"RTN","PXRMCSD",111,0)
 S XMSUB="Reminder Dialog "_$S(GLOBAL="ALL":"ICD9 AND CPT",GLOBAL="ICPT":"CPT",1:GLOBAL)_" Code changes"
"RTN","PXRMCSD",112,0)
 I '$D(^TMP("PXRMXMZ",$J)) D
"RTN","PXRMCSD",113,0)
 . S ^TMP("PXRMXMZ",$J,1,0)="No dialog elements using inactive codes were found."
"RTN","PXRMCSD",114,0)
 . S ^TMP("PXRMXMZ",$J,2,0)="No action is necessary."
"RTN","PXRMCSD",115,0)
 D SEND^PXRMMSG(XMSUB)
"RTN","PXRMCSD",116,0)
 K ^TMP("PXRMXMZ",$J)
"RTN","PXRMCSD",117,0)
 S ZTREQ="@"
"RTN","PXRMCSD",118,0)
 Q
"RTN","PXRMCSD",119,0)
DLG3 ;^PXRMD(801.41,IEN,3,IEN3,0) 1ST PIECE
"RTN","PXRMCSD",120,0)
 N IEN3,VAR3
"RTN","PXRMCSD",121,0)
 S IEN3=0 F  S IEN3=$O(^PXRMD(801.41,IEN,3,IEN3)) Q:IEN3'>0  D
"RTN","PXRMCSD",122,0)
 .S VAR3=$P($G(^PXRMD(801.41,IEN,3,IEN3,0)),"^",1)
"RTN","PXRMCSD",123,0)
 .I +VAR3'=0 S ITEM="AFI" D
"RTN","PXRMCSD",124,0)
 ..;================ICPT================================= 
"RTN","PXRMCSD",125,0)
 ..N VARIEN,CPTDATA,IADATE,VARCODE,VARDESC,VARPAST,VARTYP,VARDIS,VART
"RTN","PXRMCSD",126,0)
 ..I $P(VAR3,";",2)="ICPT(",((GLOBAL="ICPT")!(GLOBAL="ALL")) D
"RTN","PXRMCSD",127,0)
 ...S FILE=" CPT"
"RTN","PXRMCSD",128,0)
 ...S VARIEN=$P(VAR3,";",1) ;Ien from variable pointer
"RTN","PXRMCSD",129,0)
 ...S CPTDATA=$$CPTA^PXRMCSU(VARIEN) ;All CPT data
"RTN","PXRMCSD",130,0)
 ...I ($P(CPTDATA,"^",7)=0) D
"RTN","PXRMCSD",131,0)
 ....S IADATE=$$CONV^PXRMCSU($P(CPTDATA,"^",8)) ;Convert Inac Date
"RTN","PXRMCSD",132,0)
 ....S VARCODE=$$CPT^PXRMCSU(VARIEN) ;Code
"RTN","PXRMCSD",133,0)
 ....S VARDESC=$$CPTD^PXRMCSU(VARIEN) ;Description
"RTN","PXRMCSD",134,0)
 ....S VARPAST=$P(CPTDATA,"^",11)
"RTN","PXRMCSD",135,0)
 ....D GETS^DIQ(801.41,IEN,"3;4","E","VART") S VARIENX=IEN_"," D
"RTN","PXRMCSD",136,0)
 .....S VARTYP=$G(VART(801.41,VARIENX,4,"E")) ;element type
"RTN","PXRMCSD",137,0)
 .....S VARDIS=$G(VART(801.41,VARIENX,3,"E")) ;element description
"RTN","PXRMCSD",138,0)
 ....D TMP
"RTN","PXRMCSD",139,0)
 ..;================ICD9=================================
"RTN","PXRMCSD",140,0)
 ..N VARIEN,ICD9DATA,IADATE,VARCODE,VARDESC,VARPAST,VARTYP,VARDIS,VART
"RTN","PXRMCSD",141,0)
 ..I $P(VAR3,";",2)="ICD9(",((GLOBAL="ICD9")!(GLOBAL="ALL")) D
"RTN","PXRMCSD",142,0)
 ...S FILE="ICD9"
"RTN","PXRMCSD",143,0)
 ...S VARIEN=$P(VAR3,";",1) ;Ien from variable pointer
"RTN","PXRMCSD",144,0)
 ...S ICD9DATA=$$ICD9A^PXRMCSU(VARIEN) ;All ICD9 data
"RTN","PXRMCSD",145,0)
 ...I ($P(ICD9DATA,"^",10)=0) D
"RTN","PXRMCSD",146,0)
 ....S IADATE=$$CONV^PXRMCSU($P(ICD9DATA,"^",12)) ;Conver Inac date
"RTN","PXRMCSD",147,0)
 ....S VARCODE=$$ICD9^PXRMCSU(VARIEN) ;Code
"RTN","PXRMCSD",148,0)
 ....S VARDESC=$$ICD9D^PXRMCSU(VARIEN) ;Description
"RTN","PXRMCSD",149,0)
 ....S VARPAST=$P(ICD9DATA,"^",19)
"RTN","PXRMCSD",150,0)
 ....D GETS^DIQ(801.41,IEN,"3;4","E","VART") S VARIENX=IEN_"," D
"RTN","PXRMCSD",151,0)
 .....S VARTYP=$G(VART(801.41,VARIENX,4,"E")) ;element type
"RTN","PXRMCSD",152,0)
 .....S VARDIS=$G(VART(801.41,VARIENX,3,"E")) ;element desc
"RTN","PXRMCSD",153,0)
 ....D TMP
"RTN","PXRMCSD",154,0)
 Q
"RTN","PXRMCSD",155,0)
SUB ;==============Sub Routines=============================
"RTN","PXRMCSD",156,0)
 ;SET MAIL MESSAGE LINE
"RTN","PXRMCSD",157,0)
TMP ;Set tmp global lines
"RTN","PXRMCSD",158,0)
 X LINE S @TMP="    "_FILE_" "_ITEM_": "_VARCODE_" (Inactive "_$G(IADATE)_")"
"RTN","PXRMCSD",159,0)
 S VARDIS=$S($G(VARDIS)'="":"(Disabled)",1:"(Enabled)")
"RTN","PXRMCSD",160,0)
 S VARTYP=$G(VARTYP)
"RTN","PXRMCSD",161,0)
 X LINE S @TMP="    Found in: "_DLGNAME_" ["_VARTYP_"]"_" "_VARDIS
"RTN","PXRMCSD",162,0)
 D PARENT(IEN)
"RTN","PXRMCSD",163,0)
 Q
"RTN","PXRMCSD",164,0)
MESS ;Mail Message Static Text
"RTN","PXRMCSD",165,0)
 Q
"RTN","PXRMCSD",166,0)
MESS1 ;
"RTN","PXRMCSD",167,0)
 N GLOBALX
"RTN","PXRMCSD",168,0)
 S GLOBALX=$S(GLOBAL="ICPT":"CPT",GLOBAL="ICD9":"ICD9",GLOBAL="ALL":"CPT and/or ICD9",1:"")
"RTN","PXRMCSD",169,0)
 I $G(OPTION)=1 S MESS1="Review of inactive codes as of "_$$CONV^PXRMCSU(DT)
"RTN","PXRMCSD",170,0)
 I $G(OPTION)="" S MESS1="There was a "_GLOBALX_" code set update on "_$$CONV^PXRMCSU(DT)
"RTN","PXRMCSD",171,0)
 Q
"RTN","PXRMCSD",172,0)
MESS2 ;
"RTN","PXRMCSD",173,0)
 ;;
"RTN","PXRMCSD",174,0)
 ;;Please review the FINDING ITEM and ADDITIONAL FINDING items
"RTN","PXRMCSD",175,0)
 ;;currently used by REMINDER DIALOGS that may need changes.
"RTN","PXRMCSD",176,0)
 ;;
"RTN","PXRMCSD",177,0)
 ;;Consider adding another ADDITIONAL FINDING item to the reminder dialog
"RTN","PXRMCSD",178,0)
 ;;entry which will be active. This will allow the dialog to have old
"RTN","PXRMCSD",179,0)
 ;;and new codes associated with a dialog element, which will use
"RTN","PXRMCSD",180,0)
 ;;the item that is active for the encounter date.
"RTN","PXRMCSD",181,0)
 ;;Eventually, the inactive FINDING ITEM or ADDITIONAL FINDING items
"RTN","PXRMCSD",182,0)
 ;;should be removed from the dialog element.
"RTN","PXRMCSD",183,0)
 ;;
"RTN","PXRMCSD",184,0)
 ;;Note: FI=FINDING ITEM field    AFI=ADDITIONAL FINDING ITEMS field
"RTN","PXRMCSD",185,0)
 ;;Note: [finding type]  (status)
"RTN","PXRMCSD",186,0)
 ;;_______________________________________________________________________________
"RTN","PXRMCSD",187,0)
 Q
"RTN","PXRMCSD",188,0)
MESS3 ;
"RTN","PXRMCSD",189,0)
 ;;Report of Inactive ICD9 and CPT Codes referenced in the Reminder
"RTN","PXRMCSD",190,0)
 ;;Dialog file.
"RTN","PXRMCSD",191,0)
 ;;
"RTN","PXRMCSD",192,0)
 ;;Note: FI=FINDING ITEM field    AFI=ADDITIONAL FINDING ITEMS field
"RTN","PXRMCSD",193,0)
 ;;Note: [finding type]  (status)
"RTN","PXRMCSD",194,0)
 ;;_______________________________________________________________________________
"RTN","PXRMCSD",195,0)
 Q
"RTN","PXRMCSD",196,0)
TEXT ;display text
"RTN","PXRMCSD",197,0)
 N MESS1,PXRMI
"RTN","PXRMCSD",198,0)
 I GLOBAL="ALL" D
"RTN","PXRMCSD",199,0)
 .F PXRMI=1:1:6 X LINE S @TMP=$P($T(MESS3+PXRMI),";",3)
"RTN","PXRMCSD",200,0)
 I GLOBAL'="ALL" D
"RTN","PXRMCSD",201,0)
 .D MESS1 X LINE S @TMP=MESS1
"RTN","PXRMCSD",202,0)
 .F PXRMI=1:1:14 D
"RTN","PXRMCSD",203,0)
 ..X LINE S @TMP=$P($T(MESS2+PXRMI),";",3)
"RTN","PXRMCSD",204,0)
 Q
"RTN","PXRMCSD",205,0)
PARENT(PARXY) ;Get the Parent Dialog Element of the Dialog Element
"RTN","PXRMCSD",206,0)
 N PARY,PARXYVAR,PARX,PXRMTYPE
"RTN","PXRMCSD",207,0)
 S PARX=0 F  S PARX=$O(^PXRMD(801.41,PARX)) Q:PARX<1  D
"RTN","PXRMCSD",208,0)
 .S PARY=0 F  S PARY=$O(^PXRMD(801.41,PARX,10,"D",PARY)) Q:PARY<1  D 
"RTN","PXRMCSD",209,0)
 ..I PARXY=PARY D GETS^DIQ(801.41,PARX,"3;4","E","PXRMTYPE") D
"RTN","PXRMCSD",210,0)
 ...S PARXYVAR=PARX_",",VARDIS=$G(PXRMTYPE(801.41,PARXYVAR,3,"E")),VARDIS=$S($G(VARDIS)'="":"(Disabled)",1:"(Enabled)")
"RTN","PXRMCSD",211,0)
 ...X LINE S @TMP="     Used by: "_$P($G(^PXRMD(801.41,PARX,0)),"^",1)_" ["_$G(PXRMTYPE(801.41,PARXYVAR,4,"E"))_"]"_" "_VARDIS
"RTN","PXRMCSD",212,0)
 X LINE S @TMP="___________________________________________________________________________"
"RTN","PXRMCSD",213,0)
 Q
"RTN","PXRMCSTX")
0^2^B33328998
"RTN","PXRMCSTX",1,0)
PXRMCSTX ; SLC/PKR - Routines for taxonomy code set update. ; 02/22/2007
"RTN","PXRMCSTX",2,0)
 ;;2.0;CLINICAL REMINDERS;**9**;Feb 04, 2005;Build 4
"RTN","PXRMCSTX",3,0)
 ;
"RTN","PXRMCSTX",4,0)
 ;=====================================================
"RTN","PXRMCSTX",5,0)
ADDTMSG(LC,MSG) ;Add a set of messages to the global message.
"RTN","PXRMCSTX",6,0)
 N IND
"RTN","PXRMCSTX",7,0)
 S IND=0
"RTN","PXRMCSTX",8,0)
 F  S IND=$O(MSG(IND)) Q:IND=""  S LC=LC+1,^TMP("PXRMXMZ",$J,LC,0)=MSG(IND)
"RTN","PXRMCSTX",9,0)
 Q
"RTN","PXRMCSTX",10,0)
 ;
"RTN","PXRMCSTX",11,0)
 ;=====================================================
"RTN","PXRMCSTX",12,0)
ADJMSG(FILENUM,LOW,HIGH,ALOW,ALOWC,ALOWO,AHIGH,AHIGHC,AHIGHO,ADJMSG) ;
"RTN","PXRMCSTX",13,0)
 ;Create the message for adjacent codes that have changed.
"RTN","PXRMCSTX",14,0)
 N LC,TYPE
"RTN","PXRMCSTX",15,0)
 K ADJMSG
"RTN","PXRMCSTX",16,0)
 S TYPE=$S(FILENUM=80:"ICD9",FILENUM=80.1:"ICD0",FILENUM=81:"CPT")
"RTN","PXRMCSTX",17,0)
 S ADJMSG(1)="Adjacent "_TYPE_" codes have changed for the range defined by:"
"RTN","PXRMCSTX",18,0)
 S ADJMSG(2)=" Low code  "_$$GETCTEXT(FILENUM,LOW)
"RTN","PXRMCSTX",19,0)
 S ADJMSG(3)=" High code "_$$GETCTEXT(FILENUM,HIGH)
"RTN","PXRMCSTX",20,0)
 S LC=3
"RTN","PXRMCSTX",21,0)
 I ALOWC D
"RTN","PXRMCSTX",22,0)
 . S LC=LC+1,ADJMSG(LC)="  Old adjacent lower code "_$$GETCTEXT(FILENUM,ALOWO)
"RTN","PXRMCSTX",23,0)
 . S LC=LC+1,ADJMSG(LC)="  New adjacent lower code "_$$GETCTEXT(FILENUM,ALOW)
"RTN","PXRMCSTX",24,0)
 E  S LC=LC+1,ADJMSG(LC)="  No change in adjacent lower code"
"RTN","PXRMCSTX",25,0)
 I AHIGHC D
"RTN","PXRMCSTX",26,0)
 . S LC=LC+1,ADJMSG(LC)="  Old adjacent higher code "_$$GETCTEXT(FILENUM,AHIGHO)
"RTN","PXRMCSTX",27,0)
 . S LC=LC+1,ADJMSG(LC)="  New adjacent higher code "_$$GETCTEXT(FILENUM,AHIGH)
"RTN","PXRMCSTX",28,0)
 E  S LC=LC+1,ADJMSG(LC)="  No change in adjacent higher code"
"RTN","PXRMCSTX",29,0)
 S LC=LC+1,ADJMSG(LC)=" "
"RTN","PXRMCSTX",30,0)
 Q
"RTN","PXRMCSTX",31,0)
 ;
"RTN","PXRMCSTX",32,0)
 ;=====================================================
"RTN","PXRMCSTX",33,0)
CMSGHDR(TYPE) ;Create the message header.
"RTN","PXRMCSTX",34,0)
 N PTYPE
"RTN","PXRMCSTX",35,0)
 S PTYPE=$S(TYPE="CPT":"a CPT",TYPE="ICD":"an ICD")
"RTN","PXRMCSTX",36,0)
 S ^TMP("PXRMXMZ",$J,1,0)="There was "_PTYPE_" code set update on "_$$FMTE^XLFDT(DT,"5Z")_"."
"RTN","PXRMCSTX",37,0)
 S ^TMP("PXRMXMZ",$J,2,0)="This could affect adjacent codes and/or taxonomy expansions."
"RTN","PXRMCSTX",38,0)
 S ^TMP("PXRMXMZ",$J,3,0)="Please review the affected taxonomies and take appropriate action."
"RTN","PXRMCSTX",39,0)
 S ^TMP("PXRMXMZ",$J,4,0)="You can get the full details of a taxonomy using the taxonomy inquiry option."
"RTN","PXRMCSTX",40,0)
 S ^TMP("PXRMXMZ",$J,5,0)=" "
"RTN","PXRMCSTX",41,0)
 Q
"RTN","PXRMCSTX",42,0)
 ;
"RTN","PXRMCSTX",43,0)
 ;=====================================================
"RTN","PXRMCSTX",44,0)
CSU(TYPE) ;Entry point for code set update.
"RTN","PXRMCSTX",45,0)
 I TYPE'="CPT",TYPE'="ICD" Q
"RTN","PXRMCSTX",46,0)
 N ADJMSG,ALOW,ALOWC,ALOWO,AHIGH,AHIGHC,AHIGHO,CODEIEN,CODEMSG
"RTN","PXRMCSTX",47,0)
 N FI,FILELIST,FILENUM,IEN,IND,HIGH,LC,LOW,NFILES,NNEW,NEWCODES,SENDMSG
"RTN","PXRMCSTX",48,0)
 N TAXHDRE,TAXHDRL,TAXHDRS,TAXMSG,TEMP,XMSUB
"RTN","PXRMCSTX",49,0)
 I TYPE="CPT" S NFILES=1,FILELIST(1)=81
"RTN","PXRMCSTX",50,0)
 I TYPE="ICD" S NFILES=2,FILELIST(1)=80,FILELIST(2)=80.1
"RTN","PXRMCSTX",51,0)
 K ^TMP("PXRMXMZ",$J)
"RTN","PXRMCSTX",52,0)
 ;Set the line count to the end of the taxonomy header.
"RTN","PXRMCSTX",53,0)
 S TAXHDRS=6,TAXHDRL=1,TAXHDRE=TAXHDRS+TAXHDRL,LC=TAXHDRE
"RTN","PXRMCSTX",54,0)
 S (IEN,SENDMSG)=0
"RTN","PXRMCSTX",55,0)
 F  S IEN=+$O(^PXD(811.2,IEN)) Q:IEN=0  D
"RTN","PXRMCSTX",56,0)
 . F FI=1:1:NFILES D
"RTN","PXRMCSTX",57,0)
 .. S FILENUM=FILELIST(FI)
"RTN","PXRMCSTX",58,0)
 .. I '$D(^PXD(811.2,IEN,FILENUM,"B")) Q
"RTN","PXRMCSTX",59,0)
 .. S (IND,TAXMSG)=0
"RTN","PXRMCSTX",60,0)
 .. F  S IND=+$O(^PXD(811.2,IEN,FILENUM,IND)) Q:IND=0  D
"RTN","PXRMCSTX",61,0)
 ... S TEMP=^PXD(811.2,IEN,FILENUM,IND,0)
"RTN","PXRMCSTX",62,0)
 ... S LOW=$P(TEMP,U,1),HIGH=$P(TEMP,U,2)
"RTN","PXRMCSTX",63,0)
 ... S ALOWO=$P(TEMP,U,3),AHIGHO=$P(TEMP,U,4)
"RTN","PXRMCSTX",64,0)
 ... S ALOW=$S(FILENUM=80:$$PREV^ICDAPIU(LOW),FILENUM=80.1:$$PREV^ICDAPIU(LOW),FILENUM=81:$$PREV^ICPTAPIU(LOW))
"RTN","PXRMCSTX",65,0)
 ... S AHIGH=$S(FILENUM=80:$$NEXT^ICDAPIU(HIGH),FILENUM=80.1:$$NEXT^ICDAPIU(HIGH),FILENUM=81:$$NEXT^ICPTAPIU(HIGH))
"RTN","PXRMCSTX",66,0)
 ... I ALOW'=ALOWO S ALOWC=1,$P(^PXD(811.2,IEN,FILENUM,IND,0),U,3)=ALOW
"RTN","PXRMCSTX",67,0)
 ... E  S ALOWC=0
"RTN","PXRMCSTX",68,0)
 ... I AHIGH'=AHIGHO S AHIGHC=1,$P(^PXD(811.2,IEN,FILENUM,IND,0),U,4)=AHIGH
"RTN","PXRMCSTX",69,0)
 ... E  S AHIGHC=0
"RTN","PXRMCSTX",70,0)
 ... I ALOWC!AHIGHC D
"RTN","PXRMCSTX",71,0)
 .... D ADJMSG(FILENUM,LOW,HIGH,ALOW,ALOWC,ALOWO,AHIGH,AHIGHC,AHIGHO,.ADJMSG)
"RTN","PXRMCSTX",72,0)
 .... D ADDTMSG(.LC,.ADJMSG)
"RTN","PXRMCSTX",73,0)
 .... S TAXMSG=1
"RTN","PXRMCSTX",74,0)
 ..;Save the old expansion and compare with the old one.
"RTN","PXRMCSTX",75,0)
 .. K ^TMP($J,"OLDEXP")
"RTN","PXRMCSTX",76,0)
 .. S IND=0
"RTN","PXRMCSTX",77,0)
 .. F  S IND=+$O(^PXD(811.3,IEN,FILENUM,IND)) Q:IND=0  D
"RTN","PXRMCSTX",78,0)
 ... S CODEIEN=^PXD(811.3,IEN,FILENUM,IND,0)
"RTN","PXRMCSTX",79,0)
 ... S ^TMP($J,"OLDEXP",CODEIEN)=""
"RTN","PXRMCSTX",80,0)
 ..;Rexpand and compare with the old.
"RTN","PXRMCSTX",81,0)
 .. D DELEXTL^PXRMBXTL(IEN)
"RTN","PXRMCSTX",82,0)
 .. D EXPAND^PXRMBXTL(IEN,"")
"RTN","PXRMCSTX",83,0)
 ..;Old codes are never deleted from the ICD or CPT globals so just
"RTN","PXRMCSTX",84,0)
 ..;check for new entries in the expansion.
"RTN","PXRMCSTX",85,0)
 .. S (IND,NNEW)=0
"RTN","PXRMCSTX",86,0)
 .. F  S IND=+$O(^PXD(811.3,IEN,FILENUM,IND)) Q:IND=0  D
"RTN","PXRMCSTX",87,0)
 ... S CODEIEN=^PXD(811.3,IEN,FILENUM,IND,0)
"RTN","PXRMCSTX",88,0)
 ... I '$D(^TMP($J,"OLDEXP",CODEIEN)) S NNEW=NNEW+1,NEWCODES(NNEW)=CODEIEN
"RTN","PXRMCSTX",89,0)
 ..;If there are any new codes add them to the message.
"RTN","PXRMCSTX",90,0)
 .. I NNEW>0 D
"RTN","PXRMCSTX",91,0)
 ... D NEWCMSG(FILENUM,NNEW,.NEWCODES,.CODEMSG)
"RTN","PXRMCSTX",92,0)
 ... D ADDTMSG(.LC,.CODEMSG)
"RTN","PXRMCSTX",93,0)
 ... S TAXMSG=1
"RTN","PXRMCSTX",94,0)
 ..;Check the selectable codes.
"RTN","PXRMCSTX",95,0)
 .. D SELCODE^PXRMCSSC(FILENUM,IEN,.LC,.TAXMSG)
"RTN","PXRMCSTX",96,0)
 .. I TAXMSG D
"RTN","PXRMCSTX",97,0)
 ... D TAXHDR(IEN,TAXHDRS)
"RTN","PXRMCSTX",98,0)
 ... S TAXHDRS=LC+1,TAXHDRE=TAXHDRS+TAXHDRL,LC=TAXHDRE
"RTN","PXRMCSTX",99,0)
 ... S SENDMSG=1
"RTN","PXRMCSTX",100,0)
 S XMSUB="Clinical Reminder taxonomy updates, new "_TYPE_" global installation."
"RTN","PXRMCSTX",101,0)
 I SENDMSG D CMSGHDR(TYPE)
"RTN","PXRMCSTX",102,0)
 I 'SENDMSG D
"RTN","PXRMCSTX",103,0)
 . S ^TMP("PXRMXMZ",$J,1,0)="No changes in adjacent high and low codes were found."
"RTN","PXRMCSTX",104,0)
 . S ^TMP("PXRMXMZ",$J,2,0)="No inactive selectable codes were found."
"RTN","PXRMCSTX",105,0)
 . S ^TMP("PXRMXMZ",$J,3,0)="No action is necessary."
"RTN","PXRMCSTX",106,0)
 D SEND^PXRMMSG(XMSUB)
"RTN","PXRMCSTX",107,0)
 K ^TMP("PXRMXMZ",$J),^TMP($J,"OLDEXP")
"RTN","PXRMCSTX",108,0)
 Q
"RTN","PXRMCSTX",109,0)
 ;
"RTN","PXRMCSTX",110,0)
 ;=====================================================
"RTN","PXRMCSTX",111,0)
GETCTEXT(FILENUM,CODE) ;Return the code and text associated with the code.
"RTN","PXRMCSTX",112,0)
 N TEMP,TEXT
"RTN","PXRMCSTX",113,0)
 I FILENUM=80 D  Q TEXT
"RTN","PXRMCSTX",114,0)
 . S TEMP=$$ICDDX^ICDCODE(CODE,DT)
"RTN","PXRMCSTX",115,0)
 . S TEXT=$P(TEMP,U,2)_"-"_$P(TEMP,U,4)
"RTN","PXRMCSTX",116,0)
 I FILENUM=80.1 D  Q TEXT
"RTN","PXRMCSTX",117,0)
 . S TEMP=$$ICDOP^ICDCODE(CODE,DT)
"RTN","PXRMCSTX",118,0)
 . S TEXT=$P(TEMP,U,2)_"-"_$P(TEMP,U,5)
"RTN","PXRMCSTX",119,0)
 I FILENUM=81 D
"RTN","PXRMCSTX",120,0)
 . S TEMP=$$CPT^ICPTCOD(CODE,DT)
"RTN","PXRMCSTX",121,0)
 . S TEXT=$P(TEMP,U,2)_"-"_$P(TEMP,U,3)
"RTN","PXRMCSTX",122,0)
 Q TEXT
"RTN","PXRMCSTX",123,0)
 ;
"RTN","PXRMCSTX",124,0)
 ;=====================================================
"RTN","PXRMCSTX",125,0)
NEWCMSG(FILENUM,NNEW,NEWCODES,CODEMSG) ;Create the message for new codes
"RTN","PXRMCSTX",126,0)
 ;appearing in the expansion.
"RTN","PXRMCSTX",127,0)
 I NNEW=0 Q
"RTN","PXRMCSTX",128,0)
 N LC,IND,TYPE
"RTN","PXRMCSTX",129,0)
 K CODEMSG
"RTN","PXRMCSTX",130,0)
 S TYPE=$S(FILENUM=80:"ICD9",FILENUM=80.1:"ICD0",FILENUM=81:"CPT")
"RTN","PXRMCSTX",131,0)
 S CODEMSG(1)="The following are new "_TYPE_" codes in the expansion for this taxonomy:"
"RTN","PXRMCSTX",132,0)
 S LC=1
"RTN","PXRMCSTX",133,0)
 F IND=1:1:NNEW D
"RTN","PXRMCSTX",134,0)
 . S CODE=NEWCODES(IND)
"RTN","PXRMCSTX",135,0)
 . S LC=LC+1,CODEMSG(LC)=" "_$$GETCTEXT(FILENUM,CODE)
"RTN","PXRMCSTX",136,0)
 S LC=LC+1,CODEMSG(LC)=" "
"RTN","PXRMCSTX",137,0)
 Q
"RTN","PXRMCSTX",138,0)
 ;
"RTN","PXRMCSTX",139,0)
 ;=====================================================
"RTN","PXRMCSTX",140,0)
TAXHDR(IEN,LC) ;Create message header for a specific taxonomy.
"RTN","PXRMCSTX",141,0)
 S ^TMP("PXRMXMZ",$J,LC,0)="Taxonomy: "_$P(^PXD(811.2,IEN,0),U,1)_" = TX("_IEN_")"
"RTN","PXRMCSTX",142,0)
 Q
"RTN","PXRMCSTX",143,0)
 ;
"RTN","PXRMP9E")
0^3^B21025349
"RTN","PXRMP9E",1,0)
PXRMP9E ; SLC/KER - Environoment Check for LEX*2.0*49/PXRM+2*9 ;02/22/2007
"RTN","PXRMP9E",2,0)
 ;;2.0;CLINICAL REMINDERS;**9**;Feb 04, 2005;Build 4
"RTN","PXRMP9E",3,0)
 ;                     
"RTN","PXRMP9E",4,0)
 ; Local Variables not NEWed or KILLed
"RTN","PXRMP9E",5,0)
 ;   XPDENV
"RTN","PXRMP9E",6,0)
 ;                     
"RTN","PXRMP9E",7,0)
 ; Global Variables
"RTN","PXRMP9E",8,0)
 ;   None
"RTN","PXRMP9E",9,0)
 ;                     
"RTN","PXRMP9E",10,0)
 ; External References
"RTN","PXRMP9E",11,0)
 ;   DBIA 10015  EN^DIQ1
"RTN","PXRMP9E",12,0)
 ;   DBIA 10141  $$PATCH^XPDUTL
"RTN","PXRMP9E",13,0)
 ;   DBIA 10141  $$VERSION^XPDUTL
"RTN","PXRMP9E",14,0)
 ;   DBIA 10141  BMES^XPDUTL
"RTN","PXRMP9E",15,0)
 ;   DBIA 10141  MES^XPDUTL
"RTN","PXRMP9E",16,0)
 ;                     
"RTN","PXRMP9E",17,0)
ENV ; LEX*2.0*49 Environment Check
"RTN","PXRMP9E",18,0)
 D BM(" Code Set Update message fix (Remedy Ticket 175985)"),M(" ")
"RTN","PXRMP9E",19,0)
 N DA,DIC,DIQ,DR,PXRMB,PXRMBLD,PXRMBLDS,PXRMERR,PXRMHF,PXRMI,PXRML,PXRMPAT,PXRMPN,PXRMREQ,PXRMS,PXRMT,PXRMU,PXRMV,PXRMVER,X
"RTN","PXRMP9E",20,0)
 K XPDABORT,XPDQUIT S U="^",PXRMREQ="LEX*2.0*25;LEX*2.0*27;LEX*2.0*32;LEX*2.0*46;ICD*18.0*11;ICPT*6.0*16;PXRM*2.0*4"
"RTN","PXRMP9E",21,0)
 S PXRMBLD="LEX*2.0*49",PXRMBLDS="LEX*2.0*49;ICD*18.0*28;ICPT*6.0*34;PXRM*2.0*9",PXRMHF="LEX_2_49.KID"
"RTN","PXRMP9E",22,0)
 K PXRMERR D:+($$UR)'>0 ET("User not defined (DUZ)") I $D(PXRMERR) D ABRT Q
"RTN","PXRMP9E",23,0)
 D:+($$SY)'>0 ET("Undefined IO variable(s)") I $D(PXRMERR) D ABRT Q
"RTN","PXRMP9E",24,0)
 I +($G(XPDENV))>0 D
"RTN","PXRMP9E",25,0)
 . D M(" Fixes the following components:")
"RTN","PXRMP9E",26,0)
 . D BM("   LEX*2.0*49    Protocol LEXICAL SERVICES UPDATE")
"RTN","PXRMP9E",27,0)
 . D M("                 Routines LEXXFI, LEXXFI7, LEXXGI, LEXXGI2, and LEXXST")
"RTN","PXRMP9E",28,0)
 . D BM("   ICPT*6.0*34   Protocol ICPT CODE UPDATE EVENT")
"RTN","PXRMP9E",29,0)
 . D M("                 Routine  ICPTAU")
"RTN","PXRMP9E",30,0)
 . D BM("   ICD*18.0*28   Protocol ICD CODE UPDATE EVENT")
"RTN","PXRMP9E",31,0)
 . D M("                 Routine  ICDUPDT")
"RTN","PXRMP9E",32,0)
 . D BM("   PXRM*2.0*9    Protocol PXRM CODE SET UPDATE CPT")
"RTN","PXRMP9E",33,0)
 . D M("                 Protocol PXRM CODE SET UPDATE ICD")
"RTN","PXRMP9E",34,0)
 . D M("                 Routines PXRMCSD and PXRMCSTX"),M(" ")
"RTN","PXRMP9E",35,0)
 D M("   Checking installed package version numbers")
"RTN","PXRMP9E",36,0)
 S PXRMVER=$$VERSION^XPDUTL("LEX") I +PXRMVER'>1.9999 D  D ABRT Q
"RTN","PXRMP9E",37,0)
 . D ET("     Required Lexicon version 2.0 not found.")
"RTN","PXRMP9E",38,0)
 S PXRMV="     Lexicon Utility v "_PXRMVER,PXRMV=PXRMV_$J(" ",(30-$L(PXRMV)))
"RTN","PXRMP9E",39,0)
 S PXRMVER=$$VERSION^XPDUTL("PXRM") I +PXRMVER'>1.9999 D  D ABRT Q
"RTN","PXRMP9E",40,0)
 . D ET("     Required Clinical Reminders version 2.0 not found.")
"RTN","PXRMP9E",41,0)
 S PXRMV=PXRMV_"     Clinical Reminders v "_PXRMVER
"RTN","PXRMP9E",42,0)
 D M(PXRMV) S PXRMV=""
"RTN","PXRMP9E",43,0)
 S PXRMVER=$$VERSION^XPDUTL("ICD") I +PXRMVER'>17.9999 D  D ABRT Q
"RTN","PXRMP9E",44,0)
 . D ET("     Required ICD DRG Grouper version 18.0 not found.")
"RTN","PXRMP9E",45,0)
 S PXRMV="     ICD DRG Grouper v "_PXRMVER,PXRMV=PXRMV_$J(" ",(30-$L(PXRMV)))
"RTN","PXRMP9E",46,0)
 S PXRMVER=$$VERSION^XPDUTL("ICPT") I +PXRMVER'>5.9999 D  D ABRT Q
"RTN","PXRMP9E",47,0)
 . D ET("     Required ICPT/HCPCS Codes version 6.0 not found.")
"RTN","PXRMP9E",48,0)
 S PXRMV=PXRMV_"     ICPT/HCPCS Codes v "_PXRMVER
"RTN","PXRMP9E",49,0)
 D M(PXRMV) S PXRMV="" K PXRMERR D BM("   Checking for required patches")
"RTN","PXRMP9E",50,0)
 I $L(PXRMREQ) D
"RTN","PXRMP9E",51,0)
 . N PXRMPAT,PXRMI,PXRMPN,PXRMV,PXRMT
"RTN","PXRMP9E",52,0)
 . F PXRMI=1:1 Q:'$L($P(PXRMREQ,";",PXRMI))  S PXRMPAT=$P(PXRMREQ,";",PXRMI) D
"RTN","PXRMP9E",53,0)
 . . S PXRMPN=$$PATCH^XPDUTL(PXRMPAT) S PXRMT="     "_PXRMPAT
"RTN","PXRMP9E",54,0)
 . . S:PXRMPN>0 PXRMT=PXRMT_$J(" ",(35-$L(PXRMT)))_"installed"
"RTN","PXRMP9E",55,0)
 . . D:PXRMPN>0 M(PXRMT) I +PXRMPN'>0 D ET((PXRMPAT_" not found, please install "_PXRMPAT_" before continuing"))
"RTN","PXRMP9E",56,0)
 I $D(PXRMERR) D ABRT Q
"RTN","PXRMP9E",57,0)
QUIT ;   Quit   Passed Environment Check - OK
"RTN","PXRMP9E",58,0)
 D OK
"RTN","PXRMP9E",59,0)
 Q
"RTN","PXRMP9E",60,0)
ABRT ;   Abort  Failed Environment Check, KILL the distribution
"RTN","PXRMP9E",61,0)
 S PXRMBLDS="LEX*2.0*49;ICD*18.0*28;ICPT*6.0*34;PXRM*2.0*9"
"RTN","PXRMP9E",62,0)
 D:$D(PXRMERR) ED S XPDABORT=1,XPDQUIT=1 N PXRMI
"RTN","PXRMP9E",63,0)
 F PXRMI=1:1 Q:'$L($P(PXRMBLDS,";",PXRMI))  S XPDQUIT($P(PXRMBLDS,";",PXRMI))=1
"RTN","PXRMP9E",64,0)
 K PXRMERR
"RTN","PXRMP9E",65,0)
 Q
"RTN","PXRMP9E",66,0)
CLR ;   Clear Environment
"RTN","PXRMP9E",67,0)
 K DA,DIC,DIQ,DR,PXRMB,PXRMBLD,PXRMBLDS,PXRMERR,PXRMHF,PXRMI,PXRML,PXRMPAT,PXRMPN,PXRMREQ,PXRMS,PXRMT,PXRMU,PXRMV,PXRMVER,X
"RTN","PXRMP9E",68,0)
 Q
"RTN","PXRMP9E",69,0)
OK ;   Environment is OK
"RTN","PXRMP9E",70,0)
 N PXRMI,PXRMB,PXRMS,PXRML
"RTN","PXRMP9E",71,0)
 S PXRMS="  Environment "_$S($L($G(PXRMHF)):("for distribution "_$G(PXRMHF)_" "),1:"")_"is ok"
"RTN","PXRMP9E",72,0)
 D BM(PXRMS)
"RTN","PXRMP9E",73,0)
 S PXRML="  This distribution contains builds:   "
"RTN","PXRMP9E",74,0)
 D M(" ") F PXRMI=1:1 Q:'$L($P($G(PXRMBLDS),";",PXRMI))  S PXRMB=$P($G(PXRMBLDS),";",PXRMI) D
"RTN","PXRMP9E",75,0)
 . S PXRMS=PXRML_PXRMB,PXRML="                                       " D:$L($G(PXRMB)) M(PXRMS)
"RTN","PXRMP9E",76,0)
 D M(" ")
"RTN","PXRMP9E",77,0)
 Q
"RTN","PXRMP9E",78,0)
 ;            
"RTN","PXRMP9E",79,0)
 ;   Individual Checks
"RTN","PXRMP9E",80,0)
UR(X) ;     Check User variables
"RTN","PXRMP9E",81,0)
 Q:'$L($G(DUZ(0))) 0
"RTN","PXRMP9E",82,0)
 Q:+($G(DUZ))=0!($$NOTDEF(+$G(DUZ))) 0
"RTN","PXRMP9E",83,0)
 Q 1
"RTN","PXRMP9E",84,0)
NOTDEF(PXRMI) ;     Check to see if user is defined
"RTN","PXRMP9E",85,0)
 N DA,DR,DIQ,PXRMU,DIC S DA=PXRMI,DR=.01,DIC=200,DIQ="PXRMU" D EN^DIQ1
"RTN","PXRMP9E",86,0)
 Q '$D(PXRMU)
"RTN","PXRMP9E",87,0)
SY(X) ;     Check System variables
"RTN","PXRMP9E",88,0)
 Q:'$D(IO)!('$D(IOF))!('$D(IOM))!('$D(ION))!('$D(IOSL))!('$D(IOST)) 0
"RTN","PXRMP9E",89,0)
 Q 1
"RTN","PXRMP9E",90,0)
 ;            
"RTN","PXRMP9E",91,0)
 ;   Messages
"RTN","PXRMP9E",92,0)
ET(X) ;     Error Test
"RTN","PXRMP9E",93,0)
 N PXRMI S PXRMI=+($G(PXRMERR(0))),PXRMI=PXRMI+1,PXRMERR(PXRMI)="    "_$G(X),PXRMERR(0)=PXRMI
"RTN","PXRMP9E",94,0)
 Q
"RTN","PXRMP9E",95,0)
ED ;     Error Display
"RTN","PXRMP9E",96,0)
 N PXRMI S PXRMI=0 F  S PXRMI=$O(PXRMERR(PXRMI)) Q:+PXRMI=0  D M(PXRMERR(PXRMI))
"RTN","PXRMP9E",97,0)
 D M(" ") K PXRMERR Q
"RTN","PXRMP9E",98,0)
BM(X) ;     Blank Line with Message
"RTN","PXRMP9E",99,0)
 D BMES^XPDUTL($G(X)) Q
"RTN","PXRMP9E",100,0)
M(X) ;     Message
"RTN","PXRMP9E",101,0)
 D MES^XPDUTL($G(X)) Q
"VER")
8.0^22.0
**INSTALL NAME**
ICD*18.0*28
"BLD",6532,0)
ICD*18.0*28^DRG GROUPER^0^3070424^y
"BLD",6532,1,0)
^^2^2^3070207^
"BLD",6532,1,1,0)
Please see the National Patch Module for details of the enhancements
"BLD",6532,1,2,0)
included in this patch.
"BLD",6532,4,0)
^9.64PA^^
"BLD",6532,6.3)
3
"BLD",6532,"KRN",0)
^9.67PA^8989.52^19
"BLD",6532,"KRN",.4,0)
.4
"BLD",6532,"KRN",.401,0)
.401
"BLD",6532,"KRN",.402,0)
.402
"BLD",6532,"KRN",.403,0)
.403
"BLD",6532,"KRN",.5,0)
.5
"BLD",6532,"KRN",.84,0)
.84
"BLD",6532,"KRN",3.6,0)
3.6
"BLD",6532,"KRN",3.8,0)
3.8
"BLD",6532,"KRN",9.2,0)
9.2
"BLD",6532,"KRN",9.8,0)
9.8
"BLD",6532,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6532,"KRN",9.8,"NM",1,0)
ICDUPDT^^0^B146682
"BLD",6532,"KRN",9.8,"NM","B","ICDUPDT",1)

"BLD",6532,"KRN",19,0)
19
"BLD",6532,"KRN",19.1,0)
19.1
"BLD",6532,"KRN",101,0)
101
"BLD",6532,"KRN",409.61,0)
409.61
"BLD",6532,"KRN",771,0)
771
"BLD",6532,"KRN",870,0)
870
"BLD",6532,"KRN",8989.51,0)
8989.51
"BLD",6532,"KRN",8989.52,0)
8989.52
"BLD",6532,"KRN",8994,0)
8994
"BLD",6532,"KRN","B",.4,.4)

"BLD",6532,"KRN","B",.401,.401)

"BLD",6532,"KRN","B",.402,.402)

"BLD",6532,"KRN","B",.403,.403)

"BLD",6532,"KRN","B",.5,.5)

"BLD",6532,"KRN","B",.84,.84)

"BLD",6532,"KRN","B",3.6,3.6)

"BLD",6532,"KRN","B",3.8,3.8)

"BLD",6532,"KRN","B",9.2,9.2)

"BLD",6532,"KRN","B",9.8,9.8)

"BLD",6532,"KRN","B",19,19)

"BLD",6532,"KRN","B",19.1,19.1)

"BLD",6532,"KRN","B",101,101)

"BLD",6532,"KRN","B",409.61,409.61)

"BLD",6532,"KRN","B",771,771)

"BLD",6532,"KRN","B",870,870)

"BLD",6532,"KRN","B",8989.51,8989.51)

"BLD",6532,"KRN","B",8989.52,8989.52)

"BLD",6532,"KRN","B",8994,8994)

"BLD",6532,"QUES",0)
^9.62^^
"BLD",6532,"REQB",0)
^9.611^1^1
"BLD",6532,"REQB",1,0)
ICD*18.0*11^2
"BLD",6532,"REQB","B","ICD*18.0*11",1)

"MBREQ")
0
"PKG",283,-1)
1^1
"PKG",283,0)
DRG GROUPER^ICD^DRG GROUPER^^^3010710
"PKG",283,20,0)
^9.402P^^
"PKG",283,22,0)
^9.49I^1^1
"PKG",283,22,1,0)
18.0^3001020^3001020^1118
"PKG",283,22,1,"PAH",1,0)
28^3070424
"PKG",283,22,1,"PAH",1,1,0)
^^2^2^3070424
"PKG",283,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements
"PKG",283,22,1,"PAH",1,1,2,0)
included in this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","ICDUPDT")
0^1^B146682
"RTN","ICDUPDT",1,0)
ICDUPDT ; DLS/DEK/KER - ICD Update Protocol for ICD Codes ; 02/22/2007
"RTN","ICDUPDT",2,0)
 ;;18.0;DRG Grouper;**6,11,28**;Oct 20, 2000;Build 3
"RTN","ICDUPDT",3,0)
 ;
"RTN","ICDUPDT",4,0)
 ; Quit Update if NOT ICD Diagnosis/Procedure Related 
"RTN","ICDUPDT",5,0)
 ;
"RTN","ICDUPDT",6,0)
 ;   XQORQUIT  Signals the Unwinder to not process 
"RTN","ICDUPDT",7,0)
 ;             any protocols that are subordinate to 
"RTN","ICDUPDT",8,0)
 ;             the current protocol.  Control is passed
"RTN","ICDUPDT",9,0)
 ;             to the next sibling protocol.
"RTN","ICDUPDT",10,0)
 ;
"RTN","ICDUPDT",11,0)
 S:'$D(LEXSCHG("B",80))&('$D(LEXSCHG("B",80.1))) XQORQUIT=1
"RTN","ICDUPDT",12,0)
 Q
"VER")
8.0^22.0
**INSTALL NAME**
ICPT*6.0*34
"BLD",6533,0)
ICPT*6.0*34^CPT/HCPCS CODES^0^3070424^y
"BLD",6533,1,0)
^^2^2^3070207^
"BLD",6533,1,1,0)
Please see the National Patch Module for details of the enhancements
"BLD",6533,1,2,0)
included in this patch.
"BLD",6533,4,0)
^9.64PA^^
"BLD",6533,6.3)
3
"BLD",6533,"KRN",0)
^9.67PA^8989.52^19
"BLD",6533,"KRN",.4,0)
.4
"BLD",6533,"KRN",.401,0)
.401
"BLD",6533,"KRN",.402,0)
.402
"BLD",6533,"KRN",.403,0)
.403
"BLD",6533,"KRN",.5,0)
.5
"BLD",6533,"KRN",.84,0)
.84
"BLD",6533,"KRN",3.6,0)
3.6
"BLD",6533,"KRN",3.8,0)
3.8
"BLD",6533,"KRN",9.2,0)
9.2
"BLD",6533,"KRN",9.8,0)
9.8
"BLD",6533,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6533,"KRN",9.8,"NM",1,0)
ICPTAU^^0^B146280
"BLD",6533,"KRN",9.8,"NM","B","ICPTAU",1)

"BLD",6533,"KRN",19,0)
19
"BLD",6533,"KRN",19.1,0)
19.1
"BLD",6533,"KRN",101,0)
101
"BLD",6533,"KRN",409.61,0)
409.61
"BLD",6533,"KRN",771,0)
771
"BLD",6533,"KRN",870,0)
870
"BLD",6533,"KRN",8989.51,0)
8989.51
"BLD",6533,"KRN",8989.52,0)
8989.52
"BLD",6533,"KRN",8994,0)
8994
"BLD",6533,"KRN","B",.4,.4)

"BLD",6533,"KRN","B",.401,.401)

"BLD",6533,"KRN","B",.402,.402)

"BLD",6533,"KRN","B",.403,.403)

"BLD",6533,"KRN","B",.5,.5)

"BLD",6533,"KRN","B",.84,.84)

"BLD",6533,"KRN","B",3.6,3.6)

"BLD",6533,"KRN","B",3.8,3.8)

"BLD",6533,"KRN","B",9.2,9.2)

"BLD",6533,"KRN","B",9.8,9.8)

"BLD",6533,"KRN","B",19,19)

"BLD",6533,"KRN","B",19.1,19.1)

"BLD",6533,"KRN","B",101,101)

"BLD",6533,"KRN","B",409.61,409.61)

"BLD",6533,"KRN","B",771,771)

"BLD",6533,"KRN","B",870,870)

"BLD",6533,"KRN","B",8989.51,8989.51)

"BLD",6533,"KRN","B",8989.52,8989.52)

"BLD",6533,"KRN","B",8994,8994)

"BLD",6533,"QUES",0)
^9.62^^
"BLD",6533,"REQB",0)
^9.611^1^1
"BLD",6533,"REQB",1,0)
ICPT*6.0*16^2
"BLD",6533,"REQB","B","ICPT*6.0*16",1)

"MBREQ")
0
"PKG",302,-1)
1^1
"PKG",302,0)
CPT/HCPCS CODES^ICPT^ICPT/HCPCS CODES
"PKG",302,20,0)
^9.402P^^
"PKG",302,22,0)
^9.49I^1^1
"PKG",302,22,1,0)
6.0^2970519^2970519^1118
"PKG",302,22,1,"PAH",1,0)
34^3070424
"PKG",302,22,1,"PAH",1,1,0)
^^2^2^3070424
"PKG",302,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements
"PKG",302,22,1,"PAH",1,1,2,0)
included in this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","ICPTAU")
0^1^B146280
"RTN","ICPTAU",1,0)
ICPTAU ; DLS/DEK/KER - CPT Annual Update Protocol for CPT Codes ; 02/22/2007
"RTN","ICPTAU",2,0)
 ;;6.0;CPT/HCPCS;**14,16,34**;May 19, 1997;Build 3
"RTN","ICPTAU",3,0)
 ;
"RTN","ICPTAU",4,0)
 ; Quit Update if NOT CPT Procedure Related 
"RTN","ICPTAU",5,0)
 ;
"RTN","ICPTAU",6,0)
 ;   XQORQUIT  Signals the Unwinder to not process 
"RTN","ICPTAU",7,0)
 ;             any protocols that are subordinate to 
"RTN","ICPTAU",8,0)
 ;             the current protocol.  Control is passed
"RTN","ICPTAU",9,0)
 ;             to the next sibling protocol.
"RTN","ICPTAU",10,0)
 ;
"RTN","ICPTAU",11,0)
 S:'$D(LEXSCHG("B",81))&('$D(LEXSCHG("B",81.3))) XQORQUIT=1
"RTN","ICPTAU",12,0)
 Q
"VER")
8.0^22.0
**INSTALL NAME**
LEX*2.0*49
"BLD",6527,0)
LEX*2.0*49^LEXICON UTILITY^0^3070424^y
"BLD",6527,1,0)
^^2^2^3070214^
"BLD",6527,1,1,0)
Please see the National Patch Module for details of the enhancements
"BLD",6527,1,2,0)
included in this patch.
"BLD",6527,4,0)
^9.64PA^^
"BLD",6527,6.3)
3
"BLD",6527,"INIT")
POST^LEX2049P
"BLD",6527,"KRN",0)
^9.67PA^8989.52^19
"BLD",6527,"KRN",.4,0)
.4
"BLD",6527,"KRN",.401,0)
.401
"BLD",6527,"KRN",.402,0)
.402
"BLD",6527,"KRN",.403,0)
.403
"BLD",6527,"KRN",.5,0)
.5
"BLD",6527,"KRN",.84,0)
.84
"BLD",6527,"KRN",3.6,0)
3.6
"BLD",6527,"KRN",3.8,0)
3.8
"BLD",6527,"KRN",9.2,0)
9.2
"BLD",6527,"KRN",9.8,0)
9.8
"BLD",6527,"KRN",9.8,"NM",0)
^9.68A^11^11
"BLD",6527,"KRN",9.8,"NM",1,0)
LEXXGI^^0^B60750552
"BLD",6527,"KRN",9.8,"NM",2,0)
LEXCHGF^^1^
"BLD",6527,"KRN",9.8,"NM",3,0)
LEXCHGF2^^1^
"BLD",6527,"KRN",9.8,"NM",4,0)
LEXXGI2^^0^B40689022
"BLD",6527,"KRN",9.8,"NM",5,0)
LEXXST^^0^B68105086
"BLD",6527,"KRN",9.8,"NM",6,0)
LEXXST5^^1^
"BLD",6527,"KRN",9.8,"NM",7,0)
LEXXFI7^^0^B41558940
"BLD",6527,"KRN",9.8,"NM",8,0)
LEXXFI^^0^B48947190
"BLD",6527,"KRN",9.8,"NM",9,0)
LEXNDX7^^1^
"BLD",6527,"KRN",9.8,"NM",10,0)
LEX2049P^^0^B60130631
"BLD",6527,"KRN",9.8,"NM",11,0)
LEXXII^^0^B33731148
"BLD",6527,"KRN",9.8,"NM","B","LEX2049P",10)

"BLD",6527,"KRN",9.8,"NM","B","LEXCHGF",2)

"BLD",6527,"KRN",9.8,"NM","B","LEXCHGF2",3)

"BLD",6527,"KRN",9.8,"NM","B","LEXNDX7",9)

"BLD",6527,"KRN",9.8,"NM","B","LEXXFI",8)

"BLD",6527,"KRN",9.8,"NM","B","LEXXFI7",7)

"BLD",6527,"KRN",9.8,"NM","B","LEXXGI",1)

"BLD",6527,"KRN",9.8,"NM","B","LEXXGI2",4)

"BLD",6527,"KRN",9.8,"NM","B","LEXXII",11)

"BLD",6527,"KRN",9.8,"NM","B","LEXXST",5)

"BLD",6527,"KRN",9.8,"NM","B","LEXXST5",6)

"BLD",6527,"KRN",19,0)
19
"BLD",6527,"KRN",19.1,0)
19.1
"BLD",6527,"KRN",101,0)
101
"BLD",6527,"KRN",409.61,0)
409.61
"BLD",6527,"KRN",771,0)
771
"BLD",6527,"KRN",870,0)
870
"BLD",6527,"KRN",8989.51,0)
8989.51
"BLD",6527,"KRN",8989.52,0)
8989.52
"BLD",6527,"KRN",8994,0)
8994
"BLD",6527,"KRN","B",.4,.4)

"BLD",6527,"KRN","B",.401,.401)

"BLD",6527,"KRN","B",.402,.402)

"BLD",6527,"KRN","B",.403,.403)

"BLD",6527,"KRN","B",.5,.5)

"BLD",6527,"KRN","B",.84,.84)

"BLD",6527,"KRN","B",3.6,3.6)

"BLD",6527,"KRN","B",3.8,3.8)

"BLD",6527,"KRN","B",9.2,9.2)

"BLD",6527,"KRN","B",9.8,9.8)

"BLD",6527,"KRN","B",19,19)

"BLD",6527,"KRN","B",19.1,19.1)

"BLD",6527,"KRN","B",101,101)

"BLD",6527,"KRN","B",409.61,409.61)

"BLD",6527,"KRN","B",771,771)

"BLD",6527,"KRN","B",870,870)

"BLD",6527,"KRN","B",8989.51,8989.51)

"BLD",6527,"KRN","B",8989.52,8989.52)

"BLD",6527,"KRN","B",8994,8994)

"BLD",6527,"PRE")

"BLD",6527,"QUES",0)
^9.62^^
"BLD",6527,"REQB",0)
^9.611^4^4
"BLD",6527,"REQB",1,0)
LEX*2.0*25^2
"BLD",6527,"REQB",2,0)
LEX*2.0*27^2
"BLD",6527,"REQB",3,0)
LEX*2.0*32^2
"BLD",6527,"REQB",4,0)
LEX*2.0*46^2
"BLD",6527,"REQB","B","LEX*2.0*25",1)

"BLD",6527,"REQB","B","LEX*2.0*27",2)

"BLD",6527,"REQB","B","LEX*2.0*32",3)

"BLD",6527,"REQB","B","LEX*2.0*46",4)

"INIT")
POST^LEX2049P
"MBREQ")
0
"ORD",0,9.8)
9.8;;1;RTNF^XPDTA;RTNE^XPDTA
"ORD",0,9.8,0)
ROUTINE
"PKG",167,-1)
1^1
"PKG",167,0)
LEXICON UTILITY^LEX^Medical and Biomedical Terminology System.^^^3030115
"PKG",167,20,0)
^9.402P^^
"PKG",167,22,0)
^9.49I^1^1
"PKG",167,22,1,0)
2.0^2950923^2950923^1118
"PKG",167,22,1,"PAH",1,0)
49^3070424
"PKG",167,22,1,"PAH",1,1,0)
^^2^2^3070424
"PKG",167,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements
"PKG",167,22,1,"PAH",1,1,2,0)
included in this patch.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
11
"RTN","LEX2049P")
0^10^B60130631
"RTN","LEX2049P",1,0)
LEX2049P ; ISL/OI - Post Install LEX*2.0*49  ; 02/22/2007
"RTN","LEX2049P",2,0)
 ;;2.0;LEXICON UTILITY;**49**;Sep 23, 1996;Build 3
"RTN","LEX2049P",3,0)
 ;                    
"RTN","LEX2049P",4,0)
 ; Global Variables
"RTN","LEX2049P",5,0)
 ;    ^%ZOSF("DEL" 
"RTN","LEX2049P",6,0)
 ;    ^%ZOSF("TEST"
"RTN","LEX2049P",7,0)
 ;    ^LEXC
"RTN","LEX2049P",8,0)
 ;    ^LEXM(0
"RTN","LEX2049P",9,0)
 ;    ^LEXT(757.2
"RTN","LEX2049P",10,0)
 ;    ^ORD(101
"RTN","LEX2049P",11,0)
 ;    ^TMP("LEXCNT"
"RTN","LEX2049P",12,0)
 ;    ^TMP("LEXCS"
"RTN","LEX2049P",13,0)
 ;    ^TMP("LEXI"
"RTN","LEX2049P",14,0)
 ;    ^TMP("LEXINS"
"RTN","LEX2049P",15,0)
 ;    ^TMP("LEXKID"
"RTN","LEX2049P",16,0)
 ;    ^TMP("LEXMSG"
"RTN","LEX2049P",17,0)
 ;                
"RTN","LEX2049P",18,0)
 ; External References
"RTN","LEX2049P",19,0)
 ;    HOME^%ZIS
"RTN","LEX2049P",20,0)
 ;    $$GET1^DID
"RTN","LEX2049P",21,0)
 ;    ^DIK
"RTN","LEX2049P",22,0)
 ;    ^DIM
"RTN","LEX2049P",23,0)
 ;    $$GET1^DIQ
"RTN","LEX2049P",24,0)
 ;    EN^DIU2
"RTN","LEX2049P",25,0)
 ;    $$DT^XLFDT
"RTN","LEX2049P",26,0)
 ;    $$FMTE^XLFDT
"RTN","LEX2049P",27,0)
 ;    $$NOW^XLFDT
"RTN","LEX2049P",28,0)
 ;    BMES^XPDUTL
"RTN","LEX2049P",29,0)
 ;    MES^XPDUTL
"RTN","LEX2049P",30,0)
 ;    EN^XQOR
"RTN","LEX2049P",31,0)
 ;    $$DTIME^XUP
"RTN","LEX2049P",32,0)
 ;                        
"RTN","LEX2049P",33,0)
POST ; Post-Install Main Entry Point
"RTN","LEX2049P",34,0)
 N CNT,DA,DIK,DIU,ERR,EXEC,FI,FIX,FNAME,I,INST,LEX,LEXBEG,LEXBUILD,LEXCHG,LEXEDT,LEXELP,LEXEND
"RTN","LEX2049P",35,0)
 N LEXFC,LEXI,LEXID,LEXMOD,LEXMUL,LEXNM,LEXO,LEXP,LEXPOST,LEXSCHG,LEXSHORT,LEXSUB,LEXTCS,LEXTND
"RTN","LEX2049P",36,0)
 N NAME,OK,PN,PNO,ROK,RTN,SSIEN,STR,T,TAG,TXT,TY,X,Y,ZTQUEUED,ZTREQ S LEXPOST="",LEXSHORT="",(LEXID,LEXSUB)="LEXKID" D MSG1
"RTN","LEX2049P",37,0)
 S LEXCHG=1,LEXEDT=$$NOW^XLFDT,LEXSCHG("0")="1"
"RTN","LEX2049P",38,0)
 S LEXSCHG("81",0)="",LEXSCHG("81.1",0)="",LEXSCHG("81.2",0)="",LEXSCHG("81.3",0)=""
"RTN","LEX2049P",39,0)
 S LEXSCHG("B","81")="",LEXSCHG("B","81.1")="",LEXSCHG("B","81.2")="",LEXSCHG("B","81.3")=""
"RTN","LEX2049P",40,0)
 S LEXSCHG("C","CPT","81")="",LEXSCHG("C","CPT","81.1")="",LEXSCHG("C","CPT","81.2")="",LEXSCHG("C","CPT","81.3")=""
"RTN","LEX2049P",41,0)
 S LEXSCHG("80",0)="",LEXSCHG("80.1",0)=""
"RTN","LEX2049P",42,0)
 S LEXSCHG("B","80")="",LEXSCHG("B","80.1")=""
"RTN","LEX2049P",43,0)
 S LEXSCHG("C","ICD","80")="",LEXSCHG("C","ICD","80.1")=""
"RTN","LEX2049P",44,0)
 S LEXSCHG("757",0)="",LEXSCHG("757.001",0)="",LEXSCHG("757.01",0)="",LEXSCHG("757.02",0)="",LEXSCHG("757.1",0)=""
"RTN","LEX2049P",45,0)
 S LEXSCHG("B","757")="",LEXSCHG("B","757.001")="",LEXSCHG("B","757.01")="",LEXSCHG("B","757.02")="",LEXSCHG("B","757.1")=""
"RTN","LEX2049P",46,0)
 S LEXSCHG("C","LEX","757")="",LEXSCHG("C","LEX","757.001")="",LEXSCHG("C","LEX","757.01")="",LEXSCHG("C","LEX","757.02")="",LEXSCHG("C","LEX","757.1")=""
"RTN","LEX2049P",47,0)
 S LEXSCHG("D","PRO")="",LEXSHORT=""
"RTN","LEX2049P",48,0)
 D DDUZ,CHGF,RTN,INST,NOTIFY,MSG2,KALL^LEXXGI2
"RTN","LEX2049P",49,0)
 Q
"RTN","LEX2049P",50,0)
INST ; Installed Patches
"RTN","LEX2049P",51,0)
 N INST,STR D BL
"RTN","LEX2049P",52,0)
 S INST=$$PROK("PXRMCSD",9) S STR=" PXRM*2.0*9      "_$S(INST>0:"Installed",1:"Not Installed") D BM(STR),TL(STR)
"RTN","LEX2049P",53,0)
 S INST=$$PROK("ICDUPDT",28) S STR=" ICD*18.0*28     "_$S(INST>0:"Installed",1:"Not Installed") D M(STR),TL(STR)
"RTN","LEX2049P",54,0)
 S INST=$$PROK("ICPTAU",34) S STR=" ICPT*6.0*34     "_$S(INST>0:"Installed",1:"Not Installed") D M(STR),TL(STR)
"RTN","LEX2049P",55,0)
 S INST=$$PROK("LEXXGI",49) S STR=" LEX*2.0*49      "_$S(INST>0:"Installed",1:"Not Installed") D M(STR),TL(STR)
"RTN","LEX2049P",56,0)
 Q
"RTN","LEX2049P",57,0)
NOTIFY ; Notify by Protocol - LEXICAL SERVICES UPDATE
"RTN","LEX2049P",58,0)
 N LEXP,X,STR
"RTN","LEX2049P",59,0)
 S STR="ERROR:  Array of files not found" D:'$D(LEXSCHG) BM(STR),BL,TL(STR) Q:'$D(LEXSCHG)
"RTN","LEX2049P",60,0)
 S LEXP=+($O(^ORD(101,"B","LEXICAL SERVICES UPDATE",0)))
"RTN","LEX2049P",61,0)
 S STR="ERROR:  LEXICAL SERVICES UPDATE protocol not found" D:$G(LEXP)'>0 BM(STR),BL,TL(STR) Q:LEXP=0
"RTN","LEX2049P",62,0)
 S X=LEXP_";ORD(101," D EN^XQOR
"RTN","LEX2049P",63,0)
 S STR="ERROR:  LEXICAL SERVICES UPDATE protocol not invoked" D:$D(LEXSCHG) BM(STR),BL,TL(STR) Q:$D(LEXSCHG)
"RTN","LEX2049P",64,0)
 S ^LEXM(0,"PRO")=$$NOW^XLFDT,X="Protocol 'LEXICAL SERVICES UPDATE' was invoked"
"RTN","LEX2049P",65,0)
 W:'$D(XPDNM) !!,X D:$D(XPDNM) BM(X)
"RTN","LEX2049P",66,0)
 S (STR,X)="Subscribing applications were notified",STR="  "_STR D BL,TL(STR)
"RTN","LEX2049P",67,0)
 W:'$D(XPDNM) !,X D:$D(XPDNM) M(X)
"RTN","LEX2049P",68,0)
 Q
"RTN","LEX2049P",69,0)
CHGF ; Change File
"RTN","LEX2049P",70,0)
 D M(" "),RI("Removing Change Files (757.9-757.91)","Remedy 175985") N FI,FNAME,ERR,ROK,STR
"RTN","LEX2049P",71,0)
 S FI=757.91,FNAME=$$GET1^DID(FI,"","","NAME","","ERR") I $L(FNAME) D
"RTN","LEX2049P",72,0)
 . N DIU,ERR S DIU="^LEXC("_FI_",",DIU(0)="D" D EN^DIU2 K:'$L($$GET1^DID(FI,"","","NAME","","ERR")) ^LEXC(FI)
"RTN","LEX2049P",73,0)
 S FI=757.903,FNAME=$$GET1^DID(FI,"","","NAME","","ERR") I $L(FNAME) D
"RTN","LEX2049P",74,0)
 . N DIU,ERR S DIU="^LEXC("_FI_",",DIU(0)="D" D EN^DIU2 K:'$L($$GET1^DID(FI,"","","NAME","","ERR")) ^LEXC(FI)
"RTN","LEX2049P",75,0)
 S FI=757.9,FNAME=$$GET1^DID(FI,"","","NAME","","ERR") I $L(FNAME) D
"RTN","LEX2049P",76,0)
 . N DIU,ERR S DIU="^LEXC("_FI_",",DIU(0)="D" D EN^DIU2 K:'$L($$GET1^DID(FI,"","","NAME","","ERR")) ^LEXC(FI)
"RTN","LEX2049P",77,0)
 S FI=757.901,FNAME=$$GET1^DID(FI,"","","NAME","","ERR") I $L(FNAME) D
"RTN","LEX2049P",78,0)
 . N DIU,ERR S DIU="^LEXC("_FI_",",DIU(0)="D" D EN^DIU2 K:'$L($$GET1^DID(FI,"","","NAME","","ERR")) ^LEXC(FI)
"RTN","LEX2049P",79,0)
 S FI=757.902,FNAME=$$GET1^DID(FI,"","","NAME","","ERR") I $L(FNAME) D
"RTN","LEX2049P",80,0)
 . N DIU,ERR S DIU="^LEXC("_FI_",",DIU(0)="D" D EN^DIU2 K:'$L($$GET1^DID(FI,"","","NAME","","ERR")) ^LEXC(FI)
"RTN","LEX2049P",81,0)
 I '$D(^LEXC) S STR="Removed Change Files (757.9-757.91) (Remedy 175985)" D BL,TL(STR)     Q
"RTN","LEX2049P",82,0)
 Q
"RTN","LEX2049P",83,0)
RTN ; Routines
"RTN","LEX2049P",84,0)
 D M(" "),BL D DRTN,MRTN
"RTN","LEX2049P",85,0)
 Q
"RTN","LEX2049P",86,0)
DRTN ; Delete Routines
"RTN","LEX2049P",87,0)
 N EXEC,ROK,RTN,STR,X
"RTN","LEX2049P",88,0)
 S X=$G(^%ZOSF("DEL")) Q:'$L(X)  D ^DIM Q:'$D(X)  Q:'$L(X)  S EXEC=X
"RTN","LEX2049P",89,0)
 F RTN="LEXCHGF","LEXCHGF2","LEXNDX7","LEXXST5" D
"RTN","LEX2049P",90,0)
 . S ROK=+($$ROK(RTN)) I +ROK'>0 S STR="    "_RTN,STR=STR_$J(" ",(17-$L(STR)))_"Deleted" D M(STR),TL(STR) Q
"RTN","LEX2049P",91,0)
 . S X=RTN X EXEC
"RTN","LEX2049P",92,0)
 . S ROK=+($$ROK(RTN)) I +ROK'>0 S STR="    "_RTN,STR=STR_$J(" ",(17-$L(STR)))_"Deleted" D M(STR),TL(STR) Q
"RTN","LEX2049P",93,0)
 . S STR="    "_RTN D M(STR),TL(STR)
"RTN","LEX2049P",94,0)
 Q
"RTN","LEX2049P",95,0)
MRTN ; Modified Routines
"RTN","LEX2049P",96,0)
 N CNT,EXEC,FIX,I,RTN,PN,PNO,STR,TXT,TY S CNT=0 F I=1:1 D  Q:'$L(TXT)
"RTN","LEX2049P",97,0)
 . S TXT="" S EXEC="S TXT=$T(MRN+"_I_"^LEX2049P)" X EXEC
"RTN","LEX2049P",98,0)
 . S TXT=$P(TXT,";;",2,299) Q:TXT=""
"RTN","LEX2049P",99,0)
 . S RTN=$P(TXT,";",1) S:'$L(RTN) TXT="" Q:'$L(TXT)  Q:+($$ROK(RTN))=0
"RTN","LEX2049P",100,0)
 . S PN=$P(TXT,";",2),TY=$P(TXT,";",3),FIX=$P(TXT,";",4)
"RTN","LEX2049P",101,0)
 . S PNO=$$PROK(RTN,PN)
"RTN","LEX2049P",102,0)
 . S STR="    "_RTN S:+PNO>0 STR=STR_$J(" ",(17-$L(STR)))_TY S:+PNO>0 STR=STR_$J(" ",(29-$L(STR)))_FIX
"RTN","LEX2049P",103,0)
 . D M(STR),TL(STR)
"RTN","LEX2049P",104,0)
 Q
"RTN","LEX2049P",105,0)
MRN ; Modified Routine Names
"RTN","LEX2049P",106,0)
 ;;LEXXFI;49;Modified;Removed references to file #757.9
"RTN","LEX2049P",107,0)
 ;;LEXXFI7;49;Modified;Removed references to file #757.9
"RTN","LEX2049P",108,0)
 ;;LEXXST;49;Modified;Removed references to file #757.9
"RTN","LEX2049P",109,0)
 ;;LEXXGI;49;Modified;Fix LEXICAL SERVICES UPDATE Protocol
"RTN","LEX2049P",110,0)
 ;;LEXXGI2;49;Modified;Fix LEXICAL SERVICES UPDATE Protocol
"RTN","LEX2049P",111,0)
 ;;LEXXII;49;Modified;Fix Install Message (Protocol)
"RTN","LEX2049P",112,0)
 ;;ICDUPDT;28;Modified;Fix ICD CODE UPDATE EVENT Protocol
"RTN","LEX2049P",113,0)
 ;;ICPTAU;34;Modified;Fix ICPT CODE UPDATE EVENT Protocol
"RTN","LEX2049P",114,0)
 ;;PXRMCSD;9;Modified;Fix ICD/CPT Reminder Dialogs Message
"RTN","LEX2049P",115,0)
 ;;PXRMCSTX;9;Modified;Fix ICD/CPT Reminder Taxonomies Message
"RTN","LEX2049P",116,0)
 ;;
"RTN","LEX2049P",117,0)
DDUZ ; Delete Exported DUZ if broken Pointer
"RTN","LEX2049P",118,0)
 N STR S STR="Removing broken Pointer in file #757.2"
"RTN","LEX2049P",119,0)
 D M(" "),RI(STR,"ROF LEX*2.0*46") S STR=STR_" (ROF LEX*2.0*46)" Q:$L($$GET1^DIQ(200,("1118,"),.01))
"RTN","LEX2049P",120,0)
 D BL,TL(STR) N DA,DIK,NAME,SSIEN S SSIEN=0 F  S SSIEN=$O(^LEXT(757.2,SSIEN)) Q:+SSIEN'>0  D
"RTN","LEX2049P",121,0)
 . Q:'$D(^LEXT(757.2,SSIEN,200))  Q:$O(^LEXT(757.2,SSIEN,200,0))'>0  Q:'$D(^LEXT(757.2,SSIEN,200,1118))
"RTN","LEX2049P",122,0)
 . N DA,DIK,NAME S NAME=$P($G(^LEXT(757.2,SSIEN,0)),"^",1) D:$L(NAME) CI(("  "_NAME))
"RTN","LEX2049P",123,0)
 . S DA(1)=SSIEN,DA=1118,DIK="^LEXT(757.2,"_SSIEN_",200," D ^DIK
"RTN","LEX2049P",124,0)
 Q
"RTN","LEX2049P",125,0)
ROK(X) ; Routine OK
"RTN","LEX2049P",126,0)
 S X=$G(X) Q:'$L(X) 0  Q:$L(X)>8 0  X ^%ZOSF("TEST") Q:$T 1  Q 0
"RTN","LEX2049P",127,0)
PROK(X,Y) ; Routine and Patch # OK (in UCI)
"RTN","LEX2049P",128,0)
 N LEX,LEXI,LEXO S X=$G(X),Y=$G(Y) Q:'$L(X) 0 Q:Y'=""&(+Y=0)
"RTN","LEX2049P",129,0)
 S Y=+Y,LEX=$$ROK(X) Q:'LEX 0 Q:+Y=0 1 S LEXO=0,LEX=$T(@("+2^"_X)),LEX=$P($P(LEX,"**",2),"**",1)
"RTN","LEX2049P",130,0)
 F LEXI=1:1:$L(LEX,",") S:+($P(LEX,",",LEXI))=Y LEXO=1 Q:LEXO=1
"RTN","LEX2049P",131,0)
 S X=LEXO
"RTN","LEX2049P",132,0)
 Q X
"RTN","LEX2049P",133,0)
LL(T,X) ; Line Label
"RTN","LEX2049P",134,0)
 N RTN,TAG,ROK,EXEC,OK S TAG=$G(T),RTN=$G(X) Q:'$L(RTN) 0  S ROK=$$ROK(RTN) Q:+ROK'>0 0  S:'$L(TAG)&($L(RTN)) TAG=RTN
"RTN","LEX2049P",135,0)
 S OK=0,EXEC="S OK=$L($T("_TAG_"^"_RTN_")) S OK=$S(OK>0:1,1:0)" X EXEC S X=+($G(OK))
"RTN","LEX2049P",136,0)
 Q X
"RTN","LEX2049P",137,0)
MSG1 ; Send Installation Message to G.LEXICON
"RTN","LEX2049P",138,0)
 K ^TMP("LEXCS",$J),^TMP("LEXCNT",$J),^TMP("LEXI",$J),^TMP("LEXMSG",$J)
"RTN","LEX2049P",139,0)
 K ^TMP("LEXINS",$J),^TMP("LEXKID",$J) S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEX2049P",140,0)
 N LEXBEG,LEXELP,LEXEND,LEXFC,LEXMOD,LEXMUL,LEXTCS,LEXTND,LEXID,ZTQUEUED
"RTN","LEX2049P",141,0)
 S LEXID="LEXKID",LEXMUL=1,(LEXTND,LEXTCS,LEXMOD,LEXFC,ZTQUEUED)=0
"RTN","LEX2049P",142,0)
 D HDR^LEXXFI,EN^LEXXII K ^LEXM(0,"PRO")
"RTN","LEX2049P",143,0)
 Q
"RTN","LEX2049P",144,0)
MSG2 ; Send Installation (part 2)
"RTN","LEX2049P",145,0)
 N LEXSHORT,ZTQUEUED,LEXBUILD S ZTQUEUED=0,LEXSHORT=1,LEXBUILD="LEX*2.0*49"
"RTN","LEX2049P",146,0)
 D MAIL^LEXXFI,KILL^LEXXFI
"RTN","LEX2049P",147,0)
 Q
"RTN","LEX2049P",148,0)
ENV(X) ; Environment check
"RTN","LEX2049P",149,0)
 N LEXNM D HOME^%ZIS S U="^",DT=$$DT^XLFDT,LEXNM=$$GET1^DIQ(200,+($G(DUZ)),.01),DTIME=$$DTIME^XUP(+($G(DUZ))) Q:+($G(DUZ))'>0!('$L(LEXNM)) 0
"RTN","LEX2049P",150,0)
 Q 1
"RTN","LEX2049P",151,0)
ED(LEX) ; External Date MM/DD/YYYY TT:TT
"RTN","LEX2049P",152,0)
 N XPDNM S LEX=$$FMTE^XLFDT($G(LEX),"1Z") S:LEX["@" LEX=$P(LEX,"@",1)_"  "_$P(LEX,"@",2,299)
"RTN","LEX2049P",153,0)
 Q LEX
"RTN","LEX2049P",154,0)
RI(X,Y) ; Reference - Indented
"RTN","LEX2049P",155,0)
 N I S X=$G(X),Y=$G(Y) Q:'$L(X)
"RTN","LEX2049P",156,0)
 I $L(Y) S X="    "_X F  Q:$L(X)>54  S X=X_" "
"RTN","LEX2049P",157,0)
 S X=X_" "_Y S:$E(X,1)'=" " X="    "_X D MES^XPDUTL(X) Q
"RTN","LEX2049P",158,0)
CI(X) ; Comment Text - Indented
"RTN","LEX2049P",159,0)
 N I S X=$G(X) Q:'$L(X)  S X="    "_X D MES^XPDUTL(X)
"RTN","LEX2049P",160,0)
 Q
"RTN","LEX2049P",161,0)
BL ;   Blank Line
"RTN","LEX2049P",162,0)
 D TL("") Q
"RTN","LEX2049P",163,0)
TL(LEXX) ;   Text Line
"RTN","LEX2049P",164,0)
 S LEXSUB=$G(LEXSUB) S:'$L(LEXSUB) LEXSUB="LEXXII"
"RTN","LEX2049P",165,0)
 I '$D(^TMP(LEXSUB,$J,1)) S ^TMP(LEXSUB,$J,1)=" ",^TMP(LEXSUB,$J,0)=1
"RTN","LEX2049P",166,0)
 N LEXNX S LEXNX=$O(^TMP(LEXSUB,$J," "),-1),LEXNX=LEXNX+1
"RTN","LEX2049P",167,0)
 S ^TMP(LEXSUB,$J,LEXNX)=" "_$G(LEXX),^TMP(LEXSUB,$J,0)=LEXNX
"RTN","LEX2049P",168,0)
 Q
"RTN","LEX2049P",169,0)
BM(X) ; Blank and Line
"RTN","LEX2049P",170,0)
 D BMES^XPDUTL($G(X))
"RTN","LEX2049P",171,0)
 Q
"RTN","LEX2049P",172,0)
M(X) ; Line
"RTN","LEX2049P",173,0)
 D MES^XPDUTL($G(X))
"RTN","LEX2049P",174,0)
 Q
"RTN","LEXCHGF")
1^2
"RTN","LEXCHGF2")
1^3
"RTN","LEXNDX7")
1^9
"RTN","LEXXFI")
0^8^B48947190
"RTN","LEXXFI",1,0)
LEXXFI ; ISL/KER - File Info                     ; 02/22/2007
"RTN","LEXXFI",2,0)
 ;;2.0;LEXICON UTILITY;**32,46,49**;Sep 23, 1996;Build 3
"RTN","LEXXFI",3,0)
 Q
"RTN","LEXXFI",4,0)
 ;                   
"RTN","LEXXFI",5,0)
 ; Global Variables
"RTN","LEXXFI",6,0)
 ;   ^LEXM(0
"RTN","LEXXFI",7,0)
 ;   ^TMP("LEX*",$J    SACC 2.3.2.5.1  
"RTN","LEXXFI",8,0)
 ;             
"RTN","LEXXFI",9,0)
 ; External References
"RTN","LEXXFI",10,0)
 ;   DBIA 10086  HOME^%ZIS           
"RTN","LEXXFI",11,0)
 ;   DBIA 10089  ^%ZISC
"RTN","LEXXFI",12,0)
 ;   DBIA 10063  ^%ZTLOAD
"RTN","LEXXFI",13,0)
 ;   DBIA  2056  $$GET1^DIQ (file #200)
"RTN","LEXXFI",14,0)
 ;   DBIA 10103  $$DT^XLFDT
"RTN","LEXXFI",15,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","LEXXFI",16,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","LEXXFI",17,0)
 ;   DBIA 10070  ^XMD
"RTN","LEXXFI",18,0)
 ;   DBIA  4409  $$DTIME^XUP
"RTN","LEXXFI",19,0)
 ;             
"RTN","LEXXFI",20,0)
 ; Newed by Post-Install LEX20nnP
"RTN","LEXXFI",21,0)
 ;   LEXBUILD  Build
"RTN","LEXXFI",22,0)
 ;   LEXCRE    Import Global Creation Date
"RTN","LEXXFI",23,0)
 ;   LEXIGHF   Import Global Host File
"RTN","LEXXFI",24,0)
 ;   LEXLREV   Revision
"RTN","LEXXFI",25,0)
 ;   LEXREQP   Required Patches
"RTN","LEXXFI",26,0)
 ;   LEXSHORT  Flag for Summary Install Message
"RTN","LEXXFI",27,0)
 ;                
"RTN","LEXXFI",28,0)
 ; XPDA        Newed by KIDS during Install
"RTN","LEXXFI",29,0)
 ; LEXCOUNT    Flag Checked $D() and not used
"RTN","LEXXFI",30,0)
 ;             
"RTN","LEXXFI",31,0)
 ; Checksums/Counts
"RTN","LEXXFI",32,0)
EN ;   For One or More File(s)
"RTN","LEXXFI",33,0)
 N LEXENV,LEXMET,LEXID S LEXENV=$$ENV Q:+LEXENV'>0  S LEXMET=$$MT^LEXXFI7
"RTN","LEXXFI",34,0)
 I '$L(LEXMET) W !!," Checksum Files (One or All) not Selected" Q
"RTN","LEXXFI",35,0)
 I $L($T(@(LEXMET_"^LEXXFI")))>0 W ! D @LEXMET
"RTN","LEXXFI",36,0)
 Q
"RTN","LEXXFI",37,0)
ONE ;   For ONE file
"RTN","LEXXFI",38,0)
 K ^TMP("LEXCS",$J),^TMP("LEXCNT",$J),^TMP("LEXI",$J),^TMP("LEXMSG",$J)
"RTN","LEXXFI",39,0)
 N LEXBEG,LEXELP,LEXEND,LEXFC,LEXFI,LEXLDR,LEXMOD,LEXMUL,LEXNM,LEXTCS
"RTN","LEXXFI",40,0)
 N LEXTND,LEXTT,LEXTXT
"RTN","LEXXFI",41,0)
 S LEXBEG=$$TIC^LEXXFI8,LEXMUL=0,LEXMOD=0
"RTN","LEXXFI",42,0)
 S LEXFI=$$FI^LEXXFI7 I +LEXFI'>0 W !!," Checksum File not Selected" Q
"RTN","LEXXFI",43,0)
 S LEXLDR=$$LDR^LEXXFI8(LEXFI),LEXMOD=LEXMOD+($$MOD^LEXXFI8(LEXFI))
"RTN","LEXXFI",44,0)
 S LEXNM=$$FN^LEXXFI8(LEXFI),LEXTT=" "
"RTN","LEXXFI",45,0)
 W ! D ONE^LEXXFI2(LEXFI),ONE^LEXXFI3(LEXFI),ONE^LEXXFI5(LEXFI)
"RTN","LEXXFI",46,0)
 S LEXEND=$$TIC^LEXXFI8,LEXELP=$$ELAP^LEXXFI8(LEXBEG,LEXEND)
"RTN","LEXXFI",47,0)
 S:LEXELP="" LEXELP="00:00:00"
"RTN","LEXXFI",48,0)
 I +LEXBEG>0,LEXEND>0,$L(LEXELP) D TIM
"RTN","LEXXFI",49,0)
 K ^TMP("LEXCS",$J),^TMP("LEXCNT",$J),^TMP("LEXI",$J),^TMP("LEXMSG",$J)
"RTN","LEXXFI",50,0)
 Q
"RTN","LEXXFI",51,0)
ALL ;   For ALL files
"RTN","LEXXFI",52,0)
 K ^TMP("LEXCS",$J),^TMP("LEXCNT",$J),^TMP("LEXI",$J),^TMP("LEXMSG",$J)
"RTN","LEXXFI",53,0)
 K ^TMP("LEXINS",$J),^TMP("LEXKID",$J) S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEXXFI",54,0)
 N LEXBEG,LEXELP,LEXEND,LEXFC,LEXMOD,LEXMUL,LEXTCS,LEXTND,LEXID
"RTN","LEXXFI",55,0)
 S LEXID="LEXKID",LEXBEG=$$TIC^LEXXFI8,LEXMUL=1,(LEXTND,LEXTCS,LEXMOD,LEXFC)=0
"RTN","LEXXFI",56,0)
 D:'$D(LEXPOST) HDR
"RTN","LEXXFI",57,0)
 I '$D(LEXSHORT) D ALL^LEXXFI5,ALL^LEXXFI2,ALL^LEXXFI3
"RTN","LEXXFI",58,0)
 S LEXEND=$$TIC^LEXXFI8 S LEXELP=$$ELAP^LEXXFI8(LEXBEG,LEXEND)
"RTN","LEXXFI",59,0)
 S:LEXELP="" LEXELP="00:00:00"
"RTN","LEXXFI",60,0)
 I +LEXBEG>0,LEXEND>0,$L(LEXELP) D TIM
"RTN","LEXXFI",61,0)
 D:$D(LEXSEND)!($D(LEXPOST)) EN^LEXXII K ^LEXM(0,"PRO") D:$D(ZTQUEUED) MAIL
"RTN","LEXXFI",62,0)
 I '$D(ZTQUEUED) D
"RTN","LEXXFI",63,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^TMP("LEXKID",$J,LEXI)) Q:+LEXI=0  D
"RTN","LEXXFI",64,0)
 . . W !,$E($G(^TMP("LEXKID",$J,LEXI)),1,79)
"RTN","LEXXFI",65,0)
 D KILL
"RTN","LEXXFI",66,0)
 Q
"RTN","LEXXFI",67,0)
 ;              
"RTN","LEXXFI",68,0)
POST ; Entry Point for Post-Install Message
"RTN","LEXXFI",69,0)
 N LEXPOST S LEXPOST=""
"RTN","LEXXFI",70,0)
 ;            
"RTN","LEXXFI",71,0)
SEND ; Send Message
"RTN","LEXXFI",72,0)
 N LEXDESC,LEXENV,LEXP,LEXACCT,LEXPRO,LEXPRON,LEXSEND,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE,ZTSK,ZTQUEUED,ZTREQ
"RTN","LEXXFI",73,0)
 S LEXP=0,LEXENV=$$ENV Q:+LEXENV'>0  S LEXSEND="",LEXPRON="LEXICAL SERVICES UPDATE",LEXPRO=$G(^LEXM(0,"PRO"))
"RTN","LEXXFI",74,0)
 S:+LEXPRO>0 LEXPRO=$$FMTE^XLFDT(LEXPRO,"1"),LEXP=1 S LEXACCT=$$U^LEXXFI7 S ZTSAVE("LEXACCT")=""
"RTN","LEXXFI",75,0)
 S ZTRTN="ALL^LEXXFI",ZTSAVE("LEXSEND")="",ZTSAVE("LEXPOST")="" S:$D(LEXCOUNT) ZTSAVE("LEXCOUNT")=""
"RTN","LEXXFI",76,0)
 S:$L($G(LEXPRO))&($L($G(LEXPRON)))&(+($G(LEXP))>0) ZTSAVE("LEXPRO")="",ZTSAVE("LEXPRON")=""
"RTN","LEXXFI",77,0)
 S:$D(LEXLREV) ZTSAVE("LEXLREV")="" S:$D(LEXREQP) ZTSAVE("LEXREQP")="" S:$D(LEXBUILD) ZTSAVE("LEXBUILD")=""
"RTN","LEXXFI",78,0)
 S:$D(LEXSHORT) ZTSAVE("LEXSHORT")="" S:$D(LEXIGHF) ZTSAVE("LEXIGHF")="" S:$D(LEXCRE) ZTSAVE("LEXCRE")=""
"RTN","LEXXFI",79,0)
 S:$D(LEXID) ZTSAVE("LEXID")="" S:$D(XPDA) ZTSAVE("XPDA")=""
"RTN","LEXXFI",80,0)
 S (LEXDESC,ZTDESC)="Post-Install File Counts " S:$D(LEXSHORT) (LEXDESC,ZTDESC)="Post-Install Summary",ZTDTH=$H
"RTN","LEXXFI",81,0)
 S ZTIO="" D ^%ZTLOAD W:+($G(ZTSK))>0 !!,"  ",LEXDESC,!,"  Queued Task #",+($G(ZTSK)) W ! D ^%ZISC
"RTN","LEXXFI",82,0)
 Q
"RTN","LEXXFI",83,0)
MAIL ; Mail global array in message
"RTN","LEXXFI",84,0)
 N DIFROM,LEXPRI,LEXADR,LEXI,LEXM,LEXSUB,XCNP,XMDUZ,XMSCR,XMSUB,XMTEXT,XMY,XMZ
"RTN","LEXXFI",85,0)
 G:'$D(LEXSHORT)&(+($G(^TMP("LEXCS",$J,0)))'>0) MAILQ K ^TMP("LEXMSG",$J)
"RTN","LEXXFI",86,0)
 S LEXSUB="Lexicon/ICD/CPT Installation"
"RTN","LEXXFI",87,0)
 S:$L($G(LEXBUILD)) LEXSUB=$G(LEXBUILD)_" Installation"
"RTN","LEXXFI",88,0)
 S LEXPRI=$$ADR^LEXXFI8 G:'$L(LEXPRI) MAILQ
"RTN","LEXXFI",89,0)
 S LEXPRI="G.LEXINS@"_LEXPRI
"RTN","LEXXFI",90,0)
 S LEXADR=$$GET1^DIQ(200,+($G(DUZ)),.01) G:'$L(LEXADR) MAILQ
"RTN","LEXXFI",91,0)
 S U="^",XMSUB="LEX/ICD/CPT File Checksums - "_$$FMTE^XLFDT($$NOW^XLFDT)
"RTN","LEXXFI",92,0)
 S:$D(LEXCOUNT) XMSUB="LEX/ICD/CPT File Checksums/Counts - "_$$FMTE^XLFDT($$NOW^XLFDT)
"RTN","LEXXFI",93,0)
 S:$L($G(LEXBUILD)) XMSUB=$G(LEXBUILD)_" File Checksums"
"RTN","LEXXFI",94,0)
 S:$L($G(LEXBUILD))&($D(LEXCOUNT)) XMSUB=$G(LEXBUILD)_" File Checksums/Counts"
"RTN","LEXXFI",95,0)
 S:$D(LEXPOST) XMSUB=LEXSUB
"RTN","LEXXFI",96,0)
 S LEXI=0 F  S LEXI=$O(^TMP("LEXKID",$J,LEXI)) Q:+LEXI=0  D
"RTN","LEXXFI",97,0)
 . S LEXM=+($O(^TMP("LEXMSG",$J," "),-1))+1
"RTN","LEXXFI",98,0)
 . S ^TMP("LEXMSG",$J,LEXM,0)=$E($G(^TMP("LEXKID",$J,LEXI)),1,79)
"RTN","LEXXFI",99,0)
 . S ^TMP("LEXMSG",$J,0)=LEXM
"RTN","LEXXFI",100,0)
 K ^TMP("LEXKID",$J)
"RTN","LEXXFI",101,0)
 I '$D(LEXSHORT) S LEXI=0 F  S LEXI=$O(^TMP("LEXCS",$J,LEXI)) Q:+LEXI=0  D
"RTN","LEXXFI",102,0)
 . S LEXM=+($O(^TMP("LEXMSG",$J," "),-1))+1
"RTN","LEXXFI",103,0)
 . S ^TMP("LEXMSG",$J,LEXM,0)=$E($G(^TMP("LEXCS",$J,LEXI)),1,79)
"RTN","LEXXFI",104,0)
 . S ^TMP("LEXMSG",$J,0)=LEXM
"RTN","LEXXFI",105,0)
 K ^TMP("LEXCS",$J) G:'$D(^TMP("LEXMSG",$J)) MAILQ G:+($G(^TMP("LEXMSG",$J,0)))'>0 MAILQ
"RTN","LEXXFI",106,0)
 S XMY(LEXPRI)="",XMY(LEXADR)="",XMTEXT="^TMP(""LEXMSG"",$J,",XMDUZ=.5 D ^XMD
"RTN","LEXXFI",107,0)
MAILQ ; Quit Mail
"RTN","LEXXFI",108,0)
 D KILL K %Z,XCNP,XMSCR,XMDUZ,XMY,XMZ,XMSUB,XMY,XMTEXT,XMDUZ
"RTN","LEXXFI",109,0)
 Q
"RTN","LEXXFI",110,0)
 ;               
"RTN","LEXXFI",111,0)
 ; Miscellaneous
"RTN","LEXXFI",112,0)
HDR ;   Header
"RTN","LEXXFI",113,0)
 N LEXD,LEXP,LEXN,LEXT,LEXU,LEXA,LEXACT,LEXI,LEXF,LEXMUL S LEXF=0 S LEXACT=$G(LEXACCT),LEXA=""
"RTN","LEXXFI",114,0)
 S:$L($P(LEXACT,"^",1))&($L($P(LEXACT,"^",1))) LEXA=LEXACT
"RTN","LEXXFI",115,0)
 S:'$L($G(LEXA)) LEXA=$$U^LEXXFI7 S LEXU=$$P^LEXXFI7,LEXD=$$A^LEXXFI7 D TT^LEXXFI8("","Status")
"RTN","LEXXFI",116,0)
 S LEXT="" S:$L(LEXD) LEXT="   As of:       "_LEXD
"RTN","LEXXFI",117,0)
 I $L(LEXD) D:+LEXF'>0 BL^LEXXFI8 D TL^LEXXFI8(LEXT) S LEXF=1
"RTN","LEXXFI",118,0)
 S LEXT="",LEXI=$S($L($P(LEXA,"^",1)):"[",1:"")_$P(LEXA,"^",1)_$S($L($P(LEXA,"^",2)):"]",1:"")
"RTN","LEXXFI",119,0)
 S:$L(LEXI)&($L($P(LEXA,"^",2))) LEXI=LEXI_"  "_$P(LEXA,"^",2)
"RTN","LEXXFI",120,0)
 S LEXT="" S:$L(LEXI) LEXT="   In Account:  "_LEXI
"RTN","LEXXFI",121,0)
 I $L(LEXT) D:+LEXF'>0 BL^LEXXFI8 D TL^LEXXFI8(LEXT) S LEXF=1
"RTN","LEXXFI",122,0)
 S LEXN=$P(LEXU,"^",1),LEXP=$P(LEXU,"^",2)
"RTN","LEXXFI",123,0)
 S LEXT="" S:$L(LEXN) LEXT="   Maint By:    "
"RTN","LEXXFI",124,0)
 S:$L(LEXN) LEXT=LEXT_LEXN S:$L(LEXP)&($L(LEXN)) LEXT=LEXT_"   "_LEXP
"RTN","LEXXFI",125,0)
 I $L(LEXT) D:+LEXF'>0 BL^LEXXFI8 D TL^LEXXFI8(LEXT) S LEXF=1
"RTN","LEXXFI",126,0)
 S LEXT="" S:$L($G(LEXBUILD)) LEXT="   Build:       "_$G(LEXBUILD)
"RTN","LEXXFI",127,0)
 I $L(LEXT) D:+LEXF'>0 BL^LEXXFI8 D TL^LEXXFI8(LEXT) S LEXF=1
"RTN","LEXXFI",128,0)
 S LEXT="" I $L($G(LEXPRO))&($L($G(LEXPRON))) D
"RTN","LEXXFI",129,0)
 . S LEXT="   Protocol:    "_LEXPRON_" invoked "_LEXPRO
"RTN","LEXXFI",130,0)
 . I $L(LEXT) D:+LEXF'>0 BL^LEXXFI8 D TL^LEXXFI8(LEXT) S LEXF=1
"RTN","LEXXFI",131,0)
 D BL^LEXXFI8
"RTN","LEXXFI",132,0)
 Q
"RTN","LEXXFI",133,0)
TIM ;   Time
"RTN","LEXXFI",134,0)
 Q:$D(LEXPOST)  Q:+($G(LEXBEG))'>0  Q:+($G(LEXEND))'>0  Q:'$L($G(LEXELP))
"RTN","LEXXFI",135,0)
 D BL^LEXXFI8,TL^LEXXFI8(("   Started:   "_$TR($$FMTE^XLFDT(LEXBEG),"@"," ")))
"RTN","LEXXFI",136,0)
 D TL^LEXXFI8(("   Finished:  "_$TR($$FMTE^XLFDT(LEXEND),"@"," ")))
"RTN","LEXXFI",137,0)
 D TL^LEXXFI8(("   Elapsed:   "_LEXELP)),BL^LEXXFI8
"RTN","LEXXFI",138,0)
 Q
"RTN","LEXXFI",139,0)
ENV(X) ;   Environment check
"RTN","LEXXFI",140,0)
 N LEXNM D HOME^%ZIS S U="^",DT=$$DT^XLFDT
"RTN","LEXXFI",141,0)
 I +($G(DUZ))'>0 W !!,"    User (DUZ) not defined",! Q 0
"RTN","LEXXFI",142,0)
 S LEXNM=$$GET1^DIQ(200,+($G(DUZ)),.01) I '$L(LEXNM) W !!,"    Invalid User (DUZ) defined",! Q 0
"RTN","LEXXFI",143,0)
 S DTIME=$$DTIME^XUP(+($G(DUZ)))
"RTN","LEXXFI",144,0)
 Q 1
"RTN","LEXXFI",145,0)
CLR ;   Clear ^TMP("LEXCS",$J)
"RTN","LEXXFI",146,0)
 K ^TMP("LEXCS",$J) Q
"RTN","LEXXFI",147,0)
KILL ;   Kill all ^TMP("LEX**"
"RTN","LEXXFI",148,0)
 K ^TMP("LEXCNT",$J),^TMP("LEXCS",$J),^TMP("LEXI",$J)
"RTN","LEXXFI",149,0)
 K ^TMP("LEXINS",$J),^TMP("LEXMSG",$J),^TMP("LEXKID",$J)
"RTN","LEXXFI",150,0)
 Q
"RTN","LEXXFI",151,0)
 ;;
"RTN","LEXXFI",152,0)
 ;;
"RTN","LEXXFI",153,0)
FILES ;;
"RTN","LEXXFI",154,0)
 ;;;;757
"RTN","LEXXFI",155,0)
 ;;1;;757.001
"RTN","LEXXFI",156,0)
 ;;1;;757.01
"RTN","LEXXFI",157,0)
 ;;;;757.011
"RTN","LEXXFI",158,0)
 ;;;;757.014
"RTN","LEXXFI",159,0)
 ;;;;757.02
"RTN","LEXXFI",160,0)
 ;;;;757.03
"RTN","LEXXFI",161,0)
 ;;1;;757.04
"RTN","LEXXFI",162,0)
 ;;1;;757.05
"RTN","LEXXFI",163,0)
 ;;1;;757.06
"RTN","LEXXFI",164,0)
 ;;;;757.1
"RTN","LEXXFI",165,0)
 ;;;;757.11
"RTN","LEXXFI",166,0)
 ;;;;757.12
"RTN","LEXXFI",167,0)
 ;;;;757.13
"RTN","LEXXFI",168,0)
 ;;;;757.14
"RTN","LEXXFI",169,0)
 ;;1;;757.2
"RTN","LEXXFI",170,0)
 ;;1;;757.21
"RTN","LEXXFI",171,0)
 ;;;;757.3
"RTN","LEXXFI",172,0)
 ;;;;757.31
"RTN","LEXXFI",173,0)
 ;;1;;757.4
"RTN","LEXXFI",174,0)
 ;;1;;757.41
"RTN","LEXXFI",175,0)
 ;;;;80
"RTN","LEXXFI",176,0)
 ;;;;80.1
"RTN","LEXXFI",177,0)
 ;;;;80.3
"RTN","LEXXFI",178,0)
 ;;;;81
"RTN","LEXXFI",179,0)
 ;;;;81.1
"RTN","LEXXFI",180,0)
 ;;1;;81.2
"RTN","LEXXFI",181,0)
 ;;;;81.3
"RTN","LEXXFI",182,0)
 ;;
"RTN","LEXXFI",183,0)
 ;;
"RTN","LEXXFI",184,0)
 ;;
"RTN","LEXXFI",185,0)
 Q
"RTN","LEXXFI7")
0^7^B41558940
"RTN","LEXXFI7",1,0)
LEXXFI7 ; ISL/KER - File Info - Prompts and Header   ; 02/22/2007
"RTN","LEXXFI7",2,0)
 ;;2.0;LEXICON UTILITY;**32,49**;Sep 23, 1996;Build 3
"RTN","LEXXFI7",3,0)
 Q
"RTN","LEXXFI7",4,0)
 ;                    
"RTN","LEXXFI7",5,0)
 ; Global Variables
"RTN","LEXXFI7",6,0)
 ;   ^%ZOSF("UCI")       DBIA 10096
"RTN","LEXXFI7",7,0)
 ;   ^%ZOSF("PROD")      DBIA 10096
"RTN","LEXXFI7",8,0)
 ;
"RTN","LEXXFI7",9,0)
 ; External References
"RTN","LEXXFI7",10,0)
 ;   DBIA 10026  ^DIR
"RTN","LEXXFI7",11,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","LEXXFI7",12,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","LEXXFI7",13,0)
 ;   DBIA  2056  $$GET1^DIQ (file #200)
"RTN","LEXXFI7",14,0)
 ;   DBIA 10096  ^%ZOSF("UCI")
"RTN","LEXXFI7",15,0)
 ;   DBIA 10096  ^%ZOSF("PROD")
"RTN","LEXXFI7",16,0)
 ;                    
"RTN","LEXXFI7",17,0)
MT(X) ; Method - One or All Files
"RTN","LEXXFI7",18,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,Y
"RTN","LEXXFI7",19,0)
 S DIR(0)="SAO^O:Checksum for ONE file;A:Checksum for ALL files (LEX/ICD/CPT)"
"RTN","LEXXFI7",20,0)
 S DIR("A",1)=" Compute Checksum for:",DIR("A",2)=" "
"RTN","LEXXFI7",21,0)
 S DIR("A",3)="   One Lexicon, ICD or CPT file"
"RTN","LEXXFI7",22,0)
 S DIR("A",4)="   All Lexicon, ICD or CPT files (757*/80*/81*)"
"RTN","LEXXFI7",23,0)
 S DIR("A",5)=" ",DIR("A")=" Select One or All:  (O/A)  "
"RTN","LEXXFI7",24,0)
 S DIR("B")="O",(DIR("?"),DIR("??"))="^D MTH^LEXXFI7"
"RTN","LEXXFI7",25,0)
 W ! D ^DIR S X=$S(Y="O":"ONE",Y="A":"ALL",1:"")
"RTN","LEXXFI7",26,0)
 Q X
"RTN","LEXXFI7",27,0)
MTH ;   Method Help
"RTN","LEXXFI7",28,0)
 W !,"     Do you wish to compute the checksum for a single Lexicon, ICD"
"RTN","LEXXFI7",29,0)
 W !,"     or CPT file or all Lexicon, ICD and CPT files (757*/80*/81*)"
"RTN","LEXXFI7",30,0)
 W:$G(X)["??" !,"     Answer either 'O'ne or 'A'll or '^' to exit"
"RTN","LEXXFI7",31,0)
 Q
"RTN","LEXXFI7",32,0)
 ;                             
"RTN","LEXXFI7",33,0)
CC(X) ; Checksum AND Count
"RTN","LEXXFI7",34,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,Y
"RTN","LEXXFI7",35,0)
 S DIR(0)="YAO",DIR("A")=" Include a Record Count with the Checksum?  (Y/N)  "
"RTN","LEXXFI7",36,0)
 S DIR("B")="N",(DIR("?"),DIR("??"))="^D CCH^LEXXFI7"
"RTN","LEXXFI7",37,0)
 W ! D ^DIR S X=$S(+Y>0:1,1:0)
"RTN","LEXXFI7",38,0)
 Q X
"RTN","LEXXFI7",39,0)
CCH ;   Checksum AND Count Help
"RTN","LEXXFI7",40,0)
 W !,"     Answer 'Yes' to include a count of the total the number of records"
"RTN","LEXXFI7",41,0)
 W !,"     in the file/sub-file along with the checksum"
"RTN","LEXXFI7",42,0)
 Q
"RTN","LEXXFI7",43,0)
 ;                        
"RTN","LEXXFI7",44,0)
FI(X) ; Select Lexicon/ICD File
"RTN","LEXXFI7",45,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,Y
"RTN","LEXXFI7",46,0)
 S DIR(0)="FAO^1:45"
"RTN","LEXXFI7",47,0)
 S DIR("A")=" Select File:  "
"RTN","LEXXFI7",48,0)
 S (DIR("?"),DIR("??"))="^D FIH^LEXXFI7" D ^DIR S X=$$FOT(Y)
"RTN","LEXXFI7",49,0)
 Q X
"RTN","LEXXFI7",50,0)
FIH ;   File Help
"RTN","LEXXFI7",51,0)
 W !,"     Select either a Lexicon, ICD or CPT file:"
"RTN","LEXXFI7",52,0)
 W !!,"                          Lexicon                  ICD       CPT"
"RTN","LEXXFI7",53,0)
 W !,"     ----------------------------------------       ----      ----"
"RTN","LEXXFI7",54,0)
 W !,"     757        757.03     757.12     757.31        80        81"
"RTN","LEXXFI7",55,0)
 W !,"     757.001    757.03     757.13     757.4         80.1      81.1"
"RTN","LEXXFI7",56,0)
 W !,"     757.01     757.05     757.14     757.41        80.3      81.2"
"RTN","LEXXFI7",57,0)
 W !,"     757.011    757.06     757.2                              81.3"
"RTN","LEXXFI7",58,0)
 W !,"     757.014    757.1      757.21"
"RTN","LEXXFI7",59,0)
 W !,"     757.02     757.11     757.3 "
"RTN","LEXXFI7",60,0)
 Q
"RTN","LEXXFI7",61,0)
FOT(X) ;   File Output Transform
"RTN","LEXXFI7",62,0)
 N LEX,LEXX
"RTN","LEXXFI7",63,0)
 S LEXX=$G(X) Q:'$L(X) "^"  D ARY(LEXX,.LEX)
"RTN","LEXXFI7",64,0)
 S:+($G(LEX(0)))=1 LEXX=$$ONE(X,.LEX)
"RTN","LEXXFI7",65,0)
 S:+($G(LEX(0)))>1 LEXX=$$MULT(X,.LEX)
"RTN","LEXXFI7",66,0)
 S X=$S(+LEXX>0:+LEXX,1:"^")
"RTN","LEXXFI7",67,0)
 Q X
"RTN","LEXXFI7",68,0)
ONE(X,LEX) ;   One Entry
"RTN","LEXXFI7",69,0)
 S X=+($G(LEX(1)))
"RTN","LEXXFI7",70,0)
 I $L($P($G(LEX(1)),"^",2)),+X>0 D
"RTN","LEXXFI7",71,0)
 . W "    ",$P($G(LEX(1)),"^",2)," (#",+X,")"
"RTN","LEXXFI7",72,0)
 Q:+X'>0 "^"  Q X
"RTN","LEXXFI7",73,0)
MULT(X,LEX) ;   Multiple Entries
"RTN","LEXXFI7",74,0)
 N LEXE,LEXEX,LEXFI,LEXI,LEXM,LEXMAX,LEXNAM,LEXS
"RTN","LEXXFI7",75,0)
 S LEXMAX=$G(LEX(0)) Q:+LEXMAX'>1  W ! W !," ",LEXMAX," matches found"
"RTN","LEXXFI7",76,0)
 S LEXS=0,LEXEX=0 F LEXI=1:1:LEXMAX Q:((LEXS>0)&(LEXS<LEXI+1))  Q:LEXEX  D  Q:LEXEX
"RTN","LEXXFI7",77,0)
 . S LEXE=$G(LEX(LEXI)),LEXNAM=$P(LEXE,"^",2),LEXFI=+LEXE Q:'$L(LEXNAM)  Q:+LEXFI'>0  S LEXM=LEXI
"RTN","LEXXFI7",78,0)
 . W:LEXI#5=1 ! W !," ",$J(LEXI,4),".  ",LEXNAM," (#",+LEXFI,")"
"RTN","LEXXFI7",79,0)
 . W:LEXI#5=0 ! S:LEXI#5=0 LEXS=$$SEL(LEXM,.LEX) S:LEXS["^" LEXEX=1
"RTN","LEXXFI7",80,0)
 I LEXI#5'=0,+LEXS=0 W ! S LEXS=$$SEL(LEXM,.LEX) S:LEXS["^" LEXEX=1
"RTN","LEXXFI7",81,0)
 S X="^" S:'LEXEX&(+LEXS>0) X=+LEXS S:+X'>0 X="^"
"RTN","LEXXFI7",82,0)
 Q X
"RTN","LEXXFI7",83,0)
SEL(X,LEX) ;     Select Multiple
"RTN","LEXXFI7",84,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,LEXM,Y S LEXM=+($G(X)) Q:LEXM=0 -1
"RTN","LEXXFI7",85,0)
 S:+($O(LEX(+($G(LEXI)))))>0 DIR("A")=" Select 1-"_LEXM_" or '^' to exit:  "
"RTN","LEXXFI7",86,0)
 S:+($O(LEX(+($G(LEXI)))))'>0 DIR("A")=" Select 1-"_LEXM_":  "
"RTN","LEXXFI7",87,0)
 S (DIR("?"),DIR("??"))="Answer must be from 1 to "_LEXM_", or <Return> to continue  "
"RTN","LEXXFI7",88,0)
 S DIR(0)="NAO^1:"_LEXM_":0" D ^DIR S X="" S:$D(DTOUT)!(X[U) X=U
"RTN","LEXXFI7",89,0)
 I $L($P($G(LEX(+Y)),"^",2)),+($G(LEX(+Y)))>0 D
"RTN","LEXXFI7",90,0)
 . W "    ",$P($G(LEX(+Y)),"^",2)," (#",+($G(LEX(+Y))),")"
"RTN","LEXXFI7",91,0)
 . S X=+($G(LEX(+Y)))
"RTN","LEXXFI7",92,0)
 Q X
"RTN","LEXXFI7",93,0)
ARY(X,LEX) ;   Build Array  of Files
"RTN","LEXXFI7",94,0)
 N LEXF,LEXNM,LEXO,LEXX,Y
"RTN","LEXXFI7",95,0)
 S LEXX=$TR($G(X),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ") N X,Y
"RTN","LEXXFI7",96,0)
 Q:'$L(LEXX) ""  I +LEXX=LEXX D  Q
"RTN","LEXXFI7",97,0)
 . N LEXO,LEXN,LEXC S LEXO=LEXX-.00000001
"RTN","LEXXFI7",98,0)
 . F  S LEXO=$O(@("^DIC("_LEXO_")")) Q:+LEXO=0!($E(LEXO,1,$L(LEXX))'=LEXX)  D
"RTN","LEXXFI7",99,0)
 . . N LEXNM S LEXNM=$$FN^LEXXFI8(LEXO) Q:'$L(LEXNM)  S LEX(0)=($O(LEX(" "),-1)+1),LEX(+LEX(0))=+LEXO_"^"_LEXNM
"RTN","LEXXFI7",100,0)
 S LEXO=$E(LEXX,1,($L(LEXX)-1))_$C($A($E(LEXX,$L(LEXX)))-1)_"~"
"RTN","LEXXFI7",101,0)
 F  S LEXO=$O(@("^DIC(""B"","_LEXO_")")) Q:LEXO=""  Q:$E(LEXO,1,$L(LEXX))'[LEXX  D
"RTN","LEXXFI7",102,0)
 . S LEXF=0 F  S LEXF=$O(@("^DIC(""B"","_LEXO_","_LEXF_")")) Q:+LEXF'>0  D
"RTN","LEXXFI7",103,0)
 . . Q:+($$LEX^LEXXFI8(LEXF))'>0&(+($$IC^LEXXFI8(LEXF))'>0)  N LEXNM S LEXNM=$$FN^LEXXFI8(LEXF)
"RTN","LEXXFI7",104,0)
 . . Q:'$L(LEXNM)  S LEX(0)=($O(LEX(" "),-1)+1),LEX(+LEX(0))=+LEXF_"^"_LEXNM
"RTN","LEXXFI7",105,0)
 Q
"RTN","LEXXFI7",106,0)
 ;                          
"RTN","LEXXFI7",107,0)
 ; Miscellaneous
"RTN","LEXXFI7",108,0)
U(X) ;   UCI where Lexicon is installed
"RTN","LEXXFI7",109,0)
 N LEXU,LEXP,LEXT,Y X ^%ZOSF("UCI") S LEXU=Y,LEXP="" S:LEXU=^%ZOSF("PROD")!($P(LEXU,",",1)=^%ZOSF("PROD")) LEXP=" (Production)"
"RTN","LEXXFI7",110,0)
 S:LEXU'=^%ZOSF("PROD")&($P(LEXU,",",1)'=^%ZOSF("PROD")) LEXP=" (Test)" S X="",$P(X,"^",1)=LEXU,$P(X,"^",2)=LEXP
"RTN","LEXXFI7",111,0)
 Q X
"RTN","LEXXFI7",112,0)
A(X) ;   As of date/time
"RTN","LEXXFI7",113,0)
 N LEXX S LEXX=$$NOW^XLFDT,LEXX=$$FMTE^XLFDT(LEXX,"1")
"RTN","LEXXFI7",114,0)
 S:LEXX["@" LEXX=$P(LEXX,"@",1)_"  "_$P(LEXX,"@",2,299)
"RTN","LEXXFI7",115,0)
 S X=LEXX
"RTN","LEXXFI7",116,0)
 Q X
"RTN","LEXXFI7",117,0)
P(X) ;   Person
"RTN","LEXXFI7",118,0)
 N LEXDUZ,LEXPH,LEXNM
"RTN","LEXXFI7",119,0)
 S LEXDUZ=+($G(DUZ)),LEXNM=$$GET1^DIQ(200,+($G(LEXDUZ)),.01) Q:'$L(LEXNM) "UNKNOWN^"
"RTN","LEXXFI7",120,0)
 S LEXDUZ=+($G(DUZ)) S LEXPH=$$GET1^DIQ(200,+($G(LEXDUZ)),.132)
"RTN","LEXXFI7",121,0)
 S:LEXPH="" LEXPH=$$GET1^DIQ(200,+($G(LEXDUZ)),.133)
"RTN","LEXXFI7",122,0)
 S:LEXPH="" LEXPH=$$GET1^DIQ(200,+($G(LEXDUZ)),.134)
"RTN","LEXXFI7",123,0)
 S:LEXPH="" LEXPH=$$GET1^DIQ(200,+($G(LEXDUZ)),.135)
"RTN","LEXXFI7",124,0)
 S LEXDUZ=$$PM(LEXNM)
"RTN","LEXXFI7",125,0)
 S X=LEXDUZ_"^"_LEXPH
"RTN","LEXXFI7",126,0)
 Q X
"RTN","LEXXFI7",127,0)
PM(X) ;     Person, Mixed Case
"RTN","LEXXFI7",128,0)
 N LEXF,LEXL,LEXP S LEXP=$G(X),LEXL=$$MX($P(LEXP,",",1)),LEXF=$P(LEXP,",",2)
"RTN","LEXXFI7",129,0)
 S LEXL(1)=$$MX($P(LEXL,"-",1)),LEXL(2)=$$MX($P(LEXL(1)," ",2,2)),LEXL(1)=$$MX($P(LEXL(1)," ",1))
"RTN","LEXXFI7",130,0)
 S:$L(LEXL(1))&($L(LEXL(2))) LEXL(1)=LEXL(1)_" "_LEXL(2)
"RTN","LEXXFI7",131,0)
 S LEXL(3)=$$MX($P(LEXL,"-",2)),LEXL(4)=$$MX($P(LEXL(3)," ",2,2)),LEXL(3)=$$MX($P(LEXL(3)," ",1))
"RTN","LEXXFI7",132,0)
 S:$L(LEXL(3))&($L(LEXL(4))) LEXL(3)=LEXL(3)_" "_LEXL(4)
"RTN","LEXXFI7",133,0)
 S LEXL=LEXL(1) S:$L(LEXL(1))&($L(LEXL(3))) LEXL=LEXL(1)_"-"_LEXL(3)
"RTN","LEXXFI7",134,0)
 S LEXF=$$MX($P(LEXP,",",1)),LEXF=$P(LEXP,",",2)
"RTN","LEXXFI7",135,0)
 S LEXF(1)=$$MX($P(LEXF,"-",1)),LEXF(2)=$$MX($P(LEXF(1)," ",2,2)),LEXF(1)=$$MX($P(LEXF(1)," ",1))
"RTN","LEXXFI7",136,0)
 S:$L(LEXF(1))&($L(LEXF(2))) LEXF(1)=LEXF(1)_" "_LEXF(2)
"RTN","LEXXFI7",137,0)
 S LEXF(3)=$$MX($P(LEXF,"-",2)),LEXF(4)=$$MX($P(LEXF(3)," ",2,2)),LEXF(3)=$$MX($P(LEXF(3)," ",1))
"RTN","LEXXFI7",138,0)
 S:$L(LEXF(3))&($L(LEXF(4))) LEXF(3)=LEXF(3)_" "_LEXF(4)
"RTN","LEXXFI7",139,0)
 S LEXF=LEXF(1) S:$L(LEXF(1))&($L(LEXF(3))) LEXF=LEXF(1)_"-"_LEXF(3)
"RTN","LEXXFI7",140,0)
 S LEXP=LEXL_", "_LEXF,X=LEXP
"RTN","LEXXFI7",141,0)
 Q X
"RTN","LEXXFI7",142,0)
MX(X) ;     Mix Case
"RTN","LEXXFI7",143,0)
 Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","LEXXGI")
0^1^B60750552
"RTN","LEXXGI",1,0)
LEXXGI ; ISL/KER - Global Import (Needs ^LEXM) ; 02/22/2007
"RTN","LEXXGI",2,0)
 ;;2.0;LEXICON UTILITY;**4,25,26,27,28,29,46,49**;Sep 23, 1996;Build 3
"RTN","LEXXGI",3,0)
 ;              
"RTN","LEXXGI",4,0)
 ; NEWed or KILLed Elsewhere
"RTN","LEXXGI",5,0)
 ;              
"RTN","LEXXGI",6,0)
 ;    LEXBUILD, LEXFY, LEXIGHF, LEXLREV, LEXPTYPE
"RTN","LEXXGI",7,0)
 ;    LEXQTR, LEXREQP, LEXSHORT, XPDNM
"RTN","LEXXGI",8,0)
 ;              
"RTN","LEXXGI",9,0)
 ; Global Variables
"RTN","LEXXGI",10,0)
 ;    ^LEXM
"RTN","LEXXGI",11,0)
 ;              
"RTN","LEXXGI",12,0)
 ; External References
"RTN","LEXXGI",13,0)
 ;    HOME^%ZIS
"RTN","LEXXGI",14,0)
 ;    ^DIM     
"RTN","LEXXGI",15,0)
 ;    $$GET1^DIQ
"RTN","LEXXGI",16,0)
 ;    $$DT^XLFDT
"RTN","LEXXGI",17,0)
 ;    $$FMTE^XLFDT
"RTN","LEXXGI",18,0)
 ;    BMES^XPDUTL 
"RTN","LEXXGI",19,0)
 ;    MES^XPDUTL  
"RTN","LEXXGI",20,0)
 ;              
"RTN","LEXXGI",21,0)
EN ; Main Entry Point for Installing LEXM in Post-Installs
"RTN","LEXXGI",22,0)
 ;                
"RTN","LEXXGI",23,0)
 ; Requires 
"RTN","LEXXGI",24,0)
 ;                
"RTN","LEXXGI",25,0)
 ;   LEXBUILD - the name of the patch/build being installed
"RTN","LEXXGI",26,0)
 ;                
"RTN","LEXXGI",27,0)
 ; Uses
"RTN","LEXXGI",28,0)
 ;                
"RTN","LEXXGI",29,0)
 ;   LEXMSG   - If this variable exist, then an install message
"RTN","LEXXGI",30,0)
 ;              message will be set to G.LEXICON
"RTN","LEXXGI",31,0)
 ;              
"RTN","LEXXGI",32,0)
 ;   LEXSHORT - If this variable exist, the install message
"RTN","LEXXGI",33,0)
 ;              will be an abbreviated message, without the 
"RTN","LEXXGI",34,0)
 ;              file totals and checksums
"RTN","LEXXGI",35,0)
 ;               
"RTN","LEXXGI",36,0)
 ;              Abbreviated Install Message
"RTN","LEXXGI",37,0)
 ;               
"RTN","LEXXGI",38,0)
 ;                Date and Time Installed
"RTN","LEXXGI",39,0)
 ;                Account where the Data was Installed
"RTN","LEXXGI",40,0)
 ;                Who Installed the Data
"RTN","LEXXGI",41,0)
 ;                The Name of the Build Installed
"RTN","LEXXGI",42,0)
 ;                The Name of the Global Host File
"RTN","LEXXGI",43,0)
 ;                Protocol Invoked
"RTN","LEXXGI",44,0)
 ;                Date and time Protocol was Invoked
"RTN","LEXXGI",45,0)
 ;                Install Start Date/Time
"RTN","LEXXGI",46,0)
 ;                Install Complete Date/Time
"RTN","LEXXGI",47,0)
 ;                Install Elapsed Time
"RTN","LEXXGI",48,0)
 ;               
"RTN","LEXXGI",49,0)
 ;              Long Install Message
"RTN","LEXXGI",50,0)
 ;               
"RTN","LEXXGI",51,0)
 ;                All of the elements above plus:
"RTN","LEXXGI",52,0)
 ;               
"RTN","LEXXGI",53,0)
 ;                   File Versions/Revisions
"RTN","LEXXGI",54,0)
 ;                   File Checksums
"RTN","LEXXGI",55,0)
 ;                   File Record Counts
"RTN","LEXXGI",56,0)
 ;              
"RTN","LEXXGI",57,0)
 ;   LEXPTYPE - Patch Type
"RTN","LEXXGI",58,0)
 ;   LEXLREV  - Revision
"RTN","LEXXGI",59,0)
 ;   LEXREQP  - Required Patches/Builds
"RTN","LEXXGI",60,0)
 ;   LEXIGHF  - The patch Export Global Host Filename
"RTN","LEXXGI",61,0)
 ;   LEXFY    - Fiscal Year
"RTN","LEXXGI",62,0)
 ;   LEXQTR   - Quarter
"RTN","LEXXGI",63,0)
 ;   LEXCRE   - Import Global Creation Date
"RTN","LEXXGI",64,0)
 ;                
"RTN","LEXXGI",65,0)
 D IMPORT,KALL^LEXXGI2
"RTN","LEXXGI",66,0)
 Q
"RTN","LEXXGI",67,0)
IMPORT ; Import Data during a Patch Installation
"RTN","LEXXGI",68,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEXXGI",69,0)
 S:$L($G(LEXPTYPE)) LEXPTYPE=$G(LEXPTYPE) S:$L($G(LEXLREV)) LEXLREV=$G(LEXLREV) S:$L($G(LEXREQP)) LEXREQP=$G(LEXREQP)
"RTN","LEXXGI",70,0)
 S:$L($G(LEXBUILD)) LEXBUILD=$G(LEXBUILD) S:$L($G(LEXIGHF)) LEXIGHF=$G(LEXIGHF) S:$L($G(LEXFY)) LEXFY=$G(LEXFY)
"RTN","LEXXGI",71,0)
 S:$L($G(LEXQTR)) LEXQTR=$G(LEXQTR) K LEXSCHG,LEXCHG
"RTN","LEXXGI",72,0)
 N LEXB,LEXCD,LEXSTR,LEXLAST,%,%DT,C,D,D0,D1,D2,DG,DIC,DICR,DILOCKTM,DIW,IREC,J,XMDUN,XMZ,ZTSK
"RTN","LEXXGI",73,0)
 S U="^",LEXSTR=$G(LEXPTYPE),LEXB=$G(^LEXM(0,"BUILD"))
"RTN","LEXXGI",74,0)
 S:$L($G(LEXFY))&($L($G(LEXQTR)))&($L(LEXSTR)) LEXSTR=LEXSTR_" for "_$G(LEXFY)_" "_$G(LEXQTR)_" Quarter"
"RTN","LEXXGI",75,0)
 S:$L(LEXB) LEXBLD=LEXB S:'$L(LEXBLD)&($L(LEXBUILD)) LEXBLD=LEXBUILD
"RTN","LEXXGI",76,0)
 I '$L(LEXB)!(LEXB'=LEXBUILD) D
"RTN","LEXXGI",77,0)
 . N X,LEXBLD I '$L(LEXB) D  Q
"RTN","LEXXGI",78,0)
 . . S X=" Invalid export global, aborting data install" W:'$D(XPDNM) !!,X D:$D(XPDNM) BMES^XPDUTL(X) W:'$D(XPDNM) ! D:$D(XPDNM) MES^XPDUTL(" ")
"RTN","LEXXGI",79,0)
 . I '$L(LEXBUILD) D  Q
"RTN","LEXXGI",80,0)
 . . S X=" Undefined KIDS Build, aborting data install" W:'$D(XPDNM) !!,X D:$D(XPDNM) BMES^XPDUTL(X) W:'$D(XPDNM) ! D:$D(XPDNM) MES^XPDUTL(" ")
"RTN","LEXXGI",81,0)
 I $L(LEXB)&(LEXB=LEXBUILD) D
"RTN","LEXXGI",82,0)
 . N LEXFI,LEXID S X="Installing Data for patch "_LEXB W:'$D(XPDNM) !!,X D:$D(XPDNM) BMES^XPDUTL(X) W:'$D(XPDNM) ! D:$D(XPDNM) MES^XPDUTL(" ")
"RTN","LEXXGI",83,0)
 . K LEXSCHG S LEXCHG=0,LEXFI=0 F  S LEXFI=$O(^LEXM(LEXFI)) Q:+LEXFI'>0  D
"RTN","LEXXGI",84,0)
 . . S LEXID=$S(LEXFI=80!(LEXFI=80.1):"ICD",LEXFI=81!(LEXFI=81.1)!(LEXFI=81.2)!(LEXFI=81.3):"CPT",$P(LEXFI,".",1)=757:"LEX",1:"UNK")
"RTN","LEXXGI",85,0)
 . . S LEXSCHG(LEXFI,0)=+($G(^LEXM(LEXFI,0))),LEXSCHG("B",LEXFI)="" S LEXSCHG("C",LEXID,LEXFI)=""
"RTN","LEXXGI",86,0)
 . S:$D(LEXSCHG("C","CPT"))!($D(LEXSCHG("C","ICD"))) LEXSCHG("D","PRO")="",LEXCHG=1,LEXSCHG(0)=1
"RTN","LEXXGI",87,0)
 . D LOAD,NOTIFY^LEXXGI2 I +($G(DUZ))>0,$L($$GET1^DIQ(200,(+($G(DUZ))_","),.01)) D
"RTN","LEXXGI",88,0)
 . . D HOME^%ZIS N DIFROM,LEXPRO,LEXPRON,LEXLAST D:$D(LEXMSG) POST^LEXXFI
"RTN","LEXXGI",89,0)
 Q
"RTN","LEXXGI",90,0)
LOAD ; Load Data from ^LEXM into IC*/LEX Files
"RTN","LEXXGI",91,0)
 Q:'$L($G(LEXB))  S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEXXGI",92,0)
 N LEXBEG,LEXELP,LEXEND,LEXMSG,LEXOK,LEXFL
"RTN","LEXXGI",93,0)
 D:'$D(^LEXM) NF^LEXXGI2 Q:'$D(^LEXM)
"RTN","LEXXGI",94,0)
 S LEXOK=0 S:$O(^LEXM(0))>0 LEXOK=1 D:'LEXOK IG^LEXXGI2 Q:'LEXOK
"RTN","LEXXGI",95,0)
 S LEXBEG=$$HACK^LEXXGI2 D FILES S LEXEND=$$HACK^LEXXGI2,LEXELP=$$ELAP^LEXXGI2(LEXBEG,LEXEND)
"RTN","LEXXGI",96,0)
 S:LEXELP="" LEXELP="00:00:00"
"RTN","LEXXGI",97,0)
 D PB^LEXXGI2("  Data Updated ")
"RTN","LEXXGI",98,0)
 D PB^LEXXGI2(("     Started:   "_$TR($$FMTE^XLFDT(LEXBEG),"@"," ")))
"RTN","LEXXGI",99,0)
 D TL^LEXXGI2(("     Finished:  "_$TR($$FMTE^XLFDT(LEXEND),"@"," ")))
"RTN","LEXXGI",100,0)
 D TL^LEXXGI2(("     Elapsed:   "_LEXELP))
"RTN","LEXXGI",101,0)
 Q
"RTN","LEXXGI",102,0)
FILES ;   Load Data for all files
"RTN","LEXXGI",103,0)
 Q:'$L($G(LEXB))  N LEXHDR,LEXBLD,LEXDAT,LEXFI,LEXFIC,LEXHDRS,LEXLOG,LEXINS
"RTN","LEXXGI",104,0)
 S (LEXFI,LEXFIC)=0,LEXHDR=0,LEXBLD=LEXB
"RTN","LEXXGI",105,0)
 S LEXDAT=$P($G(^LEXM(0,"VRRVDT")),"^",1),LEXINS=1
"RTN","LEXXGI",106,0)
 S:+LEXDAT'>0 LEXDAT=$$DT^XLFDT I LEXOK D
"RTN","LEXXGI",107,0)
 . N LEXCRE,LEXL1 S LEXL1="" S LEXCRE=$G(^LEXM(0,"CREATED")) S LEXCRE=$S(+LEXCRE>0:($$MIX^LEXXGI2($$FMTE^XLFDT(LEXCRE))),1:"")
"RTN","LEXXGI",108,0)
 . S:$L($P(LEXCRE,"@",2)) LEXCRE=$P(LEXCRE,"@",1)_" at "_$P(LEXCRE,"@",2) S LEXL1=" Updating files "
"RTN","LEXXGI",109,0)
 . S:$L($G(LEXCRE))&($L($G(LEXL1))) LEXL1=$G(LEXL1)_"using export global created "_$G(LEXCRE)
"RTN","LEXXGI",110,0)
 . D PB^LEXXGI2(LEXL1)
"RTN","LEXXGI",111,0)
 F  S LEXFI=$O(^LEXM(LEXFI)) Q:+LEXFI=0  D FILE
"RTN","LEXXGI",112,0)
 Q
"RTN","LEXXGI",113,0)
FILE ;     Load Data for one file
"RTN","LEXXGI",114,0)
 N LEXCF,LEXCHG,LEXCHGS,LEXCNT,LEXFIL,LEXI,LEXID,LEXIEN,LEXL,LEXLC
"RTN","LEXXGI",115,0)
 N LEXMUMPS,LEXNM,LEXRT,LEXS,LEXTOT,LEXTXT,LEXIGL,LEXIGI,LEXIGF,LEXIGT
"RTN","LEXXGI",116,0)
 N LEXIGD,LEXIGO,LEXBEG,LEXEND,LEXELP,LEXFB
"RTN","LEXXGI",117,0)
 S LEXFB=$G(^LEXM(+LEXFI,0,"BUILD")),LEXIGO=0,LEXBEG=$$HACK^LEXXGI2
"RTN","LEXXGI",118,0)
 S (LEXCNT,LEXLC,LEXI)=0,LEXL=68,LEXFIC=LEXFIC+1 I LEXOK D
"RTN","LEXXGI",119,0)
 . N LEXB,LEXFID,LEXNM,LEXVR,LEXRV,LEXDT,LEXL1,LEXL2 S (LEXL1,LEXL2)="",LEXFID=$P(LEXFI,".",1)
"RTN","LEXXGI",120,0)
 . Q:+LEXFID'>0  Q:$D(LEXHDRS(+LEXFID))  S LEXHDRS(LEXFID)="" S:+LEXFI=81!(+LEXFI=81.3) LEXHDRS(81)="",LEXHDRS(81.3)=""
"RTN","LEXXGI",121,0)
 . S:LEXFID=80 LEXNM="ICD-9-CM" S:LEXFID=81 LEXNM="CPT-4/HCPSC" S:LEXFID=757 LEXNM="Lexicon" S LEXB=$G(^LEXM(LEXFI,0,"BUILD"))
"RTN","LEXXGI",122,0)
 . S LEXVR=$G(^LEXM(LEXFI,0,"VR")),LEXRV=$G(^LEXM(LEXFI,0,"VRRV")),LEXDT=$$MIX^LEXXGI2($$FMTE^XLFDT($P(LEXRV,"^",2))),LEXRV=$P(LEXRV,"^",1)
"RTN","LEXXGI",123,0)
 . S LEXL1="Updating "_LEXNM S:$L(LEXB) LEXL1=LEXL1_" with patch/build "_LEXB S:$L(LEXVR) LEXL2=" To version "_LEXVR
"RTN","LEXXGI",124,0)
 . S:$L(LEXVR)&($L(LEXRV)) LEXL2=LEXL2_" revision "_LEXRV S:$L(LEXVR)&($L(LEXRV))&($L(LEXDT)) LEXL2=LEXL2_" dated "_LEXDT
"RTN","LEXXGI",125,0)
 . S:$L(LEXL1) LEXL1=" "_LEXL1 S:$L(LEXL2) LEXL2=" "_LEXL2 D BL^LEXXGI2 D:$L(LEXL1) TL^LEXXGI2(LEXL1) D:$L(LEXL2) TL^LEXXGI2(LEXL2),BL^LEXXGI2
"RTN","LEXXGI",126,0)
 S LEXTOT=+($G(^LEXM(LEXFI,0))) G:LEXTOT=0 FILEQ
"RTN","LEXXGI",127,0)
 S LEXNM=$G(^LEXM(LEXFI,0,"NM"))
"RTN","LEXXGI",128,0)
 I $L(LEXNM),$$UP^LEXXGI2(LEXNM)'["FILE" S LEXNM=LEXNM_" FILE"
"RTN","LEXXGI",129,0)
 S:$L(LEXNM) LEXNM=$$MIX^LEXXGI2(LEXNM) S LEXCHG=$G(^LEXM(LEXFI,0))
"RTN","LEXXGI",130,0)
 S LEXTXT="   "_LEXNM,LEXTXT=LEXTXT_$J("",(40-$L(LEXTXT)))_LEXFI
"RTN","LEXXGI",131,0)
 D:LEXFIC=1 PB^LEXXGI2(LEXTXT) D:LEXFIC'=1 TL^LEXXGI2(LEXTXT)
"RTN","LEXXGI",132,0)
 S LEXS=+(LEXTOT\LEXL) S:LEXS=0 LEXS=1 W:+($O(^LEXM(LEXFI,0)))>0 !,"   "
"RTN","LEXXGI",133,0)
 D UPCHG^LEXXGI2 F  S LEXI=$O(^LEXM(LEXFI,LEXI)) Q:+LEXI=0  D
"RTN","LEXXGI",134,0)
 . S LEXCNT=LEXCNT+1,LEXMUMPS=$G(^LEXM(LEXFI,LEXI))
"RTN","LEXXGI",135,0)
 . I LEXCNT'<LEXS S LEXLC=LEXLC+1 W:LEXLC'>LEXL "." S LEXCNT=0
"RTN","LEXXGI",136,0)
 . S LEXRT=$P(LEXMUMPS,"^",2),LEXFIL=""
"RTN","LEXXGI",137,0)
 . S:LEXMUMPS["^LEX("!(LEXMUMPS["^LEXT(")!(LEXMUMPS["^LEXC(") LEXFIL=+($P(LEXRT,"(",2)),LEXFL(+($P(LEXRT,"(",2)))=""
"RTN","LEXXGI",138,0)
 . S:LEXMUMPS["^ICD9(" LEXFIL=80,LEXFL(80)=""
"RTN","LEXXGI",139,0)
 . S:LEXMUMPS["^ICD0(" LEXFIL=80.1,LEXFL(80.1)=""
"RTN","LEXXGI",140,0)
 . S:LEXMUMPS["^ICPT(" LEXFIL=81,LEXFL(81)=""
"RTN","LEXXGI",141,0)
 . S:LEXMUMPS["^DIC(81.3" LEXFIL=81.3,LEXFL(81.3)=""
"RTN","LEXXGI",142,0)
 . S:LEXMUMPS["^DIC(81.2" LEXFIL=81.2,LEXFL(81.2)=""
"RTN","LEXXGI",143,0)
 . S:LEXMUMPS["^LEX("!(LEXMUMPS["^LEXT(")!(LEXMUMPS["^LEXC(") LEXFIL=+($P(LEXRT,"(",2))
"RTN","LEXXGI",144,0)
 . S:LEXMUMPS["^ICD9(" LEXFIL=80 S:LEXMUMPS["^ICD0(" LEXFIL=80.1
"RTN","LEXXGI",145,0)
 . S:LEXMUMPS["^ICPT(" LEXFIL=81 S:LEXMUMPS["^DIC(81.3" LEXFIL=81.3
"RTN","LEXXGI",146,0)
 . S:+LEXFIL>0 LEXSCHG(+LEXFIL,0)=""
"RTN","LEXXGI",147,0)
 . I $L(LEXMUMPS) D
"RTN","LEXXGI",148,0)
 . . N X S X=LEXMUMPS D ^DIM Q:'$D(X)  X LEXMUMPS S LEXIGO=1
"RTN","LEXXGI",149,0)
 I +($G(LEXIGO))>0 D
"RTN","LEXXGI",150,0)
 . S LEXEND=$$HACK^LEXXGI2 S LEXELP=$$ELAP^LEXXGI2(LEXBEG,LEXEND) S:LEXELP="" LEXELP="00:00:00"
"RTN","LEXXGI",151,0)
FILEQ ;     Load Data for one file - QUIT
"RTN","LEXXGI",152,0)
 K ^LEXM(+LEXFI)
"RTN","LEXXGI",153,0)
 Q
"RTN","LEXXGI",154,0)
 ;                     
"RTN","LEXXGI",155,0)
NOTIFY ; Notify by Protocol - LEXICAL SERVICES UPDATE
"RTN","LEXXGI",156,0)
 D NOTIFY^LEXXGI2,KALL^LEXXGI2
"RTN","LEXXGI",157,0)
 Q
"RTN","LEXXGI",158,0)
SCHG ;   Save Change File Changes (for NOTIFY)
"RTN","LEXXGI",159,0)
 N FI,ID K LEXSCHG S LEXCHG=0
"RTN","LEXXGI",160,0)
 N FI S FI=0 F  S FI=$O(^LEXM(FI)) Q:+FI'>0  D
"RTN","LEXXGI",161,0)
 . S ID=$S(FI=80!(FI=80.1):"ICD",FI=81!(FI=81.1)!(FI=81.2)!(FI=81.3):"CPT",$P(FI,".",1)=757:"LEX",1:"UNK")
"RTN","LEXXGI",162,0)
 . S LEXSCHG(FI,0)=+($G(^LEXM(FI,0))),LEXSCHG("B",FI)="" S LEXSCHG("C",ID,FI)=""
"RTN","LEXXGI",163,0)
 S:$D(LEXSCHG("C","CPT"))!($D(LEXSCHG("C","ICD"))) LEXSCHG("D","PRO")=""
"RTN","LEXXGI",164,0)
 S:$D(^LEXM(80))!($D(^LEXM(80.1)))!($D(^LEXM(81)))!($D(^LEXM(81.2)))!($D(^LEXM(81.3)))!($D(LEXSCHG("D","PRO"))) LEXCHG=1,LEXSCHG(0)=1
"RTN","LEXXGI",165,0)
 Q
"RTN","LEXXGI",166,0)
ZTQ ; Taskman Quit
"RTN","LEXXGI",167,0)
 K ZTDESC,ZTDTH,ZTIO,ZTQUEUED,ZTREQ,ZTRTN,ZTSAVE,ZTSK
"RTN","LEXXGI",168,0)
 Q
"RTN","LEXXGI2")
0^4^B40689022
"RTN","LEXXGI2",1,0)
LEXXGI2 ; ISL/KER - Global Import (Update Change File w/^LEXM)  ; 02/22/2007
"RTN","LEXXGI2",2,0)
 ;;2.0;LEXICON UTILITY;**25,26,28,29,46,49**;Sep 23, 1996;Build 3
"RTN","LEXXGI2",3,0)
 ;             
"RTN","LEXXGI2",4,0)
 ; Global Variables
"RTN","LEXXGI2",5,0)
 ;   ^LEXM(
"RTN","LEXXGI2",6,0)
 ;   DBIA 10011  ^UTILITY($J
"RTN","LEXXGI2",7,0)
 ;             
"RTN","LEXXGI2",8,0)
 ; External References
"RTN","LEXXGI2",9,0)
 ;   DBIA 10011  ^DIWP
"RTN","LEXXGI2",10,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","LEXXGI2",11,0)
 ;   DBIA 10103  $$FMDIFF^XLFDT
"RTN","LEXXGI2",12,0)
 ;   DBIA 10141  BMES^XPDUTL
"RTN","LEXXGI2",13,0)
 ;   DBIA 10141  MES^XPDUTL
"RTN","LEXXGI2",14,0)
 ;             
"RTN","LEXXGI2",15,0)
 ; XPDNM   Newed by KIDS during Install
"RTN","LEXXGI2",16,0)
 Q
"RTN","LEXXGI2",17,0)
NOTIFY ; Notify by Protocol - LEXICAL SERVICES UPDATE
"RTN","LEXXGI2",18,0)
 ;     Uses LEXSCHG() from the Post-Install
"RTN","LEXXGI2",19,0)
 ;     Sets ^LEXM(0,"PRO")=$$NOW^XLFDT
"RTN","LEXXGI2",20,0)
 W !!,"NOTIFY^LEXXGI1",!
"RTN","LEXXGI2",21,0)
 N X,LEXU,LEXT,LEXF,LEXI,LEXL,LEX1,LEX2,LEX3,LEXN,LEXP,LEXUP D:$O(LEXSCHG(0))'>0 SCHG
"RTN","LEXXGI2",22,0)
 S LEXUP="" S:$D(LEXSCHG("C","ICD"))!($D(LEXSCHG(80)))!($D(LEXSCHG(80.1))) LEXUP=$G(LEXUP)_"ICD"
"RTN","LEXXGI2",23,0)
 S:$D(LEXSCHG("C","CPT"))!($D(LEXSCHG(81)))!($D(LEXSCHG(81.3))) LEXUP=$G(LEXUP)_"/CPT"
"RTN","LEXXGI2",24,0)
 S:$E(LEXUP,1)="/" LEXUP=$E(LEXUP,2,$L(LEXUP)) S:$L(LEXUP) LEXUP=LEXUP_" "
"RTN","LEXXGI2",25,0)
 S LEXI=756.999999 F  S LEXI=$O(LEXSCHG(LEXI)) Q:+LEXI'>0!($P(LEXI,".",1)'="757")  S LEXT=$G(LEXT)_", "_LEXI
"RTN","LEXXGI2",26,0)
 S LEXI=79.9990999 F  S LEXI=$O(LEXSCHG(LEXI)) Q:+LEXI'>0!($P(LEXI,".",1)'="80")  S LEXT=$G(LEXT)_", "_LEXI
"RTN","LEXXGI2",27,0)
 S LEXI=80.9990999 F  S LEXI=$O(LEXSCHG(LEXI)) Q:+LEXI'>0!($P(LEXI,".",1)'="81")  S LEXT=$G(LEXT)_", "_LEXI
"RTN","LEXXGI2",28,0)
 S:$E($G(LEXT),1,2)=", " LEXT=$E($G(LEXT),3,$L($G(LEXT))),LEXT=$$TRIM(LEXT)
"RTN","LEXXGI2",29,0)
 I $L(LEXT) D
"RTN","LEXXGI2",30,0)
 . S:$L(LEXT,", ")>1 LEXT=$P($G(LEXT),", ",1,($L($G(LEXT),", ")-1))_" and "_$P($G(LEXT),", ",$L($G(LEXT),", "))
"RTN","LEXXGI2",31,0)
 S:$P($O(LEXSCHG(756.999999)),".",1)="757" LEXF="Lexicon" S:$P($O(LEXSCHG(79.999999)),".",1)=80 LEXF=$G(LEXF)_", ICD"
"RTN","LEXXGI2",32,0)
 S:$P($O(LEXSCHG(80.999999)),".",1)=81 LEXF=$G(LEXF)_", CPT"
"RTN","LEXXGI2",33,0)
 S:$E($G(LEXF),1,2)=", " LEXF=$E($G(LEXF),3,$L($G(LEXF))),LEXF=$$TRIM(LEXF)
"RTN","LEXXGI2",34,0)
 I $L(LEXF) D
"RTN","LEXXGI2",35,0)
 . S:$L(LEXF,", ")>1 LEXF=$P($G(LEXF),", ",1,($L($G(LEXF),", ")-1))_" and "_$P($G(LEXF),", ",$L($G(LEXF),", "))
"RTN","LEXXGI2",36,0)
 . S:$L($P(LEXF,", ",1)) LEXF=$G(LEXF)_" File"_$S(LEXF[", ":"s",LEXF[" and ":"s",1:"")_" Updated"
"RTN","LEXXGI2",37,0)
 S LEXL=78-($L(LEXF)+4),LEXU="Lexical Files Updated" I $L(LEXT)&($L(LEXF))&(LEXL>30) D
"RTN","LEXXGI2",38,0)
 . S LEXU=LEXF N LEX S LEX=LEXT K LEXT S LEXT(1)=LEX D WP(.LEXT,LEXL)
"RTN","LEXXGI2",39,0)
 S LEXP=+($O(^ORD(101,"B","LEXICAL SERVICES UPDATE",0))) Q:LEXP=0  S X=LEXP_";ORD(101," D EN^XQOR S:'$D(LEXSCHG) ^LEXM(0,"PRO")=$$NOW^XLFDT
"RTN","LEXXGI2",40,0)
 Q:+($G(^LEXM(0,"PRO")))'>0
"RTN","LEXXGI2",41,0)
 I $L($G(LEXU)) D
"RTN","LEXXGI2",42,0)
 . N LEXI S LEXI=$L($G(LEXU))+3
"RTN","LEXXGI2",43,0)
 . S X=$G(LEXU) D:$O(LEXT(0))'>0 BL,TL(X),BL I $O(LEXT(0))>0 D
"RTN","LEXXGI2",44,0)
 . . D BL S X=$G(LEXU)_":  " N LEX S LEX=0 F  S LEX=$O(LEXT(LEX)) Q:+LEX'>0  D
"RTN","LEXXGI2",45,0)
 . . . N LEXX S LEXX=$$TRIM($G(LEXT(LEX))) S:$L(LEXX) X=X_LEXX D TL(X) S X="",$P(X," ",+LEXI)=" "
"RTN","LEXXGI2",46,0)
 . . D BL
"RTN","LEXXGI2",47,0)
 S X="Protocol 'LEXICAL SERVICES UPDATE' was invoked" D TL(X)
"RTN","LEXXGI2",48,0)
 S X="Subscribing applications were notified of the "_LEXUP_"update" D TL(X),BL
"RTN","LEXXGI2",49,0)
 Q
"RTN","LEXXGI2",50,0)
UPCHG ;
"RTN","LEXXGI2",51,0)
 Q:+LEXFI'>0  N LEXID S LEXID=$S($P(LEXFI,".",1)="757":"LEX",$P(LEXFI,".",1)="80":"ICD",$P(LEXFI,".",1)="81":"CPT",1:"UNK")
"RTN","LEXXGI2",52,0)
 I $D(LEXSCHG) S LEXSCHG(LEXFI,0)="",LEXSCHG("B",LEXFI)="",LEXSCHG("C",LEXID,LEXFI)=""
"RTN","LEXXGI2",53,0)
 Q
"RTN","LEXXGI2",54,0)
SCHG ; Change Array LEXSCHG (Some or all, but never nothing)
"RTN","LEXXGI2",55,0)
 N FI,ID K LEXSCHG S LEXCHG=0
"RTN","LEXXGI2",56,0)
 N FI S FI=0 F  S FI=$O(^LEXM(FI)) Q:+FI'>0  D
"RTN","LEXXGI2",57,0)
 . S ID=$S(FI=80!(FI=80.1):"ICD",FI=81!(FI=81.1)!(FI=81.2)!(FI=81.3):"CPT",$P(FI,".",1)=757:"LEX",1:"UNK")
"RTN","LEXXGI2",58,0)
 . S LEXSCHG(FI,0)=+($G(^LEXM(FI,0))),LEXSCHG("B",FI)="" S LEXSCHG("C",ID,FI)=""
"RTN","LEXXGI2",59,0)
 S:$D(LEXSCHG("C","CPT"))!($D(LEXSCHG("C","ICD"))) LEXSCHG("D","PRO")=""
"RTN","LEXXGI2",60,0)
 S:$D(^LEXM(80))!($D(^LEXM(80.1)))!($D(^LEXM(81)))!($D(^LEXM(81.2)))!($D(^LEXM(81.3)))!($D(LEXSCHG("D","PRO"))) LEXCHG=1,LEXSCHG(0)=1
"RTN","LEXXGI2",61,0)
 D:$O(LEXSCHG(0))'>0 SALL S:$D(LEXSCHG("C","CPT"))!($D(LEXSCHG("C","ICD"))) LEXSCHG("D","PRO")=""
"RTN","LEXXGI2",62,0)
 Q
"RTN","LEXXGI2",63,0)
SALL ;   Set All (ICD/CPT/Lexicon)
"RTN","LEXXGI2",64,0)
 D SICD,SCPT,SLEX
"RTN","LEXXGI2",65,0)
 Q
"RTN","LEXXGI2",66,0)
SICD ;   Set ICD
"RTN","LEXXGI2",67,0)
 S (LEXSCHG("80",0),LEXSCHG("B","80"),LEXSCHG("C","ICD","80"))="",(LEXSCHG("80.1",0),LEXSCHG("B","80.1"),LEXSCHG("C","ICD","80.1"))="" D SLEX
"RTN","LEXXGI2",68,0)
 Q
"RTN","LEXXGI2",69,0)
SCPT ;   Set CPT
"RTN","LEXXGI2",70,0)
 S (LEXSCHG("81",0),LEXSCHG("B","81"),LEXSCHG("C","CPT","81"))="",(LEXSCHG("81.1",0),LEXSCHG("B","81.1"),LEXSCHG("C","CPT","81.1"))=""
"RTN","LEXXGI2",71,0)
 S (LEXSCHG("81.2",0),LEXSCHG("B","81.2"),LEXSCHG("C","CPT","81.2"))="",(LEXSCHG("81.3",0),LEXSCHG("B","81.3"),LEXSCHG("C","CPT","81.3"))="" D SLEX
"RTN","LEXXGI2",72,0)
 Q
"RTN","LEXXGI2",73,0)
SLEX ;   Set Lexicon
"RTN","LEXXGI2",74,0)
 S (LEXSCHG("757",0),LEXSCHG("B","757"),LEXSCHG("C","LEX","757"))="",(LEXSCHG("757.001",0),LEXSCHG("B","757.001"),LEXSCHG("C","LEX","757.001"))=""
"RTN","LEXXGI2",75,0)
 S (LEXSCHG("757.01",0),LEXSCHG("B","757.01"),LEXSCHG("C","LEX","757.01"))="",(LEXSCHG("757.02",0),LEXSCHG("B","757.02"),LEXSCHG("C","LEX","757.02"))=""
"RTN","LEXXGI2",76,0)
 S (LEXSCHG("757.1",0),LEXSCHG("B","757.1"),LEXSCHG("C","LEX","757.1"))=""
"RTN","LEXXGI2",77,0)
 Q
"RTN","LEXXGI2",78,0)
 ; Miscellaneous
"RTN","LEXXGI2",79,0)
NF ;   Import Global Not Found
"RTN","LEXXGI2",80,0)
 D PB(" Import Global ^LEXM not found, consult the installation instructions")
"RTN","LEXXGI2",81,0)
 D TL(" to install this global")
"RTN","LEXXGI2",82,0)
 Q
"RTN","LEXXGI2",83,0)
IG ;   Invalid Import Global
"RTN","LEXXGI2",84,0)
 D PB(" Invalid Import Global ^LEXM, please consult the installation")
"RTN","LEXXGI2",85,0)
 D TL(" instructions to reload this global")
"RTN","LEXXGI2",86,0)
 Q
"RTN","LEXXGI2",87,0)
BL ;   Blank Line
"RTN","LEXXGI2",88,0)
 N X S X="" W:'$D(XPDNM) ! D:$D(XPDNM) MES^XPDUTL(X) Q
"RTN","LEXXGI2",89,0)
PB(X) ;   Preceeding Blank Line
"RTN","LEXXGI2",90,0)
 S X=$G(X) Q:'$L(X)  W:'$D(XPDNM) !!,X D:$D(XPDNM) BMES^XPDUTL(X) Q
"RTN","LEXXGI2",91,0)
TL(X) ;   Text Line
"RTN","LEXXGI2",92,0)
 S X=$G(X) Q:'$L(X)  W:'$D(XPDNM) !,X D:$D(XPDNM) MES^XPDUTL(X) Q
"RTN","LEXXGI2",93,0)
HACK(X) ;   Time
"RTN","LEXXGI2",94,0)
 S X=$$NOW^XLFDT Q X
"RTN","LEXXGI2",95,0)
ELAP(X1,X2) ;   Elapsed Time
"RTN","LEXXGI2",96,0)
 N X S X=$$FMDIFF^XLFDT(+($G(X2)),+($G(X1)),3)
"RTN","LEXXGI2",97,0)
 S:X="" X="00:00:00" S X=$TR(X," ","0") S X1=X Q X1
"RTN","LEXXGI2",98,0)
 Q
"RTN","LEXXGI2",99,0)
KLEXM ;   Subscripted Kill of ^LEXM - files only
"RTN","LEXXGI2",100,0)
 N LEX S LEX=0 F  S LEX=$O(^LEXM(LEX)) Q:+LEX'>0  K ^LEXM(LEX)
"RTN","LEXXGI2",101,0)
 Q
"RTN","LEXXGI2",102,0)
KALL ;   Subscripted Kill of ^LEXM - all
"RTN","LEXXGI2",103,0)
 K LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR,LEXB,LEXCD,LEXSTR,LEXLAST
"RTN","LEXXGI2",104,0)
 K %,%DT,C,D,D0,D1,D2,DG,DIC,DICR,DILOCKTM,DIW,IREC,J,XMDUN,XMZ,ZTSK N LEX
"RTN","LEXXGI2",105,0)
 S LEX=0 F  S LEX=$O(^LEXM(LEX)) Q:+LEX'>0  K ^LEXM(LEX)
"RTN","LEXXGI2",106,0)
 K ^LEXM(0)
"RTN","LEXXGI2",107,0)
 Q
"RTN","LEXXGI2",108,0)
 ;   Error Text
"RTN","LEXXGI2",109,0)
ET(X) ;     Save Text
"RTN","LEXXGI2",110,0)
 N LEXI S LEXI=+($G(LEXE(0))),LEXI=LEXI+1,LEXE(LEXI)=$G(X),LEXE(0)=LEXI Q
"RTN","LEXXGI2",111,0)
ED ;     Display Text
"RTN","LEXXGI2",112,0)
 N LEXI S LEXI=0 F  S LEXI=$O(LEXE(LEXI)) Q:+LEXI=0  W !,LEXE(LEXI)
"RTN","LEXXGI2",113,0)
 W ! K LEXE
"RTN","LEXXGI2",114,0)
 Q
"RTN","LEXXGI2",115,0)
 ;   Case
"RTN","LEXXGI2",116,0)
MIX(X) ;     Mixed Case
"RTN","LEXXGI2",117,0)
 S X=$G(X) N LEXT,LEXI S LEXT=""
"RTN","LEXXGI2",118,0)
 F LEXI=1:1:$L(X," ") S LEXT=LEXT_" "_$$UP($E($P(X," ",LEXI),1))_$$LO($E($P(X," ",LEXI),2,$L($P(X," ",LEXI))))
"RTN","LEXXGI2",119,0)
 F  Q:$E(LEXT,1)'=" "  S LEXT=$E(LEXT,2,$L(LEXT))
"RTN","LEXXGI2",120,0)
 S:$E(LEXT,1,3)="Cpt" LEXT="CPT"_$E(LEXT,4,$L(LEXT)) S:$E(LEXT,1,3)="Icd" LEXT="ICD"_$E(LEXT,4,$L(LEXT)) S X=LEXT
"RTN","LEXXGI2",121,0)
 Q X
"RTN","LEXXGI2",122,0)
UP(X) ;     Uppercase
"RTN","LEXXGI2",123,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","LEXXGI2",124,0)
LO(X) ;     Lowercase
"RTN","LEXXGI2",125,0)
 Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","LEXXGI2",126,0)
WP(LEX,L) ;   Wrap Text LEX with Length L
"RTN","LEXXGI2",127,0)
 K ^UTILITY($J,"W") N %,CT,DA,DIC,DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,DTOUT,DUOUT,LENGTH,TI,X,Z,END,I
"RTN","LEXXGI2",128,0)
 S TI=0,LENGTH=+($G(L)) F  S TI=$O(LEX(TI)) Q:+TI'>0  D
"RTN","LEXXGI2",129,0)
 . N X,DIWX,DN,DTOUT,DUOUT S X=$G(LEX(TI)),DIWL=1,DIWF="C78" S:+($G(LENGTH))>0 DIWF="C"_+($G(LENGTH)) D ^DIWP
"RTN","LEXXGI2",130,0)
 K LEX S (CT,I)=0 F  S I=$O(^UTILITY($J,"W",1,I)) Q:+I=0  D
"RTN","LEXXGI2",131,0)
 . S X=$G(^UTILITY($J,"W",1,I,0)),CT=CT+1,LEX(CT)=$$TRIM(X)
"RTN","LEXXGI2",132,0)
 K ^UTILITY($J,"W")
"RTN","LEXXGI2",133,0)
 Q
"RTN","LEXXGI2",134,0)
TRIM(X) ;   Trim Spaces
"RTN","LEXXGI2",135,0)
 S X=$G(X) Q:X="" X F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","LEXXGI2",136,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","LEXXGI2",137,0)
 F  Q:X'["  "  S X=$P(X,"  ",1)_" "_$P(X,"  ",2,229)
"RTN","LEXXGI2",138,0)
 Q X
"RTN","LEXXII")
0^11^B33731148
"RTN","LEXXII",1,0)
LEXXII ; ISL/KER - Lexicon Status (Install Info) ; 01/01/2007
"RTN","LEXXII",2,0)
 ;;2.0;LEXICON UTILITY;**32,46,49**;Sep 23, 1996;Build 3
"RTN","LEXXII",3,0)
 ;             
"RTN","LEXXII",4,0)
 ; Global Variables
"RTN","LEXXII",5,0)
 ;   DBIA 10096  ^%ZOSF("PROD"
"RTN","LEXXII",6,0)
 ;   DBIA 10096  ^%ZOSF("UCI"
"RTN","LEXXII",7,0)
 ;   DBIA 10060  ^VA(200
"RTN","LEXXII",8,0)
 ;   ^LEXM(0
"RTN","LEXXII",9,0)
 ;   ^TMP("LEX*",$J    SACC 2.3.2.5.1 
"RTN","LEXXII",10,0)
 ;             
"RTN","LEXXII",11,0)
 ; External References
"RTN","LEXXII",12,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","LEXXII",13,0)
 ;   DBIA 10103  $$NOW^XLFDT
"RTN","LEXXII",14,0)
 ;   DBIA 10103  $$FMDIFF^XLFDT
"RTN","LEXXII",15,0)
 ;   DBIA  2056  $$GET1^DIQ (file #200)
"RTN","LEXXII",16,0)
 ;   DBIA  2051  FIND^DIC
"RTN","LEXXII",17,0)
 ;   DBIA  2056  GETS^DIQ
"RTN","LEXXII",18,0)
 ;             
"RTN","LEXXII",19,0)
 ; LEXCRE   Newed in LEXXGI
"RTN","LEXXII",20,0)
 ; LEXID    Newed in LEXXFI
"RTN","LEXXII",21,0)
 ; LEXIGHF  Newed in Post-Install LEX20nnP
"RTN","LEXXII",22,0)
 ;            
"RTN","LEXXII",23,0)
EN ; Main Entry
"RTN","LEXXII",24,0)
 N LEXSUB S LEXSUB=$G(LEXID) S:LEXSUB="" LEXSUB="LEXXII" K ^TMP(LEXSUB,$J) D II
"RTN","LEXXII",25,0)
 Q
"RTN","LEXXII",26,0)
 ;                               
"RTN","LEXXII",27,0)
II ; Install Information
"RTN","LEXXII",28,0)
 N LEXT,LEXA,LEXACT,LEXB,LEXD,LEXE,LEXL,LEXU,LEXN,LEXP,LEXPRO,LEXPRON,LEXPROF,LEXDA H 2
"RTN","LEXXII",29,0)
 S LEXA="",LEXACT=$G(LEXACCT),LEXPRON="LEXICAL SERVICES UPDATE",LEXPRO=$G(^LEXM(0,"PRO")) S:+LEXPRO>0 LEXPRO=$$ED(LEXPRO),LEXPROF=1
"RTN","LEXXII",30,0)
 S LEXT="Lexicon/ICD/CPT Installation" D TL(LEXT)
"RTN","LEXXII",31,0)
 S LEXT="============================" D TL(LEXT),BL
"RTN","LEXXII",32,0)
 S LEXD=$$ASOF,LEXA=$$UCI,LEXU=$$USR,LEXN=$P(LEXU,"^",1)
"RTN","LEXXII",33,0)
 S:$L($P(LEXACT,"^",1))&($L($P(LEXACT,"^",1))) LEXA=LEXACT
"RTN","LEXXII",34,0)
 S LEXP=$P(LEXU,"^",2),LEXN=$$PM^LEXXFI7(LEXN)
"RTN","LEXXII",35,0)
 S:$L(LEXD) LEXT="  As of:       "_LEXD
"RTN","LEXXII",36,0)
 D:$L(LEXD) TL(LEXT)
"RTN","LEXXII",37,0)
 S LEXT="" S:$L(LEXA) LEXT="  In Account:  "_$S($L($P(LEXA,"^",1)):"[",1:"")_$P(LEXA,"^",1)_$S($L($P(LEXA,"^",2)):"]",1:"")
"RTN","LEXXII",38,0)
 S:$L(LEXT)&($L($P(LEXA,"^",2))) LEXT=LEXT_"  "_$P(LEXA,"^",2)
"RTN","LEXXII",39,0)
 D:$L(LEXA) TL(LEXT)
"RTN","LEXXII",40,0)
 S LEXT="" S:$L(LEXU) LEXT="  Maint By:    "
"RTN","LEXXII",41,0)
 S:$L(LEXN) LEXT=LEXT_LEXN
"RTN","LEXXII",42,0)
 S:$L(LEXP)&($L(LEXN)) LEXT=LEXT_"   "_LEXP
"RTN","LEXXII",43,0)
 D:$L(LEXT)&(LEXT'["UNKNOWN") TL(LEXT)
"RTN","LEXXII",44,0)
 S LEXT="" S:$L($G(LEXBUILD)) LEXT="  Build:       "_$G(LEXBUILD)
"RTN","LEXXII",45,0)
 D:$L(LEXT) TL(LEXT)
"RTN","LEXXII",46,0)
 S LEXT="" S:$L($G(LEXIGHF)) LEXT="  Host File:   "_$G(LEXIGHF)
"RTN","LEXXII",47,0)
 S:$L(LEXT)&($L($G(LEXCRE)))&($P($G(LEXCRE),".",1)?7N) LEXT=LEXT_" (Created "_$$ED($G(LEXCRE))_")"
"RTN","LEXXII",48,0)
 S:'$L(LEXT)&($L($G(LEXCRE)))&($P($G(LEXCRE),".",1)?7N) LEXT="  Created:     "_$$ED($G(LEXCRE))
"RTN","LEXXII",49,0)
 D:$L(LEXT) TL(LEXT)
"RTN","LEXXII",50,0)
 S LEXT="" I $L($G(LEXPRO))&($L($G(LEXPRON)))&(+($G(LEXPROF))>0) D
"RTN","LEXXII",51,0)
 . S LEXT="  Protocol:    "_LEXPRON D BL,TL(LEXT)
"RTN","LEXXII",52,0)
 . S LEXT="  Invoked:     "_LEXPRO D TL(LEXT)
"RTN","LEXXII",53,0)
 S LEXB=$$SS($G(LEXBUILD)),LEXE=$P(LEXB,"^",2),LEXL=$P(LEXB,"^",3),LEXB=$P(LEXB,"^",1)
"RTN","LEXXII",54,0)
 I $P(LEXB,".",1)?7N!($P(LEXB,".",2)?7N)!($P(LEXB,".",3)[":") D
"RTN","LEXXII",55,0)
 . D BL
"RTN","LEXXII",56,0)
 . I $P(LEXB,".",1)?7N D
"RTN","LEXXII",57,0)
 . . S LEXT="" S LEXT="  Started:     "_$$ED($G(LEXB)) D TL(LEXT)
"RTN","LEXXII",58,0)
 . I $P(LEXE,".",1)?7N D
"RTN","LEXXII",59,0)
 . . S LEXT="" S LEXT="  Finished:    "_$$ED($G(LEXE)) D TL(LEXT)
"RTN","LEXXII",60,0)
 . I $L(LEXL) D
"RTN","LEXXII",61,0)
 . . S LEXT="" S LEXT="  Elapsed:     "_$$ED($G(LEXL)) D TL(LEXT)
"RTN","LEXXII",62,0)
 D BL
"RTN","LEXXII",63,0)
 Q
"RTN","LEXXII",64,0)
 ;                             
"RTN","LEXXII",65,0)
 ; Miscellaneous
"RTN","LEXXII",66,0)
UCI(X) ;   UCI where Lexicon is installed
"RTN","LEXXII",67,0)
 N LEXU,LEXP,LEXT,Y X ^%ZOSF("UCI") S LEXU=Y,LEXP="" S:LEXU=^%ZOSF("PROD")!($P(LEXU,",",1)=^%ZOSF("PROD")) LEXP=" (Production)"
"RTN","LEXXII",68,0)
 S:LEXU'=^%ZOSF("PROD")&($P(LEXU,",",1)'=^%ZOSF("PROD")) LEXP=" (Test)" S X="",$P(X,"^",1)=LEXU,$P(X,"^",2)=LEXP
"RTN","LEXXII",69,0)
 Q X
"RTN","LEXXII",70,0)
USR(LEX) ;   User/Person
"RTN","LEXXII",71,0)
 N LEXDUZ,LEXPH,LEXNM
"RTN","LEXXII",72,0)
 S LEX=+($G(DUZ)),LEXNM=$$GET1^DIQ(200,+LEX,.01) Q:'$L(LEXNM) "UNKNOWN^"
"RTN","LEXXII",73,0)
 S LEXDUZ=LEX S LEXPH=$$GET1^DIQ(200,+LEXDUZ,.132) S:LEXPH="" LEXPH=$$GET1^DIQ(200,+LEXDUZ,.131)
"RTN","LEXXII",74,0)
 S:LEXPH="" LEXPH=$$GET1^DIQ(200,+LEXDUZ,.133) S:LEXPH="" LEXPH=$$GET1^DIQ(200,+LEXDUZ,.134)
"RTN","LEXXII",75,0)
 S LEXDUZ=$$GET1^DIQ(200,+LEX,.01),LEX=LEXDUZ_"^"_LEXPH Q LEX
"RTN","LEXXII",76,0)
SS(LEX) ;   Start/Stop Times
"RTN","LEXXII",77,0)
 N LEXDA,LEXOUT,LEXIENS,LEXB,LEXBUILD,LEXB,LEXE,LEXL
"RTN","LEXXII",78,0)
 S LEXBUILD=$G(LEX),LEXD=0 S:$L(LEXBUILD) LEXD=$$DDA(LEXBUILD)
"RTN","LEXXII",79,0)
 S LEXDA=+($G(XPDA))
"RTN","LEXXII",80,0)
 I +LEXDA>0 D
"RTN","LEXXII",81,0)
 . S LEXIENS=LEXDA_","
"RTN","LEXXII",82,0)
 . D GETS^DIQ(9.7,LEXIENS,"11;17","I","LEXOUT")
"RTN","LEXXII",83,0)
 . S LEXL=0,LEXB=$G(LEXOUT(9.7,LEXIENS,11,"I"))
"RTN","LEXXII",84,0)
 . S LEXE=$G(LEXOUT(9.7,LEXIENS,17,"I"))
"RTN","LEXXII",85,0)
 . S:+LEXE'>0 LEXE=$$NOW^XLFDT
"RTN","LEXXII",86,0)
 . S:+LEXB>0&(+LEXE>0) LEXL=$$EP(LEXB,LEXE)
"RTN","LEXXII",87,0)
 . S LEX=LEXB_"^"_LEXE S:$L(LEXL) $P(LEX,"^",3)=LEXL
"RTN","LEXXII",88,0)
 I +LEXDA=0 D
"RTN","LEXXII",89,0)
 . S LEX="" S LEXDA=+($G(LEXD)) Q:+LEXDA'>0
"RTN","LEXXII",90,0)
 . S LEXL="",LEXB=$P($G(LEXD),"^",2) Q:$P(LEXB,".",1)'?7N
"RTN","LEXXII",91,0)
 . S LEXE=$P($G(LEXD),"^",3) Q:$P(LEXE,".",1)'?7N
"RTN","LEXXII",92,0)
 . S:+LEXB>0&(+LEXE>0) LEXL=$$EP(LEXB,LEXE)
"RTN","LEXXII",93,0)
 . S LEX=LEXB_"^"_LEXE S:$L(LEXL) $P(LEX,"^",3)=LEXL
"RTN","LEXXII",94,0)
 Q LEX
"RTN","LEXXII",95,0)
DDA(LEX) ;   Get Default DA of Build LEX
"RTN","LEXXII",96,0)
 N LEXB,LEXE,LEXOUT,LEXMSG,LEXI S LEXB=$G(LEX) Q:'$L(LEXB) ""
"RTN","LEXXII",97,0)
 D FIND^DIC(9.7,,"11I;17I","BP",LEXB,,"B",,,"LEXOUT","LEXMSG")
"RTN","LEXXII",98,0)
 S LEXI=+($O(LEXOUT("DILIST"," "),-1))
"RTN","LEXXII",99,0)
 S LEXB=$G(LEXOUT("DILIST",+LEXI,0))
"RTN","LEXXII",100,0)
 S LEXI=$P(LEXB,"^",1),LEXE=$P(LEXB,"^",4),LEXB=$P(LEXB,"^",3)
"RTN","LEXXII",101,0)
 Q:+($G(LEXI))'>0 ""  Q:+($G(LEXB))'>0 ""  S:+LEXE'>0 LEXE=$$NOW^XLFDT
"RTN","LEXXII",102,0)
 S LEX=LEXI_"^"_LEXB_"^"_LEXE
"RTN","LEXXII",103,0)
 Q LEX
"RTN","LEXXII",104,0)
ASOF(LEX) ;   As of date/time
"RTN","LEXXII",105,0)
 S X=$$ED($$NOW^XLFDT) Q X
"RTN","LEXXII",106,0)
ED(LEX) ;   External Date MM/DD/YYYY TT:TT
"RTN","LEXXII",107,0)
 S LEX=$$FMTE^XLFDT($G(LEX),"1Z")
"RTN","LEXXII",108,0)
 S:LEX["@" LEX=$P(LEX,"@",1)_"  "_$P(LEX,"@",2,299) Q LEX
"RTN","LEXXII",109,0)
 Q LEX
"RTN","LEXXII",110,0)
EP(X,Y) ;   Elapsed Time (Begin, End)
"RTN","LEXXII",111,0)
 N LEXTIM,LEXBEG,LEXEND
"RTN","LEXXII",112,0)
 S LEXBEG=$G(X),LEXEND=$G(Y) Q:+LEXBEG'>0 ""  Q:+LEXEND'>0 ""
"RTN","LEXXII",113,0)
 S LEXTIM=$$FMDIFF^XLFDT(LEXEND,LEXBEG,2) Q:+LEXTIM'>0 "00:00:00"
"RTN","LEXXII",114,0)
 S LEXTIM=$$TIM(LEXTIM)
"RTN","LEXXII",115,0)
 Q LEXTIM
"RTN","LEXXII",116,0)
TIM(X) ;   Format Time Elapsed
"RTN","LEXXII",117,0)
 N LEXD,LEXH,LEXM,LEXS,LEXT,LEXV S X=+($G(X)) Q:X'>0 "00:00:00"
"RTN","LEXXII",118,0)
 S LEXD=X\86400 S LEXV=LEXD*86400 S:+LEXV>0&(LEXV<X) X=X-LEXV
"RTN","LEXXII",119,0)
 S LEXH=X\3600 S LEXV=LEXH*3600 S:+LEXV>0&(LEXV<X) X=X-LEXV
"RTN","LEXXII",120,0)
 S:$L(LEXH)<2 LEXH="0"_LEXH S:$L(LEXH)<2 LEXH="0"_LEXH
"RTN","LEXXII",121,0)
 S LEXM=X\60 S LEXV=LEXM*60 S:+LEXV>0&(LEXV<X) X=X-LEXV
"RTN","LEXXII",122,0)
 S:$L(LEXM)<2 LEXM="0"_LEXM S:$L(LEXM)<2 LEXM="0"_LEXM
"RTN","LEXXII",123,0)
 S LEXS=X S:$L(LEXS)<2 LEXS="0"_LEXS S:$L(LEXS)<2 LEXS="0"_LEXS
"RTN","LEXXII",124,0)
 S LEXT="" S:+LEXD>0 LEXT=+LEXD_" day"_$S(+LEXD>1:"s",1:"")_" "
"RTN","LEXXII",125,0)
 S LEXT=LEXT_LEXH_":"_LEXM_":"_LEXS,X=LEXT
"RTN","LEXXII",126,0)
 Q X
"RTN","LEXXII",127,0)
BL ;   Blank Line
"RTN","LEXXII",128,0)
 D TL("") Q
"RTN","LEXXII",129,0)
TL(LEXX) ;   Text Line
"RTN","LEXXII",130,0)
 S LEXSUB=$G(LEXSUB) S:'$L(LEXSUB) LEXSUB="LEXXII"
"RTN","LEXXII",131,0)
 I '$D(^TMP(LEXSUB,$J,1)) S ^TMP(LEXSUB,$J,1)=" ",^TMP(LEXSUB,$J,0)=1
"RTN","LEXXII",132,0)
 N LEXNX S LEXNX=$O(^TMP(LEXSUB,$J," "),-1),LEXNX=LEXNX+1
"RTN","LEXXII",133,0)
 S ^TMP(LEXSUB,$J,LEXNX)=" "_$G(LEXX),^TMP(LEXSUB,$J,0)=LEXNX
"RTN","LEXXII",134,0)
 Q
"RTN","LEXXII",135,0)
ST ;   Show Temp Array
"RTN","LEXXII",136,0)
 S LEXSUB=$G(LEXSUB) S:'$L(LEXSUB) LEXSUB="LEXXII"
"RTN","LEXXII",137,0)
 N LEXN,LEXC S LEXN="^TMP("""_LEXSUB_""","_$J_")",LEXC="^TMP("""_LEXSUB_""","_$J_","
"RTN","LEXXII",138,0)
 F  S LEXN=$Q(@LEXN) Q:LEXN=""!(LEXN'[LEXC)  D
"RTN","LEXXII",139,0)
 . Q:LEXN[",0)"  W !,@LEXN
"RTN","LEXXII",140,0)
 Q
"RTN","LEXXST")
0^5^B68105086
"RTN","LEXXST",1,0)
LEXXST ; ISL/KER - Lexicon Status (Main/Files) ; 02/22/2007
"RTN","LEXXST",2,0)
 ;;2.0;LEXICON UTILITY;**4,5,8,25,27,49**;Sep 23, 1996;Build 3
"RTN","LEXXST",3,0)
 ;            
"RTN","LEXXST",4,0)
 ; External References
"RTN","LEXXST",5,0)
 ;   DBIA 10096  ^%ZOSF("PROD"
"RTN","LEXXST",6,0)
 ;   DBIA 10096  ^%ZOSF("UCI"
"RTN","LEXXST",7,0)
 ;   DBIA 10060  ^VA(200 
"RTN","LEXXST",8,0)
 ;   DBIA 10000  NOW^%DTC
"RTN","LEXXST",9,0)
 ;   DBIA 10086  ^%ZIS   
"RTN","LEXXST",10,0)
 ;   DBIA 10086  HOME^%ZIS
"RTN","LEXXST",11,0)
 ;   DBIA 10089  ^%ZISC  
"RTN","LEXXST",12,0)
 ;   DBIA 10063  ^%ZTLOAD
"RTN","LEXXST",13,0)
 ;   DBIA  2052  FILE^DID
"RTN","LEXXST",14,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","LEXXST",15,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","LEXXST",16,0)
 ;   DBIA 10070  ^XMD
"RTN","LEXXST",17,0)
 ;                         
"RTN","LEXXST",18,0)
DISP ; Display Status only
"RTN","LEXXST",19,0)
 K ^TMP($J,"LEXINFO"),LEXMAIL,LEXAO N X,Y,LEXM,LEXY
"RTN","LEXXST",20,0)
 D DATA,SHOW Q
"RTN","LEXXST",21,0)
SEND ; Send Status to G.LEXINS@ISC-SLC.VA.GOV
"RTN","LEXXST",22,0)
 K ^TMP($J,"LEXINFO") N X,Y,LEXM,LEXY
"RTN","LEXXST",23,0)
 S:$L($G(LEXBUILD)) ZTSAVE("LEXBUILD")=""
"RTN","LEXXST",24,0)
 S:$D(LEXSHORT) ZTSAVE("LEXSHORT")=""
"RTN","LEXXST",25,0)
 S ZTRTN="SENDTO^LEXXST",ZTDESC="Lexicon Status Report Msg [LEXXST]",ZTIO="",ZTDTH=$H
"RTN","LEXXST",26,0)
 D ^%ZTLOAD
"RTN","LEXXST",27,0)
 D HOME^%ZIS K Y,ZTSK,ZTDESC,ZTDTH,ZTIO,ZTSAVE,ZTRTN
"RTN","LEXXST",28,0)
 Q
"RTN","LEXXST",29,0)
SENDTO ; Send Status (Tasked)
"RTN","LEXXST",30,0)
 N LEXMAIL,LEXAO S (LEXMAIL,LEXAO)="" S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEXXST",31,0)
 D:'$D(LEXSHORT) N0 D DATA,SHOW Q
"RTN","LEXXST",32,0)
DATA ; Get Data
"RTN","LEXXST",33,0)
 D TITLE Q:$D(LEXSHORT)
"RTN","LEXXST",34,0)
 D FILES,PT^LEXXST2,RTT^LEXXST2
"RTN","LEXXST",35,0)
 D KIDS^LEXXST3,RTN^LEXXST3
"RTN","LEXXST",36,0)
 Q
"RTN","LEXXST",37,0)
TITLE ; Title of display/message
"RTN","LEXXST",38,0)
 N LEXT,LEXA,LEXD,LEXU,LEXN,LEXP
"RTN","LEXXST",39,0)
 S LEXT="LEXICON UTILITY STATUS",LEXD=$$A,LEXA=$$U
"RTN","LEXXST",40,0)
 S LEXU=$$P,LEXN=$P(LEXU,"^",1),LEXP=$P(LEXU,"^",2)
"RTN","LEXXST",41,0)
 I $D(LEXAO) D  Q
"RTN","LEXXST",42,0)
 . D:$L(LEXT) TT(LEXT),BL S:$L(LEXD) LEXT="  AS OF:       "_LEXD D:$L(LEXD) TL(LEXT) S LEXT="" S:$L(LEXA) LEXT="  IN ACCOUNT:  "_$S($L($P(LEXA,"^",1)):"[",1:"")_$P(LEXA,"^",1)_$S($L($P(LEXA,"^",2)):"]",1:"")
"RTN","LEXXST",43,0)
 . S:$L(LEXT)&($L($P(LEXA,"^",2))) LEXT=LEXT_"  "_$P(LEXA,"^",2) D:$L(LEXA) TL(LEXT)
"RTN","LEXXST",44,0)
 . S LEXT="" S:$L(LEXU) LEXT="  MAINT BY:    " S:$L(LEXN) LEXT=LEXT_LEXN S:$L(LEXP)&($L(LEXN)) LEXT=LEXT_"   "_LEXP D:$L(LEXT) TL(LEXT)
"RTN","LEXXST",45,0)
 . S LEXT="" S:$L($G(LEXBUILD)) LEXT="  BUILD:       "_$G(LEXBUILD)
"RTN","LEXXST",46,0)
 . D:$L(LEXT) TL(LEXT) D BL
"RTN","LEXXST",47,0)
 I '$D(LEXAO) D  Q
"RTN","LEXXST",48,0)
 . D:$L(LEXT) TT(LEXT),BL S:$L(LEXD) LEXT="  AS OF:       "_LEXD D:$L(LEXD) TL(LEXT) S LEXT="" S:$L(LEXA) LEXT="  IN ACCOUNT:  "_$S($L($P(LEXA,"^",1)):"[",1:"")_$P(LEXA,"^",1)_$S($L($P(LEXA,"^",2)):"]",1:"")
"RTN","LEXXST",49,0)
 . S:$L(LEXT)&($L($P(LEXA,"^",2))) LEXT=LEXT_"  "_$P(LEXA,"^",2) D:$L(LEXA) TL(LEXT) D BL
"RTN","LEXXST",50,0)
 Q
"RTN","LEXXST",51,0)
U(X) ;   UCI where Lexicon is installed
"RTN","LEXXST",52,0)
 N LEXU,LEXP,LEXT,Y X ^%ZOSF("UCI") S LEXU=Y,LEXP=""
"RTN","LEXXST",53,0)
 S:LEXU=^%ZOSF("PROD")!($P(LEXU,",",1)=^%ZOSF("PROD")) LEXP=" (Production)"
"RTN","LEXXST",54,0)
 S:LEXU'=^%ZOSF("PROD")&($P(LEXU,",",1)'=^%ZOSF("PROD")) LEXP=" (Test)"
"RTN","LEXXST",55,0)
 S X="",$P(X,"^",1)=LEXU,$P(X,"^",2)=LEXP
"RTN","LEXXST",56,0)
 Q X
"RTN","LEXXST",57,0)
FILES ; File version/contents
"RTN","LEXXST",58,0)
 N LEXCT,LEXT,LEXSP,LEXFI,LEXX,LEXGL,LEXNM,LEXVR,LEXLR,LEXTR,LEXRLR
"RTN","LEXXST",59,0)
 N LEXDDA,LEXPRD,LEXRN,LEXRD,LEXFCT
"RTN","LEXXST",60,0)
 S LEXFI=756.999999,LEXCT=0,LEXSP="                           ",LEXFCT=$$FC
"RTN","LEXXST",61,0)
 S LEXT="     FILE     NAME                   VER  REV     DATE      LAST IEN    RECORDS"
"RTN","LEXXST",62,0)
 D BL,TT("FILE VERSIONS/REVISIONS"),BL,TL(LEXT),BK1
"RTN","LEXXST",63,0)
 D:+LEXFCT'>0 BL,TL("       NO FILES FOUND") Q:+LEXFCT'>0
"RTN","LEXXST",64,0)
 S LEXFI=756.999999 F  S LEXFI=$O(^LEX(LEXFI)) Q:+LEXFI=0!($E(LEXFI,1,3)'="757")  D FL
"RTN","LEXXST",65,0)
 S LEXFI=756.999999 F  S LEXFI=$O(^LEXT(LEXFI)) Q:+LEXFI=0!($E(LEXFI,1,3)'="757")  D FL
"RTN","LEXXST",66,0)
 S LEXFI=756.999999 F  S LEXFI=$O(^LEXC(LEXFI)) Q:+LEXFI=0!($E(LEXFI,1,3)'="757")  D FL
"RTN","LEXXST",67,0)
 F LEXFI=80,80.1,81,81.3 D FL
"RTN","LEXXST",68,0)
 Q
"RTN","LEXXST",69,0)
FL ; File List
"RTN","LEXXST",70,0)
 N LEXN K LEXDDA S LEXN=$$ATTR(LEXFI,"NAME") Q:'$L(LEXN)
"RTN","LEXXST",71,0)
 S LEXGL=$$ATTR(LEXFI,"GLOBAL NAME") Q:'$L(LEXGL)
"RTN","LEXXST",72,0)
 S LEXX=LEXGL_"0)",LEXX=$G(@LEXX),LEXTR=+($P(LEXX,"^",4)),LEXLR=+($P(LEXX,"^",3))
"RTN","LEXXST",73,0)
 S LEXRLR=$O(@(LEXGL_""" "")"),-1) S:'$L($G(LEXX)) (LEXTR,LEXLR)="??" S:LEXRLR'=LEXLR (LEXTR,LEXLR)="??"
"RTN","LEXXST",74,0)
 S LEXNM=$E(LEXN,1,21),LEXX=$$ATTR(LEXFI,"VERSION")
"RTN","LEXXST",75,0)
 S LEXVR=$P(LEXX,".",1),LEXX=$P(LEXX,".",2),LEXVR=$J(LEXVR,3)_$S($L(LEXVR):".",1:"")_LEXX
"RTN","LEXXST",76,0)
 S LEXPRD=$$ATTR(LEXFI,"PACKAGE REVISION DATA")
"RTN","LEXXST",77,0)
 S LEXRN=$P(LEXPRD,"^",1) S:LEXRN="" LEXRN="1"
"RTN","LEXXST",78,0)
 S LEXRD=$P(LEXPRD,"^",2) S:LEXRD'="" LEXRD=$$MDCY(LEXRD)
"RTN","LEXXST",79,0)
 S:LEXRD="" LEXRD="10/04/96"
"RTN","LEXXST",80,0)
 S LEXCT=LEXCT+1,LEXT=$J(LEXCT,3)_"  "_LEXFI_$E(LEXSP,1,(9-$L(LEXFI)))
"RTN","LEXXST",81,0)
 S LEXT=LEXT_LEXNM_$E(LEXSP,1,(21-$L(LEXNM))),LEXT=LEXT_LEXVR_$E(LEXSP,1,(8-$L(LEXVR)))
"RTN","LEXXST",82,0)
 S LEXT=LEXT_LEXRN_$E(LEXSP,1,(4-$L(LEXRN))),LEXT=LEXT_LEXRD_$E(LEXSP,1,(14-$L(LEXRD)))
"RTN","LEXXST",83,0)
 S LEXT=LEXT_$J(LEXLR,7)_"    "_$J(LEXTR,7) D TL(LEXT)
"RTN","LEXXST",84,0)
 Q
"RTN","LEXXST",85,0)
SHOW ; Show global array (display or mail)
"RTN","LEXXST",86,0)
 D:$D(LEXMAIL) MAIL,CLR D:'$D(LEXMAIL) DSP,CLR Q
"RTN","LEXXST",87,0)
SHOW2 ; Display global array
"RTN","LEXXST",88,0)
 N LEXI S LEXI=0 F  S LEXI=$O(^TMP($J,"LEXINFO",LEXI)) Q:+LEXI=0  W !,^TMP($J,"LEXINFO",LEXI)
"RTN","LEXXST",89,0)
 Q
"RTN","LEXXST",90,0)
MAIL ; Mail global array in message
"RTN","LEXXST",91,0)
 N DIFROM,LEXADR S U="^",XMSUB="LEXICON INFO"
"RTN","LEXXST",92,0)
 S:$L($G(LEXBUILD)) XMSUB=LEXBUILD_" Installation"
"RTN","LEXXST",93,0)
 S LEXADR=$$ADR^LEXU Q:'$L(LEXADR)
"RTN","LEXXST",94,0)
 S XMY(("G.LEXINS@"_LEXADR))="",XMTEXT="^TMP($J,""LEXINFO"",",XMDUZ=.5 D ^XMD
"RTN","LEXXST",95,0)
 K ^TMP($J,"LEXINFO"),%Z,XCNP,XMSCR,XMDUZ,XMY,XMZ,XMSUB,XMY,XMTEXT,XMDUZ Q
"RTN","LEXXST",96,0)
 Q
"RTN","LEXXST",97,0)
CLR ; Clean up
"RTN","LEXXST",98,0)
 K ^TMP($J,"LEXINFO") Q
"RTN","LEXXST",99,0)
BL ; Blank Line
"RTN","LEXXST",100,0)
 N LEXNX S LEXNX=+($$NX),^TMP($J,"LEXINFO",LEXNX)="" Q
"RTN","LEXXST",101,0)
TT(LEXX) ; Title Line
"RTN","LEXXST",102,0)
 Q:'$L($G(LEXX))  D TL(LEXX) N LEXBK S LEXBK="===============================================================================",LEXBK=$E(LEXBK,1,$L($G(LEXX))) D:$L(LEXBK) TL(LEXBK) Q
"RTN","LEXXST",103,0)
TL(LEXX) ; Text Line
"RTN","LEXXST",104,0)
 N LEXNX S LEXNX=+($$NX),^TMP($J,"LEXINFO",LEXNX)=$G(LEXX) Q
"RTN","LEXXST",105,0)
BK1 ; Break Line
"RTN","LEXXST",106,0)
 N LEXNX S LEXNX=+($$NX),^TMP($J,"LEXINFO",LEXNX)="-------------------------------------------------------------------------------" Q
"RTN","LEXXST",107,0)
NX(LEXX) ; Next Line #
"RTN","LEXXST",108,0)
 S (LEXX,^TMP($J,"LEXINFO",0))=+($G(^TMP($J,"LEXINFO",0)))+1 Q LEXX
"RTN","LEXXST",109,0)
DSP ; Display ^TMP($J,"LEXINFO")
"RTN","LEXXST",110,0)
 D DEV Q
"RTN","LEXXST",111,0)
DEV ; Select a device
"RTN","LEXXST",112,0)
 N %,%ZIS,IOP,ZTRTN,ZTSAVE,ZTDESC,ZTDTH,ZTIO,ZTSK
"RTN","LEXXST",113,0)
 S ZTRTN="DSPI^LEXXST",ZTDESC="printing Lexicon installation information"
"RTN","LEXXST",114,0)
 S ZTIO=ION,ZTDTH=$H,%ZIS="PQ",ZTSAVE("^TMP($J,""LEXINFO"",")=""
"RTN","LEXXST",115,0)
 D ^%ZIS Q:POP  S ZTIO=ION I $D(IO("Q")) D QUE,^%ZISC Q
"RTN","LEXXST",116,0)
 D NOQUE Q
"RTN","LEXXST",117,0)
NOQUE ; Do not que task
"RTN","LEXXST",118,0)
 W @IOF W:IOST["P-" !,"< Not queued, printing Lexicon Installations >",! H 2 U:IOST["P-" IO D @ZTRTN,^%ZISC Q
"RTN","LEXXST",119,0)
QUE ; Task queued to print user defaults
"RTN","LEXXST",120,0)
 K IO("Q") D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued",1:"Request Cancelled"),! H 2 Q
"RTN","LEXXST",121,0)
 Q
"RTN","LEXXST",122,0)
DSPI ; Display installations
"RTN","LEXXST",123,0)
 I '$D(ZTQUEUED),$G(IOST)'["P-" W:'$D(LEXDNC) # I '$D(^TMP($J,"LEXINFO")) W !,"Installations not found"
"RTN","LEXXST",124,0)
 I IOST["P-" U IO
"RTN","LEXXST",125,0)
 G:'$D(^TMP($J,"LEXINFO")) DSPQ
"RTN","LEXXST",126,0)
 N LEXCONT,LEXI,LEXLC,LEXEOP S LEXCONT="",(LEXLC,LEXI)=0,LEXEOP=+($G(IOSL)) S:LEXEOP=0 LEXEOP=24
"RTN","LEXXST",127,0)
 F  S LEXI=$O(^TMP($J,"LEXINFO",LEXI)) Q:+LEXI=0!(LEXCONT["^")  D
"RTN","LEXXST",128,0)
 . W !,^TMP($J,"LEXINFO",LEXI) D LF Q:LEXCONT["^"
"RTN","LEXXST",129,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","LEXXST",130,0)
 W:$G(IOST)["P-" @IOF
"RTN","LEXXST",131,0)
DSPQ ; Quit Display
"RTN","LEXXST",132,0)
 Q
"RTN","LEXXST",133,0)
LF ; Line Feed
"RTN","LEXXST",134,0)
 S LEXLC=LEXLC+1 D:IOST["P-"&(LEXLC>(LEXEOP-7)) CONT D:IOST'["P-"&(LEXLC>(LEXEOP-4)) CONT
"RTN","LEXXST",135,0)
 Q
"RTN","LEXXST",136,0)
CONT ; Page/Form Feed
"RTN","LEXXST",137,0)
 S LEXLC=0 W:IOST["P-" @IOF Q:IOST["P-"  W !!,"Press <Return> to continue  " R LEXCONT:300 S:'$T LEXCONT="^" S:LEXCONT'["^" LEXCONT=""
"RTN","LEXXST",138,0)
 Q
"RTN","LEXXST",139,0)
A(LEX) ; As of date/time
"RTN","LEXXST",140,0)
 N %,X,%I,%H D NOW^%DTC S LEX=$$UP^XLFSTR($$FMTE^XLFDT(%,"1")) S:LEX["@" LEX=$P(LEX,"@",1)_"  "_$P(LEX,"@",2,299) Q LEX
"RTN","LEXXST",141,0)
P(LEX) ; Person
"RTN","LEXXST",142,0)
 S LEX=+($G(DUZ)) Q:'$L($P($G(^VA(200,+($G(LEX)),0)),"^",1)) "UNKNOWN^"
"RTN","LEXXST",143,0)
 N LEXDUZ,LEXPH S LEXDUZ=+($G(DUZ))
"RTN","LEXXST",144,0)
 S LEXPH=$P($G(^VA(200,LEXDUZ,.13)),"^",2) S:LEXPH="" LEXPH=$P($G(^VA(200,LEXDUZ,.13)),"^",1) S:LEXPH="" LEXPH=$P($G(^VA(200,LEXDUZ,.13)),"^",3) S:LEXPH="" LEXPH=$P($G(^VA(200,LEXDUZ,.13)),"^",4)
"RTN","LEXXST",145,0)
 S LEXDUZ=$P(^VA(200,LEXDUZ,0),"^",1),LEX=LEXDUZ_"^"_LEXPH Q LEX
"RTN","LEXXST",146,0)
N0 ; 0 Node
"RTN","LEXXST",147,0)
 N LEXFI,LEXCT,DIC S LEXCT=0
"RTN","LEXXST",148,0)
 S LEXFI=756.999999 F  S LEXFI=$O(^LEX(LEXFI)) Q:+LEXFI=0!($E(LEXFI,1,3)'="757")  S DIC=$$ATTR(LEXFI,"GLOBAL NAME") D N0C
"RTN","LEXXST",149,0)
 S LEXFI=756.999999 F  S LEXFI=$O(^LEXT(LEXFI)) Q:+LEXFI=0!($E(LEXFI,1,3)'="757")  S DIC=$$ATTR(LEXFI,"GLOBAL NAME") D N0C
"RTN","LEXXST",150,0)
 S LEXFI=756.999999 F  S LEXFI=$O(^LEXC(LEXFI)) Q:+LEXFI=0!($E(LEXFI,1,3)'="757")  S DIC=$$ATTR(LEXFI,"GLOBAL NAME") D N0C
"RTN","LEXXST",151,0)
 F LEXFI=80,80.1,81,81.3 S DIC=$$ATTR(LEXFI,"GLOBAL NAME") D N0C
"RTN","LEXXST",152,0)
 Q
"RTN","LEXXST",153,0)
N0C ; 0 Node Count
"RTN","LEXXST",154,0)
 N DA,LEXLR,LEXTR,LEXDDA,LEXNM
"RTN","LEXXST",155,0)
 K LEXDDA D FILE^DID(LEXFI,"N","NAME","LEXDDA","LEXDDA")
"RTN","LEXXST",156,0)
 S LEXNM=$G(LEXDDA("NAME")) Q:'$L(LEXNM)  S (DA,LEXLR,LEXTR)=0
"RTN","LEXXST",157,0)
 F  S DA=$O(@(DIC_DA_")")) Q:+DA=0  S LEXLR=DA,LEXTR=LEXTR+1
"RTN","LEXXST",158,0)
 S $P(@(DIC_"0)"),"^",3)=LEXLR,$P(@(DIC_"0)"),"^",4)=LEXTR
"RTN","LEXXST",159,0)
 W:'$D(ZTQUEUED) !,LEXFI,?10,$J(LEXLR,10),$J(LEXTR,10)
"RTN","LEXXST",160,0)
 Q
"RTN","LEXXST",161,0)
FC(X) ; File Count
"RTN","LEXXST",162,0)
 N LEXFI,LEXCT S LEXCT=0
"RTN","LEXXST",163,0)
 S LEXFI=756.999999 F  S LEXFI=$O(^LEX(LEXFI)) Q:+LEXFI=0!($E(LEXFI,1,3)'="757")  S LEXCT=LEXCT+1
"RTN","LEXXST",164,0)
 S LEXFI=756.999999 F  S LEXFI=$O(^LEXT(LEXFI)) Q:+LEXFI=0!($E(LEXFI,1,3)'="757")  S LEXCT=LEXCT+1
"RTN","LEXXST",165,0)
 S LEXFI=756.999999 F  S LEXFI=$O(^LEXC(LEXFI)) Q:+LEXFI=0!($E(LEXFI,1,3)'="757")  S LEXCT=LEXCT+1
"RTN","LEXXST",166,0)
 S X=LEXCT Q X
"RTN","LEXXST",167,0)
MDCY(X) ; Month/Day/Century-Year where X=FM Date
"RTN","LEXXST",168,0)
 N LEXCY S LEXCY=+($G(X)) Q:LEXCY=0 "" S LEXCY=$P($$FMTE^XLFDT(LEXCY,2),"/",1,2)_"/"_$P($P($$FMTE^XLFDT(LEXCY,1)," ",3),"@",1)
"RTN","LEXXST",169,0)
 S:$L($P(LEXCY,"/",1))<2 $P(LEXCY,"/",1)="0"_$P(LEXCY,"/",1) S:$L($P(LEXCY,"/",2))<2 $P(LEXCY,"/",2)="0"_$P(LEXCY,"/",2)
"RTN","LEXXST",170,0)
 S:$L($P(LEXCY,"/",1))<2 $P(LEXCY,"/",1)="0"_$P(LEXCY,"/",1) S:$L($P(LEXCY,"/",2))<2 $P(LEXCY,"/",2)="0"_$P(LEXCY,"/",2)
"RTN","LEXXST",171,0)
 S X=LEXCY Q X
"RTN","LEXXST",172,0)
ATTR(X,A) ; File Attributes
"RTN","LEXXST",173,0)
 N LEXFI,LEXATT,LEXDDA
"RTN","LEXXST",174,0)
 S LEXFI=+($G(X)) Q:+LEXFI'>0 ""  S LEXATT=$G(A) Q:'$L(LEXATT) ""
"RTN","LEXXST",175,0)
 D FILE^DID(LEXFI,"N",LEXATT,"LEXDDA","LEXDDA") S X=$G(LEXDDA(LEXATT))
"RTN","LEXXST",176,0)
 Q X
"RTN","LEXXST5")
1^6
"VER")
8.0^22.0
**END**
**END**
