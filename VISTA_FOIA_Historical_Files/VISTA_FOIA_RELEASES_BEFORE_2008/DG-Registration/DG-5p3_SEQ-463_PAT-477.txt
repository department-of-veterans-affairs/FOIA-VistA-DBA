$TXT Created by DAVIS,PAULETTE T at DEVCRN.FO-ALBANY.MED.VA.GOV  (KIDS) on Friday, 08/15/03 at 13:16
=============================================================================
Run Date: AUG 20, 2003                     Designation: DG*5.3*477
Package : DG - REGISTRATION                   Priority: Mandatory
Version : 5.3       SEQ #463                    Status: Released
                  Compliance Date: SEP 20, 2003
=============================================================================

Associated patches: (v)DG*5.3*244  <<= must be installed BEFORE `DG*5.3*477'
                    (v)DG*5.3*307  <<= must be installed BEFORE `DG*5.3*477'
                    (v)DG*5.3*384  <<= must be installed BEFORE `DG*5.3*477'
                    (v)DG*5.3*454  <<= must be installed BEFORE `DG*5.3*477'
                    (v)DG*5.3*474  <<= must be installed BEFORE `DG*5.3*477'
                    (v)DG*5.3*484  <<= must be installed BEFORE `DG*5.3*477'

Subject: PATIENT DATA REVIEW FIXES & ENHANCEMENTS

Category: 
  - Routine
  - Enhancement (Mandatory)
  - Data Dictionary

Description:
============

  DG*5.3*244, DG*5.3*307, DG*5.3*384, DG*5.3*454, DG*5.3*474, and
  DG*5.3*484 are required builds for patch DG*5.3*477.
        
  1.) NOIS TNV-0802-31818 and MIW-0603-40046 reported a problem
  with the Patient Data Review [VAFC EXCEPTION HANDLER] option after
  patch DG*5.3*244 (PATIENT NAME STANDARDIZATION) is installed.  In
  Patient Data Review (PDR), the next of kin name could not be merged. 
  Changes have been made in routines VAFCEHU1, VAFCEHU2, and VAFCEHU3
  to address this NOIS and to deal with a similar problem with
  MOTHER'S MAIDEN NAME.
   
  2.) NOIS BHS-1202-10662 reported a problem with the Patient Data Review
  [VAFC EXCEPTION HANDLER] option.  When the Coordinating Master of
  Record (CMOR) site accepted a change in the Zip+4 field, the City, State
  and County fields were unchanged.  Modifications were made to support
  zip code linking.  Merging of the Zip+4 field will automatically populate
  City, State and County.  The merge of State and County fields can be
  overridden if the user holds the Edit Patient State and County [EAS GMT
  COUNTY EDIT] security key.  The code changes were made in routines VAFCMGA,
  VAFCMGA1, and VAFCMGB1.
   
  3.) NOIS TOG-1202-12263 and BHS-0403-10837 reported a problem with
  the Patient Data Review [VAFC EXCEPTION HANDLER] option.  When
  attempting to merge the NOK Name from another facility, the application
  automatically deleted the NOK Phone # and the UNDO function did not
  bring it back.  This patch stops the cross-reference that deletes
  the NOK Phone # and NOK address fields when a NOK Name is merged in
  PDR.  The NOK Name and NOK Phone # fields can be merged independently
  and the UNDO action restores the fields appropriately.
     
  4.) NOIS BEC-0303-20728 reported that the Date Verified field in 
  the Patient Data Review [VAFC EXCEPTION HANDLER] option is not 
  displayed in the correct date format.  This problem was introduced 
  in patch DG*5.3*474, with the new messaging.  The ELIGIBILITY 
  STATUS DATE (#.3612) field in the PATIENT (#2) file was transmitted 
  in a Health Level Seven date format instead of a FileMan date format.
  The correct date translation has been added to routine VAFCMGB0.
   
  5.) NOIS HWH-0303-41223 requested purge capability for old entries in
  the Patient Data Review [VAFC EXCEPTION HANDLER] option.  A new option,
  Purge Patient Data Review [VAFC PDR PURGE], is distributed in this
  patch.  The option is placed on the MPI/PD Patient Admin User Menu
  [RG ADMIN USER MENU].  Using this option, the user can queue a
  background task to purge data that is over 30 days old from the 
  PATIENT DATA EXCEPTION (#391.98) and PATIENT DATA ELEMENT (#391.99)
  files.  This code was added to routine VAFCEHLM.
   
  6.) In VAFCEHU1, code was changed to suppress the incoming filer from
  generating multiple "Sensitive Patient" bulletins.  Each time the data
  elements for PDR were being filed, multiple bulletins were being
  generated.
   
  7.) Danny Hayes at the Tennessee Valley HCS reported an anomaly
  with the "Remote Sensitivity Indicated" bulletin.  The fields for
  "Remote User who Flagged the Patient as Sensitive" and "Date/Time
  Remote User Flagged Patient Sensitive" were incorrectly displayed.
  Code has been changed in VAFCMSG3 to address this issue.
   
  8.) Northampton VAMC reported a problem with the Patient Data Review
  [VAFC EXCEPTION HANDLER] option.  The marital status was not being
  received from the sending site properly for the 'Never Married' status.
  Code was changed in VAFCQRY1 and VAFCEHU3 to correctly translate the
  'Never Married' marital status.
   
  Also, in VAFCQRY1, code was added to correct a timing issue that was
  generating exceptions on the MPI when new entries get created.
  Furthermore, four fields (Integration Control Number, Social Security
  Number, City, and State) were added to other fields within the HL7
  PID segment for backward compatibility with Health Data Repository
  v2.3 messages.
     
  9.) The following additional refinements were made to the Patient Data
  Review [VAFC EXCEPTION HANDLER] option.
  - Prompts were added to warn of the broadcasting of NAME, SEX, DOB,
    SSN and MOTHER'S MAIDEN NAME during a REJECT or MERGE of PDR data.
    Routine: VAFCMGA
  - Code was changed in VAFCMGB0 to properly handle the dash in ZIP+4
    with new messaging in place.
  - Since the Name field is no longer auto-updated in PDR (since patch
    DG*5.3*474), flag the field if it is different or has been edited
    within PDR.  Routine: VAFCMGB0
  - As instructed, the Patient Type field has been removed from the
    PDR display. Routine: VAFCMGB3
   
  10.) The Audit Menu in the Patient Data Review [VAFC EXCEPTION HANDLER]
  option has been enhanced.  The previous Patient Audit [VAFC EXCPT
  PATIENT AUDIT] protocol has been replaced with expanded functionality.
  The following new options have been added to the menu structure.
      MPI/PD Patient Audit Action Menu [VAFC EXCPT PATIENT AUDIT MENU]
      Send Remote Patient Audit Query [VAFC EXCPT RPA SEND]
      Check Remote Patient Audit Query [VAFC EXCPT RPA CHECK]
      Display Remote Patient Audit Query [VAFC EXCPT RPA DISPLAY]
  In addition to viewing the local audit information, PDR will now enable
  remote data to be examined also.  A REMOTE PROCEDURE, VAFC REMOTE AUDIT,
  calls routine VAFCRPC to allow users to get an audit report from a remote
  site.
   
  11.) A new option, MPI/PD Data Inquiry [VAFC EXCPT MPI/PD DATA],
  has been added to the Patient Data Review [VAFC EXCEPTION HANDLER]
  menu structure.
   
  12.) A new option, Push CMOR Request [VAFC EXCPT PUSH CMOR], has
  been added to the Patient Data Review [VAFC EXCEPTION HANDLER] menu
  structure.
        
  NOTE: DG*5.3*477 functionality does not affect any existing
  Registration functionality other than this MPI/PD functionality.
         
  New Protocols:
  ==============
  The following new protocols have been added to the Patient Data
  Review  [VAFC EXCEPTION HANDLER] menu.
   
  MPI/PD Patient Audit Action Menu [VAFC EXCPT PATIENT AUDIT MENU],
  Send Remote Patient Audit Query [VAFC EXCPT RPA SEND], Check Remote
  Patient Audit Query [VAFC EXCPT RPA CHECK], and Display Remote Patient
  Audit Query [VAFC EXCPT RPA DISPLAY].  These protocols allow the user to
  send, check, and display the status of a remote patient audit query.
   
  The MPI/PD Data Inquiry [VAFC EXCPT MPI/PD DATA] protocol displays
  Master Patient Index/Patient Demographics (MPI/PD) information
  for the selected patient.
   
  The Push CMOR Request [VAFC EXCPT PUSH CMOR] protocol allows the
  user's site to relinquish being the CMOR for a patient and give it
  to another site.
   
  Data Dictionary Changes:
  ========================
  Patch DG*5.3*474 contains changes to the data dictionary (DD) of
  the PATIENT (#2) file.  The patch adds the AVAFC* MUMPS cross-
  reference to one field.  It sets the VAFCF variable to capture
  which fields have been modified in the ADT/HL7 PIVOT (#391.71)
  file.  The cross-reference has been added for the following field.
   
  Field     Name                             Cross-reference
  -----     ----------------------           ---------------
  .313      CLAIM NUMBER                         AVAFC313
   
  List Template:
  ==============
  The following list templates are distributed with this patch.
  VAFC EXCPT LOCAL AUDIT
  VAFC EXCPT REMOTE AUDIT
   
  New Remote Procedure:
  =====================
  The VAFC REMOTE AUDIT remote procedure is distributed in this patch
  to enable the generation of an audit report from a remote site.
      
  Test Sites:
  ===========
  Battle Creek, MI
  Bedford, MA
  Beckley, WV
  Boston HCS
  Northampton, MA
  Tennessee Valley HCS
   
  Associated NOIS:
  ================
  TNV-0802-31818
  BHS-1202-10662
  TOG-1202-12263
  BEC-0303-20728
  HWH-0303-41223
  BHS-0403-10837
  MIW-0603-40046
   
  Routine Summary:
  ================
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
     
  <TAB>;;5.3;Registration;**[patch list]**;Aug 13, 1993
  CHECK^XTSUMBLD results:
   
  Routine       Before Patch       After Patch       Patch List
  --------      ------------       ------------      -----------
  DG477PST             N/A                N/A        477
  VAFCAUD              N/A           10089984        477
  VAFCEHLM         1934223            5278216        149,255,307,333,477
  VAFCEHU1         8408414            8751376        149,255,307,477
  VAFCEHU2        11044087           14432466        149,255,333,474,477
  VAFCEHU3         8568870           11845637        149,295,384,474,477
  VAFCHFS          9245954           10118745        414,477
  VAFCLAU              N/A            1780612        477
  VAFCMGA          6501242           11799975        149,477
  VAFCMGA1          733219            5403719        149,477
  VAFCMGB0         4470239            5648089        149,255,477
  VAFCMGB1         6380182            7297302        149,295,384,477
  VAFCMGB3         6009839            5487675        149,477
  VAFCMSG3         6601715            6744660        91,209,149,261,
                                                     307,494,484,477
  VAFCQRY1        22851430           24830265        428,474,477
  VAFCRAU              N/A            3544862        477
  VAFCRAUD             N/A           15204069        477
  VAFCRPC          1008001            2676313        414,440,474,477
   
  Note: Routine DG477PST is deleted by the installation.
  The checksum prior to deletion is 7445701.
   
  Post-Install Routine:
  =====================
  The post-install routine, DG477PST, uses the ^DIE("AF" cross-
  reference to find all compiled templates on fields that were
  edited in the PATIENT (#2) file for MPI/PD and re-compiles the
  templates.  The routine also updates triggered fields.
     
  Code was introduced in patch DG*5.3*474 that did not properly
  translate the MARITAL STATUS code for Patient Data Review.  The
  earliest installations of patch DG*5.3*474 were in November, 2002.
  Beginning with an event date of October 30, 2002, DG477PST
  translates the existing Patient Data Review data for MARITAL
  STATUS from "N" to "NEVER MARRIED" in the PATIENT DATA ELEMENTS
  (#391.99) file.
   
  Installation Instructions:
  ==========================
  This patch may be loaded with users on the system.  You may wish
  to install it during non-peak hours to minimize disruption to the
  users.  Installation will take less than 10 minutes.
    
  1.  Using the TaskMan option Schedule/Unschedule Options [XUTM SCHEDULE],
      unschedule the following option:
        VAFC BATCH UPDATE          UPDATE BATCH JOB FOR HL7 v2.3
    
  2.  On the Filer and Link Management Options [HL MENU FILER LINK MGT]
      menu, select the Monitor, Start, Stop Filers [HL FILER MONITOR]
      option.  At that menu level, choose the action "Stop incoming 
      filer" to stop each incoming filer that is running.  This is to
      prevent adding entries to the TREATING FACILITY LIST (#391.91)
      file while updating routines and data dictionaries.
    
  3.  Use the INSTALL/CHECK MESSAGE option on the Packman menu.  [Note: 
      TEXT PRINT/DISPLAY option in the PackMan menu will display the 
      patch text only.]
   
  4.  Review your mapped set.  If any of the routines listed in the 
      ROUTINE SUMMARY section are mapped, they should be removed
      from the mapped set at this time.
   
  5.  From the Kernel Installation and Distribution System Menu, select
      the Installation menu.
   
  6.  From this menu, you may elect to use the following options (when
      prompted for the INSTALL NAME, enter DG*5.3*477).
   
      (a)  Backup a Transport Global - this option will create a backup
           message of any routines exported with the patch.  It will NOT
           backup any other changes such as DDs or templates.
   
      (b)  Compare Transport Global to Current System - this option will
           allow you to view all changes that will be made when the
           patch is installed.  It compares all components of the patch
           (routines, DDs, templates, etc.).
   
      (c)  Verify Checksums in Transport Global - this option will allow
           you to ensure the integrity of the routines that are in the
           transport global.
   
      (d)  Print Transport Global - this option will allow you to view the
           components of the KIDS build.
   
  7.  Use the Install Package(s) option and select the package DG*5.3*477.
   
  8.  When prompted 'Want KIDS to Rebuild Menu Trees Upon Completion of
      Install? YES//', respond YES.
   
  9.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? YES//',
      respond NO.
   
  10. When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
      Protocols? YES//', respond YES.  Place the Patient Data Review [VAFC
      EXCEPTION HANDLER] option out of order.
   
  11. If any routines were unmapped as part of step 4, return them to the
      mapped set once the installation has run to completion.
   
  12. On the Filer and Link Management Options [HL MENU FILER LINK MGT]
      menu, select the Monitor, Start, Stop Filers [HL FILER MONITOR]
      option.  At that menu level, choose the action "Start incoming
      filer" to start the default number of incoming filers.
    
  13. Using the TaskMan option Schedule/Unschedule Options [XUTM SCHEDULE],
      schedule the option VAFC BATCH UPDATE [UPDATE BATCH JOB FOR HL7 v2.3]
      to run every 10 minutes.

Routine Information:
====================

Routine Name:
  - DG477PST


Routine Checksum:

Routine Name:
  - VAFCEHU1


Routine Checksum:

Routine Name:
  - VAFCLAU


Routine Checksum:

Routine Name:
  - VAFCMGA


Routine Checksum:

Routine Name:
  - VAFCMGA1


Routine Checksum:

Routine Name:
  - VAFCMGB0


Routine Checksum:

Routine Name:
  - VAFCMGB1


Routine Checksum:

Routine Name:
  - VAFCMGB3


Routine Checksum:

Routine Name:
  - VAFCQRY1


Routine Checksum:

Routine Name:
  - VAFCRAU


Routine Checksum:

Routine Name:
  - VAFCRAUD


Routine Checksum:

Routine Name:
  - VAFCEHU2


Routine Checksum:

Routine Name:
  - VAFCEHU3


Routine Checksum:

Routine Name:
  - VAFCAUD


Routine Checksum:

Routine Name:
  - VAFCEHLM


Routine Checksum:

Routine Name:
  - VAFCHFS


Routine Checksum:

Routine Name:
  - VAFCRPC


Routine Checksum:

Routine Name:
  - VAFCMSG3


Routine Checksum:

=============================================================================
User Information:
Entered By  : DAVIS,PAULETTE                Date Entered  : SEP 13, 2002
Completed By: ALDERMAN,MATT S               Date Completed: AUG 18, 2003
Released By : BURTS,WANDA                   Date Released : AUG 20, 2003
=============================================================================


Packman Mail Message:
=====================

$END TXT
