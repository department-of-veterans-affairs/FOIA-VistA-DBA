Released USR*1*4 SEQ #4
Extracted from mail message
**KIDS**:USR*1.0*4^

**INSTALL NAME**
USR*1.0*4
"BLD",628,0)
USR*1.0*4^AUTHORIZATION/SUBSCRIPTION^0^2980304^y
"BLD",628,1,0)
^^3^3^2980303^^^^
"BLD",628,1,1,0)
ASU patch 4, USR*1.0*4. This patch adds options that allow examination
"BLD",628,1,2,0)
of class memberships without editing capabilites. See the National
"BLD",628,1,3,0)
Patch module for a complete description.
"BLD",628,4,0)
^9.64PA^^0
"BLD",628,"ABPKG")
n
"BLD",628,"INI")

"BLD",628,"INIT")

"BLD",628,"KRN",0)
^9.67PA^8994^18
"BLD",628,"KRN",.4,0)
.4
"BLD",628,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",628,"KRN",.401,0)
.401
"BLD",628,"KRN",.401,"NM",0)
^9.68A^^
"BLD",628,"KRN",.402,0)
.402
"BLD",628,"KRN",.403,0)
.403
"BLD",628,"KRN",.5,0)
.5
"BLD",628,"KRN",.84,0)
.84
"BLD",628,"KRN",3.6,0)
3.6
"BLD",628,"KRN",3.8,0)
3.8
"BLD",628,"KRN",9.2,0)
9.2
"BLD",628,"KRN",9.8,0)
9.8
"BLD",628,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",628,"KRN",9.8,"NM",1,0)
USRMLST^^0^B8304019
"BLD",628,"KRN",9.8,"NM",2,0)
USRULST^^0^B6868880
"BLD",628,"KRN",9.8,"NM","B","USRMLST",1)

"BLD",628,"KRN",9.8,"NM","B","USRULST",2)

"BLD",628,"KRN",19,0)
19
"BLD",628,"KRN",19,"NM",0)
^9.68A^5^5
"BLD",628,"KRN",19,"NM",1,0)
USR LIST MEMBERSHIP BY CLASS^^0
"BLD",628,"KRN",19,"NM",2,0)
USR LIST MEMBERSHIP BY USER^^0
"BLD",628,"KRN",19,"NM",3,0)
USR SHOW MEMBERSHIP^^0
"BLD",628,"KRN",19,"NM",4,0)
USR SHOW MEMBERSHIP BY CLASS^^0
"BLD",628,"KRN",19,"NM",5,0)
USR SHOW MEMBERSHIP BY USER^^0
"BLD",628,"KRN",19,"NM","B","USR LIST MEMBERSHIP BY CLASS",1)

"BLD",628,"KRN",19,"NM","B","USR LIST MEMBERSHIP BY USER",2)

"BLD",628,"KRN",19,"NM","B","USR SHOW MEMBERSHIP",3)

"BLD",628,"KRN",19,"NM","B","USR SHOW MEMBERSHIP BY CLASS",4)

"BLD",628,"KRN",19,"NM","B","USR SHOW MEMBERSHIP BY USER",5)

"BLD",628,"KRN",19.1,0)
19.1
"BLD",628,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",628,"KRN",101,0)
101
"BLD",628,"KRN",101,"NM",0)
^9.68A^5^5
"BLD",628,"KRN",101,"NM",1,0)
USR SHOW CLASS MEMBERSHIP MENU^^0
"BLD",628,"KRN",101,"NM",2,0)
USR SHOW USER MEMBERSHIP MENU^^0
"BLD",628,"KRN",101,"NM",3,0)
USR CLASS ACTION QUIT^^0
"BLD",628,"KRN",101,"NM",4,0)
USR CLASS MEMBERSHIP CHANGE VIEW^^0
"BLD",628,"KRN",101,"NM",5,0)
USR CLASS MEMBER USER CHANGE VIEW^^0
"BLD",628,"KRN",101,"NM","B","USR CLASS ACTION QUIT",3)

"BLD",628,"KRN",101,"NM","B","USR CLASS MEMBER USER CHANGE VIEW",5)

"BLD",628,"KRN",101,"NM","B","USR CLASS MEMBERSHIP CHANGE VIEW",4)

"BLD",628,"KRN",101,"NM","B","USR SHOW CLASS MEMBERSHIP MENU",1)

"BLD",628,"KRN",101,"NM","B","USR SHOW USER MEMBERSHIP MENU",2)

"BLD",628,"KRN",409.61,0)
409.61
"BLD",628,"KRN",409.61,"NM",0)
^9.68A^2^2
"BLD",628,"KRN",409.61,"NM",1,0)
USR SHOW MEMBERSHIP BY CLASS^^0
"BLD",628,"KRN",409.61,"NM",2,0)
USR SHOW MEMBERSHIP BY USER^^0
"BLD",628,"KRN",409.61,"NM","B","USR SHOW MEMBERSHIP BY CLASS",1)

"BLD",628,"KRN",409.61,"NM","B","USR SHOW MEMBERSHIP BY USER",2)

"BLD",628,"KRN",771,0)
771
"BLD",628,"KRN",869.2,0)
869.2
"BLD",628,"KRN",870,0)
870
"BLD",628,"KRN",8994,0)
8994
"BLD",628,"KRN","B",.4,.4)

"BLD",628,"KRN","B",.401,.401)

"BLD",628,"KRN","B",.402,.402)

"BLD",628,"KRN","B",.403,.403)

"BLD",628,"KRN","B",.5,.5)

"BLD",628,"KRN","B",.84,.84)

"BLD",628,"KRN","B",3.6,3.6)

"BLD",628,"KRN","B",3.8,3.8)

"BLD",628,"KRN","B",9.2,9.2)

"BLD",628,"KRN","B",9.8,9.8)

"BLD",628,"KRN","B",19,19)

"BLD",628,"KRN","B",19.1,19.1)

"BLD",628,"KRN","B",101,101)

"BLD",628,"KRN","B",409.61,409.61)

"BLD",628,"KRN","B",771,771)

"BLD",628,"KRN","B",869.2,869.2)

"BLD",628,"KRN","B",870,870)

"BLD",628,"KRN","B",8994,8994)

"BLD",628,"QUES",0)
^9.62^^
"BLD",628,"REQB",0)
^9.611^1^1
"BLD",628,"REQB",1,0)
USR*1.0*3^1
"BLD",628,"REQB","B","USR*1.0*3",1)

"KRN",19,20269,-1)
0^2
"KRN",19,20269,0)
USR LIST MEMBERSHIP BY USER^List Membership by User^^A^^^^^^^^^^1
"KRN",19,20269,1,0)
^^2^2^2950523^^^
"KRN",19,20269,1,1,0)
This option allows review, addition, editing, and removal of individual
"KRN",19,20269,1,2,0)
members to and from User Classes.
"KRN",19,20269,20)
S USRLTMPL="USR LIST MEMBERSHIP BY USER" D MAIN^USRULST
"KRN",19,20269,"U")
LIST MEMBERSHIP BY USER
"KRN",19,20271,-1)
0^1
"KRN",19,20271,0)
USR LIST MEMBERSHIP BY CLASS^List Membership by Class^^A^^^^^^^^^^1
"KRN",19,20271,1,0)
^^2^2^2950523^^^
"KRN",19,20271,1,1,0)
This option allows review, addition, editing, and removal of individual
"KRN",19,20271,1,2,0)
members to and from User Classes.
"KRN",19,20271,20)
S USRLTMPL="USR LIST MEMBERSHIP BY CLASS" D MAIN^USRMLST
"KRN",19,20271,"U")
LIST MEMBERSHIP BY CLASS
"KRN",19,20402,-1)
0^4
"KRN",19,20402,0)
USR SHOW MEMBERSHIP BY CLASS^Show Membership by Class^^A^^^^^^^^^^1
"KRN",19,20402,1,0)
^^1^1^2980227^^^
"KRN",19,20402,1,1,0)
This option lists members of a selected User Class.
"KRN",19,20402,20)
S USRLTMPL="USR SHOW MEMBERSHIP BY CLASS" D MAIN^USRMLST
"KRN",19,20402,"U")
SHOW MEMBERSHIP BY CLASS
"KRN",19,20403,-1)
0^5
"KRN",19,20403,0)
USR SHOW MEMBERSHIP BY USER^Show Membership by User^^A^^^^^^^^^^1
"KRN",19,20403,1,0)
^^1^1^2980227^
"KRN",19,20403,1,1,0)
This option list the User Classes that a user is a member of.
"KRN",19,20403,20)
S USRLTMPL="USR SHOW MEMBERSHIP BY USER" D MAIN^USRULST
"KRN",19,20403,"U")
SHOW MEMBERSHIP BY USER
"KRN",19,20404,-1)
0^3
"KRN",19,20404,0)
USR SHOW MEMBERSHIP^Show Class Membership^^M^^^^^^^^^^1^^^1
"KRN",19,20404,1,0)
^^1^1^2980227^^^^
"KRN",19,20404,1,1,0)
Menu for showing class memberships
"KRN",19,20404,10,0)
^19.01IP^2^2
"KRN",19,20404,10,1,0)
20402^2^2
"KRN",19,20404,10,1,"^")
USR SHOW MEMBERSHIP BY CLASS
"KRN",19,20404,10,2,0)
20403^1^1
"KRN",19,20404,10,2,"^")
USR SHOW MEMBERSHIP BY USER
"KRN",19,20404,20)
Q
"KRN",19,20404,26)
W !!,$$CENTER^USRLS("--- Show Class Membership ---")
"KRN",19,20404,99)
57405,51011
"KRN",19,20404,"U")
SHOW CLASS MEMBERSHIP
"KRN",101,3945,-1)
0^4
"KRN",101,3945,0)
USR CLASS MEMBERSHIP CHANGE VIEW^Change View^^A^^^^^^^^AUTHORIZATION/SUBSCRIPTION
"KRN",101,3945,15)
S VALMBCK="Q"
"KRN",101,3945,20)
D FULL^VALM1,MAIN^USRMLST
"KRN",101,3945,99)
57306,34807
"KRN",101,3946,-1)
0^5
"KRN",101,3946,0)
USR CLASS MEMBER USER CHANGE VIEW^Change View^^A^^^^^^^^AUTHORIZATION/SUBSCRIPTION
"KRN",101,3946,15)
S VALMBCK="Q"
"KRN",101,3946,20)
D FULL^VALM1,MAIN^USRULST
"KRN",101,3946,99)
57306,34807
"KRN",101,3948,-1)
0^3
"KRN",101,3948,0)
USR CLASS ACTION QUIT^Quit^^A^^^^^^^^AUTHORIZATION/SUBSCRIPTION
"KRN",101,3948,1,0)
^^1^1^2960222^
"KRN",101,3948,1,1,0)
Allows user to quit current menu level.
"KRN",101,3948,20)
Q
"KRN",101,3948,99)
57306,34807
"KRN",101,4025,-1)
0^2
"KRN",101,4025,0)
USR SHOW USER MEMBERSHIP MENU^Show User Class Membership Menu^^M^^^^^^^^AUTHORIZATION/SUBSCRIPTION
"KRN",101,4025,1,0)
^^1^1^2980227^^^^
"KRN",101,4025,1,1,0)
Menu of action to show user class memberships.
"KRN",101,4025,4)
26
"KRN",101,4025,10,0)
^101.01PA^15^2
"KRN",101,4025,10,14,0)
3946^^9^
"KRN",101,4025,10,14,"^")
USR CLASS MEMBER USER CHANGE VIEW
"KRN",101,4025,10,15,0)
3948^^10^
"KRN",101,4025,10,15,"^")
USR CLASS ACTION QUIT
"KRN",101,4025,20)
S XQORM("SH")=0 S:$G(VALMSG)'["*" VALMSG="+ Next Screen  - Prev Screen  ?? More Actions",VALM("MAX")=+$G(VALMCNT)
"KRN",101,4025,24)
I 1 X:$D(^ORD(101,+$P(^ORD(101,DA(1),10,DA,0),"^"),24)) ^(24)
"KRN",101,4025,26)
S XQORM("#")=$G(^TMP("USRUSER",$J,"#")) D RESIZE^USRLM((IOSL-2),18),SHOW^VALM K XQORM("XLATE","FIND")
"KRN",101,4025,28)
Select Action:
"KRN",101,4025,99)
57405,51061
"KRN",101,4026,-1)
0^1
"KRN",101,4026,0)
USR SHOW CLASS MEMBERSHIP MENU^Show Class Membership Menu^^M^^^^^^^^AUTHORIZATION/SUBSCRIPTION
"KRN",101,4026,1,0)
^^1^1^2980227^^^^
"KRN",101,4026,1,1,0)
Menu for showing members of User Classes.
"KRN",101,4026,4)
26
"KRN",101,4026,10,0)
^101.01PA^16^2
"KRN",101,4026,10,14,0)
3945^^9^
"KRN",101,4026,10,14,"^")
USR CLASS MEMBERSHIP CHANGE VIEW
"KRN",101,4026,10,16,0)
3948^^10^
"KRN",101,4026,10,16,"^")
USR CLASS ACTION QUIT
"KRN",101,4026,20)
S XQORM("SH")=0 S:$G(VALMSG)'["*" VALMSG="+ Next Screen  - Prev Screen  ?? More Actions",VALM("MAX")=+$G(VALMCNT)+1
"KRN",101,4026,24)
I 1 X:$D(^ORD(101,+$P(^ORD(101,DA(1),10,DA,0),"^"),24)) ^(24)
"KRN",101,4026,26)
S XQORM("#")=$G(^TMP("USRMMBR",$J,"#")) D RESIZE^USRLM((IOSL-2),18),SHOW^VALM K XQORM("XLATE","FIND")
"KRN",101,4026,28)
Select Action:
"KRN",101,4026,99)
57405,51073
"KRN",409.61,427,-1)
0^1
"KRN",409.61,427,0)
USR SHOW MEMBERSHIP BY CLASS^1^^142^4^18^1^1^Member^USR SHOW CLASS MEMBERSHIP MENU^User Class Members
"KRN",409.61,427,1)
^USR HIDDEN ACTIONS
"KRN",409.61,427,"ARRAY")
 ^TMP("USRMMBR",$J)
"KRN",409.61,427,"COL",0)
^409.621^5^5
"KRN",409.61,427,"COL",1,0)
NUMBER^1^5
"KRN",409.61,427,"COL",2,0)
MEMBER^6^30^Member^^1
"KRN",409.61,427,"COL",3,0)
EFFECTIVE^61^9^Effective
"KRN",409.61,427,"COL",4,0)
EXPIRES^72^8^Expires
"KRN",409.61,427,"COL",5,0)
CLASS^82^60^Specific Class
"KRN",409.61,427,"COL","AIDENT",1,2)

"KRN",409.61,427,"COL","B","CLASS",5)

"KRN",409.61,427,"COL","B","EFFECTIVE",3)

"KRN",409.61,427,"COL","B","EXPIRES",4)

"KRN",409.61,427,"COL","B","MEMBER",2)

"KRN",409.61,427,"COL","B","NUMBER",1)

"KRN",409.61,427,"FNL")
D CLEAN^USRMLST
"KRN",409.61,427,"HDR")
D HDR^USRMLST
"KRN",409.61,427,"HLP")
D PROTOCOL^USRHELP
"KRN",409.61,427,"INIT")
D MAKELIST^USRMLST
"KRN",409.61,428,-1)
0^2
"KRN",409.61,428,0)
USR SHOW MEMBERSHIP BY USER^1^^80^4^18^1^1^Class^USR SHOW USER MEMBERSHIP MENU^Current User Classes
"KRN",409.61,428,1)
^USR HIDDEN ACTIONS
"KRN",409.61,428,"ARRAY")
 ^TMP("USRUSER",$J)
"KRN",409.61,428,"COL",0)
^409.621^4^4
"KRN",409.61,428,"COL",1,0)
NUMBER^1^5
"KRN",409.61,428,"COL",2,0)
CLASS^6^30^User Class^^1
"KRN",409.61,428,"COL",3,0)
EFFECTIVE^61^9^Effective
"KRN",409.61,428,"COL",4,0)
EXPIRES^72^8^Expires
"KRN",409.61,428,"COL","AIDENT",1,2)

"KRN",409.61,428,"COL","B","CLASS",2)

"KRN",409.61,428,"COL","B","EFFECTIVE",3)

"KRN",409.61,428,"COL","B","EXPIRES",4)

"KRN",409.61,428,"COL","B","NUMBER",1)

"KRN",409.61,428,"FNL")
D CLEAN^USRULST
"KRN",409.61,428,"HDR")
D HDR^USRULST
"KRN",409.61,428,"HLP")
D PROTOCOL^USRHELP
"KRN",409.61,428,"INIT")
D MAKELIST^USRULST
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"ORD",17,409.61)
409.61;17;1;;;;;;;LMDEL^XPDIA1
"ORD",17,409.61,0)
LIST TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",419,-1)
1^1
"PKG",419,0)
AUTHORIZATION/SUBSCRIPTION^USR^User Authorization
"PKG",419,22,0)
^9.49I^1^1
"PKG",419,22,1,0)
1.0^2970620^2971124^117
"PKG",419,22,1,"PAH",1,0)
4^2980304
"PKG",419,22,1,"PAH",1,1,0)
^^3^3^2980304
"PKG",419,22,1,"PAH",1,1,1,0)
ASU patch 4, USR*1.0*4. This patch adds options that allow examination
"PKG",419,22,1,"PAH",1,1,2,0)
of class memberships without editing capabilites. See the National
"PKG",419,22,1,"PAH",1,1,3,0)
Patch module for a complete description.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","USRMLST")
0^1^B8304019
"RTN","USRMLST",1,0)
USRMLST ; SLC/JER - List User Class Members ;3/3/98
"RTN","USRMLST",2,0)
 ;;1.0;AUTHORIZATION/SUBSCRIPTION;**2,3,4**;Jun 20, 1997
"RTN","USRMLST",3,0)
MAIN ; Control Branching
"RTN","USRMLST",4,0)
 N DIC,X,Y,USRDUZ
"RTN","USRMLST",5,0)
 S DIC=8930,DIC(0)="AEMQ",DIC("A")="Select CLASS: "
"RTN","USRMLST",6,0)
 D ^DIC Q:+Y'>0
"RTN","USRMLST",7,0)
 S USRDA=+Y
"RTN","USRMLST",8,0)
 D EN^VALM(USRLTMPL)
"RTN","USRMLST",9,0)
 Q
"RTN","USRMLST",10,0)
MAKELIST ; Build review screen list
"RTN","USRMLST",11,0)
 K VALMY
"RTN","USRMLST",12,0)
 W !,"Searching for the User Classes."
"RTN","USRMLST",13,0)
 D BUILD(USRDA)
"RTN","USRMLST",14,0)
 Q
"RTN","USRMLST",15,0)
BUILD(USRDA) ; Build List
"RTN","USRMLST",16,0)
 N USRCNT,USRNAME,USRPICK
"RTN","USRMLST",17,0)
 S (USRCNT,VALMCNT)=0
"RTN","USRMLST",18,0)
 S USRPICK=+$O(^ORD(101,"B","USR ACTION SELECT LIST ELEMENT",0))
"RTN","USRMLST",19,0)
 K ^TMP("USRMMBR",$J),^TMP("USRMMBRIDX",$J),^TMP("USRM",$J)
"RTN","USRMLST",20,0)
 D WHOIS^USRLM("^TMP(""USRM"",$J)",USRDA)
"RTN","USRMLST",21,0)
 S USRNAME=0
"RTN","USRMLST",22,0)
 F  S USRNAME=$O(^TMP("USRM",$J,USRNAME)) Q:USRNAME=""  D
"RTN","USRMLST",23,0)
 . N USRDA,USRDUZ,USRSIGNM,USREFF,USREXP,USRMEM,USRREC,USRCLNM
"RTN","USRMLST",24,0)
 . S USRMEM=$G(^TMP("USRM",$J,USRNAME))
"RTN","USRMLST",25,0)
 . S USRDUZ=+USRMEM,USRSIGNM=$$SIGNAME^USRLS(+USRDUZ)
"RTN","USRMLST",26,0)
 .;==== START USR*1.0*2 PKR =============================================
"RTN","USRMLST",27,0)
 .;If this user has been terminated change the name to reflect this.
"RTN","USRMLST",28,0)
 . I $$ISTERM^USRLM(+USRDUZ) S USRSIGNM="(T) "_USRSIGNM
"RTN","USRMLST",29,0)
 .;=== END USR*1.0*2 ====================================================
"RTN","USRMLST",30,0)
 . S USRDA=+$P(USRMEM,U,2),USRCLNM=$P(USRMEM,U,3)
"RTN","USRMLST",31,0)
 . S USREFF=$$DATE^USRLS(+$P(USRMEM,U,4),"MM/DD/YY")
"RTN","USRMLST",32,0)
 . S USREXP=$$DATE^USRLS(+$P(USRMEM,U,5),"MM/DD/YY")
"RTN","USRMLST",33,0)
 . S USRCNT=+$G(USRCNT)+1
"RTN","USRMLST",34,0)
 . S USRREC=$$SETFLD^VALM1(USRCNT,"","NUMBER")
"RTN","USRMLST",35,0)
 . S USRREC=$$SETFLD^VALM1(USRSIGNM,USRREC,"MEMBER")
"RTN","USRMLST",36,0)
 . S USRREC=$$SETFLD^VALM1(USREFF,USRREC,"EFFECTIVE")
"RTN","USRMLST",37,0)
 . S USRREC=$$SETFLD^VALM1(USREXP,USRREC,"EXPIRES")
"RTN","USRMLST",38,0)
 . S USRREC=$$SETFLD^VALM1(USRCLNM,USRREC,"CLASS")
"RTN","USRMLST",39,0)
 . S VALMCNT=+$G(VALMCNT)+1
"RTN","USRMLST",40,0)
 . S ^TMP("USRMMBR",$J,VALMCNT,0)=USRREC
"RTN","USRMLST",41,0)
 . S ^TMP("USRMMBR",$J,"IDX",VALMCNT,USRCNT)=""
"RTN","USRMLST",42,0)
 . S ^TMP("USRMMBRIDX",$J,USRCNT)=VALMCNT_U_USRDA W:VALMCNT#10'>0 "."
"RTN","USRMLST",43,0)
 S ^TMP("USRMMBR",$J,0)=+$G(USRCNT)_U_$P(^TMP("USRM",$J,0),U,2)
"RTN","USRMLST",44,0)
 S ^TMP("USRMMBR",$J,"#")=USRPICK_U_"1:"_USRCNT
"RTN","USRMLST",45,0)
 I $D(VALMHDR)>9 D HDR
"RTN","USRMLST",46,0)
 I +$G(USRCNT)'>0 D
"RTN","USRMLST",47,0)
 . S ^TMP("USRMMBR",$J,1,0)="",VALMCNT=2
"RTN","USRMLST",48,0)
 . S ^TMP("USRMMBR",$J,2,0)="No "_$P(^TMP("USRM",$J,0),U,2)_"s found"
"RTN","USRMLST",49,0)
 Q
"RTN","USRMLST",50,0)
HDR ; Initialize header for review screen
"RTN","USRMLST",51,0)
 N BY,USRX,USRCNT,TITLE,USRCLASS
"RTN","USRMLST",52,0)
 S USRX=$G(^TMP("USRMMBR",$J,0)),USRCLASS=$P(USRX,U,2)
"RTN","USRMLST",53,0)
 S TITLE=USRCLASS_"s"
"RTN","USRMLST",54,0)
 S USRCNT=$J(+USRX,4)_" Member"_$S(+USRX=1:"",1:"s")
"RTN","USRMLST",55,0)
 S VALMHDR(1)=$$CENTER^USRLS(TITLE)
"RTN","USRMLST",56,0)
 S VALMHDR(1)=$$SETSTR^VALM1(USRCNT,VALMHDR(1),(IOM-$L(USRCNT)),$L(USRCNT))
"RTN","USRMLST",57,0)
 Q
"RTN","USRMLST",58,0)
CLEAN ; "Joel...Clean up your mess!"
"RTN","USRMLST",59,0)
 K ^TMP("USRMMBR",$J),^TMP("USRMMBRIDX",$J),^TMP("USRM",$J)
"RTN","USRMLST",60,0)
 Q
"RTN","USRULST")
0^2^B6868880
"RTN","USRULST",1,0)
USRULST ; SLC/JER - List Class Membership by user ;3/3/98
"RTN","USRULST",2,0)
 ;;1.0;AUTHORIZATION/SUBSCRIPTION;**2,3,4**;Jun 20, 1997
"RTN","USRULST",3,0)
MAIN ; Control Branching
"RTN","USRULST",4,0)
 N DIC,X,Y,USRDUZ
"RTN","USRULST",5,0)
 S DIC=200,DIC(0)="AEMQ",DIC("A")="Select USER: "
"RTN","USRULST",6,0)
 D ^DIC Q:+Y'>0
"RTN","USRULST",7,0)
 S USRDUZ=+Y
"RTN","USRULST",8,0)
 D EN^VALM(USRLTMPL)
"RTN","USRULST",9,0)
 Q
"RTN","USRULST",10,0)
MAKELIST ; Build review screen list
"RTN","USRULST",11,0)
 W !,"Searching for the User Classes."
"RTN","USRULST",12,0)
 D BUILD(USRDUZ)
"RTN","USRULST",13,0)
 Q
"RTN","USRULST",14,0)
BUILD(USRDUZ) ; Build List
"RTN","USRULST",15,0)
 N USRCNT,USRNAME,USRPICK
"RTN","USRULST",16,0)
 S (USRCNT,VALMCNT)=0
"RTN","USRULST",17,0)
 S USRPICK=+$O(^ORD(101,"B","TIU ACTION SELECT LIST ELEMENT",0))
"RTN","USRULST",18,0)
 K ^TMP("USRUSER",$J),^TMP("USRUSERIDX",$J),^TMP("USRU",$J)
"RTN","USRULST",19,0)
 D WHATIS^USRLM(USRDUZ,"^TMP(""USRU"",$J)")
"RTN","USRULST",20,0)
 S USRNAME=0
"RTN","USRULST",21,0)
 F  S USRNAME=$O(^TMP("USRU",$J,USRNAME)) Q:USRNAME=""  D
"RTN","USRULST",22,0)
 . N USRDA,USREFF,USREXP,USRMEM,USRREC,USRCLNM
"RTN","USRULST",23,0)
 . S USRMEM=$G(^TMP("USRU",$J,USRNAME))
"RTN","USRULST",24,0)
 . S USRDA=+$P(USRMEM,U,2),USRSIGNM=$$SIGNAME^USRLS(+USRDUZ)
"RTN","USRULST",25,0)
 . S USRCLNM=$P(USRMEM,U,3)
"RTN","USRULST",26,0)
 . S USREFF=$$DATE^USRLS(+$P(USRMEM,U,4),"MM/DD/YY")
"RTN","USRULST",27,0)
 . S USREXP=$$DATE^USRLS(+$P(USRMEM,U,5),"MM/DD/YY")
"RTN","USRULST",28,0)
 . S USRCNT=+$G(USRCNT)+1
"RTN","USRULST",29,0)
 . S USRREC=$$SETFLD^VALM1(USRCNT,"","NUMBER")
"RTN","USRULST",30,0)
 . S USRREC=$$SETFLD^VALM1(USRCLNM,USRREC,"CLASS")
"RTN","USRULST",31,0)
 . S USRREC=$$SETFLD^VALM1(USREFF,USRREC,"EFFECTIVE")
"RTN","USRULST",32,0)
 . S USRREC=$$SETFLD^VALM1(USREXP,USRREC,"EXPIRES")
"RTN","USRULST",33,0)
 . S VALMCNT=+$G(VALMCNT)+1
"RTN","USRULST",34,0)
 . S ^TMP("USRUSER",$J,VALMCNT,0)=USRREC
"RTN","USRULST",35,0)
 . S ^TMP("USRUSER",$J,"IDX",VALMCNT,USRCNT)=""
"RTN","USRULST",36,0)
 . S ^TMP("USRUSERIDX",$J,USRCNT)=VALMCNT_U_USRDA W:VALMCNT#10'>0 "."
"RTN","USRULST",37,0)
 S ^TMP("USRUSER",$J,0)=+$G(USRCNT)_U_$P(^TMP("USRU",$J,0),U,2)
"RTN","USRULST",38,0)
 S ^TMP("USRUSER",$J,"#")=USRPICK_"^0:"_+$G(USRCNT)
"RTN","USRULST",39,0)
 I $D(VALMHDR)>9 D HDR
"RTN","USRULST",40,0)
 I +$G(USRCNT)'>0 D
"RTN","USRULST",41,0)
 . S ^TMP("USRUSER",$J,1,0)="",VALMCNT=2
"RTN","USRULST",42,0)
 . S ^TMP("USRUSER",$J,2,0)="No Class Memberships found for "_$P(^TMP("USRU",$J,0),U,2)
"RTN","USRULST",43,0)
 Q
"RTN","USRULST",44,0)
HDR ; Initialize header for review screen
"RTN","USRULST",45,0)
 N BY,USRX,USRCNT,TITLE,USRNAME
"RTN","USRULST",46,0)
 S USRX=$G(^TMP("USRUSER",$J,0)),USRNAME=$P(USRX,U,2)
"RTN","USRULST",47,0)
 S TITLE=USRNAME
"RTN","USRULST",48,0)
 ;==== START USR*1.0*2 PKR =============================================
"RTN","USRULST",49,0)
 ;If this user has been terminated change the title to reflect this.
"RTN","USRULST",50,0)
 I $$ISTERM^USRLM(USRDUZ) S TITLE=TITLE_" (terminated)"
"RTN","USRULST",51,0)
 ;=== END USR*1.0*2 ====================================================
"RTN","USRULST",52,0)
 S USRCNT=$J(+USRX,4)_" Class"_$S(+USRX=1:"",1:"es")
"RTN","USRULST",53,0)
 S VALMHDR(1)=$$CENTER^USRLS(TITLE)
"RTN","USRULST",54,0)
 S VALMHDR(1)=$$SETSTR^VALM1(USRCNT,VALMHDR(1),(IOM-$L(USRCNT)),$L(USRCNT))
"RTN","USRULST",55,0)
 Q
"RTN","USRULST",56,0)
CLEAN ; "Joel...Clean up your mess!"
"RTN","USRULST",57,0)
 K ^TMP("USRUSER",$J),^TMP("USRUSERIDX",$J),^TMP("USRU",$J)
"RTN","USRULST",58,0)
 Q
"VER")
8.0^21.0
**END**
**END**
