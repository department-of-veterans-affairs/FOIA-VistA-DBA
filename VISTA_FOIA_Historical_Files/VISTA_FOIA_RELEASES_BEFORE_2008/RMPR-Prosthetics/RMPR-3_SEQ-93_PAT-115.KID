Released RMPR*3*115 SEQ #93
Extracted from mail message
**KIDS**:RMPR*3.0*115^

**INSTALL NAME**
RMPR*3.0*115
"BLD",5934,0)
RMPR*3.0*115^PROSTHETICS^0^3060120^y
"BLD",5934,1,0)
^^4^4^3060120^
"BLD",5934,1,1,0)
 
"BLD",5934,1,2,0)
1. RMPR Clerk Menu not prompting for site
"BLD",5934,1,3,0)
2. Extra line feeds in Purchase Order ITEMS section after patch 90
"BLD",5934,1,4,0)
3. Oxygen letters: site name wrapping into patient's address
"BLD",5934,4,0)
^9.64PA^^
"BLD",5934,6.3)
10
"BLD",5934,"ABPKG")
n
"BLD",5934,"INIT")
RMPR115P
"BLD",5934,"KRN",0)
^9.67PA^8989.52^19
"BLD",5934,"KRN",.4,0)
.4
"BLD",5934,"KRN",.401,0)
.401
"BLD",5934,"KRN",.402,0)
.402
"BLD",5934,"KRN",.403,0)
.403
"BLD",5934,"KRN",.5,0)
.5
"BLD",5934,"KRN",.84,0)
.84
"BLD",5934,"KRN",3.6,0)
3.6
"BLD",5934,"KRN",3.8,0)
3.8
"BLD",5934,"KRN",9.2,0)
9.2
"BLD",5934,"KRN",9.8,0)
9.8
"BLD",5934,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",5934,"KRN",9.8,"NM",1,0)
RMPR4P22^^0^22130893
"BLD",5934,"KRN",9.8,"NM",2,0)
RMPOLF0^^0^18521534
"BLD",5934,"KRN",9.8,"NM",3,0)
RMPOLF0A^^0^18178558
"BLD",5934,"KRN",9.8,"NM",4,0)
RMPR115P^^0^442240
"BLD",5934,"KRN",9.8,"NM","B","RMPOLF0",2)

"BLD",5934,"KRN",9.8,"NM","B","RMPOLF0A",3)

"BLD",5934,"KRN",9.8,"NM","B","RMPR115P",4)

"BLD",5934,"KRN",9.8,"NM","B","RMPR4P22",1)

"BLD",5934,"KRN",19,0)
19
"BLD",5934,"KRN",19,"NM",0)
^9.68A^^0
"BLD",5934,"KRN",19.1,0)
19.1
"BLD",5934,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",5934,"KRN",101,0)
101
"BLD",5934,"KRN",409.61,0)
409.61
"BLD",5934,"KRN",771,0)
771
"BLD",5934,"KRN",870,0)
870
"BLD",5934,"KRN",8989.51,0)
8989.51
"BLD",5934,"KRN",8989.52,0)
8989.52
"BLD",5934,"KRN",8994,0)
8994
"BLD",5934,"KRN","B",.4,.4)

"BLD",5934,"KRN","B",.401,.401)

"BLD",5934,"KRN","B",.402,.402)

"BLD",5934,"KRN","B",.403,.403)

"BLD",5934,"KRN","B",.5,.5)

"BLD",5934,"KRN","B",.84,.84)

"BLD",5934,"KRN","B",3.6,3.6)

"BLD",5934,"KRN","B",3.8,3.8)

"BLD",5934,"KRN","B",9.2,9.2)

"BLD",5934,"KRN","B",9.8,9.8)

"BLD",5934,"KRN","B",19,19)

"BLD",5934,"KRN","B",19.1,19.1)

"BLD",5934,"KRN","B",101,101)

"BLD",5934,"KRN","B",409.61,409.61)

"BLD",5934,"KRN","B",771,771)

"BLD",5934,"KRN","B",870,870)

"BLD",5934,"KRN","B",8989.51,8989.51)

"BLD",5934,"KRN","B",8989.52,8989.52)

"BLD",5934,"KRN","B",8994,8994)

"BLD",5934,"QUES",0)
^9.62^^
"BLD",5934,"REQB",0)
^9.611^2^2
"BLD",5934,"REQB",1,0)
RMPR*3.0*55^2
"BLD",5934,"REQB",2,0)
RMPR*3.0*90^2
"BLD",5934,"REQB","B","RMPR*3.0*55",1)

"BLD",5934,"REQB","B","RMPR*3.0*90",2)

"INIT")
RMPR115P
"MBREQ")
0
"PKG",101,-1)
1^1
"PKG",101,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",101,20,0)
^9.402P^^0
"PKG",101,22,0)
^9.49I^1^1
"PKG",101,22,1,0)
3.0^2960209^2960214
"PKG",101,22,1,"PAH",1,0)
115^3060120
"PKG",101,22,1,"PAH",1,1,0)
^^4^4^3060120
"PKG",101,22,1,"PAH",1,1,1,0)
 
"PKG",101,22,1,"PAH",1,1,2,0)
1. RMPR Clerk Menu not prompting for site
"PKG",101,22,1,"PAH",1,1,3,0)
2. Extra line feeds in Purchase Order ITEMS section after patch 90
"PKG",101,22,1,"PAH",1,1,4,0)
3. Oxygen letters: site name wrapping into patient's address
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","RMPOLF0")
0^2^B18521534^B17918952
"RTN","RMPOLF0",1,0)
RMPOLF0 ;HIN CIOFO/RVD-DRIVER FOR HO LETTERS ;06/22/99
"RTN","RMPOLF0",2,0)
 ;;3.0;PROSTHETICS;**29,55,115**;Feb 09, 1996
"RTN","RMPOLF0",3,0)
 ;
"RTN","RMPOLF0",4,0)
 ; ODJ - patch 55 - 1/29/01 - replace 121 hard code mail symbol with
"RTN","RMPOLF0",5,0)
 ;                            call to site param. extrinsic
"RTN","RMPOLF0",6,0)
 ;                            see nois AUG-1097-32118
"RTN","RMPOLF0",7,0)
 ;
"RTN","RMPOLF0",8,0)
 D HOME^%ZIS S RMPRIN=0
"RTN","RMPOLF0",9,0)
 K VADM,^TMP("RL",$J)
"RTN","RMPOLF0",10,0)
 S Y=DT D DD^%DT S NAME=Y D TRANS^RMPRUTL1 S (RMPODT,RMPODATE)=RMPRNAME
"RTN","RMPOLF0",11,0)
 D PIKSOM Q:$$QUIT  I Y="" S VALMBCK="R" Q
"RTN","RMPOLF0",12,0)
 M ^TMP("RL",$J)=^TMP($J)
"RTN","RMPOLF0",13,0)
 S LFNS=Y I 'JOB D FULL^VALM1
"RTN","RMPOLF0",14,0)
 ;
"RTN","RMPOLF0",15,0)
QUED ;
"RTN","RMPOLF0",16,0)
 F ZI=1:1:$L(LFNS,",")-1 D
"RTN","RMPOLF0",17,0)
 . S LFN=$P(LFNS,",",ZI) Q:LFN'>0
"RTN","RMPOLF0",18,0)
 . S RMPONAM="",CNT=0 F  S RMPONAM=$O(^TMP("RL",$J,RMPOXITE,"RMPOLST",RMPOLCD,RMPONAM)) Q:RMPONAM=""  D
"RTN","RMPOLF0",19,0)
 .. S RMPOLTR=$P(^TMP("RL",$J,RMPOXITE,"RMPOLST",RMPOLCD,RMPONAM),U,1)
"RTN","RMPOLF0",20,0)
 .. S RMPODFN=$P(^TMP("RL",$J,RMPOXITE,"RMPOLST",RMPOLCD,RMPONAM),U,2)
"RTN","RMPOLF0",21,0)
 .. S RMDA=$P(^TMP("RL",$J,RMPOXITE,"RMPOLST",RMPOLCD,RMPONAM),U,3)
"RTN","RMPOLF0",22,0)
 .. S CNT=CNT+1
"RTN","RMPOLF0",23,0)
 .. S:CNT=LFN ^TMP("RL",$J,RMPOXITE,"LTR",RMPONAM)=RMPODFN_"^"_RMPOLTR_"^"_RMDA
"RTN","RMPOLF0",24,0)
 S (RMBLNK,RMPONAM)="",RMQUIT=0
"RTN","RMPOLF0",25,0)
 F  S RMPONAM=$O(^TMP("RL",$J,RMPOXITE,"LTR",RMPONAM)) Q:RMPONAM=""!$G(RMQUIT)  D CUM
"RTN","RMPOLF0",26,0)
 ;end
"RTN","RMPOLF0",27,0)
EXIT ;
"RTN","RMPOLF0",28,0)
 K LFNS,LFN,ZI,RTN,DIR,RMLET,^TMP($J)
"RTN","RMPOLF0",29,0)
 K %X,RMPRFFL,RMPRHED,RMPRPRIN,%Y,RMPRDEL,RMPRRVA,DIC,RMPRFA,KILL,DIE,DA
"RTN","RMPOLF0",30,0)
 K DR,DIK,RMPR1,RMPR2,RMPRDATE,RMPRIN,RMPRL,RMPRNAME,RMPRU,RMPRDELE,FR
"RTN","RMPOLF0",31,0)
 K RMPREND,VADM,VAPA,VA,NAME,RMPRGO,NAME1,RMPONAM
"RTN","RMPOLF0",32,0)
 K RMPRDEN,RMPRFLAG,RMPRNAM1,RMPRNAM2,RMPRFF,J,RP,RO,RZ D KVAR^VADPT
"RTN","RMPOLF0",33,0)
 M ^TMP($J)=^TMP("RL",$J) K ^TMP("RL",$J)
"RTN","RMPOLF0",34,0)
 D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@" Q:$D(ZTQUEUED)
"RTN","RMPOLF0",35,0)
 D HOME^%ZIS D CLEAN^VALM10,INIT^RMPOLT S VALMBCK="R"
"RTN","RMPOLF0",36,0)
 Q
"RTN","RMPOLF0",37,0)
 ;
"RTN","RMPOLF0",38,0)
CUM ;
"RTN","RMPOLF0",39,0)
 K RMPRNT S RDATA=^TMP("RL",$J,RMPOXITE,"LTR",RMPONAM)
"RTN","RMPOLF0",40,0)
 S DFN=$P(RDATA,U,1),RMPOLTR=$P(RDATA,U,2),RMDA=$P(RDATA,U,3)
"RTN","RMPOLF0",41,0)
 S RMREC=^TMP("RL",$J,RMPOXITE,"RMPODEMO",DFN)
"RTN","RMPOLF0",42,0)
 S RMPORX=$P(RMREC,U,6) S:RMPORX="" RMPORX="Not on file"
"RTN","RMPOLF0",43,0)
 S RMPORXDT=$P(RMREC,U,4)
"RTN","RMPOLF0",44,0)
 I RMPORXDT="" S RMPORXDT="n/a"
"RTN","RMPOLF0",45,0)
 E  S Y=RMPORXDT X ^DD("DD") S RMPORXDT=Y
"RTN","RMPOLF0",46,0)
 S RMPRFA=RMPOLTR
"RTN","RMPOLF0",47,0)
 D DEM^VADPT,ADD^VADPT
"RTN","RMPOLF0",48,0)
 F RI=1:1:21 S ^TMP($J,"DW",RI,0)=" "
"RTN","RMPOLF0",49,0)
HEADER1 ;
"RTN","RMPOLF0",50,0)
 S RMPRHED=$G(^TMP("RL",$J,RMPOXITE,"HEADER",RMPOLTR))
"RTN","RMPOLF0",51,0)
 W @IOF I 'RMPRHED G HEADER
"RTN","RMPOLF0",52,0)
 S ^TMP($J,"DW",1,0)="|SETTAB(""C"")|"
"RTN","RMPOLF0",53,0)
 S ^TMP($J,"DW",2,0)="|TAB|Department of Veterans Affairs"
"RTN","RMPOLF0",54,0)
 S NAME=$P(^RMPR(669.9,RMPOXITE,2),U,4) I NAME]"" S NAME=$S($D(^DIC(5,NAME)):$P(^DIC(5,NAME,0),U),1:"STATE") S RMFXN=$$PARS^RMPRUTL1(NAME)
"RTN","RMPOLF0",55,0)
 S ^TMP($J,"DW",3,0)="|TAB|"_$P(^RMPR(669.9,RMPOXITE,0),U)
"RTN","RMPOLF0",56,0)
 S ^TMP($J,"DW",4,0)="|TAB|"_$P(^RMPR(669.9,RMPOXITE,2),U,2)
"RTN","RMPOLF0",57,0)
 S ^TMP($J,"DW",5,0)="|TAB|"_$P(^RMPR(669.9,RMPOXITE,2),U,3)_", "_RMFXN_" "_$P(^RMPR(669.9,RMPOXITE,2),U,5) K RMFXN
"RTN","RMPOLF0",58,0)
HEADER ;
"RTN","RMPOLF0",59,0)
 S ^TMP($J,"DW",9,0)="|SETTAB(5,50)||TAB|"_RMPODT
"RTN","RMPOLF0",60,0)
 S STATNID=$P(^RMPR(669.9,RMPOXITE,0),U,2) I $D(^DIC(4,STATNID,99)) S STATNID=$P(^DIC(4,STATNID,99),U)
"RTN","RMPOLF0",61,0)
 S ^TMP($J,"DW",11,0)="|TAB|"_$P(VADM(1),",",2)_" "_$P(VADM(1),",",1)_"|TAB|In Reply Refer To: "_STATNID_"/"_$$ROU^RMPRUTIL(RMPOXITE)
"RTN","RMPOLF0",62,0)
 K STATNID
"RTN","RMPOLF0",63,0)
 S ^TMP($J,"DW",12,0)="|TAB|"_VAPA(1)_"|TAB|SSN: "_$P(VADM(2),U,2)
"RTN","RMPOLF0",64,0)
 I VAPA(2)]"" S ^TMP($J,"DW",13,0)="|TAB|"_VAPA(2)_"|TAB|"_VADM(1),^TMP($J,"DW",14,0)="|TAB|"_VAPA(4)_","_" "_$P(VAPA(5),U,2)_" "_VAPA(6)
"RTN","RMPOLF0",65,0)
 E  S ^TMP($J,"DW",13,0)="|TAB|"_VAPA(4)_","_" "_$P(VAPA(5),U,2)_" "_VAPA(6)_"|TAB|"_VADM(1)
"RTN","RMPOLF0",66,0)
 ;
"RTN","RMPOLF0",67,0)
 S ^TMP($J,"DW",15,0)="|TAB|"_RMBLNK_"|TAB|"_DFN
"RTN","RMPOLF0",68,0)
 S ^TMP($J,"DW",16,0)="|TAB|"_RMBLNK_"|TAB|Current Home Oxygen Rx#: "_RMPORX
"RTN","RMPOLF0",69,0)
 S ^TMP($J,"DW",17,0)="|TAB|"_RMBLNK_"|TAB|Rx Expiration Date: "_RMPORXDT
"RTN","RMPOLF0",70,0)
 ;
"RTN","RMPOLF0",71,0)
 S NAME=$P(VADM(1),",")
"RTN","RMPOLF0",72,0)
 I $P(NAME," ",2)?1A.A D
"RTN","RMPOLF0",73,0)
 .S NAME1=NAME,NAME=$P(NAME," ",1) D TRANS^RMPRUTL1 S RMPRNAM1=RMPRNAME,NAME=NAME1,NAME=$P(NAME," ",2) D TRANS^RMPRUTL1 S RMPRNAM2=RMPRNAME,RMPRNAME=RMPRNAM1_" "_RMPRNAM2
"RTN","RMPOLF0",74,0)
 E  D TRANS^RMPRUTL1
"RTN","RMPOLF0",75,0)
 D NAME^RMPOLF1
"RTN","RMPOLF0",76,0)
 Q
"RTN","RMPOLF0",77,0)
QUIT() S QUIT=$D(DTOUT)!$D(DUOUT)!$D(DIROUT) Q QUIT
"RTN","RMPOLF0",78,0)
 Q
"RTN","RMPOLF0",79,0)
PIKSOM ; ALLOW SELECTION FROM DISPLAYED ENTRIES
"RTN","RMPOLF0",80,0)
 K DIR S DIR(0)="LO^"_VALMBG_":"_VALMLST D ^DIR
"RTN","RMPOLF0",81,0)
 Q
"RTN","RMPOLF0A")
0^3^B18178558^B17619033
"RTN","RMPOLF0A",1,0)
RMPOLF0A ;HIN CIOFO/RVD-DRIVER FOR HO LETTERS(ALL) ;06/28/99
"RTN","RMPOLF0A",2,0)
 ;;3.0;PROSTHETICS;**29,55,115**;Feb 09, 1996
"RTN","RMPOLF0A",3,0)
 ;
"RTN","RMPOLF0A",4,0)
 ; ODJ - patch 55 - 29/1/01 - replace 121 hard coded mail code with call
"RTN","RMPOLF0A",5,0)
 ;                            to site param. extrinsic (AUG-1097-32118)
"RTN","RMPOLF0A",6,0)
 ;
"RTN","RMPOLF0A",7,0)
 D HOME^%ZIS S RMPRIN=0
"RTN","RMPOLF0A",8,0)
 S RMPRTFLG=1
"RTN","RMPOLF0A",9,0)
 S Y=DT D DD^%DT S NAME=Y D TRANS^RMPRUTL1 S (RMPODT,RMPODATE)=RMPRNAME
"RTN","RMPOLF0A",10,0)
 K ZTSAVE,^TMP("RL",$J) D FULL^VALM1
"RTN","RMPOLF0A",11,0)
 M ^TMP("RL",$J)=^TMP($J) K ^TMP($J)
"RTN","RMPOLF0A",12,0)
 ;
"RTN","RMPOLF0A",13,0)
QUED ;
"RTN","RMPOLF0A",14,0)
 S (RMBLNK,RMPONAM)="",RMQUIT=0 S:'$D(ZTQUEUED) RMIOST=IOST,RMIO=IO
"RTN","RMPOLF0A",15,0)
 F  S RMPONAM=$O(^TMP("RL",$J,RMPOXITE,"RMPOLST",RMPOLCD,RMPONAM)) Q:RMPONAM=""!$G(RMQUIT)  D CUM
"RTN","RMPOLF0A",16,0)
 D PRALL^RMPOLF1
"RTN","RMPOLF0A",17,0)
 F RI=0:0 S RI=$O(^TMP("RL",$J,1,RI)) Q:RI'>0  S RMDFN=^TMP("RL",$J,1,RI) D
"RTN","RMPOLF0A",18,0)
 .I RMPOLCD="A" S $P(^RMPR(665,RMDFN,"RMPOA"),U,9)=DT,$P(^("RMPOA"),U,10)="P" K ^RMPR(669.9,RMPOXITE,"RMPOXBAT1") S ^RMPR(669.9,RMPOXITE,"RMPOXBAT1",0)="^669.9002P^^^"
"RTN","RMPOLF0A",19,0)
 .I RMPOLCD="B" S $P(^RMPR(665,RMDFN,"RMPOA"),U,11)=DT,$P(^("RMPOA"),U,12)="P" K ^RMPR(669.9,RMPOXITE,"RMPOXBAT2") S ^RMPR(669.9,RMPOXITE,"RMPOXBAT2",0)="^669.972P^^^"
"RTN","RMPOLF0A",20,0)
 .I RMPOLCD="C" S $P(^RMPR(665,RMDFN,"RMPOA"),U,13)=DT,$P(^("RMPOA"),U,14)="P" K ^RMPR(669.9,RMPOXITE,"RMPOXBAT3") S ^RMPR(669.9,RMPOXITE,"RMPOXBAT3",0)="^669.974P^^^"
"RTN","RMPOLF0A",21,0)
 ;
"RTN","RMPOLF0A",22,0)
EXIT K LFNS,LFN,ZI,RTN,DIR,RMLET,RMPRTFLG,RMPRIN,RMIO,RMIOST,RMION,RMPONAM
"RTN","RMPOLF0A",23,0)
 K RMDAT,DFN,RMDA,RMPRFA,RMDFN,RI
"RTN","RMPOLF0A",24,0)
 M ^TMP($J)=^TMP("RL",$J) K ^TMP("RL",$J)
"RTN","RMPOLF0A",25,0)
 K ^TMP($J,RMPOXITE,"RMPOLST",RMPOLCD)
"RTN","RMPOLF0A",26,0)
 D ^%ZISC S:$D(ZTQUEUED) ZTREQ="@" Q:$D(ZTQUEUED)
"RTN","RMPOLF0A",27,0)
 D CLEAN^VALM10,INIT^RMPOLT,RE^VALM4
"RTN","RMPOLF0A",28,0)
 S VALMBCK="R"
"RTN","RMPOLF0A",29,0)
 Q
"RTN","RMPOLF0A",30,0)
 ;
"RTN","RMPOLF0A",31,0)
CUM ;
"RTN","RMPOLF0A",32,0)
 S RMDAT=^TMP("RL",$J,RMPOXITE,"RMPOLST",RMPOLCD,RMPONAM)
"RTN","RMPOLF0A",33,0)
 S RMPOLTR=$P(RMDAT,U,1)
"RTN","RMPOLF0A",34,0)
 S DFN=$P(RMDAT,U,2)
"RTN","RMPOLF0A",35,0)
 S RMDA=$P(RMDAT,U,3)
"RTN","RMPOLF0A",36,0)
 S RMPRFA=RMPOLTR,RMPRTFLG=1
"RTN","RMPOLF0A",37,0)
 S RMREC=^TMP("RL",$J,RMPOXITE,"RMPODEMO",DFN)
"RTN","RMPOLF0A",38,0)
 S RMPORX=$P(RMREC,U,6) S:RMPORX="" RMPORX="Not on file"
"RTN","RMPOLF0A",39,0)
 S RMPORXDT=$P(RMREC,U,4)
"RTN","RMPOLF0A",40,0)
 I RMPORXDT="" S RMPORXDT="n/a"
"RTN","RMPOLF0A",41,0)
 E  S Y=RMPORXDT X ^DD("DD") S RMPORXDT=Y
"RTN","RMPOLF0A",42,0)
 D DEM^VADPT,ADD^VADPT
"RTN","RMPOLF0A",43,0)
 F RI=1:1:21 S ^TMP($J,"DW",RI,0)=" "
"RTN","RMPOLF0A",44,0)
HEADER1 ;
"RTN","RMPOLF0A",45,0)
 S RMPRHED=$G(^TMP("RL",$J,RMPOXITE,"HEADER",RMPOLTR))
"RTN","RMPOLF0A",46,0)
 W @IOF I 'RMPRHED G HEADER
"RTN","RMPOLF0A",47,0)
 S ^TMP($J,"DW",1,0)="|SETTAB(""C"")|"
"RTN","RMPOLF0A",48,0)
 S ^TMP($J,"DW",2,0)="|TAB|Department of Veterans Affairs"
"RTN","RMPOLF0A",49,0)
 S NAME=$P(^RMPR(669.9,RMPOXITE,2),U,4) I NAME]"" S NAME=$S($D(^DIC(5,NAME)):$P(^DIC(5,NAME,0),U),1:"STATE") S RMFXN=$$PARS^RMPRUTL1(NAME)
"RTN","RMPOLF0A",50,0)
 S ^TMP($J,"DW",3,0)="|TAB|"_$P(^RMPR(669.9,RMPOXITE,0),U)
"RTN","RMPOLF0A",51,0)
 S ^TMP($J,"DW",4,0)="|TAB|"_$P(^RMPR(669.9,RMPOXITE,2),U,2)
"RTN","RMPOLF0A",52,0)
 S ^TMP($J,"DW",5,0)="|TAB|"_$P(^RMPR(669.9,RMPOXITE,2),U,3)_", "_RMFXN_" "_$P(^RMPR(669.9,RMPOXITE,2),U,5) K RMFXN
"RTN","RMPOLF0A",53,0)
HEADER ;
"RTN","RMPOLF0A",54,0)
 S ^TMP($J,"DW",9,0)="|SETTAB(5,50)||TAB|"_RMPODT
"RTN","RMPOLF0A",55,0)
 S STATNID=$P(^RMPR(669.9,RMPOXITE,0),U,2) I $D(^DIC(4,STATNID,99)) S STATNID=$P(^DIC(4,STATNID,99),U)
"RTN","RMPOLF0A",56,0)
 S ^TMP($J,"DW",11,0)="|TAB|"_$P(VADM(1),",",2)_" "_$P(VADM(1),",",1)_"|TAB|In Reply Refer To: "_STATNID_"/"_$$ROU^RMPRUTIL(RMPOXITE)
"RTN","RMPOLF0A",57,0)
 K STATNID
"RTN","RMPOLF0A",58,0)
 S ^TMP($J,"DW",12,0)="|TAB|"_VAPA(1)_"|TAB|SSN: "_$P(VADM(2),U,2)
"RTN","RMPOLF0A",59,0)
 I VAPA(2)]"" S ^TMP($J,"DW",13,0)="|TAB|"_VAPA(2)_"|TAB|"_VADM(1),^TMP($J,"DW",14,0)="|TAB|"_VAPA(4)_","_" "_$P(VAPA(5),U,2)_" "_VAPA(6)
"RTN","RMPOLF0A",60,0)
 E  S ^TMP($J,"DW",13,0)="|TAB|"_VAPA(4)_","_" "_$P(VAPA(5),U,2)_" "_VAPA(6)_"|TAB|"_VADM(1)
"RTN","RMPOLF0A",61,0)
 S ^TMP($J,"DW",15,0)="|TAB|"_RMBLNK_"|TAB|"_DFN
"RTN","RMPOLF0A",62,0)
 S ^TMP($J,"DW",16,0)="|TAB|"_RMBLNK_"|TAB|Current Home Oxygen Rx#: "_RMPORX
"RTN","RMPOLF0A",63,0)
 S ^TMP($J,"DW",17,0)="|TAB|"_RMBLNK_"|TAB|Rx Expiration Date: "_RMPORXDT
"RTN","RMPOLF0A",64,0)
 ;
"RTN","RMPOLF0A",65,0)
 S NAME=$P(VADM(1),",")
"RTN","RMPOLF0A",66,0)
 I $P(NAME," ",2)?1A.A D
"RTN","RMPOLF0A",67,0)
 .S NAME1=NAME,NAME=$P(NAME," ",1) D TRANS^RMPRUTL1 S RMPRNAM1=RMPRNAME,NAME=NAME1,NAME=$P(NAME," ",2) D TRANS^RMPRUTL1 S RMPRNAM2=RMPRNAME,RMPRNAME=RMPRNAM1_" "_RMPRNAM2
"RTN","RMPOLF0A",68,0)
 E  D TRANS^RMPRUTL1
"RTN","RMPOLF0A",69,0)
 D NAME^RMPOLF1
"RTN","RMPOLF0A",70,0)
 Q
"RTN","RMPR115P")
0^4^B442240
"RTN","RMPR115P",1,0)
RMPR115P ;VMP/RB - DELETE FIELD# 19 FOR FILE #660 ;11/7/05
"RTN","RMPR115P",2,0)
 ;;3.0;Prosthetics;**115**;06/20/05
"RTN","RMPR115P",3,0)
 ;;
"RTN","RMPR115P",4,0)
 ;1. Post install to delete in ^DIC(19,int#,20), Entry Action for menu RMPR CLERK 
"RTN","RMPR115P",5,0)
 ;
"RTN","RMPR115P",6,0)
FIX1 ;Null Entry Action field for menu RMPR CLERK
"RTN","RMPR115P",7,0)
 S OIEN=0,SRCH="R"
"RTN","RMPR115P",8,0)
 F  S SRCH=$O(^DIC(19,"B",SRCH)) I SRCH="RMPR CLERK" S OIEN=$O(^DIC(19,"B",SRCH,OIEN)) Q
"RTN","RMPR115P",9,0)
 I OIEN D
"RTN","RMPR115P",10,0)
 . S DR="20////@",DIE="^DIC(19,",DA=OIEN D ^DIE
"RTN","RMPR115P",11,0)
 K OIEN,SRCH,DR,DIE,DA
"RTN","RMPR115P",12,0)
 Q
"RTN","RMPR4P22")
0^1^B22130893^B21879825
"RTN","RMPR4P22",1,0)
RMPR4P22 ;PHX/HNC/RVD-CONT PURCHASE CARD ;3/1/1996
"RTN","RMPR4P22",2,0)
 ;;3.0;PROSTHETICS;**3,20,26,90,115**;Feb 09, 1996
"RTN","RMPR4P22",3,0)
 S RO=0 F I=1:1 S RO=$O(R664(1,RO)) Q:RO'>0  D  Q:$D(J1)
"RTN","RMPR4P22",4,0)
 .I I>4 S J1=1 W !!,?9,"***SEE ATTACHED CONTINUATION SHEET FOR ITEM DESCRIPTION(S)***",!! Q
"RTN","RMPR4P22",5,0)
 .I $D(R664(1,RO,1,0)) S RP=0 F J=1:1 S RP=$O(R664(1,RO,1,RP)) Q:RP=""  D  Q:$D(J1)
"RTN","RMPR4P22",6,0)
 ..I I>4!((J+I)>4) S J1=1 W !!,?9,"***SEE ATTACHED CONTINUATION SHEET FOR ITEM DESCRIPTION(S)***",!! Q
"RTN","RMPR4P22",7,0)
 D ADD
"RTN","RMPR4P22",8,0)
 S RO=0 F  S RO=$O(R664(1,RO)) Q:RO'>0  D:'$D(RMPRMOR)&($Y>36) CONT D:$D(RMPRMOR)&($Y>58) CONT D:'$D(RMPRMOR) ADD D START
"RTN","RMPR4P22",9,0)
 I '$D(RMPRMOR)&($Y<37) F  W ! Q:$Y>36
"RTN","RMPR4P22",10,0)
 Q
"RTN","RMPR4P22",11,0)
START W !,"#"_RO_"."
"RTN","RMPR4P22",12,0)
 S RMPRI=$S($P(R664(1,RO,0),U,7)'="":$P(R664(1,RO,0),U,7),1:$P(R664(1,RO,0),U,3))
"RTN","RMPR4P22",13,0)
 W ?4,$P(R664(1,RO,0),U,2)
"RTN","RMPR4P22",14,0)
 W ?50,$J($P(R664(1,RO,0),U,4),6) S RMPRUT=$P(R664(1,RO,0),U,5) W:$D(^PRCD(420.5,+RMPRUT,0)) ?61,$P(^PRCD(420.5,+RMPRUT,0),U,1),?65,$J($FN(RMPRI,"P",2),6)
"RTN","RMPR4P22",15,0)
ZWE S RMPRTOT=RMPRI*$P(R664(1,RO,0),U,4) W ?72,$J($FN(RMPRTOT,"P",2),8) D EXT
"RTN","RMPR4P22",16,0)
 Q
"RTN","RMPR4P22",17,0)
EXT ;CHECKING FOR EXTENDED DESCRIPTION
"RTN","RMPR4P22",18,0)
 ;serial number
"RTN","RMPR4P22",19,0)
 N RMPRCNT,RMPRSSM,LNCT
"RTN","RMPR4P22",20,0)
 S RMPRCNT=0,LNCT=0
"RTN","RMPR4P22",21,0)
 S RMPRSSM(1)=$P($G(R664(1,RO,0)),U,15)
"RTN","RMPR4P22",22,0)
 S RMPRSSM(2)=$P($G(R664(1,RO,2)),U,1)
"RTN","RMPR4P22",23,0)
 S RMPRSSM(3)=$P($G(R664(1,RO,2)),U,2)
"RTN","RMPR4P22",24,0)
 S RMPRSSM(4)=$P($G(R664(1,RO,2)),U,3)
"RTN","RMPR4P22",25,0)
 I RMPRSSM(1)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR4P22",26,0)
 I RMPRSSM(2)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR4P22",27,0)
 I RMPRSSM(3)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR4P22",28,0)
 I RMPRSSM(4)'="" S RMPRCNT=RMPRCNT+1
"RTN","RMPR4P22",29,0)
 ;I RMPRCNT>2 D CONT
"RTN","RMPR4P22",30,0)
 I RMPRSSM(1)'="" W:LNCT#2=0 ! W "    Serial Number: "_RMPRSSM(1) S LNCT=LNCT+1
"RTN","RMPR4P22",31,0)
 I RMPRSSM(4)'="" W:LNCT#2=0 ! W "    Lot #: "_RMPRSSM(4) S LNCT=LNCT+1
"RTN","RMPR4P22",32,0)
 I RMPRSSM(3)'="" W:LNCT#2=0 ! W "    Model: "_RMPRSSM(3) S LNCT=LNCT+1
"RTN","RMPR4P22",33,0)
 I RMPRSSM(2)'="" W:LNCT#2=0 ! W "    Make: "_RMPRSSM(2)
"RTN","RMPR4P22",34,0)
 K RMPRSSM,RMPRCNT,LNCT
"RTN","RMPR4P22",35,0)
 ;
"RTN","RMPR4P22",36,0)
 S RMPRCH=$G(R664(1,RO,1,0))
"RTN","RMPR4P22",37,0)
 I RMPRCH="" Q
"RTN","RMPR4P22",38,0)
 ;S (RMPR90,RMPRX)=$Q(R664(1,RO,0,0))
"RTN","RMPR4P22",39,0)
 ;S RMPRX=$E(RMPRX,1,10)
"RTN","RMPR4P22",40,0)
 ;Q:RMPR90=""
"RTN","RMPR4P22",41,0)
 S RMPR90=0
"RTN","RMPR4P22",42,0)
 F  S RMPR90=$O(R664(1,RO,1,RMPR90)) Q:RMPR90=""  D
"RTN","RMPR4P22",43,0)
 .D:$D(RMPRMOR)&($Y>58) CONT
"RTN","RMPR4P22",44,0)
 .D:'$D(RMPRMOR)&($Y>36) CONT
"RTN","RMPR4P22",45,0)
 .W !,R664(1,RO,1,RMPR90,0)
"RTN","RMPR4P22",46,0)
 ;F  S RMPR90=$Q(@RMPR90) Q:RMPRX'=$E(RMPR90,1,10)  D:$D(RMPRMOR)&($Y>58) CONT D:'$D(RMPRMOR)&($Y>36) CONT
"RTN","RMPR4P22",47,0)
 ;D WRI
"RTN","RMPR4P22",48,0)
 Q
"RTN","RMPR4P22",49,0)
WRI ;CONTINUATION OF 10-2421
"RTN","RMPR4P22",50,0)
 W !,@RMPR90
"RTN","RMPR4P22",51,0)
 Q
"RTN","RMPR4P22",52,0)
CONT D:'$D(RMPRMOR) CON W @IOF,!,"CONTINUATION OF PURCHASE CARD ",?27,"ORDER NUMBER: ",$P($G(^RMPR(664,RMPRA,4)),U,5),?71,"PAGE ",RMPRPAGE S RMPRMOR=1,RMPRPAGE=RMPRPAGE+1 D HDR^RMPR4P21
"RTN","RMPR4P22",53,0)
 Q
"RTN","RMPR4P22",54,0)
ADD S (RMPRAMT2,RMPRAMT,RMPRAMT1,RMPRAMTN)=0
"RTN","RMPR4P22",55,0)
 S RMSHI=$S($P(R664(0),U,11)'="":$P(R664(0),U,11),1:$P(R664(0),U,10))
"RTN","RMPR4P22",56,0)
 S RC=0 F  S RC=$O(R664(1,RC)) Q:RC=""!(RC["B")  S RMPRI=$S($P(R664(1,RC,0),U,7)'="":$P(R664(1,RC,0),U,7),1:$P(R664(1,RC,0),U,3)) D ADD1
"RTN","RMPR4P22",57,0)
 I $D(R664(2)) S RMPRDISC=$S($P(R664(2),U,6)'="":$P(R664(2),U,6),1:"") I $D(RMPRDISC) S RMPRAMT2=$J(RMPRDISC*RMPRAMT/100,0,2),RMPRAMTN=RMPRAMT-$J(RMPRAMT2,0,2),RMPRAMTN=$J(RMPRAMTN+RMSHI,0,2) Q
"RTN","RMPR4P22",58,0)
 Q
"RTN","RMPR4P22",59,0)
ADD1 S RMPRAMT1=$J($P(R664(1,RC,0),U,4)*RMPRI,0,2) S RMPRAMT=RMPRAMT+RMPRAMT1 Q
"RTN","RMPR4P22",60,0)
CON ;CONTINUATION OF 2421
"RTN","RMPR4P22",61,0)
 W !,RMPRB,!,"16. Contract Number: " S RO("C")=$O(R664(1,0)) W:RO("C") $P(R664(1,RO("C"),0),U,14) W ?61,"Subtotal: ",$J($FN(RMPRAMT,"P",2),8)
"RTN","RMPR4P22",62,0)
 W !,"    ACCT.#: ",RMPRVACN K RMPRVACN
"RTN","RMPR4P22",63,0)
 W ?28,"Discount $" I $D(RMPRAMT2) W $J($FN(RMPRAMT2,"P",2),7)
"RTN","RMPR4P22",64,0)
 W ?45,"Shipping: ",$J($FN(RMSHI,"P",2),5)
"RTN","RMPR4P22",65,0)
 W ?62,"Total",?69,"$",$J($FN(RMPRAMTN,"P",2),9)
"RTN","RMPR4P22",66,0)
 W !,RMPRB,!,"17. Signature of"
"RTN","RMPR4P22",67,0)
 W ?28,"18. DATE",?39,"19. Signature and Title of",?70,"20. Date"
"RTN","RMPR4P22",68,0)
 W !,?5,"Requesting Official",?39,"Contracting/Accountable Officer"
"RTN","RMPR4P22",69,0)
 W !!,?5,RDUZ,?39,RMPR("SIG")
"RTN","RMPR4P22",70,0)
 W !,RMPRB,!?25,"Order and Receipt Action",!,RMPRB
"RTN","RMPR4P22",71,0)
 W !,"21. Order Number",?18,"22. Exp Date",?37,"23. Date Item Received",?62,"24. Date Delivered"
"RTN","RMPR4P22",72,0)
 I DUZ=$P(^RMPR(664,RMPRA,0),U,9)!($D(^XUSEC("RMPR FCP MANAGER",DUZ)))  D
"RTN","RMPR4P22",73,0)
 .;W !,"************"
"RTN","RMPR4P22",74,0)
 .N RMPRPRCD
"RTN","RMPR4P22",75,0)
 .S RMPRPRCD=$$DEC^RMPR4LI($P(^RMPR(664,RMPRA,4),U,1),$P(^RMPR(664,RMPRA,0),U,9),RMPRA)
"RTN","RMPR4P22",76,0)
 .;W $E(RMPRPRCD,13,16)
"RTN","RMPR4P22",77,0)
 .W !,RMPRPRCD
"RTN","RMPR4P22",78,0)
 E  W !,?3,"encrypted"
"RTN","RMPR4P22",79,0)
 ;W !,?3,$$DEC^RMPR4LI($P(^RMPR(664,RMPRA,4),U,1),DUZ,RMPRA)
"RTN","RMPR4P22",80,0)
 ;DATE REMOVED
"RTN","RMPR4P22",81,0)
 W !,RMPRB
"RTN","RMPR4P22",82,0)
 W !,"25. The articles or services listed herein have been received, or rendered",!,"ordered in the quantity and quality specified originally or as shown by"
"RTN","RMPR4P22",83,0)
 W !,"authenticated changes, except as noted.",!!?40,"Signature of Veteran or VA Official",!,RMPRB
"RTN","RMPR4P22",84,0)
 ;W !?30,"VOUCHER AUDIT BLOCK (For use by VA Facility only)",!,RMPRB
"RTN","RMPR4P22",85,0)
 ;W !,"Bank Authorization Number: ",$P(^RMPR(664,RMPRA,4),U,2)
"RTN","RMPR4P22",86,0)
 W !,?$X+6,"Acct. Symbol ",$$STA^RMPRUTIL,"-"_$P($G(^RMPR(664,RMPRA,4)),U,5)
"RTN","RMPR4P22",87,0)
 W !,RMPRB,!,?52,"ADP Form 10-2421PC  APR 1991" S RMPRMOR1=1
"RTN","RMPR4P22",88,0)
 Q
"VER")
8.0^22.0
"BLD",5934,6)
^93
**END**
**END**
