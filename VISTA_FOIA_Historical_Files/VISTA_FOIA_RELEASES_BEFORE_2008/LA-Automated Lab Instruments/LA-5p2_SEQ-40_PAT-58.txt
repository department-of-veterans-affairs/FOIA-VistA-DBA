
=============================================================================
Run Date: JAN 17, 2001                     Designation: LA*5.2*58
Package : LA - AUTOMATED LAB INSTRUMENTS     Priority: Mandatory
Version : 5.2        SEQ #40                    Status: Released
=============================================================================

Associated patches: (v)LA*5.2*53   <<= must be installed BEFORE `LA*5.2*58'

Subject: CAREVUE PROTOCOL PROCESSING ROUTINE

Category: 
  - Informational
  - Routine
  - Enhancement (Mandatory)

Description: 
============

  EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patches LA*5.2*58 and
 LR*5.2*266 do not contain any changes to the VISTA BLOOD BANK Software as
 defined by VHA DIRECTIVE 99-053 titled VISTA BLOOD BANK SOFTWARE VERSION
 5.2.
  
  EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patches LA*5.2*58 and
 LR*5.2*266 do not alter or modify any software design safeguards or safety
 critical elements functions.
  
  RISK ANALYSIS: Changes made by patches LA*5.2*58 and LR*5.2*266 have no
 effect on Blood Bank software functionality, therefore RISK is none.
  
 **NOTE**
  
 Patches LA*5.2*58 and LR*5.2*266 are being released in a single
 distribution.  Because of this, patch descriptions for LA*5.2*58 and
 LR*5.2*266 are identical and contain routine summaries for both sets of
 routines.
  
 **NOTE**
  
 The laboratory routines LRVER3A and LRMIUT are being modified by this
 patch.  These routines may have been locally modified at the sites.  The
 sites must ensure that precautions are taken to prevent loss of local
 modifications when patches to Laboratory are installed.
  
 **NOTE**
  
 When initially setting up the FOREIGN INTERFACE file (#62.487), the
 FOREIGN COMPUTER INTERFACE NAME field (#.01) should ALWAYS be set to
 "CAREVUE" (all caps, no leading or trailing spaces, and no quotes).  The
 routines that access this file are looking specifically for CAREVUE.  The
 routines will not be able to process the results for CareVue ward patients
 if this is not done.
  
 This patch contains changes to Class I CareVue code and requires that
 patch LA*5.2*53 and LR*5.2*263 be installed before LA*5.2*58.  Patches
 LA*5.2*58 and LR*5.2*266 are contained in the same KID file
 (LA_52_P58.KID) and will be installed together.
  
 This patch includes the following changes:
  
 1.  This patch updates the documentation released with the CareVue
 Interface patch (LA*5.2*53).
  
 2.  This patch makes changes to the routines LRVER3A and LRMIUT, and will
 create a new routine (LA7DLOC).  Currently, two routines (LRVER3A and
 LRMIUT) contain the Class I software for the CareVue interface. This patch
 will modify these routines to call the new routine (LA7DLOC).  LA7DLOC
 contains the Class I code for determining if a patient is located in a
 CareVue ward.  The current condition of the Class I code checks the CHEM,
 HEM, TOX, RIA, SER, etc. field (#4) and the Microbiology field (#5) of the
 Lab Data file (#63), but the updated routines will call LA7DLOC and will
 look in the Ward Location field (#.1) of the Patient file (#2).  This
 shows the current location of the patient.  There were problems with
 patients that were not transferred to the CareVue ward until after the lab
 order was taken. The old routine was checking where the patient was
 located when the order was taken, and not the current location of the
 patient.
  
 3.  Updates to the HL/7 date conversion routines. The previous standard
 for HL/7 dates listed the date in YYYYMMDDHHMMSS format.  The degree of
 precision was listed as a separate parameter.  The new standard format is
 [YYYY[MM[DD[HH[MM[SS]]]]]-zzzz] where the bracketed sections are optional
 depending on the existence of the subsequent set. Also, if either the
 seconds or the minutes/seconds combination consist only of zeroes, the
 minutes (if zeroes) and seconds will be omitted.  The length of the
 date/time string specifies the degree of precision. In addition, a ZULU
 time offset (-zzzz) is also included.  This is the number of hours between
 Greenwich Mean Time and the local time where the date/time string was
 created.  Routines LA7DVM and LA7DVEXT have been modified to use the
 Kernel function ($$FMTHL7^XLFDT) to convert dates from FileMan to HL7
 instead of the HL/7 date conversion utility ($$HDATE^HLFNC).
  
 4.  This patch will use TaskMan to transfer data to the CareVue system.
 Currently, TaskMan is not invoked. This could cause a problem verifying a
 result if an error was encountered in the CareVue routines.
  
 5.  This patch changes the LA7D EDIT FOREIGN INTERFACE (Edit Foreign
 Interface Parameters) option.  It is now easier to add a Ward to a Foreign
 Computer System Name.
  
 6.  This patch updates the Processing RTN field (#771) and the Response
 Processing RTN field (#772) of the Protocol file (#101) for the LA7D
 CARELIFE RESULTS and LA7D CARELIFE SERVER entries. The letter "Q" will be
 entered by the post-init routine LR266 if no entry exists.
  
 NOIS - MIA-0600-30434
    Reported an error, MISSING PROCESSING ROUTINE, when sending the HL7
    message from VistA to CareVue.  The letter "Q" will be entered by
    the post-init routine LR266 if no entry exists.
 NOIS - MWV-0900-21094
    Reported that all CareVue ward patients tests were not being sent to
    the CareVue system.  It was discovered that these patients were ones
    who were transferred from a non-CareVue ward to a CareVue ward after
    the tests were ordered. The patient was bypassed since the location
    at time of order was not a CareVue ward.  This patch will correct
    this by looking at the Ward Location field (#.1) in the Patient file
    (#2) for the current location of the patient.
  
 Associated NOIS
 ===============
 MIA-0600-30434
 MWV-0900-21094
  
 Test Sites
 ==========
 Martinsburg, West Virginia
  
  
 ROUTINE SUMMARY
 =================
 The following is a list of routines included in patch LA*5.2*58. The
 second line of each routine now looks like:
  
 <tab>;;5.2;AUTOMATED LAB INSTRUMENTS;**[patch list]**;Sep 27, 1994
  
                  CHECK^XTSUMBLD Results
   Routine Name    Before Patch      After Patch    Patch List
   ------------    ------------      -----------    ------------
   LA7DEDT            3765930          5836716      53,58
   LA7DLOC             NEW              553499      58
   LA7DVM             6983644          6949969      53,58
  
  
 The following is a list of routines included in patch LR*5.2*266. The
 second line of each routine now looks like:
  
 <tab>;;5.2;LAB SERVICE;**[patch list]**;Sep 27, 1994
                  CHECK^XTSUMBLD Results
   Routine Name    Before Patch      After Patch    Patch List
   ------------    ------------      -----------    ------------
   LR266               NEW             1529899      266
   LRMIUT             3673249          3951633      254,266
   LRVER3A           10780812         10508599      1,5,42,100,121
                                                    153,190,221,254,
                                                    263,266
  
  
 The documentation and distribution files for patches LA*5.2*58 and
 LR*5.2*266 may be obtained using FTP from the appropriate National VistA
 Support directory:
  
     OI FIELD OFFICE       FTP ADDRESS             DIRECTORY
     ===============       ===========             ==========
      HINES               152.129.1.110      [ANONYMOUS.SOFTWARE]
      SALT LAKE CITY      152.131.2.1        [ANONYMOUS.SOFTWARE]
      ALBANY              152.127.1.5        [ANONYMOUS.SOFTWARE]
  
 File names are:
  
  ASCII FILE
   LA_52_P58.KID     -  KIDS distribution for LA*5.2*58 and LR*5.2*266
  
  BINARY FILE
   LA7DIG.PDF        -  CareVue Installation Guide
  
 INSTALLATION INSTRUCTIONS
 =========================
  
   NOTE: This KIDS install does not place any options out of service
         during the install and no user options are affected.
         If KIDS prompts:
   
         "Want KIDS to Rebuild Menu Trees Upon Completion of
          Install? YES// NO"
         "Want KIDS to INHIBIT LOGONs during the install? YES// NO"
         "Want to DISABLE Scheduled Options, Menu Options, and
         Protocols? YES// NO"
  
         The site should answer "NO" to all three questions.
             Note: You may not receive all three prompts at your site.  
   
      1. Review your mapped set.  If any of the routines listed in
         patches LA*5.2*58 or LR*5.2*266 are mapped, they should be
         removed from the mapped set at this time.
  
      2. From the Kernel Installation & Distribution System menu (XPD
         MAIN), select the Installation menu option, then the option,
         Load a Distribution. Enter your directory name and
         LA_52_P58.KID at the Host File prompt.
  
      3. The patch has now been loaded into a Transport global on
         your system. You now need to use KIDS to install the 
         Transport global.
  
         On the KIDS menu, under the 'Installation' menu, use the 
         following options:
            Print Transport Global
            Compare Transport Global to Current System
            Verify Checksums in Transport Global
            Backup a Transport Global
  
      4. It is recommended that this release be installed during off
         peak hours.  To prevent a possible problem with the tasking
         of the next days laboratory orders, do not install this package
         at the same time as the following nightly tasked jobs:
  
               LRTASK ROLLOVER
               LRTASK NIGHTLY
               LRTASK CONJAM
               LRTASK CUM
  
      5. No options need to be placed out of service.
  
      6. Installation time is less than 2 minutes during off peak 
         hours and less than 5 minutes during peak hours
  
      7. From the 'Installation Menu' of the KIDS menu, run the 
         option 'Install Package(s)' Select the package 'LA*5.2*58'
         and proceed with the install. When prompted 'Want to 
         DISABLE Scheduled Options, Menu Options, and Protocols? 
         YES//', choose 'NO'.
  
      8. This patch updates the Processing RTN field (#771) and the
         Response Processing RTN field (#772) of the Protocol file
         (#101) for the LA7D CARELIFE RESULTS and LA7D CARELIFE SERVER
         entries. The letter "Q" will be entered by the post-init
         routine LR266 if no entry exists.  The LR266 routine will
         automatically be deleted after the patch is installed.
  
      9. If any routines were unmapped as part of step 2, they 
         should be returned to the mapped set once the installation 
         has run to completion.

Routine Information:
====================

Routine Name:
  - LA7DLOC


Routine Checksum:

Routine Name:
  - LA7DVM


Routine Checksum:

Routine Name:
  - LA7DEDT


Routine Checksum:

=============================================================================
User Information:                               
Entered By  : CROSSMAN,PAM                   Date Entered : JUN 12, 2000
Completed By: GARCIA,DELORES                Date Completed: JAN 16, 2001
Released By : BELSCHWINDER,MICHAEL          Date Released : JAN 17, 2001
=============================================================================


Packman Mail Message:
=====================

No routines included
