Released ECX*3*78 SEQ #71
Extracted from mail message
**KIDS**:ECX*3.0*78^

**INSTALL NAME**
ECX*3.0*78
"BLD",5209,0)
ECX*3.0*78^DSS EXTRACTS^0^3050302^y
"BLD",5209,1,0)
^^7^7^3041214^
"BLD",5209,1,1,0)
The DSS Blood Bank Extract project will provide a means of exporting data 
"BLD",5209,1,2,0)
from the VistA Blood Bank application and transmitting it to a DSS 
"BLD",5209,1,3,0)
database residing at the AAC. Data from the VistA Blood Bank package will
"BLD",5209,1,4,0)
be stored by the extract routine in an intermediate file, where it will be
"BLD",5209,1,5,0)
temporarily available for local site DSS review and audit prior to running
"BLD",5209,1,6,0)
of the extract. The data will then be transmitted to the AAC, where it 
"BLD",5209,1,7,0)
will be formatted and uploaded into other software products.
"BLD",5209,4,0)
^9.64PA^727.1^3
"BLD",5209,4,727.1,0)
727.1
"BLD",5209,4,727.1,222)
n^n^f^^n^^y^o^n
"BLD",5209,4,727.1,224)
I $P($G(^ECX(727.1,+Y,0)),U)="BLOOD BANK"
"BLD",5209,4,727.829,0)
727.829
"BLD",5209,4,727.829,222)
y^n^f^^^^n
"BLD",5209,4,728,0)
728
"BLD",5209,4,728,2,0)
^9.641^728^1
"BLD",5209,4,728,2,728,0)
DSS EXTRACTS  (File-top level)
"BLD",5209,4,728,2,728,1,0)
^9.6411^70^2
"BLD",5209,4,728,2,728,1,69,0)
LAST DATE LBB
"BLD",5209,4,728,2,728,1,70,0)
LBB STATUS
"BLD",5209,4,728,222)
y^n^p^^^^n^^n
"BLD",5209,4,728,224)

"BLD",5209,4,"APDD",728,728)

"BLD",5209,4,"APDD",728,728,69)

"BLD",5209,4,"APDD",728,728,70)

"BLD",5209,4,"B",727.1,727.1)

"BLD",5209,4,"B",727.829,727.829)

"BLD",5209,4,"B",728,728)

"BLD",5209,"KRN",0)
^9.67PA^8989.52^19
"BLD",5209,"KRN",.4,0)
.4
"BLD",5209,"KRN",.401,0)
.401
"BLD",5209,"KRN",.402,0)
.402
"BLD",5209,"KRN",.403,0)
.403
"BLD",5209,"KRN",.5,0)
.5
"BLD",5209,"KRN",.84,0)
.84
"BLD",5209,"KRN",3.6,0)
3.6
"BLD",5209,"KRN",3.8,0)
3.8
"BLD",5209,"KRN",3.8,"NM",0)
^9.68A^1^1
"BLD",5209,"KRN",3.8,"NM",1,0)
DSS-LBB^^0
"BLD",5209,"KRN",3.8,"NM","B","DSS-LBB",1)

"BLD",5209,"KRN",9.2,0)
9.2
"BLD",5209,"KRN",9.8,0)
9.8
"BLD",5209,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",5209,"KRN",9.8,"NM",1,0)
ECXLBB^^0^B14546218
"BLD",5209,"KRN",9.8,"NM",2,0)
ECXPLBB^^0^B18243786
"BLD",5209,"KRN",9.8,"NM",3,0)
ECXUTL4^^0^B40678058
"BLD",5209,"KRN",9.8,"NM","B","ECXLBB",1)

"BLD",5209,"KRN",9.8,"NM","B","ECXPLBB",2)

"BLD",5209,"KRN",9.8,"NM","B","ECXUTL4",3)

"BLD",5209,"KRN",19,0)
19
"BLD",5209,"KRN",19,"NM",0)
^9.68A^4^4
"BLD",5209,"KRN",19,"NM",1,0)
ECXLBB^^0
"BLD",5209,"KRN",19,"NM",2,0)
ECXMENU^^2
"BLD",5209,"KRN",19,"NM",3,0)
ECX MAINTENANCE^^2
"BLD",5209,"KRN",19,"NM",4,0)
ECX LBB PRE-EXTRACT^^0
"BLD",5209,"KRN",19,"NM","B","ECX LBB PRE-EXTRACT",4)

"BLD",5209,"KRN",19,"NM","B","ECX MAINTENANCE",3)

"BLD",5209,"KRN",19,"NM","B","ECXLBB",1)

"BLD",5209,"KRN",19,"NM","B","ECXMENU",2)

"BLD",5209,"KRN",19.1,0)
19.1
"BLD",5209,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",5209,"KRN",101,0)
101
"BLD",5209,"KRN",101,"NM",0)
^9.68A^^
"BLD",5209,"KRN",409.61,0)
409.61
"BLD",5209,"KRN",771,0)
771
"BLD",5209,"KRN",870,0)
870
"BLD",5209,"KRN",8989.51,0)
8989.51
"BLD",5209,"KRN",8989.52,0)
8989.52
"BLD",5209,"KRN",8994,0)
8994
"BLD",5209,"KRN","B",.4,.4)

"BLD",5209,"KRN","B",.401,.401)

"BLD",5209,"KRN","B",.402,.402)

"BLD",5209,"KRN","B",.403,.403)

"BLD",5209,"KRN","B",.5,.5)

"BLD",5209,"KRN","B",.84,.84)

"BLD",5209,"KRN","B",3.6,3.6)

"BLD",5209,"KRN","B",3.8,3.8)

"BLD",5209,"KRN","B",9.2,9.2)

"BLD",5209,"KRN","B",9.8,9.8)

"BLD",5209,"KRN","B",19,19)

"BLD",5209,"KRN","B",19.1,19.1)

"BLD",5209,"KRN","B",101,101)

"BLD",5209,"KRN","B",409.61,409.61)

"BLD",5209,"KRN","B",771,771)

"BLD",5209,"KRN","B",870,870)

"BLD",5209,"KRN","B",8989.51,8989.51)

"BLD",5209,"KRN","B",8989.52,8989.52)

"BLD",5209,"KRN","B",8994,8994)

"BLD",5209,"QUES",0)
^9.62^^
"BLD",5209,"REQB",0)
^9.611^4^1
"BLD",5209,"REQB",4,0)
ECX*3.0*49^2
"BLD",5209,"REQB","B","ECX*3.0*49",4)

"DATA",727.1,23,0)
BLOOD BANK^727.829^M^^^^Blood Bank^LBB^LBB^27^200^0
"DATA",727.1,23,"ROU")
ECXLBB
"FIA",727.1)
EXTRACT DEFINITIONS
"FIA",727.1,0)
^ECX(727.1,
"FIA",727.1,0,0)
727.1
"FIA",727.1,0,1)
n^n^f^^n^^y^o^n
"FIA",727.1,0,10)

"FIA",727.1,0,11)
I $P($G(^ECX(727.1,+Y,0)),U)="BLOOD BANK"
"FIA",727.1,0,"RLRO")

"FIA",727.1,0,"VR")
3.0^ECX
"FIA",727.1,727.1)
0
"FIA",727.1,727.11)
0
"FIA",727.829)
BLOOD BANK EXTRACT
"FIA",727.829,0)
^ECX(727.829,
"FIA",727.829,0,0)
727.829
"FIA",727.829,0,1)
y^n^f^^^^n
"FIA",727.829,0,10)

"FIA",727.829,0,11)

"FIA",727.829,0,"RLRO")

"FIA",727.829,0,"VR")
3.0^ECX
"FIA",727.829,727.829)
0
"FIA",728)
DSS EXTRACTS
"FIA",728,0)
^ECX(728,
"FIA",728,0,0)
728P
"FIA",728,0,1)
y^n^p^^^^n^^n
"FIA",728,0,10)

"FIA",728,0,11)

"FIA",728,0,"RLRO")

"FIA",728,0,"VR")
3.0^ECX
"FIA",728,728)
1
"FIA",728,728,69)

"FIA",728,728,70)

"KRN",3.8,345,-1)
0^1
"KRN",3.8,345,0)
DSS-LBB^PU^n^^^^
"KRN",3.8,345,2,0)
^^2^2^3041209^
"KRN",3.8,345,2,1,0)
This mail group contains users responsible for DSS extracts.  A message is
"KRN",3.8,345,2,2,0)
sent to this group upon completion of package extracts. 
"KRN",3.8,345,3)

"KRN",3.8,345,5,0)
^3.811P
"KRN",19,11878,-1)
2^2
"KRN",19,11878,0)
ECXMENU^Package Extracts^^M^2441^ECXMGR^^^^^^462
"KRN",19,11878,10,0)
^19.01IP^21^21
"KRN",19,11878,10,20,0)
12244^LBB
"KRN",19,11878,10,20,"^")
ECXLBB
"KRN",19,11878,"U")
PACKAGE EXTRACTS
"KRN",19,11919,-1)
2^3
"KRN",19,11919,0)
ECX MAINTENANCE^Maintenance^^M^2441^^^^^^^462
"KRN",19,11919,10,0)
^19.01IP^21^20
"KRN",19,11919,10,21,0)
12245^19
"KRN",19,11919,10,21,"^")
ECX LBB PRE-EXTRACT
"KRN",19,11919,"U")
MAINTENANCE
"KRN",19,12244,-1)
0^1
"KRN",19,12244,0)
ECXLBB^Blood Bank Extract^^R^^^^^^^^DSS EXTRACTS
"KRN",19,12244,1,0)
^^4^4^3041209^
"KRN",19,12244,1,1,0)
This option provides the extract manager the ability to extract blood bank
"KRN",19,12244,1,2,0)
data for a selected date range. This data is stored in the BLOOD BANK
"KRN",19,12244,1,3,0)
EXTRACT file (#727.829) until the data is transmitted to the commercial
"KRN",19,12244,1,4,0)
vendor.
"KRN",19,12244,25)
BEG^ECXLBB
"KRN",19,12244,"U")
BLOOD BANK EXTRACT
"KRN",19,12245,-1)
0^4
"KRN",19,12245,0)
ECX LBB PRE-EXTRACT^LBB Pre-Extract Audit Report^^R^^^^^^^^DSS EXTRACTS^^
"KRN",19,12245,1,0)
^19.06^5^5^3041213^^
"KRN",19,12245,1,1,0)
This report is to provide DSS on-site support with a list of unmatched 
"KRN",19,12245,1,2,0)
blood products.  The report will contain those records that do not have a 
"KRN",19,12245,1,3,0)
value in either the DSS Product Dept or DSS IP # fields.  The result 
"KRN",19,12245,1,4,0)
report will enable the DSS on-site support team to correct the unmatched 
"KRN",19,12245,1,5,0)
blood products prior to running the LBB Extract.
"KRN",19,12245,20)

"KRN",19,12245,25)
ECXPLBB
"KRN",19,12245,"U")
LBB PRE-EXTRACT AUDIT REPORT
"MBREQ")
0
"ORD",11,3.8)
3.8;11;;;MAILG^XPDTA1;MAILGF1^XPDIA1;MAILGE1^XPDIA1;MAILGF2^XPDIA1;;MAILGDEL^XPDIA1(%)
"ORD",11,3.8,0)
MAIL GROUP
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",462,-1)
1^1
"PKG",462,0)
DSS EXTRACTS^ECX
"PKG",462,22,0)
^9.49I^1^1
"PKG",462,22,1,0)
3.0^2971222^3040205^2441
"PKG",462,22,1,"PAH",1,0)
78^3050302
"PKG",462,22,1,"PAH",1,1,0)
^^7^7^3050302
"PKG",462,22,1,"PAH",1,1,1,0)
The DSS Blood Bank Extract project will provide a means of exporting data 
"PKG",462,22,1,"PAH",1,1,2,0)
from the VistA Blood Bank application and transmitting it to a DSS 
"PKG",462,22,1,"PAH",1,1,3,0)
database residing at the AAC. Data from the VistA Blood Bank package will
"PKG",462,22,1,"PAH",1,1,4,0)
be stored by the extract routine in an intermediate file, where it will be
"PKG",462,22,1,"PAH",1,1,5,0)
temporarily available for local site DSS review and audit prior to running
"PKG",462,22,1,"PAH",1,1,6,0)
of the extract. The data will then be transmitted to the AAC, where it 
"PKG",462,22,1,"PAH",1,1,7,0)
will be formatted and uploaded into other software products.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","ECXLBB")
0^1^B14546218
"RTN","ECXLBB",1,0)
ECXLBB ;DALOI/KML - DSS BLOOD BANK EXTRACT ;5/6/2004
"RTN","ECXLBB",2,0)
 ;;3.0;DSS EXTRACTS;**78**;Dec 22, 1997
"RTN","ECXLBB",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","ECXLBB",4,0)
 ; access to the LAB DATA file (#63) is supported by 
"RTN","ECXLBB",5,0)
 ; controlled subscription to IA 525  (global root ^LR)  
"RTN","ECXLBB",6,0)
BEG ;entry point from option
"RTN","ECXLBB",7,0)
 D SETUP I ECFILE="" Q
"RTN","ECXLBB",8,0)
 D ^ECXTRAC,^ECXKILL
"RTN","ECXLBB",9,0)
 Q
"RTN","ECXLBB",10,0)
 ;
"RTN","ECXLBB",11,0)
START ; Entry point from tasked job
"RTN","ECXLBB",12,0)
 ; begin package specific extract
"RTN","ECXLBB",13,0)
 N ECTRSP,ECADMT,ECTODT,ECENCTR,ECPAT,ECLRDFN
"RTN","ECXLBB",14,0)
 N ECD,ECXDFN,ECARRY,EC66,ECERR,ECTRFDT,ECTRFTM,ECX,ECINOUT
"RTN","ECXLBB",15,0)
 ;variables ECFILE,EC23,ECXYM,ECINST,ECSD,ECSD1,ECED passed in 
"RTN","ECXLBB",16,0)
 ; by taskmanager 
"RTN","ECXLBB",17,0)
 ; ECED defined in ^ECXTRAC - it represents the end date of the extract
"RTN","ECXLBB",18,0)
 ; sort process.  TRANSFUSION DATE should be within start and end dates
"RTN","ECXLBB",19,0)
 ; ECED and ECSD were assigned with input provided by the user interface
"RTN","ECXLBB",20,0)
 ; and ECSD1 = ECSD-.1
"RTN","ECXLBB",21,0)
 ; Read through the TRANSFUSION RECORD sub-file (63.017) of 
"RTN","ECXLBB",22,0)
 ; the LAB DATA file (#63)
"RTN","ECXLBB",23,0)
 ;the global nodes containing transfusion record entries are constructed
"RTN","ECXLBB",24,0)
 ; by calculating the TRANSFUSION DATE/TIME (.01)
"RTN","ECXLBB",25,0)
 ; into its reverse date/time representation and then DINUM'd when 
"RTN","ECXLBB",26,0)
 ;filing the record entry 
"RTN","ECXLBB",27,0)
 ; ECD equals the reverse date/time of ECED+.3 and will need to be
"RTN","ECXLBB",28,0)
 ; reset for each DFN.
"RTN","ECXLBB",29,0)
 I $D(ZTQUEUED),$$S^%ZTLOAD S QFLG=1 Q  ;quit if tasked and user sends stop request  (QFLG assigned in ECXTRAC)
"RTN","ECXLBB",30,0)
AUDRPT ; entry point for pre-extract audit report
"RTN","ECXLBB",31,0)
 S ECTODT=9999999-ECSD1,ECLRDFN=0
"RTN","ECXLBB",32,0)
 F  S ECLRDFN=$O(^LR(ECLRDFN)) Q:'ECLRDFN  S ECXDFN=$$GETDFN(ECLRDFN),ECERR=$$PAT(ECXDFN) S ECD=9999999-(ECED+.3) F  S ECD=$O(^LR(ECLRDFN,1.6,ECD)) Q:ECERR  Q:'ECD!(ECD>ECTODT)  S EC0=^LR(ECLRDFN,1.6,ECD,0) D
"RTN","ECXLBB",33,0)
 .; ECARRY(1)=TRANSFUSION DATE AND TIME, 
"RTN","ECXLBB",34,0)
 .; ECARRY(3)=COMPONENT, ECARRY(4)=COMPONENT ABBREVIATION
"RTN","ECXLBB",35,0)
 .; ECARRY(5)=UNITS POOLED, ECARRY(6)=TRANSFUSION REACTION, 
"RTN","ECXLBB",36,0)
 .; ECARRY(7)=VOLUME TRANSFUSED, ECARRY(8)=TRANSFUSION REACTION TYPE
"RTN","ECXLBB",37,0)
 . S ECARRY(1)=$P(EC0,"^"),EC66=$P($G(^LAB(66,$P(EC0,"^",2),0)),"^",1,2)
"RTN","ECXLBB",38,0)
 . S ECARRY(3)=$E($P(EC66,"^"),1,15),ECARRY(4)=$P(EC66,"^",2)
"RTN","ECXLBB",39,0)
 . S ECARRY(5)=$S(+$P(EC0,"^",7)=0:1,1:+$P(EC0,"^",7))
"RTN","ECXLBB",40,0)
 . S ECARRY(6)=$S($P(EC0,"^",8)=1:"Y",1:"N"),ECARRY(7)=$P(EC0,"^",10)
"RTN","ECXLBB",41,0)
 . S ECARRY(8)=$P($G(^LAB(65.4,+$P(EC0,"^",11),0)),"^",2)
"RTN","ECXLBB",42,0)
 . D GETDATA
"RTN","ECXLBB",43,0)
 . K ECARRY
"RTN","ECXLBB",44,0)
 Q
"RTN","ECXLBB",45,0)
 ;
"RTN","ECXLBB",46,0)
GETDATA ; gather rest of extract data that will be recorded in an 
"RTN","ECXLBB",47,0)
 ; entry in file 727.829
"RTN","ECXLBB",48,0)
 S ECTRFDT=$$ECXDOB^ECXUTL(ECARRY(1)),ECTRFTM=$$ECXTIME^ECXUTL(ECARRY(1))
"RTN","ECXLBB",49,0)
 S ECX=$$INP^ECXUTL2(ECXDFN,ECARRY(1)),ECINOUT=$P(ECX,U),ECTRSP=$P(ECX,U,3),ECADMT=$P(ECX,U,4) ; [FLD #5]
"RTN","ECXLBB",50,0)
 ;
"RTN","ECXLBB",51,0)
 ;- Observation patient indicator (YES/NO)
"RTN","ECXLBB",52,0)
 S ECXOBS=$$OBSPAT^ECXUTL4(ECINOUT,ECTRSP)
"RTN","ECXLBB",53,0)
 ;- If no encounter number don't file record
"RTN","ECXLBB",54,0)
 S ECENCTR=$$ENCNUM^ECXUTL4(ECINOUT,ECPAT("SSN"),ECADMT,ECARRY(1),ECTRSP,ECXOBS,ECHEAD,,) ; [FLD #6]
"RTN","ECXLBB",55,0)
 Q:ECENCTR=""
"RTN","ECXLBB",56,0)
 ;
"RTN","ECXLBB",57,0)
 S ECXSTR=$G(EC23)_"^"_ECINST_"^"_ECXDFN_"^"_ECPAT("SSN")_"^"_ECPAT("NAME")_"^"_ECINOUT_"^"_ECENCTR_"^"_ECTRFDT_"^"_ECTRFTM_"^"_ECARRY(3)_"^"_ECARRY(4)_"^"_ECARRY(5)_"^"_ECARRY(7)_"^"_ECARRY(6)_"^"_ECARRY(8)_"^BB"_ECINST_"^^"
"RTN","ECXLBB",58,0)
 I '$D(ECXRPT) D FILE(ECXSTR) Q
"RTN","ECXLBB",59,0)
 S ^TMP("ECXLBB",$J,ECXDFN,ECD)=ECXSTR  ;temporary global array
"RTN","ECXLBB",60,0)
 ;   used in ECXPLBB (pre-extract audit report)
"RTN","ECXLBB",61,0)
 Q
"RTN","ECXLBB",62,0)
 ;
"RTN","ECXLBB",63,0)
GETDFN(ECXLRDFN) ;
"RTN","ECXLBB",64,0)
 ; INPUT - LRDFN
"RTN","ECXLBB",65,0)
 ; OUTPUT - DFN
"RTN","ECXLBB",66,0)
 ; Obtains DFN (Patient ID) from LRDFN (Lab Patient ID).
"RTN","ECXLBB",67,0)
 ; If no valid DFN exists, 0 is returned.
"RTN","ECXLBB",68,0)
 S ECXLRDFN=+$G(ECXLRDFN)
"RTN","ECXLBB",69,0)
 I $P($G(^LR(ECXLRDFN,0)),"^",2)'=2 Q 0
"RTN","ECXLBB",70,0)
 Q +$P(^LR(ECXLRDFN,0),"^",3)
"RTN","ECXLBB",71,0)
 ; 
"RTN","ECXLBB",72,0)
PAT(ECXDFN) ;get/set patient data
"RTN","ECXLBB",73,0)
 ; INPUT - ECXDFN = patient ien (DFN)
"RTN","ECXLBB",74,0)
 ; OUTPUT - ECPAT array:
"RTN","ECXLBB",75,0)
 ;          ECPAT("SSN")
"RTN","ECXLBB",76,0)
 ;          ECPAT("NAME")
"RTN","ECXLBB",77,0)
 ; returns 0 or 1 in ECXERR - 0=successful
"RTN","ECXLBB",78,0)
 ;                            1=error condition
"RTN","ECXLBB",79,0)
 N X,OK,ECXERR
"RTN","ECXLBB",80,0)
 ;get data
"RTN","ECXLBB",81,0)
 S ECXERR=0
"RTN","ECXLBB",82,0)
 K ECXPAT S OK=$$PAT^ECXUTL3(ECXDFN,"",1,.ECPAT)
"RTN","ECXLBB",83,0)
 I 'OK S ECXERR=1
"RTN","ECXLBB",84,0)
 Q ECXERR
"RTN","ECXLBB",85,0)
 ;
"RTN","ECXLBB",86,0)
FILE(ECODE) ;
"RTN","ECXLBB",87,0)
 ; Input - ECODE = extract record
"RTN","ECXLBB",88,0)
 ;
"RTN","ECXLBB",89,0)
 ; record the extract record at a global node in file 727.829
"RTN","ECXLBB",90,0)
 ; sequence #^year/month of extract^extract #^facility^patient dfn^SSN^
"RTN","ECXLBB",91,0)
 ; name^i/o pt indicator^encounter #^date of transfusion^time of 
"RTN","ECXLBB",92,0)
 ; transfusion^component^component abbrev^# of units^volume in mm^
"RTN","ECXLBB",93,0)
 ; reaction^reaction type^feeder location^DSS product dept^DSS IP #
"RTN","ECXLBB",94,0)
 ;note:  DSS product dept and DSS IP # are dependent on the release of
"RTN","ECXLBB",95,0)
 ; ECX*3*61
"RTN","ECXLBB",96,0)
 N DA,DIK,EC7
"RTN","ECXLBB",97,0)
 S EC7=$O(^ECX(ECFILE,999999999),-1),EC7=EC7+1
"RTN","ECXLBB",98,0)
 S ECODE=EC7_"^"_ECODE
"RTN","ECXLBB",99,0)
 S ^ECX(ECFILE,EC7,0)=ECODE,ECRN=ECRN+1
"RTN","ECXLBB",100,0)
 S DA=EC7,DIK="^ECX("_ECFILE_"," D IX1^DIK K DIK,DA
"RTN","ECXLBB",101,0)
 Q
"RTN","ECXLBB",102,0)
 ;
"RTN","ECXLBB",103,0)
 ;
"RTN","ECXLBB",104,0)
SETUP ;Set required input for ECXTRAC.
"RTN","ECXLBB",105,0)
 S ECHEAD="LBB"
"RTN","ECXLBB",106,0)
 D ECXDEF^ECXUTL2(ECHEAD,.ECPACK,.ECGRP,.ECFILE,.ECRTN,.ECPIECE,.ECVER)
"RTN","ECXLBB",107,0)
 Q
"RTN","ECXLBB",108,0)
 ;
"RTN","ECXLBB",109,0)
LOCAL ; to extract nightly for local use not to be transmitted to TSI
"RTN","ECXLBB",110,0)
 ; should be queued with a 1D frequency
"RTN","ECXLBB",111,0)
 D SETUP,^ECXTLOCL,^ECXKILL Q
"RTN","ECXLBB",112,0)
 ;
"RTN","ECXLBB",113,0)
QUE ; entry point for the background requeuing handled by ECXTAUTO
"RTN","ECXLBB",114,0)
 D SETUP,QUE^ECXTAUTO,^ECXKILL
"RTN","ECXLBB",115,0)
 Q
"RTN","ECXLBB",116,0)
 ;
"RTN","ECXLBB",117,0)
 ;ECXLBB
"RTN","ECXPLBB")
0^2^B18243786
"RTN","ECXPLBB",1,0)
ECXPLBB ;DALOI/KML - DSS BLOOD BANK PRE-EXTRACT AUDIT REPORT ;12/10/2004
"RTN","ECXPLBB",2,0)
 ;;3.0;DSS EXTRACTS;**78**;Dec 22, 1997
"RTN","ECXPLBB",3,0)
 ;Per VHA Directive 97-033 this routine should not be modified.  Medical Device # BK970021
"RTN","ECXPLBB",4,0)
 ;entry point from option
"RTN","ECXPLBB",5,0)
 D SETUP^ECXLBB I ECFILE="" Q
"RTN","ECXPLBB",6,0)
 N ECXINST
"RTN","ECXPLBB",7,0)
 D DATES
"RTN","ECXPLBB",8,0)
 Q:ECED']""&(ECSD']"")
"RTN","ECXPLBB",9,0)
 N ECXPOP S ECXPOP=0 D QUE Q:ECXPOP
"RTN","ECXPLBB",10,0)
 ;
"RTN","ECXPLBB",11,0)
START ;  entry point from tasked job
"RTN","ECXPLBB",12,0)
 ; get LAB DATA and build temporary global ^TMP("ECXLBB",$J)
"RTN","ECXPLBB",13,0)
 N ECTRSP,ECADMT,ECTODT,ECXRPT,ECOUT,ECXSTR,ECRDT,ECLINE,ECPG,ECQUIT
"RTN","ECXPLBB",14,0)
 N ECD,ECXDFN,ECARRY,EC66,ECERR,ECTRFDT,ECTRFTM,ECX,ECINOUT,ECXJOB
"RTN","ECXPLBB",15,0)
 S ECXJOB=$J
"RTN","ECXPLBB",16,0)
 K ^TMP("ECXLBB",ECXJOB)
"RTN","ECXPLBB",17,0)
 U IO
"RTN","ECXPLBB",18,0)
 I $E(IOST,1,2)="C-" W !,"Retrieving records... "
"RTN","ECXPLBB",19,0)
 S ECXRPT=1 D AUDRPT^ECXLBB
"RTN","ECXPLBB",20,0)
OUTPUT ; entry point called by EN tag
"RTN","ECXPLBB",21,0)
 I '$D(^TMP("ECXLBB",ECXJOB)) W !,"There were no records that met the date range criteria" Q
"RTN","ECXPLBB",22,0)
 S (ECPG,ECDATE,ECQUIT,ECXDFN)=0,ECLINE="",$P(ECLINE,"=",80)="="
"RTN","ECXPLBB",23,0)
 S ECSDN=$$FMTE^XLFDT(ECSD,9),ECEDN=$$FMTE^XLFDT(ECED,9),ECRDT=$$FMTE^XLFDT(DT,9)
"RTN","ECXPLBB",24,0)
 W:$E(IOST,1,2)="C-" @IOF D HED
"RTN","ECXPLBB",25,0)
 F  S ECXDFN=$O(^TMP("ECXLBB",ECXJOB,ECXDFN)) Q:'ECXDFN  F  S ECDATE=$O(^TMP("ECXLBB",ECXJOB,ECXDFN,ECDATE))  Q:'ECDATE  Q:ECQUIT  S ECXSTR=^(ECDATE) D PRINT
"RTN","ECXPLBB",26,0)
 D ^ECXKILL
"RTN","ECXPLBB",27,0)
 Q
"RTN","ECXPLBB",28,0)
 ;
"RTN","ECXPLBB",29,0)
PRINT ;
"RTN","ECXPLBB",30,0)
 I $Y+5>IOSL D  Q:ECQUIT
"RTN","ECXPLBB",31,0)
 . I $E(IOST,1,2)["C-" S DIR(0)="E" D ^DIR K DIR I 'Y S ECQUIT=1 Q
"RTN","ECXPLBB",32,0)
 . W @IOF D HED
"RTN","ECXPLBB",33,0)
 W !,$P(ECXSTR,"^",5),?7,$P(ECXSTR,"^",4),?19,$P(ECXSTR,"^",16)
"RTN","ECXPLBB",34,0)
 W ?27,$$FMTE^XLFDT($$HL7TFM^XLFDT($P(ECXSTR,"^",8)),2)
"RTN","ECXPLBB",35,0)
 W ?36,$P(ECXSTR,"^",11),?47,$J(+$P(ECXSTR,"^",12),2),?54
"RTN","ECXPLBB",36,0)
 W $P(ECXSTR,"^",17),?67,$P(ECXSTR,"^",18)
"RTN","ECXPLBB",37,0)
 Q
"RTN","ECXPLBB",38,0)
 ;
"RTN","ECXPLBB",39,0)
HED ;
"RTN","ECXPLBB",40,0)
 S ECPG=ECPG+1
"RTN","ECXPLBB",41,0)
 W !,"LBB Pre-Extract Audit Report",?72,"Page",$J(ECPG,3)
"RTN","ECXPLBB",42,0)
 W !,ECSDN," - ",ECEDN,?58,"Run Date:",$J(ECRDT,12)
"RTN","ECXPLBB",43,0)
 W !,?27,"Transf",?44,"Number"
"RTN","ECXPLBB",44,0)
 W !,"Name",?10,"SSN",?18,"FDR LOC",?27,"Date",?36,"COMP"
"RTN","ECXPLBB",45,0)
 W ?44,"of Units",?54,"IPD",?67,"IP"
"RTN","ECXPLBB",46,0)
 W !,ECLINE
"RTN","ECXPLBB",47,0)
 Q
"RTN","ECXPLBB",48,0)
DATES ;
"RTN","ECXPLBB",49,0)
 N OUT,CHKFLG
"RTN","ECXPLBB",50,0)
 I '$D(ECNODE) S ECNODE=7
"RTN","ECXPLBB",51,0)
 I '$D(ECHEAD) S ECHEAD=" "
"RTN","ECXPLBB",52,0)
 W @IOF,!,"LBB Pre-Extract Audit Report Information for DSS",!!
"RTN","ECXPLBB",53,0)
 S:'$D(ECINST) ECINST=+$P(^ECX(728,1,0),U)
"RTN","ECXPLBB",54,0)
 S ECXINST=ECINST
"RTN","ECXPLBB",55,0)
 K ECXDIC S DA=ECINST,DIC="^DIC(4,",DIQ(0)="I",DIQ="ECXDIC",DR=".01;99"
"RTN","ECXPLBB",56,0)
 D EN^DIQ1 S ECINST=$G(ECXDIC(4,DA,99,"I")) K DIC,DIQ,DA,DR,ECXDIC
"RTN","ECXPLBB",57,0)
 S ECLDT=$S($D(^ECX(728,1,ECNODE)):$P(^(ECNODE),U,ECPIECE),1:2610624)
"RTN","ECXPLBB",58,0)
 S:ECLDT="" ECLDT=2610624
"RTN","ECXPLBB",59,0)
 S ECOUT=0 F  S (ECED,ECSD)="" D  Q:ECOUT
"RTN","ECXPLBB",60,0)
 . K %DT S %DT="AEX",%DT("A")="Starting with Date: " D ^%DT
"RTN","ECXPLBB",61,0)
 . I Y<0 S ECOUT=1 Q
"RTN","ECXPLBB",62,0)
 . S ECSD=Y
"RTN","ECXPLBB",63,0)
 . K %DT S %DT="AEX",%DT("A")="Ending with Date: " D ^%DT
"RTN","ECXPLBB",64,0)
 . I Y<0 S ECOUT=1 Q
"RTN","ECXPLBB",65,0)
 . I Y<ECSD W !!,"The ending date cannot be earlier than the starting date.",!,"Please try again.",!! Q
"RTN","ECXPLBB",66,0)
 . I $E(Y,1,5)'=$E(ECSD,1,5) W !!,"Beginning and ending dates must be in the same month and year.",!,"Please try again.",!! Q
"RTN","ECXPLBB",67,0)
 . S ECED=Y
"RTN","ECXPLBB",68,0)
 . I ECLDT'<ECSD W !!,"The Blood Bank information has already been extracted through ",$$FMTE^XLFDT(ECLDT),".",!,"Please enter a new date range.",!! Q
"RTN","ECXPLBB",69,0)
 . S ECOUT=1
"RTN","ECXPLBB",70,0)
 Q
"RTN","ECXPLBB",71,0)
 ;
"RTN","ECXPLBB",72,0)
QUE ;
"RTN","ECXPLBB",73,0)
 K ZTSAVE
"RTN","ECXPLBB",74,0)
 S ECSDN=$$FMTE^XLFDT(ECSD),ECEDN=$$FMTE^XLFDT(ECED),ECSD1=ECSD-.1
"RTN","ECXPLBB",75,0)
 K ZTSAVE
"RTN","ECXPLBB",76,0)
 F X="ECINST","ECED","ECSD","ECSD1","ECEDN","ECSDN" S ZTSAVE(X)=""
"RTN","ECXPLBB",77,0)
 F X="ECPACK","ECPIECE","ECRTN","ECGRP","ECNODE" S ZTSAVE(X)=""
"RTN","ECXPLBB",78,0)
 F X="ECFILE","ECHEAD","ECVER","ECINST","ECXINST" S ZTSAVE(X)=""
"RTN","ECXPLBB",79,0)
 F X="ECXLOGIC","ECXDATES" S ZTSAVE(X)=""
"RTN","ECXPLBB",80,0)
 S ZTDESC=ECPACK_" PRE-EXTRACT AUDIT REPORT: "_ECSDN_" TO "_ECEDN,ZTRTN="START^ECXPLBB",ZTIO=""
"RTN","ECXPLBB",81,0)
 S IOP="Q" W ! S %ZIS="QMP" D ^%ZIS S:POP ECXPOP=1 Q:POP  I $D(IO("Q")) K IO("Q"),ZTIO D ^%ZTLOAD W:$D(ZTSK) !,$C(7),"REQUEST QUEUED",!,"Task #: ",$G(ZTSK) K I,ZTSK,ZTIO,ZTSAVE,ZTRTN D HOME^%ZIS S ECXPOP=1
"RTN","ECXPLBB",82,0)
 Q
"RTN","ECXPLBB",83,0)
 ;
"RTN","ECXPLBB",84,0)
EN(ECXJOB,ECSD,ECED) ; entry point used primarily for testing
"RTN","ECXPLBB",85,0)
 ; input:
"RTN","ECXPLBB",86,0)
 ;        ECXJOB = $J that is assigned to the 2nd subscript of 
"RTN","ECXPLBB",87,0)
 ;                 the temporary global array containing the 
"RTN","ECXPLBB",88,0)
 ;                 extracted data that feeds the pre-extract
"RTN","ECXPLBB",89,0)
 ;                 audit report
"RTN","ECXPLBB",90,0)
 ;        ECSD   = starting date range representing the FM
"RTN","ECXPLBB",91,0)
 ;                 date used to retrieve data from file #63
"RTN","ECXPLBB",92,0)
 ;        ECED   = ending date range representing the FM date
"RTN","ECXPLBB",93,0)
 ;                 used to retrieve data from file #63
"RTN","ECXPLBB",94,0)
 ; syntax  of the call: D EN^ECXPLBB(541571372,3000101,3000131)
"RTN","ECXPLBB",95,0)
 D OUTPUT
"RTN","ECXPLBB",96,0)
 Q
"RTN","ECXPLBB",97,0)
 ;
"RTN","ECXPLBB",98,0)
 ;ECXPLBB
"RTN","ECXUTL4")
0^3^B40678058
"RTN","ECXUTL4",1,0)
ECXUTL4 ;ALB/ESD - Utilities for DSS Extracts ; 10/4/02 1:29pm
"RTN","ECXUTL4",2,0)
 ;;3.0;DSS EXTRACTS;**39,41,46,49,78**;Dec 22,1997
"RTN","ECXUTL4",3,0)
 ;
"RTN","ECXUTL4",4,0)
OBSPAT(ECXIO,ECXTS,DSSID) ;
"RTN","ECXUTL4",5,0)
 ; Get observation patient indicator from DSS TREATING SPECIALTY
"RTN","ECXUTL4",6,0)
 ; TRANSLATION file (#727.831) or DSS Identifier
"RTN","ECXUTL4",7,0)
 ;
"RTN","ECXUTL4",8,0)
 ; Input:
"RTN","ECXUTL4",9,0)
 ;   ECXIO  - Inpatient/Outpatient indicator
"RTN","ECXUTL4",10,0)
 ;   ECXTS  - Treating specialty (from file #42.4)
"RTN","ECXUTL4",11,0)
 ;   DSSID  - DSS Identifier
"RTN","ECXUTL4",12,0)
 ;
"RTN","ECXUTL4",13,0)
 ;Output:
"RTN","ECXUTL4",14,0)
 ;   ECXOBS - Observation patient indicator (YES/NO)
"RTN","ECXUTL4",15,0)
 ;
"RTN","ECXUTL4",16,0)
 ;- Check input vars
"RTN","ECXUTL4",17,0)
 S ECXIO=$G(ECXIO),ECXTS=+$G(ECXTS),DSSID=+$G(DSSID)
"RTN","ECXUTL4",18,0)
 S ECXOBS=""
"RTN","ECXUTL4",19,0)
 D
"RTN","ECXUTL4",20,0)
 .;- Look up obs patient indicator if treating spec is in file #727.831
"RTN","ECXUTL4",21,0)
 . I $G(^ECX(727.831,ECXTS,0)) S ECXOBS=$P($G(^ECX(727.831,ECXTS,0)),"^",4)
"RTN","ECXUTL4",22,0)
 . I ECXOBS'="" S ECXOBS=$S(ECXOBS="Y":"YES",1:"NO") Q
"RTN","ECXUTL4",23,0)
 .;
"RTN","ECXUTL4",24,0)
 .;- If outpatient and TS not in file, AND Feeder Key (CLI) or DSS ID
"RTN","ECXUTL4",25,0)
 .;- (MTL,IVP,ECQ,QSR,NOS,SUR) is 290-296, Observation Patient Ind=YES
"RTN","ECXUTL4",26,0)
 . I ECXIO="O",ECXOBS="",DSSID D
"RTN","ECXUTL4",27,0)
 .. I $E(DSSID,1,3)>289&($E(DSSID,1,3)<297) S ECXOBS="YES"
"RTN","ECXUTL4",28,0)
 .. E  S ECXOBS="NO"
"RTN","ECXUTL4",29,0)
 Q $S(ECXOBS'="":ECXOBS,1:"NO")
"RTN","ECXUTL4",30,0)
 ;
"RTN","ECXUTL4",31,0)
INOUTP(ECXTS) ;
"RTN","ECXUTL4",32,0)
 ; Get inpatient/outpatient indicator from DSS TREATING SPECIALTY
"RTN","ECXUTL4",33,0)
 ; TRANSLATION file (#727.831)
"RTN","ECXUTL4",34,0)
 ;
"RTN","ECXUTL4",35,0)
 ; Input:
"RTN","ECXUTL4",36,0)
 ;   ECXTS   - Treating specialty
"RTN","ECXUTL4",37,0)
 ;
"RTN","ECXUTL4",38,0)
 ; Output:
"RTN","ECXUTL4",39,0)
 ;             Inpatient/Outpatient indicator (I/O)
"RTN","ECXUTL4",40,0)
 ;
"RTN","ECXUTL4",41,0)
 S ECXTS=+$G(ECXTS)
"RTN","ECXUTL4",42,0)
 S ECXIO=""
"RTN","ECXUTL4",43,0)
 ;
"RTN","ECXUTL4",44,0)
 ;- Look up inpat/outpat indicator if treating spec is in file
"RTN","ECXUTL4",45,0)
 I $G(^ECX(727.831,ECXTS,0)) S ECXIO=$P($G(^ECX(727.831,ECXTS,0)),"^",5)
"RTN","ECXUTL4",46,0)
 Q $S(ECXIO'="":ECXIO,1:"I")
"RTN","ECXUTL4",47,0)
 ;
"RTN","ECXUTL4",48,0)
ENCNUM(ECXIO,ECXSSN,ECXADT,ECXVDT,ECXTRT,ECXOBS,ECXEXT,ECXSTP,ECXSTP2) ;
"RTN","ECXUTL4",49,0)
 ; Get encounter number
"RTN","ECXUTL4",50,0)
 ;
"RTN","ECXUTL4",51,0)
 ; Input:
"RTN","ECXUTL4",52,0)
 ;   ECXIO   - Inpat/Outpat indicator = I or O
"RTN","ECXUTL4",53,0)
 ;   ECXSSN  - Patient SSN
"RTN","ECXUTL4",54,0)
 ;   ECXADT  - Admit Date
"RTN","ECXUTL4",55,0)
 ;   ECXVDT  - Visit Date
"RTN","ECXUTL4",56,0)
 ;   ECXTRT  - Treating Spec
"RTN","ECXUTL4",57,0)
 ;   ECXOBS  - Observation Pat Indicator
"RTN","ECXUTL4",58,0)
 ;   ECXEXT  - Extract
"RTN","ECXUTL4",59,0)
 ;   ECXSTP  - Stop Code (or stop code related) variable
"RTN","ECXUTL4",60,0)
 ;   ECXSTP2 - Stop Code (or stop code related) addtl variable
"RTN","ECXUTL4",61,0)
 ;             (used for SUR and ECS)
"RTN","ECXUTL4",62,0)
 ;
"RTN","ECXUTL4",63,0)
 ;Output:
"RTN","ECXUTL4",64,0)
 ;             Encounter Number
"RTN","ECXUTL4",65,0)
 ;
"RTN","ECXUTL4",66,0)
 N ENCNUM,ECXDATE,ECXSTCD
"RTN","ECXUTL4",67,0)
 S (ENCNUM,ECXSTCD)=""
"RTN","ECXUTL4",68,0)
 ;
"RTN","ECXUTL4",69,0)
 ;- Check input vars
"RTN","ECXUTL4",70,0)
 S ECXEXT=$G(ECXEXT),ECXIO=$G(ECXIO),ECXOBS=$G(ECXOBS),ECXTRT=+$G(ECXTRT)
"RTN","ECXUTL4",71,0)
 S ECXSTP=+$G(ECXSTP),ECXSTP2=+$G(ECXSTP2)
"RTN","ECXUTL4",72,0)
 S ECXADT=+$G(ECXADT),ECXVDT=+$G(ECXVDT)
"RTN","ECXUTL4",73,0)
 ;
"RTN","ECXUTL4",74,0)
 ;- Don't use pseudo-SSN in encounter number
"RTN","ECXUTL4",75,0)
 S ECXSSN=$E($G(ECXSSN),1,9)
"RTN","ECXUTL4",76,0)
 ;
"RTN","ECXUTL4",77,0)
 D
"RTN","ECXUTL4",78,0)
 . ;- Inpatient
"RTN","ECXUTL4",79,0)
 . I ECXIO="I",ECXADT,ECXSSN'="" D  Q
"RTN","ECXUTL4",80,0)
 .. S ECXDATE=$$ADMITDT(ECXADT)
"RTN","ECXUTL4",81,0)
 .. I ECXDATE'="" S ENCNUM=ECXSSN_ECXDATE_"I"
"RTN","ECXUTL4",82,0)
 . ;
"RTN","ECXUTL4",83,0)
 . ;- Outpatient branch
"RTN","ECXUTL4",84,0)
 . I ECXIO="O" D
"RTN","ECXUTL4",85,0)
 .. ;- Observation patient (outpatient)
"RTN","ECXUTL4",86,0)
 .. I ECXOBS="YES",ECXSSN'="" D  Q
"RTN","ECXUTL4",87,0)
 ... ;
"RTN","ECXUTL4",88,0)
 ... S ECXDATE=$S(ECXADT:$$JULDT(ECXADT),1:$$JULDT(ECXVDT))
"RTN","ECXUTL4",89,0)
 ... S ECXSTCD=$S(+$P($G(^ECX(727.831,ECXTRT,0)),"^",6):+$P($G(^ECX(727.831,ECXTRT,0)),"^",6),1:+$E(ECXSTP,1,3))
"RTN","ECXUTL4",90,0)
 ... Q:ECXDATE=""!(ECXSTCD="")
"RTN","ECXUTL4",91,0)
 ... S ENCNUM=ECXSSN_ECXDATE_ECXSTCD
"RTN","ECXUTL4",92,0)
 .. ;
"RTN","ECXUTL4",93,0)
 .. ;- Outpatient (no observation pat)
"RTN","ECXUTL4",94,0)
 .. I ECXOBS="NO",ECXVDT,ECXSSN'="" D  Q
"RTN","ECXUTL4",95,0)
 ... ;
"RTN","ECXUTL4",96,0)
 ... ;- ADM, MOV, TRT have no outpat encounter number
"RTN","ECXUTL4",97,0)
 ... I ECXEXT="ADM"!(ECXEXT="MOV")!(ECXEXT="TRT") Q
"RTN","ECXUTL4",98,0)
 ... ;
"RTN","ECXUTL4",99,0)
 ... ;- Use 1st 3 chars of DSS ID for NOS and ECQ (feeder key for CLI)
"RTN","ECXUTL4",100,0)
 ... ;- Use observation stop code for IVP
"RTN","ECXUTL4",101,0)
 ... I ECXEXT="CLI"!(ECXEXT="NOS")!(ECXEXT="ECQ")!(ECXEXT="IVP") S ECXSTCD=+$E(ECXSTP,1,3) Q:'ECXSTCD
"RTN","ECXUTL4",102,0)
 ... ;
"RTN","ECXUTL4",103,0)
 ... ;- Use cost center to obtain stop code for ECS
"RTN","ECXUTL4",104,0)
 ... I ECXEXT="ECS" D  Q:'ECXSTCD
"RTN","ECXUTL4",105,0)
 .... S ECXSTCD=$$ECSCOST(ECXSTP2)
"RTN","ECXUTL4",106,0)
 ....;
"RTN","ECXUTL4",107,0)
 ....;- If no cost center, use 1st 3 chars of DSS ID
"RTN","ECXUTL4",108,0)
 .... I ECXSTCD="" S ECXSTCD=+$E(ECXSTP,1,3)
"RTN","ECXUTL4",109,0)
 ... ;
"RTN","ECXUTL4",110,0)
 ... ;- These extracts have predetermined stop code values
"RTN","ECXUTL4",111,0)
 ... I ECXEXT="DEN" S ECXSTCD=180
"RTN","ECXUTL4",112,0)
 ... I ECXEXT="PRE"!(ECXEXT="UDP") S ECXSTCD=160
"RTN","ECXUTL4",113,0)
 ... I ECXEXT="LAB"!(ECXEXT="LAR")!(ECXEXT="LBB") S ECXSTCD=108
"RTN","ECXUTL4",114,0)
 ... I ECXEXT="MTL" S ECXSTCD=538
"RTN","ECXUTL4",115,0)
 ... I ECXEXT="NUR" S ECXSTCD=950
"RTN","ECXUTL4",116,0)
 ... I ECXEXT="PRO" S ECXSTCD=423
"RTN","ECXUTL4",117,0)
 ... ;
"RTN","ECXUTL4",118,0)
 ... ;- If Imaging Type fld=2, use 109 otherwise use 105
"RTN","ECXUTL4",119,0)
 ... I ECXEXT="RAD" S ECXSTCD=$S(ECXSTP=2:109,1:105)
"RTN","ECXUTL4",120,0)
 ... ;
"RTN","ECXUTL4",121,0)
 ... ;- Use DSS STOP CODE fld if populated or if SURG SPEC fld=59 use 430
"RTN","ECXUTL4",122,0)
 ... ;- otherwise if null use 429
"RTN","ECXUTL4",123,0)
 ... I ECXEXT="SUR" S ECXSTCD=$S(ECXSTP:ECXSTP,ECXSTP2=59:430,1:429)
"RTN","ECXUTL4",124,0)
 ... ;
"RTN","ECXUTL4",125,0)
 ... ;- Get Julian Date
"RTN","ECXUTL4",126,0)
 ... S ECXDATE=$$JULDT(ECXVDT)
"RTN","ECXUTL4",127,0)
 ... I ECXDATE'="" S ENCNUM=ECXSSN_ECXDATE_ECXSTCD
"RTN","ECXUTL4",128,0)
 Q ENCNUM
"RTN","ECXUTL4",129,0)
 ;
"RTN","ECXUTL4",130,0)
ADMITDT(ECXINDT) ; Returns date in YYMMDD format
"RTN","ECXUTL4",131,0)
 ;
"RTN","ECXUTL4",132,0)
 ; Input:
"RTN","ECXUTL4",133,0)
 ;   ECXINDT - Date (can also include time) in internal FM format
"RTN","ECXUTL4",134,0)
 ;
"RTN","ECXUTL4",135,0)
 ;Output:
"RTN","ECXUTL4",136,0)
 ;             Date in YYMMDD form
"RTN","ECXUTL4",137,0)
 ;
"RTN","ECXUTL4",138,0)
 N ECXDT
"RTN","ECXUTL4",139,0)
 S ECXDT=""
"RTN","ECXUTL4",140,0)
 S ECXINDT=+$G(ECXINDT)
"RTN","ECXUTL4",141,0)
 ;
"RTN","ECXUTL4",142,0)
 ;- If no input or full FM date not passed in, quit
"RTN","ECXUTL4",143,0)
 I 'ECXINDT!($L(ECXINDT)<7) G ADMTDTQ
"RTN","ECXUTL4",144,0)
 ;
"RTN","ECXUTL4",145,0)
 ;- Date in YYMMDD form
"RTN","ECXUTL4",146,0)
 S ECXDT=$TR($$FMTE^XLFDT(ECXINDT,"4DF")," /","0")
"RTN","ECXUTL4",147,0)
ADMTDTQ Q ECXDT
"RTN","ECXUTL4",148,0)
 ;
"RTN","ECXUTL4",149,0)
 ;
"RTN","ECXUTL4",150,0)
JULDT(ECXINDT) ;  Returns Julian Date in MMDDD format
"RTN","ECXUTL4",151,0)
 ;
"RTN","ECXUTL4",152,0)
 ; Input:
"RTN","ECXUTL4",153,0)
 ;   ECINDT  - Date (can also include time) in internal FM format
"RTN","ECXUTL4",154,0)
 ;
"RTN","ECXUTL4",155,0)
 ;Output:
"RTN","ECXUTL4",156,0)
 ;             Julian date in MM_DDD form
"RTN","ECXUTL4",157,0)
 ;
"RTN","ECXUTL4",158,0)
 N ECXDDD,ECXDT,ECXJUL,ECXMM
"RTN","ECXUTL4",159,0)
 S (ECXDDD,ECXMM)=""
"RTN","ECXUTL4",160,0)
 ;
"RTN","ECXUTL4",161,0)
 ;- If no input or full FM date not passed in, quit
"RTN","ECXUTL4",162,0)
 S ECXINDT=+$G(ECXINDT)
"RTN","ECXUTL4",163,0)
 I 'ECXINDT!($L(ECXINDT)<7) G JULDTQ
"RTN","ECXUTL4",164,0)
 ;
"RTN","ECXUTL4",165,0)
 ;- Extract date portion
"RTN","ECXUTL4",166,0)
 S ECXDT=$E(ECXINDT,1,7)
"RTN","ECXUTL4",167,0)
 ;
"RTN","ECXUTL4",168,0)
 ;- Get month (MM)
"RTN","ECXUTL4",169,0)
 S ECXMM=$E(ECXINDT,2,3)
"RTN","ECXUTL4",170,0)
 ;
"RTN","ECXUTL4",171,0)
 ;- Number of day within year (DDD)
"RTN","ECXUTL4",172,0)
 S ECXDDD=$$RJ^XLFSTR($$FMDIFF^XLFDT(ECXDT,$E(ECXDT,1,3)_"0101",1)+1,3,"0")
"RTN","ECXUTL4",173,0)
JULDTQ Q ECXMM_ECXDDD
"RTN","ECXUTL4",174,0)
 ;
"RTN","ECXUTL4",175,0)
CNHSTAT(ECXDFN) ;  Get CNH (Contract Nursing Home) status
"RTN","ECXUTL4",176,0)
 ;
"RTN","ECXUTL4",177,0)
 ; Input:
"RTN","ECXUTL4",178,0)
 ;   ECXDFN  - Patient DFN
"RTN","ECXUTL4",179,0)
 ;
"RTN","ECXUTL4",180,0)
 ;Output:
"RTN","ECXUTL4",181,0)
 ;             CNH status (YES/NO)
"RTN","ECXUTL4",182,0)
 ;
"RTN","ECXUTL4",183,0)
 N ECXCNH
"RTN","ECXUTL4",184,0)
 S ECXDFN=+$G(ECXDFN)
"RTN","ECXUTL4",185,0)
 S ECXCNH=$P($G(^DPT(ECXDFN,"NHC")),U)
"RTN","ECXUTL4",186,0)
 Q $S(ECXCNH="Y":"YES",ECXCNH="N":"NO",1:"")
"RTN","ECXUTL4",187,0)
 ;
"RTN","ECXUTL4",188,0)
CANC(ECXNOR,ECXTMOR) ; Get Surgery Cancelled/Aborted Status
"RTN","ECXUTL4",189,0)
 ;
"RTN","ECXUTL4",190,0)
 ; Function called after determining CANCEL DATE in SURGERY record exists
"RTN","ECXUTL4",191,0)
 ;
"RTN","ECXUTL4",192,0)
 ; Input:
"RTN","ECXUTL4",193,0)
 ;   ECXNOR   - Non-OR DSS ID
"RTN","ECXUTL4",194,0)
 ;   ECXTMOR  - Time Pat in OR
"RTN","ECXUTL4",195,0)
 ;
"RTN","ECXUTL4",196,0)
 ;Output:
"RTN","ECXUTL4",197,0)
 ;              Cancelled/aborted status (C/A)
"RTN","ECXUTL4",198,0)
 ;
"RTN","ECXUTL4",199,0)
 N ECXCANC
"RTN","ECXUTL4",200,0)
 S ECXCANC=""
"RTN","ECXUTL4",201,0)
 S ECXNOR=$G(ECXNOR)
"RTN","ECXUTL4",202,0)
 ;
"RTN","ECXUTL4",203,0)
 ;- If Non-OR DSS ID or Time Pat in OR, ECXCANC = "A" else = "C"
"RTN","ECXUTL4",204,0)
 D
"RTN","ECXUTL4",205,0)
 . I ECXNOR'=""&(ECXNOR'="UNKNOWN") S ECXCANC="A" Q
"RTN","ECXUTL4",206,0)
 . I +$G(ECXTMOR) S ECXCANC="A" Q
"RTN","ECXUTL4",207,0)
 . S ECXCANC="C"
"RTN","ECXUTL4",208,0)
 Q ECXCANC
"RTN","ECXUTL4",209,0)
 ;
"RTN","ECXUTL4",210,0)
ECSCOST(ECXCOST) ;Get ECS extract stop code based on cost center
"RTN","ECXUTL4",211,0)
 ;
"RTN","ECXUTL4",212,0)
 ;
"RTN","ECXUTL4",213,0)
 ; Input:
"RTN","ECXUTL4",214,0)
 ;   ECXCOST  - ECS extract cost center
"RTN","ECXUTL4",215,0)
 ;
"RTN","ECXUTL4",216,0)
 ;Output:
"RTN","ECXUTL4",217,0)
 ;              ECS extract stop code
"RTN","ECXUTL4",218,0)
 ;
"RTN","ECXUTL4",219,0)
 N ECXFND,ECXSTOP,I
"RTN","ECXUTL4",220,0)
 S ECXFND=0
"RTN","ECXUTL4",221,0)
 S ECXSTOP=""
"RTN","ECXUTL4",222,0)
 S ECXCOST=+$G(ECXCOST)
"RTN","ECXUTL4",223,0)
 D
"RTN","ECXUTL4",224,0)
 . I 'ECXCOST Q
"RTN","ECXUTL4",225,0)
 . F I=1:1 Q:ECXFND!($P($T(COST+I),";;",2)="END")  D
"RTN","ECXUTL4",226,0)
 .. I ECXCOST=$P($T(COST+I),";;",2) S ECXSTOP=$P($T(COST+I),";;",3),ECXFND=1
"RTN","ECXUTL4",227,0)
 Q ECXSTOP
"RTN","ECXUTL4",228,0)
 ;
"RTN","ECXUTL4",229,0)
COST ;- ECS Cost Center and stop code
"RTN","ECXUTL4",230,0)
 ;;833100;;652
"RTN","ECXUTL4",231,0)
 ;;833200;;653
"RTN","ECXUTL4",232,0)
 ;;833300;;681
"RTN","ECXUTL4",233,0)
 ;;834100;;651
"RTN","ECXUTL4",234,0)
 ;;834200;;650
"RTN","ECXUTL4",235,0)
 ;;834300;;681
"RTN","ECXUTL4",236,0)
 ;;834400;;654
"RTN","ECXUTL4",237,0)
 ;;834500;;681
"RTN","ECXUTL4",238,0)
 ;;834600;;681
"RTN","ECXUTL4",239,0)
 ;;834700;;681
"RTN","ECXUTL4",240,0)
 ;;834800;;681
"RTN","ECXUTL4",241,0)
 ;;834900;;681
"RTN","ECXUTL4",242,0)
 ;;836100;;654
"RTN","ECXUTL4",243,0)
 ;;836200;;654
"RTN","ECXUTL4",244,0)
 ;;END
"RTN","ECXUTL4",245,0)
 ;
"RTN","ECXUTL4",246,0)
HNCI(ECXDFN) ; Get head & neck cancer indicator
"RTN","ECXUTL4",247,0)
 ;
"RTN","ECXUTL4",248,0)
 ; Input:
"RTN","ECXUTL4",249,0)
 ;   ECXDFN  - Patient DFN
"RTN","ECXUTL4",250,0)
 ;
"RTN","ECXUTL4",251,0)
 ;Output:
"RTN","ECXUTL4",252,0)
 ;             Head/Neck CA DX (Y/N)
"RTN","ECXUTL4",253,0)
 ;
"RTN","ECXUTL4",254,0)
 N ECXHNCI,DGNT
"RTN","ECXUTL4",255,0)
 S ECXHNCI=""
"RTN","ECXUTL4",256,0)
 S ECXDFN=+$G(ECXDFN) I ECXDFN D
"RTN","ECXUTL4",257,0)
 .I $$GETCUR^DGNTAPI(ECXDFN,"DGNT") S ECXHNCI=$P(DGNT("HNC"),U)
"RTN","ECXUTL4",258,0)
 Q ECXHNCI
"RTN","ECXUTL4",259,0)
 ;
"RTN","ECXUTL4",260,0)
TSMAP(ECXTS) ;Determines DSS Identifier for the following observation
"RTN","ECXUTL4",261,0)
 ; treating speciality
"RTN","ECXUTL4",262,0)
 ; Input:
"RTN","ECXUTL4",263,0)
 ;   ECXTS - Observation Treating Speciality
"RTN","ECXUTL4",264,0)
 ;
"RTN","ECXUTL4",265,0)
 ; Output:
"RTN","ECXUTL4",266,0)
 ;   DSS Identifier (Stop Code)
"RTN","ECXUTL4",267,0)
 ;
"RTN","ECXUTL4",268,0)
 N TS,SC,I
"RTN","ECXUTL4",269,0)
 S TS="^18^23^24^36^41^65^94^",SC="^293^295^290^294^296^291^292^"
"RTN","ECXUTL4",270,0)
 F I=1:1:$L(TS) Q:$P(TS,"^",I)=ECXTS
"RTN","ECXUTL4",271,0)
 Q $P(SC,"^",I)_"000"
"VER")
8.0^22.0
"^DD",727.1,727.1,0)
FIELD^^13^14
"^DD",727.1,727.1,0,"DDA")
N
"^DD",727.1,727.1,0,"DT")
2990327
"^DD",727.1,727.1,0,"IX","AC",727.1,7)

"^DD",727.1,727.1,0,"IX","AF",727.1,1)

"^DD",727.1,727.1,0,"IX","B",727.1,.01)

"^DD",727.1,727.1,0,"IX","C",727.1,8)

"^DD",727.1,727.1,0,"NM","EXTRACT DEFINITIONS")

"^DD",727.1,727.1,0,"VRPK")
ECX
"^DD",727.1,727.1,.01,0)
EXTRACT NAME^RFI^^0;1^K:$L(X)>30!($L(X)<1) X
"^DD",727.1,727.1,.01,1,0)
^.1
"^DD",727.1,727.1,.01,1,1,0)
727.1^B
"^DD",727.1,727.1,.01,1,1,1)
S ^ECX(727.1,"B",$E(X,1,30),DA)=""
"^DD",727.1,727.1,.01,1,1,2)
K ^ECX(727.1,"B",$E(X,1,30),DA)
"^DD",727.1,727.1,.01,3)
Answer must be 1-30 characters in length.
"^DD",727.1,727.1,.01,21,0)
^^1^1^2930415^^^^
"^DD",727.1,727.1,.01,21,1,0)
The name of the extract.
"^DD",727.1,727.1,.01,"DT")
2950421
"^DD",727.1,727.1,1,0)
FILE NUMBER^RNJ7,3I^^0;2^K:+X'=X!(X>728)!(X<727)!(X?.E1"."4N.N) X
"^DD",727.1,727.1,1,1,0)
^.1
"^DD",727.1,727.1,1,1,1,0)
727.1^AF
"^DD",727.1,727.1,1,1,1,1)
S ^ECX(727.1,"AF",$E(X,1,30),DA)=""
"^DD",727.1,727.1,1,1,1,2)
K ^ECX(727.1,"AF",$E(X,1,30),DA)
"^DD",727.1,727.1,1,1,1,3)
DO NOT DELETE
"^DD",727.1,727.1,1,1,1,"%D",0)
^^2^2^2930415^^
"^DD",727.1,727.1,1,1,1,"%D",1,0)
This cross reference is essential for determing the frequency and date
"^DD",727.1,727.1,1,1,1,"%D",2,0)
range for package extracts.  Do not delete.
"^DD",727.1,727.1,1,1,1,"DT")
2930129
"^DD",727.1,727.1,1,3)
Type a Number between 727 and 728, 3 Decimal Digits
"^DD",727.1,727.1,1,21,0)
^^1^1^2930129^
"^DD",727.1,727.1,1,21,1,0)
The number of the file into which this extract places data.
"^DD",727.1,727.1,1,23,0)
^^4^4^2930129^
"^DD",727.1,727.1,1,23,1,0)
The AF cross reference on this file is used by the extract routines,
"^DD",727.1,727.1,1,23,2,0)
using the variable ECFILE, to determine the frequency with which the
"^DD",727.1,727.1,1,23,3,0)
extract is run and, from the frequency, the starting and ending days
"^DD",727.1,727.1,1,23,4,0)
for the extract.
"^DD",727.1,727.1,1,"DT")
2940428
"^DD",727.1,727.1,2,0)
FREQUENCY^S^D:DAILY;W:WEEKLY;M:MONTHLY;^0;3^Q
"^DD",727.1,727.1,2,21,0)
^^5^5^2940225^^^^
"^DD",727.1,727.1,2,21,1,0)
This field determines the frequency with which this extract will be
"^DD",727.1,727.1,2,21,2,0)
run.  Daily extracts are run for a single day, T-X, where X is the
"^DD",727.1,727.1,2,21,3,0)
number entered in the DAYS AGO field in this file.  Weekly extracts
"^DD",727.1,727.1,2,21,4,0)
are run for the week ending on T-X.  Monthly extracts are run for
"^DD",727.1,727.1,2,21,5,0)
the previous month.
"^DD",727.1,727.1,2,23,0)
^^2^2^2940225^^^^
"^DD",727.1,727.1,2,23,1,0)
This field is used by the extract routines to determine the starting
"^DD",727.1,727.1,2,23,2,0)
and ending dates for the extract.
"^DD",727.1,727.1,2,"DT")
2940225
"^DD",727.1,727.1,3,0)
DAYS AGO^RNJ2,0^^0;4^K:+X'=X!(X>30)!(X<1)!(X?.E1"."1N.N) X
"^DD",727.1,727.1,3,3)
Type a Number between 1 and 30, 0 Decimal Digits
"^DD",727.1,727.1,3,21,0)
^^4^4^2930811^^
"^DD",727.1,727.1,3,21,1,0)
This field is used for daily and weekly extracts to determine how
"^DD",727.1,727.1,3,21,2,0)
many days ago the extract should look for data.  For daily extracts,
"^DD",727.1,727.1,3,21,3,0)
the date would be T-X, for weekly extracts, the date range would
"^DD",727.1,727.1,3,21,4,0)
be from T-X-7 to T-X.
"^DD",727.1,727.1,3,23,0)
^^2^2^2930811^^
"^DD",727.1,727.1,3,23,1,0)
Used by the extract routines to determine the date for a daily extract
"^DD",727.1,727.1,3,23,2,0)
or the date range for a weekly extract.
"^DD",727.1,727.1,3,"DT")
2930129
"^DD",727.1,727.1,4,0)
ROUTINE^FI^^ROU;1^K:$L(X)>8!($L(X)<1)!'(X?1"ECX".UN) X
"^DD",727.1,727.1,4,3)
Answer must be 1-8 characters in length.
"^DD",727.1,727.1,4,21,0)
^^2^2^2930811^^
"^DD",727.1,727.1,4,21,1,0)
The name of the routine which performs this extract.  Data is loaded
"^DD",727.1,727.1,4,21,2,0)
into this field at creation time as should not be edited in the field
"^DD",727.1,727.1,4,23,0)
^^4^4^2930811^^
"^DD",727.1,727.1,4,23,1,0)
Data in this field is used to queue the initial extract.  Once the
"^DD",727.1,727.1,4,23,2,0)
extract manager specifies the frequency, days offset, start date
"^DD",727.1,727.1,4,23,3,0)
(which is not a data element in this file), the extract setup
"^DD",727.1,727.1,4,23,4,0)
calls %ZTLOAD to queue QUE^routine at the proper time.
"^DD",727.1,727.1,4,"DT")
2940324
"^DD",727.1,727.1,5,0)
OFFSET^NJ2,0^^0;5^K:+X'=X!(X>60)!(X<1)!(X?.E1"."1N.N) X
"^DD",727.1,727.1,5,3)
The offset, in days, for the daily local extract
"^DD",727.1,727.1,5,21,0)
^^2^2^2980706^^
"^DD",727.1,727.1,5,21,1,0)
This field is used by the local daily extract to determine how many days
"^DD",727.1,727.1,5,21,2,0)
back to look for data
"^DD",727.1,727.1,5,"DT")
2930827
"^DD",727.1,727.1,6,0)
QUEUED^SI^1:YES;^0;6^Q
"^DD",727.1,727.1,6,21,0)
^^6^6^2990601^^^
"^DD",727.1,727.1,6,21,1,0)
This field is set by the software when the extract is queued to
"^DD",727.1,727.1,6,21,2,0)
run.  Once this field is set, other data elements should be
"^DD",727.1,727.1,6,21,3,0)
changed only with extreme care.  Changing either the frequency or
"^DD",727.1,727.1,6,21,4,0)
the days ago field could result in a date range being missed and
"^DD",727.1,727.1,6,21,5,0)
not extracted for trasmission to TSI.
"^DD",727.1,727.1,6,21,6,0)
 
"^DD",727.1,727.1,6,"DT")
2940324
"^DD",727.1,727.1,7,0)
TYPE^RF^^0;7^K:$L(X)>30!($L(X)<3) X
"^DD",727.1,727.1,7,1,0)
^.1
"^DD",727.1,727.1,7,1,1,0)
727.1^AC
"^DD",727.1,727.1,7,1,1,1)
S ^ECX(727.1,"AC",$E(X,1,30),DA)=""
"^DD",727.1,727.1,7,1,1,2)
K ^ECX(727.1,"AC",$E(X,1,30),DA)
"^DD",727.1,727.1,7,1,1,"DT")
2980706
"^DD",727.1,727.1,7,3)
Answer must be 3-30 characters in length.
"^DD",727.1,727.1,7,21,0)
^^3^3^2970925^
"^DD",727.1,727.1,7,21,1,0)
This is the print name for the extract.  It has an important use in
"^DD",727.1,727.1,7,21,2,0)
supplying a data element to the TYPE field (#2) of the DSS EXTRACT
"^DD",727.1,727.1,7,21,3,0)
LOG file (#727).
"^DD",727.1,727.1,7,23,0)
^^5^5^2970925^
"^DD",727.1,727.1,7,23,1,0)
A free text field; only 1st character is capitalized.  Used as
"^DD",727.1,727.1,7,23,2,0)
print name for the extract.
"^DD",727.1,727.1,7,23,3,0)
 
"^DD",727.1,727.1,7,23,4,0)
This data element is also hard-coded into the SETUP code unit of
"^DD",727.1,727.1,7,23,5,0)
each extract routine using variable ECPACK.
"^DD",727.1,727.1,7,"DT")
2980706
"^DD",727.1,727.1,8,0)
HEADER CODE^RF^^0;8^K:$L(X)>3!($L(X)<3) X
"^DD",727.1,727.1,8,1,0)
^.1
"^DD",727.1,727.1,8,1,1,0)
727.1^C
"^DD",727.1,727.1,8,1,1,1)
S ^ECX(727.1,"C",$E(X,1,30),DA)=""
"^DD",727.1,727.1,8,1,1,2)
K ^ECX(727.1,"C",$E(X,1,30),DA)
"^DD",727.1,727.1,8,1,1,3)
Do not delete this cross-reference.
"^DD",727.1,727.1,8,1,1,"%D",0)
^^2^2^2970925^
"^DD",727.1,727.1,8,1,1,"%D",1,0)
This cross-reference will be used by all the extract audit report
"^DD",727.1,727.1,8,1,1,"%D",2,0)
routines to obtain defining information on the extract.
"^DD",727.1,727.1,8,1,1,"DT")
2970925
"^DD",727.1,727.1,8,3)
Answer must be 3 characters in length.
"^DD",727.1,727.1,8,21,0)
^^2^2^2970925^^
"^DD",727.1,727.1,8,21,1,0)
The unique 3-letter identifier code for the extract type.  Needed for
"^DD",727.1,727.1,8,21,2,0)
the header record in each extract transmission.
"^DD",727.1,727.1,8,23,0)
^^4^4^2970925^^
"^DD",727.1,727.1,8,23,1,0)
A 3-character identifying code; each character is an uppercase alpha.
"^DD",727.1,727.1,8,23,2,0)
 
"^DD",727.1,727.1,8,23,3,0)
This data element is also hard-coded into the SETUP code unit of
"^DD",727.1,727.1,8,23,4,0)
each extract routine using variable ECHEAD.
"^DD",727.1,727.1,8,"DT")
2970925
"^DD",727.1,727.1,9,0)
GROUP^RF^^0;9^K:$L(X)>5!($L(X)<2) X
"^DD",727.1,727.1,9,3)
Answer must be 2-5 characters in length.
"^DD",727.1,727.1,9,21,0)
^^1^1^2970925^
"^DD",727.1,727.1,9,21,1,0)
This code identifies the data group to which the extract belongs.
"^DD",727.1,727.1,9,23,0)
^^4^4^2970925^
"^DD",727.1,727.1,9,23,1,0)
A 2-5 character identifying code; each character is an uppercase alpha.
"^DD",727.1,727.1,9,23,2,0)
 
"^DD",727.1,727.1,9,23,3,0)
This data element is also hard-coded into the SETUP code unit of
"^DD",727.1,727.1,9,23,4,0)
each extract routine using variable ECGRP.
"^DD",727.1,727.1,9,"DT")
2970925
"^DD",727.1,727.1,10,0)
AUDIT DESCRIPTION^727.11^^1;0
"^DD",727.1,727.1,11,0)
RUNNING PIECE^RNJ2,0^^0;10^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",727.1,727.1,11,3)
Type a Number between 1 and 99, 0 Decimal Digits
"^DD",727.1,727.1,11,21,0)
^^3^3^2980706^^
"^DD",727.1,727.1,11,21,1,0)
This numeric provides the position of the data element which indicates
"^DD",727.1,727.1,11,21,2,0)
whether an extract of this type is currently running or is queued to
"^DD",727.1,727.1,11,21,3,0)
run.
"^DD",727.1,727.1,11,23,0)
^^2^2^2980706^
"^DD",727.1,727.1,11,23,1,0)
The piece of the ^ECX(728,1,7.1) node indicated in this field will
"^DD",727.1,727.1,11,23,2,0)
contain an "R", if the extract is currently running or queued to run.
"^DD",727.1,727.1,11,"DT")
2980706
"^DD",727.1,727.1,12,0)
MAX. LINES PER MESSAGE^RNJ3,0^^0;11^K:+X'=X!(X>500)!(X<2)!(X?.E1"."1N.N) X
"^DD",727.1,727.1,12,3)
Type a Number between 2 and 500, 0 Decimal Digits
"^DD",727.1,727.1,12,21,0)
^^10^10^2990326^^
"^DD",727.1,727.1,12,21,1,0)
This number is the maximum number of lines per transmission message
"^DD",727.1,727.1,12,21,2,0)
allowed for this extract type.
"^DD",727.1,727.1,12,21,3,0)
  
"^DD",727.1,727.1,12,21,4,0)
A default value of 200 is usually acceptable for most extracts.
"^DD",727.1,727.1,12,21,5,0)
However, for some (e.g., CLI, ADM) lower values are recommended.
"^DD",727.1,727.1,12,21,6,0)
 
"^DD",727.1,727.1,12,21,7,0)
It may be possible in some cases to set a value greater than 200,
"^DD",727.1,727.1,12,21,8,0)
thus reducing the total number of transmission messages needed for
"^DD",727.1,727.1,12,21,9,0)
the extract.  However, if the transmission message becomes larger
"^DD",727.1,727.1,12,21,10,0)
than 32 Kbytes, it will be rejected by AAC.
"^DD",727.1,727.1,12,"DT")
2990327
"^DD",727.1,727.1,13,0)
INACTIVE^S^1:YES;0:NO;^0;12^Q
"^DD",727.1,727.1,13,3)
Enter YES if this extract is inactive
"^DD",727.1,727.1,13,21,0)
^^1^1^3030710^
"^DD",727.1,727.1,13,21,1,0)
Denotes whether or not this extract is considered inactive.
"^DD",727.1,727.1,13,"DT")
3030710
"^DD",727.1,727.11,0)
AUDIT DESCRIPTION SUB-FIELD^^.01^1
"^DD",727.1,727.11,0,"DT")
2971030
"^DD",727.1,727.11,0,"NM","AUDIT DESCRIPTION")

"^DD",727.1,727.11,0,"UP")
727.1
"^DD",727.1,727.11,.01,0)
AUDIT DESCRIPTION^WL^^0;1^Q
"^DD",727.1,727.11,.01,21,0)
^^2^2^2971030^^
"^DD",727.1,727.11,.01,21,1,0)
The information contained here provides user instructions on the 
"^DD",727.1,727.11,.01,21,2,0)
recommended method for verifying the extract audit report.
"^DD",727.1,727.11,.01,"DT")
2971030
"^DD",727.829,727.829,0)
FIELD^^19^20
"^DD",727.829,727.829,0,"DDA")
N
"^DD",727.829,727.829,0,"DT")
3041202
"^DD",727.829,727.829,0,"IX","AC",727.829,2)

"^DD",727.829,727.829,0,"IX","B",727.829,.01)

"^DD",727.829,727.829,0,"NM","BLOOD BANK EXTRACT")

"^DD",727.829,727.829,.01,0)
SEQUENCE NUMBER^RNJ9,0X^^0;1^K:+X'=X!(X>999999999)!(X<1)!(X?.E1"."1N.N) X S:$D(X) DINUM=X
"^DD",727.829,727.829,.01,1,0)
^.1
"^DD",727.829,727.829,.01,1,1,0)
727.829^B
"^DD",727.829,727.829,.01,1,1,1)
S ^ECX(727.829,"B",$E(X,1,30),DA)=""
"^DD",727.829,727.829,.01,1,1,2)
K ^ECX(727.829,"B",$E(X,1,30),DA)
"^DD",727.829,727.829,.01,3)
Type a Number between 1 and 999999999, 0 Decimal Digits
"^DD",727.829,727.829,.01,21,0)
^^1^1^3041202^
"^DD",727.829,727.829,.01,21,1,0)
The record number for this extract entry.
"^DD",727.829,727.829,.01,23,0)
^^2^2^3041202^
"^DD",727.829,727.829,.01,23,1,0)
The internal entry number (IEN) for this record.  This entry is DINUMed.
"^DD",727.829,727.829,.01,23,2,0)
It is not transmitted to the AAC.  Part of the header for extract record.
"^DD",727.829,727.829,.01,"DT")
3041202
"^DD",727.829,727.829,1,0)
YEAR MONTH^FO^^0;2^K:$L(X)>6!($L(X)<6)!'(X?6N) X
"^DD",727.829,727.829,1,.1)
Year/Month
"^DD",727.829,727.829,1,2)
S Y(0)=Y S Y=$$ECXYMX^ECXUTL(Y)
"^DD",727.829,727.829,1,2.1)
S Y=$$ECXYMX^ECXUTL(Y)
"^DD",727.829,727.829,1,3)
format is YYYYMM
"^DD",727.829,727.829,1,21,0)
^^2^2^3041202^
"^DD",727.829,727.829,1,21,1,0)
A six character numeric string representing the year and the month
"^DD",727.829,727.829,1,21,2,0)
for which this extract was performed.
"^DD",727.829,727.829,1,23,0)
^^1^1^3041202^
"^DD",727.829,727.829,1,23,1,0)
Not transmitted to the AAC.  Part of header for extract record.
"^DD",727.829,727.829,1,"DT")
3050301
"^DD",727.829,727.829,2,0)
EXTRACT NUMBER^P727'^ECX(727,^0;3^Q
"^DD",727.829,727.829,2,.1)
Extract Number
"^DD",727.829,727.829,2,1,0)
^.1
"^DD",727.829,727.829,2,1,1,0)
727.829^AC
"^DD",727.829,727.829,2,1,1,1)
S ^ECX(727.829,"AC",$E(X,1,30),DA)=""
"^DD",727.829,727.829,2,1,1,2)
K ^ECX(727.829,"AC",$E(X,1,30),DA)
"^DD",727.829,727.829,2,1,1,3)
DO NOT DELETE
"^DD",727.829,727.829,2,1,1,"%D",0)
^.101^2^2^3041213^^
"^DD",727.829,727.829,2,1,1,"%D",1,0)
This cross reference is essential for managing and purging data in this
"^DD",727.829,727.829,2,1,1,"%D",2,0)
file.
"^DD",727.829,727.829,2,1,1,"DT")
3041213
"^DD",727.829,727.829,2,3)
Enter the extract number for this extract.
"^DD",727.829,727.829,2,21,0)
^.001^2^2^3041202^^^
"^DD",727.829,727.829,2,21,1,0)
The corresponding entry in the DSS EXTRACT LOG file (#727) for this
"^DD",727.829,727.829,2,21,2,0)
extract.
"^DD",727.829,727.829,2,23,0)
^^2^2^3041202^
"^DD",727.829,727.829,2,23,1,0)
A pointer to the DSS EXTRACT LOG file (#727). The primary purpose is to
"^DD",727.829,727.829,2,23,2,0)
pick up the header for the mail message.  Not transmitted to the AAC.
"^DD",727.829,727.829,2,"DT")
3041213
"^DD",727.829,727.829,3,0)
FACILITY^F^^0;4^K:$L(X)>7!($L(X)<1) X
"^DD",727.829,727.829,3,.1)
Facility
"^DD",727.829,727.829,3,3)
Answer must be 1-7 characters in length.
"^DD",727.829,727.829,3,21,0)
^.001^1^1^3040513^^^
"^DD",727.829,727.829,3,21,1,0)
Identifies the facility for this extract record.
"^DD",727.829,727.829,3,23,0)
^.001^4^4^3040513^^
"^DD",727.829,727.829,3,23,1,0)
An indicator of the division where this event happened. Using the NAME
"^DD",727.829,727.829,3,23,2,0)
field (.01) pointer from the DSS EXTRACTS file (#728), FACILITY is
"^DD",727.829,727.829,3,23,3,0)
derived from the STATION NUMBER field (99) for that pointer number in
"^DD",727.829,727.829,3,23,4,0)
the INSTITUTION file (#4).
"^DD",727.829,727.829,3,"DT")
3040513
"^DD",727.829,727.829,4,0)
PATIENT NO. - DFN^P2'^DPT(^0;5^Q
"^DD",727.829,727.829,4,.1)
Patient No. - DFN
"^DD",727.829,727.829,4,3)

"^DD",727.829,727.829,4,21,0)
^.001^1^1^3041202^^^
"^DD",727.829,727.829,4,21,1,0)
An identifying number for the patient at the local site.
"^DD",727.829,727.829,4,23,0)
^^1^1^3041202^
"^DD",727.829,727.829,4,23,1,0)
Defined as the IEN of a given record entry in the PATIENT file (#2).
"^DD",727.829,727.829,4,"DT")
3041202
"^DD",727.829,727.829,5,0)
SSN^F^^0;6^K:$L(X)>10!($L(X)<9) X
"^DD",727.829,727.829,5,3)
Answer must be 9-10 characters in length.
"^DD",727.829,727.829,5,21,0)
^^1^1^3041202^^
"^DD",727.829,727.829,5,21,1,0)
The patient's social security number.
"^DD",727.829,727.829,5,23,0)
^^1^1^3041202^
"^DD",727.829,727.829,5,23,1,0)
Obtained from field .09 of the PATIENT file (#2) using DFN.
"^DD",727.829,727.829,5,"DT")
3041202
"^DD",727.829,727.829,6,0)
NAME^F^^0;7^K:$L(X)>4!($L(X)<4) X
"^DD",727.829,727.829,6,3)
First 4 characters of patient's last name padding with spaces if necessary
"^DD",727.829,727.829,6,21,0)
^^1^1^3041202^^
"^DD",727.829,727.829,6,21,1,0)
The first four characters of the patient's last name.
"^DD",727.829,727.829,6,23,0)
^^1^1^3041202^
"^DD",727.829,727.829,6,23,1,0)
Field is retrieved from .01 field of PATIENT file (#2) using DFN.
"^DD",727.829,727.829,6,"DT")
3041202
"^DD",727.829,727.829,7,0)
IN/OUT PATIENT INDICATOR^F^^0;8^K:$L(X)>1!($L(X)<1) X
"^DD",727.829,727.829,7,3)
'O'- Outpatient, 'I'- Inpatient
"^DD",727.829,727.829,7,21,0)
^.001^2^2^3041202^^^
"^DD",727.829,727.829,7,21,1,0)
Indicates whether the patient was an inpatient or an outpatient for this
"^DD",727.829,727.829,7,21,2,0)
extract entry.
"^DD",727.829,727.829,7,23,0)
^^3^3^3041202^
"^DD",727.829,727.829,7,23,1,0)
This field formerly contained the the value 1=Outpatient or 3=Inpatient.
"^DD",727.829,727.829,7,23,2,0)
In FY2002, this field has been changed to free text and will contain
"^DD",727.829,727.829,7,23,3,0)
"O"=Outpatient or "I"=Inpatient.  Determined by a call to IN5^VADPT.
"^DD",727.829,727.829,7,"DT")
3041202
"^DD",727.829,727.829,8,0)
ENCOUNTER NUMBER^F^^0;9^K:$L(X)>18!($L(X)<1) X
"^DD",727.829,727.829,8,.1)
Encounter Number
"^DD",727.829,727.829,8,3)
Answer must be 1-18 characters in length.
"^DD",727.829,727.829,8,21,0)
^^3^3^3041202^^
"^DD",727.829,727.829,8,21,1,0)
This field is derived from the inpatient/outpatient status, SSN,
"^DD",727.829,727.829,8,21,2,0)
admit/visit date, treating specialty, observation patient indicator, and
"^DD",727.829,727.829,8,21,3,0)
DSS Identifier or feeder key values in the record.
"^DD",727.829,727.829,8,23,0)
^^15^15^3041202^
"^DD",727.829,727.829,8,23,1,0)
Determined by the following:  If IN/OUT PATIENT INDICATOR = 'I', the 
"^DD",727.829,727.829,8,23,2,0)
ENCOUNTER NUMBER is the Patient SSN concatenated with the Admit Date 
"^DD",727.829,727.829,8,23,3,0)
concatenated with the letter 'I'.
"^DD",727.829,727.829,8,23,4,0)
 
"^DD",727.829,727.829,8,23,5,0)
If the IN/OUT PATIENT INDICATOR field is 'O' and the OBSERVATION PATIENT
"^DD",727.829,727.829,8,23,6,0)
INDICATOR field is 'NO', then encounter is presumed to be an Outpatient
"^DD",727.829,727.829,8,23,7,0)
Encounter and the ENCOUNTER NUMBER field is the Patient SSN concatenated
"^DD",727.829,727.829,8,23,8,0)
with the Julian Date of Visit concatenated with Stop Code.   For the LBB
"^DD",727.829,727.829,8,23,9,0)
Extract the Outpatient Stop Code is always = '108' (SSSSSSSSSS+YYDDD+108).
"^DD",727.829,727.829,8,23,10,0)
 
"^DD",727.829,727.829,8,23,11,0)
If the IN/OUT PATIENT INDICATOR field is 'O' and the OBSERVATION PATIENT
"^DD",727.829,727.829,8,23,12,0)
INDICATOR field is equal to 'YES', then the ENCOUNTER NUMBER is the
"^DD",727.829,727.829,8,23,13,0)
Patient SSN concatenated with the Admit Julian Date concatenated with the
"^DD",727.829,727.829,8,23,14,0)
Observation Stop Code.  SSSSSSSSSS+YYDDD+CCC.   Found using
"^DD",727.829,727.829,8,23,15,0)
ENCNUM^ECXUTL4.
"^DD",727.829,727.829,8,"DT")
3041202
"^DD",727.829,727.829,9,0)
DATE OF TRANSFUSION^FO^^0;10^K:$L(X)>8!($L(X)<8) X
"^DD",727.829,727.829,9,.1)
Date of Transfusion
"^DD",727.829,727.829,9,2)
S Y(0)=Y S Y=$$ECXDATEX^ECXUTL(Y)
"^DD",727.829,727.829,9,2.1)
S Y=$$ECXDATEX^ECXUTL(Y)
"^DD",727.829,727.829,9,3)
Format is YYYYMMDD
"^DD",727.829,727.829,9,21,0)
^^1^1^3041202^^
"^DD",727.829,727.829,9,21,1,0)
This field contains the date of the blood component transfusion.
"^DD",727.829,727.829,9,23,0)
^^2^2^3041202^
"^DD",727.829,727.829,9,23,1,0)
Obtained from field .01 of the TRANSFUSION RECORD sub-file (#63.017) of 
"^DD",727.829,727.829,9,23,2,0)
the LAB DATA file (#63).
"^DD",727.829,727.829,9,"DT")
3050209
"^DD",727.829,727.829,10,0)
TIME OF TRANSFUSION^FO^^0;11^K:$L(X)>6!($L(X)<6) X
"^DD",727.829,727.829,10,.1)
Time of Transfusion
"^DD",727.829,727.829,10,2)
S Y(0)=Y S Y=$$ECXTIMEX^ECXUTL(Y,1)
"^DD",727.829,727.829,10,2.1)
S Y=$$ECXTIMEX^ECXUTL(Y,1)
"^DD",727.829,727.829,10,3)
Format is HHMMSS
"^DD",727.829,727.829,10,21,0)
^^2^2^3041202^
"^DD",727.829,727.829,10,21,1,0)
A 6-character numeric string that represents the time of day
"^DD",727.829,727.829,10,21,2,0)
the blood component transfusion was performed.
"^DD",727.829,727.829,10,23,0)
^^2^2^3041202^
"^DD",727.829,727.829,10,23,1,0)
If time cannot be determined, use 000001 as a default.  Field .01 of the 
"^DD",727.829,727.829,10,23,2,0)
TRANSFUSION RECORD sub-file (#63.017) of the LAB DATA file (#63).
"^DD",727.829,727.829,10,"DT")
3050209
"^DD",727.829,727.829,11,0)
COMPONENT^F^^0;12^K:$L(X)>15!($L(X)<1) X
"^DD",727.829,727.829,11,.1)
Component
"^DD",727.829,727.829,11,3)
Answer must be 1-15 characters in length
"^DD",727.829,727.829,11,21,0)
^^1^1^3041202^^^
"^DD",727.829,727.829,11,21,1,0)
This is the name of the blood bank product transfused.
"^DD",727.829,727.829,11,23,0)
^^3^3^3041202^^
"^DD",727.829,727.829,11,23,1,0)
Obtained from field .02 of the TRANSFUSION RECORD sub-file (#63.017) of
"^DD",727.829,727.829,11,23,2,0)
the LAB DATA file (#63) which is a pointer to the Blood Bank product file 
"^DD",727.829,727.829,11,23,3,0)
(#65).
"^DD",727.829,727.829,11,"DT")
3041202
"^DD",727.829,727.829,12,0)
COMPONENT ABBREVIATION^F^^0;13^K:$L(X)>4!($L(X)<1) X
"^DD",727.829,727.829,12,.1)
Component Abbreviation
"^DD",727.829,727.829,12,3)
Answer must be 1-4 characters in length.
"^DD",727.829,727.829,12,21,0)
^^2^2^3041202^
"^DD",727.829,727.829,12,21,1,0)
This is the abbreviation for the component, taken from the BLOOD PRODUCT
"^DD",727.829,727.829,12,21,2,0)
file (#66).
"^DD",727.829,727.829,12,23,0)
^^3^3^3041202^
"^DD",727.829,727.829,12,23,1,0)
Use COMPONENT (field .02 of the TRANSFUSION RECORD sub-file (#63.017) to 
"^DD",727.829,727.829,12,23,2,0)
obtain COMPONENT ABBREVIATION from field .02 of the BLOOD PRODUCT file 
"^DD",727.829,727.829,12,23,3,0)
(#66).
"^DD",727.829,727.829,12,"DT")
3041202
"^DD",727.829,727.829,13,0)
NUMBER OF UNITS^NJ2,0^^0;14^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1.N) X
"^DD",727.829,727.829,13,.1)
Number Of Units
"^DD",727.829,727.829,13,3)
Type a number between 1 and 99, 0 Decimal Digits
"^DD",727.829,727.829,13,21,0)
^^1^1^3041202^^
"^DD",727.829,727.829,13,21,1,0)
This is the number of units that were transfused.
"^DD",727.829,727.829,13,23,0)
^^2^2^3041202^
"^DD",727.829,727.829,13,23,1,0)
Field .07 of the TRANSFUSION RECORD sub-file (#63.017) of the LAB DATA 
"^DD",727.829,727.829,13,23,2,0)
file (#63).  If units is blank use default of 1.
"^DD",727.829,727.829,13,"DT")
3041202
"^DD",727.829,727.829,14,0)
VOLUME^NJ4,0^^0;15^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1.N) X
"^DD",727.829,727.829,14,.1)
Volume
"^DD",727.829,727.829,14,3)
Type a number between 0 and 9999, 0 Decimal Digits
"^DD",727.829,727.829,14,21,0)
^^1^1^3041202^
"^DD",727.829,727.829,14,21,1,0)
This is the volume, in milliliters, of the component or unit transfused.
"^DD",727.829,727.829,14,23,0)
^^2^2^3041202^
"^DD",727.829,727.829,14,23,1,0)
Field .1 of the TRANSFUSION RECORD sub-file (#63.017) of the LAB DATA 
"^DD",727.829,727.829,14,23,2,0)
file (#63).
"^DD",727.829,727.829,14,"DT")
3041202
"^DD",727.829,727.829,15,0)
REACTION^S^Y:YES;N:NO;^0;16^Q
"^DD",727.829,727.829,15,.1)
Feeder Location
"^DD",727.829,727.829,15,3)

"^DD",727.829,727.829,15,21,0)
^^1^1^3041202^
"^DD",727.829,727.829,15,21,1,0)
Indicates a transfusion reaction.
"^DD",727.829,727.829,15,23,0)
^^2^2^3041202^
"^DD",727.829,727.829,15,23,1,0)
Field .08 of the TRANSFUSION RECORD sub-file (#63.017) of the LAB DATA 
"^DD",727.829,727.829,15,23,2,0)
file (#63).
"^DD",727.829,727.829,15,"DT")
3041202
"^DD",727.829,727.829,16,0)
REACTION TYPE^S^G:GROUP AFFILIATION;D:DEFERRAL CODE;C:COLLECTION SITE;GC:GROUP AFFIL. & COLLECTION SITE;R:DONOR REACTION;T:TRANSFUSION REACTION;^0;17^Q
"^DD",727.829,727.829,16,3)
Answer must be 1 character in length.
"^DD",727.829,727.829,16,21,0)
^^1^1^3041202^
"^DD",727.829,727.829,16,21,1,0)
Type of reaction from transfusion
"^DD",727.829,727.829,16,23,0)
^^3^3^3041202^
"^DD",727.829,727.829,16,23,1,0)
Field .11 of the TRANSFUSION RECORD sub-file (#63.017) of the LAB DATA 
"^DD",727.829,727.829,16,23,2,0)
file (#63) which is a pointer to field .02 of the BLOOD BANK UTILITY file 
"^DD",727.829,727.829,16,23,3,0)
(#65.4).
"^DD",727.829,727.829,16,"DT")
3041202
"^DD",727.829,727.829,17,0)
FEEDER LOCATION^F^^0;18^K:$L(X)>9!($L(X)<1) X
"^DD",727.829,727.829,17,3)
Answer must be 1-9 characters in length
"^DD",727.829,727.829,17,21,0)
^^2^2^3041202^
"^DD",727.829,727.829,17,21,1,0)
Feeder locations are station-specific locations that are specific to each
"^DD",727.829,727.829,17,21,2,0)
extract.  
"^DD",727.829,727.829,17,23,0)
^^1^1^3041202^
"^DD",727.829,727.829,17,23,1,0)
Feeder Location in Blood Bank extract is BB concatenated with Facility.
"^DD",727.829,727.829,17,"DT")
3041202
"^DD",727.829,727.829,18,0)
DSS PRODUCT DEPARTMENT^F^^0;19^K:$L(X)>10!($L(X)<1) X
"^DD",727.829,727.829,18,3)
Answer must be 1-10 characters in length
"^DD",727.829,727.829,18,21,0)
^^3^3^3041202^
"^DD",727.829,727.829,18,21,1,0)
The nationally defined and designated intermediate product dept number 
"^DD",727.829,727.829,18,21,2,0)
designated to the patient care product being delivered for standardized 
"^DD",727.829,727.829,18,21,3,0)
workload reporting purposes.
"^DD",727.829,727.829,18,23,0)
^^1^1^3041202^
"^DD",727.829,727.829,18,23,1,0)
Obtained from the DSS PRODUCT DEPARTMENT AND IP NUMBER file (#727.6).  
"^DD",727.829,727.829,18,"DT")
3041202
"^DD",727.829,727.829,19,0)
DSS IP #^F^^0;20^K:$L(X)>7!($L(X)<1) X
"^DD",727.829,727.829,19,3)
Answer must be 1-7 characters in length
"^DD",727.829,727.829,19,21,0)
^^1^1^3041202^
"^DD",727.829,727.829,19,21,1,0)
same description recorded in field 18 of this file.
"^DD",727.829,727.829,19,"DT")
3041202
"^DD",728,728,69,0)
LAST DATE LBB^D^^7;27^S %DT="E" D ^%DT S X=Y K:X<1 X
"^DD",728,728,69,3)
(No range limit on date)
"^DD",728,728,69,21,0)
^^2^2^3050302^
"^DD",728,728,69,21,1,0)
This field contains the last date that blood bank data was extracted to
"^DD",728,728,69,21,2,0)
the DSS software.
"^DD",728,728,69,23,0)
^^2^2^3050302^
"^DD",728,728,69,23,1,0)
This date is set by the extract routine.  Must not be manipulated via the 
"^DD",728,728,69,23,2,0)
VA FileMan.
"^DD",728,728,69,"DT")
3050302
"^DD",728,728,70,0)
LBB STATUS^S^R:RUNNING;^7.1;27^Q
"^DD",728,728,70,3)
Populated by the software
"^DD",728,728,70,21,0)
^^1^1^3041124^
"^DD",728,728,70,21,1,0)
Used to inform the user that the extract is presently running.  
"^DD",728,728,70,"DT")
3041124
"^DIC",727.1,727.1,0)
EXTRACT DEFINITIONS^1
"^DIC",727.1,727.1,0,"GL")
^ECX(727.1,
"^DIC",727.1,727.1,"%D",0)
^^6^6^2990914^^^^
"^DIC",727.1,727.1,"%D",1,0)
This file provides a mechanism for sites to tailor the running of
"^DIC",727.1,727.1,"%D",2,0)
package extracts by defining the frequency (daily, weekly, or monthly)
"^DIC",727.1,727.1,"%D",3,0)
with which the extracts will run and the number of days in the past
"^DIC",727.1,727.1,"%D",4,0)
for which data will be extracted.  The EXTRACT NAME field (#.01) and
"^DIC",727.1,727.1,"%D",5,0)
the FILE NUMBER field (#1) are national standard entries, exported with
"^DIC",727.1,727.1,"%D",6,0)
the file, and should not be edited locally.
"^DIC",727.1,"B","EXTRACT DEFINITIONS",727.1)

"^DIC",727.829,727.829,0)
BLOOD BANK EXTRACT^727.829
"^DIC",727.829,727.829,0,"GL")
^ECX(727.829,
"^DIC",727.829,727.829,"%",0)
^1.005^^
"^DIC",727.829,727.829,"%D",0)
^^18^18^3041213^
"^DIC",727.829,727.829,"%D",1,0)
This file contains data elements as specified by the Decision Support 
"^DIC",727.829,727.829,"%D",2,0)
System (DSS) Program Office for the Blood Bank extract from existing VistA
"^DIC",727.829,727.829,"%D",3,0)
files.  Contains data extracted from the sub file #63.017, TRANSFUSION 
"^DIC",727.829,727.829,"%D",4,0)
RECORD file of the LAB DATA file (#63) and from the PATIENT file (#2).
"^DIC",727.829,727.829,"%D",5,0)
Once approved by the DSS site manager, entries in this file are loaded
"^DIC",727.829,727.829,"%D",6,0)
into an electronic mail message and sent to the commercial vendor. This
"^DIC",727.829,727.829,"%D",7,0)
file is intended to be used for validation purposes only. Entries should
"^DIC",727.829,727.829,"%D",8,0)
be made only by the extract load routine.
"^DIC",727.829,727.829,"%D",9,0)
  
"^DIC",727.829,727.829,"%D",10,0)
Since validation techniques will be determined by the local site, it is 
"^DIC",727.829,727.829,"%D",11,0)
intended that the site add whatever cross references deemed necessary.  
"^DIC",727.829,727.829,"%D",12,0)
However, this file contains one nationally determined cross reference, 
"^DIC",727.829,727.829,"%D",13,0)
the "AC" cross reference on the EXTRACT NUMBER field (#2).  This cross
"^DIC",727.829,727.829,"%D",14,0)
reference is used by the DSS Extracts software package as an essential
"^DIC",727.829,727.829,"%D",15,0)
feature for managing and purging data in this file and should not be
"^DIC",727.829,727.829,"%D",16,0)
modified.  
"^DIC",727.829,727.829,"%D",17,0)
  
"^DIC",727.829,727.829,"%D",18,0)
This file should NOT be modified directly using VA FileMan.
"^DIC",727.829,"B","BLOOD BANK EXTRACT",727.829)

**END**
**END**
