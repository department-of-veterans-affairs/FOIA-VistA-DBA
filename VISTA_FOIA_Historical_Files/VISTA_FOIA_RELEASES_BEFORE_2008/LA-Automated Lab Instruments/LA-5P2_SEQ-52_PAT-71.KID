Released LA*5.2*71 SEQ #52
Extracted from mail message
**KIDS**:LA*5.2*71^

**INSTALL NAME**
LA*5.2*71
"BLD",16577,0)
LA*5.2*71^AUTOMATED LAB INSTRUMENTS^0^3050511^y
"BLD",16577,1,0)
^9.61A^199^199^3050511^^^^
"BLD",16577,1,1,0)
Blood Bank Clearance
"BLD",16577,1,2,0)
====================
"BLD",16577,1,3,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LA*5.2*71 does not
"BLD",16577,1,4,0)
contain any changes to the VISTA BLOOD BANK Software as defined by VHA
"BLD",16577,1,5,0)
DIRECTIVE 2004-058 titled VISTA BLOOD BANK SOFTWARE VERSION 5.2.
"BLD",16577,1,6,0)

"BLD",16577,1,7,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LA*5.2*71 does not
"BLD",16577,1,8,0)
alter or modify any software design safeguards or safety critical elements
"BLD",16577,1,9,0)
functions.
"BLD",16577,1,10,0)

"BLD",16577,1,11,0)
RISK ANALYSIS: Changes made by patch LA*5.2*71 have no effect on Blood
"BLD",16577,1,12,0)
Bank software functionality, therefore RISK is none.
"BLD",16577,1,13,0)

"BLD",16577,1,14,0)
VALIDATION REQUIREMENTS BY OPTION: Because of the nature of the changes
"BLD",16577,1,15,0)
made, no specific validation requirements exist as a result of installation
"BLD",16577,1,16,0)
of this patch.
"BLD",16577,1,17,0)
 
"BLD",16577,1,18,0)
 
"BLD",16577,1,19,0)
NOIS NCH-0105-417985 reported the inability to verify corrected 
"BLD",16577,1,20,0)
Laboratory Electronic Data Interchange (LEDI) results when the reference
"BLD",16577,1,21,0)
(host) laboratory removes the previously reported result and changes the
"BLD",16577,1,22,0)
result to 'pending'. The result of 'pending' was not being sent to the
"BLD",16577,1,23,0)
collecting facility via LEDI HL7 messaging.
"BLD",16577,1,24,0)
 
"BLD",16577,1,25,0)
This patch allows users at the collecting facility who are verifying
"BLD",16577,1,26,0)
reference laboratory results to release amended (corrected) results
"BLD",16577,1,27,0)
that are 'pending'.
"BLD",16577,1,28,0)
 
"BLD",16577,1,29,0)
 
"BLD",16577,1,30,0)
 
"BLD",16577,1,31,0)
 ASSOCIATED E3R
"BLD",16577,1,32,0)
 --------------
"BLD",16577,1,33,0)
 None
"BLD",16577,1,34,0)
 
"BLD",16577,1,35,0)
 ASSOCIATED NOIS
"BLD",16577,1,36,0)
 ---------------
"BLD",16577,1,37,0)
 NCH-0105-417985/Remedy ticket HD0000000071220
"BLD",16577,1,38,0)
 
"BLD",16577,1,39,0)
 
"BLD",16577,1,40,0)
 TEST SITES
"BLD",16577,1,41,0)
 ----------
"BLD",16577,1,42,0)
 Boston HCS
"BLD",16577,1,43,0)
 Durham VAMC
"BLD",16577,1,44,0)
 Hines VAMC
"BLD",16577,1,45,0)
 Milwaukee VAMC
"BLD",16577,1,46,0)
 North Chicago VAMC
"BLD",16577,1,47,0)
  
"BLD",16577,1,48,0)
 
"BLD",16577,1,49,0)
ROUTINE SUMMARY
"BLD",16577,1,50,0)
===============
"BLD",16577,1,51,0)
  The following routines are included in this patch.  The second line
"BLD",16577,1,52,0)
  of each of these routines now looks like:
"BLD",16577,1,53,0)
  <tab> ;;5.2;AUTOMATED LAB INSTRUMENTS;<patchlist>;Sep 27, 1994
"BLD",16577,1,54,0)
 
"BLD",16577,1,55,0)
                    Checksum       Checksum
"BLD",16577,1,56,0)
   Routine Name     Before Patch   After Patch    Patch List
"BLD",16577,1,57,0)
   ------------     ------------   -----------    ------------
"BLD",16577,1,58,0)
   LA71             N/A            4588676        **71** (Deleted by KIDS)
"BLD",16577,1,59,0)
   LA7VOBX1         4535705        4442510        **46,61,63,64,71**
"BLD",16577,1,60,0)
   LA7VORU          8366274        8469558        **27,46,61,64,71**
"BLD",16577,1,61,0)
  
"BLD",16577,1,62,0)
 List of preceding patches: 64
"BLD",16577,1,63,0)
 Sites should use CHECK^XTSUMBLD to verify checksums.
"BLD",16577,1,64,0)
  
"BLD",16577,1,65,0)
 
"BLD",16577,1,66,0)
INSTALLATION INSTRUCTIONS
"BLD",16577,1,67,0)
-------------------------
"BLD",16577,1,68,0)
  The install time for this patch is less than 5 minute. This patch
"BLD",16577,1,69,0)
  can be installed when Laboratory users are on the system.
"BLD",16577,1,70,0)
  Suggested time to install: non-peak requirement hours.
"BLD",16577,1,71,0)
 
"BLD",16577,1,72,0)
 
"BLD",16577,1,73,0)
NOTE: Kernel patches must be current on the target system to avoid
"BLD",16577,1,74,0)
      problems loading and/or installing this patch.
"BLD",16577,1,75,0)
 
"BLD",16577,1,76,0)
      Patch installation needs to be coordinated with the Laboratory
"BLD",16577,1,77,0)
      Information Manager (LIM/ADPAC).
"BLD",16577,1,78,0)
 
"BLD",16577,1,79,0)
 
"BLD",16577,1,80,0)
  1.  If any of the above routines are mapped, disable mapping for them.
"BLD",16577,1,81,0)
 
"BLD",16577,1,82,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"BLD",16577,1,83,0)
        option will load the KIDS package onto your system.
"BLD",16577,1,84,0)
 
"BLD",16577,1,85,0)
  3.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"BLD",16577,1,86,0)
      select the 'Installation' menu.
"BLD",16577,1,87,0)
 
"BLD",16577,1,88,0)
  4.  From this menu, you may then elect to use the following options
"BLD",16577,1,89,0)
      (when prompted for the INSTALL NAME, enter LA*5.2*71):
"BLD",16577,1,90,0)
        a. Print Transport Global
"BLD",16577,1,91,0)
        b. Backup a Transport Global
"BLD",16577,1,92,0)
        c. Compare Transport Global to Current System
"BLD",16577,1,93,0)
        d. Verify Checksums in Transport Global
"BLD",16577,1,94,0)
 
"BLD",16577,1,95,0)
      Use the 'Verify Checksum in Transport Global' option and verify that
"BLD",16577,1,96,0)
      all routines have the correct checksums.
"BLD",16577,1,97,0)
 
"BLD",16577,1,98,0)
  5.  Use the 'Install Package(s)' option under the 'Installation' menu
"BLD",16577,1,99,0)
      and select the package 'LA*5.2*71'.  When prompted 'Want KIDS to
"BLD",16577,1,100,0)
      INHIBIT LOGONs during the install? YES// choose 'NO'.  When prompted
"BLD",16577,1,101,0)
      'Want to DISABLE Scheduled Options, Menu Options, and Protocols?
"BLD",16577,1,102,0)
      YES//', choose 'NO'.
"BLD",16577,1,103,0)
 
"BLD",16577,1,104,0)
      The install will automatically disable the following options:
"BLD",16577,1,105,0)
 
"BLD",16577,1,106,0)
       Accession order then immediately enter data LR ACC THEN DATA
"BLD",16577,1,107,0)
       Batch data entry (chem, hem, tox, etc.) [LRSTUF]
"BLD",16577,1,108,0)
       Bypass normal data entry [LRFAST]
"BLD",16577,1,109,0)
       Enter/verify data (Load list) [LRVRW2]
"BLD",16577,1,110,0)
       Enter/verify data (Work list) [LRVRW]
"BLD",16577,1,111,0)
       Enter/verify data (auto instrument) [LRVR]
"BLD",16577,1,112,0)
       Enter/verify/modify data (manual) [LRENTER]
"BLD",16577,1,113,0)
       Fast Bypass Data Entry/Verify [LRFASTS]
"BLD",16577,1,114,0)
       Group verify (EA, EL, EW)[ LRGV]
"BLD",16577,1,115,0)
       Special test accessioning [LRNONCOM]
"BLD",16577,1,116,0)
 
"BLD",16577,1,117,0)
  6.  On a mapped system, rebuild your map set.
"BLD",16577,1,118,0)
 
"BLD",16577,1,119,0)
 Note: Routine LA71 will be deleted after successful patch installation.
"BLD",16577,1,120,0)
 
"BLD",16577,1,121,0)
 
"BLD",16577,1,122,0)
INSTALLATION EXAMPLE
"BLD",16577,1,123,0)
====================
"BLD",16577,1,124,0)
 
"BLD",16577,1,125,0)
Select Installation Option:
"BLD",16577,1,126,0)
 
"BLD",16577,1,127,0)
Select Kernel Installation & Distribution System Option:  Installation
"BLD",16577,1,128,0)
 
"BLD",16577,1,129,0)
Select Installation Option:  Install Package(s)
"BLD",16577,1,130,0)
Select INSTALL NAME: LA*5.2*71  Loaded from Distribution 1/31/05@14:21:40
"BLD",16577,1,131,0)
     => LA*5.2*71
"BLD",16577,1,132,0)
 
"BLD",16577,1,133,0)
This Distribution was loaded on Jan 31, 2005@14:21:40 with header of
"BLD",16577,1,134,0)
   LA*5.2*71
"BLD",16577,1,135,0)
   It consisted of the following Install(s):
"BLD",16577,1,136,0)
      LA*5.2*71
"BLD",16577,1,137,0)
Checking Install for Package LA*5.2*71
"BLD",16577,1,138,0)
Will first run the Environment Check Routine, LA71
"BLD",16577,1,139,0)
 
"BLD",16577,1,140,0)
 
"BLD",16577,1,141,0)
                        --- Environment Check is Ok ---
"BLD",16577,1,142,0)
 
"BLD",16577,1,143,0)
Install Questions for LA*5.2*71
"BLD",16577,1,144,0)
 
"BLD",16577,1,145,0)
 
"BLD",16577,1,146,0)
Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// NO
"BLD",16577,1,147,0)
 
"BLD",16577,1,148,0)
 
"BLD",16577,1,149,0)
Want KIDS to INHIBIT LOGONs during the install? YES// NO
"BLD",16577,1,150,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"BLD",16577,1,151,0)
 
"BLD",16577,1,152,0)
Enter the Device you want to print the Install messages.
"BLD",16577,1,153,0)
You can queue the install by enter a 'Q' at the device prompt.
"BLD",16577,1,154,0)
Enter a '^' to abort the install.
"BLD",16577,1,155,0)
 
"BLD",16577,1,156,0)
DEVICE: HOME// TELNET VIRTUAL
"BLD",16577,1,157,0)
 
"BLD",16577,1,158,0)
 
"BLD",16577,1,159,0)
 Install Started for LA*5.2*71 :
"BLD",16577,1,160,0)
               Jan 31, 2005@14:22:11
"BLD",16577,1,161,0)
 
"BLD",16577,1,162,0)
Build Distribution Date: Jan 31, 2005
"BLD",16577,1,163,0)
 
"BLD",16577,1,164,0)
 Installing Routines:...
"BLD",16577,1,165,0)
               Jan 31, 2005@14:22:11
"BLD",16577,1,166,0)
 
"BLD",16577,1,167,0)
 Running Pre-Install Routine: PRE^LA71.
"BLD",16577,1,168,0)
 
"BLD",16577,1,169,0)
               Sending install started alert to mail group G.LMI
"BLD",16577,1,170,0)
 
"BLD",16577,1,171,0)
                          *** Pre install started ***
"BLD",16577,1,172,0)
 
"BLD",16577,1,173,0)
                           --- No action required---
"BLD",16577,1,174,0)
 
"BLD",16577,1,175,0)
                         *** Pre install completed ***
"BLD",16577,1,176,0)
 
"BLD",16577,1,177,0)
 Installing PACKAGE COMPONENTS:
"BLD",16577,1,178,0)
 
"BLD",16577,1,179,0)
 Installing OPTION...........
"BLD",16577,1,180,0)
               Jan 31, 2005@14:22:11
"BLD",16577,1,181,0)
 
"BLD",16577,1,182,0)
 Running Post-Install Routine: POST^LA71.
"BLD",16577,1,183,0)
 
"BLD",16577,1,184,0)
                          *** Post install started ***
"BLD",16577,1,185,0)
 
"BLD",16577,1,186,0)
                  --- No actions required for post install ---
"BLD",16577,1,187,0)
 
"BLD",16577,1,188,0)
                         *** Post install completed ***
"BLD",16577,1,189,0)
 
"BLD",16577,1,190,0)
              Sending install completion alert to mail group G.LMI
"BLD",16577,1,191,0)
 
"BLD",16577,1,192,0)
 Updating Routine file......
"BLD",16577,1,193,0)
 
"BLD",16577,1,194,0)
 Updating KIDS files.......
"BLD",16577,1,195,0)
 
"BLD",16577,1,196,0)
 LA*5.2*71 Installed.
"BLD",16577,1,197,0)
               Jan 31, 2005@14:22:11
"BLD",16577,1,198,0)
 
"BLD",16577,1,199,0)
 Install Message sent #xxxx
"BLD",16577,4,0)
^9.64PA^^
"BLD",16577,"ABPKG")
n
"BLD",16577,"INI")
PRE^LA71
"BLD",16577,"INID")
y
"BLD",16577,"INIT")
POST^LA71
"BLD",16577,"KRN",0)
^9.67PA^8989.52^19
"BLD",16577,"KRN",.4,0)
.4
"BLD",16577,"KRN",.401,0)
.401
"BLD",16577,"KRN",.402,0)
.402
"BLD",16577,"KRN",.403,0)
.403
"BLD",16577,"KRN",.5,0)
.5
"BLD",16577,"KRN",.84,0)
.84
"BLD",16577,"KRN",3.6,0)
3.6
"BLD",16577,"KRN",3.8,0)
3.8
"BLD",16577,"KRN",9.2,0)
9.2
"BLD",16577,"KRN",9.8,0)
9.8
"BLD",16577,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",16577,"KRN",9.8,"NM",1,0)
LA7VOBX1^^0^B15262892
"BLD",16577,"KRN",9.8,"NM",2,0)
LA7VORU^^0^B58855542
"BLD",16577,"KRN",9.8,"NM","B","LA7VOBX1",1)

"BLD",16577,"KRN",9.8,"NM","B","LA7VORU",2)

"BLD",16577,"KRN",19,0)
19
"BLD",16577,"KRN",19,"NM",0)
^9.68A^11^10
"BLD",16577,"KRN",19,"NM",1,0)
LRVR^^5^
"BLD",16577,"KRN",19,"NM",2,0)
LRVRW^^5^
"BLD",16577,"KRN",19,"NM",3,0)
LRVRW2^^5^
"BLD",16577,"KRN",19,"NM",4,0)
LRENTER^^5^
"BLD",16577,"KRN",19,"NM",5,0)
LR ACC THEN DATA^^5^
"BLD",16577,"KRN",19,"NM",6,0)
LRFAST^^5^
"BLD",16577,"KRN",19,"NM",7,0)
LRFASTS^^5^
"BLD",16577,"KRN",19,"NM",8,0)
LRGV^^5^
"BLD",16577,"KRN",19,"NM",10,0)
LRSTUF^^5^
"BLD",16577,"KRN",19,"NM",11,0)
LRNONCOM^^5^
"BLD",16577,"KRN",19,"NM","B","LR ACC THEN DATA",5)

"BLD",16577,"KRN",19,"NM","B","LRENTER",4)

"BLD",16577,"KRN",19,"NM","B","LRFAST",6)

"BLD",16577,"KRN",19,"NM","B","LRFASTS",7)

"BLD",16577,"KRN",19,"NM","B","LRGV",8)

"BLD",16577,"KRN",19,"NM","B","LRNONCOM",11)

"BLD",16577,"KRN",19,"NM","B","LRSTUF",10)

"BLD",16577,"KRN",19,"NM","B","LRVR",1)

"BLD",16577,"KRN",19,"NM","B","LRVRW",2)

"BLD",16577,"KRN",19,"NM","B","LRVRW2",3)

"BLD",16577,"KRN",19.1,0)
19.1
"BLD",16577,"KRN",101,0)
101
"BLD",16577,"KRN",409.61,0)
409.61
"BLD",16577,"KRN",771,0)
771
"BLD",16577,"KRN",870,0)
870
"BLD",16577,"KRN",8989.51,0)
8989.51
"BLD",16577,"KRN",8989.52,0)
8989.52
"BLD",16577,"KRN",8994,0)
8994
"BLD",16577,"KRN","B",.4,.4)

"BLD",16577,"KRN","B",.401,.401)

"BLD",16577,"KRN","B",.402,.402)

"BLD",16577,"KRN","B",.403,.403)

"BLD",16577,"KRN","B",.5,.5)

"BLD",16577,"KRN","B",.84,.84)

"BLD",16577,"KRN","B",3.6,3.6)

"BLD",16577,"KRN","B",3.8,3.8)

"BLD",16577,"KRN","B",9.2,9.2)

"BLD",16577,"KRN","B",9.8,9.8)

"BLD",16577,"KRN","B",19,19)

"BLD",16577,"KRN","B",19.1,19.1)

"BLD",16577,"KRN","B",101,101)

"BLD",16577,"KRN","B",409.61,409.61)

"BLD",16577,"KRN","B",771,771)

"BLD",16577,"KRN","B",870,870)

"BLD",16577,"KRN","B",8989.51,8989.51)

"BLD",16577,"KRN","B",8989.52,8989.52)

"BLD",16577,"KRN","B",8994,8994)

"BLD",16577,"PRE")
LA71
"BLD",16577,"QUES",0)
^9.62^^
"BLD",16577,"REQB",0)
^9.611^1^1
"BLD",16577,"REQB",1,0)
LA*5.2*64^2
"BLD",16577,"REQB","B","LA*5.2*64",1)

"INI")
PRE^LA71
"INIT")
POST^LA71
"KRN",19,600,-1)
5^4
"KRN",19,600,0)
LRENTER
"KRN",19,611,-1)
5^6
"KRN",19,611,0)
LRFAST
"KRN",19,651,-1)
5^11
"KRN",19,651,0)
LRNONCOM
"KRN",19,661,-1)
5^8
"KRN",19,661,0)
LRGV
"KRN",19,664,-1)
5^1
"KRN",19,664,0)
LRVR
"KRN",19,684,-1)
5^10
"KRN",19,684,0)
LRSTUF
"KRN",19,727,-1)
5^2
"KRN",19,727,0)
LRVRW
"KRN",19,728,-1)
5^3
"KRN",19,728,0)
LRVRW2
"KRN",19,1041,-1)
5^5
"KRN",19,1041,0)
LR ACC THEN DATA
"KRN",19,8003,-1)
5^7
"KRN",19,8003,0)
LRFASTS
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",53,-1)
1^1
"PKG",53,0)
AUTOMATED LAB INSTRUMENTS^LA^Lab Auto-Instrument Package
"PKG",53,20,0)
^9.402P^^
"PKG",53,22,0)
^9.49I^1^1
"PKG",53,22,1,0)
5.2^2940927^2950125
"PKG",53,22,1,"PAH",1,0)
71^3050511
"PKG",53,22,1,"PAH",1,1,0)
^^199^199^3050511
"PKG",53,22,1,"PAH",1,1,1,0)
Blood Bank Clearance
"PKG",53,22,1,"PAH",1,1,2,0)
====================
"PKG",53,22,1,"PAH",1,1,3,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LA*5.2*71 does not
"PKG",53,22,1,"PAH",1,1,4,0)
contain any changes to the VISTA BLOOD BANK Software as defined by VHA
"PKG",53,22,1,"PAH",1,1,5,0)
DIRECTIVE 2004-058 titled VISTA BLOOD BANK SOFTWARE VERSION 5.2.
"PKG",53,22,1,"PAH",1,1,6,0)

"PKG",53,22,1,"PAH",1,1,7,0)
EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LA*5.2*71 does not
"PKG",53,22,1,"PAH",1,1,8,0)
alter or modify any software design safeguards or safety critical elements
"PKG",53,22,1,"PAH",1,1,9,0)
functions.
"PKG",53,22,1,"PAH",1,1,10,0)

"PKG",53,22,1,"PAH",1,1,11,0)
RISK ANALYSIS: Changes made by patch LA*5.2*71 have no effect on Blood
"PKG",53,22,1,"PAH",1,1,12,0)
Bank software functionality, therefore RISK is none.
"PKG",53,22,1,"PAH",1,1,13,0)

"PKG",53,22,1,"PAH",1,1,14,0)
VALIDATION REQUIREMENTS BY OPTION: Because of the nature of the changes
"PKG",53,22,1,"PAH",1,1,15,0)
made, no specific validation requirements exist as a result of installation
"PKG",53,22,1,"PAH",1,1,16,0)
of this patch.
"PKG",53,22,1,"PAH",1,1,17,0)
 
"PKG",53,22,1,"PAH",1,1,18,0)
 
"PKG",53,22,1,"PAH",1,1,19,0)
NOIS NCH-0105-417985 reported the inability to verify corrected 
"PKG",53,22,1,"PAH",1,1,20,0)
Laboratory Electronic Data Interchange (LEDI) results when the reference
"PKG",53,22,1,"PAH",1,1,21,0)
(host) laboratory removes the previously reported result and changes the
"PKG",53,22,1,"PAH",1,1,22,0)
result to 'pending'. The result of 'pending' was not being sent to the
"PKG",53,22,1,"PAH",1,1,23,0)
collecting facility via LEDI HL7 messaging.
"PKG",53,22,1,"PAH",1,1,24,0)
 
"PKG",53,22,1,"PAH",1,1,25,0)
This patch allows users at the collecting facility who are verifying
"PKG",53,22,1,"PAH",1,1,26,0)
reference laboratory results to release amended (corrected) results
"PKG",53,22,1,"PAH",1,1,27,0)
that are 'pending'.
"PKG",53,22,1,"PAH",1,1,28,0)
 
"PKG",53,22,1,"PAH",1,1,29,0)
 
"PKG",53,22,1,"PAH",1,1,30,0)
 
"PKG",53,22,1,"PAH",1,1,31,0)
 ASSOCIATED E3R
"PKG",53,22,1,"PAH",1,1,32,0)
 --------------
"PKG",53,22,1,"PAH",1,1,33,0)
 None
"PKG",53,22,1,"PAH",1,1,34,0)
 
"PKG",53,22,1,"PAH",1,1,35,0)
 ASSOCIATED NOIS
"PKG",53,22,1,"PAH",1,1,36,0)
 ---------------
"PKG",53,22,1,"PAH",1,1,37,0)
 NCH-0105-417985/Remedy ticket HD0000000071220
"PKG",53,22,1,"PAH",1,1,38,0)
 
"PKG",53,22,1,"PAH",1,1,39,0)
 
"PKG",53,22,1,"PAH",1,1,40,0)
 TEST SITES
"PKG",53,22,1,"PAH",1,1,41,0)
 ----------
"PKG",53,22,1,"PAH",1,1,42,0)
 Boston HCS
"PKG",53,22,1,"PAH",1,1,43,0)
 Durham VAMC
"PKG",53,22,1,"PAH",1,1,44,0)
 Hines VAMC
"PKG",53,22,1,"PAH",1,1,45,0)
 Milwaukee VAMC
"PKG",53,22,1,"PAH",1,1,46,0)
 North Chicago VAMC
"PKG",53,22,1,"PAH",1,1,47,0)
  
"PKG",53,22,1,"PAH",1,1,48,0)
 
"PKG",53,22,1,"PAH",1,1,49,0)
ROUTINE SUMMARY
"PKG",53,22,1,"PAH",1,1,50,0)
===============
"PKG",53,22,1,"PAH",1,1,51,0)
  The following routines are included in this patch.  The second line
"PKG",53,22,1,"PAH",1,1,52,0)
  of each of these routines now looks like:
"PKG",53,22,1,"PAH",1,1,53,0)
  <tab> ;;5.2;AUTOMATED LAB INSTRUMENTS;<patchlist>;Sep 27, 1994
"PKG",53,22,1,"PAH",1,1,54,0)
 
"PKG",53,22,1,"PAH",1,1,55,0)
                    Checksum       Checksum
"PKG",53,22,1,"PAH",1,1,56,0)
   Routine Name     Before Patch   After Patch    Patch List
"PKG",53,22,1,"PAH",1,1,57,0)
   ------------     ------------   -----------    ------------
"PKG",53,22,1,"PAH",1,1,58,0)
   LA71             N/A            4588676        **71** (Deleted by KIDS)
"PKG",53,22,1,"PAH",1,1,59,0)
   LA7VOBX1         4535705        4442510        **46,61,63,64,71**
"PKG",53,22,1,"PAH",1,1,60,0)
   LA7VORU          8366274        8469558        **27,46,61,64,71**
"PKG",53,22,1,"PAH",1,1,61,0)
  
"PKG",53,22,1,"PAH",1,1,62,0)
 List of preceding patches: 64
"PKG",53,22,1,"PAH",1,1,63,0)
 Sites should use CHECK^XTSUMBLD to verify checksums.
"PKG",53,22,1,"PAH",1,1,64,0)
  
"PKG",53,22,1,"PAH",1,1,65,0)
 
"PKG",53,22,1,"PAH",1,1,66,0)
INSTALLATION INSTRUCTIONS
"PKG",53,22,1,"PAH",1,1,67,0)
-------------------------
"PKG",53,22,1,"PAH",1,1,68,0)
  The install time for this patch is less than 5 minute. This patch
"PKG",53,22,1,"PAH",1,1,69,0)
  can be installed when Laboratory users are on the system.
"PKG",53,22,1,"PAH",1,1,70,0)
  Suggested time to install: non-peak requirement hours.
"PKG",53,22,1,"PAH",1,1,71,0)
 
"PKG",53,22,1,"PAH",1,1,72,0)
 
"PKG",53,22,1,"PAH",1,1,73,0)
NOTE: Kernel patches must be current on the target system to avoid
"PKG",53,22,1,"PAH",1,1,74,0)
      problems loading and/or installing this patch.
"PKG",53,22,1,"PAH",1,1,75,0)
 
"PKG",53,22,1,"PAH",1,1,76,0)
      Patch installation needs to be coordinated with the Laboratory
"PKG",53,22,1,"PAH",1,1,77,0)
      Information Manager (LIM/ADPAC).
"PKG",53,22,1,"PAH",1,1,78,0)
 
"PKG",53,22,1,"PAH",1,1,79,0)
 
"PKG",53,22,1,"PAH",1,1,80,0)
  1.  If any of the above routines are mapped, disable mapping for them.
"PKG",53,22,1,"PAH",1,1,81,0)
 
"PKG",53,22,1,"PAH",1,1,82,0)
  2.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu. This
"PKG",53,22,1,"PAH",1,1,83,0)
        option will load the KIDS package onto your system.
"PKG",53,22,1,"PAH",1,1,84,0)
 
"PKG",53,22,1,"PAH",1,1,85,0)
  3.  On the 'Kernel Installation & Distribution System' Menu (KIDS),
"PKG",53,22,1,"PAH",1,1,86,0)
      select the 'Installation' menu.
"PKG",53,22,1,"PAH",1,1,87,0)
 
"PKG",53,22,1,"PAH",1,1,88,0)
  4.  From this menu, you may then elect to use the following options
"PKG",53,22,1,"PAH",1,1,89,0)
      (when prompted for the INSTALL NAME, enter LA*5.2*71):
"PKG",53,22,1,"PAH",1,1,90,0)
        a. Print Transport Global
"PKG",53,22,1,"PAH",1,1,91,0)
        b. Backup a Transport Global
"PKG",53,22,1,"PAH",1,1,92,0)
        c. Compare Transport Global to Current System
"PKG",53,22,1,"PAH",1,1,93,0)
        d. Verify Checksums in Transport Global
"PKG",53,22,1,"PAH",1,1,94,0)
 
"PKG",53,22,1,"PAH",1,1,95,0)
      Use the 'Verify Checksum in Transport Global' option and verify that
"PKG",53,22,1,"PAH",1,1,96,0)
      all routines have the correct checksums.
"PKG",53,22,1,"PAH",1,1,97,0)
 
"PKG",53,22,1,"PAH",1,1,98,0)
  5.  Use the 'Install Package(s)' option under the 'Installation' menu
"PKG",53,22,1,"PAH",1,1,99,0)
      and select the package 'LA*5.2*71'.  When prompted 'Want KIDS to
"PKG",53,22,1,"PAH",1,1,100,0)
      INHIBIT LOGONs during the install? YES// choose 'NO'.  When prompted
"PKG",53,22,1,"PAH",1,1,101,0)
      'Want to DISABLE Scheduled Options, Menu Options, and Protocols?
"PKG",53,22,1,"PAH",1,1,102,0)
      YES//', choose 'NO'.
"PKG",53,22,1,"PAH",1,1,103,0)
 
"PKG",53,22,1,"PAH",1,1,104,0)
      The install will automatically disable the following options:
"PKG",53,22,1,"PAH",1,1,105,0)
 
"PKG",53,22,1,"PAH",1,1,106,0)
       Accession order then immediately enter data LR ACC THEN DATA
"PKG",53,22,1,"PAH",1,1,107,0)
       Batch data entry (chem, hem, tox, etc.) [LRSTUF]
"PKG",53,22,1,"PAH",1,1,108,0)
       Bypass normal data entry [LRFAST]
"PKG",53,22,1,"PAH",1,1,109,0)
       Enter/verify data (Load list) [LRVRW2]
"PKG",53,22,1,"PAH",1,1,110,0)
       Enter/verify data (Work list) [LRVRW]
"PKG",53,22,1,"PAH",1,1,111,0)
       Enter/verify data (auto instrument) [LRVR]
"PKG",53,22,1,"PAH",1,1,112,0)
       Enter/verify/modify data (manual) [LRENTER]
"PKG",53,22,1,"PAH",1,1,113,0)
       Fast Bypass Data Entry/Verify [LRFASTS]
"PKG",53,22,1,"PAH",1,1,114,0)
       Group verify (EA, EL, EW)[ LRGV]
"PKG",53,22,1,"PAH",1,1,115,0)
       Special test accessioning [LRNONCOM]
"PKG",53,22,1,"PAH",1,1,116,0)
 
"PKG",53,22,1,"PAH",1,1,117,0)
  6.  On a mapped system, rebuild your map set.
"PKG",53,22,1,"PAH",1,1,118,0)
 
"PKG",53,22,1,"PAH",1,1,119,0)
 Note: Routine LA71 will be deleted after successful patch installation.
"PKG",53,22,1,"PAH",1,1,120,0)
 
"PKG",53,22,1,"PAH",1,1,121,0)
 
"PKG",53,22,1,"PAH",1,1,122,0)
INSTALLATION EXAMPLE
"PKG",53,22,1,"PAH",1,1,123,0)
====================
"PKG",53,22,1,"PAH",1,1,124,0)
 
"PKG",53,22,1,"PAH",1,1,125,0)
Select Installation Option:
"PKG",53,22,1,"PAH",1,1,126,0)
 
"PKG",53,22,1,"PAH",1,1,127,0)
Select Kernel Installation & Distribution System Option:  Installation
"PKG",53,22,1,"PAH",1,1,128,0)
 
"PKG",53,22,1,"PAH",1,1,129,0)
Select Installation Option:  Install Package(s)
"PKG",53,22,1,"PAH",1,1,130,0)
Select INSTALL NAME: LA*5.2*71  Loaded from Distribution 1/31/05@14:21:40
"PKG",53,22,1,"PAH",1,1,131,0)
     => LA*5.2*71
"PKG",53,22,1,"PAH",1,1,132,0)
 
"PKG",53,22,1,"PAH",1,1,133,0)
This Distribution was loaded on Jan 31, 2005@14:21:40 with header of
"PKG",53,22,1,"PAH",1,1,134,0)
   LA*5.2*71
"PKG",53,22,1,"PAH",1,1,135,0)
   It consisted of the following Install(s):
"PKG",53,22,1,"PAH",1,1,136,0)
      LA*5.2*71
"PKG",53,22,1,"PAH",1,1,137,0)
Checking Install for Package LA*5.2*71
"PKG",53,22,1,"PAH",1,1,138,0)
Will first run the Environment Check Routine, LA71
"PKG",53,22,1,"PAH",1,1,139,0)
 
"PKG",53,22,1,"PAH",1,1,140,0)
 
"PKG",53,22,1,"PAH",1,1,141,0)
                        --- Environment Check is Ok ---
"PKG",53,22,1,"PAH",1,1,142,0)
 
"PKG",53,22,1,"PAH",1,1,143,0)
Install Questions for LA*5.2*71
"PKG",53,22,1,"PAH",1,1,144,0)
 
"PKG",53,22,1,"PAH",1,1,145,0)
 
"PKG",53,22,1,"PAH",1,1,146,0)
Want KIDS to Rebuild Menu Trees Upon Completion of Install? YES// NO
"PKG",53,22,1,"PAH",1,1,147,0)
 
"PKG",53,22,1,"PAH",1,1,148,0)
 
"PKG",53,22,1,"PAH",1,1,149,0)
Want KIDS to INHIBIT LOGONs during the install? YES// NO
"PKG",53,22,1,"PAH",1,1,150,0)
Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
"PKG",53,22,1,"PAH",1,1,151,0)
 
"PKG",53,22,1,"PAH",1,1,152,0)
Enter the Device you want to print the Install messages.
"PKG",53,22,1,"PAH",1,1,153,0)
You can queue the install by enter a 'Q' at the device prompt.
"PKG",53,22,1,"PAH",1,1,154,0)
Enter a '^' to abort the install.
"PKG",53,22,1,"PAH",1,1,155,0)
 
"PKG",53,22,1,"PAH",1,1,156,0)
DEVICE: HOME// TELNET VIRTUAL
"PKG",53,22,1,"PAH",1,1,157,0)
 
"PKG",53,22,1,"PAH",1,1,158,0)
 
"PKG",53,22,1,"PAH",1,1,159,0)
 Install Started for LA*5.2*71 :
"PKG",53,22,1,"PAH",1,1,160,0)
               Jan 31, 2005@14:22:11
"PKG",53,22,1,"PAH",1,1,161,0)
 
"PKG",53,22,1,"PAH",1,1,162,0)
Build Distribution Date: Jan 31, 2005
"PKG",53,22,1,"PAH",1,1,163,0)
 
"PKG",53,22,1,"PAH",1,1,164,0)
 Installing Routines:...
"PKG",53,22,1,"PAH",1,1,165,0)
               Jan 31, 2005@14:22:11
"PKG",53,22,1,"PAH",1,1,166,0)
 
"PKG",53,22,1,"PAH",1,1,167,0)
 Running Pre-Install Routine: PRE^LA71.
"PKG",53,22,1,"PAH",1,1,168,0)
 
"PKG",53,22,1,"PAH",1,1,169,0)
               Sending install started alert to mail group G.LMI
"PKG",53,22,1,"PAH",1,1,170,0)
 
"PKG",53,22,1,"PAH",1,1,171,0)
                          *** Pre install started ***
"PKG",53,22,1,"PAH",1,1,172,0)
 
"PKG",53,22,1,"PAH",1,1,173,0)
                           --- No action required---
"PKG",53,22,1,"PAH",1,1,174,0)
 
"PKG",53,22,1,"PAH",1,1,175,0)
                         *** Pre install completed ***
"PKG",53,22,1,"PAH",1,1,176,0)
 
"PKG",53,22,1,"PAH",1,1,177,0)
 Installing PACKAGE COMPONENTS:
"PKG",53,22,1,"PAH",1,1,178,0)
 
"PKG",53,22,1,"PAH",1,1,179,0)
 Installing OPTION...........
"PKG",53,22,1,"PAH",1,1,180,0)
               Jan 31, 2005@14:22:11
"PKG",53,22,1,"PAH",1,1,181,0)
 
"PKG",53,22,1,"PAH",1,1,182,0)
 Running Post-Install Routine: POST^LA71.
"PKG",53,22,1,"PAH",1,1,183,0)
 
"PKG",53,22,1,"PAH",1,1,184,0)
                          *** Post install started ***
"PKG",53,22,1,"PAH",1,1,185,0)
 
"PKG",53,22,1,"PAH",1,1,186,0)
                  --- No actions required for post install ---
"PKG",53,22,1,"PAH",1,1,187,0)
 
"PKG",53,22,1,"PAH",1,1,188,0)
                         *** Post install completed ***
"PKG",53,22,1,"PAH",1,1,189,0)
 
"PKG",53,22,1,"PAH",1,1,190,0)
              Sending install completion alert to mail group G.LMI
"PKG",53,22,1,"PAH",1,1,191,0)
 
"PKG",53,22,1,"PAH",1,1,192,0)
 Updating Routine file......
"PKG",53,22,1,"PAH",1,1,193,0)
 
"PKG",53,22,1,"PAH",1,1,194,0)
 Updating KIDS files.......
"PKG",53,22,1,"PAH",1,1,195,0)
 
"PKG",53,22,1,"PAH",1,1,196,0)
 LA*5.2*71 Installed.
"PKG",53,22,1,"PAH",1,1,197,0)
               Jan 31, 2005@14:22:11
"PKG",53,22,1,"PAH",1,1,198,0)
 
"PKG",53,22,1,"PAH",1,1,199,0)
 Install Message sent #xxxx
"PRE")
LA71
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","LA71")
0^^B9084232
"RTN","LA71",1,0)
LA71 ;DALOI/JMC - LA*5.2*71 PATCH ENVIRONMENT CHECK ROUTINE ; 31 Jan 2005
"RTN","LA71",2,0)
 ;;5.2;AUTOMATED LAB INSTRUMENTS;**71**;Sep 27, 1994
"RTN","LA71",3,0)
EN ; Does not prevent loading of the transport global.
"RTN","LA71",4,0)
 ; Environment check is done only during the install.
"RTN","LA71",5,0)
 ;
"RTN","LA71",6,0)
 N XQA,XQAMSG
"RTN","LA71",7,0)
 ;
"RTN","LA71",8,0)
 I '$G(XPDENV) D  Q
"RTN","LA71",9,0)
 . S XQAMSG="Transport global for patch "_$G(XPDNM,"Unknown patch")_" loaded on "_$$HTE^XLFDT($H),XQA("G.LMI")=""
"RTN","LA71",10,0)
 . D SETUP^XQALERT
"RTN","LA71",11,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Sending transport global loaded alert to mail group G.LMI",80))
"RTN","LA71",12,0)
 ;
"RTN","LA71",13,0)
 S XQAMSG="Installation of patch "_$G(XPDNM,"Unknown patch")_" started on "_$$HTE^XLFDT($H)
"RTN","LA71",14,0)
 S XQA("G.LMI")=""
"RTN","LA71",15,0)
 D SETUP^XQALERT
"RTN","LA71",16,0)
 ;
"RTN","LA71",17,0)
 D CHECK
"RTN","LA71",18,0)
 D EXIT
"RTN","LA71",19,0)
 Q
"RTN","LA71",20,0)
 ;
"RTN","LA71",21,0)
CHECK ; Perform environment check
"RTN","LA71",22,0)
 I $S('$G(IOM):1,'$G(IOSL):1,$G(U)'="^":1,1:0) D  Q
"RTN","LA71",23,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Terminal Device is not defined",80))
"RTN","LA71",24,0)
 . S XPDQUIT=2
"RTN","LA71",25,0)
 I $S('$G(DUZ):1,$D(DUZ)[0:1,$D(DUZ(0))[0:1,1:0) D  Q
"RTN","LA71",26,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("Please log in to set local DUZ... variables",80))
"RTN","LA71",27,0)
 . S XPDQUIT=2
"RTN","LA71",28,0)
 I $P($$ACTIVE^XUSER(DUZ),"^")'=1 D  Q
"RTN","LA71",29,0)
 . D BMES^XPDUTL($$CJ^XLFSTR("You are not a valid user on this system",80))
"RTN","LA71",30,0)
 . S XPDQUIT=2
"RTN","LA71",31,0)
 S XPDIQ("XPZ1","B")="NO"
"RTN","LA71",32,0)
 Q
"RTN","LA71",33,0)
 ;
"RTN","LA71",34,0)
EXIT ;
"RTN","LA71",35,0)
 I $G(XPDQUIT) D BMES^XPDUTL($$CJ^XLFSTR("--- Install Environment Check FAILED ---",80))
"RTN","LA71",36,0)
 I '$G(XPDQUIT) D BMES^XPDUTL($$CJ^XLFSTR("--- Environment Check is Ok ---",80))
"RTN","LA71",37,0)
 Q
"RTN","LA71",38,0)
 ;
"RTN","LA71",39,0)
 ;
"RTN","LA71",40,0)
PRE ; KIDS Pre install for LA*5.2*71
"RTN","LA71",41,0)
 ;
"RTN","LA71",42,0)
 N FDA,LA76248,LA771,LA7FLG,LA7ROOT,LA7Y
"RTN","LA71",43,0)
 ;
"RTN","LA71",44,0)
 D BMES^XPDUTL($$CJ^XLFSTR("Sending install started alert to mail group G.LMI",80))
"RTN","LA71",45,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Pre install started ***",80))
"RTN","LA71",46,0)
 D BMES^XPDUTL($$CJ^XLFSTR("--- No action required---",80))
"RTN","LA71",47,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Pre install completed ***",80))
"RTN","LA71",48,0)
 ;
"RTN","LA71",49,0)
 Q
"RTN","LA71",50,0)
 ;
"RTN","LA71",51,0)
 ;
"RTN","LA71",52,0)
POST ; KIDS Post install for LA*5.2*71
"RTN","LA71",53,0)
 N DA,DIK,XQA,XQAMSG
"RTN","LA71",54,0)
 ;
"RTN","LA71",55,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Post install started ***",80))
"RTN","LA71",56,0)
 D BMES^XPDUTL($$CJ^XLFSTR("--- No actions required for post install ---",80))
"RTN","LA71",57,0)
 D BMES^XPDUTL($$CJ^XLFSTR("*** Post install completed ***",80))
"RTN","LA71",58,0)
 ;
"RTN","LA71",59,0)
 D BMES^XPDUTL($$CJ^XLFSTR("Sending install completion alert to mail group G.LMI",80))
"RTN","LA71",60,0)
 S XQAMSG="Installation of patch "_$G(XPDNM,"Unknown patch")_" completed on "_$$HTE^XLFDT($H)
"RTN","LA71",61,0)
 S XQA("G.LMI")=""
"RTN","LA71",62,0)
 D SETUP^XQALERT
"RTN","LA71",63,0)
 ;
"RTN","LA71",64,0)
 Q
"RTN","LA7VOBX1")
0^1^B15262892
"RTN","LA7VOBX1",1,0)
LA7VOBX1 ;DALOI/JMC - LAB OBX Segment message builder (CH subscript) cont'd; 5/25/00
"RTN","LA7VOBX1",2,0)
 ;;5.2;AUTOMATED LAB INSTRUMENTS;**46,61,63,64,71**;Sep 27, 1994
"RTN","LA7VOBX1",3,0)
 ;
"RTN","LA7VOBX1",4,0)
CH ; Observation/Result segment for "CH" subscript results.
"RTN","LA7VOBX1",5,0)
 ; Called by LA7VOBX
"RTN","LA7VOBX1",6,0)
 ;
"RTN","LA7VOBX1",7,0)
 N LA76304,LA7ALT,LA7DIV,LA7I,LA7RS,LA7X,LA7Y,X
"RTN","LA7VOBX1",8,0)
 ;
"RTN","LA7VOBX1",9,0)
 ; "CH" subscript requires a dataname
"RTN","LA7VOBX1",10,0)
 I '$G(LRSB) Q
"RTN","LA7VOBX1",11,0)
 ;
"RTN","LA7VOBX1",12,0)
 ; get result node from LR global.
"RTN","LA7VOBX1",13,0)
 S LA76304(0)=$G(^LR(LRDFN,LRSS,LRIDT,0))
"RTN","LA7VOBX1",14,0)
 S LA7RS=$P(LRSB,"^",2),LRSB=$P(LRSB,"^")
"RTN","LA7VOBX1",15,0)
 S LA7VAL=$G(^LR(LRDFN,LRSS,LRIDT,LRSB))
"RTN","LA7VOBX1",16,0)
 ; If previous results have been corrected then send corrected status
"RTN","LA7VOBX1",17,0)
 I LA7RS="",$P(LA7VAL,"^",10)=2 S LA7RS="C"
"RTN","LA7VOBX1",18,0)
 ;
"RTN","LA7VOBX1",19,0)
 ; Check if test is OK to send - (O)utput or (B)oth
"RTN","LA7VOBX1",20,0)
 S LA7X=$P(LA7VAL,"^",12)
"RTN","LA7VOBX1",21,0)
 I LA7X]"","BO"'[LA7X Q
"RTN","LA7VOBX1",22,0)
 I LA7X="",'$$OKTOSND^LA7VHLU1(LRSS,LRSB,+$P($P(LA7VAL,"^",3),"!",7)) Q
"RTN","LA7VOBX1",23,0)
 ;
"RTN","LA7VOBX1",24,0)
 ; If no result NLT or LOINC try to determine from file #60
"RTN","LA7VOBX1",25,0)
 S LA7X=$P(LA7VAL,"^",3)
"RTN","LA7VOBX1",26,0)
 I $P(LA7X,"!",2)=""!($P(LA7X,"!",3)="") S $P(LA7VAL,"^",3)=$$DEFCODE^LA7VHLU5(LRSS,LRSB,LA7X,$P(LA76304(0),"^",5))
"RTN","LA7VOBX1",27,0)
 ; No result NLT code - log error
"RTN","LA7VOBX1",28,0)
 I $P($P(LA7VAL,"^",3),"!",2)="" D
"RTN","LA7VOBX1",29,0)
 . N LA7X
"RTN","LA7VOBX1",30,0)
 . S LA7X="["_LRSB_"]"_$$GET1^DID(63.04,LRSB,"","LABEL")
"RTN","LA7VOBX1",31,0)
 . D CREATE^LA7LOG(36)
"RTN","LA7VOBX1",32,0)
 ;
"RTN","LA7VOBX1",33,0)
 ; something missing - No NLT code, etc.
"RTN","LA7VOBX1",34,0)
 I LA7VAL="" Q
"RTN","LA7VOBX1",35,0)
 ;
"RTN","LA7VOBX1",36,0)
 ; Check for missing units/reference ranges
"RTN","LA7VOBX1",37,0)
 S LA7X=$P(LA7VAL,"^",5)
"RTN","LA7VOBX1",38,0)
 ;
"RTN","LA7VOBX1",39,0)
 ; Results missing units, lookup in file #60
"RTN","LA7VOBX1",40,0)
 I $P(LA7X,"!",7)="" S $P(LA7X,"!",7)=$P($$REFUNIT^LA7VHLU1(LRSB,$P(LA76304(0),"^",5)),"^",3)
"RTN","LA7VOBX1",41,0)
 ;
"RTN","LA7VOBX1",42,0)
 ; If results missing reference ranges, use values from file #60.
"RTN","LA7VOBX1",43,0)
 I $P(LA7X,"!",2)="",$P(LA7X,"!",3)="",$P(LA7X,"!",11)="",$P(LA7X,"!",12)="" D
"RTN","LA7VOBX1",44,0)
 . S LA7Y=$$REFUNIT^LA7VHLU1(LRSB,$P(LA76304(0),"^",5))
"RTN","LA7VOBX1",45,0)
 . S $P(LA7X,"!",2)=$P(LA7Y,"^")
"RTN","LA7VOBX1",46,0)
 . S $P(LA7X,"!",3)=$P(LA7Y,"^",2)
"RTN","LA7VOBX1",47,0)
 . S $P(LA7X,"!",11)=$P(LA7Y,"^",6)
"RTN","LA7VOBX1",48,0)
 . S $P(LA7X,"!",12)=$P(LA7Y,"^",7)
"RTN","LA7VOBX1",49,0)
 ; Use therapeutic low/high if low/high missing.
"RTN","LA7VOBX1",50,0)
 I $P(LA7X,"!",2)="",$P(LA7X,"!",3)="" D
"RTN","LA7VOBX1",51,0)
 . S $P(LA7X,"!",2)=$P(LA7X,"!",11)
"RTN","LA7VOBX1",52,0)
 . S $P(LA7X,"!",3)=$P(LA7X,"!",12)
"RTN","LA7VOBX1",53,0)
 ;
"RTN","LA7VOBX1",54,0)
 ; Evaluate low/high reference ranges in case M code in these fields.
"RTN","LA7VOBX1",55,0)
 S:$G(SEX)="" SEX="M" S:$G(AGE)="" AGE=99
"RTN","LA7VOBX1",56,0)
 F LA7I=2,3 I $E($P(LA7X,"!",LA7I),1,3)="$S(" D
"RTN","LA7VOBX1",57,0)
 . S @("X="_$P(LA7X,"!",LA7I))
"RTN","LA7VOBX1",58,0)
 . S $P(LA7X,"!",LA7I)=X
"RTN","LA7VOBX1",59,0)
 ;
"RTN","LA7VOBX1",60,0)
 ; Put units/reference ranges back in variable LA7VAL
"RTN","LA7VOBX1",61,0)
 S $P(LA7VAL,"^",5)=LA7X
"RTN","LA7VOBX1",62,0)
 ;
"RTN","LA7VOBX1",63,0)
 ; Initialize OBX segment
"RTN","LA7VOBX1",64,0)
 S LA7OBX(0)="OBX"
"RTN","LA7VOBX1",65,0)
 S LA7OBX(1)=$$OBX1^LA7VOBX(.LA7OBXSN)
"RTN","LA7VOBX1",66,0)
 ;
"RTN","LA7VOBX1",67,0)
 ; Value type
"RTN","LA7VOBX1",68,0)
 ; If result is "cancel" or "comment" then data type is ST - string data
"RTN","LA7VOBX1",69,0)
 S LA7X=$S("canccomment"[$P(LA7VAL,"^"):1,1:0)
"RTN","LA7VOBX1",70,0)
 I LA7X S LA7OBX(2)="ST"
"RTN","LA7VOBX1",71,0)
 E  S LA7OBX(2)=$$OBX2^LA7VOBX(63.04,LRSB)
"RTN","LA7VOBX1",72,0)
 ;
"RTN","LA7VOBX1",73,0)
 ; Observation identifer
"RTN","LA7VOBX1",74,0)
 ; build alternate code based on dataname from file #63 in case it's needed
"RTN","LA7VOBX1",75,0)
 S LA7X=$P(LA7VAL,"^",3)
"RTN","LA7VOBX1",76,0)
 S LA7ALT="CH"_LRSB_"^"_$$GET1^DID(63.04,LRSB,"","LABEL")_"^"_"99VA63"
"RTN","LA7VOBX1",77,0)
 S LA7OBX(3)=$$OBX3^LA7VOBX($P(LA7X,"!",2),$P(LA7X,"!",3),LA7ALT,LA7FS,LA7ECH)
"RTN","LA7VOBX1",78,0)
 ;
"RTN","LA7VOBX1",79,0)
 ; Test value
"RTN","LA7VOBX1",80,0)
 ; If DoD and "canc" then report "PL Cancelled" per Lab Interop ICD.
"RTN","LA7VOBX1",81,0)
 S LA7X=$P(LA7VAL,"^")
"RTN","LA7VOBX1",82,0)
 I LA7X'="canc",$$GET1^DID(63.04,LRSB,"","TYPE","","LA7ERR")="SET" D
"RTN","LA7VOBX1",83,0)
 . S LA7X=$$EXTERNAL^DILFD(63.04,LRSB,"",LA7X)
"RTN","LA7VOBX1",84,0)
 . I LA7X="" S LA7X=$P(LA7VAL,"^")
"RTN","LA7VOBX1",85,0)
 I $G(LA7NVAF)=1,LA7X="canc" S LA7X="PL Cancelled"
"RTN","LA7VOBX1",86,0)
 S LA7OBX(5)=$$OBX5^LA7VOBX(LA7X,LA7OBX(2),LA7FS,LA7ECH)
"RTN","LA7VOBX1",87,0)
 ;
"RTN","LA7VOBX1",88,0)
 ; Units
"RTN","LA7VOBX1",89,0)
 S LA7X=$P(LA7VAL,"^",5)
"RTN","LA7VOBX1",90,0)
 S LA7OBX(6)=$$OBX6^LA7VOBX($P(LA7X,"!",7),"",LA7FS,LA7ECH)
"RTN","LA7VOBX1",91,0)
 ;
"RTN","LA7VOBX1",92,0)
 ; Reference range
"RTN","LA7VOBX1",93,0)
 S LA7OBX(7)=$$OBX7^LA7VOBX($P(LA7X,"!",2),$P(LA7X,"!",3),LA7FS,LA7ECH)
"RTN","LA7VOBX1",94,0)
 ;
"RTN","LA7VOBX1",95,0)
 ; Abnormal flags
"RTN","LA7VOBX1",96,0)
 S LA7OBX(8)=$$OBX8^LA7VOBX($P(LA7VAL,"^",2))
"RTN","LA7VOBX1",97,0)
 ;
"RTN","LA7VOBX1",98,0)
 ; "P"artial or "F"inal results
"RTN","LA7VOBX1",99,0)
 S LA7X=$S("canccommentpending"[$P(LA7VAL,"^"):$P(LA7VAL,"^"),1:"F")
"RTN","LA7VOBX1",100,0)
 I LA7RS="C" S LA7X=LA7RS
"RTN","LA7VOBX1",101,0)
 S LA7OBX(11)=$$OBX11^LA7VOBX(LA7X)
"RTN","LA7VOBX1",102,0)
 ;
"RTN","LA7VOBX1",103,0)
 ; Observation date/time - collection date/time per HL7 standard
"RTN","LA7VOBX1",104,0)
 I $P(LA76304(0),"^") S LA7OBX(14)=$$OBX14^LA7VOBX($P(LA76304(0),"^"))
"RTN","LA7VOBX1",105,0)
 ;
"RTN","LA7VOBX1",106,0)
 S LA7DIV=$P(LA7VAL,"^",9)
"RTN","LA7VOBX1",107,0)
 I LA7DIV="",$$DIV4^XUSER(.LA7DIV,$P(LA7VAL,"^",4)) S LA7DIV=$O(LA7DIV(0))
"RTN","LA7VOBX1",108,0)
 ;
"RTN","LA7VOBX1",109,0)
 ; Facility that performed the testing
"RTN","LA7VOBX1",110,0)
 S LA7OBX(15)=$$OBX15^LA7VOBX(LA7DIV,LA7FS,LA7ECH)
"RTN","LA7VOBX1",111,0)
 ;
"RTN","LA7VOBX1",112,0)
 ; Person that verified the test
"RTN","LA7VOBX1",113,0)
 S LA7OBX(16)=$$OBX16^LA7VOBX($P(LA7VAL,"^",4),LA7DIV,LA7FS,LA7ECH)
"RTN","LA7VOBX1",114,0)
 ;
"RTN","LA7VOBX1",115,0)
 ; Observation method
"RTN","LA7VOBX1",116,0)
 S LA7X=$P($P(LA7VAL,"^",3),"!",4)
"RTN","LA7VOBX1",117,0)
 I LA7X S LA7OBX(17)=$$OBX17^LA7VOBX(LA7X,LA7FS,LA7ECH)
"RTN","LA7VOBX1",118,0)
 ;
"RTN","LA7VOBX1",119,0)
 ; Equipment entity identifier
"RTN","LA7VOBX1",120,0)
 I $L($P(LA7VAL,"^",11)) S LA7OBX(18)=$$OBX18^LA7VOBX($P(LA7VAL,"^",11),LA7FS,LA7ECH)
"RTN","LA7VOBX1",121,0)
 ;
"RTN","LA7VOBX1",122,0)
 D BUILDSEG^LA7VHLU(.LA7OBX,.LA7ARRAY,LA7FS)
"RTN","LA7VOBX1",123,0)
 ;
"RTN","LA7VOBX1",124,0)
 Q
"RTN","LA7VORU")
0^2^B58855542
"RTN","LA7VORU",1,0)
LA7VORU ;DALOI/JMC - Builder of HL7 Lab Results OBR/OBX/NTE ;Jan 31, 2005
"RTN","LA7VORU",2,0)
 ;;5.2;AUTOMATED LAB INSTRUMENTS;**27,46,61,64,71**;Sep 27, 1994
"RTN","LA7VORU",3,0)
 ;
"RTN","LA7VORU",4,0)
EN(LA) ; called from IN^LA7VMSG(...)
"RTN","LA7VORU",5,0)
 ; variables
"RTN","LA7VORU",6,0)
 ; LA("HUID") - Host Unique ID from the local ACCESSION file (#68)
"RTN","LA7VORU",7,0)
 ; LA("SITE") - Ordering site IEN in the INSTITUTION file (#4)
"RTN","LA7VORU",8,0)
 ; LA("RUID") - Remote sites Unique ID from ACCESSION file (#68)
"RTN","LA7VORU",9,0)
 ; LA("ORD") - Free text ordered test name from WKLD CODE file (#64)
"RTN","LA7VORU",10,0)
 ; LA("NLT") - National Laboratory test code from WKLD CODE file (#64)
"RTN","LA7VORU",11,0)
 ; LA("LRIDT") - Inverse date/time the lab arrival time (accession date/time)
"RTN","LA7VORU",12,0)
 ; LA("SUB") - test subscript defined in LABORATORY TEST file (#60)
"RTN","LA7VORU",13,0)
 ; LA("LRDFN") - IEN in LAB DATA file (#63)
"RTN","LA7VORU",14,0)
 ; LA("ORD"), LA("NLT"), and LA("SUB") are sent for specific lab results.
"RTN","LA7VORU",15,0)
 ; LA("AUTO-INST") - Auto-Instrument
"RTN","LA7VORU",16,0)
 ;
"RTN","LA7VORU",17,0)
 N LA763,LA7NLT,LA7NVAF,LA7X,PRIMARY
"RTN","LA7VORU",18,0)
 ;
"RTN","LA7VORU",19,0)
 S PRIMARY=$$PRIM^VASITE(DT),LA("AUTO-INST")=""
"RTN","LA7VORU",20,0)
 I $G(PRIMARY)'="" D
"RTN","LA7VORU",21,0)
 . S PRIMARY=$$SITE^VASITE(DT,PRIMARY)
"RTN","LA7VORU",22,0)
 . S PRIMARY=$P(PRIMARY,U,3)
"RTN","LA7VORU",23,0)
 . S LA("AUTO-INST")="LA7V HOST "_PRIMARY
"RTN","LA7VORU",24,0)
 ;
"RTN","LA7VORU",25,0)
 I '$O(^LR(LA("LRDFN"),LA("SUB"),LA("LRIDT"),0)) D  Q
"RTN","LA7VORU",26,0)
 . ; need to add error logging when no entry in 63.
"RTN","LA7VORU",27,0)
 ;
"RTN","LA7VORU",28,0)
 ; Get zeroth node of entry in #63.
"RTN","LA7VORU",29,0)
 S LA763(0)=$G(^LR(LA("LRDFN"),LA("SUB"),LA("LRIDT"),0))
"RTN","LA7VORU",30,0)
 S LA7NLT=$G(LA("NLT"))
"RTN","LA7VORU",31,0)
 ;
"RTN","LA7VORU",32,0)
 S LA7NVAF=$$NVAF^LA7VHLU2(+LA("SITE"))
"RTN","LA7VORU",33,0)
 S LA7NTESN=0
"RTN","LA7VORU",34,0)
 D ORC
"RTN","LA7VORU",35,0)
 ;
"RTN","LA7VORU",36,0)
 I $G(LA("SUB"))="CH" D CH
"RTN","LA7VORU",37,0)
 I $G(LA("SUB"))="MI" D MI^LA7VORU1
"RTN","LA7VORU",38,0)
 I "SPCYEM"[$G(LA("SUB")) D AP^LA7VORU2
"RTN","LA7VORU",39,0)
 Q
"RTN","LA7VORU",40,0)
 ;
"RTN","LA7VORU",41,0)
 ;
"RTN","LA7VORU",42,0)
CH ; Build segments for "CH" subscript
"RTN","LA7VORU",43,0)
 ;
"RTN","LA7VORU",44,0)
 D OBR
"RTN","LA7VORU",45,0)
 D NTE
"RTN","LA7VORU",46,0)
 S LA7OBXSN=0
"RTN","LA7VORU",47,0)
 D OBX
"RTN","LA7VORU",48,0)
 ;
"RTN","LA7VORU",49,0)
 Q
"RTN","LA7VORU",50,0)
 ;
"RTN","LA7VORU",51,0)
 ;
"RTN","LA7VORU",52,0)
ORC ; Build ORC segment
"RTN","LA7VORU",53,0)
 ;
"RTN","LA7VORU",54,0)
 N LA763,LA7696,LA7DATA,LA7SM,LA7X,LA7Y,ORC
"RTN","LA7VORU",55,0)
 ;
"RTN","LA7VORU",56,0)
 S LA763(0)=$G(^LR(LA("LRDFN"),LA("SUB"),LA("LRIDT"),0))
"RTN","LA7VORU",57,0)
 ;
"RTN","LA7VORU",58,0)
 S ORC(0)="ORC"
"RTN","LA7VORU",59,0)
 ;
"RTN","LA7VORU",60,0)
 ; Order control
"RTN","LA7VORU",61,0)
 S ORC(1)=$$ORC1^LA7VORC("RE")
"RTN","LA7VORU",62,0)
 ;
"RTN","LA7VORU",63,0)
 ; Remote UID
"RTN","LA7VORU",64,0)
 S ORC(2)=$$ORC2^LA7VORC(LA("RUID"),LA7FS,LA7ECH)
"RTN","LA7VORU",65,0)
 ;
"RTN","LA7VORU",66,0)
 ; Host UID
"RTN","LA7VORU",67,0)
 S ORC(3)=$$ORC3^LA7VORC(LA("HUID"),LA7FS,LA7ECH)
"RTN","LA7VORU",68,0)
 ;
"RTN","LA7VORU",69,0)
 ; Return shipping manifest if found
"RTN","LA7VORU",70,0)
 S LA7SM="",LA7696=0
"RTN","LA7VORU",71,0)
 I LA("SITE")'="",LA("RUID")'="" S LA7696=$O(^LRO(69.6,"RST",LA("SITE"),LA("RUID"),0))
"RTN","LA7VORU",72,0)
 I LA7696 S LA7SM=$P($G(^LRO(69.6,LA7696,0)),U,14)
"RTN","LA7VORU",73,0)
 I LA7SM'="" S ORC(4)=$$ORC4^LA7VORC(LA7SM,LA7FS,LA7ECH)
"RTN","LA7VORU",74,0)
 ;
"RTN","LA7VORU",75,0)
 ; Order status
"RTN","LA7VORU",76,0)
 ; DoD/CHCS requires ORC-5 valued otherwise will not process message
"RTN","LA7VORU",77,0)
 I LA7NVAF=1 S ORC(5)=$$ORC5^LA7VORC("CM",LA7FS,LA7ECH)
"RTN","LA7VORU",78,0)
 ;
"RTN","LA7VORU",79,0)
 ; Ordering provider
"RTN","LA7VORU",80,0)
 S (LA7X,LA7Y)=""
"RTN","LA7VORU",81,0)
 ; "CH" subscript stores requesting provider and requesting div/location.
"RTN","LA7VORU",82,0)
 I LA("SUB")="CH" D
"RTN","LA7VORU",83,0)
 . N LA7J
"RTN","LA7VORU",84,0)
 . S LA7J=$P(LA763(0),"^",13)
"RTN","LA7VORU",85,0)
 . I $P(LA7J,";",2)="SC(" S LA7Y=$$GET1^DIQ(44,$P(LA7J,";")_",",3,"I")
"RTN","LA7VORU",86,0)
 . I $P(LA7J,";",2)="DIC(4," S LA7Y=$P(LA7J,";")
"RTN","LA7VORU",87,0)
 . S LA7X=$P(LA763(0),"^",10)
"RTN","LA7VORU",88,0)
 ;
"RTN","LA7VORU",89,0)
 ; Other subscripts only store requesting provider
"RTN","LA7VORU",90,0)
 I "CYEMMISP"[LA("SUB") S LA7X=$P(LA763(0),"^",7)
"RTN","LA7VORU",91,0)
 ; Get default institution from MailMan Site Parameters file
"RTN","LA7VORU",92,0)
 I LA7Y="" S LA7Y=$$GET1^DIQ(4.3,"1,",217,"I")
"RTN","LA7VORU",93,0)
 S ORC(12)=$$ORC12^LA7VORC(LA7X,LA7Y,LA7FS,LA7ECH)
"RTN","LA7VORU",94,0)
 ;
"RTN","LA7VORU",95,0)
 ; Entering organization
"RTN","LA7VORU",96,0)
 S ORC(17)=$$ORC17^LA7VORC(LA7Y,LA7FS,LA7ECH)
"RTN","LA7VORU",97,0)
 ;
"RTN","LA7VORU",98,0)
 D BUILDSEG^LA7VHLU(.ORC,.LA7DATA,LA7FS)
"RTN","LA7VORU",99,0)
 D FILESEG^LA7VHLU(GBL,.LA7DATA)
"RTN","LA7VORU",100,0)
 ;
"RTN","LA7VORU",101,0)
 ; Check for flag to only build message but do not file
"RTN","LA7VORU",102,0)
 I '$G(LA7NOMSG) D FILE6249^LA7VHLU(LA76249P,.LA7DATA)
"RTN","LA7VORU",103,0)
 ;
"RTN","LA7VORU",104,0)
 Q
"RTN","LA7VORU",105,0)
 ;
"RTN","LA7VORU",106,0)
 ;
"RTN","LA7VORU",107,0)
OBR ;Observation Request segment for Lab Order
"RTN","LA7VORU",108,0)
 ;
"RTN","LA7VORU",109,0)
 N LA761,LA762,LA7DATA,LA7PLOBR,LA7X,LA7Y,OBR
"RTN","LA7VORU",110,0)
 ;
"RTN","LA7VORU",111,0)
 ; Retrieve placer's OBR information stored in #69.6
"RTN","LA7VORU",112,0)
 D RETOBR^LA7VHLU(LA("SITE"),LA("RUID"),LA("NLT"),.LA7PLOBR)
"RTN","LA7VORU",113,0)
 ;
"RTN","LA7VORU",114,0)
 ; Initialize OBR segment
"RTN","LA7VORU",115,0)
 S OBR(0)="OBR"
"RTN","LA7VORU",116,0)
 S OBR(1)=$$OBR1^LA7VOBR(.LA7OBRSN)
"RTN","LA7VORU",117,0)
 ;
"RTN","LA7VORU",118,0)
 ; Remote UID
"RTN","LA7VORU",119,0)
 S OBR(2)=$$OBR2^LA7VOBR(LA("RUID"),LA7FS,LA7ECH)
"RTN","LA7VORU",120,0)
 ;
"RTN","LA7VORU",121,0)
 ; Host UID
"RTN","LA7VORU",122,0)
 S OBR(3)=$$OBR3^LA7VOBR(LA("HUID"),LA7FS,LA7ECH)
"RTN","LA7VORU",123,0)
 ;
"RTN","LA7VORU",124,0)
 ; Universal service ID, build from info stored in #69.6
"RTN","LA7VORU",125,0)
 S LA7X=""
"RTN","LA7VORU",126,0)
 I $G(LA7PLOBR("OBR-4"))'="" S OBR(4)=$$CNVFLD^LA7VHLU3(LA7PLOBR("OBR-4"),LA7PLOBR("ECH"),LA7ECH)
"RTN","LA7VORU",127,0)
 E  S OBR(4)=$$OBR4^LA7VOBR(LA7NLT,"",LA7X,LA7FS,LA7ECH)
"RTN","LA7VORU",128,0)
 ;
"RTN","LA7VORU",129,0)
 ; Collection D/T
"RTN","LA7VORU",130,0)
 S OBR(7)=$$OBR7^LA7VOBR($P(LA763(0),U))
"RTN","LA7VORU",131,0)
 ;
"RTN","LA7VORU",132,0)
 ; Specimen action code
"RTN","LA7VORU",133,0)
 ; If no OBR from PENDING ORDER file (#69.6) then assume added test.
"RTN","LA7VORU",134,0)
 I $G(LA7INTYP)=10,$G(LA7PLOBR("OBR-4"))="" S OBR(11)=$$OBR11^LA7VOBR("A")
"RTN","LA7VORU",135,0)
 ;
"RTN","LA7VORU",136,0)
 ; Infection Warning
"RTN","LA7VORU",137,0)
 S OBR(12)=$$OBR12^LA7VOBR(LRDFN,LA7FS,LA7ECH)
"RTN","LA7VORU",138,0)
 ;
"RTN","LA7VORU",139,0)
 ; Lab Arrival Time
"RTN","LA7VORU",140,0)
 ; "CH" subscript does not store lab arrival time, use collection time.
"RTN","LA7VORU",141,0)
 ; Other subscripts do store lab arrival time (date/time received).
"RTN","LA7VORU",142,0)
 I "CYEMMISP"[LA("SUB") S OBR(14)=$$OBR14^LA7VOBR($P(LA763(0),"^",10))
"RTN","LA7VORU",143,0)
 I LA("SUB")="CH" S OBR(14)=$$OBR14^LA7VOBR($P(LA763(0),"^"))
"RTN","LA7VORU",144,0)
 ;
"RTN","LA7VORU",145,0)
 ; Specimen source 
"RTN","LA7VORU",146,0)
 S (LA761,LA762)=""
"RTN","LA7VORU",147,0)
 I "CHMI"[LA("SUB") D
"RTN","LA7VORU",148,0)
 . S LA761=$P(LA763(0),U,5)
"RTN","LA7VORU",149,0)
 . I LA761="" D CREATE^LA7LOG(27)
"RTN","LA7VORU",150,0)
 . I LA("SUB")="MI" S LA762=$P(LA763(0),U,11)
"RTN","LA7VORU",151,0)
 S OBR(15)=$$OBR15^LA7VOBR(LA761,LA762,"",LA7FS,LA7ECH)
"RTN","LA7VORU",152,0)
 ;
"RTN","LA7VORU",153,0)
 ; Ordering provider
"RTN","LA7VORU",154,0)
 S (LA7X,LA7Y)=""
"RTN","LA7VORU",155,0)
 ; "CH" subscript stores requesting provider and requesting div/location.
"RTN","LA7VORU",156,0)
 I LA("SUB")="CH" D
"RTN","LA7VORU",157,0)
 . N LA7J
"RTN","LA7VORU",158,0)
 . S LA7J=$P(LA763(0),"^",13)
"RTN","LA7VORU",159,0)
 . I $P(LA7J,";",2)="SC(" S LA7Y=$$GET1^DIQ(44,$P(LA7J,";")_",",3,"I")
"RTN","LA7VORU",160,0)
 . I $P(LA7J,";",2)="DIC(4," S LA7Y=$P(LA7J,";")
"RTN","LA7VORU",161,0)
 . S LA7X=$P(LA763(0),"^",10)
"RTN","LA7VORU",162,0)
 ;
"RTN","LA7VORU",163,0)
 ; Other subscripts only store requesting provider
"RTN","LA7VORU",164,0)
 I "CYEMMISP"[LA("SUB") S LA7X=$P(LA763(0),"^",7)
"RTN","LA7VORU",165,0)
 ; Get default institution from MailMan Site Parameters file
"RTN","LA7VORU",166,0)
 I LA7Y="" S LA7Y=$$GET1^DIQ(4.3,"1,",217,"I")
"RTN","LA7VORU",167,0)
 S OBR(16)=$$ORC12^LA7VORC(LA7X,LA7Y,LA7FS,LA7ECH)
"RTN","LA7VORU",168,0)
 ;
"RTN","LA7VORU",169,0)
 ; Placer Field #1 (remote auto-inst)
"RTN","LA7VORU",170,0)
 ; Build from info stored in #69.6
"RTN","LA7VORU",171,0)
 I $G(LA7PLOBR("OBR-18"))'="" D
"RTN","LA7VORU",172,0)
 . S OBR(18)=$$CHKDATA^LA7VHLU3(LA7PLOBR("OBR-18"),LA7FS_LA7ECH)
"RTN","LA7VORU",173,0)
 ; Else build "auto instrument" if sending to VA facility
"RTN","LA7VORU",174,0)
 I $G(LA7PLOBR("OBR-18"))="",'LA7NVAF D
"RTN","LA7VORU",175,0)
 . N LA7X
"RTN","LA7VORU",176,0)
 . S LA7X(1)=LA("AUTO-INST")
"RTN","LA7VORU",177,0)
 . S OBR(18)=$$OBR18^LA7VOBR(.LA7X,LA7FS,LA7ECH)
"RTN","LA7VORU",178,0)
 ;
"RTN","LA7VORU",179,0)
 ; Placer Field #2
"RTN","LA7VORU",180,0)
 I $G(LA7PLOBR("OBR-19"))'="" D
"RTN","LA7VORU",181,0)
 . S OBR(19)=$$CHKDATA^LA7VHLU3(LA7PLOBR("OBR-19"),LA7FS_LA7ECH)
"RTN","LA7VORU",182,0)
 ; Else build collecting UID if sending to VA facility
"RTN","LA7VORU",183,0)
 I $G(LA7PLOBR("OBR-19"))="",'LA7NVAF,LA("RUID")'="" D
"RTN","LA7VORU",184,0)
 . K LA7X
"RTN","LA7VORU",185,0)
 . S LA7X(7)=LA("RUID")
"RTN","LA7VORU",186,0)
 . S OBR(19)=$$OBR19^LA7VOBR(.LA7X,LA7FS,LA7ECH)
"RTN","LA7VORU",187,0)
 ;
"RTN","LA7VORU",188,0)
 ; Filler Field #1
"RTN","LA7VORU",189,0)
 ; Send file #63 ien info - used by HDR to track patient/specimen
"RTN","LA7VORU",190,0)
 K LA7X
"RTN","LA7VORU",191,0)
 S LA7X(1)=LA("LRDFN")
"RTN","LA7VORU",192,0)
 S LA7X(2)=LA("SUB")
"RTN","LA7VORU",193,0)
 S LA7X(3)=LA("LRIDT")
"RTN","LA7VORU",194,0)
 S OBR(20)=$$OBR20^LA7VOBR(.LA7X,LA7FS,LA7ECH)
"RTN","LA7VORU",195,0)
 ;
"RTN","LA7VORU",196,0)
 ; Date Report Completed
"RTN","LA7VORU",197,0)
 I $P(LA763(0),"^",3) S OBR(22)=$$OBR22^LA7VOBR($P(LA763(0),"^",3))
"RTN","LA7VORU",198,0)
 ;
"RTN","LA7VORU",199,0)
 ; Diagnostic service id
"RTN","LA7VORU",200,0)
 S OBR(24)=$$OBR24^LA7VOBR(LA("SUB")_"^"_$G(LRSB))
"RTN","LA7VORU",201,0)
 ;
"RTN","LA7VORU",202,0)
 ; Parent Result and Parent
"RTN","LA7VORU",203,0)
 I $D(LA7PARNT) D
"RTN","LA7VORU",204,0)
 . S OBR(26)=$$OBR26^LA7VOBR(LA7PARNT(1),LA7PARNT(2),LA7PARNT(3),LA7FS,LA7ECH)
"RTN","LA7VORU",205,0)
 . S OBR(29)=$$OBR29^LA7VOBR(LA("RUID"),LA("HUID"),LA7FS,LA7ECH)
"RTN","LA7VORU",206,0)
 ;
"RTN","LA7VORU",207,0)
 ; Principle result interpreter
"RTN","LA7VORU",208,0)
 ; Get default institution from MailMan Site Parameters file
"RTN","LA7VORU",209,0)
 I "CYEMMISP"[LA("SUB") D
"RTN","LA7VORU",210,0)
 . I LA("SUB")="MI" S LA7X=$P(LA763(0),"^",4)
"RTN","LA7VORU",211,0)
 . E  S LA7X=$P(LA763(0),"^",2)
"RTN","LA7VORU",212,0)
 . S LA7Y=$$GET1^DIQ(4.3,"1,",217,"I")
"RTN","LA7VORU",213,0)
 . S OBR(32)=$$OBR32^LA7VOBR(LA7X,LA7Y,LA7FS,LA7ECH)
"RTN","LA7VORU",214,0)
 ; 
"RTN","LA7VORU",215,0)
 ; Assistant result interpreter
"RTN","LA7VORU",216,0)
 ; Get default institution from MailMan Site Parameters file
"RTN","LA7VORU",217,0)
 I "EMSP"[LA("SUB") D
"RTN","LA7VORU",218,0)
 . S LA7X=$P(LA763(0),"^",4),LA7Y=$$GET1^DIQ(4.3,"1,",217,"I")
"RTN","LA7VORU",219,0)
 . S OBR(33)=$$OBR33^LA7VOBR(LA7X,LA7Y,LA7FS,LA7ECH)
"RTN","LA7VORU",220,0)
 ; 
"RTN","LA7VORU",221,0)
 ; Technician
"RTN","LA7VORU",222,0)
 ; Get default institution from MailMan Site Parameters file
"RTN","LA7VORU",223,0)
 I "CYEM"[LA("SUB") D
"RTN","LA7VORU",224,0)
 . S LA7X=$P(LA763(0),"^",4),LA7Y=$$GET1^DIQ(4.3,"1,",217,"I")
"RTN","LA7VORU",225,0)
 . S OBR(34)=$$OBR34^LA7VOBR(LA7X,LA7Y,LA7FS,LA7ECH)
"RTN","LA7VORU",226,0)
 ; 
"RTN","LA7VORU",227,0)
 ; Typist - VistA stores as free text
"RTN","LA7VORU",228,0)
 ; Get default institution from MailMan Site Parameters file
"RTN","LA7VORU",229,0)
 I "CYEMSP"[LA("SUB") D
"RTN","LA7VORU",230,0)
 . S LA7X=$P(LA763(0),"^",9),LA7Y=$$GET1^DIQ(4.3,"1,",217,"I")
"RTN","LA7VORU",231,0)
 . S OBR(35)=$$OBR35^LA7VOBR(LA7X,LA7Y,LA7FS,LA7ECH)
"RTN","LA7VORU",232,0)
 ; 
"RTN","LA7VORU",233,0)
 D BUILDSEG^LA7VHLU(.OBR,.LA7DATA,LA7FS)
"RTN","LA7VORU",234,0)
 D FILESEG^LA7VHLU(GBL,.LA7DATA)
"RTN","LA7VORU",235,0)
 ;
"RTN","LA7VORU",236,0)
 ; Check for flag to only build message but do not file
"RTN","LA7VORU",237,0)
 I '$G(LA7NOMSG) D FILE6249^LA7VHLU(LA76249,.LA7DATA)
"RTN","LA7VORU",238,0)
 ;
"RTN","LA7VORU",239,0)
 Q
"RTN","LA7VORU",240,0)
 ;
"RTN","LA7VORU",241,0)
 ;
"RTN","LA7VORU",242,0)
OBX ;Observation/Result segment for Lab Results
"RTN","LA7VORU",243,0)
 ;
"RTN","LA7VORU",244,0)
 N LA7953,LA7DATA,LA7VT,LA7VTIEN,LA7X
"RTN","LA7VORU",245,0)
 ;
"RTN","LA7VORU",246,0)
 S LA7VTIEN=0
"RTN","LA7VORU",247,0)
 F  S LA7VTIEN=$O(^LAHM(62.49,LA(62.49),1,LA7VTIEN)) Q:'LA7VTIEN  D
"RTN","LA7VORU",248,0)
 . S LA7VT=$P(^LAHM(62.49,LA(62.49),1,LA7VTIEN,0),"^",1,2)
"RTN","LA7VORU",249,0)
 . ; Build OBX segment
"RTN","LA7VORU",250,0)
 . K LA7DATA
"RTN","LA7VORU",251,0)
 . D OBX^LA7VOBX(LA("LRDFN"),LA("SUB"),LA("LRIDT"),$P(LA7VT,"^",1,2),.LA7DATA,.LA7OBXSN,LA7FS,LA7ECH,$G(LA7NVAF))
"RTN","LA7VORU",252,0)
 . ; If OBX failed to build then don't store
"RTN","LA7VORU",253,0)
 . I '$D(LA7DATA) Q
"RTN","LA7VORU",254,0)
 . ;
"RTN","LA7VORU",255,0)
 . D FILESEG^LA7VHLU(GBL,.LA7DATA)
"RTN","LA7VORU",256,0)
 . I '$G(LA7NOMSG) D FILE6249^LA7VHLU(LA76249,.LA7DATA)
"RTN","LA7VORU",257,0)
 . ;
"RTN","LA7VORU",258,0)
 . ; Send performing lab comment and interpretation from file #60
"RTN","LA7VORU",259,0)
 . S LA7NTESN=0
"RTN","LA7VORU",260,0)
 . I LA7NVAF=1 D PLC^LA7VORUA
"RTN","LA7VORU",261,0)
 . D INTRP^LA7VORUA
"RTN","LA7VORU",262,0)
 . ;
"RTN","LA7VORU",263,0)
 . ; Mark result as sent - set to 1, if corrected results set to 2
"RTN","LA7VORU",264,0)
 . I LA("SUB")="CH" D
"RTN","LA7VORU",265,0)
 . . I $P(^LR(LA("LRDFN"),LA("SUB"),LA("LRIDT"),$P(LA7VT,"^")),"^",10)>1 Q
"RTN","LA7VORU",266,0)
 . . S $P(^LR(LA("LRDFN"),LA("SUB"),LA("LRIDT"),$P(LA7VT,"^")),"^",10)=$S($P(LA7VT,"^",2)="C":2,1:1)
"RTN","LA7VORU",267,0)
 ;
"RTN","LA7VORU",268,0)
 Q
"RTN","LA7VORU",269,0)
 ;
"RTN","LA7VORU",270,0)
 ;
"RTN","LA7VORU",271,0)
NTE ; Build NTE segment
"RTN","LA7VORU",272,0)
 ;
"RTN","LA7VORU",273,0)
 D NTE^LA7VORUA
"RTN","LA7VORU",274,0)
 Q
"VER")
8.0^22.0
**END**
**END**
