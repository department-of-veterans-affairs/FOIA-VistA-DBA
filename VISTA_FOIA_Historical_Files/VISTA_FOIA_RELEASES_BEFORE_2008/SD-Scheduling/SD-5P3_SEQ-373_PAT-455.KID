Released SD*5.3*455 SEQ #373
Extracted from mail message
**KIDS**:SD*5.3*455^

**INSTALL NAME**
SD*5.3*455
"BLD",6369,0)
SD*5.3*455^SCHEDULING^0^3060105^y
"BLD",6369,1,0)
^^1^1^3050901^
"BLD",6369,1,1,0)
No Show Letters printing for Checked Out and No Action Taken appts.
"BLD",6369,4,0)
^9.64PA^^
"BLD",6369,"ABPKG")
n
"BLD",6369,"KRN",0)
^9.67PA^8989.52^19
"BLD",6369,"KRN",.4,0)
.4
"BLD",6369,"KRN",.401,0)
.401
"BLD",6369,"KRN",.402,0)
.402
"BLD",6369,"KRN",.403,0)
.403
"BLD",6369,"KRN",.5,0)
.5
"BLD",6369,"KRN",.84,0)
.84
"BLD",6369,"KRN",3.6,0)
3.6
"BLD",6369,"KRN",3.8,0)
3.8
"BLD",6369,"KRN",9.2,0)
9.2
"BLD",6369,"KRN",9.8,0)
9.8
"BLD",6369,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",6369,"KRN",9.8,"NM",1,0)
SDB^^0^B17221185
"BLD",6369,"KRN",9.8,"NM",2,0)
SDN1^^0^B20640360
"BLD",6369,"KRN",9.8,"NM","B","SDB",1)

"BLD",6369,"KRN",9.8,"NM","B","SDN1",2)

"BLD",6369,"KRN",19,0)
19
"BLD",6369,"KRN",19.1,0)
19.1
"BLD",6369,"KRN",101,0)
101
"BLD",6369,"KRN",409.61,0)
409.61
"BLD",6369,"KRN",771,0)
771
"BLD",6369,"KRN",870,0)
870
"BLD",6369,"KRN",8989.51,0)
8989.51
"BLD",6369,"KRN",8989.52,0)
8989.52
"BLD",6369,"KRN",8994,0)
8994
"BLD",6369,"KRN","B",.4,.4)

"BLD",6369,"KRN","B",.401,.401)

"BLD",6369,"KRN","B",.402,.402)

"BLD",6369,"KRN","B",.403,.403)

"BLD",6369,"KRN","B",.5,.5)

"BLD",6369,"KRN","B",.84,.84)

"BLD",6369,"KRN","B",3.6,3.6)

"BLD",6369,"KRN","B",3.8,3.8)

"BLD",6369,"KRN","B",9.2,9.2)

"BLD",6369,"KRN","B",9.8,9.8)

"BLD",6369,"KRN","B",19,19)

"BLD",6369,"KRN","B",19.1,19.1)

"BLD",6369,"KRN","B",101,101)

"BLD",6369,"KRN","B",409.61,409.61)

"BLD",6369,"KRN","B",771,771)

"BLD",6369,"KRN","B",870,870)

"BLD",6369,"KRN","B",8989.51,8989.51)

"BLD",6369,"KRN","B",8989.52,8989.52)

"BLD",6369,"KRN","B",8994,8994)

"BLD",6369,"QUES",0)
^9.62^^
"BLD",6369,"REQB",0)
^9.611^2^2
"BLD",6369,"REQB",1,0)
SD*5.3*167^1
"BLD",6369,"REQB",2,0)
SD*5.3*398^1
"BLD",6369,"REQB","B","SD*5.3*167",1)

"BLD",6369,"REQB","B","SD*5.3*398",2)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
455^3060105
"PKG",16,22,1,"PAH",1,1,0)
^^1^1^3060105
"PKG",16,22,1,"PAH",1,1,1,0)
No Show Letters printing for Checked Out and No Action Taken appts.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","SDB")
0^1^B17221185
"RTN","SDB",1,0)
SDB ;FLA/RF,BSN/GRR - SET UP A CLINIC ; 19 SEP 84  11:51 am
"RTN","SDB",2,0)
 ;;5.3;Scheduling;**20,63,167,455**;Aug 13, 1993
"RTN","SDB",3,0)
 S SDTOP=1,SDZQ=1 K SDREACT
"RTN","SDB",4,0)
C Q:$D(SDREACT)!('$D(SDTOP))  W !! D DT^DICRW S (DLAYGO,DIC)=44,DIC(0)="MAQEZL",DIC("A")="Select CLINIC NAME: ",DIC("DR")="2////C",DIC("S")="I $P(^(0),""^"",3)=""C"",'$G(^(""OOS""))" K SDREACT
"RTN","SDB",5,0)
 D ^DIC K DIC("A"),DIC("S") G:Y<0 END S DIE=44,DA=+Y S:$P(Y,U,3)=1 DIE("NO^")=""
"RTN","SDB",6,0)
 K SDIN,SDINH,SDRE,SDRE1 I $D(^SC(DA,"I")),+^("I")>0 S SDIN=+^("I"),SDINH=SDIN,SDRE=+$P(^("I"),"^",2)
"RTN","SDB",7,0)
 S DR="[SDB]" S:'$D(^SC(DA,"ST",0)) ^SC(DA,"ST",0)="^44.005" D ^DIE K DIE("NO^")
"RTN","SDB",8,0)
EN ;Q:$D(SDONE)&('$D(SDTOP))  SD*5.3*455 added 2nd Go on next line
"RTN","SDB",9,0)
 G C:'$D(^SC(DA,"SL")) G C:'+$G(^SC(DA,"SL")) S SL=^("SL"),STARTDAY=8,X=$P(SL,U,3),D=$P(SL,U,6),SI=$S(D:D,1:4),DIC(0)="MAQEZL",(DIC,DIE)="^SC("_DA_",""T"",",DIC("W")=$P($T(DOW),";",3) S:'$D(^("T",0)) ^(0)="^44.002D" S:$L(X) STARTDAY=X
"RTN","SDB",10,0)
 ;K SDREACT
"RTN","SDB",11,0)
G1 D:$D(SDREACT)&('$D(SDTOP)) E1 S SI=$P(SL,"^",6) K Y,HY S SDFSW="" S:$D(SDINH) SDIN=SDINH D PRINT
"RTN","SDB",12,0)
 S (SDREB,SDEL)=0,(SDSAV,SDPAT)="" R !!,"AVAILABILITY DATE: ",X:DTIME Q:U[X&$D(SDREACT)  G C:U[X S %DT="EFX" K Y D ^%DT G HLPD^SDB1:X["?" S POP=0 I $D(SDIN),$S(SDIN>Y!(SDIN=0):0,(SDRE'>Y&(SDRE'=0))!(SDRE=0&(SDIN=0)):0,1:1) D INACT G:POP G1
"RTN","SDB",13,0)
 G EN:$D(SDONE)&(Y<0)&('$D(SDTOP)),EN:$D(SDREACT)&(Y<0),C:Y<0&('$D(SDREACT)) S SD=Y,X=Y D DOW^SDM0 S DOW=Y
"RTN","SDB",14,0)
 D EN1^SDB0 Q:$D(SDREACT)
"RTN","SDB",15,0)
END K %,%DT,%H,C,CCXN,CNT,COLLAT,CTR,D0,DA,DFN,DG,DGO,DH,DI,DIC,DIE,DIFLD,DIK,DK,DL,DLAYGO,DM,DOW,DR,ENDATE,H1,H2,HSI,I,J,LT,M1,M2,MAX,NSL,POP,S,SB,SC,SD,SDAV,SDCL,SDDIF,SDEL,SDFSW,SDHX,SDIN,SDINA,SDINH,SDREACT,SDSDL,SDL,SDLA,SDMAX,SDMM,SDPAT
"RTN","SDB",16,0)
 K SDRE,SDREB,SDRVE,SDSAV,SDSOH,SDT,SDTOP,SDW,SDZQ,SDA1,SI,SL,SLT,SM,SS,SDSTRTDT,STARTDAY,STIME,STR,T1,T2,WY,X,Y,Y1,ZDX
"RTN","SDB",17,0)
 Q
"RTN","SDB",18,0)
INACT Q:Y<0  S POP=1,Y=SDIN D DTS^SDUTL S Y1=Y,Y=SDRE D:Y DTS^SDUTL W !,*7,"Clinic is inactive",$S('SDRE:" as of ",1:" from "),Y1,$S('SDRE:"",1:" to "_Y) Q
"RTN","SDB",19,0)
 ;
"RTN","SDB",20,0)
E1 S:'$D(^SC(DA,"T"_DOW,9999999,1))&($O(^SC(DA,"T"_DOW,0))>0) ^SC(DA,"T"_DOW,9999999,1)="",^(0)=9999999 D TX^SDB1 S:'$D(SDRE) SDRE=D0 Q
"RTN","SDB",21,0)
DOW ;;S %=$E(^(0),1,3),I=$E(^(0),4,5),I=I>2&'(%#4)+$E("144025036146",I) X "F %=%:-1:281 S I=%#4=1+1+I" W "  ",$P("SUN^MON^TUES^WEDNES^THURS^FRI^SATUR",U,$E(^(0),6,7)+I#7+1),"DAY"
"RTN","SDB",22,0)
 Q
"RTN","SDB",23,0)
PRINT ;Print cancelled days
"RTN","SDB",24,0)
 N Y I '$D(^TMP("SDAVAIL",$J)) G PRINTQ
"RTN","SDB",25,0)
 W !,"Availability has been cancelled previously.  The day(s) has been overwritten",!,"with the new availability.  Would you like to see the day(s) that has been affected"
"RTN","SDB",26,0)
 S %=1 D YN^DICN G:%=-1!(%=2) PRINTQ I %=0 D HELP G PRINT
"RTN","SDB",27,0)
 S %ZIS="PMQ" D ^%ZIS I POP G PRINTQ
"RTN","SDB",28,0)
 I '$D(IO("Q")) G PRINT1
"RTN","SDB",29,0)
 S Y=$$QUE(0) G PRINTQ
"RTN","SDB",30,0)
 ;
"RTN","SDB",31,0)
PRINT1 N SDAVAIL,SDLINE S SDAVAIL=0,$P(SDLINE,"=",80)=""
"RTN","SDB",32,0)
 U IO W !,"Dates of Availability Previously Cancelled for "_$E($P($G(^SC(DA,0)),U),1,25),?70,$$FDATE^VALM1(DT),!,SDLINE
"RTN","SDB",33,0)
 F  S SDAVAIL=$O(^TMP("SDAVAIL",$J,SDAVAIL)) Q:'SDAVAIL  D
"RTN","SDB",34,0)
 .W !,$$FDATE^VALM1(SDAVAIL)_" "_$G(^TMP("SDAVAIL",$J,SDAVAIL))
"RTN","SDB",35,0)
 ;
"RTN","SDB",36,0)
PRINTQ K ^TMP("SDAVAIL",$J)
"RTN","SDB",37,0)
 D:'$D(ZTQUEUED) ^%ZISC
"RTN","SDB",38,0)
 Q
"RTN","SDB",39,0)
HELP ;
"RTN","SDB",40,0)
 W !,"Answer 'Y'es or 'N'o."
"RTN","SDB",41,0)
 Q
"RTN","SDB",42,0)
QUE(X) ; -- que job
"RTN","SDB",43,0)
 ; return: did job que [ 1|yes   0|no ]
"RTN","SDB",44,0)
 ;
"RTN","SDB",45,0)
 K ZTSK,IO("Q")
"RTN","SDB",46,0)
 S ZTDESC="Previously Cancelled Availability Dates",ZTRTN="PRINT1^SDB"
"RTN","SDB",47,0)
 F  S X=$O(^TMP("SDAVAIL",$J,X)) Q:'X  D
"RTN","SDB",48,0)
 .S ZTSAVE("^TMP(""SDAVAIL"",$J,")=^TMP("SDAVAIL",$J,X)
"RTN","SDB",49,0)
 S ZTSAVE("DA")=DA
"RTN","SDB",50,0)
 D ^%ZTLOAD W:$D(ZTSK) "   (Task: ",ZTSK,")"
"RTN","SDB",51,0)
 Q $D(ZTSK)
"RTN","SDN1")
0^2^B20640360
"RTN","SDN1",1,0)
SDN1 ;BSN/GRR - NO-SHOW LETTERS ; 17 AUG 84  4:34 pm
"RTN","SDN1",2,0)
 ;;5.3;Scheduling;**330,340,398,455**;Aug 13, 1993
"RTN","SDN1",3,0)
 N SDBAD
"RTN","SDN1",4,0)
 I ANS["Y"&($D(C)) F A=0:0 S A=$O(^UTILITY($J,A)) Q:A'>0  F C=0:0 S C=$O(^(A,C)) Q:C'>0  S SC=+^(C),SDLET="" S:$D(^SC(SC,"LTR")) SDLET=+^("LTR") S:SDLET ^UTILITY($J,"SDLT",SDLET,A,C)=^UTILITY($J,A,C) S:'SDLET ^UTILITY($J,"NO",A,C)=SC D KLL
"RTN","SDN1",5,0)
 S SDFORM=$S($D(^DG(40.8,SDV1,"LTR")):^("LTR"),1:"") G:ANS["Y"&($D(C)) LST
"RTN","SDN1",6,0)
BC K:$D(SDLT) C S:$D(SDLT) SDT=SDBD,DATEND=SDED K ^UTILITY($J) I $D(C) K VAUTC S (VAUTC,VAUTC(C))=""
"RTN","SDN1",7,0)
 I $D(VAUTC),'VAUTC F C=0:0 S C=$O(VAUTC(C)) Q:C'>0  D:$D(SDLT) LT D CHECK1 I $T D OVER
"RTN","SDN1",8,0)
 I $D(VAUTC),'VAUTC G LST
"RTN","SDN1",9,0)
LST1 F C=0:0 S C=$O(^SC(C)) Q:C'>0  D LT,CHECK1 I $T,$S(SDV1="":1,SDV=SDV1:1,SDV="":1,1:0),'$D(SDVAUTC(+C)),$D(^SC(C,"S")) D OVER
"RTN","SDN1",10,0)
LST N SDFIRST S SDFIRST=1
"RTN","SDN1",11,0)
 F SDLET=0:0 S SDLET=$O(^UTILITY($J,"SDLT",SDLET)) Q:SDLET'>0  F A=0:0 S A=$O(^UTILITY($J,"SDLT",SDLET,A)) Q:A'>0  I $S('$D(^DPT(A,.35)):1,$P(^(.35),"^",1)']"":1,1:0) D ^SDLT,WR
"RTN","SDN1",12,0)
 I $D(^UTILITY($J,"NO")) W @IOF F A=0:0 S A=$O(^UTILITY($J,"NO",A)) Q:A'>0  F A1=0:0 S A1=$O(^(A,A1)) Q:A1'>0  Q:$$BADADR^DGUTL3(A)  W !,$P(^DPT(A,0),"^")," ",$P(^(0),"^",9)," has failed to keep the following appointment(s):" D NDT
"RTN","SDN1",13,0)
 W:$D(^UTILITY($J,"NO")) !,"However, there are no letters assigned to the clinic(s).",!!
"RTN","SDN1",14,0)
 I $D(^TMP($J,"BADADD")) D BADADD^SDLT K ^TMP($J,"BADADD")
"RTN","SDN1",15,0)
 G END
"RTN","SDN1",16,0)
OVER S GDATE=SDT Q:'$D(^SC(C,"S"))  F J=0:0 S GDATE=$O(^SC(C,"S",GDATE)) Q:GDATE=""!(GDATE>(DATEND+.9999))  F K=0:0 S K=$O(^SC(C,"S",GDATE,1,K)) Q:K=""  I $D(^(K,0)) S DFN=+^(0) D CHECK
"RTN","SDN1",17,0)
 Q
"RTN","SDN1",18,0)
END K %,%DT,%IS,A,A0,A1,A2,ALL,ALS,ANS,BY,C,CDATE,DA,DFN,DGPGM,DGVAR,DH,DHD,DIC,DIS,DIV,DIW,DIWF,DIWL,DIWR,DIWT,DO,DOW,DN,DUPE,FLDS,F,F1,FR,GDATE,I,I1,L,L0,LET,MAX,MESS,MIN,NOAP,P,POP,SC,SD,SDFOR,SDLET,SDTIME,SI,SL,SS,ST,SDSTRTDT,TO,X,Y,ADDR,B
"RTN","SDN1",19,0)
 K CLIN,HX,LL,PDAT,S,TIME,Z,D,NDATE,ENDATE,J,SDMDT,SDMSTIME,X1,X2,SDTADE,SDADTB,SDRE,SDRE1,SDIN,SDIS,SDYES,CNN,SDT,DATEND,SDV1,K,SDR,SDJ1,^UTILITY($J),SD1,SD2,SDADD,SDC,SDCL,SDCMAX,SDCONS,SDD,SDDAT,SDDIF,SDDT,SDED,SDFORM,SDHX,SDINP,SDIP
"RTN","SDN1",20,0)
 K %ZIS,Y1,SDBD,SDCT,SDVAUTC,VAUTC,SDX,SDX1,SDNOSH,SDLT1,SDMSG,SDNODE,SDQ,SDRT,SDSOH,SDSTAT,SDT0,SDZSC,SM,SM1,STARTDAY,STIME,SDV,Z0,Z5 D CLOSE^DGUTQ Q
"RTN","SDN1",21,0)
CHECK I $S('$D(^DPT(DFN,.35)):1,$P(^(.35),"^",1)']"":1,1:0),$D(^DPT(DFN,"S",GDATE,0)),$S($P(^(0),U,2)="N":1,$P(^(0),U,2)="NA":1,$D(SDCP)&$P(^(0),"^",2)["C":1,1:0),$P(^(0),"^",14)=SDTIME!(SDTIME="*"),'$D(^DPT(DFN,.1)) D
"RTN","SDN1",22,0)
 .D BAD Q:SDBAD
"RTN","SDN1",23,0)
 .D SET
"RTN","SDN1",24,0)
 Q  ;above logic changed SD*5.3*455
"RTN","SDN1",25,0)
SET I SDLT1!SDLET S ^UTILITY($J,"SDLT",$S(SDLT1:SDLT1,1:SDLET),DFN,GDATE)=C_"^"_$P(^DPT(DFN,"S",GDATE,0),"^",10) Q
"RTN","SDN1",26,0)
 S ^UTILITY($J,"NO",DFN,GDATE)=C Q
"RTN","SDN1",27,0)
CHECK1 S SDV=$P(^SC(C,0),"^",15) I $P(^(0),"^",3)="C",$S('$D(^SC(C,"I")):1,'(+^("I")):1,+^("I")>DATEND:1,+$P(^("I"),"^",2)'>DATEND&(+$P(^("I"),"^",2)):1,1:0)
"RTN","SDN1",28,0)
 Q
"RTN","SDN1",29,0)
WR K CNN F J=0:0 S J=$O(^UTILITY($J,"SDLT",SDLET,A,J)) Q:J=""  S SDR=0,SDX=J,CNN(J)=^(J),CLIN=$P(^SC(+$P(CNN(J),"^",1),0),"^",1),SDC=+CNN(J),S=$S($D(^DPT(A,"S",J,0)):^(0),1:"") D WRAPP^SDLT,SET1
"RTN","SDN1",30,0)
 D:SDR SDR D REST^SDLT Q
"RTN","SDN1",31,0)
SDR W !!,"The appointment(s) have been rescheduled as follows:",!
"RTN","SDN1",32,0)
 F J=0:0 S J=$O(CNN(J)) Q:J=""  S SDX=$P(CNN(J),"^",2),SDC=$P(CNN(J),"^") I SDX S S=$S($D(^DPT(A,"S",SDX,0)):^(0),1:"") D WRAPP^SDLT
"RTN","SDN1",33,0)
 Q
"RTN","SDN1",34,0)
SET1 S:'SDR SDR=$S($P(CNN(J),"^",2)]"":1,1:0) Q
"RTN","SDN1",35,0)
 Q
"RTN","SDN1",36,0)
LT S:'SDLT1 SDLET=0 I $D(^SC(C,"LTR")),^("LTR") S SDLET=+^("LTR")
"RTN","SDN1",37,0)
 Q
"RTN","SDN1",38,0)
NDT W !?15,$P(^SC(+^UTILITY($J,"NO",A,A1),0),"^")," on " S Y=A1 D DT^DIQ Q
"RTN","SDN1",39,0)
KLL K ^UTILITY($J,A,C) Q
"RTN","SDN1",40,0)
BAD S SDBAD=$$BADADR^DGUTL3(+DFN)
"RTN","SDN1",41,0)
 S:SDBAD ^TMP($J,"BADADD",$P(^DPT(+DFN,0),"^"),+DFN)=""
"RTN","SDN1",42,0)
 Q
"VER")
8.0^22.0
"BLD",6369,6)
^373
**END**
**END**
