Released SD*5.3*407 SEQ #327
Extracted from mail message
**KIDS**:SD*5.3*407^

**INSTALL NAME**
SD*5.3*407
"BLD",5897,0)
SD*5.3*407^SCHEDULING^0^3041215^y
"BLD",5897,1,0)
^^1^1^3041208^
"BLD",5897,1,1,0)
PRE APPT AND CLINIC CANCELLED LETTERS NOT PRINTING CORRECTLY.
"BLD",5897,4,0)
^9.64PA^^
"BLD",5897,"KRN",0)
^9.67PA^8989.52^19
"BLD",5897,"KRN",.4,0)
.4
"BLD",5897,"KRN",.401,0)
.401
"BLD",5897,"KRN",.402,0)
.402
"BLD",5897,"KRN",.403,0)
.403
"BLD",5897,"KRN",.5,0)
.5
"BLD",5897,"KRN",.84,0)
.84
"BLD",5897,"KRN",3.6,0)
3.6
"BLD",5897,"KRN",3.8,0)
3.8
"BLD",5897,"KRN",9.2,0)
9.2
"BLD",5897,"KRN",9.8,0)
9.8
"BLD",5897,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",5897,"KRN",9.8,"NM",1,0)
SDL1^^0^B12697610
"BLD",5897,"KRN",9.8,"NM",2,0)
SDCNL^^0^B19652569
"BLD",5897,"KRN",9.8,"NM","B","SDCNL",2)

"BLD",5897,"KRN",9.8,"NM","B","SDL1",1)

"BLD",5897,"KRN",19,0)
19
"BLD",5897,"KRN",19.1,0)
19.1
"BLD",5897,"KRN",101,0)
101
"BLD",5897,"KRN",409.61,0)
409.61
"BLD",5897,"KRN",771,0)
771
"BLD",5897,"KRN",870,0)
870
"BLD",5897,"KRN",8989.51,0)
8989.51
"BLD",5897,"KRN",8989.52,0)
8989.52
"BLD",5897,"KRN",8994,0)
8994
"BLD",5897,"KRN","B",.4,.4)

"BLD",5897,"KRN","B",.401,.401)

"BLD",5897,"KRN","B",.402,.402)

"BLD",5897,"KRN","B",.403,.403)

"BLD",5897,"KRN","B",.5,.5)

"BLD",5897,"KRN","B",.84,.84)

"BLD",5897,"KRN","B",3.6,3.6)

"BLD",5897,"KRN","B",3.8,3.8)

"BLD",5897,"KRN","B",9.2,9.2)

"BLD",5897,"KRN","B",9.8,9.8)

"BLD",5897,"KRN","B",19,19)

"BLD",5897,"KRN","B",19.1,19.1)

"BLD",5897,"KRN","B",101,101)

"BLD",5897,"KRN","B",409.61,409.61)

"BLD",5897,"KRN","B",771,771)

"BLD",5897,"KRN","B",870,870)

"BLD",5897,"KRN","B",8989.51,8989.51)

"BLD",5897,"KRN","B",8989.52,8989.52)

"BLD",5897,"KRN","B",8994,8994)

"BLD",5897,"QUES",0)
^9.62^^
"BLD",5897,"REQB",0)
^9.611^1^1
"BLD",5897,"REQB",1,0)
SD*5.3*340^2
"BLD",5897,"REQB","B","SD*5.3*340",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
407^3041215
"PKG",16,22,1,"PAH",1,1,0)
^^1^1^3041215
"PKG",16,22,1,"PAH",1,1,1,0)
PRE APPT AND CLINIC CANCELLED LETTERS NOT PRINTING CORRECTLY.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","SDCNL")
0^2^B19652569
"RTN","SDCNL",1,0)
SDCNL ;ALB/LDB - CANCELLED APPOINTMENT LETTER ; 25 MAR 88@13:00
"RTN","SDCNL",2,0)
 ;;5.3;Scheduling;**330,340,407**;Aug 13, 1993
"RTN","SDCNL",3,0)
 N SDBAD S (SDOK,SDV)=0 I $D(^DG(43,1,"GL")),$P(^("GL"),"^",2) S SDV=1
"RTN","SDCNL",4,0)
 G:"Cc"[S1 ASDCN
"RTN","SDCNL",5,0)
PT S (SDPT,SDINP)=0 F B=0:0 S SDPT=$O(VAUTN(SDPT)) Q:SDPT=""  D
"RTN","SDCNL",6,0)
 .S SDBAD=$$BADADR^DGUTL3(SDPT) Q:SDBAD
"RTN","SDCNL",7,0)
 .W:$D(^DPT(SDPT,.1)) !,$P(^DPT(SDPT,0),"^")," ",$P(^(0),"^",9)," is currently an inpatient!" S:$D(^DPT(SDPT,.1)) SDINP=1 D:'SDINP START S SDINP=0
"RTN","SDCNL",8,0)
 D:$O(^UTILITY($J,0)) PR Q
"RTN","SDCNL",9,0)
START F SDX=SDBD:0 S SDX=$O(^DPT(SDPT,"S",SDX)) Q:SDX>(SDED+.9999)!(SDX'>0)  S SDAP=^DPT(SDPT,"S",SDX,0),SDV2=0 I $P(SDAP,"^",2)["C" D MDIV I SDV2!'SDV S SDC=+SDAP D CHK1 I 'SDOK D CHK
"RTN","SDCNL",10,0)
 Q
"RTN","SDCNL",11,0)
PR N SDFIRST S SDFIRST=1
"RTN","SDCNL",12,0)
 S SDLET="" F A0=0:0 S SDLET=$O(^UTILITY($J,SDLET)) Q:'SDLET  S (B0,X7)="" F A1=0:0 S A5=B0,B0=$O(^UTILITY($J,SDLET,B0)) D:B0="" R Q:B0=""  D R:A5&(B0'=A5) S A=B0 D ^SDLT F A2=0:0 S X7=$O(^UTILITY($J,SDLET,B0,X7)) Q:X7=""  D S,WRAPP^SDLT
"RTN","SDCNL",13,0)
 I $D(^UTILITY($J,"NO")) D NO W:$D(DUZ) !!,"Printed by: ",$P(^VA(200,DUZ,0),"^")
"RTN","SDCNL",14,0)
 D END
"RTN","SDCNL",15,0)
 Q
"RTN","SDCNL",16,0)
END D END^SDN1 K ^UTILITY($J),A0,A1,A3,A5,ALL,B0,SDA,SDINP,SDOK,SDS,SDV,SDV21,SDX,SDX1,SDX8,Z0,Z5,ZTSK,SDAP,X7,DIC,DGPGM,DGVAR,SDPT
"RTN","SDCNL",17,0)
 K BEGDATE,DTOUT,DUOUT,ENDDATE,SDBD,SDBD1,SDCP,SDED,SDLET,SDLET1,SDV,SDV2,X8,Y Q
"RTN","SDCNL",18,0)
MDIV S SDAP=^DPT(SDPT,"S",SDX,0),SDV=$P(^SC(+SDAP,0),"^",15) I SDV=SDV1 S SDV2=1 Q
"RTN","SDCNL",19,0)
 Q
"RTN","SDCNL",20,0)
CAN S SDAP=^DPT(SDPT,"S",SDX,0),SDC=+SDAP
"RTN","SDCNL",21,0)
 S SDLET="" I $D(^SC(SDC,"LTR")),'SDLT1 S SDLET=$S('SD9:$P(^("LTR"),"^",4),1:$P(^("LTR"),"^",3))
"RTN","SDCNL",22,0)
 I 'SDLET&'SDLT1 S ^UTILITY($J,"NO",SDPT,SDC,SDX)=""
"RTN","SDCNL",23,0)
 S SDAP=^DPT(SDPT,"S",SDX,0) I SDLET!SDLT1 S ^UTILITY($J,$S(SDLET:SDLET,1:SDLT1),SDPT,SDX)=SDC
"RTN","SDCNL",24,0)
 I (SDLET!SDLT1),$P(SDAP,"^",10),$D(^DPT(SDPT,"S",$P(SDAP,"^",10))),$P(^DPT(SDPT,"S",$P(SDAP,"^",10),0),"^",2)'["C" S ^UTILITY($J,$S(SDLET:SDLET,1:SDLT1),SDPT,SDX)=$P(SDAP,"^")_"^"_$P(SDAP,"^",10)
"RTN","SDCNL",25,0)
 Q
"RTN","SDCNL",26,0)
ASDCN I 'VAUTC S SDC=0 F Z=0:0 S SDC=$O(VAUTC(SDC)) Q:SDC=""  S SDAP=SDC D ASDCN1
"RTN","SDCNL",27,0)
 G:'VAUTC PR
"RTN","SDCNL",28,0)
 I VAUTC S SDC=0 F Z=0:0 S SDC=$O(^SC(SDC)) Q:'SDC  I $P(^SC(SDC,0),"^",3)="C",$S($P(^(0),"^",15)=SDV1:1,'$P(^(0),"^",15):1,1:0),'$D(SDVAUTC(SDC)) S SDAP=SDC D ASDCN1
"RTN","SDCNL",29,0)
 G:VAUTC PR
"RTN","SDCNL",30,0)
ASDCN1 S SDX=SDBD F W=0:0 S SDX=$O(^DPT("ASDCN",SDC,SDX)) Q:(SDX>(SDED+.9))!(SDX="")  S SDPT=0 F T=0:0 S SDPT=$O(^DPT("ASDCN",SDC,SDX,SDPT)) Q:SDPT=""  I $D(^DPT(SDPT,"S",SDX,0)),$P(^(0),"^")=SDC,'$D(^DPT(SDPT,.1)) D CHK1 D:'SDOK CHK
"RTN","SDCNL",31,0)
 Q
"RTN","SDCNL",32,0)
R S SDR=0,SDX8="",SDA=A5
"RTN","SDCNL",33,0)
 F A3=0:0 S SDX8=$O(^UTILITY($J,SDLET,A5,SDX8)) Q:SDX8=""  I ^(SDX8),$P(^(SDX8),"^",2) S SDX=$P(^(SDX8),"^",2),SDC=$P(^(SDX8),"^"),(DFN,A)=A5,SDS=^DPT(DFN,"S",SDX,0) W:'SDR !!,"The rescheduled appointment(s) follow:",! D WRAPP^SDLT S SDR=1
"RTN","SDCNL",34,0)
 D REST^SDLT Q
"RTN","SDCNL",35,0)
S S A=B0,SDX=X7,SDS=^DPT(A,"S",SDX,0),SDC=+^(0) Q
"RTN","SDCNL",36,0)
NO W @IOF S SDPT=""
"RTN","SDCNL",37,0)
 F A3=0:0 S SDPT=$O(^UTILITY($J,"NO",SDPT)) Q:SDPT=""  S SDC="" F A4=0:0 S SDC=$O(^UTILITY($J,"NO",SDPT,SDC)) Q:SDC=""  D NOAP S SDAP="" F A5=0:0 S SDAP=$O(^UTILITY($J,"NO",SDPT,SDC,SDAP)) D:SDAP="" NOAP2 Q:SDAP=""  W ! D NOAP1
"RTN","SDCNL",38,0)
 Q
"RTN","SDCNL",39,0)
NOAP W !!,$P(^DPT(SDPT,0),"^")," ",$P(^(0),"^",9),!,"has the following cancelled appointment(s) in ",$P(^SC(SDC,0),"^")," CLINIC" Q
"RTN","SDCNL",40,0)
NOAP1 S Y=SDAP D DT^DIQ Q
"RTN","SDCNL",41,0)
NOAP2 W !,"but no letter is assigned to the clinic" Q
"RTN","SDCNL",42,0)
 S Y=SDAP D DT^DIQ W ! Q
"RTN","SDCNL",43,0)
 Q
"RTN","SDCNL",44,0)
CHK S DFN=SDPT D DEM^VADPT I VADM(6) D KVAR^VADPT Q
"RTN","SDCNL",45,0)
 S SDBAD=$$BADADR^DGUTL3(SDPT) Q:SDBAD
"RTN","SDCNL",46,0)
 D CAN:$D(^DPT("ASDCN",SDC,SDX,SDPT)),KVAR^VADPT Q
"RTN","SDCNL",47,0)
CHK1 S SDOK=0 I '$D(^SC(+SDAP,"S",SDX)) Q
"RTN","SDCNL",48,0)
 I $D(^SC(+SDAP,"S",SDX)) F P=0:0 S P=$O(^SC(+SDAP,"S",SDX,1,P)) Q:P'>0  I $P(^(P,0),"^")=SDPT S SDOK=1
"RTN","SDCNL",49,0)
 Q
"RTN","SDL1")
0^1^B12697610
"RTN","SDL1",1,0)
SDL1 ;BSN/GRR,ALB/LDB - PRE-APPOINTMENT LETTERS ; 7/7/04 10:45am
"RTN","SDL1",2,0)
 ;;5.3;Scheduling;**106,330,340,407**;Aug 13, 1993
"RTN","SDL1",3,0)
 ;
"RTN","SDL1",4,0)
 ;******************MODIFICATIONS***********************************
"RTN","SDL1",5,0)
 ;
"RTN","SDL1",6,0)
 ;  DATE        PATCH       DEVELOPER    DESCRIPTION
"RTN","SDL1",7,0)
 ;  ----        -----       ---------    -----------
"RTN","SDL1",8,0)
 ;  12/12/2003  SD*5.3*330  JOHN LUNDEN  FIX FORM FEED LOGIC
"RTN","SDL1",9,0)
 ;
"RTN","SDL1",10,0)
 ;******************************************************************
"RTN","SDL1",11,0)
 ;
"RTN","SDL1",12,0)
 U IO N SDBAD K ^UTILITY($J) S SDLT1=SDLET G:"Pp"'[S1 BC
"RTN","SDL1",13,0)
 I $D(VAUTN) D
"RTN","SDL1",14,0)
 .F C=0:0 S C=$O(VAUTN(C)) Q:'C  S DFN=C D
"RTN","SDL1",15,0)
 ..D BAD Q:SDBAD  D DATE
"RTN","SDL1",16,0)
 D LST Q
"RTN","SDL1",17,0)
DATE F D=SDBD:0 S D=$O(^DPT(C,"S",D)) Q:'D!(D>(SDED+.9999))  I $D(^(D,0)),$P(^(0),"^",2)'["C",$S('$D(^DPT(C,.35)):1,$P(^(.35),"^",1)']"":1,1:0) S A1=C,B1=D,D1=+^DPT(C,"S",D,0) D SET
"RTN","SDL1",18,0)
 Q
"RTN","SDL1",19,0)
APP F J=0:0 S J=$O(^UTILITY($J,L,A,J)) Q:'J  S SDX=J,SDC=^(J),S=^DPT(+A,"S",J,0) D WRAPP^SDLT
"RTN","SDL1",20,0)
 D REST^SDLT Q
"RTN","SDL1",21,0)
BC S U="^" I $D(VAUTC),'VAUTC D CL G LST
"RTN","SDL1",22,0)
ALCL F C=0:0 S C=$O(^SC(C)) Q:'C  I '$D(SDVAUTC(C)),$P(^SC(C,0),U,3)="C",$S('$D(^("I")):1,'+^("I"):1,+^("I")<SDBD&('$P(^("I"),U,2)):0,+^("I")<SDBD&($P(^("I"),U,2)>SDED):0,1:1) D NCHECK I $T D D D:$D(SDD) OVER
"RTN","SDL1",23,0)
LST N SDFIRST S SDFIRST=1       ;SD*5.3*330. Flag to determine first pag
"RTN","SDL1",24,0)
 F L=0:0 S L=$O(^UTILITY($J,L)) Q:'L  D
"RTN","SDL1",25,0)
 .F A=0:0 S A=$O(^UTILITY($J,L,A)) Q:'A  D
"RTN","SDL1",26,0)
 ..S DFN=A D BAD Q:SDBAD
"RTN","SDL1",27,0)
 ..S SDLET=L D ^SDLT,APP
"RTN","SDL1",28,0)
 D NO,END,CLOSE^DGUTQ Q
"RTN","SDL1",29,0)
CL F C=0:0 S C=$O(VAUTC(C)) Q:'C  S:'SDLT1 SDLET=0 D OVER
"RTN","SDL1",30,0)
 Q
"RTN","SDL1",31,0)
OVER Q:'$D(^SC(C,"S"))
"RTN","SDL1",32,0)
 F SDT=SDBD:0 S SDT=$O(^SC(C,"S",SDT)) Q:'SDT!(SDT>(SDED+.9999))  D
"RTN","SDL1",33,0)
 .F K=0:0 S K=$O(^SC(C,"S",SDT,1,K)) Q:'K  D
"RTN","SDL1",34,0)
 ..S DFN=+^(K,0)
"RTN","SDL1",35,0)
 ..I $P(^(0),"^",9)'["C" D BAD Q:SDBAD  D CHECK
"RTN","SDL1",36,0)
 Q
"RTN","SDL1",37,0)
END W ! K %,%H,%I,%Y,%DT,%IS,%ZIS,A,B,C,D,DN,CLIN,CNN,DATE,DATEND,DFN,DIC,DIV,DOW,GDATE,SDHX,I,J,J1,K,L,L0,PDAT,S,S1,SC,SDADD,SDFORM,SDT,SDXX,TIME,X,Y,Z,Z0,Z5 Q
"RTN","SDL1",38,0)
CHECK I $S('$D(^DPT(DFN,.35)):1,$P(^(.35),"^",1)']"":1,1:0),$D(^DPT(DFN,"S",SDT,0)),$P(^(0),"^",2)'["C",'$D(^DPT(DFN,.1)) S A1=DFN,B1=SDT,D1=C D SET
"RTN","SDL1",39,0)
 Q
"RTN","SDL1",40,0)
SET I $D(^SC(D1,"LTR"))!(SDLT1) S:'SDLT1 SDLET=$P(^SC(D1,"LTR"),"^",2) I SDLET S ^UTILITY($J,SDLET,A1,B1)=D1 S:'SDLT1 SDLET=0 K A,A1,B1,D1 Q
"RTN","SDL1",41,0)
 I 'SDLET S ^UTILITY($J,"C",A1,D1)="" K A,A1,B1,D1 Q
"RTN","SDL1",42,0)
 Q
"RTN","SDL1",43,0)
NO I $D(VAUTN),'$O(^UTILITY($J,0)),'$D(^UTILITY($J,"C")) D
"RTN","SDL1",44,0)
 .I SDBAD W !,"THIS PATIENT(S) HAS THE BAD ADDRESS INDICATOR SET AND PRE-APPOINTMENT LETTER(S) WILL NOT PRINT." Q
"RTN","SDL1",45,0)
 .W !,"NO ACTIVE APPOINTMENTS FOR THE PATIENT(S) DURING THAT TIME PERIOD!",*7
"RTN","SDL1",46,0)
 I $D(^UTILITY($J,"C")) W @IOF F X=0:0 S X=$O(^UTILITY($J,"C",X)) Q:'X  W !!,$P(^DPT(X,0),"^")," ",$P(^(0),"^",9)," HAS FUTURE APPTS., but" D NOCL
"RTN","SDL1",47,0)
 Q
"RTN","SDL1",48,0)
NOCL F XX=0:0 S XX=$O(^UTILITY($J,"C",X,XX)) Q:'XX  W !,$P(^SC(XX,0),"^")," Clinic is not assigned a PRE-APPOINTMENT LETTER"
"RTN","SDL1",49,0)
 Q
"RTN","SDL1",50,0)
D K SDD I ($P(^SC(C,0),"^",15)=SDV1)!(SDV1=$O(^DG(40.8,0))&($P(^SC(C,0),"^",15)="")) S SDD=1
"RTN","SDL1",51,0)
 Q
"RTN","SDL1",52,0)
NCHECK ;
"RTN","SDL1",53,0)
 N NOC S NOC=$P($G(^SC(C,0)),U,17)
"RTN","SDL1",54,0)
 I SDCONC="B" Q
"RTN","SDL1",55,0)
 I SDCONC="C"&(NOC="N") Q
"RTN","SDL1",56,0)
 I SDCONC="N"&(NOC="Y") Q
"RTN","SDL1",57,0)
 Q
"RTN","SDL1",58,0)
BAD S SDBAD=$$BADADR^DGUTL3(DFN)
"RTN","SDL1",59,0)
 Q
"VER")
8.0^22
**END**
**END**
