Released XU*8*207 SEQ #193
Extracted from mail message
**KIDS**:XU*8.0*207^

**INSTALL NAME**
XU*8.0*207
"BLD",350,0)
XU*8.0*207^KERNEL^0^3020508^y
"BLD",350,1,0)
^^2^2^3020508^
"BLD",350,1,1,0)
For the patch description see the patch message or the patch module on
"BLD",350,1,2,0)
Forum.
"BLD",350,4,0)
^9.64PA^8992.1^2
"BLD",350,4,8992,0)
8992
"BLD",350,4,8992,2,0)
^9.641^8992.01^1
"BLD",350,4,8992,2,8992.01,0)
ALERT DATE/TIME  (sub-file)
"BLD",350,4,8992,2,8992.01,1,0)
^9.6411^4^2
"BLD",350,4,8992,2,8992.01,1,3.01,0)
GUID FOR GUI
"BLD",350,4,8992,2,8992.01,1,4,0)
LONG INFO TEXT
"BLD",350,4,8992,222)
y^n^p^^^^n
"BLD",350,4,8992.1,0)
8992.1
"BLD",350,4,8992.1,2,0)
^9.641^8992.1^1
"BLD",350,4,8992.1,2,8992.1,0)
ALERT TRACKING  (File-top level)
"BLD",350,4,8992.1,2,8992.1,1,0)
^9.6411^4^2
"BLD",350,4,8992.1,2,8992.1,1,3.01,0)
GUID FOR GUI
"BLD",350,4,8992.1,2,8992.1,1,4,0)
LONG INFO TEXT
"BLD",350,4,8992.1,222)
y^n^p^^^^n
"BLD",350,4,"APDD",8992,8992.01)

"BLD",350,4,"APDD",8992,8992.01,3.01)

"BLD",350,4,"APDD",8992,8992.01,4)

"BLD",350,4,"APDD",8992.1,8992.1)

"BLD",350,4,"APDD",8992.1,8992.1,3.01)

"BLD",350,4,"APDD",8992.1,8992.1,4)

"BLD",350,4,"B",8992,8992)

"BLD",350,4,"B",8992.1,8992.1)

"BLD",350,"KRN",0)
^9.67PA^19^17
"BLD",350,"KRN",.4,0)
.4
"BLD",350,"KRN",.401,0)
.401
"BLD",350,"KRN",.402,0)
.402
"BLD",350,"KRN",.403,0)
.403
"BLD",350,"KRN",.5,0)
.5
"BLD",350,"KRN",.84,0)
.84
"BLD",350,"KRN",3.6,0)
3.6
"BLD",350,"KRN",3.8,0)
3.8
"BLD",350,"KRN",9.2,0)
9.2
"BLD",350,"KRN",9.8,0)
9.8
"BLD",350,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",350,"KRN",9.8,"NM",1,0)
XQALGUI^^0^B18668830
"BLD",350,"KRN",9.8,"NM",2,0)
XQALDOIT^^0^B16827192
"BLD",350,"KRN",9.8,"NM",3,0)
XQALSET^^0^B32467813
"BLD",350,"KRN",9.8,"NM",4,0)
XQALDATA^^0^B6636341
"BLD",350,"KRN",9.8,"NM","B","XQALDATA",4)

"BLD",350,"KRN",9.8,"NM","B","XQALDOIT",2)

"BLD",350,"KRN",9.8,"NM","B","XQALGUI",1)

"BLD",350,"KRN",9.8,"NM","B","XQALSET",3)

"BLD",350,"KRN",19,0)
19
"BLD",350,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",350,"KRN",19,"NM",1,0)
XQAL GUI ALERTS^^0
"BLD",350,"KRN",19,"NM","B","XQAL GUI ALERTS",1)

"BLD",350,"KRN",19.1,0)
19.1
"BLD",350,"KRN",101,0)
101
"BLD",350,"KRN",409.61,0)
409.61
"BLD",350,"KRN",771,0)
771
"BLD",350,"KRN",870,0)
870
"BLD",350,"KRN",8994,0)
8994
"BLD",350,"KRN",8994,"NM",0)
^9.68A^1^1
"BLD",350,"KRN",8994,"NM",1,0)
XQAL GUI ALERTS^^0
"BLD",350,"KRN",8994,"NM","B","XQAL GUI ALERTS",1)

"BLD",350,"KRN","B",.4,.4)

"BLD",350,"KRN","B",.401,.401)

"BLD",350,"KRN","B",.402,.402)

"BLD",350,"KRN","B",.403,.403)

"BLD",350,"KRN","B",.5,.5)

"BLD",350,"KRN","B",.84,.84)

"BLD",350,"KRN","B",3.6,3.6)

"BLD",350,"KRN","B",3.8,3.8)

"BLD",350,"KRN","B",9.2,9.2)

"BLD",350,"KRN","B",9.8,9.8)

"BLD",350,"KRN","B",19,19)

"BLD",350,"KRN","B",19.1,19.1)

"BLD",350,"KRN","B",101,101)

"BLD",350,"KRN","B",409.61,409.61)

"BLD",350,"KRN","B",771,771)

"BLD",350,"KRN","B",870,870)

"BLD",350,"KRN","B",8994,8994)

"BLD",350,"QUES",0)
^9.62^^
"BLD",350,"REQB",0)
^9.611^1^1
"BLD",350,"REQB",1,0)
XU*8.0*173^0
"BLD",350,"REQB","B","XU*8.0*173",1)

"FIA",8992)
ALERT
"FIA",8992,0)
^XTV(8992,
"FIA",8992,0,0)
8992PA
"FIA",8992,0,1)
y^n^p^^^^n
"FIA",8992,0,10)

"FIA",8992,0,11)

"FIA",8992,0,"RLRO")

"FIA",8992,0,"VR")
8.0^XU
"FIA",8992,8992)
1
"FIA",8992,8992.01)
1
"FIA",8992,8992.01,3.01)

"FIA",8992,8992.01,4)

"FIA",8992,8992.04)
0
"FIA",8992.1)
ALERT TRACKING
"FIA",8992.1,0)
^XTV(8992.1,
"FIA",8992.1,0,0)
8992.1A
"FIA",8992.1,0,1)
y^n^p^^^^n
"FIA",8992.1,0,10)

"FIA",8992.1,0,11)

"FIA",8992.1,0,"RLRO")

"FIA",8992.1,0,"VR")
8.0^XU
"FIA",8992.1,8992.1)
1
"FIA",8992.1,8992.1,3.01)

"FIA",8992.1,8992.1,4)

"FIA",8992.1,8992.14)
0
"KRN",19,745,-1)
0^1
"KRN",19,745,0)
XQAL GUI ALERTS^Kernel GUI Alerts^^B^^^^^^^^KERNEL
"KRN",19,745,1,0)
^19.06^1^1^3011003^^^^
"KRN",19,745,1,1,0)
This is the context option for the Kernel Alert components
"KRN",19,745,99.1)
58815,56304
"KRN",19,745,"RPC",0)
^19.05P^12^12
"KRN",19,745,"RPC",1,0)
XQAL GUI ALERTS
"KRN",19,745,"RPC",2,0)
XUS KEY CHECK
"KRN",19,745,"RPC",3,0)
DDR DELETE ENTRY
"KRN",19,745,"RPC",4,0)
DDR FILER
"KRN",19,745,"RPC",5,0)
DDR FIND1
"KRN",19,745,"RPC",6,0)
DDR FINDER
"KRN",19,745,"RPC",7,0)
DDR GET DD HELP
"KRN",19,745,"RPC",8,0)
DDR GETS ENTRY DATA
"KRN",19,745,"RPC",9,0)
DDR KEY VALIDATOR
"KRN",19,745,"RPC",10,0)
DDR LISTER
"KRN",19,745,"RPC",11,0)
DDR LOCK/UNLOCK NODE
"KRN",19,745,"RPC",12,0)
DDR VALIDATOR
"KRN",19,745,"U")
KERNEL GUI ALERTS
"KRN",8994,81,-1)
0^1
"KRN",8994,81,0)
XQAL GUI ALERTS^ENTRY^XQALGUI^4^^^^1
"KRN",8994,81,1,0)
^^1^1^3011003^
"KRN",8994,81,1,1,0)
This is the RPC that handles the XUAlert component
"KRN",8994,81,2,0)
^8994.02A^1^1
"KRN",8994,81,2,1,0)
DATA^2^^1^1
"KRN",8994,81,2,1,1,0)
^^4^4^3011003^
"KRN",8994,81,2,1,1,1,0)
This is the only input parameter into the ENTRY tag. DATA is subscripted,
"KRN",8994,81,2,1,1,2,0)
and the subscript contains the actual variable name (and may be a global
"KRN",8994,81,2,1,1,3,0)
reference), while the value for the variable is the value associated with
"KRN",8994,81,2,1,1,4,0)
that DATA element.
"KRN",8994,81,2,"B","DATA",1)

"KRN",8994,81,2,"PARAMSEQ",1,1)

"KRN",8994,81,3,0)
^^2^2^3011003^
"KRN",8994,81,3,1,0)
The return parameter is a global array containing the return values
"KRN",8994,81,3,2,0)
 for the type of call.
"MBREQ")
0
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",3,-1)
1^1
"PKG",3,0)
KERNEL^XU^SIGN-ON, SECURITY, MENU DRIVER, DEVICES, TASKMAN^
"PKG",3,20,0)
^9.402P^^
"PKG",3,22,0)
^9.49I^1^1
"PKG",3,22,1,0)
8.0^2950703^2990606^1
"PKG",3,22,1,"PAH",1,0)
207^3020508
"PKG",3,22,1,"PAH",1,1,0)
^^2^2^3020508
"PKG",3,22,1,"PAH",1,1,1,0)
For the patch description see the patch message or the patch module on
"PKG",3,22,1,"PAH",1,1,2,0)
Forum.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","XQALDATA")
0^4^B6636341
"RTN","XQALDATA",1,0)
XQALDATA ;ISC-SF/JLI - PROVIDE DATA ON ALERTS ;2/19/02  16:13
"RTN","XQALDATA",2,0)
 ;;8.0;KERNEL;**207**;Jul 10, 1995
"RTN","XQALDATA",3,0)
 Q
"RTN","XQALDATA",4,0)
GETUSER(ROOT,XQAUSER,FRSTDATE,LASTDATE) ;
"RTN","XQALDATA",5,0)
 S:$G(XQAUSER)'>0 XQAUSER=DUZ
"RTN","XQALDATA",6,0)
 S:$G(FRSTDATE)'>0 FRSTDATE=0
"RTN","XQALDATA",7,0)
 S:$G(LASTDATE)'>0 LASTDATE=0
"RTN","XQALDATA",8,0)
 S NCNT=0 K @ROOT
"RTN","XQALDATA",9,0)
 I FRSTDATE=0 D  Q
"RTN","XQALDATA",10,0)
 . F I=0:0 S I=$O(^XTV(8992,XQAUSER,"XQA",I)) Q:I'>0  S X=^(I,0),X3=$G(^(3)) D
"RTN","XQALDATA",11,0)
 . . S NCNT=NCNT+1
"RTN","XQALDATA",12,0)
 . . S @ROOT@(NCNT)=$S(X3'="":"G  ",$P(X,U,7,8)="^ ":"I  ",1:"   ")_$P(X,U,3)_U_$P(X,U,2)
"RTN","XQALDATA",13,0)
 . S @ROOT=NCNT
"RTN","XQALDATA",14,0)
 S XREF="R"
"RTN","XQALDATA",15,0)
 S XVAL=XQAUSER
"RTN","XQALDATA",16,0)
 D CHKTRAIL
"RTN","XQALDATA",17,0)
 Q
"RTN","XQALDATA",18,0)
GETPAT(ROOT,PATIENT,FRSTDATE,LASTDATE) ;
"RTN","XQALDATA",19,0)
 S NCNT=0 K @ROOT
"RTN","XQALDATA",20,0)
 I $G(PATIENT)'>0 S @ROOT=0 Q
"RTN","XQALDATA",21,0)
 S XREF="C"
"RTN","XQALDATA",22,0)
 S XVAL=PATIENT
"RTN","XQALDATA",23,0)
 D CHKTRAIL
"RTN","XQALDATA",24,0)
 Q
"RTN","XQALDATA",25,0)
CHKTRAIL ;
"RTN","XQALDATA",26,0)
 F XQ1=0:0 S XQ1=$O(^XTV(8992.1,XREF,XVAL,XQ1)) Q:XQ1'>0  D
"RTN","XQALDATA",27,0)
 . S X=$G(^XTV(8992.1,XQ1,0)),X1=$G(^(1)),X3=$G(^(3)) Q:X=""
"RTN","XQALDATA",28,0)
 . I FRSTDATE'>0,'$D(^XTV(8992,"AXQA",$P(X,U))) Q
"RTN","XQALDATA",29,0)
 . I FRSTDATE>0,$P(X,U,2)<FRSTDATE Q
"RTN","XQALDATA",30,0)
 . I FRSTDATE>0,LASTDATE>0,$P(X,U,2)>LASTDATE Q
"RTN","XQALDATA",31,0)
 . S NCNT=NCNT+1
"RTN","XQALDATA",32,0)
 . S @ROOT@(NCNT)=$S(X3'="":"G  ",$P(X1,U,2,3)="^":"I  ",$P(X1,U,2,3)="":"I  ",1:"   ")_$P(X1,U)_U_$P(X,U)
"RTN","XQALDATA",33,0)
 S @ROOT=NCNT
"RTN","XQALDATA",34,0)
 Q
"RTN","XQALDATA",35,0)
GETUSER1(ROOT,XQAUSER,FRSTDATE,LASTDATE) ;
"RTN","XQALDATA",36,0)
 N NCNT,KEY
"RTN","XQALDATA",37,0)
 S:$G(XQAUSER)'>0 XQAUSER=DUZ
"RTN","XQALDATA",38,0)
 S:$G(FRSTDATE)'>0 FRSTDATE=0
"RTN","XQALDATA",39,0)
 S:$G(LASTDATE)'>0 LASTDATE=0
"RTN","XQALDATA",40,0)
 S NCNT=0 K @ROOT
"RTN","XQALDATA",41,0)
 I FRSTDATE=0 D  Q
"RTN","XQALDATA",42,0)
 . N X,X2,X3,X4,I S I="" F  S I=$O(^XTV(8992,XQAUSER,"XQA",I),-1) Q:I'>0  S X=^(I,0),X2=$G(^(2)),X3=$G(^(3)),X4=$D(^(4)) D
"RTN","XQALDATA",43,0)
 . . I $P(X,U,4)'="" S $P(^XTV(8992,XQAUSER,"XQA",I,0),U,4)="" ; MARK SEEN
"RTN","XQALDATA",44,0)
 . . S NCNT=NCNT+1
"RTN","XQALDATA",45,0)
 . . S KEY=$S(X3'="":"G  ",X4>1:"L  ",$P(X,U,7,8)="^ ":"I  ",1:"R  "),@ROOT@(NCNT)=KEY_$P(X,U,3)_U_$P(X,U,2)
"RTN","XQALDATA",46,0)
 . . I X2'="" D
"RTN","XQALDATA",47,0)
 . . . S NCNT=NCNT+1,@ROOT@(NCNT)=KEY_"-----Forwarded by: "_$$GET1^DIQ(200,($P(X2,U)_","),.01)_"   Generated: "_$$DAT8^XQALERT($P(X2,U,2),1)_U_$P(X,U,2)
"RTN","XQALDATA",48,0)
 . . . I $P(X2,U,3)'="" S NCNT=NCNT+1,@ROOT@(NCNT)=KEY_"-----"_$P(X2,U,3)_U_$P(X,U,2)
"RTN","XQALDATA",49,0)
 . . . Q
"RTN","XQALDATA",50,0)
 . S @ROOT=NCNT
"RTN","XQALDATA",51,0)
 . Q
"RTN","XQALDATA",52,0)
 Q
"RTN","XQALDOIT")
0^2^B16827192
"RTN","XQALDOIT",1,0)
XQALDOIT ;ISC-SF.SEA/JLI - ALERT HANDLER ;10/25/99  09:13
"RTN","XQALDOIT",2,0)
 ;;8.0;KERNEL;**1,6,65,114,128,129,207**;Jul 10, 1995
"RTN","XQALDOIT",3,0)
 ;
"RTN","XQALDOIT",4,0)
EN ;
"RTN","XQALDOIT",5,0)
 S XQAEXIT="DOIT^XQALERT1"
"RTN","XQALDOIT",6,0)
 S XQX=^TMP("XQ",$J,"XQA1",+XQX1),XQI=^(+XQX1,1),XQZ=^(2)
"RTN","XQALDOIT",7,0)
EN1 ;
"RTN","XQALDOIT",8,0)
 S XQADATA=$S(XQZ'="":XQZ,1:$P(XQX,U,9,99)),XQAID=$P(XQX,U,2),XQA1=$P(XQAID,";"),XQX2=+XQX1,XQX1=$P(XQX1,",",2,200) I XQX1'>0 S XQK=$O(XQX1(0)) I XQK>0 S XQX1=XQX1(XQK) K XQX1(XQK)
"RTN","XQALDOIT",9,0)
 S XQAROU=""
"RTN","XQALDOIT",10,0)
 S XQAKILL=1 I XQX2,$P(XQX,U,8)'="" S XQAROU=$P(XQX,U,7,8) K:XQA1="" ^XTV(8992,DUZ,"XQA",XQI)
"RTN","XQALDOIT",11,0)
 I XQAID'="" D
"RTN","XQALDOIT",12,0)
 . S XQXX=$O(^XTV(8992.1,"B",XQAID,0)),XQXY=0,XQADAT=$$NOW^XLFDT()
"RTN","XQALDOIT",13,0)
 . I XQXX>0 S XQXY=$O(^XTV(8992.1,XQXX,20,"B",DUZ,0)) I XQXY>0,$P(^XTV(8992.1,XQXX,20,XQXY,0),U,3)="" S $P(^XTV(8992.1,XQXX,20,XQXY,0),U,3)=XQADAT
"RTN","XQALDOIT",14,0)
 . ;I $P(XQAID,";")="NO-ID" D
"RTN","XQALDOIT",15,0)
 . ;. I XQXY>0 S $P(^XTV(8992.1,XQXX,20,XQXY,0),U,4)=XQADAT,$P(^(0),U,5)=XQADAT
"RTN","XQALDOIT",16,0)
 . ;. K ^XTV(8992,XQAUSER,"XQA",XQI),^XTV(8992,"AXQA",XQAID,XQAUSER,XQI),^XTV(8992,"AXQAN",$P(XQAID,";"),XQAUSER,XQI),^XTV(8992,XQAUSER,"XQA","B",$P(XQX,U),XQI),XQAID,XQAKILL
"RTN","XQALDOIT",17,0)
 . K XQXX,XQXY
"RTN","XQALDOIT",18,0)
 I XQAROU'="",XQAROU'="^ " S XQAROUX=XQAROU D  G @XQAEXIT
"RTN","XQALDOIT",19,0)
 . N XQAROUX D @XQAROU
"RTN","XQALDOIT",20,0)
 . Q
"RTN","XQALDOIT",21,0)
 I XQAROU'="" S XQAROUX="^ " D  W !!,"Processed Alert Number ",XQX2,!?4,$P(XQX,U,3),! G @XQAEXIT
"RTN","XQALDOIT",22,0)
 . I $O(^XTV(8992,DUZ,"XQA",XQI,4,0))>0 D EN^DDIOL("",$NA(^XTV(8992,DUZ,"XQA",XQI,4)))
"RTN","XQALDOIT",23,0)
 . Q
"RTN","XQALDOIT",24,0)
 I XQX2 S XQAROUX=$P(XQX,U,7),XQMM("J")=XQAROUX_";"_$P(^DIC(19,XQY,0),U),XQRB=0 K:XQA1="" ^XTV(8992,DUZ,"XQA",XQI)
"RTN","XQALDOIT",25,0)
 K XQI,XQX,XQJ,XQK,XQXOUT,XQ1,XQII,XQA1,XQAREV,XQACNT,XQX2,%ZIS
"RTN","XQALDOIT",26,0)
 ;Need to reset count in zero node
"RTN","XQALDOIT",27,0)
 Q
"RTN","XQALDOIT",28,0)
 ;
"RTN","XQALDOIT",29,0)
ACTION(ALERTID) ;
"RTN","XQALDOIT",30,0)
 N XQAUSER
"RTN","XQALDOIT",31,0)
 S XQI=$O(^XTV(8992,"AXQA",ALERTID,DUZ,0))
"RTN","XQALDOIT",32,0)
 Q:XQI'>0
"RTN","XQALDOIT",33,0)
 S XQX=$G(^XTV(8992,DUZ,"XQA",XQI,0)) Q:XQX=""  S XQAUSER=DUZ
"RTN","XQALDOIT",34,0)
 S XQZ=$G(^XTV(8992,DUZ,"XQA",XQI,1))
"RTN","XQALDOIT",35,0)
 I $D(XQAGETAC) Q  ; just get data to return
"RTN","XQALDOIT",36,0)
 S XQAEXIT="ENDACT",XQX1=XQI
"RTN","XQALDOIT",37,0)
 I $P(XQX,U,8)'="" G EN1
"RTN","XQALDOIT",38,0)
 D EN1
"RTN","XQALDOIT",39,0)
ENDACT ;
"RTN","XQALDOIT",40,0)
 I $D(XQMM("J")) S XQMM("J")=$P(XQMM("J"),";")_";",XQALEXIT=1 D  D ^XQ74 K XQALEXIT,XQALMENU
"RTN","XQALDOIT",41,0)
 . K XQALMENU
"RTN","XQALDOIT",42,0)
 . N X S X=$P(XQMM("J"),";")
"RTN","XQALDOIT",43,0)
 . I X=+X S:$P(^DIC(19,X,0),U,4)="M" XQALMENU="" Q
"RTN","XQALDOIT",44,0)
 . S X=$O(^DIC(19,"B",X,0)) S:$P($G(^DIC(19,+X,0)),U,4)="M" XQALMENU=""
"RTN","XQALDOIT",45,0)
 I $D(XQX1),XQX1'>0 K XQX1
"RTN","XQALDOIT",46,0)
 I $D(XQAKILL) D DELETEA^XQALERT
"RTN","XQALDOIT",47,0)
 K XQAKILL,XQAROU,XQAID,XQADATA
"RTN","XQALDOIT",48,0)
 Q
"RTN","XQALDOIT",49,0)
DOOPT(OPTION) ;
"RTN","XQALDOIT",50,0)
 N XQX1,XQAKILL,XQAROU,XQADATA,XQAID,XQMM
"RTN","XQALDOIT",51,0)
 S XQMM("J")=OPTION
"RTN","XQALDOIT",52,0)
 D ENDACT
"RTN","XQALDOIT",53,0)
 Q
"RTN","XQALDOIT",54,0)
 ;
"RTN","XQALDOIT",55,0)
PRINT ;
"RTN","XQALDOIT",56,0)
 S XQIJ=$$NOW^XLFDT(),%ZIS="MQ" D ^%ZIS Q:POP  I $D(IO("Q")) K IO("Q") S ZTRTN="DQ^XQALDOIT",ZTIO=ION,ZTSAVE("XQIJ")="",ZTSAVE("^TMP(""XQ"",$J,""XQA2"",")="" D ^%ZTLOAD K ZTSK,ZTRTN,ZTIO,ZTSAVE Q
"RTN","XQALDOIT",57,0)
DQ ;
"RTN","XQALDOIT",58,0)
 U IO W @IOF,!!?10,"PENDING ALERTS  "_$P(^VA(200,+^XTV(8992,DUZ,0),0),U)_"   "_$E(XQIJ,4,5)_"/"_$E(XQIJ,6,7)_"/"_$E(XQIJ,2,3)_"  "_$E($P(XQIJ,".",2)_"00",1,2)_":"_$E($P(XQIJ,".",2)_"0000",3,4),!!
"RTN","XQALDOIT",59,0)
 F XQIJ=0:0 S XQIJ=$O(^TMP("XQ",$J,"XQA2",XQIJ)) Q:XQIJ'>0  W !,^(XQIJ,0)
"RTN","XQALDOIT",60,0)
 D ^%ZISC K XQIJ W:'$D(ZTQUEUED) !!
"RTN","XQALDOIT",61,0)
 Q
"RTN","XQALDOIT",62,0)
MORP K ^TMP("XQ",$J,"XQA2") S XQIK=0 F XQIJ=0:0 S XQIJ=$O(^TMP("XQ",$J,"XQA",XQIJ)) Q:XQIJ'>0  S XQIK=XQIK+1,XQIX=^(XQIJ),^TMP("XQ",$J,"XQA2",XQIK,0)=$J(XQIK,3)_". "_$P(XQIX,U,3)
"RTN","XQALDOIT",63,0)
 K XQIK,XQIX,XQIJ
"RTN","XQALDOIT",64,0)
 Q
"RTN","XQALDOIT",65,0)
MAIL ;
"RTN","XQALDOIT",66,0)
 S XMTEXT="^TMP(""XQ"",$J,""XQA2"",",XMSUB="LIST OF PENDING ALERTS",XMY(DUZ)="",XMDUZ=.5 D ^XMD K XMTEXT,XMSUB,XMDUZ,XMY W !!,"Message will be delivered as NEW mail to YOU.",!!
"RTN","XQALDOIT",67,0)
 Q
"RTN","XQALGUI")
0^1^B18668830
"RTN","XQALGUI",1,0)
XQALGUI ; SFCIOFO/JLI - KERNEL COMPONENTS FOR ALERTS ;3/15/02  11:24
"RTN","XQALGUI",2,0)
 ;;8.0;KERNEL;**207**;Jul 10, 1995
"RTN","XQALGUI",3,0)
 ;
"RTN","XQALGUI",4,0)
 ;  added CURRSURO and SETSURO entry points  3/21/00  jli
"RTN","XQALGUI",5,0)
 ;
"RTN","XQALGUI",6,0)
 ; All entry is at the ENTRY tag.  The type of processing is indicated by the
"RTN","XQALGUI",7,0)
 ; variable LOC which contains the name of the tag to be used for processing.
"RTN","XQALGUI",8,0)
 ; The following tags currently exist and expect the variable names indicated
"RTN","XQALGUI",9,0)
 ;
"RTN","XQALGUI",10,0)
 ;  SEND
"RTN","XQALGUI",11,0)
 ;  GETLIST
"RTN","XQALGUI",12,0)
 ;  ISPEND
"RTN","XQALGUI",13,0)
 ;  ISNEW
"RTN","XQALGUI",14,0)
 ;  DELETE
"RTN","XQALGUI",15,0)
 ;  FORWARD
"RTN","XQALGUI",16,0)
 ;  CURRSURO
"RTN","XQALGUI",17,0)
 ;  SETSURO
"RTN","XQALGUI",18,0)
 ;
"RTN","XQALGUI",19,0)
ENTRY(XQALRSLT,DATA) ;
"RTN","XQALGUI",20,0)
 K ^TMP($J) N I,LOC,XQA,XQACTMSG,XQAEND,XQAID,XQALFWD,XQALRSL1,XQAMSG,XQASTART,XQASURO,XQATEXT
"RTN","XQALGUI",21,0)
 N NAME,XQALSTO S NAME="" S XQALSTO=$NA(^TMP("XQALXQAL",$J)) K @XQALSTO
"RTN","XQALGUI",22,0)
 F  S NAME=$O(DATA(NAME)) Q:NAME=""  D  I $E(NAME)'=U S @("^TMP(""XQALXQAL"",$J,"_NAME1_")")=DATA(NAME)
"RTN","XQALGUI",23,0)
 . I $E(NAME)=U S @NAME=DATA(NAME) Q
"RTN","XQALGUI",24,0)
 . S NAME1=""""
"RTN","XQALGUI",25,0)
 . F I=1:1 S X=$P(NAME,",",I) Q:X=""  S NAME1=NAME1_$S(I>1:",""",1:"")_X_""""
"RTN","XQALGUI",26,0)
 S NAME="" F  S NAME=$O(@XQALSTO@(NAME)) Q:NAME=""  D:$D(@XQALSTO@(NAME))>1  I $D(@XQALSTO@(NAME))=1 N @NAME S @NAME=@XQALSTO@(NAME)
"RTN","XQALGUI",27,0)
 . N NAME1 S NAME1=""
"RTN","XQALGUI",28,0)
 . F  S NAME1=$O(@XQALSTO@(NAME,NAME1)) Q:NAME1=""  S @(NAME_"("""_NAME1_""")")=^(NAME1)
"RTN","XQALGUI",29,0)
 Q:'$D(LOC)
"RTN","XQALGUI",30,0)
 ; need to add code here to check key if XQAUSER is defined and not DUZ
"RTN","XQALGUI",31,0)
 G @LOC
"RTN","XQALGUI",32,0)
 ;
"RTN","XQALGUI",33,0)
2 ;
"RTN","XQALGUI",34,0)
SEND ;
"RTN","XQALGUI",35,0)
SETUP ; ENTRY FOR SETUP NEW ALERT
"RTN","XQALGUI",36,0)
 I '$D(XQAUSER) S XQAUSER=DUZ
"RTN","XQALGUI",37,0)
 Q:($O(XQA(""))="")  Q:'$D(XQAMSG)
"RTN","XQALGUI",38,0)
 I $D(^TMP($J,"XQAL1")) S XQATEXT=$NA(^TMP($J,"XQAL1"))
"RTN","XQALGUI",39,0)
 D SETUP^XQALERT ; Supported Reference
"RTN","XQALGUI",40,0)
 Q
"RTN","XQALGUI",41,0)
 ;
"RTN","XQALGUI",42,0)
GETLIST ; GET LIST OF ALERTS FOR USER
"RTN","XQALGUI",43,0)
 I '$D(XQAUSER) S XQAUSER=DUZ
"RTN","XQALGUI",44,0)
 S XQALRSLT=$NA(^TMP($J)),XQALRSL1=$NA(^TMP("XQALXQAL",$J)) K @XQALRSL1,@XQALRSLT
"RTN","XQALGUI",45,0)
 D GETUSER1^XQALDATA(XQALRSL1,XQAUSER) ;
"RTN","XQALGUI",46,0)
 F I=0:0 S I=$O(@XQALRSL1@(I)) Q:I'>0  S X=^(I) K ^(I) S @XQALRSLT@(I)=X
"RTN","XQALGUI",47,0)
 Q
"RTN","XQALGUI",48,0)
 ;
"RTN","XQALGUI",49,0)
ISPEND ;
"RTN","XQALGUI",50,0)
 S XQALRSLT=$NA(^TMP($J,"XQALXQAL")) K @XQALRSLT
"RTN","XQALGUI",51,0)
 I $O(^XTV(8992,DUZ,"XQA",0))>0 S @XQALRSLT@(1)=1
"RTN","XQALGUI",52,0)
 E  S @XQALRSLT@(1)=0
"RTN","XQALGUI",53,0)
 Q
"RTN","XQALGUI",54,0)
 ;
"RTN","XQALGUI",55,0)
ISNEW ;
"RTN","XQALGUI",56,0)
 S XQALRSLT=$NA(^TMP($J,"XQALXQAL")) K @XQALRSLT
"RTN","XQALGUI",57,0)
 S @XQALRSLT@(1)=0
"RTN","XQALGUI",58,0)
 F I=0:0 S I=$O(^XTV(8992,DUZ,"XQA",I)) Q:I'>0  I $P($G(^(I,0)),U,4)>0 S @XQALRSLT@(1)=1 Q
"RTN","XQALGUI",59,0)
 Q
"RTN","XQALGUI",60,0)
 ;
"RTN","XQALGUI",61,0)
DELETE ;
"RTN","XQALGUI",62,0)
 I '$D(XQAUSER) S XQAUSER=DUZ
"RTN","XQALGUI",63,0)
 D DELETE^XQALERT
"RTN","XQALGUI",64,0)
 Q
"RTN","XQALGUI",65,0)
 ;
"RTN","XQALGUI",66,0)
FORWARD ;
"RTN","XQALGUI",67,0)
 I '$D(XQAUSER) N XQAUSER S XQAUSER=DUZ
"RTN","XQALGUI",68,0)
 S XQALFWD(1)=IEN
"RTN","XQALGUI",69,0)
 D FORWARD^XQALFWD(.XQALFWD,.XQA,"A",$G(XQACTMSG))
"RTN","XQALGUI",70,0)
 Q
"RTN","XQALGUI",71,0)
 ;
"RTN","XQALGUI",72,0)
GETSURO ; GET CURRENT SURROGATE INFORMATION (IF ANY)
"RTN","XQALGUI",73,0)
 I '$D(XQAUSER) S XQAUSER=DUZ
"RTN","XQALGUI",74,0)
 N X S X=$$GETSURO^XQALSURO(XQAUSER) I X'>0 S X="" ; SUPPORTED REFERENCE
"RTN","XQALGUI",75,0)
 S XQALRSLT=$NA(^TMP($J,"XQALXQAL")) K @XQALRSLT
"RTN","XQALGUI",76,0)
 S @XQALRSLT@(1)=X
"RTN","XQALGUI",77,0)
 Q
"RTN","XQALGUI",78,0)
 ;
"RTN","XQALGUI",79,0)
SETSURO ; SET NEW SURROGATE
"RTN","XQALGUI",80,0)
 Q:XQASURO'>0
"RTN","XQALGUI",81,0)
 I '$D(XQAUSER) S XQAUSER=DUZ
"RTN","XQALGUI",82,0)
 S XQALRSLT=$NA(^TMP("XQALRSLT",$J)) K @XQALRSLT
"RTN","XQALGUI",83,0)
 S @XQALRSLT@(1)=$$SETSURO1^XQALSURO(XQAUSER,XQASURO,XQASTART,XQAEND) ; SUPPORTED REFERENCE
"RTN","XQALGUI",84,0)
 Q
"RTN","XQALGUI",85,0)
 ;
"RTN","XQALGUI",86,0)
SUROFOR ;
"RTN","XQALGUI",87,0)
 N SUROLIST S XQALRSLT=$NA(^TMP("XQALRSLT",$J)) K @XQALRSLT
"RTN","XQALGUI",88,0)
 I '$D(XQAUSER) S XQAUSER=DUZ
"RTN","XQALGUI",89,0)
 D SUROFOR^XQALSURO(.SUROLIST,XQAUSER)
"RTN","XQALGUI",90,0)
 M @XQALRSLT=SUROLIST
"RTN","XQALGUI",91,0)
 Q
"RTN","XQALGUI",92,0)
 Q
"RTN","XQALGUI",93,0)
 ;
"RTN","XQALGUI",94,0)
REMVSURO ; REMOVE SURROGATE
"RTN","XQALGUI",95,0)
 I '$D(XQAUSER) S XQAUSER=DUZ
"RTN","XQALGUI",96,0)
 D REMVSURO^XQALSURO(XQAUSER) ; SUPPORTED REFERENCE
"RTN","XQALGUI",97,0)
 Q
"RTN","XQALGUI",98,0)
 ;
"RTN","XQALGUI",99,0)
GETDATA ;
"RTN","XQALGUI",100,0)
 S XQALRSLT=$NA(^TMP("XQALRSLT",$J)) K @XQALRSLT
"RTN","XQALGUI",101,0)
 N IEN S IEN=$O(^XTV(8992,"AXQA",XQAID,DUZ,0)) Q:IEN'>0
"RTN","XQALGUI",102,0)
 S @XQALRSLT@(1)=$P(^XTV(8992,DUZ,"XQA",IEN,0),U,7,8)
"RTN","XQALGUI",103,0)
 S @XQALRSLT@(2)=$G(^XTV(8992,DUZ,"XQA",IEN,1))
"RTN","XQALGUI",104,0)
 S @XQALRSLT@(3)=$G(^XTV(8992,DUZ,"XQA",IEN,3))
"RTN","XQALGUI",105,0)
 Q
"RTN","XQALGUI",106,0)
 ;
"RTN","XQALGUI",107,0)
GETLONG ; TAKE LONG TEXT BACK TO THE CLIENT
"RTN","XQALGUI",108,0)
 S XQALRSLT=$NA(^TMP("XQALRSLT",$J)) K @XQALRSLT
"RTN","XQALGUI",109,0)
 I '$D(XQAUSER) N XQAUSER S XQAUSER=DUZ
"RTN","XQALGUI",110,0)
 N IEN,IENS,XQALTMP S IEN=$O(^XTV(8992,"AXQA",XQAID,XQAUSER,0)) Q:IEN'>0
"RTN","XQALGUI",111,0)
 S IENS=IEN_","_XQAUSER_",",XQALTMP=$NA(^TMP($J)) K @XQALTMP
"RTN","XQALGUI",112,0)
 D GETS^DIQ(8992.01,(IEN_","_XQAUSER_","),"4","",XQALTMP)
"RTN","XQALGUI",113,0)
 F I=0:0 S I=$O(@XQALTMP@(8992.01,IENS,4,I)) Q:I'>0  S @XQALRSLT@(I)=^(I)
"RTN","XQALGUI",114,0)
 K @XQALTMP
"RTN","XQALGUI",115,0)
 Q
"RTN","XQALGUI",116,0)
 ;
"RTN","XQALGUI",117,0)
CHKADPAC ; Check for ADPAC or IRM status
"RTN","XQALGUI",118,0)
 S XQALRSLT=$NA(^TMP("XQALRSLT",$J)) K @XQALRSLT
"RTN","XQALGUI",119,0)
 N XQALVAL,RESULT S XQALVAL=0
"RTN","XQALGUI",120,0)
 D OWNSKEY^XUSRB(.RESULT,"XQAL-DELETE") S XQALVAL=RESULT(0)
"RTN","XQALGUI",121,0)
 S @XQALRSLT@(1)=XQALVAL
"RTN","XQALGUI",122,0)
 Q
"RTN","XQALGUI",123,0)
 ;
"RTN","XQALSET")
0^3^B32467813
"RTN","XQALSET",1,0)
XQALSET ;ISC-SF.SEA/JLI - SETUP ALERTS ;04/16/02  12:03
"RTN","XQALSET",2,0)
 ;;8.0;KERNEL;**1,6,65,75,114,125,173,207**;Jul 10, 1995
"RTN","XQALSET",3,0)
 ;;
"RTN","XQALSET",4,0)
 Q
"RTN","XQALSET",5,0)
 ;
"RTN","XQALSET",6,0)
SETUP Q:$O(XQA(0))=""  Q:'($D(XQAMSG)#2)  Q:XQAMSG=""
"RTN","XQALSET",7,0)
 N X,XQI,XQJ,XQX,XQK,XQACOMNT,XQARESET,DA,XQADA
"RTN","XQALSET",8,0)
 S XQAOPT1=$S('($D(XQAROU)#2):U,XQAROU'[U:U_XQAROU,1:XQAROU),XQAOPT1=$S(XQAOPT1'=U:XQAOPT1,$D(XQAOPT)#2:XQAOPT_U,1:XQAOPT1) S:XQAOPT1=U XQAOPT1=U_" "
"RTN","XQALSET",9,0)
NOW S XQX=$$NOW^XLFDT()
"RTN","XQALSET",10,0)
 S:$S('$D(XQAID):1,XQAID="":1,1:0) XQAID="NO-ID" S:XQAID[";" XQAID=$P(XQAID,";") S XQA1=XQAID,XQI=XQX
"RTN","XQALSET",11,0)
 I XQA1'="" F  S XQAID=XQA1_";"_DUZ_";"_XQI L +^XTV(8992,"AXQA",XQAID):10 D  L -^XTV(8992,"AXQA",XQAID) Q:XQI=""  S XQI=XQI+.00000001
"RTN","XQALSET",12,0)
 . I $D(^XTV(8992,"AXQA",XQAID)) Q
"RTN","XQALSET",13,0)
 . S ^XTV(8992,"AXQA",XQAID,0,0)="",XQI=""
"RTN","XQALSET",14,0)
 I XQAID'="" D
"RTN","XQALSET",15,0)
 . N FDA,IENS,XQA2,DIERR
"RTN","XQALSET",16,0)
 . S XQA2=XQA1 I XQA2[",",$P(XQA2,",",3)'="" S XQA2=$P(XQA2,",")_","_$P(XQA2,",",3)
"RTN","XQALSET",17,0)
 . F  D  Q:'$D(DIERR)  Q:'$D(^TMP("DIERR",$J,"E",111))
"RTN","XQALSET",18,0)
 . . K DIERR,^TMP("DIERR",$J)
"RTN","XQALSET",19,0)
 . . S FDA=$NA(^TMP($J,"XQALSET")) K @FDA
"RTN","XQALSET",20,0)
 . . S @FDA@(8992.1,"+1,",.01)=XQAID D UPDATE^DIE("",FDA,"IENS")
"RTN","XQALSET",21,0)
 . . K @FDA
"RTN","XQALSET",22,0)
 . I $D(DIERR) S XQDIERR1=DIERR M XQDIERR=^TMP("DIERR",$J) Q
"RTN","XQALSET",23,0)
 . Q:IENS(1)'>0  S (DA,XQADA)=IENS(1)
"RTN","XQALSET",24,0)
 . S IENS=IENS(1)_",",@FDA@(8992.1,IENS,.02)=XQX,^(.03)=XQA2,^(.05)=DUZ,^(1.01)=XQAMSG
"RTN","XQALSET",25,0)
 . I $D(XQAARCH) S X=$$FMADD^XLFDT(DT,XQAARCH) I X>DT S @FDA@(8992.1,IENS,.08)=X
"RTN","XQALSET",26,0)
 . I $P(XQA1,",",2)>0 S @FDA@(8992.1,IENS,.04)=$P(XQA1,",",2)
"RTN","XQALSET",27,0)
 . I $D(ZTQUEUED) S @FDA@(8992.1,IENS,.06)=1
"RTN","XQALSET",28,0)
 . I $D(XQAOPT)#2 S @FDA@(8992.1,IENS,1.02)=XQAOPT
"RTN","XQALSET",29,0)
 . I $D(XQAROU)#2 N XQAXX S XQAXX=$S(XQAROU[U:XQAROU,1:U_XQAROU) I $P(XQAXX,U,2)'="" S:$P(XQAXX,U)'="" @FDA@(8992.1,IENS,1.03)=$P(XQAXX,U) S @FDA@(8992.1,IENS,1.04)=$P(XQAXX,U,2)
"RTN","XQALSET",30,0)
 . I $D(XQACTMSG) S @FDA@(8992.1,IENS,1.05)=XQACTMSG
"RTN","XQALSET",31,0)
 . I $D(XQADATA) S @FDA@(8992.1,IENS,2)=XQADATA
"RTN","XQALSET",32,0)
 . I $D(XQAGUID) S @FDA@(8992.1,IENS,3.01)=XQAGUID
"RTN","XQALSET",33,0)
 . D FILE^DIE("KS",FDA)
"RTN","XQALSET",34,0)
 . I $D(XQATEXT) D WP^DIE(8992.1,IENS,4,"",XQATEXT)
"RTN","XQALSET",35,0)
REENT S XQALIN1=$S($D(XQAID)#2:XQAID,1:"")_U_$E(XQAMSG,1,80)_"^1^"_$S(XQAOPT1=U:"D",1:"R")_U_$S($D(XQACTMSG):$E(XQACTMSG,1,40),1:"")_U_XQAOPT1
"RTN","XQALSET",36,0)
 S:$D(XQACNDEL) $P(XQALIN1,U,9)=1 S:$D(XQASURO) $P(XQALIN1,U,12)=XQASURO S:$D(XQASUPV) $P(XQALIN1,U,13)=XQASUPV S:$D(XQAREVUE) $P(XQALIN1,U,14)=XQAREVUE
"RTN","XQALSET",37,0)
 S XQALIN=XQX_U_XQALIN1,XQJ=0
"RTN","XQALSET",38,0)
 K XQALIN1 S:$D(XQADATA) XQALIN1=XQADATA
"RTN","XQALSET",39,0)
LOOP1 S XQJ=$O(XQA(" ")) I XQJ'="" K:"G.g."'[$E(XQJ_",,",1,2) XQA(XQJ) D:$D(XQA(XQJ)) GROUP G LOOP1
"RTN","XQALSET",40,0)
 ;
"RTN","XQALSET",41,0)
 ; The following section of code was added to provide a generalized way to handle surrogates
"RTN","XQALSET",42,0)
 ;
"RTN","XQALSET",43,0)
 F XQJ=0:0 S XQJ=$O(XQA(XQJ)) Q:XQJ=""  D
"RTN","XQALSET",44,0)
 . N X S X=$G(^XTV(8992,XQJ,0))
"RTN","XQALSET",45,0)
 . I $$CURRSURO^XQALSURO(XQJ)>0 D  ;                   Surrogate specified
"RTN","XQALSET",46,0)
 . . N DATE,NOW S NOW=$$NOW^XLFDT() ; Get current Date/Time to check date/times if present
"RTN","XQALSET",47,0)
 . . S DATE=$P(X,U,3) I DATE>0,DATE>NOW Q  ; Period for surrogate hasn't started yet
"RTN","XQALSET",48,0)
 . . S X=+$P(X,U,2) ;                        Get surrogate value (Pointer to file 200)
"RTN","XQALSET",49,0)
 . . S XQA(X)="" K XQA(XQJ) ; Add Surrogate to XQA array, delete XQJ entry
"RTN","XQALSET",50,0)
 . . I X<XQJ S XQJ=X-1 ; Make sure surrogate gets checked also
"RTN","XQALSET",51,0)
 . . Q
"RTN","XQALSET",52,0)
 . Q
"RTN","XQALSET",53,0)
 ;
"RTN","XQALSET",54,0)
 ; End of surrogate specific code
"RTN","XQALSET",55,0)
 S XQJ=0
"RTN","XQALSET",56,0)
LOOP S XQJ=$O(XQA(XQJ)) G:XQJ="" WRAP
"RTN","XQALSET",57,0)
 I '(+$$ACTIVE^XUSER(XQJ)) K XQA(XQJ) G LOOP ;Don't send to users that can't sign-on
"RTN","XQALSET",58,0)
 I $G(XQADA)>0 L +^XTV(8992.1,XQADA):10 D
"RTN","XQALSET",59,0)
 . N XQATOP S XQATOP=$S($D(^XTV(8992.1,XQADA,20,0)):$P(^(0),U,4),1:0)+1 S ^(0)="^8992.11^"_XQJ_U_XQATOP
"RTN","XQALSET",60,0)
 . S ^XTV(8992.1,XQADA,20,XQATOP,0)=XQJ,^XTV(8992.1,"R",XQJ,XQADA,XQATOP)="",^XTV(8992.1,XQADA,20,"B",XQJ,XQATOP)="" I $D(XQARESET) S $P(^XTV(8992.1,XQADA,20,XQATOP,0),U,7,8)=XQAUSER_U_XQX
"RTN","XQALSET",61,0)
 . Q
"RTN","XQALSET",62,0)
 I '$D(^XTV(8992,XQJ,0)) D
"RTN","XQALSET",63,0)
 . N FDA,IENS
"RTN","XQALSET",64,0)
 . F  D  Q:'$D(DIERR)  Q:'$D(^TMP("DIERR",$J,"E",110))&'$D(^TMP("DIERR",$J,"E",111))
"RTN","XQALSET",65,0)
 . . K DIERR,^TMP("DIERR",$J)
"RTN","XQALSET",66,0)
 . . S FDA=$NA(^TMP($J,"XQALSET")) K @FDA S @FDA@(8992,"+1,",.01)=XQJ
"RTN","XQALSET",67,0)
 . . S IENS(1)=XQJ
"RTN","XQALSET",68,0)
 . . D UPDATE^DIE("S",FDA,"IENS")
"RTN","XQALSET",69,0)
 L +^XTV(8992,XQJ):10 S XQXI=XQX S:'$D(^XTV(8992,XQJ,"XQA",0)) ^(0)="^8992.01DA^"
"RTN","XQALSET",70,0)
REP I $D(^XTV(8992,XQJ,"XQA",XQXI,0)) S XQXI=XQXI+.00000001 G REP
"RTN","XQALSET",71,0)
 S ^XTV(8992,XQJ,"XQA",XQXI,0)=XQALIN S:$D(XQALIN1) ^(1)=XQALIN1 S:$D(XQAGUID) ^(3)=XQAGUID S:$D(XQARESET) ^(2)=XQAUSER_U_XQX_U_$G(XQACOMNT) S ^(0)=$P(^XTV(8992,XQJ,"XQA",0),U,1,2)_U_XQXI_U_($P(^(0),U,4)+1)
"RTN","XQALSET",72,0)
 I $D(XQATEXT) D WP^DIE(8992.01,(XQXI_","_XQJ_","),4,"",XQATEXT)
"RTN","XQALSET",73,0)
 L -^XTV(8992,XQJ) L:$G(XQADA)>0 -^XTV(8992.1,XQADA)
"RTN","XQALSET",74,0)
 K XQA(XQJ) S:XQAID'="" ^XTV(8992,"AXQA",XQAID,XQJ,XQXI)="",^XTV(8992,"AXQAN",XQA1,XQJ,XQXI)=""
"RTN","XQALSET",75,0)
 G LOOP
"RTN","XQALSET",76,0)
WRAP K:XQAID'="" ^XTV(8992,"AXQA",XQAID,0,0) K XQA,XQALIN,XQALIN1,XQAMSG,XQAID,XQAFLG,XQAOPT,XQAOPT1,XQAROU,XQADATA,XQI,XQX,XQJ,XQK,XQA1,XQACTMSG,XQJ,XQXI,XQAARCH,XQACNDEL,XQAREVUE,XQASUPV,XQASURO
"RTN","XQALSET",77,0)
 Q
"RTN","XQALSET",78,0)
 ;
"RTN","XQALSET",79,0)
GROUP S XQL="" F XQI=3:1:$L(XQJ) S XQL1=$E(XQJ,XQI) S:XQL1?1L XQL1=$C($A(XQL1)-32) S XQL=XQL_XQL1
"RTN","XQALSET",80,0)
 S XQI=$O(^XMB(3.8,"B",XQL,0)) I XQI'>0 S XQL1=$O(^XMB(3.8,"B",XQL)) I $E(XQL1,1,$L(XQL))=XQL S XQL2=$O(^(XQL1)) I $E(XQL2,1,$L(XQL))'=XQL S XQI=$O(^(XQL1,0))
"RTN","XQALSET",81,0)
 I XQI>0 F XQL=0:0 S XQL=$O(^XMB(3.8,XQI,1,XQL)) Q:XQL'>0  S XQA(+^(XQL,0))=""
"RTN","XQALSET",82,0)
 K XQA(XQJ),XQI,XQL,XQL1,XQL2
"RTN","XQALSET",83,0)
 Q
"RTN","XQALSET",84,0)
 ;
"RTN","XQALSET",85,0)
RESETUP(XQAIDVAL,XQA,XQACOMNT) ;
"RTN","XQALSET",86,0)
 N XQAIEN,DA,XQI,XQJ,XQK,XQX,X,X1,X3,XQARESET,XQAID,XQA1,XQADA,XQAOPT1,XQAMSG,XQACTMSG,XQADATA,XQAGUID
"RTN","XQALSET",87,0)
 S:'$D(XQAUSER) XQAUSER=DUZ
"RTN","XQALSET",88,0)
 S XQARESET=1
"RTN","XQALSET",89,0)
 S XQAIEN=$O(^XTV(8992,"AXQA",XQAIDVAL,XQAUSER,0)) Q:XQAIEN'>0
"RTN","XQALSET",90,0)
 S X=$G(^XTV(8992,XQAUSER,"XQA",XQAIEN,0)),X1=$G(^(1)),X3=$G(^(3))
"RTN","XQALSET",91,0)
 Q:X=""
"RTN","XQALSET",92,0)
 S XQAID=$P(X,U,2),XQA1=$P(XQAID,";"),XQADA=$O(^XTV(8992.1,"B",XQAID,0))
"RTN","XQALSET",93,0)
 S XQAOPT1=$P(X,U,7,8),XQAMSG=$P(X,U,3),XQACTMSG=$P(X,U,6)
"RTN","XQALSET",94,0)
 S XQADATA=$S(X1'="":X1,1:$P(X,U,9,100)) I $P(X3,U)'="" S XQAGUID=$P(X3,U)
"RTN","XQALSET",95,0)
 S XQX=$$NOW^XLFDT()
"RTN","XQALSET",96,0)
 D REENT
"RTN","XQALSET",97,0)
 Q
"UP",8992,8992.01,-1)
8992^XQA
"UP",8992,8992.01,0)
8992.01
"UP",8992,8992.04,-2)
8992^XQA
"UP",8992,8992.04,-1)
8992.01^4
"UP",8992,8992.04,0)
8992.04
"UP",8992.1,8992.14,-1)
8992.1^4
"UP",8992.1,8992.14,0)
8992.14
"VER")
8.0^22.0
"^DD",8992,8992.01,3.01,0)
GUID FOR GUI^F^^3;1^K:$L(X)>38!($L(X)<38) X
"^DD",8992,8992.01,3.01,3)
Answer must be a GUID - 38 characters in length
"^DD",8992,8992.01,3.01,21,0)
^^8^8^3000126^
"^DD",8992,8992.01,3.01,21,1,0)
This field contains a Globally Unique IDentifier (GUID) which is used to
"^DD",8992,8992.01,3.01,21,2,0)
identify the application which should be used in a graphical user
"^DD",8992,8992.01,3.01,21,3,0)
interface environment (windows) to process the alert.  This application
"^DD",8992,8992.01,3.01,21,4,0)
must implement the IVAlert interface.  The GUID should be of the form
"^DD",8992,8992.01,3.01,21,5,0)
 
"^DD",8992,8992.01,3.01,21,6,0)
  {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}
"^DD",8992,8992.01,3.01,21,7,0)
 
"^DD",8992,8992.01,3.01,21,8,0)
where each x is a hexadecimal digit (0 through 9 or A through F).
"^DD",8992,8992.01,3.01,"DT")
3000126
"^DD",8992,8992.01,4,0)
LONG INFO TEXT^8992.04^^4;0
"^DD",8992,8992.04,0)
LONG INFO TEXT SUB-FIELD^^.01^1
"^DD",8992,8992.04,0,"DT")
3000126
"^DD",8992,8992.04,0,"NM","LONG INFO TEXT")

"^DD",8992,8992.04,0,"UP")
8992.01
"^DD",8992,8992.04,.01,0)
LONG INFO TEXT^W^^0;1
"^DD",8992,8992.04,.01,3)
This field is used to enter multiple lines of text for a longer INFO only alert
"^DD",8992,8992.04,.01,"DT")
3000126
"^DD",8992.1,8992.1,3.01,0)
GUID FOR GUI^F^^3;1^K:$L(X)>38!($L(X)<38) X
"^DD",8992.1,8992.1,3.01,3)
Answer must be a 38 character GUID {.......}
"^DD",8992.1,8992.1,3.01,21,0)
^^8^8^3010703^
"^DD",8992.1,8992.1,3.01,21,1,0)
This field contains a Globally Unique IDentifier (GUID) which is used to
"^DD",8992.1,8992.1,3.01,21,2,0)
identify the application which should be used in a graphical user
"^DD",8992.1,8992.1,3.01,21,3,0)
interface environment (windows) to process the alert.  This application
"^DD",8992.1,8992.1,3.01,21,4,0)
must implement the IVAlert interface.  The GUID should be of the form
"^DD",8992.1,8992.1,3.01,21,5,0)
 
"^DD",8992.1,8992.1,3.01,21,6,0)
  {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}
"^DD",8992.1,8992.1,3.01,21,7,0)
 
"^DD",8992.1,8992.1,3.01,21,8,0)
where each x is a hexadecimal digit (0 through 9 or A through F).
"^DD",8992.1,8992.1,3.01,"DT")
3010703
"^DD",8992.1,8992.1,4,0)
LONG INFO TEXT^8992.14^^4;0
"^DD",8992.1,8992.14,0)
LONG INFO TEXT SUB-FIELD^^.01^1
"^DD",8992.1,8992.14,0,"DT")
3000329
"^DD",8992.1,8992.14,0,"NM","LONG INFO TEXT")

"^DD",8992.1,8992.14,0,"UP")
8992.1
"^DD",8992.1,8992.14,.01,0)
LONG INFO TEXT^W^^0;1^Q
"^DD",8992.1,8992.14,.01,3)
Enter text for an information only alert that should be displayed as word-processing text instead of a single line.
"^DD",8992.1,8992.14,.01,21,0)
^^4^4^3000329^
"^DD",8992.1,8992.14,.01,21,1,0)
This field is used to present a long information only alert.  It can be
"^DD",8992.1,8992.14,.01,21,2,0)
any length since it is stored as word processing text.  It is to be
"^DD",8992.1,8992.14,.01,21,3,0)
displayed in a screen-man window on dumb terminals and in a memo box on
"^DD",8992.1,8992.14,.01,21,4,0)
windowed systems.
"^DD",8992.1,8992.14,.01,"DT")
3000329
**END**
**END**
