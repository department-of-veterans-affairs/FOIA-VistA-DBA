Released YS*5.01*88 SEQ #74
Extracted from mail message
**KIDS**:YS*5.01*88^

**INSTALL NAME**
YS*5.01*88
"BLD",6118,0)
YS*5.01*88^MENTAL HEALTH^0^3050418^y
"BLD",6118,1,0)
^^2^2^3050418^
"BLD",6118,1,1,0)
Under certain coditions when entering an Outpatient ASI the message 
"BLD",6118,1,2,0)
Progress Note Created will display when it has not been created.
"BLD",6118,4,0)
^9.64PA^^
"BLD",6118,"ABPKG")
n
"BLD",6118,"KRN",0)
^9.67PA^8989.52^19
"BLD",6118,"KRN",.4,0)
.4
"BLD",6118,"KRN",.401,0)
.401
"BLD",6118,"KRN",.402,0)
.402
"BLD",6118,"KRN",.403,0)
.403
"BLD",6118,"KRN",.5,0)
.5
"BLD",6118,"KRN",.84,0)
.84
"BLD",6118,"KRN",3.6,0)
3.6
"BLD",6118,"KRN",3.8,0)
3.8
"BLD",6118,"KRN",9.2,0)
9.2
"BLD",6118,"KRN",9.8,0)
9.8
"BLD",6118,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6118,"KRN",9.8,"NM",1,0)
YSASPNT^^0^B9930691
"BLD",6118,"KRN",9.8,"NM","B","YSASPNT",1)

"BLD",6118,"KRN",19,0)
19
"BLD",6118,"KRN",19.1,0)
19.1
"BLD",6118,"KRN",101,0)
101
"BLD",6118,"KRN",409.61,0)
409.61
"BLD",6118,"KRN",771,0)
771
"BLD",6118,"KRN",870,0)
870
"BLD",6118,"KRN",8989.51,0)
8989.51
"BLD",6118,"KRN",8989.52,0)
8989.52
"BLD",6118,"KRN",8994,0)
8994
"BLD",6118,"KRN","B",.4,.4)

"BLD",6118,"KRN","B",.401,.401)

"BLD",6118,"KRN","B",.402,.402)

"BLD",6118,"KRN","B",.403,.403)

"BLD",6118,"KRN","B",.5,.5)

"BLD",6118,"KRN","B",.84,.84)

"BLD",6118,"KRN","B",3.6,3.6)

"BLD",6118,"KRN","B",3.8,3.8)

"BLD",6118,"KRN","B",9.2,9.2)

"BLD",6118,"KRN","B",9.8,9.8)

"BLD",6118,"KRN","B",19,19)

"BLD",6118,"KRN","B",19.1,19.1)

"BLD",6118,"KRN","B",101,101)

"BLD",6118,"KRN","B",409.61,409.61)

"BLD",6118,"KRN","B",771,771)

"BLD",6118,"KRN","B",870,870)

"BLD",6118,"KRN","B",8989.51,8989.51)

"BLD",6118,"KRN","B",8989.52,8989.52)

"BLD",6118,"KRN","B",8994,8994)

"BLD",6118,"QUES",0)
^9.62^^
"BLD",6118,"REQB",0)
^9.611^1^1
"BLD",6118,"REQB",1,0)
YS*5.01*73^1
"BLD",6118,"REQB","B","YS*5.01*73",1)

"MBREQ")
0
"PKG",7,-1)
1^1
"PKG",7,0)
MENTAL HEALTH^YS^Version 5.01 of Mental Health
"PKG",7,20,0)
^9.402P^^
"PKG",7,22,0)
^9.49I^1^1
"PKG",7,22,1,0)
5.01^2941230^2990120
"PKG",7,22,1,"PAH",1,0)
88^3050418
"PKG",7,22,1,"PAH",1,1,0)
^^2^2^3050418
"PKG",7,22,1,"PAH",1,1,1,0)
Under certain coditions when entering an Outpatient ASI the message 
"PKG",7,22,1,"PAH",1,1,2,0)
Progress Note Created will display when it has not been created.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","YSASPNT")
0^1^B9930691
"RTN","YSASPNT",1,0)
YSASPNT ;ALB/ASF-TIU PROGRESS NOTE ;10/16/01  10:23
"RTN","YSASPNT",2,0)
 ;;5.01;MENTAL HEALTH;**39,73,88**;Dec 30, 1994
"RTN","YSASPNT",3,0)
MAIN(YSASDA) ;
"RTN","YSASPNT",4,0)
 N VA,VADM,YSASAUTH,YSASC,YSAUTOSG,YSNOW,YSPIFN,YSTIUT,YSTIUTS,G,G2,N,P1,P2,R,V,V1,Y1,YSA,YSAGE,YSAS0,YSASC,YSASD,YSASIG,YSASN,YSASNA,YSASQUIT,YSAST,YSASWP
"RTN","YSASPNT",5,0)
 N YSASWP,YSBID,YSDOB,YSHDR,YSHIML,YSHIMU,YSI,YSJ,YSLAST,YSLCK,YSLFN,YSNM,YSPART,YSPOSL,YSPOSU
"RTN","YSASPNT",6,0)
 N YSPROL,YSPROU,YSSC,YSSCK,YSSEX,YSSSN,YSSTEM,YSTITLE,YSX,YSYCK,YSYX,YSZ,YSZZ,YSV1,YSV2,YSV3,YSV4,YSV5,YSV6,YSV7,YSV8,YSV9,YSV10,YSV11,YSV12,YSV13,YSV14
"RTN","YSASPNT",7,0)
 S Y=$$GET1^DIQ(604,YSASDA,.11,"I") Q:Y'="N"  ;---> out if G12 10/16/01 ASF
"RTN","YSASPNT",8,0)
 S YSTIUT=0,YSTIUTS=0 D ASTIT
"RTN","YSASPNT",9,0)
 I (YSTIUT'>0)!(YSTIUTS'?1"ACT".E) W !,"ASI-TIU not fully ready" Q
"RTN","YSASPNT",10,0)
 K DIR S DIR(0)="Y",DIR("B")="Yes",DIR("A")="Do you wish to create a TIU Progress Note" D ^DIR K DIR Q:$D(DIRUT)!(Y'=1)
"RTN","YSASPNT",11,0)
 K DIR S DIR(0)="Y",DIR("B")="No",DIR("A")="Do you wish to automatically sign this note" D ^DIR K DIR Q:$D(DIRUT)  S YSAUTOSG=+Y
"RTN","YSASPNT",12,0)
 D NARSET
"RTN","YSASPNT",13,0)
 D PUTPN
"RTN","YSASPNT",14,0)
 ;
"RTN","YSASPNT",15,0)
 Q
"RTN","YSASPNT",16,0)
ASTIT ;ASI document title check
"RTN","YSASPNT",17,0)
 S X="ASI-ADDICTION SEVERITY INDEX",DIC="^TIU(8925.1,",DIC(0)="M",DIC("S")="I $P(^TIU(8925.1,+Y,0),U,4)=""DOC""" D ^DIC K DIC("S") S YSTIUT=+Y Q:YSTIUT'>0
"RTN","YSASPNT",18,0)
 S YSTIUTS=$$GET1^DIQ(8925.1,YSTIUT_",","STATUS")
"RTN","YSASPNT",19,0)
 Q
"RTN","YSASPNT",20,0)
NARSET ;Set up narrative global
"RTN","YSASPNT",21,0)
 S YSZZ=0
"RTN","YSASPNT",22,0)
 S YSAS0=^YSTX(604,YSASDA,0),DFN=$P(YSAS0,"^",2)
"RTN","YSASPNT",23,0)
 D DEM^VADPT
"RTN","YSASPNT",24,0)
 S YSASD=$$FMTE^XLFDT($P(YSAS0,U,5),"5ZD")
"RTN","YSASPNT",25,0)
 S YSAST=$$GET1^DIQ(604,YSASDA_",",.04)
"RTN","YSASPNT",26,0)
 S YSASC=$$GET1^DIQ(604,YSASDA_",",.09)
"RTN","YSASPNT",27,0)
 S YSASIG=$$GET1^DIQ(604,YSASDA_",",.51,"I")
"RTN","YSASPNT",28,0)
 S YSASAUTH=$$GET1^DIQ(604,YSASDA_",",.09,"I")
"RTN","YSASPNT",29,0)
 S YSNM=VADM(1),YSSEX=$P(VADM(5),U),YSDOB=$P(VADM(3),U,2),YSAGE=VADM(4),YSSSN=VA("PID"),YSBID=VA("BID")
"RTN","YSASPNT",30,0)
 ;
"RTN","YSASPNT",31,0)
 K ^UTILITY($J,"YSTMP"),^TMP("TIUP",$J)
"RTN","YSASPNT",32,0)
 S YSLFN=1,^UTILITY($J,"YSTMP",0,1,0)=""
"RTN","YSASPNT",33,0)
 D VARPRO^YSASNAR
"RTN","YSASPNT",34,0)
 D R1^YSASNAR
"RTN","YSASPNT",35,0)
 M ^TMP("TIUP",$J)=^UTILITY($J,"YSTMP",0)
"RTN","YSASPNT",36,0)
 S X="NOW",%DT="T" D ^%DT S YSNOW=Y
"RTN","YSASPNT",37,0)
 S YSLFN=YSLFN-1,^TMP("TIUP",$J,0)="^^"_YSLFN_U_YSLFN_U_YSNOW_U
"RTN","YSASPNT",38,0)
 S YSLFN=0 F  S YSLFN=$O(^TMP("TIUP",$J,YSLFN)) Q:YSLFN'>0  S:^TMP("TIUP",$J,YSLFN,0)?1"|BLANK".E ^TMP("TIUP",$J,YSLFN,0)=""
"RTN","YSASPNT",39,0)
 Q
"RTN","YSASPNT",40,0)
PUTPN ;create Pnote
"RTN","YSASPNT",41,0)
 S YSAUTOSG=$S(YSAUTOSG:YSASAUTH,1:""),TIUASKVS=1
"RTN","YSASPNT",42,0)
 D NEW^TIUPNAPI(.YSPIFN,DFN,YSASAUTH,YSNOW,YSTIUT,"","","",YSAUTOSG,TIUASKVS)
"RTN","YSASPNT",43,0)
 ;VMP OIFO BAY PINES;ELR;YS*5.01*88 ADDED NEXT LINE OF CODE
"RTN","YSASPNT",44,0)
 S:$G(YSPIFN)=-1 YSPIFN=0
"RTN","YSASPNT",45,0)
 W !,$S(+YSPIFN:"Progress Note created",1:"Progress Note has NOT been created - please select the existing appointment") H 1
"RTN","YSASPNT",46,0)
 Q
"VER")
8.0^22.0
"BLD",6118,6)
^SEQ #74
**END**
**END**
