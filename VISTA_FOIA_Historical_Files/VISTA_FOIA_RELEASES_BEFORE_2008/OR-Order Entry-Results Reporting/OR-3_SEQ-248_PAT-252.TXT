
=============================================================================
Run Date: MAY 02, 2007                     Designation: OR*3*252
Package : OR - ORDER ENTRY/RESULTS REPORTING  Priority: Mandatory
Version : 3       SEQ #248                      Status: Released
                  Compliance Date: JUN 02, 2007
=============================================================================


Subject: Correct CPRSUpdate.EXE Defects

Category: 
  - Other
  - Informational

Description:
============

 This patch will include the resolution for CQ 11208, submitted from a 
 CPRS GUI v26 test site.  It is planned for release after OR*3*215 (CPRS 
 GUI v26) and before OR*3*243 (CPRS GUI v27).  It was identified as a 
 Known Issue in OR*3*215.  See below for more details and/or CQ 11208.
  
 During the testing of CPRS GUI v26, OR*3*215, an issue was identified 
 with the auto-update functionality which occasionally led to a "Range 
 Check" error on startup when the CPRSUpdate utility was run.  The problem 
 would only occur on workstations that had not been rebooted for a time 
 period greater than 24.85 days prior to the current run date of the 
 auto-update utility.
  
 A second issue discovered during internal testing of this patch involved 
 the use of double quotes around GOLD and ONLY directory entries that 
 contained embedded spaces.  If the quotes were included, but the 
 directory did not contain a trailing backslash "\" within the quotes, a 
 trailing "\" was being added automatically AFTER the trailing quote and 
 stored in the registry.  This would result in failure to locate that 
 directory, and no update would occur.  This has also been corrected.
  
 Third, it was discovered during testing under Windows XP that adding 
 double quotes around a directory path with embedded spaces caused that 
 directory to not be found by Windows, resulting in no update occurring.  
 CPRSUpdate now checks for the version of Windows being run, and if WinXP,
 does not require or store leading/trailing quotes, whether or not entered
 by the user.  A second part of this fix will be included in CPRS v27.  
 CPRS, if running under Windows XP, and finding double quotes in either the
 GOLD or ONLY directory paths in the registry, may be unable to locate
 those directories, and may fail to automatically update.  That correction
 will not be seen until CPRS v27 (OR*3*243) is released and an update to an
 even higher version occurs.
  
 Finally, since CPRS v27 is compiled with a new version of Delphi, Delphi
 2006, this necessitates installation on all workstations of a new version
 of the BORLNDMM.DLL that was first distributed with CPRS v25.  That DLL is
 included in this patch for use with CPRSUpdate, and it will also be
 included with the CPRS v27 distribution in OR*3*243.  It should be placed
 in the GOLD directory along with all other CPRS v27 files, and will be
 updated automatically when the automatic update to CPRS v27 occurs.
 Failure to update this DLL, either via CPRSUpdate or other normal means,
 will prevent CPRS v27 from running.
  
 This utility was never formally released, and was originally provided 
 as-is, as a convenience to sites running CPRS at the time, in conjunction 
 with OR*3*10, CPRS GUI v10f.  Its use has grown with the spread of CPRS 
 itself, but it has never been formally supported.  OR*3*252 formally
 releases this auto-update utility, and also corrects the "Range Check"
 error described above.  
  
 Test Sites
 ===========
 Charleston 
 Loma Linda 
 Northern California Health Care System       
 Puget Sound
 Tampa      
  
 REQUIRED PATCHES:
 =================
 None
   
 ROUTINE SUMMARY:
 ================
  
 No routines are included with this patch.  
  
 INSTALLATION FILES:
 ==================
  
 A section in the main CPRS Installation Guide documents the use of this
 auto-update feature, and that document is included in the OR_30_252.ZIP
 file as described below.
  
 The following software files are exported as part of this patch:
  
    File Name          Contents                            Retrieval Format
    ---------          --------                            ----------------
    OR_30_252.ZIP      File(s) indented below     (size 1006080)     BINARY
     - CPRSUPDATE.EXE  CPRSUpdate Executable 
                       (v1.0.252.3)
     - CPRSIG.DOC      CPRS Installation Guide (updated)
     - CPRSIG.PDF      CPRS Installation Guide (updated)
     - BORLNDMM.DLL    New Delphi 2006 version of DLL 
                       (v10.0.2288.42451)
     - OR_3_252RN.DOC  CPRS Update Release Notes
     - OR_3_252RN.PDF  CPRS Update Release Notes
    OR_30_252SRC.ZIP   CPRSUpdate Source          (size 3012096)     BINARY
  
 The files listed above may be obtained via FTP.  The preferred method is
 to FTP the files from:
  
    download.vista.med.va.gov
  
 This transmits the files from the first available FTP server. Sites may
 also elect to retrieve software directly from a specific server as
 follows:
  
    OI FIELD OFFICE    FTP ADDRESS                 DIRECTORY
    ----------------   -------------------------   --------------------
    Albany             ftp.fo-albany.med.va.gov    [anonymous.software]
    Hines              ftp.fo-hines.med.va.gov     [anonymous.software]
    Salt Lake City     ftp.fo-slc.med.va.gov       [anonymous.software]
  
  
 INSTALLATION INSTRUCTIONS:
 ========================= 
  
  These files should be installed during non-peak hours to minimize 
  disruption. Users may be on the system during installation.  Installation
  should take approximately 1 minute.  This patch should be installed by
  the compliance date to comply with VHA Directive 2001-023.
   
  Installation simply involves replacing any existing copies of 
  CPRSUPDATE.EXE and BORLNDMM.DLL with a copy of the new EXE and DLL on
  your workstations, network server, or in the currently designated "GOLD"
  directory as outlined in the Installation Guide.
      
  1.  Retrieve and open the file OR_30_252.ZIP.
   
  2.  If your site does not use CPRSUpdate to update versions of CPRS, 
      please skip to step 3b.
      
      Move the CPRSUpdate.exe file to the appropriate directory where
      it can be accessed by all CPRS workstations. This can be either the 
      network "GOLD" directory where new copies of CPRSChart.EXE are 
      distributed from, or in the same directory as CPRSChart.EXE on the 
      workstation or server.
  
  3.  a. If your site uses CPRSUpdate to update versions of CPRS, 
      place the new BORLNDMM.DLL in the GOLD directory, and it will be 
      updated automatically the next time CPRS is run on a workstation 
      that uses CPRSUpdate.
      
      b. If your site does not use CPRSUpdate to update versions of CPRS,
      or you have workstations that are updated by means other than 
      CPRSUpdate, the BORLNDMM.DLL will need to be placed in the 
      workstation or network server's CPRS directory, or in a location
      that is reachable via the workstation's PATH variable, replacing any
      previous copies that are installed.
  
      As noted above, CPRS v27, to be released later in 2007, will be 
      unable to run without this new version of the DLL.
  
      ***************************** IMPORTANT *****************************
      If the DLL is to be updated on workstations by a means OTHER THAN 
      CPRSUpdate, and CPRSUpdate is to be used later to update CPRSChart,
      please be sure to place the updated DLL in your GOLD directory
      BEFORE distributing it to workstations.  If the old DLL is present 
      in the GOLD directory when CPRS v26.69 starts up, the old DLL will be
      copied to the workstation, replacing the new version you placed
      earlier. This will result in CPRS v27 being unable to run following
      the automatic update.  An alternative would be to simply remove the
      old DLL from the GOLD directory until you're ready to also update to
      CPRS v27.
      *********************************************************************

Routine Information:
====================
No routines included.

=============================================================================
User Information:
Entered By  : KRIEG,JEAN                    Date Entered  : APR 12, 2006
Completed By: CONDIE,KENNY                  Date Completed: APR 30, 2007
Released By : BOYER,EDWARD                  Date Released : MAY 02, 2007
=============================================================================


Packman Mail Message:
=====================

No routines included
