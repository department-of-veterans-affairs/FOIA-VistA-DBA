$TXT Created by HARTIN,JIM at DAYT17.FO-BAYPINES.MED.VA.GOV  (KIDS) on Thursday, 09/06/07 at 18:22
=============================================================================
Run Date: OCT 15, 2007                     Designation: OR*3*278
Package : OR - ORDER ENTRY/RESULTS REPORTING  Priority: Mandatory
Version : 3       SEQ #252                      Status: Released
                  Compliance Date: NOV 15, 2007
=============================================================================

Associated patches: (v)OR*3*195    <<= must be installed BEFORE `OR*3*278'

Subject: Back up with Taskman waiting for partitions.

Category: 
  - Routine

Description:
============

 This patch corrects the following issues:
  
 Corrects the issue with Task accumulating while  waiting  for a partition.
  
 ASSOCIATED REMEDY TICKETS:
 ==========================
 HD0000000202687  Runaway Task Creation EN^ORMEVNT crippling the system
    Duplicate HD0000000203346  Taskman reporting 118,000 tasks
    Duplicate HD0000000207117  System crashed due to several jobs 
                               scheduled by routine 
  
 PARTICIPATING TEST SITES:
 =========================
 Fayettville, NC 
 Cheyenne, WY 
 South Texas HCS 
  
 REMEDY OVERVIEW:
 ===============
 HD0000000202687 Runaway Task Creation EN^ORMEVNT crippling the system
  
 Problem:
 --------
 Site reported large numbers of Tasks waiting for partitions.  It was 
 found that one task had a lock on the event and quit without unlocking.
 In a normal entry, the global would be unlocked by Cache when 
 the routine finishes and the process dies.  But in this case,  since this 
 process is started by a Taskman Sub-manager, when this routine finishes, 
 the sub-manager proceeds to run another task in the queue and keeps the 
 process alive and the global locked until there are no more tasks to 
 run.  This results in this log jam. 
  
 Solution:
 ---------
 We found that the routine / process EN^ORMEVNT activated with patient 
 movement and run in this task had a path that would leave the global 
 locked when the process exited this routine. Also there was a chance that 
 the lock reverence could be lost in calls to other routines causing the 
 routine not to process the unlock. Code was added to save the lock 
 variable in the routine so as to protect it from change by other 
 routines. Also, the exit path was change to unlock the global and clean 
 up. 
  
  
 INSTALLATION INSTRUCTIONS
 =========================
 This patch can be loaded with users in the system.  Installation time
 will be less than 2 minutes.
  
  1.  Choose the PackMan message containing this patch and invoke the 
      INSTALL/CHECK MESSAGE PackMan option.  
  
  2.  Start up the Kernel Installation and Distribution System Menu
      [XPD MAIN]: 
  
           Edits and Distribution ...  
           Utilities ...  
           Installation ...  
  
      Select Kernel Installation & Distribution System Option: Installation
                                                               ---
           1      Load a Distribution
           2      Verify Checksums in Transport Global
           3      Print Transport Global
           4      Compare Transport Global to Current System
           5      Backup a Transport Global
           6      Install Package(s)
                  Restart Install of Package(s)
                  Unload a Distribution
  
  3.  From this menu, you may elect to use the following options
      (When prompted for the INSTALL NAME, enter "OR*3.0*278"):
    
      a.  Backup a Transport Global - This option will create a backup
          message of any routines exported with this patch. It will
          not backup any other changes such as DD's or templates.
      b.  Compare Transport Global to Current System - This option
          will allow you to view all changes that will be made when
          this patch is installed.  It compares all components of this
          patch (routines, DD's, templates, etc.).
      c.  Verify Checksums in Transport Global - This option will
          allow you to ensure the integrity of the routines that are
          in the transport global.
  
  4.  Use the Install Package(s) option and select the package.
      a.  When prompted "Want KIDS to INHIBIT LOGONs during the
          install? YES//", answer NO.
      b.  When prompted "Want to DISABLE Scheduled Options and Menu 
          Options and Protocols? YES//", answer NO.
  
 ROUTINE SUMMARY:
 ===============
 The second line of each of these routine(s) will look like:
  
 <tab>;;3.0;ORDER ENTRY/RESULTS REPORTING;**[Patch List]**;Dec 17, 1997
                      
                      CHECK^XTSUMBLD results
 Routine name  Before Patch    After Patch    Patch List
 ============  ============    ===========    ==========
 ORMEVNT       21240415        22001087       24,45,70,79,141,165,
                                              177,186,195,278

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**[Patch List]**;Dec 17, 1997;Build 5

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: ORMEVNT
    Before: B71407003   After: B75252404  **24,45,70,79,141,165,177,186,
                                           195,278**
 
Routine list of preceding patches: 195

=============================================================================
User Information:
Entered By  : HARTIN,JAMES                  Date Entered  : AUG 13, 2007
Completed By: CROSSMAN,PAM                  Date Completed: OCT 15, 2007
Released By : SPIVEY,RICHARD J              Date Released : OCT 15, 2007
=============================================================================


Packman Mail Message:
=====================

$END TXT
