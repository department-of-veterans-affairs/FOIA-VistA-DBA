Released EN*7*78 SEQ #76
Extracted from mail message
**KIDS**:EN*7.0*78^

**INSTALL NAME**
EN*7.0*78
"BLD",4769,0)
EN*7.0*78^ENGINEERING^0^3030930^y
"BLD",4769,1,0)
^^1^1^3030522^
"BLD",4769,1,1,0)
CoreFLS Data Cleansing Reports for BUILDING FILE (#6928.3)
"BLD",4769,4,0)
^9.64PA^^
"BLD",4769,"KRN",0)
^9.67PA^8989.52^19
"BLD",4769,"KRN",.4,0)
.4
"BLD",4769,"KRN",.401,0)
.401
"BLD",4769,"KRN",.402,0)
.402
"BLD",4769,"KRN",.403,0)
.403
"BLD",4769,"KRN",.5,0)
.5
"BLD",4769,"KRN",.84,0)
.84
"BLD",4769,"KRN",3.6,0)
3.6
"BLD",4769,"KRN",3.8,0)
3.8
"BLD",4769,"KRN",9.2,0)
9.2
"BLD",4769,"KRN",9.8,0)
9.8
"BLD",4769,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",4769,"KRN",9.8,"NM",1,0)
ENH283^^0^B9548172
"BLD",4769,"KRN",9.8,"NM",2,0)
ENH283I^^0^B52031864
"BLD",4769,"KRN",9.8,"NM",3,0)
ENH283L^^0^B31641076
"BLD",4769,"KRN",9.8,"NM",4,0)
ENH283M^^0^B44387138
"BLD",4769,"KRN",9.8,"NM",5,0)
ENH283P^^0^B47281041
"BLD",4769,"KRN",9.8,"NM",6,0)
ENH283U^^0^B2984917
"BLD",4769,"KRN",9.8,"NM","B","ENH283",1)

"BLD",4769,"KRN",9.8,"NM","B","ENH283I",2)

"BLD",4769,"KRN",9.8,"NM","B","ENH283L",3)

"BLD",4769,"KRN",9.8,"NM","B","ENH283M",4)

"BLD",4769,"KRN",9.8,"NM","B","ENH283P",5)

"BLD",4769,"KRN",9.8,"NM","B","ENH283U",6)

"BLD",4769,"KRN",19,0)
19
"BLD",4769,"KRN",19,"NM",0)
^9.68A^6^6
"BLD",4769,"KRN",19,"NM",1,0)
ENH DATA CLEANSING^^2
"BLD",4769,"KRN",19,"NM",2,0)
ENH BUILDING FILE^^0
"BLD",4769,"KRN",19,"NM",3,0)
ENH 6928.3 SUMMARY REPORT^^0
"BLD",4769,"KRN",19,"NM",4,0)
ENH 6928.3 REQUIRED RPT^^0
"BLD",4769,"KRN",19,"NM",5,0)
ENH 6928.3 LOOKUP RPT^^0
"BLD",4769,"KRN",19,"NM",6,0)
ENH 6928.3 NON-REQUIRED RPT^^0
"BLD",4769,"KRN",19,"NM","B","ENH 6928.3 LOOKUP RPT",5)

"BLD",4769,"KRN",19,"NM","B","ENH 6928.3 NON-REQUIRED RPT",6)

"BLD",4769,"KRN",19,"NM","B","ENH 6928.3 REQUIRED RPT",4)

"BLD",4769,"KRN",19,"NM","B","ENH 6928.3 SUMMARY REPORT",3)

"BLD",4769,"KRN",19,"NM","B","ENH BUILDING FILE",2)

"BLD",4769,"KRN",19,"NM","B","ENH DATA CLEANSING",1)

"BLD",4769,"KRN",19.1,0)
19.1
"BLD",4769,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",4769,"KRN",101,0)
101
"BLD",4769,"KRN",409.61,0)
409.61
"BLD",4769,"KRN",771,0)
771
"BLD",4769,"KRN",870,0)
870
"BLD",4769,"KRN",8989.51,0)
8989.51
"BLD",4769,"KRN",8989.52,0)
8989.52
"BLD",4769,"KRN",8994,0)
8994
"BLD",4769,"KRN","B",.4,.4)

"BLD",4769,"KRN","B",.401,.401)

"BLD",4769,"KRN","B",.402,.402)

"BLD",4769,"KRN","B",.403,.403)

"BLD",4769,"KRN","B",.5,.5)

"BLD",4769,"KRN","B",.84,.84)

"BLD",4769,"KRN","B",3.6,3.6)

"BLD",4769,"KRN","B",3.8,3.8)

"BLD",4769,"KRN","B",9.2,9.2)

"BLD",4769,"KRN","B",9.8,9.8)

"BLD",4769,"KRN","B",19,19)

"BLD",4769,"KRN","B",19.1,19.1)

"BLD",4769,"KRN","B",101,101)

"BLD",4769,"KRN","B",409.61,409.61)

"BLD",4769,"KRN","B",771,771)

"BLD",4769,"KRN","B",870,870)

"BLD",4769,"KRN","B",8989.51,8989.51)

"BLD",4769,"KRN","B",8989.52,8989.52)

"BLD",4769,"KRN","B",8994,8994)

"BLD",4769,"QUES",0)
^9.62^^
"BLD",4769,"REQB",0)
^9.611^^
"KRN",19,11578,-1)
2^1
"KRN",19,11578,0)
ENH DATA CLEANSING^CoreFLS AEMS/MERS Data Cleansing Reports^^M^101009^ENH DATA CLEANSING^^^^^^33
"KRN",19,11578,10,0)
^19.01IP^7^7
"KRN",19,11578,10,4,0)
11699^4^4
"KRN",19,11578,10,4,"^")
ENH BUILDING FILE
"KRN",19,11578,"U")
COREFLS AEMS/MERS DATA CLEANSI
"KRN",19,11699,-1)
0^2
"KRN",19,11699,0)
ENH BUILDING FILE^Building File - 6928.3^^M^^ENH DATA CLEANSING^^^^^^ENGINEERING
"KRN",19,11699,1,0)
^^2^2^3030916^
"KRN",19,11699,1,1,0)
This menu displays all of the CoreFLS Data Cleansing report options for
"KRN",19,11699,1,2,0)
AEMS/MERS ENG BUILDING (#6928.3) file.
"KRN",19,11699,10,0)
^19.01IP^4^4
"KRN",19,11699,10,1,0)
11732^1^1
"KRN",19,11699,10,1,"^")
ENH 6928.3 SUMMARY REPORT
"KRN",19,11699,10,2,0)
11733^2^2
"KRN",19,11699,10,2,"^")
ENH 6928.3 REQUIRED RPT
"KRN",19,11699,10,3,0)
11734^3^3
"KRN",19,11699,10,3,"^")
ENH 6928.3 LOOKUP RPT
"KRN",19,11699,10,4,0)
11735^4^4
"KRN",19,11699,10,4,"^")
ENH 6928.3 NON-REQUIRED RPT
"KRN",19,11699,25)

"KRN",19,11699,99)
59403,62957
"KRN",19,11699,"U")
BUILDING FILE - 6928.3
"KRN",19,11732,-1)
0^3
"KRN",19,11732,0)
ENH 6928.3 SUMMARY REPORT^Summary Report^^R^^^^^^^^ENGINEERING^^1
"KRN",19,11732,1,0)
^19.06^4^4^3030929^^
"KRN",19,11732,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Summary Report
"KRN",19,11732,1,2,0)
for the ENG BUILDING (#6928.3) file. The report shows the fields being
"KRN",19,11732,1,3,0)
checked and the total number of times that required fields and
"KRN",19,11732,1,4,0)
non-required fields are missing data.
"KRN",19,11732,20)
S ENHRPT=1
"KRN",19,11732,25)
REPTYP^ENH283
"KRN",19,11732,"U")
SUMMARY REPORT
"KRN",19,11733,-1)
0^4
"KRN",19,11733,0)
ENH 6928.3 REQUIRED RPT^Required Fields Missing Data Report^^R^^^^^^^^ENGINEERING^^1
"KRN",19,11733,1,0)
^19.06^3^3^3030929^^
"KRN",19,11733,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Required Fields
"KRN",19,11733,1,2,0)
Missing Data Report for the ENG BUILDING (#6928.3) file. The report lists
"KRN",19,11733,1,3,0)
the required fields that are empty and that you must correct.
"KRN",19,11733,20)
S ENHRPT=2
"KRN",19,11733,25)
REPTYP^ENH283
"KRN",19,11733,"U")
REQUIRED FIELDS MISSING DATA R
"KRN",19,11734,-1)
0^5
"KRN",19,11734,0)
ENH 6928.3 LOOKUP RPT^Lookup Fields w/ Invalid Data Report - N/A^^R^^^^^^^^ENGINEERING^^1
"KRN",19,11734,1,0)
^19.06^5^5^3030929^^
"KRN",19,11734,1,1,0)
This option is a placeholder for the Lookup Fields w/ Invalid Data Report.
"KRN",19,11734,1,2,0)
Currently, the ENG BUILDING (#6928.3) file does not have any lookup fields
"KRN",19,11734,1,3,0)
(a.k.a. pointers) that are being checked for validity and thus there is no
"KRN",19,11734,1,4,0)
report to print for this type of data check. This option is included for
"KRN",19,11734,1,5,0)
consistency with other Data Cleansing menus. 
"KRN",19,11734,20)
S ENHRPT=3
"KRN",19,11734,25)
REPTYP^ENH283
"KRN",19,11734,99)
59358,38381
"KRN",19,11734,"U")
LOOKUP FIELDS W/ INVALID DATA 
"KRN",19,11735,-1)
0^6
"KRN",19,11735,0)
ENH 6928.3 NON-REQUIRED RPT^Non-Required Fields Missing Data Report^^R^^^^^^^^ENGINEERING^^1
"KRN",19,11735,1,0)
^19.06^3^3^3030929^^
"KRN",19,11735,1,1,0)
This option prints or displays the CoreFLS Data Cleansing Non-Required
"KRN",19,11735,1,2,0)
Fields Missing Data Report for the ENG BUILDING (#6928.3) file. The report
"KRN",19,11735,1,3,0)
lists the non-required fields that are empty and that you should correct.
"KRN",19,11735,20)
S ENHRPT=4
"KRN",19,11735,25)
REPTYP^ENH283
"KRN",19,11735,"U")
NON-REQUIRED FIELDS MISSING DA
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",33,-1)
1^1
"PKG",33,0)
ENGINEERING^EN^AUTOMATED ENGINEERING MANAGEMENT SYSTEM
"PKG",33,20,0)
^9.402P^^
"PKG",33,22,0)
^9.49I^1^1
"PKG",33,22,1,0)
7.0^2930817^2960130
"PKG",33,22,1,"PAH",1,0)
78^3030930
"PKG",33,22,1,"PAH",1,1,0)
^^1^1^3030930
"PKG",33,22,1,"PAH",1,1,1,0)
CoreFLS Data Cleansing Reports for BUILDING FILE (#6928.3)
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","ENH283")
0^1^B9548172
"RTN","ENH283",1,0)
ENH283 ;WOIFO/EEN - Eng Building File Report Driver (AMES/MERS) - CoreFLS ;
"RTN","ENH283",2,0)
 ;;7.0;Engineering;**78**; 09/30/03 10:55
"RTN","ENH283",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH283",4,0)
 ;
"RTN","ENH283",5,0)
 Q  ;this routine is not callable from the top
"RTN","ENH283",6,0)
 ;
"RTN","ENH283",7,0)
REPTYP ; Entry point to print all data cleansing reports for 6928.3
"RTN","ENH283",8,0)
 I '$D(DT)!'$D(U) D DT^DICRW
"RTN","ENH283",9,0)
 K ^TMP("ENH283",$J)
"RTN","ENH283",10,0)
 S ABORT=0
"RTN","ENH283",11,0)
 I ENHRPT=1 D
"RTN","ENH283",12,0)
 . S PRTRTN="OPT1^ENH283P"
"RTN","ENH283",13,0)
 I ENHRPT=2 D
"RTN","ENH283",14,0)
 . S PRTRTN="OPT2^ENH283P"
"RTN","ENH283",15,0)
 I ENHRPT=3 D  G EXIT Q
"RTN","ENH283",16,0)
 . ;S PRTRTN="OPT3^ENH283P"
"RTN","ENH283",17,0)
 . W !!,"*** Data cleansing of lookup fields is not applicable for this file ***"
"RTN","ENH283",18,0)
 . W !!,"  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1
"RTN","ENH283",19,0)
 I ENHRPT=4 D
"RTN","ENH283",20,0)
 . S PRTRTN="OPT4^ENH283P"
"RTN","ENH283",21,0)
 D DIVM I ABORT G EXIT Q
"RTN","ENH283",22,0)
 D INST^ENH283U I ABORT G EXIT Q
"RTN","ENH283",23,0)
 D DEVICE
"RTN","ENH283",24,0)
 G EXIT
"RTN","ENH283",25,0)
 Q
"RTN","ENH283",26,0)
 ;
"RTN","ENH283",27,0)
DIVM ; Print by Division Prompt
"RTN","ENH283",28,0)
 ;
"RTN","ENH283",29,0)
 K DIR,ENHDIVFG,Y,ENHDIV
"RTN","ENH283",30,0)
 S IEN=0,DIV=""
"RTN","ENH283",31,0)
 F  S IEN=$O(^ENG(6928.3,IEN)) Q:'IEN  D
"RTN","ENH283",32,0)
 . S DIV=$P(^ENG(6928.3,IEN,0),U,16) I DIV="" S DIV="ZZ no division"
"RTN","ENH283",33,0)
 . I '$D(ENHDIV(DIV)) S ENHDIV(DIV)=""
"RTN","ENH283",34,0)
 W !!," This report is sorted by division. You may select a single division or ALL."
"RTN","ENH283",35,0)
 S DIVDIR="S^1:ALL",CNT=1,DIV=""
"RTN","ENH283",36,0)
 F  S DIV=$O(ENHDIV(DIV)) Q:DIV=""  D
"RTN","ENH283",37,0)
 . S CNT=CNT+1
"RTN","ENH283",38,0)
 . S DIVDIR=DIVDIR_";"_CNT_":"_DIV
"RTN","ENH283",39,0)
 S DIR(0)=DIVDIR
"RTN","ENH283",40,0)
 S DIR("A")="Please select a division (1-"_CNT_")"
"RTN","ENH283",41,0)
 S DIR("A",1)=" "
"RTN","ENH283",42,0)
 S DIR("B")=1
"RTN","ENH283",43,0)
 S DIR("?")=" "
"RTN","ENH283",44,0)
 S DIR("?",1)=" The list below contains the divisions that have been"
"RTN","ENH283",45,0)
 S DIR("?",2)=" found in the DIVISION (#.2) field in the ENG BUILDING"
"RTN","ENH283",46,0)
 S DIR("?",3)=" (#6928.3) file."
"RTN","ENH283",47,0)
 S DIR("?",4)=" "
"RTN","ENH283",48,0)
 S DIR("?",5)=" Select ""ZZ no division"" to display the records with"
"RTN","ENH283",49,0)
 S DIR("?",6)=" no entry in the DIVISION (#.2) field."
"RTN","ENH283",50,0)
 D ^DIR K DIR
"RTN","ENH283",51,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH283",52,0)
 S ENHDIVFG=Y(0)
"RTN","ENH283",53,0)
 Q
"RTN","ENH283",54,0)
 ;
"RTN","ENH283",55,0)
 ;
"RTN","ENH283",56,0)
DEVICE ; Ask the user for a device to print to (queuing is allowed).
"RTN","ENH283",57,0)
 W !
"RTN","ENH283",58,0)
 S %ZIS="Q"
"RTN","ENH283",59,0)
 D ^%ZIS I POP S ABORT=1 Q
"RTN","ENH283",60,0)
 ;User has decided to Queue report
"RTN","ENH283",61,0)
 I $D(IO("Q")) D  Q
"RTN","ENH283",62,0)
 . S ZTSAVE("ENHRPT")="",ZTSAVE("ENHDIVFG")="",ZTSAVE("ENHINST")=""
"RTN","ENH283",63,0)
 . S ZTRTN=PRTRTN
"RTN","ENH283",64,0)
 . S ZTDESC="CoreFLS DATA QUALITY REPORT (File# 6928.3 - BUILDING FILE)"
"RTN","ENH283",65,0)
 . D ^%ZTLOAD,HOME^%ZIS
"RTN","ENH283",66,0)
 . K ZTSK,ZTSAVE,ZTRTN,ZTDESC
"RTN","ENH283",67,0)
 D @PRTRTN
"RTN","ENH283",68,0)
 Q
"RTN","ENH283",69,0)
EXIT ;
"RTN","ENH283",70,0)
 K P,L,ABORT,ENFLG,TOTANA,CRITREC,BPTREC,DESREC,CRITNUM,BPTNUM,DESNUM
"RTN","ENH283",71,0)
 K CHKTYP,FLDNAME,FLDNUM,PRTRTN,DIR,ENHRPT,ENHDIVFG,ENHDIV,ENHDR,DIV,TYP
"RTN","ENH283",72,0)
 K SFIEN,FLD,RECIEN,RECNUM,NAME,NAMECRT,PADD1DES,PADD2DES,CITYDES,ZIPDES
"RTN","ENH283",73,0)
 K STATDES,GSQFTDES,ENHDIVCT,CNT,DIVDIR,DTOUT,DUOUT,POP,Y,I,IEN,TOTFLD
"RTN","ENH283",74,0)
 K DESFLD,FUNDES,DIVCT,ENHINST,TOTREC,%ZIS
"RTN","ENH283",75,0)
 Q
"RTN","ENH283I")
0^2^B52031864
"RTN","ENH283I",1,0)
ENH283I ;WOIFO/EEN - Eng Building File Instructions (AMES/MERS) - CoreFLS ;
"RTN","ENH283I",2,0)
 ;;7.0;Engineering;**78**;09/30/03 10:55
"RTN","ENH283I",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH283I",4,0)
 ;
"RTN","ENH283I",5,0)
 Q  ; This report is not callable from the top
"RTN","ENH283I",6,0)
 ;
"RTN","ENH283I",7,0)
PRT1 ; Print Instructions for Summary Report
"RTN","ENH283I",8,0)
 ;
"RTN","ENH283I",9,0)
 S (P,L,ABORT)=0
"RTN","ENH283I",10,0)
 S ENHDR="SUMMARY"
"RTN","ENH283I",11,0)
 S ENHDR1="Instructions"
"RTN","ENH283I",12,0)
 U IO
"RTN","ENH283I",13,0)
 D HDR^ENH283U
"RTN","ENH283I",14,0)
 W !!,"The purpose of this report is to display the total number of records in the"
"RTN","ENH283I",15,0)
 W !,"ENG BUILDING (#6928.3) file that have missing (empty) values in the fields"
"RTN","ENH283I",16,0)
 W !,"that are being converted into the CoreFLS system.  The report examines seven"
"RTN","ENH283I",17,0)
 W !,"fields to determine if there is a valid value in each. If there is no value"
"RTN","ENH283I",18,0)
 W !,"in the field, it is considered to be empty."
"RTN","ENH283I",19,0)
 W !!,"This report examines the following fields:"
"RTN","ENH283I",20,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH283I",21,0)
 W !,"to the field number"
"RTN","ENH283I",22,0)
 W !!,"     NAME (#.01)"
"RTN","ENH283I",23,0)
 W !,"     PROPERTY ADDRESS 1 (#5.3) - ""Property Addr 1"""
"RTN","ENH283I",24,0)
 W !,"     PROPERTY ADDRESS 2 (#5.4) - ""Property Addr 2"""
"RTN","ENH283I",25,0)
 W !,"     PROPERTY CITY (#5.5)"
"RTN","ENH283I",26,0)
 W !,"     PROPERTY STATE (#5.6)"
"RTN","ENH283I",27,0)
 W !,"     PROPERTY ZIP CODE (#5.7)"
"RTN","ENH283I",28,0)
 W !,"     GROSS SQUARE FEET (#13.5) - ""Gross Sq. Ft."""
"RTN","ENH283I",29,0)
 S L=L+18
"RTN","ENH283I",30,0)
 I L+7>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",31,0)
 W !!,"The report is sorted by division. When printing or viewing this report, you"
"RTN","ENH283I",32,0)
 W !,"may select a single division or ALL. Select ""ZZ no division"" to display the"
"RTN","ENH283I",33,0)
 W !,"records with no entry in the DIVISION (#.2) field. The report lists the overall"
"RTN","ENH283I",34,0)
 W !,"count of the number of problem records and fields detected."
"RTN","ENH283I",35,0)
 S L=L+5
"RTN","ENH283I",36,0)
 I L+7>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",37,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH283I",38,0)
 W !!,"Total records analyzed - number of records in the ENG BUILDING (#6928.3) file"
"RTN","ENH283I",39,0)
 W !,"     assigned to the division"
"RTN","ENH283I",40,0)
 S L=L+5
"RTN","ENH283I",41,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",42,0)
 W !!,"Total records with Required Fields Missing Data - number of records that have"
"RTN","ENH283I",43,0)
 W !,"     at least one empty required field"
"RTN","ENH283I",44,0)
 S L=L+3
"RTN","ENH283I",45,0)
 I L+7>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",46,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - ""N/A"" appears because"
"RTN","ENH283I",47,0)
 W !,"     this file does not contain lookup fields that are being checked for"
"RTN","ENH283I",48,0)
 W !,"     validity. This entry has been left for consistency with the other Data"
"RTN","ENH283I",49,0)
 W !,"     Cleansing reports."
"RTN","ENH283I",50,0)
 S L=L+5
"RTN","ENH283I",51,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",52,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records that"
"RTN","ENH283I",53,0)
 W !,"     have nothing in at least one non-required field"
"RTN","ENH283I",54,0)
 S L=L+3
"RTN","ENH283I",55,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",56,0)
 W !!,"Next, the report lists the counts for each individual field. The fields are"
"RTN","ENH283I",57,0)
 W !,"listed in alphabetical order. Each row consists of the following columns:"
"RTN","ENH283I",58,0)
 S L=L+3
"RTN","ENH283I",59,0)
 I L+6>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",60,0)
 W !!,"DATA QUALITY CHECK TYPE - tells whether the field was examined for:"
"RTN","ENH283I",61,0)
 W !,"     REQ: required fields missing data"
"RTN","ENH283I",62,0)
 W !,"     NREQ: non-required fields missing data"
"RTN","ENH283I",63,0)
 S L=L+4
"RTN","ENH283I",64,0)
 I L+4>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",65,0)
 W !!,"FIELD NAME - name or abbreviation of the field from the ENG BUILDING (#6928.3)"
"RTN","ENH283I",66,0)
 W !,"     file"
"RTN","ENH283I",67,0)
 S L=L+2
"RTN","ENH283I",68,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",69,0)
 W !!,"REQUIRED FIELDS MISSING DATA - count of the number of empty required fields"
"RTN","ENH283I",70,0)
 W !,"     (""N/A"" appears in this column if the field is not required by CoreFLS.)"
"RTN","ENH283I",71,0)
 S L=L+3
"RTN","ENH283I",72,0)
 I L+6>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",73,0)
 W !!,"LOOKUP FIELDS W/ INVALID DATA - ""N/A"" appears because this file does not"
"RTN","ENH283I",74,0)
 W !,"     contain lookup fields that are being checked for validity. This header"
"RTN","ENH283I",75,0)
 W !,"     has been left for consistency with the other Data Cleansing reports."
"RTN","ENH283I",76,0)
 S L=L+4
"RTN","ENH283I",77,0)
 I L+7>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",78,0)
 W !!,"NON-REQ. FIELDS WITH MISSING DATA - count of the number of empty non-required"
"RTN","ENH283I",79,0)
 W !,"     fields (""N/A"" appears in this column if non-required does not apply to"
"RTN","ENH283I",80,0)
 W !,"     this field.)"
"RTN","ENH283I",81,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH283I",82,0)
 W @IOF
"RTN","ENH283I",83,0)
 K P,L,Y,ENHDR,ENHDR1
"RTN","ENH283I",84,0)
 Q
"RTN","ENH283I",85,0)
 ;
"RTN","ENH283I",86,0)
PRT2 ; Print Instructions for Required Fields Missing Data Report
"RTN","ENH283I",87,0)
 ;
"RTN","ENH283I",88,0)
 S (P,L,ABORT)=0
"RTN","ENH283I",89,0)
 S ENHDR="REQUIRED FIELDS MISSING DATA"
"RTN","ENH283I",90,0)
 S ENHDR1="Instructions"
"RTN","ENH283I",91,0)
 U IO
"RTN","ENH283I",92,0)
 D HDR^ENH283U
"RTN","ENH283I",93,0)
 W !!,"The purpose of this report is to display a list of all ENG BUILDING (#6928.3)"
"RTN","ENH283I",94,0)
 W !,"items with missing (empty) data for the fields that are required in the CoreFLS"
"RTN","ENH283I",95,0)
 W !,"system. CoreFLS is unable to function when a required field is empty;"
"RTN","ENH283I",96,0)
 W !,"therefore, you must enter valid data in these fields prior to conversion."
"RTN","ENH283I",97,0)
 W !!,"This report examines the following required field:"
"RTN","ENH283I",98,0)
 W !,"     NAME (#.01)"
"RTN","ENH283I",99,0)
 S L=L+9
"RTN","ENH283I",100,0)
 I L+6>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",101,0)
 W !!,"The report is sorted by division. When printing or viewing this report, you"
"RTN","ENH283I",102,0)
 W !,"may select a single division or ALL. Select ""ZZ no division"" to display the"
"RTN","ENH283I",103,0)
 W !,"records with no entry in the DIVISION (#.2) field."
"RTN","ENH283I",104,0)
 S L=L+4
"RTN","ENH283I",105,0)
 I L+4>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",106,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH283I",107,0)
 S L=L+2
"RTN","ENH283I",108,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",109,0)
 W !!,"Total records analyzed - number of records in the ENG BUILDING (#6928.3) file"
"RTN","ENH283I",110,0)
 W !,"     assigned to the division"
"RTN","ENH283I",111,0)
 S L=L+3
"RTN","ENH283I",112,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",113,0)
 W !!,"Total records with Required Fields Missing Data - number of records that have"
"RTN","ENH283I",114,0)
 W !,"    an empty required field"
"RTN","ENH283I",115,0)
 S L=L+3
"RTN","ENH283I",116,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",117,0)
 W !!,"Total fields with Required Fields Missing Data - number of required fields"
"RTN","ENH283I",118,0)
 W !,"    that are empty"
"RTN","ENH283I",119,0)
 S L=L+3
"RTN","ENH283I",120,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",121,0)
 W !!,"The report then lists each record in order by its internal entry number (IEN)."
"RTN","ENH283I",122,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH283I",123,0)
 S L=L+3
"RTN","ENH283I",124,0)
 I L+4>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",125,0)
 W !!,"REC IEN - lists the ENG BUILDING (#6928.3) file internal record number"
"RTN","ENH283I",126,0)
 S L=L+2
"RTN","ENH283I",127,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",128,0)
 W !!,"BUILDING NAME - listed as ""ZZ no name"" since there is no entry in the NAME"
"RTN","ENH283I",129,0)
 W !,"     (#.01) field"
"RTN","ENH283I",130,0)
 S L=L+3
"RTN","ENH283I",131,0)
 I L+4>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",132,0)
 W !!,"FIELD NAME - name of the required field"
"RTN","ENH283I",133,0)
 S L=L+2
"RTN","ENH283I",134,0)
 I L+6>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283I",135,0)
 W !!,"You cannot correct the records that appear on this report using AEMS/MERS"
"RTN","ENH283I",136,0)
 W !,"options. Contact the IRM or ADPAC for assistance."
"RTN","ENH283I",137,0)
 W !!,"*** Conversion Note **********************************************"
"RTN","ENH283I",138,0)
 W !,"If any NAME (#.01) field remains empty at the time of conversion,"
"RTN","ENH283I",139,0)
 W !,"the record will not be converted into CoreFLS."
"RTN","ENH283I",140,0)
 W !,"******************************************************************"
"RTN","ENH283I",141,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH283I",142,0)
 W @IOF
"RTN","ENH283I",143,0)
 K Y,L,P,ENHDR,ENHDR1
"RTN","ENH283I",144,0)
 Q
"RTN","ENH283L")
0^3^B31641076
"RTN","ENH283L",1,0)
ENH283L ;WOIFO/EEN - Eng Building File Report Loop (AEMS/MERS) - CoreFLS
"RTN","ENH283L",2,0)
 ;;7.0;ENGINEERING;**78**; 09/30/03 10:55
"RTN","ENH283L",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH283L",4,0)
 ;
"RTN","ENH283L",5,0)
INIT ; Initialize Variables
"RTN","ENH283L",6,0)
 I $E(IOST,1,2)="C-" D WAIT^DICD
"RTN","ENH283L",7,0)
 K ^TMP("ENH6928.3",$J)
"RTN","ENH283L",8,0)
 S (ENIEN,DIVCT,ENHDIVCT)=0
"RTN","ENH283L",9,0)
 ;
"RTN","ENH283L",10,0)
LOOP ; Initialize TMP global with records in file 6928.3 Building File
"RTN","ENH283L",11,0)
 ;
"RTN","ENH283L",12,0)
 F  S ENIEN=$O(^ENG(6928.3,ENIEN)) Q:'ENIEN  D
"RTN","ENH283L",13,0)
 . S (CRITFLD,BPTFLD,DESFLD,CRITFLG,BPTFLG,DESFLG)=0
"RTN","ENH283L",14,0)
 . S (ENHDIV,NAME)=""
"RTN","ENH283L",15,0)
 . ;
"RTN","ENH283L",16,0)
 . ; Get Division if NULL then set to "ZZ no division"
"RTN","ENH283L",17,0)
 . S ENHDIV=$P($G(^ENG(6928.3,ENIEN,0)),U,16)
"RTN","ENH283L",18,0)
 . I ENHDIV="" S ENHDIV="ZZ no division"
"RTN","ENH283L",19,0)
 . ;
"RTN","ENH283L",20,0)
 . ; Set Division node in ^TMP and initialize nodes for Division
"RTN","ENH283L",21,0)
 . I '$D(^TMP("ENH6928.3",$J,"DIV",ENHDIV)) D
"RTN","ENH283L",22,0)
 .. S DIVCT=DIVCT+1
"RTN","ENH283L",23,0)
 .. S ^TMP("ENH6928.3",$J,"DIV",ENHDIV)=DIVCT
"RTN","ENH283L",24,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,0)=ENHDIV
"RTN","ENH283L",25,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"SUM")="0^0^0^0"
"RTN","ENH283L",26,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"CRIT")="0"
"RTN","ENH283L",27,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"BPT")=0
"RTN","ENH283L",28,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"DES")=0
"RTN","ENH283L",29,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"CRIT",.01)=0
"RTN","ENH283L",30,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"DES",5.3)=0
"RTN","ENH283L",31,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"DES",5.4)=0
"RTN","ENH283L",32,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"DES",5.5)=0
"RTN","ENH283L",33,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"DES",5.6)=0
"RTN","ENH283L",34,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"DES",5.7)=0
"RTN","ENH283L",35,0)
 .. S ^TMP("ENH6928.3",$J,DIVCT,"DES",13.5)=0
"RTN","ENH283L",36,0)
 . ;
"RTN","ENH283L",37,0)
 . ; Nodes that have been initialized or that already exist
"RTN","ENH283L",38,0)
 . I $D(^TMP("ENH6928.3",$J,"DIV",ENHDIV)) D
"RTN","ENH283L",39,0)
 .. S ENDIVCT=^TMP("ENH6928.3",$J,"DIV",ENHDIV)
"RTN","ENH283L",40,0)
 . ;
"RTN","ENH283L",41,0)
 . ; Get NAME (.01 field)
"RTN","ENH283L",42,0)
 . S NAME=$P($G(^ENG(6928.3,ENIEN,0)),U)
"RTN","ENH283L",43,0)
 . ;
"RTN","ENH283L",44,0)
 . ; **Add up Critical Null fields**
"RTN","ENH283L",45,0)
 . ; -- NAME (Check for Crit Null) --
"RTN","ENH283L",46,0)
 . I $P($G(^ENG(6928.3,ENIEN,0)),U)="" D
"RTN","ENH283L",47,0)
 .. S CRITFLD=CRITFLD+1,CRITFLG=1
"RTN","ENH283L",48,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"CRIT",.01)=^TMP("ENH6928.3",$J,ENDIVCT,"CRIT",.01)+1
"RTN","ENH283L",49,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"CRIT",.01,ENIEN)=ENIEN_U_NAME_U_"Name"_U_"6928.3,.01"_U_"N/A"_U_"N/A"
"RTN","ENH283L",50,0)
 . ;
"RTN","ENH283L",51,0)
 . ; **Add up Broken Pointer fields**
"RTN","ENH283L",52,0)
 . ; -- Currently no Pointer Fields to check in Building File --
"RTN","ENH283L",53,0)
 . ;
"RTN","ENH283L",54,0)
 . ; **Add up the Desirable Null fields**
"RTN","ENH283L",55,0)
 . ; -- Property Address 1 (Check for Desirable Null)
"RTN","ENH283L",56,0)
 . I $P($G(^ENG(6928.3,ENIEN,3)),U,3)="" D
"RTN","ENH283L",57,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH283L",58,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.3)=^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.3)+1
"RTN","ENH283L",59,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.3,ENIEN)=ENIEN_U_NAME_U_"Property Addr 1"_U_"6928.3,5.3"_U_"N/A"_U_"N/A"
"RTN","ENH283L",60,0)
 . ;
"RTN","ENH283L",61,0)
 . ; -- Property Address 2 (Check for Desirable Null)
"RTN","ENH283L",62,0)
 . I $P($G(^ENG(6928.3,ENIEN,3)),U,4)="" D
"RTN","ENH283L",63,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH283L",64,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.4)=^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.4)+1
"RTN","ENH283L",65,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.4,ENIEN)=ENIEN_U_NAME_U_"Property Addr 2"_U_"6928.3,5.4"_U_"N/A"_U_"N/A"
"RTN","ENH283L",66,0)
 . ;
"RTN","ENH283L",67,0)
 . ; -- Property City (Check for Desirable Null)
"RTN","ENH283L",68,0)
 . I $P($G(^ENG(6928.3,ENIEN,3)),U,5)="" D
"RTN","ENH283L",69,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH283L",70,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.5)=^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.5)+1
"RTN","ENH283L",71,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.5,ENIEN)=ENIEN_U_NAME_U_"Property City"_U_"6928.3,5.5"_U_"N/A"_U_"N/A"
"RTN","ENH283L",72,0)
 . ;
"RTN","ENH283L",73,0)
 . ; -- Property State (Check for Desirable Null)
"RTN","ENH283L",74,0)
 . I $P($G(^ENG(6928.3,ENIEN,3)),U,6)="" D
"RTN","ENH283L",75,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH283L",76,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.6)=^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.6)+1
"RTN","ENH283L",77,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.6,ENIEN)=ENIEN_U_NAME_U_"Property State"_U_"6928.3,5.6"_U_"N/A"_U_"N/A"
"RTN","ENH283L",78,0)
 . ;
"RTN","ENH283L",79,0)
 . ; -- Property Zip Code (Check for Desirable Null)
"RTN","ENH283L",80,0)
 . I $P($G(^ENG(6928.3,ENIEN,3)),U,7)="" D
"RTN","ENH283L",81,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH283L",82,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.7)=^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.7)+1
"RTN","ENH283L",83,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",5.7,ENIEN)=ENIEN_U_NAME_U_"Property Zip Code"_U_"6928.3,5.7"_U_"N/A"_U_"N/A"
"RTN","ENH283L",84,0)
 . ;
"RTN","ENH283L",85,0)
 . ; -- Property Gross Square Feet (Check for Desirable Null)
"RTN","ENH283L",86,0)
 . I $P($G(^ENG(6928.3,ENIEN,3)),U)="" D
"RTN","ENH283L",87,0)
 .. S DESFLD=DESFLD+1,DESFLG=1
"RTN","ENH283L",88,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",13.5)=^TMP("ENH6928.3",$J,ENDIVCT,"DES",13.5)+1
"RTN","ENH283L",89,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES",13.5,ENIEN)=ENIEN_U_NAME_U_"Gross Square Feet"_U_"6928.3,13.5"_U_"N/A"_U_"N/A"
"RTN","ENH283L",90,0)
 . ;
"RTN","ENH283L",91,0)
 . ; Add counters for Total Analyzed, Critical, Broken, and Desirable
"RTN","ENH283L",92,0)
 . S $P(^TMP("ENH6928.3",$J,ENDIVCT,"SUM"),U)=$P(^TMP("ENH6928.3",$J,ENDIVCT,"SUM"),U)+1
"RTN","ENH283L",93,0)
 . I CRITFLG D
"RTN","ENH283L",94,0)
 .. S $P(^TMP("ENH6928.3",$J,ENDIVCT,"SUM"),U,2)=$P(^TMP("ENH6928.3",$J,ENDIVCT,"SUM"),U,2)+1
"RTN","ENH283L",95,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"CRIT")=^TMP("ENH6928.3",$J,ENDIVCT,"CRIT")+CRITFLD
"RTN","ENH283L",96,0)
 . I BPTFLG D
"RTN","ENH283L",97,0)
 .. S $P(^TMP("ENH6928.3",$J,ENDIVCT,"SUM"),U,3)=$P(^TMP("ENH6928.3",$J,ENDIVCT,"SUM"),U,3)+1
"RTN","ENH283L",98,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"BPT")=^TMP("ENH6928.3",$J,ENDIVCT,"BPT")+BPTFLD
"RTN","ENH283L",99,0)
 . I DESFLG D
"RTN","ENH283L",100,0)
 .. S $P(^TMP("ENH6928.3",$J,ENDIVCT,"SUM"),U,4)=$P(^TMP("ENH6928.3",$J,ENDIVCT,"SUM"),U,4)+1
"RTN","ENH283L",101,0)
 .. S ^TMP("ENH6928.3",$J,ENDIVCT,"DES")=^TMP("ENH6928.3",$J,ENDIVCT,"DES")+DESFLD
"RTN","ENH283L",102,0)
 . ;
"RTN","ENH283L",103,0)
 . Q
"RTN","ENH283L",104,0)
 ;
"RTN","ENH283L",105,0)
SORT ; RE-SORT THE ^TMP GLOBAL BY RECORD
"RTN","ENH283L",106,0)
 S EN1="",ENFILE="ENH6928.3",ENFILE1="ENH6928.3R"
"RTN","ENH283L",107,0)
 K ^TMP(ENFILE1)
"RTN","ENH283L",108,0)
 F  S EN1=$O(^TMP(ENFILE,$J,EN1)) Q:EN1=""  D
"RTN","ENH283L",109,0)
 . S EN2=""
"RTN","ENH283L",110,0)
 . F  S EN2=$O(^TMP(ENFILE,$J,EN1,EN2)) Q:EN2=""  D
"RTN","ENH283L",111,0)
 .. S EN3=0
"RTN","ENH283L",112,0)
 .. F  S EN3=$O(^TMP(ENFILE,$J,EN1,EN2,EN3)) Q:'EN3  D
"RTN","ENH283L",113,0)
 ... S EN4=0
"RTN","ENH283L",114,0)
 ... F  S EN4=$O(^TMP(ENFILE,$J,EN1,EN2,EN3,EN4)) Q:'EN4  D
"RTN","ENH283L",115,0)
 .... S ^TMP(ENFILE1,$J,EN1,EN2,EN4,EN3)=^TMP(ENFILE,$J,EN1,EN2,EN3,EN4)
"RTN","ENH283L",116,0)
 ;
"RTN","ENH283L",117,0)
EXIT ; Kill all local variables
"RTN","ENH283L",118,0)
 K ENIEN,ENHDIV,ENDIVCT,CRITFLD,BPTFLD,DESFLD,CRITFLG,BPTFLG,DESFLG
"RTN","ENH283L",119,0)
 K DIVCT,EN1,EN2,EN3,EN4,EN5,ENFILE,ENFILE1
"RTN","ENH283L",120,0)
 Q
"RTN","ENH283M")
0^4^B44387138
"RTN","ENH283M",1,0)
ENH283M ;WOIFO/EEN - Eng Building File Instructions (AMES/MERS) - CoreFLS ;
"RTN","ENH283M",2,0)
 ;;7.0;Engineering;**78**;09/30/03 10:55
"RTN","ENH283M",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH283M",4,0)
 ;
"RTN","ENH283M",5,0)
 Q  ; This report is not callable from the top
"RTN","ENH283M",6,0)
 ;
"RTN","ENH283M",7,0)
PRT3 ; Print Instructions for Broken Pointers Report
"RTN","ENH283M",8,0)
 ;
"RTN","ENH283M",9,0)
 S (P,L,ABORT)=0
"RTN","ENH283M",10,0)
 S ENHDR="LOOKUP FIELDS W/ INVALID DATA"
"RTN","ENH283M",11,0)
 S ENHDR1="Instructions"
"RTN","ENH283M",12,0)
 U IO
"RTN","ENH283M",13,0)
 D HDR^ENH283U
"RTN","ENH283M",14,0)
 W !!,"The purpose of this report is to print a list of all fields in theBUILDING"
"RTN","ENH283M",15,0)
 W !,"FILE (#6928.3) file that contain an invalid value in a lookup-type or pointer"
"RTN","ENH283M",16,0)
 W !,"field.  An invalid value is defined as a value that either does nothave an"
"RTN","ENH283M",17,0)
 W !,"entry in the file to which it points, or the entry in the file pointed to has"
"RTN","ENH283M",18,0)
 W !,"an empty NAME (#.01) field.  An entry and a name must be present in any file"
"RTN","ENH283M",19,0)
 W !,"to which a field points."
"RTN","ENH283M",20,0)
 W !!,"This report examines the following fields:"
"RTN","ENH283M",21,0)
 W !,"     **Currently no Lookup Fields are analyzed for this file**"
"RTN","ENH283M",22,0)
 S L=L+10
"RTN","ENH283M",23,0)
 I L+6>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",24,0)
 W !!,"This report is sorted by division.  When printing or viewing this report, you"
"RTN","ENH283M",25,0)
 W !,"may select a single division or ALL divisions. The first page of the report"
"RTN","ENH283M",26,0)
 W !,"prints the totals for the records. The totals for the report are as follows:"
"RTN","ENH283M",27,0)
 S L=L+4
"RTN","ENH283M",28,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",29,0)
 W !!,"Total records analyzed - number of all records in the ENG BUILDING (#6928.3)"
"RTN","ENH283M",30,0)
 W !,"     file that are within the division selected"
"RTN","ENH283M",31,0)
 S L=L+3
"RTN","ENH283M",32,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",33,0)
 W !!,"Total records with Lookup Fields w/ Invalid Data - number of records within the"
"RTN","ENH283M",34,0)
 W !,"     division selected that have an invalid value in any of the lookup fields"
"RTN","ENH283M",35,0)
 S L=L+3
"RTN","ENH283M",36,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",37,0)
 W !!,"Total Lookup Fields w/ Invalid Data - number of all lookup fields in records"
"RTN","ENH283M",38,0)
 W !,"     within the division selected that have invalid data or are empty"
"RTN","ENH283M",39,0)
 S L=L+3
"RTN","ENH283M",40,0)
 I L+6>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",41,0)
 W !!,"Each row on the report contains the following columns:"
"RTN","ENH283M",42,0)
 W !!,"REC IEN - lists the ENG BUILDING (#6928.3) file internal record number"
"RTN","ENH283M",43,0)
 S L=L+4
"RTN","ENH283M",44,0)
 I L+6>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",45,0)
 W !!,"BUILDING NAME - name of the Building File record"
"RTN","ENH283M",46,0)
 W !!,"FIELD NAME - name of the lookup field"
"RTN","ENH283M",47,0)
 S L=L+4
"RTN","ENH283M",48,0)
 I L+4>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",49,0)
 W !!,"MULTIPLE NUM - the index number of the multiple"
"RTN","ENH283M",50,0)
 S L=L+2
"RTN","ENH283M",51,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",52,0)
 W !!,"Using this report as a reference, you must correct every field prior to"
"RTN","ENH283M",53,0)
 W !,"conversion."
"RTN","ENH283M",54,0)
 S L=L+3
"RTN","ENH283M",55,0)
 I L+7>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",56,0)
 W !!,"The records with invalid data that appear on this report must be fixed prior to"
"RTN","ENH283M",57,0)
 W !,"conversion to CoreFLS. Once data is fixed for all invalid fields, this report"
"RTN","ENH283M",58,0)
 W !,"should not show any remaining records to be fixed."
"RTN","ENH283M",59,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH283M",60,0)
 W @IOF
"RTN","ENH283M",61,0)
 K Y,P,L,ENHDR,ENHDR1
"RTN","ENH283M",62,0)
 Q
"RTN","ENH283M",63,0)
 ;
"RTN","ENH283M",64,0)
PRT4 ; Print Instructions for Desirable Nulls Report
"RTN","ENH283M",65,0)
 ;
"RTN","ENH283M",66,0)
 S (P,L,ABORT)=0
"RTN","ENH283M",67,0)
 S ENHDR="NON-REQUIRED FIELDS MISSING DATA"
"RTN","ENH283M",68,0)
 S ENHDR1="Instructions"
"RTN","ENH283M",69,0)
 U IO
"RTN","ENH283M",70,0)
 D HDR^ENH283U
"RTN","ENH283M",71,0)
 W !!,"The purpose of this report is to display a list of all ENG BUILDING (#6928.3)"
"RTN","ENH283M",72,0)
 W !,"items with missing (empty) data for the fields that are not required in the"
"RTN","ENH283M",73,0)
 W !,"CoreFLS system.  If fields appearing on this report are left empty, the"
"RTN","ENH283M",74,0)
 W !,"conversion will either default to a value or convert the field as empty into"
"RTN","ENH283M",75,0)
 W !,"the CoreFLS system."
"RTN","ENH283M",76,0)
 W !!,"The report examines the following non-required fields:"
"RTN","ENH283M",77,0)
 W !,"NOTE: Abbreviations for field names used on this report appear in quotes next"
"RTN","ENH283M",78,0)
 W !,"to the field number"
"RTN","ENH283M",79,0)
 W !!,"     PROPERTY ADDRESS 1 (#5.3) - ""Property Addr 1"""
"RTN","ENH283M",80,0)
 W !,"     PROPERTY ADDRESS 2 (#5.4) - ""Property Addr 2"""
"RTN","ENH283M",81,0)
 W !,"     PROPERTY CITY (#5.5)"
"RTN","ENH283M",82,0)
 W !,"     PROPERTY STATE (#5.6)"
"RTN","ENH283M",83,0)
 W !,"     PROPERTY ZIP CODE (#5.7)"
"RTN","ENH283M",84,0)
 W !,"     GROSS SQUARE FEET (#13.5) - ""Gross Sq. Ft."""
"RTN","ENH283M",85,0)
 S L=L+17
"RTN","ENH283M",86,0)
 I L+6>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",87,0)
 W !!,"The report is sorted by division. When printing or viewing this report, you may"
"RTN","ENH283M",88,0)
 W !,"select a single division or ALL. Select ""ZZ no division"" to display the record"
"RTN","ENH283M",89,0)
 W !,"with no entry in the DIVISION (#.2) field."
"RTN","ENH283M",90,0)
 S L=L+4
"RTN","ENH283M",91,0)
 I L+4>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",92,0)
 W !!,"The totals for each division are as follows:"
"RTN","ENH283M",93,0)
 S L=L+2
"RTN","ENH283M",94,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",95,0)
 W !!,"Total records analyzed - number of records in the BUILDING FILE (#6928.3) file"
"RTN","ENH283M",96,0)
 W !,"     assigned to the division"
"RTN","ENH283M",97,0)
 S L=L+3
"RTN","ENH283M",98,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",99,0)
 W !!,"Total records with Non-Required Fields Missing Data - number of records that"
"RTN","ENH283M",100,0)
 W !,"     have one or more empty non-required fields"
"RTN","ENH283M",101,0)
 S L=L+3
"RTN","ENH283M",102,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",103,0)
 W !!,"Total fields with Non-Required Fields Missing Data - number of non-required"
"RTN","ENH283M",104,0)
 W !,"     fields that are empty"
"RTN","ENH283M",105,0)
 S L=L+3
"RTN","ENH283M",106,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",107,0)
 W !!,"The report then lists each record in order by its internal entry number (IEN)."
"RTN","ENH283M",108,0)
 W !,"Each row on the report contains the following columns:"
"RTN","ENH283M",109,0)
 S L=L+3
"RTN","ENH283M",110,0)
 I L+4>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",111,0)
 W !!,"REC IEN - lists the ENG BUILDING (#6928.3) file internal record number"
"RTN","ENH283M",112,0)
 S L=L+4
"RTN","ENH283M",113,0)
 I L+4>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",114,0)
 W !!,"BUILDING NAME - name of the Building File record (#.01 field)"
"RTN","ENH283M",115,0)
 S L=L+2
"RTN","ENH283M",116,0)
 I L+4>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",117,0)
 W !!,"FIELD NAME - name or abbreviation of the non-required field"
"RTN","ENH283M",118,0)
 S L=L+2
"RTN","ENH283M",119,0)
 I L+5>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",120,0)
 W !!,"You should correct every field that appears on this report prior to conversion."
"RTN","ENH283M",121,0)
 W !,"Use AEMS/MERS to enter a valid value in each empty field listed."
"RTN","ENH283M",122,0)
 S L=L+3
"RTN","ENH283M",123,0)
 I L+8>IOSL D HDR^ENH283U Q:ABORT
"RTN","ENH283M",124,0)
 W !!,"*** Conversion Note **********************************************"
"RTN","ENH283M",125,0)
 W !,"If any non-required field on this report is left with missing"
"RTN","ENH283M",126,0)
 W !,"data, it will be converted as empty into CoreFLS."
"RTN","ENH283M",127,0)
 W !,"******************************************************************"
"RTN","ENH283M",128,0)
 W !!,"<End of Instructions>" I $E(IOST,1,2)="C-" W "  Enter RETURN to continue or '^' to exit: " R Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH283M",129,0)
 W @IOF
"RTN","ENH283M",130,0)
 K Y,P,L,ENHDR,ENHDR1
"RTN","ENH283M",131,0)
 Q
"RTN","ENH283P")
0^5^B47281041
"RTN","ENH283P",1,0)
ENH283P ;WOIFO/EEN - Eng Build File Report Print (AMES/MERS) - CoreFLS ;09/30/03  10:55
"RTN","ENH283P",2,0)
 ;;7.0;Engineering;**78**; 09/30/03 10:55
"RTN","ENH283P",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH283P",4,0)
 ;
"RTN","ENH283P",5,0)
 ; This routine prints Summary and Detailed Reports for the
"RTN","ENH283P",6,0)
 ; Building File (#6928.3)
"RTN","ENH283P",7,0)
 ;
"RTN","ENH283P",8,0)
 Q  ;This routine is not callable from the top
"RTN","ENH283P",9,0)
 ;
"RTN","ENH283P",10,0)
INIT ; Initialize Variables
"RTN","ENH283P",11,0)
 S (P,L,ABORT,ENFLG,TOTANA,TOTREC,TOTFLD,CRITREC,BPTREC,DESREC)=0
"RTN","ENH283P",12,0)
 S (TYP,FLDNAME,FLDNUM,NAMECRT,PADD1DES,PADD2DES,CITYDES,STATDES)=""
"RTN","ENH283P",13,0)
 S (DIV,DIVI,ZIPDES,GSQFTDES,FLDNAME,RECIEN,NAME)=""
"RTN","ENH283P",14,0)
 S ENFILE="ENH6928.3R"
"RTN","ENH283P",15,0)
 Q
"RTN","ENH283P",16,0)
 ;
"RTN","ENH283P",17,0)
OPT1 ; Print Summary Report
"RTN","ENH283P",18,0)
 I ENHINST=1 D PRT1^ENH283I I ABORT Q
"RTN","ENH283P",19,0)
 I '$D(^TMP("ENH6928.3",$J)) D ^ENH283L
"RTN","ENH283P",20,0)
 D INIT
"RTN","ENH283P",21,0)
 S ENHDR="SUMMARY"
"RTN","ENH283P",22,0)
 I ENHDIVFG="ALL" D
"RTN","ENH283P",23,0)
 . S ENHDIV=" for ALL Divisions",DIVI=""
"RTN","ENH283P",24,0)
 . F  S DIVI=$O(^TMP("ENH6928.3",$J,"DIV",DIVI)) Q:DIVI=""!(ENFLG=1)  D
"RTN","ENH283P",25,0)
 .. S DIV=^TMP("ENH6928.3",$J,"DIV",DIVI)
"RTN","ENH283P",26,0)
 .. D L1
"RTN","ENH283P",27,0)
 I ENHDIVFG'="ALL" D
"RTN","ENH283P",28,0)
 . S ENHDIV=" for "_ENHDIVFG_" Division"
"RTN","ENH283P",29,0)
 . S DIV=^TMP("ENH6928.3",$J,"DIV",ENHDIVFG)
"RTN","ENH283P",30,0)
 . D L1
"RTN","ENH283P",31,0)
 D EORT^ENH283U
"RTN","ENH283P",32,0)
 K DIVI
"RTN","ENH283P",33,0)
 Q
"RTN","ENH283P",34,0)
L1 U IO
"RTN","ENH283P",35,0)
 D HDR^ENH283U
"RTN","ENH283P",36,0)
 I ABORT S ENFLG=1 Q
"RTN","ENH283P",37,0)
 S TOTANA=$P($G(^TMP("ENH6928.3",$J,DIV,"SUM")),U)
"RTN","ENH283P",38,0)
 S CRITREC=$P($G(^TMP("ENH6928.3",$J,DIV,"SUM")),U,2)
"RTN","ENH283P",39,0)
 S BPTREC=$P($G(^TMP("ENH6928.3",$J,DIV,"SUM")),U,3)
"RTN","ENH283P",40,0)
 S DESREC=$P($G(^TMP("ENH6928.3",$J,DIV,"SUM")),U,4)
"RTN","ENH283P",41,0)
 S NAMECRT=^TMP("ENH6928.3",$J,DIV,"CRIT",.01)
"RTN","ENH283P",42,0)
 S PADD1DES=^TMP("ENH6928.3",$J,DIV,"DES",5.3)
"RTN","ENH283P",43,0)
 S PADD2DES=^TMP("ENH6928.3",$J,DIV,"DES",5.4)
"RTN","ENH283P",44,0)
 S CITYDES=^TMP("ENH6928.3",$J,DIV,"DES",5.5)
"RTN","ENH283P",45,0)
 S STATDES=^TMP("ENH6928.3",$J,DIV,"DES",5.6)
"RTN","ENH283P",46,0)
 S ZIPDES=^TMP("ENH6928.3",$J,DIV,"DES",5.7)
"RTN","ENH283P",47,0)
 S GSQFTDES=^TMP("ENH6928.3",$J,DIV,"DES",13.5)
"RTN","ENH283P",48,0)
 D SHDR
"RTN","ENH283P",49,0)
 W !,"NREQ",?15,"Gross Sq. Ft.",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH283P",50,0)
 W ?69,$J(GSQFTDES,5)
"RTN","ENH283P",51,0)
 W !,"REQ",?15,"Name",?35,$J(NAMECRT,5),?52,$J("N/A",5),?69,$J("N/A",5)
"RTN","ENH283P",52,0)
 W !,"NREQ",?15,"Property Addr 1",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH283P",53,0)
 W ?69,$J(PADD1DES,5)
"RTN","ENH283P",54,0)
 W !,"NREQ",?15,"Property Addr 2",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH283P",55,0)
 W ?69,$J(PADD2DES,5)
"RTN","ENH283P",56,0)
 W !,"NREQ",?15,"Property City",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH283P",57,0)
 W ?69,$J(CITYDES,5)
"RTN","ENH283P",58,0)
 W !,"NREQ",?15,"Property State",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH283P",59,0)
 W ?69,$J(STATDES,5)
"RTN","ENH283P",60,0)
 W !,"NREQ",?15,"Property Zip Code",?35,$J("N/A",5),?52,$J("N/A",5)
"RTN","ENH283P",61,0)
 W ?69,$J(ZIPDES,5)
"RTN","ENH283P",62,0)
 S L=L+6
"RTN","ENH283P",63,0)
 I ENHDIVFG'="ALL" S ENFLG=1 ; Stop print if single division is picked
"RTN","ENH283P",64,0)
 Q
"RTN","ENH283P",65,0)
 ;
"RTN","ENH283P",66,0)
OPT2 ; Required Fields Missing Data Report
"RTN","ENH283P",67,0)
 I ENHINST=1 D PRT2^ENH283I I ABORT Q
"RTN","ENH283P",68,0)
 D INIT
"RTN","ENH283P",69,0)
 I '$D(^TMP("ENH6928.3",$J))!('$D(^TMP(ENFILE,$J))) D ^ENH283L
"RTN","ENH283P",70,0)
 S ENHDR="REQUIRED FIELDS MISSING DATA",TYP="CRIT",ENFILE="ENH6928.3R"
"RTN","ENH283P",71,0)
 G PRT
"RTN","ENH283P",72,0)
 Q
"RTN","ENH283P",73,0)
 ;
"RTN","ENH283P",74,0)
OPT3 ; Lookup Fields with Invalid Data Report
"RTN","ENH283P",75,0)
 I ENHINST=1 D PRT3^ENH283M I ABORT Q
"RTN","ENH283P",76,0)
 D INIT
"RTN","ENH283P",77,0)
 I '$D(^TMP("ENH6928.3",$J))!('$D(^TMP(ENFILE,$J))) D ^ENH283L
"RTN","ENH283P",78,0)
 S ENHDR="LOOKUP FIELDS W/ INVALID DATA",TYP="BPT",ENFILE="ENH6928.3R"
"RTN","ENH283P",79,0)
 G PRT
"RTN","ENH283P",80,0)
 Q
"RTN","ENH283P",81,0)
 ;
"RTN","ENH283P",82,0)
OPT4 ; Non-Required Fields Missing Data Report
"RTN","ENH283P",83,0)
 I ENHINST=1 D PRT4^ENH283M I ABORT Q
"RTN","ENH283P",84,0)
 D INIT
"RTN","ENH283P",85,0)
 I '$D(^TMP("ENH6928.3",$J))!('$D(^TMP(ENFILE,$J))) D ^ENH283L
"RTN","ENH283P",86,0)
 S ENHDR="NON-REQUIRED FIELDS MISSING DATA",TYP="DES",ENFILE="ENH6928.3R"
"RTN","ENH283P",87,0)
 G PRT
"RTN","ENH283P",88,0)
 Q
"RTN","ENH283P",89,0)
 ;
"RTN","ENH283P",90,0)
PRT ;Start Printing Detailed Reports by Division
"RTN","ENH283P",91,0)
 I ENHDIVFG="ALL" D
"RTN","ENH283P",92,0)
 . S ENHDIV=" for ALL Divisions",DIVI=""
"RTN","ENH283P",93,0)
 . F  S DIVI=$O(^TMP("ENH6928.3",$J,"DIV",DIVI)) Q:DIVI=""!(ENFLG=1)  D
"RTN","ENH283P",94,0)
 .. S DIV=^TMP("ENH6928.3",$J,"DIV",DIVI)
"RTN","ENH283P",95,0)
 .. D LOOP
"RTN","ENH283P",96,0)
 I ENHDIVFG'="ALL" D
"RTN","ENH283P",97,0)
 . S ENHDIV=" for "_ENHDIVFG_" Division"
"RTN","ENH283P",98,0)
 . S DIV=^TMP("ENH6928.3",$J,"DIV",ENHDIVFG)
"RTN","ENH283P",99,0)
 . D LOOP
"RTN","ENH283P",100,0)
 D EORT^ENH283U
"RTN","ENH283P",101,0)
 K DIVI
"RTN","ENH283P",102,0)
 Q
"RTN","ENH283P",103,0)
 ;
"RTN","ENH283P",104,0)
LOOP ;Loop to print out all bad records
"RTN","ENH283P",105,0)
 U IO
"RTN","ENH283P",106,0)
 S TOTANA=$P($G(^TMP("ENH6928.3",$J,DIV,"SUM")),U)
"RTN","ENH283P",107,0)
 I TYP="CRIT" S TOTREC=$P($G(^TMP("ENH6928.3",$J,DIV,"SUM")),U,2)
"RTN","ENH283P",108,0)
 I TYP="BPT" S TOTREC=$P($G(^TMP("ENH6928.3",$J,DIV,"SUM")),U,3)
"RTN","ENH283P",109,0)
 I TYP="DES" S TOTREC=$P($G(^TMP("ENH6928.3",$J,DIV,"SUM")),U,4)
"RTN","ENH283P",110,0)
 S TOTFLD=^TMP("ENH6928.3",$J,DIV,TYP)
"RTN","ENH283P",111,0)
 D HDR^ENH283U I ABORT S ENFLG=1 Q
"RTN","ENH283P",112,0)
 I TYP="CRIT" D CHDR
"RTN","ENH283P",113,0)
 I TYP="BPT" D BHDR
"RTN","ENH283P",114,0)
 I TYP="DES" D DHDR
"RTN","ENH283P",115,0)
 I TOTFLD=0&(TOTREC=0) D  Q
"RTN","ENH283P",116,0)
 . W !!,"**NO DATA TO PRINT**",!
"RTN","ENH283P",117,0)
 . S L=L+3
"RTN","ENH283P",118,0)
 . I ENHDIVFG'="ALL" S ENFLG=1
"RTN","ENH283P",119,0)
 S RECIEN=0
"RTN","ENH283P",120,0)
 F  S RECIEN=$O(^TMP(ENFILE,$J,DIV,TYP,RECIEN)) Q:'RECIEN!(ENFLG=1)  D
"RTN","ENH283P",121,0)
 . S FLD=0
"RTN","ENH283P",122,0)
 . F  S FLD=$O(^TMP(ENFILE,$J,DIV,TYP,RECIEN,FLD)) Q:'FLD!(ENFLG=1)  D
"RTN","ENH283P",123,0)
 .. S NAME=$P(^TMP(ENFILE,$J,DIV,TYP,RECIEN,FLD),U,2)
"RTN","ENH283P",124,0)
 .. I NAME="" S NAME="ZZ no name"
"RTN","ENH283P",125,0)
 .. S FLDNAME=$P(^TMP(ENFILE,$J,DIV,TYP,RECIEN,FLD),U,3)
"RTN","ENH283P",126,0)
 .. ;S SFIEN=$P(^TMP(ENFILE,$J,DIV,TYP,RECIEN,FLD),U,5)
"RTN","ENH283P",127,0)
 .. W !,$J(RECIEN,8),?10,NAME,?45,FLDNAME
"RTN","ENH283P",128,0)
 .. S L=L+1
"RTN","ENH283P",129,0)
 .. I L+3>IOSL D  Q
"RTN","ENH283P",130,0)
 ... D HDR^ENH283U I ABORT S ENFLG=1 Q
"RTN","ENH283P",131,0)
 ... D OHDR
"RTN","ENH283P",132,0)
 I ENHDIVFG'="ALL" S ENFLG=1 ; Stop Print if single division is picked
"RTN","ENH283P",133,0)
 Q
"RTN","ENH283P",134,0)
 ;
"RTN","ENH283P",135,0)
SHDR ; Summary Report Header
"RTN","ENH283P",136,0)
 W !!,"Totals for the """_^TMP("ENH6928.3",$J,DIV,0)_""" Division:"
"RTN","ENH283P",137,0)
 W ! F I=1:1:60 W "-"
"RTN","ENH283P",138,0)
 W !,"Total records analyzed",?55,$J(TOTANA,5)
"RTN","ENH283P",139,0)
 W !,"Total records with Required Fields Missing Data",?55,$J(CRITREC,5)
"RTN","ENH283P",140,0)
 W !,"Total records with Lookup Fields w/ Invalid Data",?55,$J("N/A",5)
"RTN","ENH283P",141,0)
 W !,"Total records with Non-Required Fields Missing Data",?55,$J(DESREC,5)
"RTN","ENH283P",142,0)
 W !!,"DATA QUALITY",?15,"FIELD",?31,"REQUIRED FIELDS",?48,"LOOKUP FIELDS",?65,"NON-REQ. FIELDS"
"RTN","ENH283P",143,0)
 W !,"CHECK TYPE",?15,"NAME",?31,"MISSING DATA",?48,"W/ INVALID DATA",?65,"MISSING DATA"
"RTN","ENH283P",144,0)
 W ! F I=1:1:80 W "="
"RTN","ENH283P",145,0)
 S L=L+11
"RTN","ENH283P",146,0)
 Q
"RTN","ENH283P",147,0)
 ;
"RTN","ENH283P",148,0)
CHDR ; Required Fields w/ Missing Data Report Header
"RTN","ENH283P",149,0)
 W !!,"Totals for the """_^TMP("ENH6928.3",$J,DIV,0)_""" Division:"
"RTN","ENH283P",150,0)
 W ! F I=1:1:60 W "-"
"RTN","ENH283P",151,0)
 W !,"Total records analyzed",?55,$J(TOTANA,5)
"RTN","ENH283P",152,0)
 W !,"Total records with Required Fields Missing Data",?55,$J(TOTREC,5)
"RTN","ENH283P",153,0)
 W !,"Total fields with Required Fields Missing Data",?55,$J(TOTFLD,5)
"RTN","ENH283P",154,0)
 W !!,"REC",?10,"BUILDING",?45,"FIELD"
"RTN","ENH283P",155,0)
 W !,"IEN",?10,"NAME",?45,"NAME"
"RTN","ENH283P",156,0)
 W ! F I=1:1:80 W "="
"RTN","ENH283P",157,0)
 S L=L+10
"RTN","ENH283P",158,0)
 Q
"RTN","ENH283P",159,0)
 ;
"RTN","ENH283P",160,0)
BHDR ; Lookup Fields w/ Invalid Data Report Header
"RTN","ENH283P",161,0)
 W !!,"Totals for the """_^TMP("ENH6928.3",$J,DIV,0)_""" Division:"
"RTN","ENH283P",162,0)
 W ! F I=1:1:60 W "-"
"RTN","ENH283P",163,0)
 W !,"Total records analyzed",?55,$J(TOTANA,5)
"RTN","ENH283P",164,0)
 W !,"Total records with Lookup Fields w/ Invalid Data",?55,$J(TOTREC,5)
"RTN","ENH283P",165,0)
 W !,"Total fields with Lookup Fields with Invalid Data",?55,$J(TOTFLD,5)
"RTN","ENH283P",166,0)
 W !!,"REC",?10,"BUILDING",?45,"FIELD"
"RTN","ENH283P",167,0)
 W !,"IEN",?10,"NAME",?45,"NAME"
"RTN","ENH283P",168,0)
 W ! F I=1:1:80 W "="
"RTN","ENH283P",169,0)
 S L=L+10
"RTN","ENH283P",170,0)
 Q
"RTN","ENH283P",171,0)
 ;
"RTN","ENH283P",172,0)
DHDR ; Non-Required Fields w/ Missing Data Report Header
"RTN","ENH283P",173,0)
 W !!,"Totals for the """_^TMP("ENH6928.3",$J,DIV,0)_""" Division:"
"RTN","ENH283P",174,0)
 W ! F I=1:1:60 W "-"
"RTN","ENH283P",175,0)
 W !,"Total records analyzed",?55,$J(TOTANA,5)
"RTN","ENH283P",176,0)
 W !,"Total records with Non-Required Fields Missing Data",?55,$J(TOTREC,5)
"RTN","ENH283P",177,0)
 W !,"Total fields with Non-Required Fields Missing Data",?55,$J(TOTFLD,5)
"RTN","ENH283P",178,0)
 W !!,"REC",?10,"BUILDING",?45,"FIELD"
"RTN","ENH283P",179,0)
 W !,"IEN",?10,"NAME",?45,"NAME"
"RTN","ENH283P",180,0)
 W ! F I=1:1:80 W "="
"RTN","ENH283P",181,0)
 S L=L+10
"RTN","ENH283P",182,0)
 Q
"RTN","ENH283P",183,0)
 ;
"RTN","ENH283P",184,0)
OHDR ; Header for subsequent pages of detailed reports
"RTN","ENH283P",185,0)
 W !!,"For the """_^TMP("ENH6928.3",$J,DIV,0)_""" Division:"
"RTN","ENH283P",186,0)
 W ! F I=1:1:60 W "-"
"RTN","ENH283P",187,0)
 W !!,"REC",?10,"BUILDING",?45,"FIELD"
"RTN","ENH283P",188,0)
 W !,"IEN",?10,"NAME",?45,"NAME"
"RTN","ENH283P",189,0)
 W ! F I=1:1:80 W "="
"RTN","ENH283P",190,0)
 S L=L+7
"RTN","ENH283P",191,0)
 Q
"RTN","ENH283U")
0^6^B2984917
"RTN","ENH283U",1,0)
ENH283U ;WOIFO/EEN - Eng Building File Report Utilities (AMES/MERS) - CoreFLS ;
"RTN","ENH283U",2,0)
 ;;7.0;Engineering;**78**; 09/30/03 10:55
"RTN","ENH283U",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","ENH283U",4,0)
 ;
"RTN","ENH283U",5,0)
HDR ; Print the standard report header.
"RTN","ENH283U",6,0)
 ; Do not ask 'RETURN' before first page on CRT.
"RTN","ENH283U",7,0)
 I $E(IOST,1,2)="C-",P R !!,"Enter RETURN to continue or '^' to exit: ",Y:DTIME I '$T!(Y[U) S ABORT=1 Q
"RTN","ENH283U",8,0)
 ; Do not print a form feed before first page on printer.
"RTN","ENH283U",9,0)
 ; Top of form is set at end of previous report.
"RTN","ENH283U",10,0)
 I $E(IOST,1,2)="C-"!P W @IOF
"RTN","ENH283U",11,0)
 S P=P+1,L=4
"RTN","ENH283U",12,0)
 W !,"ENG BUILDING (#6928.3) - "_$G(ENHDR),?67,"Page: ",$J(P,5,0)
"RTN","ENH283U",13,0)
 W !,"CoreFLS Data Cleansing Report ",$G(ENHDR1),?58,"Printed: ",$$FMTE^XLFDT(DT)
"RTN","ENH283U",14,0)
 Q
"RTN","ENH283U",15,0)
 ;
"RTN","ENH283U",16,0)
EORT ; Report completed
"RTN","ENH283U",17,0)
 I 'ABORT D
"RTN","ENH283U",18,0)
 . W !!,"<End of Report>"
"RTN","ENH283U",19,0)
 . I $E(IOST,1,2)="C-" W " Enter RETURN to continue: " R Y:DTIME
"RTN","ENH283U",20,0)
 I ABORT W !!,"<Report Aborted>"
"RTN","ENH283U",21,0)
 D ^%ZISC
"RTN","ENH283U",22,0)
 K L,P,X,Y,ABORT
"RTN","ENH283U",23,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","ENH283U",24,0)
 Q
"RTN","ENH283U",25,0)
 ;
"RTN","ENH283U",26,0)
INST ; Print Instructions for Summary Report
"RTN","ENH283U",27,0)
 ;
"RTN","ENH283U",28,0)
 ;  Variables:
"RTN","ENH283U",29,0)
 ;    ENHRPT = Type of report
"RTN","ENH283U",30,0)
 ;           1 - Summary Report
"RTN","ENH283U",31,0)
 ;           2 - Required Fields Missing Data Report
"RTN","ENH283U",32,0)
 ;           3 - Lookup Fields w/ Invalid Data Report
"RTN","ENH283U",33,0)
 ;           4 - Non-Required Fields Missing Data Report
"RTN","ENH283U",34,0)
 ;
"RTN","ENH283U",35,0)
 D HOME^%ZIS
"RTN","ENH283U",36,0)
 K DIR
"RTN","ENH283U",37,0)
 S DIR(0)="Y"
"RTN","ENH283U",38,0)
 S DIR("A")="Do you wish to print the instructions for this report"
"RTN","ENH283U",39,0)
 S DIR("A",1)=" "
"RTN","ENH283U",40,0)
 S DIR("B")="NO"
"RTN","ENH283U",41,0)
 S DIR("?")="Please enter Y to print the instructions or N to skip the instructions"
"RTN","ENH283U",42,0)
 D ^DIR K DIR
"RTN","ENH283U",43,0)
 I Y[U!(Y="")!$D(DTOUT)!$D(DUOUT) S ABORT=1 Q
"RTN","ENH283U",44,0)
 S ENHINST=Y
"RTN","ENH283U",45,0)
 Q
"VER")
8.0^22
**END**
**END**
