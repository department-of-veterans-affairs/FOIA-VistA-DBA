Released PSO*7*254 SEQ #228
Extracted from mail message
**KIDS**:PSO*7.0*254^

**INSTALL NAME**
PSO*7.0*254
"BLD",5799,0)
PSO*7.0*254^OUTPATIENT PHARMACY^0^3061116^y
"BLD",5799,1,0)
^^66^66^3061108^^
"BLD",5799,1,1,0)
For the Health Insurance Portability and Accountability Act (HIPAA)
"BLD",5799,1,2,0)
National Provider Identifier (NPI) project, this patch will create and
"BLD",5799,1,3,0)
populate the new NPI INSTITUTION field (#101) in the OUTPATIENT SITE file
"BLD",5799,1,4,0)
(#59). This patch will also change the Site Parameter Enter/Edi [PSO SITE
"BLD",5799,1,5,0)
PARAMETERS] option to allow the user to edit this new field as shown
"BLD",5799,1,6,0)
below:
"BLD",5799,1,7,0)
 
"BLD",5799,1,8,0)
       NAME: ALBANY// 
"BLD",5799,1,9,0)
 
"BLD",5799,1,10,0)
       ...
"BLD",5799,1,11,0)
 
"BLD",5799,1,12,0)
       Select CPRS ORDERING INSTITUTION:
"BLD",5799,1,13,0)
       RELATED INSTITUTION: ALBANY// 
"BLD",5799,1,14,0)
       NPI INSTITUTION: ALBANY// 
"BLD",5799,1,15,0)
   
"BLD",5799,1,16,0)
       ...
"BLD",5799,1,17,0)
  
"BLD",5799,1,18,0)
When this patch is installed, the information in this field will be 
"BLD",5799,1,19,0)
automatically populated through a post-install routine. The correct
"BLD",5799,1,20,0)
institution will be identified using the existing NCPDP NUMBER field
"BLD",5799,1,21,0)
(#1008) in the OUTPATIENT SITE file (#59), along with a list of
"BLD",5799,1,22,0)
pre-defined NPI numbers, which should match to NPI numbers previously 
"BLD",5799,1,23,0)
assigned to each institution by the KERNEL V. 8.0 patch XU*8*410.
"BLD",5799,1,24,0)
   
"BLD",5799,1,25,0)
The PSO SITE input template is being changed to include this new field.
"BLD",5799,1,26,0)
Therefore, the user will be able to manually add/edit/delete the NPI
"BLD",5799,1,27,0)
INSTITUTION field through the Site Parameter Enter/Edit [PSO SITE
"BLD",5799,1,28,0)
PARAMETERS] option.
"BLD",5799,1,29,0)
  
"BLD",5799,1,30,0)
**************************************************************************
"BLD",5799,1,31,0)
NOTE: All active outpatient sites MUST have an NPI INSTITUTION assigned.
"BLD",5799,1,32,0)
This is very important for sites currently performing third party
"BLD",5799,1,33,0)
electronic billing (ePharmacy) because the NPI number will replace the 
"BLD",5799,1,34,0)
previous NCPDP (National Council for Prescription Drug Programs) number 
"BLD",5799,1,35,0)
used to identify the dispensing pharmacy. 
"BLD",5799,1,36,0)
**************************************************************************
"BLD",5799,1,37,0)
 
"BLD",5799,1,38,0)
For active sites that do not have an NPI INSTITUTION assigned after the
"BLD",5799,1,39,0)
installation of this patch, using the Site Parameter Enter/Edit [PSO SITE
"BLD",5799,1,40,0)
PARAMETERS] option enter the correct institution for each site. In order
"BLD",5799,1,41,0)
to help you identify which sites have and which ones have not been 
"BLD",5799,1,42,0)
assigned an NPI INSTITUTION, the post-install routine will generate a 
"BLD",5799,1,43,0)
Mailman message which will be sent to the user installing the patch as 
"BLD",5799,1,44,0)
well as all the holders of the PSORPH security key. Below is an example
"BLD",5799,1,45,0)
of the Mailman message:
"BLD",5799,1,46,0)
 
"BLD",5799,1,47,0)
Subj: NPI INSTITUTION POPULATION [#93686] 08/01/06@16:16  20 lines
"BLD",5799,1,48,0)
From: PATCH PSO*7*254  In 'IN' basket.   Page 1  *New*
"BLD",5799,1,49,0)
-----------------------------------------------------------------------
"BLD",5799,1,50,0)
PSO*7*254 POST-INSTALL - POPULATES NPI INSTITUTION FIELD (#101)
"BLD",5799,1,51,0)
                         IN THE OUTPATIENT SITE FILE (#59)
"BLD",5799,1,52,0)
 
"BLD",5799,1,53,0)
Please, validate that the NPI INSTITUTION assignment below is correct for 
"BLD",5799,1,54,0)
each active DIVISION. If not, please use the Site Parameter Enter/Edit [PSO
"BLD",5799,1,55,0)
SITE PARAMETERS] option and assign the correct NPI INSTITUTION.
"BLD",5799,1,56,0)
 
"BLD",5799,1,57,0)
------------------------------------------------------------------------
"BLD",5799,1,58,0)
DIVISION(SITE#)        NPI#        NPI INSTITUTION
"BLD",5799,1,59,0)
------------------------------------------------------------------------
"BLD",5799,1,60,0)
ALBANY(500)            9999854880  ALBANY
"BLD",5799,1,61,0)
LEAVENWORTH(686)       9999813538  LEAVENWORTH, KS
"BLD",5799,1,62,0)
SIDNEY CLINIC(442GC)               NO SITE# OR NCPDP# FOUND FOR DIVISION
"BLD",5799,1,63,0)
TROY(514)                          NO NPI# FOUND FOR THIS DIVISION
"BLD",5799,1,64,0)
GREELEY CLINIC(442GD)  9999591232  GREELEY CBOC
"BLD",5799,1,65,0)
  
"BLD",5799,1,66,0)
TOTAL: 5 Division(s).
"BLD",5799,4,0)
^9.64PA^59^1
"BLD",5799,4,59,0)
59
"BLD",5799,4,59,2,0)
^9.641^59^1
"BLD",5799,4,59,2,59,0)
OUTPATIENT SITE  (File-top level)
"BLD",5799,4,59,2,59,1,0)
^9.6411^101^1
"BLD",5799,4,59,2,59,1,101,0)
CORRESPONDING INSTITUTION
"BLD",5799,4,59,222)
y^y^p^^^^n^^n
"BLD",5799,4,59,224)

"BLD",5799,4,"APDD",59,59)

"BLD",5799,4,"APDD",59,59,101)

"BLD",5799,4,"B",59,59)

"BLD",5799,6.3)
19
"BLD",5799,"INID")
n^n
"BLD",5799,"INIT")
PSO254PI
"BLD",5799,"KRN",0)
^9.67PA^8989.52^19
"BLD",5799,"KRN",.4,0)
.4
"BLD",5799,"KRN",.401,0)
.401
"BLD",5799,"KRN",.402,0)
.402
"BLD",5799,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",5799,"KRN",.402,"NM",1,0)
PSO SITE    FILE #59^59^0
"BLD",5799,"KRN",.402,"NM","B","PSO SITE    FILE #59",1)

"BLD",5799,"KRN",.403,0)
.403
"BLD",5799,"KRN",.5,0)
.5
"BLD",5799,"KRN",.84,0)
.84
"BLD",5799,"KRN",3.6,0)
3.6
"BLD",5799,"KRN",3.8,0)
3.8
"BLD",5799,"KRN",9.2,0)
9.2
"BLD",5799,"KRN",9.8,0)
9.8
"BLD",5799,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",5799,"KRN",9.8,"NM",1,0)
PSO254PI^^0^B24787071
"BLD",5799,"KRN",9.8,"NM",2,0)
PSO254P1^^0^B76535553
"BLD",5799,"KRN",9.8,"NM",3,0)
PSO59^^0^B3468336
"BLD",5799,"KRN",9.8,"NM",4,0)
PSO254EN^^0^B7205346
"BLD",5799,"KRN",9.8,"NM","B","PSO254EN",4)

"BLD",5799,"KRN",9.8,"NM","B","PSO254P1",2)

"BLD",5799,"KRN",9.8,"NM","B","PSO254PI",1)

"BLD",5799,"KRN",9.8,"NM","B","PSO59",3)

"BLD",5799,"KRN",19,0)
19
"BLD",5799,"KRN",19.1,0)
19.1
"BLD",5799,"KRN",101,0)
101
"BLD",5799,"KRN",409.61,0)
409.61
"BLD",5799,"KRN",771,0)
771
"BLD",5799,"KRN",870,0)
870
"BLD",5799,"KRN",8989.51,0)
8989.51
"BLD",5799,"KRN",8989.52,0)
8989.52
"BLD",5799,"KRN",8994,0)
8994
"BLD",5799,"KRN","B",.4,.4)

"BLD",5799,"KRN","B",.401,.401)

"BLD",5799,"KRN","B",.402,.402)

"BLD",5799,"KRN","B",.403,.403)

"BLD",5799,"KRN","B",.5,.5)

"BLD",5799,"KRN","B",.84,.84)

"BLD",5799,"KRN","B",3.6,3.6)

"BLD",5799,"KRN","B",3.8,3.8)

"BLD",5799,"KRN","B",9.2,9.2)

"BLD",5799,"KRN","B",9.8,9.8)

"BLD",5799,"KRN","B",19,19)

"BLD",5799,"KRN","B",19.1,19.1)

"BLD",5799,"KRN","B",101,101)

"BLD",5799,"KRN","B",409.61,409.61)

"BLD",5799,"KRN","B",771,771)

"BLD",5799,"KRN","B",870,870)

"BLD",5799,"KRN","B",8989.51,8989.51)

"BLD",5799,"KRN","B",8989.52,8989.52)

"BLD",5799,"KRN","B",8994,8994)

"BLD",5799,"PRE")
PSO254EN
"BLD",5799,"QUES",0)
^9.62^^
"BLD",5799,"REQB",0)
^9.611^2^2
"BLD",5799,"REQB",1,0)
PSO*7.0*229^2
"BLD",5799,"REQB",2,0)
XU*8.0*416^2
"BLD",5799,"REQB","B","PSO*7.0*229",1)

"BLD",5799,"REQB","B","XU*8.0*416",2)

"FIA",59)
OUTPATIENT SITE
"FIA",59,0)
^PS(59,
"FIA",59,0,0)
59I
"FIA",59,0,1)
y^y^p^^^^n^^n
"FIA",59,0,10)

"FIA",59,0,11)

"FIA",59,0,"RLRO")

"FIA",59,0,"VR")
7.0^PSO
"FIA",59,59)
1
"FIA",59,59,101)

"INIT")
PSO254PI
"KRN",.402,1379,-1)
0^1
"KRN",.402,1379,0)
PSO SITE^3060731.1515^^59^^^3060825
"KRN",.402,1379,"DIAB",1,1,59.02008,0)
ALL
"KRN",.402,1379,"DR",1,59)
.01:.06;1008;.07:.081;2004;.09:.091;.1:.18;.2:.52;3:5;2008;6:7;105;105.1;105.2;2006;2007;8;100;101;109;1000;1001;1002;2001;2002;1003;1004;1005;1006;2005;
"KRN",.402,1379,"DR",2,59.02008)
.01
"KRN",.402,1379,"DR",2,59.08)
.01;1;
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",141,-1)
1^1
"PKG",141,0)
OUTPATIENT PHARMACY^PSO^OUTPATIENT LABELS, PROFILE, INVENTORY, PRESCRIPTIONS
"PKG",141,20,0)
^9.402P^^
"PKG",141,22,0)
^9.49I^1^1
"PKG",141,22,1,0)
7.0^2971216^2980917^11712
"PKG",141,22,1,"PAH",1,0)
254^3061116^10000000022
"PKG",141,22,1,"PAH",1,1,0)
^^66^66^3061116
"PKG",141,22,1,"PAH",1,1,1,0)
For the Health Insurance Portability and Accountability Act (HIPAA)
"PKG",141,22,1,"PAH",1,1,2,0)
National Provider Identifier (NPI) project, this patch will create and
"PKG",141,22,1,"PAH",1,1,3,0)
populate the new NPI INSTITUTION field (#101) in the OUTPATIENT SITE file
"PKG",141,22,1,"PAH",1,1,4,0)
(#59). This patch will also change the Site Parameter Enter/Edi [PSO SITE
"PKG",141,22,1,"PAH",1,1,5,0)
PARAMETERS] option to allow the user to edit this new field as shown
"PKG",141,22,1,"PAH",1,1,6,0)
below:
"PKG",141,22,1,"PAH",1,1,7,0)
 
"PKG",141,22,1,"PAH",1,1,8,0)
       NAME: ALBANY// 
"PKG",141,22,1,"PAH",1,1,9,0)
 
"PKG",141,22,1,"PAH",1,1,10,0)
       ...
"PKG",141,22,1,"PAH",1,1,11,0)
 
"PKG",141,22,1,"PAH",1,1,12,0)
       Select CPRS ORDERING INSTITUTION:
"PKG",141,22,1,"PAH",1,1,13,0)
       RELATED INSTITUTION: ALBANY// 
"PKG",141,22,1,"PAH",1,1,14,0)
       NPI INSTITUTION: ALBANY// 
"PKG",141,22,1,"PAH",1,1,15,0)
   
"PKG",141,22,1,"PAH",1,1,16,0)
       ...
"PKG",141,22,1,"PAH",1,1,17,0)
  
"PKG",141,22,1,"PAH",1,1,18,0)
When this patch is installed, the information in this field will be 
"PKG",141,22,1,"PAH",1,1,19,0)
automatically populated through a post-install routine. The correct
"PKG",141,22,1,"PAH",1,1,20,0)
institution will be identified using the existing NCPDP NUMBER field
"PKG",141,22,1,"PAH",1,1,21,0)
(#1008) in the OUTPATIENT SITE file (#59), along with a list of
"PKG",141,22,1,"PAH",1,1,22,0)
pre-defined NPI numbers, which should match to NPI numbers previously 
"PKG",141,22,1,"PAH",1,1,23,0)
assigned to each institution by the KERNEL V. 8.0 patch XU*8*410.
"PKG",141,22,1,"PAH",1,1,24,0)
   
"PKG",141,22,1,"PAH",1,1,25,0)
The PSO SITE input template is being changed to include this new field.
"PKG",141,22,1,"PAH",1,1,26,0)
Therefore, the user will be able to manually add/edit/delete the NPI
"PKG",141,22,1,"PAH",1,1,27,0)
INSTITUTION field through the Site Parameter Enter/Edit [PSO SITE
"PKG",141,22,1,"PAH",1,1,28,0)
PARAMETERS] option.
"PKG",141,22,1,"PAH",1,1,29,0)
  
"PKG",141,22,1,"PAH",1,1,30,0)
**************************************************************************
"PKG",141,22,1,"PAH",1,1,31,0)
NOTE: All active outpatient sites MUST have an NPI INSTITUTION assigned.
"PKG",141,22,1,"PAH",1,1,32,0)
This is very important for sites currently performing third party
"PKG",141,22,1,"PAH",1,1,33,0)
electronic billing (ePharmacy) because the NPI number will replace the 
"PKG",141,22,1,"PAH",1,1,34,0)
previous NCPDP (National Council for Prescription Drug Programs) number 
"PKG",141,22,1,"PAH",1,1,35,0)
used to identify the dispensing pharmacy. 
"PKG",141,22,1,"PAH",1,1,36,0)
**************************************************************************
"PKG",141,22,1,"PAH",1,1,37,0)
 
"PKG",141,22,1,"PAH",1,1,38,0)
For active sites that do not have an NPI INSTITUTION assigned after the
"PKG",141,22,1,"PAH",1,1,39,0)
installation of this patch, using the Site Parameter Enter/Edit [PSO SITE
"PKG",141,22,1,"PAH",1,1,40,0)
PARAMETERS] option enter the correct institution for each site. In order
"PKG",141,22,1,"PAH",1,1,41,0)
to help you identify which sites have and which ones have not been 
"PKG",141,22,1,"PAH",1,1,42,0)
assigned an NPI INSTITUTION, the post-install routine will generate a 
"PKG",141,22,1,"PAH",1,1,43,0)
Mailman message which will be sent to the user installing the patch as 
"PKG",141,22,1,"PAH",1,1,44,0)
well as all the holders of the PSORPH security key. Below is an example
"PKG",141,22,1,"PAH",1,1,45,0)
of the Mailman message:
"PKG",141,22,1,"PAH",1,1,46,0)
 
"PKG",141,22,1,"PAH",1,1,47,0)
Subj: NPI INSTITUTION POPULATION [#93686] 08/01/06@16:16  20 lines
"PKG",141,22,1,"PAH",1,1,48,0)
From: PATCH PSO*7*254  In 'IN' basket.   Page 1  *New*
"PKG",141,22,1,"PAH",1,1,49,0)
-----------------------------------------------------------------------
"PKG",141,22,1,"PAH",1,1,50,0)
PSO*7*254 POST-INSTALL - POPULATES NPI INSTITUTION FIELD (#101)
"PKG",141,22,1,"PAH",1,1,51,0)
                         IN THE OUTPATIENT SITE FILE (#59)
"PKG",141,22,1,"PAH",1,1,52,0)
 
"PKG",141,22,1,"PAH",1,1,53,0)
Please, validate that the NPI INSTITUTION assignment below is correct for 
"PKG",141,22,1,"PAH",1,1,54,0)
each active DIVISION. If not, please use the Site Parameter Enter/Edit [PSO
"PKG",141,22,1,"PAH",1,1,55,0)
SITE PARAMETERS] option and assign the correct NPI INSTITUTION.
"PKG",141,22,1,"PAH",1,1,56,0)
 
"PKG",141,22,1,"PAH",1,1,57,0)
------------------------------------------------------------------------
"PKG",141,22,1,"PAH",1,1,58,0)
DIVISION(SITE#)        NPI#        NPI INSTITUTION
"PKG",141,22,1,"PAH",1,1,59,0)
------------------------------------------------------------------------
"PKG",141,22,1,"PAH",1,1,60,0)
ALBANY(500)            9999854880  ALBANY
"PKG",141,22,1,"PAH",1,1,61,0)
LEAVENWORTH(686)       9999813538  LEAVENWORTH, KS
"PKG",141,22,1,"PAH",1,1,62,0)
SIDNEY CLINIC(442GC)               NO SITE# OR NCPDP# FOUND FOR DIVISION
"PKG",141,22,1,"PAH",1,1,63,0)
TROY(514)                          NO NPI# FOUND FOR THIS DIVISION
"PKG",141,22,1,"PAH",1,1,64,0)
GREELEY CLINIC(442GD)  9999591232  GREELEY CBOC
"PKG",141,22,1,"PAH",1,1,65,0)
  
"PKG",141,22,1,"PAH",1,1,66,0)
TOTAL: 5 Division(s).
"PRE")
PSO254EN
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","PSO254EN")
0^4^B7205346^n/a
"RTN","PSO254EN",1,0)
PSO254EN ;BHAM-ISC/MFR - ENVIRONMENT CHECK ROUTINE FOR PATCH PSO*7*254 ;10/03/06
"RTN","PSO254EN",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**254**;DEC 1997;Build 19
"RTN","PSO254EN",3,0)
 ;Reference to $$PROD^XPROD supported by IA 4440
"RTN","PSO254EN",4,0)
 ;Reference to NEW PERSON file (#200) supported by IA 224
"RTN","PSO254EN",5,0)
 ;Reference to BMES^XPDUTL supported by IA 10141
"RTN","PSO254EN",6,0)
 ;
"RTN","PSO254EN",7,0)
 Q:'$G(XPDENV)  S XPDABORT=0
"RTN","PSO254EN",8,0)
 ;
"RTN","PSO254EN",9,0)
 I $$PROD^XUPROD(),'$$FIND1^DIC(4,,"B","LEAVENWORTH PHARMACY") D  Q
"RTN","PSO254EN",10,0)
 . S XPDQUIT=1 D BMES^XPDUTL("THE POST-INSTALL FOR XU*8*416 HAS NOT COMPLETED AND/OR RUN. TRY AGAIN LATER!")
"RTN","PSO254EN",11,0)
 ;
"RTN","PSO254EN",12,0)
 W !
"RTN","PSO254EN",13,0)
 W !,"     The post-install routine included with this patch will send out a"
"RTN","PSO254EN",14,0)
 W !,"     Mailman message with the list of Pharmacy Divisions in your site"
"RTN","PSO254EN",15,0)
 W !,"     along with their related National Provider Identifier (NPI)"
"RTN","PSO254EN",16,0)
 W !,"     Institution, which is being automatically assigned by this patch."
"RTN","PSO254EN",17,0)
 W !,"     "
"RTN","PSO254EN",18,0)
 W !,"     It will also indicate if there were problems in the automatic"
"RTN","PSO254EN",19,0)
 W !,"     assignment, which will have to be followed-up by an Outpatient"
"RTN","PSO254EN",20,0)
 W !,"     Pharmacy user as outlined in the patch description."
"RTN","PSO254EN",21,0)
 W !,"     "
"RTN","PSO254EN",22,0)
 W !,"     So, please enter the Outpatient Pharmacy user(s) (e.g., Pharmacy"
"RTN","PSO254EN",23,0)
 W !,"     ADPAC or designee) who should receive this message (at least 1 user"
"RTN","PSO254EN",24,0)
 W !,"     is required). The user entered should be the person responsible for"
"RTN","PSO254EN",25,0)
 W !,"     the maintenance of the PSO Site Parameters. The message will also"
"RTN","PSO254EN",26,0)
 W !,"     be sent to the user installing the patch."
"RTN","PSO254EN",27,0)
 W !
"RTN","PSO254EN",28,0)
 ;
"RTN","PSO254EN",29,0)
 N ARRAY,DIC,DTOUT,DUOUT,QT,Y,X,I,USR
"RTN","PSO254EN",30,0)
 S DIC=200,DIC(0)="QEZAM",DIC("A")="PHARMACY USER: "
"RTN","PSO254EN",31,0)
 F  D ^DIC Q:X=""  D  Q:$G(QT)
"RTN","PSO254EN",32,0)
 . I $D(DTOUT)!$D(DUOUT) K ARRAY S QT=1 Q
"RTN","PSO254EN",33,0)
 . W "   ",$P(Y,"^",2),$S($D(ARRAY(+Y)):"       (already selected)",1:"")
"RTN","PSO254EN",34,0)
 . W ! S ARRAY(+Y)="",DIC("A")="ANOTHER ONE: "
"RTN","PSO254EN",35,0)
 ;
"RTN","PSO254EN",36,0)
 I '$D(ARRAY) D  S XPDABORT=2 Q
"RTN","PSO254EN",37,0)
 . D BMES^XPDUTL("AT LEAST ONE PHARMACY USER MUST BE ENTERED FOR THIS PATCH TO BE INSTALLED!")
"RTN","PSO254EN",38,0)
 ;
"RTN","PSO254EN",39,0)
 S @XPDGREF@("PSO254USR0")=DUZ
"RTN","PSO254EN",40,0)
 S USR="" F I=1:1 S USR=$O(ARRAY(USR)) Q:USR=""  S @XPDGREF@("PSO254USR"_I)=USR
"RTN","PSO254EN",41,0)
 ;
"RTN","PSO254EN",42,0)
 Q
"RTN","PSO254P1")
0^2^B76535553^n/a
"RTN","PSO254P1",1,0)
PSO254P1 ;BHAM-ISC/MFR - POPULATE NPI NUMBER IN FILE 59 ;07/26/06
"RTN","PSO254P1",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**254**;DEC 1997;Build 19
"RTN","PSO254P1",3,0)
 ;
"RTN","PSO254P1",4,0)
SETTMP ; TMP(NCPDP#)="SITE NAME^SITE NUMBER^NPI NUMBER"
"RTN","PSO254P1",5,0)
 S TMP(3330925)="Castle Point VAMC^620A4^1225086325"
"RTN","PSO254P1",6,0)
 S TMP(421785)="Central Arkansas VA HCS^598^1720046725"
"RTN","PSO254P1",7,0)
 S TMP(4224628)="Charleston VAMC^534^1265490262"
"RTN","PSO254P1",8,0)
 S TMP(5203651)="Cheyenne VAMC^442^1790743797"
"RTN","PSO254P1",9,0)
 S TMP(1473242)="Chicago Lake Side VAMC^537A4^1417915414"
"RTN","PSO254P1",10,0)
 S TMP(1467869)="Chicago VAMC^537^1518915172"
"RTN","PSO254P1",11,0)
 S TMP(5617038)="Chico VA Outpatient Clinic^^1598713703"
"RTN","PSO254P1",12,0)
 S TMP(3660683)="Chillicothe VAMC^538^1851359855"
"RTN","PSO254P1",13,0)
 S TMP(3636098)="Cincinnati VAMC^539^1114985116"
"RTN","PSO254P1",14,0)
 S TMP(5004875)="Clarksburg VAMC^540^1356399364"
"RTN","PSO254P1",15,0)
 S TMP(3660671)="Cleveland VAMC^541^1902864911"
"RTN","PSO254P1",16,0)
 S TMP(3981897)="Coatesville VAMC^542^1790743706"
"RTN","PSO254P1",17,0)
 S TMP(2764339)="Columbia Falls CBOC^541A22^1497703409"
"RTN","PSO254P1",18,0)
 S TMP(2614825)="Columbia MO VAMC^544^1194783001"
"RTN","PSO254P1",19,0)
 S TMP(4223260)="Columbia SC VAMC^436DT^1104884014"
"RTN","PSO254P1",20,0)
 S TMP(3664162)="Columbus VAOPC^757^1821056730"
"RTN","PSO254P1",21,0)
 S TMP(4532138)="Corpus Christi VAOPC^671BZ^1780632513"
"RTN","PSO254P1",22,0)
 S TMP(1535244)="Crown Point CBOC^537BY^1821046848"
"RTN","PSO254P1",23,0)
 S TMP(4539055)="Dallas VAMC^549^1871541433"
"RTN","PSO254P1",24,0)
 S TMP(1466134)="Danville VAMC^550^1508824418"
"RTN","PSO254P1",25,0)
 S TMP(3664085)="Dayton VAMC^552^1043278955"
"RTN","PSO254P1",26,0)
 S TMP(617766)="Denver VAMC^554^1053369520"
"RTN","PSO254P1",27,0)
 S TMP(1620043)="Des Moines VAMC^636A6^1710935747"
"RTN","PSO254P1",28,0)
 S TMP(2359063)="Detroit VAMC^553^1184682007"
"RTN","PSO254P1",29,0)
 S TMP(1151478)="Dublin VAMC^557^1053379974"
"RTN","PSO254P1",30,0)
 S TMP(3432717)="Durham VAMC^558^1952369886"
"RTN","PSO254P1",31,0)
 S TMP(3145388)="East Orange VAMC^561^1023076957"
"RTN","PSO254P1",32,0)
 S TMP(4519469)="El Paso VAMC^756^1740248673"
"RTN","PSO254P1",33,0)
 S TMP(3981900)="Erie VAMC^562^1811955743"
"RTN","PSO254P1",34,0)
 S TMP(1560095)="Evansville Clinic^^1851349062"
"RTN","PSO254P1",35,0)
 S TMP(5617026)="Fairfield Outpatient Clinic^^1528016649"
"RTN","PSO254P1",36,0)
 S TMP(3504063)="Fargo VAMC^437^1700844636"
"RTN","PSO254P1",37,0)
 S TMP(420466)="Fayetteville AR VAMC^564^1508824434"
"RTN","PSO254P1",38,0)
 S TMP(3429417)="Fayetteville NC VAMC^565^1871551713"
"RTN","PSO254P1",39,0)
 S TMP(2706553)="Fort Harrison VAMC^436^1538117593"
"RTN","PSO254P1",40,0)
 S TMP(4304806)="Fort Meade VAMC^568^1114985058"
"RTN","PSO254P1",41,0)
 S TMP(1015090)="Fort Myers Outpatient Clinic^516 BZ^1003874942"
"RTN","PSO254P1",42,0)
 S TMP(1510735)="Fort Wayne VAMC^610A4^1427016369"
"RTN","PSO254P1",43,0)
 S TMP(4518316)="Fort Worth Outpatient Clinic^549BY^1477511368"
"RTN","PSO254P1",44,0)
 S TMP(4532087)="Frank M. Tejeda VA Outpatient Clinic Pharmacy^671BY^1164480018"
"RTN","PSO254P1",45,0)
 S TMP(4838453)="Fredericksburg CBOC^^1336197144"
"RTN","PSO254P1",46,0)
 S TMP(550207)="Fresno VAMC^570^1366400244"
"RTN","PSO254P1",47,0)
 S TMP(1098993)="Gainesville VAMC^573^1861450744"
"RTN","PSO254P1",48,0)
 S TMP(2816912)="Grand Island VAMC^541A104^1841258720"
"RTN","PSO254P1",49,0)
 S TMP(617728)="Grand Junction VAMC^575^1093773988"
"RTN","PSO254P1",50,0)
 S TMP(2366462)="Grand Rapids OPC^^1881642858"
"RTN","PSO254P1",51,0)
 S TMP(4226924)="Greenville Outpatient Clinic Pharmacy^544R^1265490155"
"RTN","PSO254P1",52,0)
 S TMP(2521474)="Gulfport VAMC^541A32^1689622771"
"RTN","PSO254P1",53,0)
 S TMP(4836992)="Hampton VAMC^590^1669430559"
"RTN","PSO254P1",54,0)
 S TMP(1475145)="Hines VAMC^578^1396793378"
"RTN","PSO254P1",55,0)
 S TMP(1204419)="Honolulu VAMC^459^1801854708"
"RTN","PSO254P1",56,0)
 S TMP(4352768)="Hot Springs VAMC^541A101^1558319541"
"RTN","PSO254P1",57,0)
 S TMP(4541149)="Houston VAMC^580^1407814304"
"RTN","PSO254P1",58,0)
 S TMP(5004673)="Huntington VAMC^581^1508824301"
"RTN","PSO254P1",59,0)
 S TMP(1516206)="Indianapolis VAMC^583^1982662789"
"RTN","PSO254P1",60,0)
 S TMP(1620663)="Iowa City VAMC^636A8^1578512687"
"RTN","PSO254P1",61,0)
 S TMP(2350192)="Iron Mountain VAMC^585^1528026333"
"RTN","PSO254P1",62,0)
 S TMP(2508995)="Jackson VAMC^586^1932167756"
"RTN","PSO254P1",63,0)
 S TMP(1099008)="Jacksonville CBOC^573BY^1992753008"
"RTN","PSO254P1",64,0)
 S TMP(3192375)="James J. Howard Clinic^^1780632802"
"RTN","PSO254P1",65,0)
 S TMP(2614522)="Kansas City VAMC^589^1326006149"
"RTN","PSO254P1",66,0)
 S TMP(4593693)="Kerrville VAMC^541A48^1871551606"
"RTN","PSO254P1",67,0)
 S TMP(1081354)="Lake City VAMC^573A4^1972551323"
"RTN","PSO254P1",68,0)
 S TMP(1712911)="Leavenworth VAMC^589A6^1295793032"
"RTN","PSO254P1",69,0)
 S TMP(3981912)="Lebanon VAMC^595^1578521365"
"RTN","PSO254P1",70,0)
 S TMP(1822990)="Lexington VAMC^596^1487612172"
"RTN","PSO254P1",71,0)
 S TMP(2816924)="Lincoln VAMC^541A105^1356399372"
"RTN","PSO254P1",72,0)
 S TMP(529783)="Livermore VAMC^640A4^1598723280"
"RTN","PSO254P1",73,0)
 S TMP(569333)="Loma Linda VAMC^605^1255399952"
"RTN","PSO254P1",74,0)
 S TMP(570855)="Long Beach VAMC^600^1912965658"
"RTN","PSO254P1",75,0)
 S TMP(539152)="Los Angeles Ambulatory Care Center (Methadone Pharmacy)^691A96^1235187683"
"RTN","PSO254P1",76,0)
 S TMP(569713)="Los Angeles Ambulatory Care Center (Outpatient Pharmacy)^691A97^1396793428"
"RTN","PSO254P1",77,0)
 S TMP(1827243)="Louisville VAMC^603^1538127295"
"RTN","PSO254P1",78,0)
 S TMP(2240238)="Lowell CBOC^523BY^1811945819"
"RTN","PSO254P1",79,0)
 S TMP(4530336)="Lubbock VAMC^504BY^1750339636"
"RTN","PSO254P1",80,0)
 S TMP(3138749)="Lyons VAMC^561A4^1447208442"
"RTN","PSO254P1",81,0)
 S TMP(5123322)="Madison VAMC^607^1033177787"
"RTN","PSO254P1",82,0)
 S TMP(3005255)="Manchester VAMC^608^1255399838"
"RTN","PSO254P1",83,0)
 S TMP(5617002)="Mare Island Outpatient Clinic^^1780632901"
"RTN","PSO254P1",84,0)
 S TMP(1469471)="Marion VAMC^541A28^1750349429"
"RTN","PSO254P1",85,0)
 S TMP(5617014)="Martinez Outpatient Clinic^^1114975570"
"RTN","PSO254P1",86,0)
 S TMP(575576)="Martinez VAMC^612^1356309017"
"RTN","PSO254P1",87,0)
 S TMP(5005423)="Martinsburg VAMC^613^1629026414"
"RTN","PSO254P1",88,0)
 S TMP(575588)="Mather Outpatient Clinic ^^1457309577"
"RTN","PSO254P1",89,0)
 S TMP(4024028)="Mayaguez VA Clinic^672BZ^1427016187"
"RTN","PSO254P1",90,0)
 S TMP(4532001)="McAllen VA Outpatient^671BO^1366400038"
"RTN","PSO254P1",91,0)
 S TMP(537920)="McClellan Outpatient Clinic^^1588612329"
"RTN","PSO254P1",92,0)
 S TMP(4436538)="Memphis VAMC^614^1386602050"
"RTN","PSO254P1",93,0)
 S TMP(5600196)="Menlo Park VAMC^640A0^1043268048"
"RTN","PSO254P1",94,0)
 S TMP(1074715)="Miami VAMC^546^1255389144"
"RTN","PSO254P1",95,0)
 S TMP(2764442)="Miles City CBOC^436GJ^1497703292"
"RTN","PSO254P1",96,0)
 S TMP(5121950)="Milwaukee VAMC^695^1972561645"
"RTN","PSO254P1",97,0)
 S TMP(2411508)="Minneapolis VAMC^618^1689632366"
"RTN","PSO254P1",98,0)
 S TMP(131881)="Mobile CBOC^541A34^1417905217"
"RTN","PSO254P1",99,0)
 S TMP(5600211)="Monterey CBOC^640HC^1124078308"
"RTN","PSO254P1",100,0)
 S TMP(126842)="Montgomery VAMC^619^1801854146"
"RTN","PSO254P1",101,0)
 S TMP(3339783)="Montrose VAMC^620^1063460798"
"RTN","PSO254P1",102,0)
 S TMP(4436540)="Mountain Home VAMC^621^1548218266"
"RTN","PSO254P1",103,0)
 S TMP(4429583)="Murfreesboro VAMC^626A4^1316905904"
"RTN","PSO254P1",104,0)
 S TMP(3710933)="Muskogee VAMC^623^1770541377"
"RTN","PSO254P1",105,0)
 S TMP(1913652)="New Orleans VAMC^629^1487612081"
"RTN","PSO254P1",106,0)
 S TMP(1099022)="New Port Richey CBOC^673BZ^1952359879"
"RTN","PSO254P1",107,0)
 S TMP(3304449)="New York VAMC^630^1457309049"
"RTN","PSO254P1",108,0)
 S TMP(719596)="Newington VAMC^689A4^1821056086"
"RTN","PSO254P1",109,0)
 S TMP(1473329)="North Chicago VAMC^556^1326006933"
"RTN","PSO254P1",110,0)
 S TMP(420339)="North Little Rock VAMC^598^1316905920"
"RTN","PSO254P1",111,0)
 S TMP(2240240)="Northampton VAMC^632^1720046337"
"RTN","PSO254P1",112,0)
 S TMP(1519377)="Northern Indiana VAMC^631^1457309379"
"RTN","PSO254P1",113,0)
 S TMP(3322687)="Northport VAMC^610^1659339265"
"RTN","PSO254P1",114,0)
 S TMP(575526)="Oakland Outpatient Clinic^^1073561817"
"RTN","PSO254P1",115,0)
 S TMP(3706972)="Oklahoma City VAMC^635^1043278211"
"RTN","PSO254P1",116,0)
 S TMP(2814564)="Omaha VAMC^636^1366491524"
"RTN","PSO254P1",117,0)
 S TMP(1099010)="Orlando VAHC^673BY^1871541797"
"RTN","PSO254P1",118,0)
 S TMP(592534)="Palo Alto VA HCS^640^1932157930"
"RTN","PSO254P1",119,0)
 S TMP(1099072)="Pensacola VAMC^541A33^1891743134"
"RTN","PSO254P1",120,0)
 S TMP(1476313)="Peoria CBOC^541A6^1336197284"
"RTN","PSO254P1",121,0)
 S TMP(2119952)="Perry Point VAMC^512A5^1972551596"
"RTN","PSO254P1",122,0)
 S TMP(3921904)="Philadelphia VAMC^642^1124077144"
"RTN","PSO254P1",123,0)
 S TMP(327204)="Phoenix VAMC^644^1184682676"
"RTN","PSO254P1",124,0)
 S TMP(3981924)="Pittsburgh Highland Dr VAMC^646A5^1255389680"
"RTN","PSO254P1",125,0)
 S TMP(3982508)="Pittsburgh VA HCS^646^1467401299"
"RTN","PSO254P1",126,0)
 S TMP(4024016)="Ponce VA Clinic^672BO^1043268683"
"RTN","PSO254P1",127,0)
 S TMP(2616805)="Popular Bluff VAMC^657A4^1588622880"
"RTN","PSO254P1",128,0)
 S TMP(3804007)="Portland VAMC^648^1306804588"
"RTN","PSO254P1",129,0)
 S TMP(327280)="Prescott VAMC^649^1801854328"
"RTN","PSO254P1",130,0)
 S TMP(4106349)="Providence VAMC^650^1619935145"
"RTN","PSO254P1",131,0)
 S TMP(575603)="Redding VAOPC^612B4^1750349056"
"RTN","PSO254P1",132,0)
 S TMP(2905466)="Reno VAMC^654^1346208592"
"RTN","PSO254P1",133,0)
 S TMP(4837944)="Richmond VAMC^652^1013975317"
"RTN","PSO254P1",134,0)
 S TMP(3333515)="Rochester Outpatient Clinic^528GE^1922066109"
"RTN","PSO254P1",135,0)
 S TMP(1478444)="Rockford VA Clinic^607HZ^1033177589"
"RTN","PSO254P1",136,0)
 S TMP(3333490)="Rome Outpatient Clinic^^1346298155"
"RTN","PSO254P1",137,0)
 S TMP(3811862)="Roseburg VAMC^653^1003874546"
"RTN","PSO254P1",138,0)
 S TMP(2354671)="Saginaw VAMC^655^1326006867"
"RTN","PSO254P1",139,0)
 S TMP(4829125)="Salem VAMC^658^1033177597"
"RTN","PSO254P1",140,0)
 S TMP(3429556)="Salisbury VAMC^659^1922056555"
"RTN","PSO254P1",141,0)
 S TMP(4608658)="Salt Lake City VAMC^660^1558329722"
"RTN","PSO254P1",142,0)
 S TMP(4537809)="San Antonio VAMC^671^1518925809"
"RTN","PSO254P1",143,0)
 S TMP(574978)="San Diego VAMC^664^1528026895"
"RTN","PSO254P1",144,0)
 S TMP(575641)="San Francisco VAMC^662^1134187693"
"RTN","PSO254P1",145,0)
 S TMP(5600209)="San Jose CBOC^640BY^1487602025"
"RTN","PSO254P1",146,0)
 S TMP(4024030)="San Juan VAMC^672^1962450767"
"RTN","PSO254P1",147,0)
 S TMP(538061)="Santa Barbara CBOC^^1316995244"
"RTN","PSO254P1",148,0)
 S TMP(532122)="Sepulveda Ambulatory Care Center (Methadone Pharmacy)^^1003864851"
"RTN","PSO254P1",149,0)
 S TMP(514237)="Sepulveda VAMC^541A95^1871551002"
"RTN","PSO254P1",150,0)
 S TMP(5203702)="Sheridan VAMC^666^1679531800"
"RTN","PSO254P1",151,0)
 S TMP(1913462)="Shreveport VAMC^667^1982652145"
"RTN","PSO254P1",152,0)
 S TMP(4304616)="Sioux Falls VAMC^438^1902854151"
"RTN","PSO254P1",153,0)
 S TMP(2907092)="Southern Nevada HCS^541A89^1063461853"
"RTN","PSO254P1",154,0)
 S TMP(4912792)="Spokane VAMC^668^1962450122"
"RTN","PSO254P1",155,0)
 S TMP(2241189)="Springfield Outpatient Clinic^^1013965896"
"RTN","PSO254P1",156,0)
 S TMP(3330785)="St. Albans VAMC^630A5^1134177694"
"RTN","PSO254P1",157,0)
 S TMP(2408195)="St. Cloud VAMC^656^1235187741"
"RTN","PSO254P1",158,0)
 S TMP(2629509)="St. Louis VAMC^657^1558319715"
"RTN","PSO254P1",159,0)
 S TMP(3337448)="Syracuse VAMC^528^1124086228"
"RTN","PSO254P1",160,0)
 S TMP(1007120)="Tallahassee CBOC^573GF^1720036296"
"RTN","PSO254P1",161,0)
 S TMP(1073371)="Tampa VAMC^673^1740238666"
"RTN","PSO254P1",162,0)
 S TMP(4545274)="Temple VAMC^674BY^1952359432"
"RTN","PSO254P1",163,0)
 S TMP(4436552)="Tennessee Valley Healthcare System^626^1720036171"
"RTN","PSO254P1",164,0)
 S TMP(2006965)="Togus VAMC^402^1407804537"
"RTN","PSO254P1",165,0)
 S TMP(5123182)="Tomah VAMC^676^1598713778"
"RTN","PSO254P1",166,0)
 S TMP(1712884)="Topeka VAMC ^589A5^1306894514"
"RTN","PSO254P1",167,0)
 S TMP(321783)="Tucson VAMC^678^1811945090"
"RTN","PSO254P1",168,0)
 S TMP(125787)="Tuscaloosa VAMC^679^1295783470"
"RTN","PSO254P1",169,0)
 S TMP(132667)="Tuskegee VAMC^619A4^1255389730"
"RTN","PSO254P1",170,0)
 S TMP(4913136)="VA Puget Sound - Seattle^663^1619925807"
"RTN","PSO254P1",171,0)
 S TMP(4912398)="VA Puget Sound - Tacoma^663A^1790733285"
"RTN","PSO254P1",172,0)
 S TMP(1099060)="Viera CBOC^673GA^1659329571"
"RTN","PSO254P1",173,0)
 S TMP(4538445)="Waco VAMC^541A50^1013965235"
"RTN","PSO254P1",174,0)
 S TMP(4912653)="Walla Walla VAMC^687^1477501666"
"RTN","PSO254P1",175,0)
 S TMP(904260)="Washington DC VAMC^688^1235187428"
"RTN","PSO254P1",176,0)
 S TMP(719584)="West Haven VAMC^689^1245289610"
"RTN","PSO254P1",177,0)
 S TMP(577621)="West LA VAMC - Healthcare^^1871541268"
"RTN","PSO254P1",178,0)
 S TMP(521965)="West LA VAMC - Methadone^691^1528016862"
"RTN","PSO254P1",179,0)
 S TMP(1098234)="West Palm Beach VAMC^548^1538117734"
"RTN","PSO254P1",180,0)
 S TMP(2231594)="West Roxbury VAMC^523A4^1023066529"
"RTN","PSO254P1",181,0)
 S TMP(3345990)="Western NY HCS - Buffalo^528^1740238252"
"RTN","PSO254P1",182,0)
 S TMP(3812206)="White City VAMC^692^1700834900"
"RTN","PSO254P1",183,0)
 S TMP(4704044)="White River Junction VAMC^405^1790733996"
"RTN","PSO254P1",184,0)
 S TMP(1712923)="Wichita VAMC^589A7^1316995517"
"RTN","PSO254P1",185,0)
 S TMP(3969269)="Wilkes-Barre VAMC^693^1144278342"
"RTN","PSO254P1",186,0)
 S TMP(1009213)="William V. Chappell, Jr., VA OPC^573BZ^1497703698"
"RTN","PSO254P1",187,0)
 S TMP(803177)="Wilmington VAMC^460^1003864208"
"RTN","PSO254P1",188,0)
 S TMP(3402132)="Winston-Salem Satellite^^1982652723"
"RTN","PSO254P1",189,0)
 S TMP(2240226)="Worcester CBOC^523GB^1033167564"
"RTN","PSO254P1",190,0)
 Q
"RTN","PSO254PI")
0^1^B24787071^n/a
"RTN","PSO254PI",1,0)
PSO254PI ;BHAM-ISC/MFR - POPULATE NPI INSTITUTION IN FILE 59 ;07/26/06
"RTN","PSO254PI",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**254**;DEC 1997;Build 19
"RTN","PSO254PI",3,0)
 ;Reference to $$QI^XUSNPI.$$NPI^XUSNPI supported by IA 4532
"RTN","PSO254PI",4,0)
 ;Reference to ^XUSEC( supported by IA 10076
"RTN","PSO254PI",5,0)
 ;Reference to ^XPDUTL supported by IA 10141
"RTN","PSO254PI",6,0)
 ;Reference to INSTITUTION file (#4) supported by IA 10090
"RTN","PSO254PI",7,0)
 ;
"RTN","PSO254PI",8,0)
 N SITE,DIVNAM,TMP,PSODIV,INACT,DIE,DA,DR,DIVCNT,NAMSITE,PSOINST,NPINST,PSONCPDP,PSONPI,PSOPOP,SUB,X,PSODUZ,LIST,I
"RTN","PSO254PI",9,0)
 D SETTMP,SETTMP^PSO254P1
"RTN","PSO254PI",10,0)
 S (PSODIV,DIVCNT)=0 F  S PSODIV=$O(^PS(59,PSODIV)) Q:'PSODIV  D
"RTN","PSO254PI",11,0)
 . S INACT=$$GET1^DIQ(59,PSODIV,2004,"I") I INACT,DT>INACT Q
"RTN","PSO254PI",12,0)
 . S DIVNAM=$$GET1^DIQ(59,PSODIV,.01,"I") I DIVNAM="" S DIVNAM="DIVISION IEN #"_PSODIV
"RTN","PSO254PI",13,0)
 . S SITE=$$GET1^DIQ(59,PSODIV,.06,"I"),PSONCPDP=$$GET1^DIQ(59,PSODIV,1008,"I")
"RTN","PSO254PI",14,0)
 . S DIVCNT=DIVCNT+1,SUB=$E(DIVNAM,1,20)_"("_SITE_")",NPINST=$$GET1^DIQ(59,PSODIV,101,"I")
"RTN","PSO254PI",15,0)
 . I NPINST D  Q
"RTN","PSO254PI",16,0)
 . . S PSOPOP(SUB)="INSTITUTION ALREADY SET("_$E($$GET1^DIQ(4,NPINST,.01),1,15)_")^"_$P($$NPI^XUSNPI("Organization_ID",NPINST,DT),"^")
"RTN","PSO254PI",17,0)
 . I PSONCPDP="",SITE="" S PSOPOP(SUB)="NO SITE# OR NCPDP# FOUND FOR DIVISION" Q
"RTN","PSO254PI",18,0)
 . I PSONCPDP,'$D(TMP(PSONCPDP)) S PSOPOP(SUB)="NO DIVISION FOUND FOR NCPDP#"_PSONCPDP Q
"RTN","PSO254PI",19,0)
 . S PSONPI=0 S:PSONCPDP'="" PSONPI=$P(TMP(PSONCPDP),"^",3)
"RTN","PSO254PI",20,0)
 . I 'PSONPI S PSOPOP(SUB)="NO NPI# FOUND FOR THIS DIVISION" Q
"RTN","PSO254PI",21,0)
 . S LIST=$$QI^XUSNPI(PSONPI),PSOINST=0
"RTN","PSO254PI",22,0)
 . F I=1:1:$L(LIST,";") D  I PSOINST Q
"RTN","PSO254PI",23,0)
 . . I $P(LIST,";",I)="" Q
"RTN","PSO254PI",24,0)
 . . I $P($P(LIST,";",I),"^",4)'="Active" Q
"RTN","PSO254PI",25,0)
 . . I '$P($P(LIST,";",I),"^",2) Q
"RTN","PSO254PI",26,0)
 . . S PSOINST=+$P($P(LIST,";",I),"^",2)
"RTN","PSO254PI",27,0)
 . I 'PSOINST S PSOPOP(SUB)="NO INSTITUTION FOUND FOR NPI #"_PSONPI_"^"_PSONPI Q
"RTN","PSO254PI",28,0)
 . S DIE="^PS(59,",DA=PSODIV,DR="101////"_PSOINST D ^DIE K DIE,DA,DR
"RTN","PSO254PI",29,0)
 . S PSOPOP(SUB)=$$GET1^DIQ(4,PSOINST,.01)_"^"_PSONPI
"RTN","PSO254PI",30,0)
 ;
"RTN","PSO254PI",31,0)
 D MAIL
"RTN","PSO254PI",32,0)
 Q
"RTN","PSO254PI",33,0)
 ;
"RTN","PSO254PI",34,0)
MAIL    ; Compose/Send the Mailman message
"RTN","PSO254PI",35,0)
 N XMDUZ,XMSUB,XMY,XMTEXT,LINE,PSOTEXT,I
"RTN","PSO254PI",36,0)
 S XMDUZ="Patch PSO*7*254",XMSUB="NPI INSTITUTION POPULATION"
"RTN","PSO254PI",37,0)
 F I=0:1 S PSODUZ=$G(@XPDGREF@("PSO254USR"_I)) Q:'PSODUZ  S XMY(PSODUZ)=""
"RTN","PSO254PI",38,0)
 S PSOTEXT(1)="PSO*7*254 POST-INSTALL - POPULATES NPI INSTITUTION FIELD (#101)"
"RTN","PSO254PI",39,0)
 S PSOTEXT(2)="                         IN THE OUTPATIENT SITE FILE (#59)"
"RTN","PSO254PI",40,0)
 S PSOTEXT(3)=" "
"RTN","PSO254PI",41,0)
 S PSOTEXT(4)="Please, validate that the NPI INSTITUTION assignment below is correct for "
"RTN","PSO254PI",42,0)
 S PSOTEXT(5)="each active DIVISION. If not, please use the Site Parameter Enter/Edit [PSO"
"RTN","PSO254PI",43,0)
 S PSOTEXT(6)="SITE PARAMETERS] option and assign the correct NPI INSTITUTION."
"RTN","PSO254PI",44,0)
 S PSOTEXT(7)=" "
"RTN","PSO254PI",45,0)
 S $P(PSOTEXT(8),"-",80)=""
"RTN","PSO254PI",46,0)
 S X="DIVISION(SITE#)",$E(X,28)="NPI#",$E(X,40)="NPI INSTITUTION"
"RTN","PSO254PI",47,0)
 S PSOTEXT(9)=X
"RTN","PSO254PI",48,0)
 S $P(PSOTEXT(10),"-",80)=""
"RTN","PSO254PI",49,0)
 S LINE=10
"RTN","PSO254PI",50,0)
 S (NAMSITE)=""
"RTN","PSO254PI",51,0)
 F  S NAMSITE=$O(PSOPOP(NAMSITE)) Q:NAMSITE=""  D
"RTN","PSO254PI",52,0)
 . S LINE=LINE+1,X=NAMSITE
"RTN","PSO254PI",53,0)
 . S $E(X,28)=$J($P(PSOPOP(NAMSITE),"^",2),10)
"RTN","PSO254PI",54,0)
 . S $E(X,40)=$P(PSOPOP(NAMSITE),"^")
"RTN","PSO254PI",55,0)
 . S PSOTEXT(LINE)=X
"RTN","PSO254PI",56,0)
 S PSOTEXT(LINE+1)=" ",PSOTEXT(LINE+2)="TOTAL: "_DIVCNT_" Division(s)."
"RTN","PSO254PI",57,0)
 S XMTEXT="PSOTEXT(" N DIFROM D ^XMD
"RTN","PSO254PI",58,0)
 Q
"RTN","PSO254PI",59,0)
 ;
"RTN","PSO254PI",60,0)
SETTMP ; TMP(NCPDP#)="SITE NAME^SITE NUMBER^NPI NUMBER"
"RTN","PSO254PI",61,0)
 K TMP
"RTN","PSO254PI",62,0)
 S TMP(3338349)="Albany VAMC^528A8^1801854880"
"RTN","PSO254PI",63,0)
 S TMP(3208899)="Albuquerque VAMC^501^1396703336"
"RTN","PSO254PI",64,0)
 S TMP(1914717)="Alexandria VAMC^502^1922066968"
"RTN","PSO254PI",65,0)
 S TMP(3982293)="Allentown OPC^693B4^1821056862"
"RTN","PSO254PI",66,0)
 S TMP(3973004)="Altoona VAMC^503^1558329599"
"RTN","PSO254PI",67,0)
 S TMP(4525690)="Amarillo VAMC^504^1235197658"
"RTN","PSO254PI",68,0)
 S TMP(225842)="Anchorage VAOPC^463^1871551820"
"RTN","PSO254PI",69,0)
 S TMP(2358162)="Ann Arbor VAMC^506^1821055906"
"RTN","PSO254PI",70,0)
 S TMP(3412222)="Asheville VAMC^637^1417914508"
"RTN","PSO254PI",71,0)
 S TMP(3981936)="Aspinwall VAMC^646A4^1861440885"
"RTN","PSO254PI",72,0)
 S TMP(1119672)="Atlanta VAMC^508^1295793248"
"RTN","PSO254PI",73,0)
 S TMP(1147912)="Augusta VAMC (Downtown)^509AO^1649237751"
"RTN","PSO254PI",74,0)
 S TMP(1152925)="Augusta VAMC (Uptown)^509^1194783142"
"RTN","PSO254PI",75,0)
 S TMP(4529117)="Austin VAMC^674Z^1538126651"
"RTN","PSO254PI",76,0)
 S TMP(566820)="Bakersfield CBOC^^1427006634"
"RTN","PSO254PI",77,0)
 S TMP(2122036)="Baltimore VAMC^512^1164480596"
"RTN","PSO254PI",78,0)
 S TMP(3346017)="Batavia VAMC^528A4^1306803424"
"RTN","PSO254PI",79,0)
 S TMP(3350458)="Bath VAMC^528A6^1952368078"
"RTN","PSO254PI",80,0)
 S TMP(1917698)="Baton Rouge Outpatient Clinic^629^1679530794"
"RTN","PSO254PI",81,0)
 S TMP(2354621)="Battle Creek VAMC^515^1700843836"
"RTN","PSO254PI",82,0)
 S TMP(1098981)="Bay Pines VAMC^516^1376591396"
"RTN","PSO254PI",83,0)
 S TMP(5005497)="Beckley VAMC^517^1104884535"
"RTN","PSO254PI",84,0)
 S TMP(2233548)="Bedford VAMC^518^1154388288"
"RTN","PSO254PI",85,0)
 S TMP(4594190)="Big Spring VAMC^519^1407813538"
"RTN","PSO254PI",86,0)
 S TMP(2764555)="Billings CBOC^436GH^1568410595"
"RTN","PSO254PI",87,0)
 S TMP(2517350)="Biloxi VAMC^520^1396703427"
"RTN","PSO254PI",88,0)
 S TMP(3333476)="Binghamton Outpatient Clinic^528GN^1831157965"
"RTN","PSO254PI",89,0)
 S TMP(131829)="Birmingham VAMC^521^1508824632"
"RTN","PSO254PI",90,0)
 S TMP(1305766)="Boise VAMC^531^1841258985"
"RTN","PSO254PI",91,0)
 S TMP(4539447)="Bonham VAMC^549A4^1992763031"
"RTN","PSO254PI",92,0)
 S TMP(2235100)="Boston VAMC^523^1326006461"
"RTN","PSO254PI",93,0)
 S TMP(2240202)="Boston-Causeway CBOC^523BZ^1215995410"
"RTN","PSO254PI",94,0)
 S TMP(2240214)="Brockton VAMC^523A5^1447218896"
"RTN","PSO254PI",95,0)
 S TMP(3336725)="Bronx VAMC^526^1821056995"
"RTN","PSO254PI",96,0)
 S TMP(3330773)="Brooklyn VAMC^630A4^1275591232"
"RTN","PSO254PI",97,0)
 S TMP(3964295)="Butler VAMC^529^1649238759"
"RTN","PSO254PI",98,0)
 S TMP(3334163)="Canandaigua VAMC^528A5^1164480273"
"RTN","PSO254PI",99,0)
 S TMP(353083)="Carl T. Hayden VA Med Clinic Northwest Extension^644^1871551986"
"RTN","PSO254PI",100,0)
 S TMP(353069)="Carl T. Hayden VA Med Clinic Southeast Extension^644^1477511590"
"RTN","PSO254PI",101,0)
 Q
"RTN","PSO59")
0^3^B3468336^B3433876
"RTN","PSO59",1,0)
PSO59 ;BHM/DB - Outpatient Site File API ;1 JUL 05
"RTN","PSO59",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**213,229,254**;DEC 1997;Build 19
"RTN","PSO59",3,0)
PSS(PSOIEN,PSOTXT,LIST) ;
"RTN","PSO59",4,0)
 N DA,DIC,DIQ,DR,X,I
"RTN","PSO59",5,0)
 I $G(PSOIEN)="",$G(PSOTXT)="" Q
"RTN","PSO59",6,0)
 I $G(LIST)="" Q
"RTN","PSO59",7,0)
 K ^TMP($J,LIST) S:$G(PSOIEN)>0 ^TMP($J,LIST,PSOIEN,0)=0
"RTN","PSO59",8,0)
 I $G(PSOIEN)>0,'$D(^PS(59,PSOIEN,0)) S ^TMP($J,LIST,PSOIEN,0)="-1^NO DATA FOUND" Q
"RTN","PSO59",9,0)
 I $G(PSOTXT)'="",'$D(^PS(59,"B",PSOTXT)),$G(PSOIEN)>0 S ^TMP($J,LIST,PSOIEN,0)="-1^NO DATA FOUND" Q
"RTN","PSO59",10,0)
 S DA=$S($G(PSOIEN)]"":PSOIEN,1:$O(^PS(59,"B",PSOTXT,0)))
"RTN","PSO59",11,0)
 I $G(DA)'>0 S ^TMP($J,LIST,0)="-1^NO DATA FOUND" Q
"RTN","PSO59",12,0)
 K ^UTILITY("DIQ1",$J),DIC S DIC=59,DR=".01;.02;.05;.06;.07;.08;1;100;101;1003",DIQ(0)="IE" D EN^DIQ1
"RTN","PSO59",13,0)
 I '$D(^UTILITY("DIQ1",$J)) S ^TMP($J,LIST,PSOIEN,0)="-1^NO DATA FOUND" Q
"RTN","PSO59",14,0)
 F X=.01,.02,.05,.06,.07,.08,1,100,101,1003 D
"RTN","PSO59",15,0)
 .I $G(^UTILITY("DIQ1",$J,59,DA,X,"I"))'=$G(^UTILITY("DIQ1",$J,59,DA,X,"E")) S ^TMP($J,LIST,DA,X)=$G(^UTILITY("DIQ1",$J,59,DA,X,"I"))_"^"_$G(^UTILITY("DIQ1",$J,59,DA,X,"E")) Q
"RTN","PSO59",16,0)
 .S ^TMP($J,LIST,DA,X)=$G(^UTILITY("DIQ1",$J,59,DA,X,"I"))
"RTN","PSO59",17,0)
 S PSOTXT=$G(^UTILITY("DIQ1",$J,59,DA,.01,"E")) S ^TMP($J,LIST,"B",PSOTXT,DA)=""
"RTN","PSO59",18,0)
 S ^TMP($J,LIST,DA,0)=$G(^TMP($J,LIST,DA,0))+1
"RTN","PSO59",19,0)
 K DA,DIC,DIQ,DR,PSOIEN,PSOTXT
"RTN","PSO59",20,0)
 Q
"VER")
8.0^22.0
"^DD",59,59,101,0)
NPI INSTITUTION^P4'^DIC(4,^INI;2^Q
"^DD",59,59,101,21,0)
^^2^2^3060801^^^^
"^DD",59,59,101,21,1,0)
This is the institution or division that has the National Provider Identifier (NPI) value for this Outpatient Site.  No two Outpatient Site entries in this file should point to the same INSTITUTION file entry.  (Note that the RELATED INSTITUTION
"^DD",59,59,101,21,2,0)
 field differs from this field and is the  parent institution  which may be the same for any or all of the Outpatient Site entries.)
"^DD",59,59,101,23,0)
^^7^7^3060801^^^
"^DD",59,59,101,23,1,0)
This field points to the corresponding entry in the INSTITUTION file (#4) for this Outpatient Site entry. This field was created for two reasons: 
"^DD",59,59,101,23,2,0)
 
"^DD",59,59,101,23,3,0)
1) Avoid the creation of a new field on this file to store the NPI (National   Provider Identification) number and keep it at the institution level. The   INSTITUTION file (#4) is being updated along with the introduction of this   new field to
"^DD",59,59,101,23,4,0)
make sure that each entry in the OUTPATIENT SITE (#59) file has   an unique corresponding entry in that file.  
"^DD",59,59,101,23,5,0)
 
"^DD",59,59,101,23,6,0)
2) Eventually replace the RELATED INSTITUTION field (#100), which has been   used in different ways by different VA Medical Centers. The NPI INSTITUTION (#101) will establish a consistent relationship between the   OUTPATIENT SITE
"^DD",59,59,101,23,7,0)
(#59) and INSTITUTION (#4) files across the VA.
"^DD",59,59,101,"DT")
3060801
"BLD",5799,6)
^228
**END**
**END**
