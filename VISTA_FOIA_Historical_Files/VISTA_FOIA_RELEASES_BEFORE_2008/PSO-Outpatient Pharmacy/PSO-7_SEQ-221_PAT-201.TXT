$TXT Created by ELLZEY,LINDA J at DEVVII.FO-ALBANY.MED.VA.GOV  (KIDS) on Friday, 08/25/06 at 14:11
=============================================================================
Run Date: OCT 19, 2006                     Designation: PSO*7*201
Package : PSO - OUTPATIENT PHARMACY           Priority: Mandatory
Version : 7       SEQ #221                      Status: Released
                  Compliance Date: NOV 19, 2006
=============================================================================

Associated patches: (v)PSO*7*125   <<= must be installed BEFORE `PSO*7*201'
                    (v)PSO*7*148   <<= must be installed BEFORE `PSO*7*201'
                    (v)IB*2*260    <<= must be installed BEFORE `PSO*7*201'
                    (v)IB*2*286    <<= must be installed BEFORE `PSO*7*201'
                    (v)PSO*7*239   <<= must be installed BEFORE `PSO*7*201'

Subject: PATIENT FINANCIAL SERVICES SYSTEM (PFSS) SUPPORT

Category: 
  - Routine
  - Enhancement (Mandatory)
  - Data Dictionary
  - Input Template

Description:
============

 This Outpatient Pharmacy patch is part of the Patient Financial Services
 System (PFSS) project.  PFSS patches are being released on various
 schedules.  Some patch functionality will not be active until a new PFSS
 switch is activated during final implementation. PFSS will initially be
 implemented at select pilot sites ONLY.
  
 The purpose of the PFSS project is to prepare the Veterans Health 
 Information Systems and Technology Architecture (VistA) environment for
 the implementation of a Commercial Off-The-Shelf (COTS) billing 
 replacement system.  The project consists of the implementation of the 
 billing replacement system, business process improvements, and 
 enhancements to VistA to support integration with the COTS billing
 replacement system.  Significant changes to VistA legacy systems and 
 ancillary packages are necessary.
  
 Some of the PFSS software components are not operational until the PFSS 
 On/Off Switch, distributed with patch IB*2*260, is set to "ON".  The 
 ability for the local site to set the switch to "ON" will be provided at 
 the appropriate time with the release of a subsequent Integrated Billing 
 patch.
  
 For more information about the PFSS project, review the documentation 
 accompanying this patch and refer to the following website: 
 http://vista.med.va.gov/billreplace/.
  
 This Outpatient Pharmacy patch, PSO*7*201 provides the functionality
 needed to support the PFSS project.  Note that this patch depends on
 patches PSN*4*103 and PSS*1*92 to provide the new Charge Description
 Master (CDM) functionality.  The CDM provides Service Codes for each drug,
 supply item, etc. to uniquely identify them to the new COTS billing
 system.  This information is passed via IB Application Program Interface
 (API) calls, which is explained in the Technical Description.
  
 Functional Description:
 =======================
  
 Outpatient Pharmacy was modified to check the status of the PFSS 
 switch.  If the PFSS switch is not activated, the current Integrated 
 Billing (IB) billing process will continue.  If the PFSS switch is
 activated, prescription and copay information will be passed to the new
 COTS billing system for final copay assessments and billing via IB.
 As is currently the case with IB, the exchange of information will take
 place in the background with no user impact.
  
 Upon entering a new prescription order, copying, renewing, or editing 
 an order that causes a new order to be created, a PFSS Account Reference
 will be requested at finish from IB. This reference is used to uniquely
 identify the prescription in the COTS billing system.
  
 At prescription release, a unique charge identifier will be requested 
 from IB, and it will serve to uniquely identify the fill in IB.  Next, a
 charge message will be sent to the COTS billing system via IB.  This
 includes the release of Consolidated Mail Outpatient Pharmacy (CMOP)
 prescriptions and prescriptions released by the Outpatient Pharmacy
 Automation Interface (OPAI) functionality.
  
 For return to stocks, and deletes that perform a return to stock, a charge
 credit message will be sent.  
  
 When Service Connection and/or Environmental Indicators are modified
 without a change in copay using the Reset Copay Status/Cancel Charges
 [PSOCP RESET COPAY STATUS] option, a charge update message will be sent.  
 A charge credit message will be sent when copay charges are cancelled.  
 When the fill is changed to copay, no message will be sent because this
 change is considered to be for the future fills.
  
 No messaging will take place for discontinued orders.  When a 
 discontinued order is reinstated, the previously obtained PFSS Account 
 Reference will be used.
  
 In order to maintain the display of the "$" sign on the Medication 
 Profile screen that indicates the prescription is eligible for copay, IB
 will continue to be utilized for the copay eligibility assessment that is
 performed at finish.  Also, the Outpatient Pharmacy and IB copay
 evaluations performed at release for Service Connection, Environmental 
 Indicators, Drug Enforcement Agency (DEA) special handling (supply items
 and investigational drugs), income exempt, and RX Patient Status checks
 have not changed and will continue to be used.  However, the final copay
 billing determination will be performed by the COTS billing system, and
 the final decision is based on the above information, interfacility copay
 information, and current IB billing rules.  There will be no return
 messaging from the COTS billing system to Outpatient Pharmacy.
  
 When Days Supply is edited on a released prescription, a charge update
 message will be sent to the COTS billing system, and it is understood that
 the COTS billing system will pick up the latest charge update.
  
 Last, a new CHARGE LOCATION field (#1007) was added to the OUTPATIENT 
 SITE file (#59).  This field will be used by the COTS billing system 
 to group charges by division.  Upon installation and before the PFSS 
 switch is turned on, the user will need to enter an Outpatient Pharmacy
 charge location in the HOSPITAL LOCATION file (#44), and afterward define
 this location in the new CHARGE LOCATION field (#1007) in the OUTPATIENT
 SITE file (#59).  The Site Parameter Enter/Edit [PSO SITE PARAMETERS]
 option may be used to define the CHARGE LOCATION in the OUTPATIENT 
 SITE file (#59).  A charge location should be defined for each division in
 the OUTPATIENT SITE file (#59). It is suggested that this field be
 coordinated with the Medical Center's billing office and the activation of
 the PFSS functionality.  If at least one division has a CHARGE LOCATION
 defined, that value will be passed to the COTS billing system for all 
 division having prescriptions filled. If the CHARGE LOCATION is not
 defined for any division and the PFSS switch is turned on, the
 prescription information will not pass to IB or the COTS billing system.
  
  
 Technical Description:
 ======================
  
 At FINISH of the prescription fill:
  
 1. The new IB API #4664 GETACCT^IBBAPI will be called to request a PFSS
 ACCOUNT REFERENCE and it will be stored in the PRESCRIPTION file (#52) on
 the fill level. For original fills, it will be stored in the PFSS ACCOUNT
 REFERENCE field (#125), and for refills it will be stored in the PFSS
 ACCOUNT REFERENCE field (#21). These references uniquely identify the
 prescription to the COTS billing system.
  
 2. The array of data passed using the GETACCT^IBBAPI call encompasses all 
 of the minimum required data elements as stated in the PFSS SRS-SDD IBB 
 Generic API document.  The following outlines data passed from 
 Outpatient Pharmacy:
  
   $$GETACCT^IBBAPI(VAR1,VAR2,VAR3,VAR4,.ARR1,,,.ARR4,.ARR5,VAR5,,)
     Where:  
       VAR1 = Patient Identifier (Patient IEN)  
       VAR2 = PFSS Account Reference  
       VAR3 = HL7 Event Code          
       VAR4 = Application Location Reference
       ARR1 = ARR1(2) Patient Class, ARR1(3) Patient Location,
                   ARR1(7) Attending Physician, ARR1(44) Admit 
                   Date/Time (Fill Date), ARR1(50) Alternant Visit
                   ID (Prescription IEN)
       ARR4 = ARR4(n,3) Diagnoses Code, ARR4(n,6) Diagnosis Type 
       ARR5 = ARR5(n,2) Type
       VAR5 = Medical Center Division
  
 3. After IB returns the PFSS ACCOUNT REFERENCE to Outpatient Pharmacy,
 IB will pass the GETACCT information to the COTS billing system via the
 VistA Data Extraction Framework (VDEF) and will store the returned PFSS
 Account Number external value in the PFSS ACCOUNT file (#375).
  
  
 At RELEASE of the prescription fill:
  
 1. The new IB API # 4665 GETCHGID^IBBAPI will be called to request a PFSS
 CHARGE ID.  This information is used to uniquely identify the fill in the
 IB and will be stored in Prescription file (#52) on the fill level. For
 original fills, it will be stored in the PFSS CHARGE ID field (#126), and
 for refills it will be stored in the PFSS CHARGE ID field (#22).  No data
 is passed using this API.
  
 2. Next, the new IB API #4665 CHARGE^IBBAPI will be called to pass
 prescription and copay information.  This information will be stored in
 the PFSS CHARGE CACHE file (#373).  IB will batch the charge information
 and pass it on to the COTS billing system via VDEF.
  
 3. The array of data passed using the CHARGE^IBBAPI call encompasses all 
 of the minimum required data elements as stated in the PFSS SRS-SDD IBB 
 Generic API document.  The following outlines data passed from Outpatient
 Pharmacy:
  
      $$CHARGE^IBBAPI(VAR1,VAR2,VAR3,VAR4,.ARR1,,.ARR3,.ARR4,.ARR5,,,)
        Where:
          VAR1 = Patient Identifier (Patient IEN)              
          VAR2 = PFSS Account Reference  
          VAR3 = Charge Type               
          VAR4 = Unique Charge ID (PFSS Charge ID)
          ARR1 = ARR1(4) Transaction Date (Fill Date), ARR1(7) Transaction
                   Code, ARR1(10) Transaction Quantity, ARR1(13) Department
                   Code, ARR1(18) Patient Copay Status, ARR1(21) Ordered by
                   Code, ARR1(22) Unit Cost, ARR1(29) NDC_";"_Generic
                   Name, ARR1(31) Copay Transaction Type
          ARR3 = ARR3(n,3) Diagnoses Code, ARR3(n,6) Diagnosis Type
          ARR4 = ARR4(n,2) Type
          ARR5 = ARR5(1) Quantity_";;"_Days Supply, ARR5(17) Refills 
                   Dispensed (Fill Number), ARR5(18) Date of Most Recent
                   Fill (Release Date), ARR5(31) DEA, Special Handling
  
 4. There will be no return messaging from the COTS billing system to 
 Outpatient Pharmacy.  Note that IB will combine the data passed in the
 GETACCT and CHARGE APIs to form the charge message that will ultimately
 be passed to the COTS billing system via VDEF.
  
  
 CHARGE LOCATION additions:
  
 1. In the OUTPATIENT SITE file (#59), a new CHARGE LOCATION field 
 (#1007) was added, and this field is a pointer to HOSPITAL LOCATION file 
 (#44).
  
 2. The Site Parameter Enter/Edit [PSO SITE PARAMETERS] option input
 template PSO SITE was modified to accommodate entry of the new CHARGE
 LOCATION field (#1007).
  
 3. If a CHARGE LOCATION is not defined for a particular division, the 
 system will loop through all divisions in the OUTPATIENT SITE file (#59) 
 and will use the first CHARGE LOCATION it finds.  When none of the
 divisions have a CHARGE LOCATION defined, the prescription will not be 
 passed to IB or the COTS billing system.  This issue will be addressed in
 a subsequent phase of the PFSS project.  Until that time, it is imperative
 that CHARGE LOCATION are defined for each division.
  
 The Integration Agreement (IA) #4732 was created to facilitate 
 modifications being made by IB for interfacility copay.  It will be used 
 in the background to return the pharmacist, person who last edited the 
 prescription fill, and the value of the IB SERVICE/SECTION field (#1003) 
 from the OUTPATIENT SITE file (#59).
  
  
 Associated New Service Request (NSR):
 =====================================
 N/A 
  
  
 Associated Remedy Ticket(s):
 ============================
 N/A 
  
  
 Associated E3Rs:
 ================
 N/A 
  
  
 Test Sites: 
 =========== 
 CLEVELAND, OH
 DAYTON, OH
 BOSTON HCS, MA 
 TUSCALOOSA, AL 
  
 Routine Summary: 
 ================
 The following is a list of the routine(s) included in this patch.  The second
 line of each of these routine(s) will look like: 
  
      <tab>;;7.0;OUTPATIENT PHARMACY;**[patch list]**;DEC 1997 
  
 Routine    Before Patch   After Patch   Patch List
 ---------  ------------   -----------   ---------------------------------
 PSOCP          20083736      20475457   20,46,71,85,137,157,143,219,
                                            239,201
 PSOCPA         15060347      17091982   9,71,85,137,143,201
 PSOCPB         30983878      32811786   72,71,85,185,143,219,239,201
 PSOCPC         25194285      25572244   10,9,71,85,114,157,143,239,201
 PSOCPD         22106461      27222397   71,85,201
 PSOHLNE3       21660394      21938339   143,239,201
 PSOHLNE4            N/A       6042525   201
 PSON52         23824880      23908009   1,16,23,27,32,46,71,111,124,117,
                                            131,139,157,143,219,148,
                                            239,201
 PSOPFSU0            N/A       6067206   201
 PSOPFSU1            N/A      13426812   201
 PSOR52         11514154      11646969   10,22,27,181,148,201
 PSORESK        27854541      29865487   15,9,27,40,47,55,85,130,185,
                                             184,196,148,201
 PSORESK1        5886525       6251195   9,201
 PSORN52        20042374      20125503   1,11,27,37,46,79,71,100,117,157,
                                             143,219,148,239,201
 PSORXDL        30121659      32500583   4,17,9,27,117,131,148,201
 PSORXED        24260411      25313442   2,16,21,26,56,71,125,201
  
 Total number of routines - 16  
  
  
 File Summary:
 =============
                                      UP    SEND  DATA                USER
                                      DATE  SEC.  COMES  SITE   RSLV  OVER
 FILE #      NAME                     DD    CODE  W/FILE DATA   PTS   RIDE
 --------------------------------------------------------------------------
 52          PRESCRIPTION             YES   YES   NO                  NO
 Partial DD: subDD: 52     fld: 125
                           fld: 126
             subDD: 52.1   fld: 21
                           fld: 22
   DATA SCREEN: 
  
 59          OUTPATIENT SITE          YES   NO    NO                  NO
 Partial DD: subDD: 59     fld: 1007
   DATA SCREEN: 
  
  
 Field Summary:
 ==============
  
 Field Name (Number)               File Name (Number)
 -------------------               ------------------
 PFSS ACCOUNT REFERENCE (#125)     PRESCRIPTION (#52)
 PFSS CHARGE ID (#126)              PRESCRIPTION (#52)
 PFSS ACCOUNT REFERENCE (#21)     REFILL SUBFILE (#52.1) of PRESCRIPTION
                                        file (#52)
 PFSS CHARGE ID (#22)              REFILL SUBFILE (#52.1) of PRESCRIPTION
                                        file (#52)
 CHARGE LOCATION (#1007)           OUTPATIENT SITE (#59) 
  
  
 Template Summary:
 =================
  
 Template Name     Type        File Name (Number)
 -------------     -----       --------------------------
 PSO SITE          INPUT       OUTPATIENT SITE file (#59)
  
  
 Documentation Retrieval:
 ========================
  
 The PFSS documentation is available on the ANONYMOUS.SOFTWARE directory
 at one of the following Office of Information (OI) Field Offices.
  
 Sites may retrieve documentation in one of the following ways:
  
 (1) The preferred method is to FTP the files from
     download.vista.med.va.gov, which will transmit the files from the
     first available FTP server.
  
 (2) Sites may also elect to retrieve documentation directly from a
     specific server as follows:
  
     Albany              ftp.fo-albany.med.va.gov
     Hines               ftp.fo-hines.med.va.gov
     Salt Lake City      ftp.fo-slc.med.va.gov 
  
 The documentation distribution includes:
  
    FILE NAME                DESCRIPTION
    PSO_7_P201_RN.PDF        Release Notes
    PSO_7_P201_UM_CP.PDF     User Manual Change Pages
    PSO_7_P201_TM_CP.PDF     Technical Manual Change Pages
    
  
 (3) Documentation can also be retrieved from VistA Documentation Library
 (VDL) on the Internet at the following address, http://www.va.gov/vdl.
  
  
 Installation Instructions:
 ==========================
  
 This patch can be installed while users are on the system. Installation 
 will take less than 10 minutes.
  
  Suggested time to install: non-peak requirement hours.
  
    1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu.
  
    2. From the Kernel Installation & Distribution System (KIDS) menu,
       select the Installation menu.
  
    3. From this menu, you may select to use the following options
       (when prompted for INSTALL NAME, enter PSO*7.0*201):
      a. Backup a Transport Global - this option will create a backup
         message of any routines exported with the patch. It will NOT
         backup any other changes such as DDs or templates.
      b. Compare Transport Global to Current System - this option will
         allow you to view all changes that will be made when the patch
         is installed. It compares all components of the patch (routines,
         DDs, templates, etc.).
      c. Verify Checksums in Transport Global - this option will ensure
         the integrity of the routines that are in the transport global.
  
   4. Use the Install Package(s) option and select the package PSO*7.0*201.
  
   5. When prompted "Want KIDS to INHIBIT LOGONs during the install? YES//"
      respond NO.
  
   6. When prompted "Want to DISABLE Scheduled Options, Menu Options, and
      Protocols? YES//" respond NO.

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: PSOCP
    Before: B68323456  After: B65342782  **20,46,71,85,137,157,143,219,
                                          239,201**
Routine Name: PSOCPA
    Before: B36106278  After: B43580682  **9,71,85,137,143,201**
Routine Name: PSOCPB
    Before: B78420405  After: B83592265  **72,71,85,185,143,219,239,201**
Routine Name: PSOCPC
    Before: B67206155  After: B68516946  **10,9,71,85,114,157,143,239,201**
Routine Name: PSOCPD
    Before: B55811844  After: B68892823  **71,85,201**
Routine Name: PSOHLNE3
    Before: B55635403  After: B56031313  **143,239,201**
Routine Name: PSOHLNE4
    Before:       n/a  After: B10329069  **201**
Routine Name: PSON52
    Before: B58876503  After: B59816394  **1,16,23,27,32,46,71,111,124,
                                          117,131,139,157,143,219,148,239,
                                          201**
Routine Name: PSOPFSU0
    Before:       n/a  After: B16719657  **201**
Routine Name: PSOPFSU1
    Before:       n/a  After: B33416408  **201**
Routine Name: PSOR52
    Before: B30307425  After: B31117928  **10,22,27,181,148,201**
Routine Name: PSORESK
    Before: B58029902  After: B61223518  **15,9,27,40,47,55,85,130,185,
                                          184,196,148,201**
Routine Name: PSORESK1
    Before:  B7187442  After:  B7754829  **9,201**
Routine Name: PSORN52
    Before: B42247336  After: B43085141  **1,11,27,37,46,79,71,100,117,
                                          157,143,219,148,239,201**
Routine Name: PSORXDL
    Before: B58159508  After: B61943911  **4,17,9,27,117,131,148,201**
Routine Name: PSORXED
    Before: B49641748  After: B53144628  **2,16,21,26,56,71,125,201**

=============================================================================
User Information:
Entered By  : ANWER,MOHAMED                 Date Entered  : FEB 17, 2005
Completed By: LYNCH,MARY F.                 Date Completed: OCT 17, 2006
Released By : CONSENTINO,ALBERT             Date Released : OCT 19, 2006
=============================================================================


Packman Mail Message:
=====================

$END TXT
