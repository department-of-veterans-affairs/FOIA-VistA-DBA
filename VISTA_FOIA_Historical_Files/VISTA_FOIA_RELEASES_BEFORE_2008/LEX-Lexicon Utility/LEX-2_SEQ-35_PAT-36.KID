Released LEX*2*36 SEQ #35
Extracted from mail message
**KIDS**:LEX*2.0*36^

**INSTALL NAME**
LEX*2.0*36
"BLD",5836,0)
LEX*2.0*36^LEXICON UTILITY^0^3050623^y
"BLD",5836,1,0)
^^2^2^3050614^
"BLD",5836,1,1,0)
Please see the National Patch Module for details of the enhancements 
"BLD",5836,1,2,0)
included in this patch.
"BLD",5836,4,0)
^9.64PA^^
"BLD",5836,"INI")

"BLD",5836,"INIT")
POST^LEX2036P
"BLD",5836,"KRN",0)
^9.67PA^8989.52^19
"BLD",5836,"KRN",.4,0)
.4
"BLD",5836,"KRN",.401,0)
.401
"BLD",5836,"KRN",.402,0)
.402
"BLD",5836,"KRN",.403,0)
.403
"BLD",5836,"KRN",.5,0)
.5
"BLD",5836,"KRN",.84,0)
.84
"BLD",5836,"KRN",3.6,0)
3.6
"BLD",5836,"KRN",3.8,0)
3.8
"BLD",5836,"KRN",9.2,0)
9.2
"BLD",5836,"KRN",9.8,0)
9.8
"BLD",5836,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",5836,"KRN",9.8,"NM",1,0)
LEX2036^^0^B75073721
"BLD",5836,"KRN",9.8,"NM",2,0)
LEX2036P^^0^B26627619
"BLD",5836,"KRN",9.8,"NM",3,0)
LEXA^^0^B29821376
"BLD",5836,"KRN",9.8,"NM",4,0)
LEXU^^0^B21347999
"BLD",5836,"KRN",9.8,"NM","B","LEX2036",1)

"BLD",5836,"KRN",9.8,"NM","B","LEX2036P",2)

"BLD",5836,"KRN",9.8,"NM","B","LEXA",3)

"BLD",5836,"KRN",9.8,"NM","B","LEXU",4)

"BLD",5836,"KRN",19,0)
19
"BLD",5836,"KRN",19.1,0)
19.1
"BLD",5836,"KRN",101,0)
101
"BLD",5836,"KRN",409.61,0)
409.61
"BLD",5836,"KRN",771,0)
771
"BLD",5836,"KRN",870,0)
870
"BLD",5836,"KRN",8989.51,0)
8989.51
"BLD",5836,"KRN",8989.52,0)
8989.52
"BLD",5836,"KRN",8994,0)
8994
"BLD",5836,"KRN","B",.4,.4)

"BLD",5836,"KRN","B",.401,.401)

"BLD",5836,"KRN","B",.402,.402)

"BLD",5836,"KRN","B",.403,.403)

"BLD",5836,"KRN","B",.5,.5)

"BLD",5836,"KRN","B",.84,.84)

"BLD",5836,"KRN","B",3.6,3.6)

"BLD",5836,"KRN","B",3.8,3.8)

"BLD",5836,"KRN","B",9.2,9.2)

"BLD",5836,"KRN","B",9.8,9.8)

"BLD",5836,"KRN","B",19,19)

"BLD",5836,"KRN","B",19.1,19.1)

"BLD",5836,"KRN","B",101,101)

"BLD",5836,"KRN","B",409.61,409.61)

"BLD",5836,"KRN","B",771,771)

"BLD",5836,"KRN","B",870,870)

"BLD",5836,"KRN","B",8989.51,8989.51)

"BLD",5836,"KRN","B",8989.52,8989.52)

"BLD",5836,"KRN","B",8994,8994)

"BLD",5836,"PRE")
LEX2036
"BLD",5836,"QUES",0)
^9.62^^
"BLD",5836,"REQB",0)
^9.611^2^2
"BLD",5836,"REQB",1,0)
LEX*2.0*35^2
"BLD",5836,"REQB",2,0)
LEX*2.0*32^2
"BLD",5836,"REQB","B","LEX*2.0*32",2)

"BLD",5836,"REQB","B","LEX*2.0*35",1)

"INIT")
POST^LEX2036P
"MBREQ")
0
"PKG",574,-1)
1^1
"PKG",574,0)
LEXICON UTILITY^LEX^Medical and Biomedical Terminology System.
"PKG",574,20,0)
^9.402P^^
"PKG",574,22,0)
^9.49I^1^1
"PKG",574,22,1,0)
2.0^2950923^2950923^520642433
"PKG",574,22,1,"PAH",1,0)
36^3050623
"PKG",574,22,1,"PAH",1,1,0)
^^2^2^3050623
"PKG",574,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements 
"PKG",574,22,1,"PAH",1,1,2,0)
included in this patch.
"PRE")
LEX2036
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","LEX2036")
0^1^B75073721
"RTN","LEX2036",1,0)
LEX2036 ; ISL/KER - Environment Check/Pre/Post Install ; 06/23/2005
"RTN","LEX2036",2,0)
 ;;2.0;LEXICON UTILITY;**36**;Sep 23, 1996
"RTN","LEX2036",3,0)
 ;                     
"RTN","LEX2036",4,0)
 ; External References
"RTN","LEX2036",5,0)
 ;   DBIA 10015  EN^DIQ1
"RTN","LEX2036",6,0)
 ;   DBIA 10141  $$PATCH^XPDUTL
"RTN","LEX2036",7,0)
 ;   DBIA 10141  $$VERSION^XPDUTL
"RTN","LEX2036",8,0)
 ;   DBIA 10141  BMES^XPDUTL
"RTN","LEX2036",9,0)
 ;   DBIA 10141  MES^XPDUTL
"RTN","LEX2036",10,0)
 ;                            
"RTN","LEX2036",11,0)
ENV ; LEX*2.0*36 Environment Check
"RTN","LEX2036",12,0)
 ;
"RTN","LEX2036",13,0)
 ;   General
"RTN","LEX2036",14,0)
 ;
"RTN","LEX2036",15,0)
 N LEXBUILD,LEXIGHF,LEXREQP,LEXLREV,LEXG,LEXE
"RTN","LEX2036",16,0)
 W !," Code Set Quarterly Update with CPT/HCPCS FY 2005 Annual Release",!
"RTN","LEX2036",17,0)
 D IMP S U="^"
"RTN","LEX2036",18,0)
 ;     No user
"RTN","LEX2036",19,0)
 D:+($$UR)'>0 ET("User not defined (DUZ)")
"RTN","LEX2036",20,0)
 ;     No IO
"RTN","LEX2036",21,0)
 D:+($$SY)'>0 ET("Undefined IO variable(s)") I $D(LEXE) D ABRT Q
"RTN","LEX2036",22,0)
 ;
"RTN","LEX2036",23,0)
 ;   Load Distribution
"RTN","LEX2036",24,0)
 ;
"RTN","LEX2036",25,0)
 ;     XPDENV = 0 Environment Check during Load
"RTN","LEX2036",26,0)
 ;
"RTN","LEX2036",27,0)
 ;       Check Version (2.0)
"RTN","LEX2036",28,0)
 I $$VERSION^XPDUTL("LEX")'="2.0" D  D ABRT Q
"RTN","LEX2036",29,0)
 . D ET("Version 2.0 not found.  Please install Lexicon Utility v 2.0")
"RTN","LEX2036",30,0)
 ;
"RTN","LEX2036",31,0)
 ;       Check Required Patches
"RTN","LEX2036",32,0)
 D:'$L($G(LEXREQP)) IMP I $L(LEXREQP) D
"RTN","LEX2036",33,0)
 . N LEXPAT,LEXI,LEXPN
"RTN","LEX2036",34,0)
 . F LEXI=1:1 Q:'$L($P(LEXREQP,";",LEXI))  S LEXPAT=$P(LEXREQP,";",LEXI) D
"RTN","LEX2036",35,0)
 . . S LEXPN=$$PATCH^XPDUTL(LEXPAT) W !,"   Checking for ",LEXPAT I +LEXPN>0 H 1 W " - installed"
"RTN","LEX2036",36,0)
 . . I +LEXPN'>0 D ET((LEXPAT_" not found, please install "_LEXPAT_" before continuing"))
"RTN","LEX2036",37,0)
 I $D(LEXE) D ABRT Q
"RTN","LEX2036",38,0)
 S LEXG=$$RGBL
"RTN","LEX2036",39,0)
 I $D(LEXE)&(+LEXG=0) D ABRT Q
"RTN","LEX2036",40,0)
 I $D(LEXE)&(+LEXG<0) D ABRT Q
"RTN","LEX2036",41,0)
 I '$D(LEXFULL)&(+($G(XPDENV))'=1) D QUIT Q
"RTN","LEX2036",42,0)
 ;
"RTN","LEX2036",43,0)
 ;   Install Package(s)
"RTN","LEX2036",44,0)
 ;
"RTN","LEX2036",45,0)
 ;     XPDENV = 1 Environment Check during Install
"RTN","LEX2036",46,0)
 ;
"RTN","LEX2036",47,0)
 ;       Check Data "is installed" or "is translated"
"RTN","LEX2036",48,0)
 N LEXIT S LEXIT=+($$CPD) I '$D(LEXFULL)&(LEXIT) D QUIT Q
"RTN","LEX2036",49,0)
 ;       Checking Global "Write" Protection 
"RTN","LEX2036",50,0)
 D:+($G(XPDENV))=1 GBLS I $D(LEXE) D ABRT Q
"RTN","LEX2036",51,0)
 ;       Check Import Global Checksum 
"RTN","LEX2036",52,0)
 D:+($G(XPDENV))=1 CS I $D(LEXE) D ABRT Q
"RTN","LEX2036",53,0)
 ;
"RTN","LEX2036",54,0)
 ;   Quit, Exit or Abort
"RTN","LEX2036",55,0)
 ;
"RTN","LEX2036",56,0)
QUIT ;     Quit   Passed Environment Check
"RTN","LEX2036",57,0)
 K LEXFULL D OK
"RTN","LEX2036",58,0)
 Q
"RTN","LEX2036",59,0)
EXIT ;     Exit   Failed Environment Check
"RTN","LEX2036",60,0)
 D:$D(LEXE) ED S XPDQUIT=2 K LEXE,LEXFULL Q
"RTN","LEX2036",61,0)
ABRT ;     Abort  Failed Environment Check, KILL the distribution
"RTN","LEX2036",62,0)
 D:$D(LEXE) ED S XPDABORT=1,XPDQUIT=1,XPDQUIT("LEX*2.0*36")=1
"RTN","LEX2036",63,0)
 S XPDQUIT("ICD*18.0*12")=1,XPDQUIT("ICPT*6.0*19")=1
"RTN","LEX2036",64,0)
 S XPDQUIT("CTD UTIL 1.0")=1 K LEXE,LEXFULL
"RTN","LEX2036",65,0)
 Q
"RTN","LEX2036",66,0)
 ;               
"RTN","LEX2036",67,0)
 ; Checks
"RTN","LEX2036",68,0)
 ;
"RTN","LEX2036",69,0)
GBLS ;   Check Write access on globals
"RTN","LEX2036",70,0)
 N LEXE,LEXGBL,LEXRT,LEXT,LEXF,LEXI,LEXX,LEXOK,LEXCPD,LEXS,X S LEXOK=1
"RTN","LEX2036",71,0)
 D BM("   I will now check the protection on ^LEX, ^ICPT, and ^DIC Globals.")
"RTN","LEX2036",72,0)
 D M("   If you get an ERROR, you will need to change the protection on these")
"RTN","LEX2036",73,0)
 D M("   globals to allow read/write as indicated:")
"RTN","LEX2036",74,0)
 ;D BM("                        System    World    Group    UCI")
"RTN","LEX2036",75,0)
 ;D M("      DSM for OpenVMS    RWP       RW       RW      RW")
"RTN","LEX2036",76,0)
 ; D BM("                        System    World    Group    User")
"RTN","LEX2036",77,0)
 ; D M("      MSM-DOS            RWD       RWD      RWD     RWD")
"RTN","LEX2036",78,0)
 D BM("                        Owner     Group    World   Network")
"RTN","LEX2036",79,0)
 D M("      Cache systems      RWD       RW       RW      RWD")
"RTN","LEX2036",80,0)
 D BM("   Checking:"),M(" ")
"RTN","LEX2036",81,0)
 S LEXCPD=$$CPD,LEXS="",X=1 F LEXI=1:1 D  Q:'$L(LEXX)
"RTN","LEX2036",82,0)
 . S LEXX="" S LEXE="S LEXX=$T(GD+"_LEXI_")" X LEXE S LEXX=$$TRIM(LEXX) Q:'$L(LEXX)  Q:'$L($TR(LEXX,";",""))
"RTN","LEX2036",83,0)
 . S LEXGBL=$P(LEXX,";",3) Q:+LEXCPD>0&(LEXGBL="^LEXM(0)")  S LEXRT=$P(LEXX,";",4),LEXT=$P(LEXX,";",5),LEXF=$P(LEXX,";",6)
"RTN","LEX2036",84,0)
 . S (LEXB1,LEXB2)="",$P(LEXB1," ",(19-$L(LEXRT)))="",$P(LEXB2," ",(28-$L(LEXT)))=""
"RTN","LEX2036",85,0)
 . I '$D(@LEXGBL) D RGNF S LEXOK=0 D M(("      <"_LEXRT_" not found>")) Q
"RTN","LEX2036",86,0)
 . D M(("      "_LEXRT_LEXB1_LEXT_LEXB2_LEXF)) S @LEXGBL=$G(@LEXGBL) H 1
"RTN","LEX2036",87,0)
 D:LEXOK M("    --> ok") D:'LEXOK M("    ??") D M(" ")
"RTN","LEX2036",88,0)
 Q
"RTN","LEX2036",89,0)
RGBL(X) ;   Check Write access on globals
"RTN","LEX2036",90,0)
 N LEXCPD,LEXS,LEXI,LEXX,LEXEC,LEXGBL,LEXRT,LEXT,LEXF,LEXB1,LEXB2
"RTN","LEX2036",91,0)
 S LEXCPD=$$CPD,LEXS="",X=1 F LEXI=1:1 D  Q:'$L(LEXX)
"RTN","LEX2036",92,0)
 . S LEXX="" S LEXEC="S LEXX=$T(GD+"_LEXI_")" X LEXEC S LEXX=$$TRIM(LEXX) Q:'$L(LEXX)  Q:'$L($TR(LEXX,";",""))
"RTN","LEX2036",93,0)
 . S LEXGBL=$P(LEXX,";",3) Q:+LEXCPD>0&(LEXGBL="^LEXM(0)")  S LEXRT=$P(LEXX,";",4),LEXT=$P(LEXX,";",5),LEXF=$P(LEXX,";",6)
"RTN","LEX2036",94,0)
 . S (LEXB1,LEXB2)="",$P(LEXB1," ",(15-$L(LEXRT)))="",$P(LEXB2," ",(28-$L(LEXT)))=""
"RTN","LEX2036",95,0)
 . I '$D(@LEXGBL) S:LEXS'[LEXRT LEXS=LEXS_", "_LEXRT S X=-1 S:LEXGBL["LEXM("&(X=1) X=0
"RTN","LEX2036",96,0)
 I $L(LEXS),X'>0 D
"RTN","LEX2036",97,0)
 . S:LEXS[", " LEXS=$P(LEXS,", ",1,($L(LEXS,", ")-1))_" and "_$P(LEXS,", ",$L(LEXS,", "))
"RTN","LEX2036",98,0)
 . S:$E(LEXS,1,2)=", " LEXS=$E(LEXS,3,$L(LEXS)) S:$E(LEXS,1,7)[" and " LEXS=$P(LEXS," and ",2)
"RTN","LEX2036",99,0)
 . D:X=-1 ET(("Global"_$S(LEXS[", "!(LEXS[" and "):"s",1:"")_" "_LEXS_" either not found or incomplete."))
"RTN","LEX2036",100,0)
 . D:X=0 CM
"RTN","LEX2036",101,0)
 Q X
"RTN","LEX2036",102,0)
RGNF ;   Required global not found
"RTN","LEX2036",103,0)
 N LEXLREV,LEXREQP,LEXBUILD,LEXIGHF D IMP
"RTN","LEX2036",104,0)
 D:$G(LEXGL)["^LEX"&($G(LEXGL)'["^LEXM") ET(""),ET("Required global "_$P($G(LEXGL),"(",1)_" not found.")
"RTN","LEX2036",105,0)
 D:$G(LEXGL)["^LEX"&($G(LEXGL)["^LEXM") CM
"RTN","LEX2036",106,0)
 Q
"RTN","LEX2036",107,0)
CHK ;   Check the Checksum
"RTN","LEX2036",108,0)
 D CS I $D(LEXE) D ED Q
"RTN","LEX2036",109,0)
 D BM("  OK"),M(" ")
"RTN","LEX2036",110,0)
 Q
"RTN","LEX2036",111,0)
CS ;   Checksum for import global
"RTN","LEX2036",112,0)
 K LEXE
"RTN","LEX2036",113,0)
 D BM("   Running checksum routine on the ^LEXM import global, please wait")
"RTN","LEX2036",114,0)
 N LEXCHK,LEXNDS,LEXVER S LEXCHK=+($G(^LEXM(0,"CHECKSUM")))
"RTN","LEX2036",115,0)
 S LEXNDS=+($G(^LEXM(0,"NODES"))),LEXVER=+($$VC(LEXCHK,LEXNDS))
"RTN","LEX2036",116,0)
 D M(" ") D:LEXVER>0 M("     Checksum is ok"),M(" ")
"RTN","LEX2036",117,0)
 D:LEXVER=0 CM D:LEXVER=-1 CW D:LEXVER=-2 CU D:LEXVER=-3 CF
"RTN","LEX2036",118,0)
 Q
"RTN","LEX2036",119,0)
VC(X,Y) ;   Verify Checksum for import global
"RTN","LEX2036",120,0)
 N LEXLREV,LEXREQP,LEXBUILD,LEXIGHF Q:'$D(^LEXM) 0
"RTN","LEX2036",121,0)
 D IMP I $G(^LEXM(0,"BUILD"))'=$G(LEXBUILD) Q -1
"RTN","LEX2036",122,0)
 N LEXCHK,LEXNDS,LEXCNT,LEXLC,LEXL,LEXS,LEXNC,LEXD,LEXN,LEXC,LEXGCS,LEXP,LEXT
"RTN","LEX2036",123,0)
 S LEXCHK=+($G(X)),LEXNDS=+($G(Y))
"RTN","LEX2036",124,0)
 Q:LEXCHK'>0!(LEXNDS'>0) -2
"RTN","LEX2036",125,0)
 S LEXL=64,(LEXCNT,LEXLC)=0,LEXS=(+(LEXNDS\LEXL))
"RTN","LEX2036",126,0)
 S:LEXS=0 LEXS=1 D:+($O(^LEXM(0)))>0 M("")
"RTN","LEX2036",127,0)
 S (LEXC,LEXN)="^LEXM",(LEXNC,LEXGCS)=0 W "   "
"RTN","LEX2036",128,0)
 F  S LEXN=$Q(@LEXN) Q:LEXN=""!(LEXN'[LEXC)  D
"RTN","LEX2036",129,0)
 . Q:LEXN="^LEXM(0,""CHECKSUM"")"
"RTN","LEX2036",130,0)
 . Q:LEXN="^LEXM(0,""NODES"")"
"RTN","LEX2036",131,0)
 . S LEXCNT=LEXCNT+1
"RTN","LEX2036",132,0)
 . I LEXCNT'<LEXS S LEXLC=LEXLC+1 W:LEXLC'>LEXL "." S LEXCNT=0
"RTN","LEX2036",133,0)
 . S LEXNC=LEXNC+1,LEXD=@LEXN,LEXT=LEXN_"="_LEXD
"RTN","LEX2036",134,0)
 . F LEXP=1:1:$L(LEXT) S LEXGCS=$A(LEXT,LEXP)*LEXP+LEXGCS
"RTN","LEX2036",135,0)
 Q:LEXNC'=LEXNDS -3
"RTN","LEX2036",136,0)
 Q:LEXGCS'=LEXCHK -3
"RTN","LEX2036",137,0)
 Q 1
"RTN","LEX2036",138,0)
SY(X) ;   Check System variables
"RTN","LEX2036",139,0)
 Q:'$D(IO)!('$D(IOF))!('$D(IOM))!('$D(ION))!('$D(IOSL))!('$D(IOST)) 0
"RTN","LEX2036",140,0)
 Q 1
"RTN","LEX2036",141,0)
UR(X) ;   Check User variables
"RTN","LEX2036",142,0)
 Q:'$L($G(DUZ(0))) 0
"RTN","LEX2036",143,0)
 Q:+($G(DUZ))=0!($$NOTDEF(+$G(DUZ))) 0
"RTN","LEX2036",144,0)
 Q 1
"RTN","LEX2036",145,0)
CPD(X) ;  Check Current Patched Data is installed
"RTN","LEX2036",146,0)
 N INS S INS=1
"RTN","LEX2036",147,0)
 ;    Check Last Lexicon Set/Kill
"RTN","LEX2036",148,0)
 S:'$D(^LEX(757.1,"B",183168,260335)) INS=0
"RTN","LEX2036",149,0)
 S:$D(^LEX(757.02,"ACODE","C9126 ",328380)) INS=0
"RTN","LEX2036",150,0)
 ;    Check Last CPT/HCPCS Procedures Set/Kill
"RTN","LEX2036",151,0)
 S:'$D(^ICPT("F","S8270",108083)) INS=0
"RTN","LEX2036",152,0)
 S:$D(^ICPT("D",31,90714)) INS=0
"RTN","LEX2036",153,0)
 ;    Check Last CPT Modifiers Set
"RTN","LEX2036",154,0)
 S:'$D(^DIC(81.3,"M",88230,88291,591)) INS=0
"RTN","LEX2036",155,0)
 S X=+($G(INS))
"RTN","LEX2036",156,0)
 Q X
"RTN","LEX2036",157,0)
 ;
"RTN","LEX2036",158,0)
 ; Error messages
"RTN","LEX2036",159,0)
 ;
"RTN","LEX2036",160,0)
CM ;   Missing ^LEXM
"RTN","LEX2036",161,0)
 N LEXLREV,LEXREQP,LEXBUILD,LEXIGHF D IMP
"RTN","LEX2036",162,0)
 D ET(""),ET("Missing import global ^LEXM.") D CO
"RTN","LEX2036",163,0)
 Q
"RTN","LEX2036",164,0)
CW ;   Wrong ^LEXM
"RTN","LEX2036",165,0)
 N LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXB D IMP
"RTN","LEX2036",166,0)
 S LEXB=$G(^LEXM(0,"BUILD")) D ET("")
"RTN","LEX2036",167,0)
 I $L(LEXBUILD),$L(LEXB),LEXBUILD'=LEXB D  Q
"RTN","LEX2036",168,0)
 . D ET(("Incorrect import global ^LEXM found ("_LEXB_" global)."))
"RTN","LEX2036",169,0)
 . D CKO
"RTN","LEX2036",170,0)
 D ET("Incorrect import global ^LEXM found.") D CKO
"RTN","LEX2036",171,0)
 Q
"RTN","LEX2036",172,0)
CU ;   Unable to verify
"RTN","LEX2036",173,0)
 N LEXLREV,LEXREQP,LEXBUILD,LEXIGHF D IMP
"RTN","LEX2036",174,0)
 D ET(""),ET("Unable to verify checksum for import global ^LEXM (possibly corrupt).") D CKO
"RTN","LEX2036",175,0)
 Q
"RTN","LEX2036",176,0)
CF ;   Failed checksum
"RTN","LEX2036",177,0)
 N LEXLREV,LEXREQP,LEXBUILD,LEXIGHF D IMP D ET("")
"RTN","LEX2036",178,0)
 D ET("Import global ^LEXM failed checksum.") D CKO
"RTN","LEX2036",179,0)
 Q
"RTN","LEX2036",180,0)
CO ;   Obtain new global
"RTN","LEX2036",181,0)
 N LEXLREV,LEXREQP,LEXBUILD,LEXIGHF D IMP
"RTN","LEX2036",182,0)
 D ET(""),ET("    Please obtain a copy of the import global ^LEXM contained in the ")
"RTN","LEX2036",183,0)
 D ET(("    global host file "_LEXIGHF_" before continuing with the "_LEXBUILD))
"RTN","LEX2036",184,0)
 D ET(("    installation."))
"RTN","LEX2036",185,0)
 Q
"RTN","LEX2036",186,0)
CKO ;   Kill and Obtain new global
"RTN","LEX2036",187,0)
 N LEXLREV,LEXREQP,LEXBUILD,LEXIGHF D IMP
"RTN","LEX2036",188,0)
 D ET(""),ET("    Please KILL the existing import global ^LEXM from your system")
"RTN","LEX2036",189,0)
 D ET(("    and obtain a new copy of ^LEXM contained in the global host file"))
"RTN","LEX2036",190,0)
 D ET(("    "_LEXIGHF_" before continuing with the "_LEXBUILD_" installation."))
"RTN","LEX2036",191,0)
 Q
"RTN","LEX2036",192,0)
ET(X) ;   Error Text
"RTN","LEX2036",193,0)
 N LEXI S LEXI=+($G(LEXE(0))),LEXI=LEXI+1,LEXE(LEXI)="    "_$G(X),LEXE(0)=LEXI
"RTN","LEX2036",194,0)
 Q
"RTN","LEX2036",195,0)
ED ;   Error Display
"RTN","LEX2036",196,0)
 N LEXI S LEXI=0 F  S LEXI=$O(LEXE(LEXI)) Q:+LEXI=0  D M(LEXE(LEXI))
"RTN","LEX2036",197,0)
 D M(" ") K LEXE Q
"RTN","LEX2036",198,0)
 ;                   
"RTN","LEX2036",199,0)
 ; Miscellaneous
"RTN","LEX2036",200,0)
 ;
"RTN","LEX2036",201,0)
IMP ;   Import names
"RTN","LEX2036",202,0)
 S LEXLREV=36,LEXREQP="LEX*2.0*32;LEX*2.0*35",LEXBUILD="LEX*2.0*36"
"RTN","LEX2036",203,0)
 S LEXIGHF="LEX_2_36.GBL"
"RTN","LEX2036",204,0)
 Q
"RTN","LEX2036",205,0)
NOTDEF(IEN) ;   Check to see if user is defined
"RTN","LEX2036",206,0)
 N DA,DR,DIQ,LEX,DIC S DA=IEN,DR=.01,DIC=200,DIQ="LEX" D EN^DIQ1 Q '$D(LEX)
"RTN","LEX2036",207,0)
OK ;   Environment is OK
"RTN","LEX2036",208,0)
 N LEXBUILD,LEXIGHF,LEXREQP,LEXLREV,LEXT
"RTN","LEX2036",209,0)
 D IMP S LEXT="  Environment "_$S($L(LEXBUILD):("for patch/build "_LEXBUILD_" "),1:"")_"is ok"
"RTN","LEX2036",210,0)
 D BM(LEXT),M(" ")
"RTN","LEX2036",211,0)
 Q
"RTN","LEX2036",212,0)
BM(X) ;   Blank Line with Message
"RTN","LEX2036",213,0)
 D BMES^XPDUTL($G(X)) Q
"RTN","LEX2036",214,0)
M(X) ;   Message
"RTN","LEX2036",215,0)
 D MES^XPDUTL($G(X)) Q
"RTN","LEX2036",216,0)
TRIM(X) ;   Trim Spaces
"RTN","LEX2036",217,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","LEX2036",218,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","LEX2036",219,0)
 Q X
"RTN","LEX2036",220,0)
 ; Exported Files
"RTN","LEX2036",221,0)
 ;;^LEX(757.01);^LEX(*;Lexicon;757-757.41
"RTN","LEX2036",222,0)
 ;;^LEXT(757.2);^LEXT(757.2);Lexicon Subsets/Defaults;757.2
"RTN","LEX2036",223,0)
 ;;^LEXC(757.9);^LEXC(*;Lexicon Change File;757.9-757.91
"RTN","LEX2036",224,0)
 ;;^LEXM(0);^LEXM(*;Lexicon Export/Import;No File #
"RTN","LEX2036",225,0)
 ;;^ICPT(0);^ICPT(;CPT/HCPCS;81
"RTN","LEX2036",226,0)
 ;;^DIC(81.1,0);^DIC(81.1);CPT Category;81.1
"RTN","LEX2036",227,0)
 ;;^DIC(81.2,0);^DIC(81.2);CPT Copyright;81.2
"RTN","LEX2036",228,0)
 ;;^DIC(81.3,0);^DIC(81.3);CPT Modifier;81.3
"RTN","LEX2036",229,0)
 ;;^ICD9(0);^ICD9(;ICD Diagnosis;80
"RTN","LEX2036",230,0)
 ;;^ICD0(0);^ICD0(;ICD Operation/Procedure;80.1
"RTN","LEX2036",231,0)
 ;;^ICD(0);^ICD(;DRG Grouper;80.2
"RTN","LEX2036",232,0)
 ;;^ICM(0);^ICM(;MAJOR DIAGNOSTIC CATEGORY;80.3
"RTN","LEX2036",233,0)
 Q
"RTN","LEX2036",234,0)
GD ; Global Data
"RTN","LEX2036",235,0)
 ;;^LEX(757.01);^LEX(*;Lexicon;757-757.41
"RTN","LEX2036",236,0)
 ;;^ICPT(0);^ICPT(;CPT/HCPCS;81
"RTN","LEX2036",237,0)
 ;;^DIC(81.3,0);^DIC(81.3);CPT Modifier;81.3
"RTN","LEX2036P")
0^2^B26627619
"RTN","LEX2036P",1,0)
LEX2036P ; ISL/KER - Pre/Post Install ; 06/23/2005
"RTN","LEX2036P",2,0)
 ;;2.0;LEXICON UTILITY;**36**;Sep 23, 1996
"RTN","LEX2036P",3,0)
 ;
"RTN","LEX2036P",4,0)
 ; External References
"RTN","LEX2036P",5,0)
 ;   DBIA 10086  HOME^%ZIS
"RTN","LEX2036P",6,0)
 ;   DBIA  2052  $$GET1^DID
"RTN","LEX2036P",7,0)
 ;   DBIA  2055  PRD^DILFD
"RTN","LEX2036P",8,0)
 ;   DBIA 10014  EN^DIU2
"RTN","LEX2036P",9,0)
 ;   DBIA 10141  BMES^XPDUTL
"RTN","LEX2036P",10,0)
 ;   DBIA 10141  MES^XPDUTL
"RTN","LEX2036P",11,0)
 ;                      
"RTN","LEX2036P",12,0)
 Q
"RTN","LEX2036P",13,0)
 ;                      
"RTN","LEX2036P",14,0)
POST ; LEX*2.0*36 Post-Install
"RTN","LEX2036P",15,0)
 N LEXEDT,LEXCHG,LEXSCHG S LEXEDT=$G(^LEXM(0,"CREATED"))
"RTN","LEX2036P",16,0)
 S LEXCHG=0 S:$D(^LEXM(80))!($D(^LEXM(80.1)))!($D(^LEXM(81)))!($D(^LEXM(81.2)))!($D(^LEXM(81.3))) LEXCHG=1
"RTN","LEX2036P",17,0)
 ;
"RTN","LEX2036P",18,0)
 ;-----------------------------
"RTN","LEX2036P",19,0)
 ;   Save Changes
"RTN","LEX2036P",20,0)
 D SCHG
"RTN","LEX2036P",21,0)
 ;
"RTN","LEX2036P",22,0)
 ;-----------------------------
"RTN","LEX2036P",23,0)
 ;   Load Data into Files
"RTN","LEX2036P",24,0)
 D LOAD
"RTN","LEX2036P",25,0)
 ;
"RTN","LEX2036P",26,0)
 ;-----------------------------
"RTN","LEX2036P",27,0)
 ;   Data Conversion
"RTN","LEX2036P",28,0)
 D CON
"RTN","LEX2036P",29,0)
 ;
"RTN","LEX2036P",30,0)
 ;-----------------------------
"RTN","LEX2036P",31,0)
 ;   Re-Index Files - N/A for LEX*2.0*36
"RTN","LEX2036P",32,0)
 ;   Do not use for Annual/Quarterly Updates, it disrupts the Protocol
"RTN","LEX2036P",33,0)
 ;   D RX
"RTN","LEX2036P",34,0)
 ;
"RTN","LEX2036P",35,0)
 ;-----------------------------
"RTN","LEX2036P",36,0)
 ;   Fire Protocol - N/A for LEX*2.0*36
"RTN","LEX2036P",37,0)
 ;   D NOTIFY^LEXXGI
"RTN","LEX2036P",38,0)
 ;
"RTN","LEX2036P",39,0)
 ;-----------------------------
"RTN","LEX2036P",40,0)
 ;   Send a Install Message
"RTN","LEX2036P",41,0)
 D MSG
"RTN","LEX2036P",42,0)
 ;
"RTN","LEX2036P",43,0)
 ;-----------------------------
"RTN","LEX2036P",44,0)
 ;   Clean up and Quit
"RTN","LEX2036P",45,0)
 D KLEXM
"RTN","LEX2036P",46,0)
 Q
"RTN","LEX2036P",47,0)
 ;                      
"RTN","LEX2036P",48,0)
LOAD ; Load Data from ^LEXM into IC*/LEX Files
"RTN","LEX2036P",49,0)
 N LEXB,LEXBUILD,LEXCD,LEXIGHF,LEXLAST,LEXLREV D IMP^LEX2036
"RTN","LEX2036P",50,0)
 S U="^",LEXB=$G(^LEXM(0,"BUILD")) Q:LEXB=""  Q:LEXBUILD=""
"RTN","LEX2036P",51,0)
 S LEXCD=0 S LEXCD=+($$CPD^LEX2036)
"RTN","LEX2036P",52,0)
 I LEXCD,LEXB=LEXBUILD D  G LQ
"RTN","LEX2036P",53,0)
 . S X="Data for patch "_LEXBUILD_" has already been installed"
"RTN","LEX2036P",54,0)
 . W:'$D(XPDNM) !!,X D:$D(XPDNM) BMES^XPDUTL(X)
"RTN","LEX2036P",55,0)
 . S X="" W:'$D(XPDNM) ! D:$D(XPDNM) MES^XPDUTL(X)
"RTN","LEX2036P",56,0)
 D:'LEXCD&(LEXB=LEXBUILD) EN^LEXXGI
"RTN","LEX2036P",57,0)
LQ ; Load Quit
"RTN","LEX2036P",58,0)
 D KLEXM
"RTN","LEX2036P",59,0)
 Q
"RTN","LEX2036P",60,0)
 ;
"RTN","LEX2036P",61,0)
MSG ; Send Installation Message to G.LEXICON
"RTN","LEX2036P",62,0)
 Q:+($G(DUZ))=0!($$NOTDEF^LEX2036($G(DUZ)))
"RTN","LEX2036P",63,0)
 D HOME^%ZIS N DIFROM,LEXLREV,LEXLAST,LEXBUILD,LEXIGHF
"RTN","LEX2036P",64,0)
 D IMP^LEX2036,POST^LEXXFI Q
"RTN","LEX2036P",65,0)
 ;
"RTN","LEX2036P",66,0)
SCHG ; Save Change File Changes
"RTN","LEX2036P",67,0)
 ; N/A for patch 36
"RTN","LEX2036P",68,0)
 Q
"RTN","LEX2036P",69,0)
 D MES^XPDUTL(" Updating Change File")
"RTN","LEX2036P",70,0)
 N LEXI,LEXFI,LEXFIL S LEXFI=0 F  S LEXFI=$O(^LEXM(LEXFI)) Q:+LEXFI=0  D
"RTN","LEX2036P",71,0)
 . S LEXI=0 F  S LEXI=$O(^LEXM(LEXFI,LEXI)) Q:+LEXI=0  D
"RTN","LEX2036P",72,0)
 . . N LEXCF,LEXIEN S LEXMUMPS=$G(^LEXM(LEXFI,LEXI)),LEXRT=$P(LEXMUMPS,"^",2)
"RTN","LEX2036P",73,0)
 . . S:LEXMUMPS["^LEX("!(LEXMUMPS["^LEXT(")!(LEXMUMPS["^LEXC(") LEXFIL=+($P(LEXRT,"(",2))
"RTN","LEX2036P",74,0)
 . . S:LEXMUMPS["^ICD9(" LEXFIL=80 S:LEXMUMPS["^ICD0(" LEXFIL=80.1 S:LEXMUMPS["^ICPT(" LEXFIL=81 S:LEXMUMPS["^DIC(81.3" LEXFIL=81.3
"RTN","LEX2036P",75,0)
 . . S:+LEXFIL>0 LEXSCHG(+LEXFIL,0)="" S LEXCF=+($P(LEXMUMPS,"LEXC(757.9,""AFIL"",",2))
"RTN","LEX2036P",76,0)
 . . S:$P(LEXCF,".",1)'="757"&("^80^80.1^81^81.3^"'[("^"_LEXCF_"^")) LEXCF=""
"RTN","LEX2036P",77,0)
 . . S LEXIEN=+($P(LEXMUMPS,("LEXC(757.9,""AFIL"","_+LEXCF_","),2))
"RTN","LEX2036P",78,0)
 . . I +LEXIEN>0&(+LEXCF)>0&("^80^80.1^81^81.3)"[LEXCF)&(+LEXFIL=757.9)&(LEXMUMPS["LEXC(757.9") D
"RTN","LEX2036P",79,0)
 . . . S LEXSCHG(+LEXFIL,LEXIEN)=LEXCF,LEXSCHG(757.9,"B",+LEXCF,LEXIEN)=""
"RTN","LEX2036P",80,0)
 . . S:$L(LEXMUMPS)&($L(LEXCF)) LEXCHGS(LEXCF)=""
"RTN","LEX2036P",81,0)
 Q
"RTN","LEX2036P",82,0)
 ;
"RTN","LEX2036P",83,0)
KLEXM ; Subscripted Kill of ^LEXM
"RTN","LEX2036P",84,0)
 N DA S DA=0 F  S DA=$O(^LEXM(DA)) Q:+DA=0  K ^LEXM(DA)
"RTN","LEX2036P",85,0)
 K ^LEXM(0)
"RTN","LEX2036P",86,0)
 Q
"RTN","LEX2036P",87,0)
 ;
"RTN","LEX2036P",88,0)
PRE ; LEX*2.0*36 Pre-Install   (N/A for patch 36)
"RTN","LEX2036P",89,0)
 Q
"RTN","LEX2036P",90,0)
 ;
"RTN","LEX2036P",91,0)
RX ; Reindex files
"RTN","LEX2036P",92,0)
 ; N/A for patch 36
"RTN","LEX2036P",93,0)
 Q
"RTN","LEX2036P",94,0)
 N LEX,DA,DIK,TH,TM,TD
"RTN","LEX2036P",95,0)
 D BMES^XPDUTL(" Re-indexing NEW Versioned Text Cross-References")
"RTN","LEX2036P",96,0)
 ;
"RTN","LEX2036P",97,0)
 D BMES^XPDUTL("   ICD-9 Diagnosis file                 #80") W !,"   "
"RTN","LEX2036P",98,0)
 S (LEX,DA)=0 F  S DA=$O(^ICD9(DA)) Q:+DA=0  K ^ICD9(DA,66,"B"),^ICD9(DA,67,"B"),^ICD9(DA,68,"B") S LEX=+($G(LEX))+1 W:LEX#120=0 "."
"RTN","LEX2036P",99,0)
 K ^ICD9("AB"),^ICD9("ACC"),^ICD9("ACT"),^ICD9("BA"),^ICD9("D"),^ICD9("AST"),^ICD9("ADS") S DIK="^ICD9(" D IXALL^DIK
"RTN","LEX2036P",100,0)
 ;
"RTN","LEX2036P",101,0)
 D MES^XPDUTL("   ICD-9 Operations/Procedure file      #80.1") W !,"   "
"RTN","LEX2036P",102,0)
 S (LEX,DA)=0 F  S DA=$O(^ICD0(DA)) Q:+DA=0  K ^ICD0(DA,66,"B"),^ICD0(DA,67,"B"),^ICD0(DA,68,"B") S LEX=+($G(LEX))+1 W:LEX#120=0 "."
"RTN","LEX2036P",103,0)
 K ^ICD0("AB"),^ICD0("ACT"),^ICD0("ADS"),^ICD0("AST"),^ICD0("BA"),^ICD0("D"),^ICD0("E") S DIK="^ICD0(" D IXALL^DIK
"RTN","LEX2036P",104,0)
 ;
"RTN","LEX2036P",105,0)
 D MES^XPDUTL("   DRG file                             #80.2") W !,"   "
"RTN","LEX2036P",106,0)
 S (LEX,DA)=0 F  S DA=$O(^ICD(DA)) Q:+DA=0  K ^ICD(DA,1,"B"),^ICD(DA,66,"B"),^ICD(DA,68,"B") S LEX=+($G(LEX))+1 W:LEX#120=0 "."
"RTN","LEX2036P",107,0)
 K ^ICD("ADS"),^ICD("B") S DIK="^ICD(" D IXALL^DIK
"RTN","LEX2036P",108,0)
 ;
"RTN","LEX2036P",109,0)
 D MES^XPDUTL("   CPT/HCPCS Procedure/Services file    #81") W !,"   "
"RTN","LEX2036P",110,0)
 S (LEX,DA)=0 F  S DA=$O(^ICPT(DA)) Q:+DA=0  D
"RTN","LEX2036P",111,0)
 . K ^ICPT(DA,60,"B"),^ICPT(DA,61,"B"),^ICPT(DA,62,"B"),^ICPT(DA,"D","B") S LEX=+($G(LEX))+1 W:LEX#120=0 "."
"RTN","LEX2036P",112,0)
 K ^ICPT("ACT"),^ICPT("ADS"),^ICPT("AST"),^ICPT("B"),^ICPT("BA"),^ICPT("C"),^ICPT("D"),^ICPT("E"),^ICPT("F") S DIK="^ICPT(" D IXALL^DIK
"RTN","LEX2036P",113,0)
 ;
"RTN","LEX2036P",114,0)
 D MES^XPDUTL("   CPT Modifier file                    #81.3") W !,"   "
"RTN","LEX2036P",115,0)
 S (LEX,DA)=0 F  S DA=$O(^DIC(81.3,DA)) Q:+DA=0  D
"RTN","LEX2036P",116,0)
 . K ^DIC(81.3,DA,60,"B"),^DIC(81.3,DA,61,"B"),^DIC(81.3,DA,62,"B") S LEX=+($G(LEX))+1 W:LEX#120=0 "."
"RTN","LEX2036P",117,0)
 K ^DIC(81.3,"ACT"),^DIC(81.3,"ADS"),^DIC(81.3,"AST"),^DIC(81.3,"B"),^DIC(81.3,"BA"),^DIC(81.3,"C"),^DIC(81.3,"D"),^DIC(81.3,"M") S DIK="^DIC(81.3," D IXALL^DIK
"RTN","LEX2036P",118,0)
 Q
"RTN","LEX2036P",119,0)
 ;
"RTN","LEX2036P",120,0)
CON ; Conversion of data       (N/A ;
"RTN","LEX2036P",121,0)
 ;----------------------------- for patch 36 only)
"RTN","LEX2036P",122,0)
 Q
"RTN","LEXA")
0^3^B29821376
"RTN","LEXA",1,0)
LEXA ; ISA/FJF/KER-Look-up (Silent) ; 06/23/2005
"RTN","LEXA",2,0)
 ;;2.0;LEXICON UTILITY;**3,4,6,19,25,36**;Sep 23, 1996
"RTN","LEXA",3,0)
 ;
"RTN","LEXA",4,0)
 ; External References
"RTN","LEXA",5,0)
 ;   DBIA 10104  $$UP^XLFSTR
"RTN","LEXA",6,0)
 ;   DBIA 10103  $$DT^XLFDT
"RTN","LEXA",7,0)
 ;   DBIA 10060  ^VA(200,
"RTN","LEXA",8,0)
 ;   DBIA 10016  ^DIM
"RTN","LEXA",9,0)
 ;                   
"RTN","LEXA",10,0)
 ; Look-up  D LOOK^LEXA(LEXX,LEXAP,LEXLL,LEXSUB,lexvdt)
"RTN","LEXA",11,0)
 ;                   
"RTN","LEXA",12,0)
 ;         LEXX      User Input
"RTN","LEXA",13,0)
 ;         LEXAP     Application
"RTN","LEXA",14,0)
 ;         LEXLL     Selection List Length
"RTN","LEXA",15,0)
 ;         LEXSUB    Mode/Subset (file 757.2)
"RTN","LEXA",16,0)
 ;         LEXVDT    Date to use for retrieving/displaying codes
"RTN","LEXA",17,0)
 ;                   
"RTN","LEXA",18,0)
 ; 1.  Search parameters ^TMP("LEXSCH",$J,PAR)=VALUE
"RTN","LEXA",19,0)
 ; 2.  Expressions found ^TMP("LEXFND",$J,FQ,IEN)=DT
"RTN","LEXA",20,0)
 ; 3.  Review List       ^TMP("LEXHITS",$J,#)=IEN^DT
"RTN","LEXA",21,0)
 ; 4.  Display List      LEX("LIST",#)
"RTN","LEXA",22,0)
 ;                   
"RTN","LEXA",23,0)
 ;         LEX("LIST",0)=LAST^TOTAL
"RTN","LEXA",24,0)
 ;         LEX("LIST",#)=IEN^DT
"RTN","LEXA",25,0)
 ;                   
"RTN","LEXA",26,0)
LOOK(LEXX,LEXAP,LEXLL,LEXSUB,LEXVDT) ; Search for LEXX
"RTN","LEXA",27,0)
 I $G(LEXVDT)="" S LEXVDT=$$DT^XLFDT
"RTN","LEXA",28,0)
 K DIERR,LEX
"RTN","LEXA",29,0)
 K ^TMP("LEXFND",$J),^TMP("LEXHIT",$J)
"RTN","LEXA",30,0)
 K:+$G(^TMP("LEXSCH",$J,"ADF",0))=0 ^TMP("LEXSCH",$J)
"RTN","LEXA",31,0)
 I $D(DIC(0)) D
"RTN","LEXA",32,0)
 .S:DIC(0)["L" DIC(0)=$P(DIC(0),"L",1)_$P(DIC(0),"L",2)
"RTN","LEXA",33,0)
 .S:DIC(0)["I" DIC(0)=$P(DIC(0),"I",1)_$P(DIC(0),"I",2)
"RTN","LEXA",34,0)
 S LEXQ=1,LEXX=$G(LEXX)
"RTN","LEXA",35,0)
 I LEXX=""!(LEXX["^") D EN^LEXAR("^",$G(LEXVDT)) K LEXAP D EXIT Q
"RTN","LEXA",36,0)
 S LEXAP=$$UP^XLFSTR($G(LEXAP))
"RTN","LEXA",37,0)
 S LEXLL=+$G(LEXLL)
"RTN","LEXA",38,0)
 S LEXSUB=$G(LEXSUB)
"RTN","LEXA",39,0)
 S ^TMP("LEXSCH",$J,"APP",0)=+$$AP^LEXDFN2($G(LEXAP))
"RTN","LEXA",40,0)
 S:^TMP("LEXSCH",$J,"APP",0)=0 ^TMP("LEXSCH",$J,"APP",0)=1
"RTN","LEXA",41,0)
 S:LEXSUB="" LEXSUB=^TMP("LEXSCH",$J,"APP",0)
"RTN","LEXA",42,0)
 S:$L($G(DIC("S"))) ^TMP("LEXSCH",$J,"FIL",0)=DIC("S")
"RTN","LEXA",43,0)
 S:LEXLL=0 LEXLL=5
"RTN","LEXA",44,0)
 S ^TMP("LEXSCH",$J,"LEN",0)=LEXLL
"RTN","LEXA",45,0)
X ; Search for X
"RTN","LEXA",46,0)
 I '$L($G(LEXX)) D  D EXIT Q
"RTN","LEXA",47,0)
 .S LEX("ERR",0)=$G(LEX("ERR",0))+1
"RTN","LEXA",48,0)
 .S LEX("ERR",LEX("ERR",0))="User input LEXX missing or invalid"
"RTN","LEXA",49,0)
APP ; Application
"RTN","LEXA",50,0)
 I +$G(^TMP("LEXSCH",$J,"APP",0))=0!('$D(^LEXT(757.2,+$G(^TMP("LEXSCH",$J,"APP",0)),0))) D  D EXIT Q
"RTN","LEXA",51,0)
 .S LEX("ERR",0)=$G(LEX("ERR",0))+1
"RTN","LEXA",52,0)
 .S LEX("ERR",LEX("ERR",0))="Calling application identification LEXAP missing or invalid"
"RTN","LEXA",53,0)
USR ; User
"RTN","LEXA",54,0)
 I +$G(DUZ)=0!('$D(^VA(200,+$G(DUZ),0))) D  D EXIT Q
"RTN","LEXA",55,0)
 .S LEX("ERR",0)=$G(LEX("ERR",0))+1
"RTN","LEXA",56,0)
 .S LEX("ERR",LEX("ERR",0))="User identification DUZ missing or invalid"
"RTN","LEXA",57,0)
 N LEXFND
"RTN","LEXA",58,0)
 S LEXFND=0
"RTN","LEXA",59,0)
 S ^TMP("LEXSCH",$J,"USR",0)=+$G(DUZ)
"RTN","LEXA",60,0)
 S ^TMP("LEXSCH",$J,"NAR",0)=LEXX
"RTN","LEXA",61,0)
 S ^TMP("LEXSCH",$J,"SCH",0)=$$UP^XLFSTR(LEXX)
"RTN","LEXA",62,0)
DEF ; Defaults                     CONFIG^LEXSET
"RTN","LEXA",63,0)
 N LEXFIL,LEXDSP,LEXFILR S:$L($G(DIC("S"))) LEXFIL=DIC("S")
"RTN","LEXA",64,0)
 I '$L($G(LEXFIL)),$L($G(^TMP("LEXSCH",$J,"FIL",0))) S LEXFIL=^TMP("LEXSCH",$J,"FIL",0)
"RTN","LEXA",65,0)
 N LEXNS,LEXSS
"RTN","LEXA",66,0)
 S LEXNS=$$NS^LEXDFN2(LEXAP)
"RTN","LEXA",67,0)
 S LEXSS=$$MD^LEXDFN2(LEXSUB)
"RTN","LEXA",68,0)
 I +$G(^TMP("LEXSCH",$J,"ADF",0))=0 D CONFIG^LEXSET(LEXNS,LEXSS,$G(LEXVDT))
"RTN","LEXA",69,0)
 I '$L($G(LEXFIL)),$L($G(^TMP("LEXSCH",$J,"FIL",0))) S LEXFIL=^TMP("LEXSCH",$J,"FIL",0)
"RTN","LEXA",70,0)
 S:$L($G(LEXFIL)) LEXFIL=$$FIL(LEXFIL)
"RTN","LEXA",71,0)
 S LEXFIL=$G(LEXFIL)
"RTN","LEXA",72,0)
 K ^TMP("LEXFND",$J),^TMP("LEXHIT",$J)
"RTN","LEXA",73,0)
 D MAN
"RTN","LEXA",74,0)
 I $D(LEX("ERR")) D EXIT Q
"RTN","LEXA",75,0)
 D SETUP^LEXAM($G(^TMP("LEXSCH",$J,"VOC",0)))
"RTN","LEXA",76,0)
 I $D(LEX("ERR")) D EXIT Q
"RTN","LEXA",77,0)
LK ; Look-up
"RTN","LEXA",78,0)
IEN ; Look-up by IEN               ADDL^LEXAL PCH 4
"RTN","LEXA",79,0)
 I ^TMP("LEXSCH",$J,"NAR",0)?1"`"1N.N D  I $D(LEX("LIST")) D EXIT Q
"RTN","LEXA",80,0)
 .N LEXE,LEXUN
"RTN","LEXA",81,0)
 .S LEXE=+$E(^TMP("LEXSCH",$J,"NAR",0),2,$L(^TMP("LEXSCH",$J,"NAR",0))) Q:LEXE=0
"RTN","LEXA",82,0)
 .S LEXUN=+$G(^TMP("LEXSCH",$J,"UNR",0))
"RTN","LEXA",83,0)
 .Q:'$D(^LEX(757.01,LEXE,0))
"RTN","LEXA",84,0)
 .D ADDL^LEXAL(LEXE,$$DES^LEXASC(LEXE),$$SO^LEXASO(LEXE,$G(^TMP("LEXSCH",$J,"DIS",0)),1,$G(LEXVDT)))
"RTN","LEXA",85,0)
 .I $D(^TMP("LEXFND",$J)) D BEG^LEXAL
"RTN","LEXA",86,0)
 .I LEXUN>0,$L($G(^TMP("LEXSCH",$J,"NAR",0))) S LEX("NAR")=$G(^TMP("LEXSCH",$J,"NAR",0))
"RTN","LEXA",87,0)
 .I LEXUN>0,$L($G(^LEX(757.01,+$G(LEXE),0))) S LEX("NAR")=$G(^LEX(757.01,+$G(LEXE),0))
"RTN","LEXA",88,0)
SCT ; Look-up by Shortcuts         EN^LEXASC  
"RTN","LEXA",89,0)
 I +$G(^TMP("LEXSCH",$J,"SCT",0)),$D(^LEX(757.41,^TMP("LEXSCH",$J,"SCT",0))) D
"RTN","LEXA",90,0)
 .S LEXFND=$$EN^LEXASC(^TMP("LEXSCH",$J,"SCH",0),^TMP("LEXSCH",$J,"SCT",0),$G(LEXVDT))
"RTN","LEXA",91,0)
 I +LEXFND D EXIT Q
"RTN","LEXA",92,0)
CODE ; Look-up by Code              EN^LEXABC
"RTN","LEXA",93,0)
 S LEXFND=$$EN^LEXABC(^TMP("LEXSCH",$J,"SCH",0),$G(LEXVDT))
"RTN","LEXA",94,0)
 I +LEXFND D EXIT Q
"RTN","LEXA",95,0)
 ; if code is found but it is inactive
"RTN","LEXA",96,0)
 ;I +$P(LEXFND,"^",2)'=-1 S LEX=0 D EXIT Q
"RTN","LEXA",97,0)
EXACT ; Look-up Exact Match          EN^LEXAB
"RTN","LEXA",98,0)
 S LEXFND=$$EN^LEXAB(^TMP("LEXSCH",$J,"SCH",0),$G(LEXVDT))
"RTN","LEXA",99,0)
 K:+LEXFND=0 ^TMP("LEXFND",$J)
"RTN","LEXA",100,0)
 K ^TMP("LEXHIT",$J)
"RTN","LEXA",101,0)
KEYWRD ; Look-up by word              EN^LEXALK
"RTN","LEXA",102,0)
 D EN^LEXALK
"RTN","LEXA",103,0)
EXIT ; Clean-up and quit
"RTN","LEXA",104,0)
 K LEXQ,LEXDICS,LEXFIL,LEXFILR,LEXDSP,LEXSHOW,LEXSHCT,LEXSUB
"RTN","LEXA",105,0)
 K LEXOVR,LEXUN,LEXLKFL,LEXLKGL,LEXLKIX,LEXLKSH,LEXTKNS,LEXTKN
"RTN","LEXA",106,0)
 K LEXI
"RTN","LEXA",107,0)
 D:$D(LEX("ERR")) CLN
"RTN","LEXA",108,0)
 I $D(LEX),+$G(LEX)=0,'$D(LEX("LIST")),$L($G(LEXX)) D
"RTN","LEXA",109,0)
 .N LEXC,LEXF,LEXV
"RTN","LEXA",110,0)
 .S LEXC=1
"RTN","LEXA",111,0)
 .S LEXF=$G(^TMP("LEXSCH",$J,"FIL",0))
"RTN","LEXA",112,0)
 .S LEXV=$G(^TMP("LEXSCH",$J,"VOC",0))
"RTN","LEXA",113,0)
 .D:+$G(^TMP("LEXSCH",$J,"UNR",0))>0 EN^LEXAR(LEXX,$G(LEXVDT))
"RTN","LEXA",114,0)
 .S LEX("NAR")=LEXX
"RTN","LEXA",115,0)
 .S LEX=0
"RTN","LEXA",116,0)
 .S LEX("HLP",LEXC)="    A suitable term could not be found based on user input"
"RTN","LEXA",117,0)
 .S:LEXF="I 1" LEXF=""
"RTN","LEXA",118,0)
 .I $L(LEXF)!(LEXV'="WRD") D
"RTN","LEXA",119,0)
 ..S LEX("HLP",LEXC)=$G(LEX("HLP",LEXC))_" and "
"RTN","LEXA",120,0)
 ..S LEXC=LEXC+1
"RTN","LEXA",121,0)
 ..S LEX("HLP",LEXC)="    current user defaults"
"RTN","LEXA",122,0)
 ..S LEX("HLP",0)=LEXC
"RTN","LEXA",123,0)
 .S LEX("HLP",LEXC)=$G(LEX("HLP",LEXC))_"."
"RTN","LEXA",124,0)
 Q
"RTN","LEXA",125,0)
CLN ; Clean
"RTN","LEXA",126,0)
 K LEXQ,LEXTKNS,LEXTKN,LEXI
"RTN","LEXA",127,0)
 K ^TMP("LEXSCH",$J),^TMP("LEXHIT",$J),^TMP("LEXFND",$J)
"RTN","LEXA",128,0)
 Q
"RTN","LEXA",129,0)
CLR ; Clear all (FOR TESTING ONLY)
"RTN","LEXA",130,0)
 K LEX,LEXQ,LEXTKNS,LEXTKN,LEXI
"RTN","LEXA",131,0)
 K ^TMP("LEXSCH"),^TMP("LEXHIT"),^TMP("LEXFND")
"RTN","LEXA",132,0)
 Q
"RTN","LEXA",133,0)
MAN ; Mandatory variables
"RTN","LEXA",134,0)
 N LEXERR
"RTN","LEXA",135,0)
 F LEXERR="SCH","VOC","APP","USR" D
"RTN","LEXA",136,0)
 .I '$L($G(^TMP("LEXSCH",$J,LEXERR,0))) D
"RTN","LEXA",137,0)
 ..S LEX("ERR",0)=$G(LEX("ERR",0))+1
"RTN","LEXA",138,0)
 ..S LEX("ERR",LEX("ERR",0))="Mandatory variable ^TMP(""LEXSCH"",$J,"""_LEXERR_""",0) missing or invalid"
"RTN","LEXA",139,0)
 Q
"RTN","LEXA",140,0)
FIL(X) ; Validate Filter
"RTN","LEXA",141,0)
 S X=$G(X)
"RTN","LEXA",142,0)
 Q:'$L(X) X
"RTN","LEXA",143,0)
 D ^DIM
"RTN","LEXA",144,0)
 S:'$D(X) X=""
"RTN","LEXA",145,0)
 Q X
"RTN","LEXA",146,0)
 ;                   
"RTN","LEXA",147,0)
 ; D INFO^LEXA(IEN,DATE)
"RTN","LEXA",148,0)
 ;                   
"RTN","LEXA",149,0)
 ;    IEN   Internal Entry Number in file 757.01
"RTN","LEXA",150,0)
 ;    DATE  Optional - retrieves codes active on a specified date
"RTN","LEXA",151,0)
 ;               
"RTN","LEXA",152,0)
 ; Returns array LEX("SEL") or null
"RTN","LEXA",153,0)
 ;                   
"RTN","LEXA",154,0)
 ;    LEX("SEL","EXP")   Expressions Concepts/Synonyms/Variants
"RTN","LEXA",155,0)
 ;    LEX("SEL","SIG")   Expression definition
"RTN","LEXA",156,0)
 ;    LEX("SEL","SRC")   Classification Codes
"RTN","LEXA",157,0)
 ;    LEX("SEL"."STY")   Semantic Class/Semantic Types
"RTN","LEXA",158,0)
 ;    LEX("SEL","VAS")   VA Classification Sources
"RTN","LEXA",159,0)
 ;                   
"RTN","LEXA",160,0)
INFO(X,LEXVDT) ; Get Information about a Term
"RTN","LEXA",161,0)
 K LEX("SEL") S X=+$G(X) Q:X=0  Q:'$D(^LEX(757.01,X,0))
"RTN","LEXA",162,0)
 N LEXD S LEXD=$G(LEXVDT) S:+LEXD'>0 LEXD=$$DT^XLFDT
"RTN","LEXA",163,0)
 N LEXVDT S LEXVDT=LEXD D SET^LEXAR4(X,LEXVDT)
"RTN","LEXA",164,0)
 Q
"RTN","LEXU")
0^4^B21347999
"RTN","LEXU",1,0)
LEXU ; ISA/FJF-Miscellaneous Lexicon Utilities; 06/23/2005
"RTN","LEXU",2,0)
 ;;2.0;LEXICON UTILITY;**2,6,9,15,25,36**;Sep 23, 1996
"RTN","LEXU",3,0)
 ;
"RTN","LEXU",4,0)
 ; External References
"RTN","LEXU",5,0)
 ;   DBIA 10103  $$DT^XLFDT
"RTN","LEXU",6,0)
 ;   DBIA  3990  $$ICDDX^ICDCODE
"RTN","LEXU",7,0)
 ;   DBIA  1995  $$CPT^ICPTCOD
"RTN","LEXU",8,0)
 ;                         
"RTN","LEXU",9,0)
SC(LEX,LEXS,LEXVDT) ; Filter by Semantic Class
"RTN","LEXU",10,0)
 ;    LEX      IEN of file 757.01
"RTN","LEXU",11,0)
 ;    LEXS     Filter
"RTN","LEXU",12,0)
 ;    LEXVDT   Date to use for screening by codes
"RTN","LEXU",13,0)
 N LEXINC,LEXEXC,LEXIC,LEXEC,LEXRREC
"RTN","LEXU",14,0)
 S LEXRREC=LEX Q:'$D(^LEX(757.01,LEXRREC,0)) 0
"RTN","LEXU",15,0)
 I $L(LEXS,";")=3,$P(LEXS,";",3)'="" D  I LEXINC K LEXIC,LEXEXC,LEXS,LEXEC Q LEXINC
"RTN","LEXU",16,0)
 . S LEXINC=0 S LEXINC=$$SO(LEXRREC,$P(LEXS,";",3),$G(LEXVDT))
"RTN","LEXU",17,0)
 S LEXRREC=$P(^LEX(757.01,LEXRREC,1),U,1)
"RTN","LEXU",18,0)
 S LEXINC=0 F LEXIC=1:1:$L($P(LEXS,";",1),"/") D
"RTN","LEXU",19,0)
 . I $D(^LEX(757.1,"AMCC",LEXRREC,$P($P(LEXS,";",1),"/",LEXIC)))!($D(^LEX(757.1,"AMCT",LEXRREC,$P($P(LEXS,";",1),"/",LEXIC)))) S LEXINC=1,LEXIC=$L($P(LEXS,";",1),"/")+1
"RTN","LEXU",20,0)
 I LEXINC=0!($P(LEXS,";",2)="") K LEXIC,LEXS,LEXEC Q LEXINC
"RTN","LEXU",21,0)
 S LEXEXC=0 F LEXEC=1:1:$L($P(LEXS,";",2),"/") D
"RTN","LEXU",22,0)
 . I $D(^LEX(757.1,"AMCC",LEXRREC,$P($P(LEXS,";",2),"/",LEXEC)))!($D(^LEX(757.1,"AMCT",LEXRREC,$P($P(LEXS,";",2),"/",LEXEC)))) S LEXEXC=1,LEXEC=$L($P(LEXS,";",2),"/")+1
"RTN","LEXU",23,0)
 I LEXINC,'LEXEXC K LEXIC,LEXS,LEXEC Q 1
"RTN","LEXU",24,0)
 K LEXIC,LEXS,LEXEC Q 0
"RTN","LEXU",25,0)
SO(LEX,LEXS,LEXVDT) ; Filter by Source
"RTN","LEXU",26,0)
 ;    LEX      IEN of file 757.01
"RTN","LEXU",27,0)
 ;    LEXS     Filter
"RTN","LEXU",28,0)
 ;    LEXVDT   Date to use for screening by codes
"RTN","LEXU",29,0)
 N LEXTREC S LEXTREC=+LEX Q:'$D(^LEX(757.01,LEXTREC,0)) 0
"RTN","LEXU",30,0)
 N LEXFND S LEXFND=0,LEXTREC=+LEXTREC Q:'$D(^LEX(757.01,LEXTREC)) LEXFND
"RTN","LEXU",31,0)
 N LEXCODE,LEXSOID,LEXCREC,LEXSAB,LEXMC,LEXN0,LEXSO,LEXSTA
"RTN","LEXU",32,0)
 S LEXMC=$P(^LEX(757.01,LEXTREC,1),U,1)
"RTN","LEXU",33,0)
 S LEXMCE=+(^LEX(757,+($P(^LEX(757.01,LEXTREC,1),U,1)),0))
"RTN","LEXU",34,0)
 I LEXTREC=LEXMCE D  G SOQ
"RTN","LEXU",35,0)
 . S LEXFND=0 F LEXSOID=1:1:$L(LEXS,"/") Q:LEXFND  D
"RTN","LEXU",36,0)
 . . S LEXCODE=$P(LEXS,"/",LEXSOID),LEXCREC=0
"RTN","LEXU",37,0)
 . . F  S LEXCREC=$O(^LEX(757.02,"AMC",LEXMC,LEXCREC)) Q:+LEXCREC=0!(LEXFND)  D
"RTN","LEXU",38,0)
 . . . S LEXN0=$G(^LEX(757.02,LEXCREC,0))
"RTN","LEXU",39,0)
 . . . S LEXSAB=+($P(LEXN0,U,3)),LEXSO=$P(LEXN0,U,2)
"RTN","LEXU",40,0)
 . . . S LEXSTA=$$STATCHK^LEXSRC2(LEXSO,$G(LEXVDT)) Q:+LEXSTA'>0
"RTN","LEXU",41,0)
 . . . Q:'$D(^LEX(757.03,LEXSAB,0))
"RTN","LEXU",42,0)
 . . . S LEXSAB=$E(^LEX(757.03,LEXSAB,0),1,3)
"RTN","LEXU",43,0)
 . . . I LEXSAB=LEXCODE S LEXFND=1
"RTN","LEXU",44,0)
SOQ ; Quit Source Filter
"RTN","LEXU",45,0)
 K LEX,LEXTREC,LEXMC,LEXS,LEXCODE,LEXMCE,LEXSOID Q LEXFND
"RTN","LEXU",46,0)
SRC(LEX,LEXS) ; Filter by Expression Source
"RTN","LEXU",47,0)
 ;    LEX      IEN of file 757.01
"RTN","LEXU",48,0)
 ;    LEXS     Filter
"RTN","LEXU",49,0)
 S LEX=+($G(LEX)),LEXS=+($G(LEXS))
"RTN","LEXU",50,0)
 Q:LEX=0 0 Q:LEXS=0 0 Q:'$D(^LEX(757.01,LEX,0)) 0 Q:'$D(^LEX(757.14,LEXS,0)) 0
"RTN","LEXU",51,0)
 S LEXSR=$P($G(^LEX(757.01,LEX,1)),U,12) Q:LEXSR=LEXS 1
"RTN","LEXU",52,0)
 N LEXSR,LEXMC,LEXMCE S LEXMC=+($G(^LEX(757.01,LEX,1))),LEXMCE=+($G(^LEX(757,+LEXMC,0)))
"RTN","LEXU",53,0)
 S LEXSR=$P($G(^LEX(757.01,LEXMCE,1)),U,12) Q:LEXSR=LEXS 1
"RTN","LEXU",54,0)
 Q 0
"RTN","LEXU",55,0)
DEF(LEX) ; Display expression definition
"RTN","LEXU",56,0)
 ;    LEX      IEN of file 757.01
"RTN","LEXU",57,0)
 I $D(^LEX(757.01,LEX,3,0)) D
"RTN","LEXU",58,0)
 . N LEXLN F LEXLN=1:1:$P(^LEX(757.01,LEX,3,0),U,4) D
"RTN","LEXU",59,0)
 . . I $D(^LEX(757.01,LEX,3,LEXLN,0)) W !,?2,^LEX(757.01,LEX,3,LEXLN,0)
"RTN","LEXU",60,0)
 . K LEX,LEXLN W !
"RTN","LEXU",61,0)
 Q
"RTN","LEXU",62,0)
ID(LEX) ; ICD Diagnosis retained - ICD procedures ignored
"RTN","LEXU",63,0)
 ;    LEX      Code
"RTN","LEXU",64,0)
 Q:'$L($G(LEX)) "" Q:$L($P(LEX,".",1))<3 "" Q:'$D(^LEX(757.02,"AVA",(LEX_" "))) ""
"RTN","LEXU",65,0)
 N LEXO,LEXR S (LEXO,LEXR)=0 F  S LEXR=$O(^LEX(757.02,"AVA",(LEX_" "),LEXR)) Q:+LEXR=0  D  Q:LEXO=1
"RTN","LEXU",66,0)
 . I $D(^LEX(757.02,"AVA",(LEX_" "),LEXR,"ICD")) S LEXO=1
"RTN","LEXU",67,0)
 Q:'LEXO "" Q LEX
"RTN","LEXU",68,0)
ICDONE(LEX,LEXVDT) ; Return one ICD code for an expression
"RTN","LEXU",69,0)
 ;    LEX      IEN of file 757.01
"RTN","LEXU",70,0)
 ;    LEXVDT   Date to use for screening by codes
"RTN","LEXU",71,0)
 N LEXICD
"RTN","LEXU",72,0)
 S LEXVDT=$S(+$G(LEXVDT)>0:LEXVDT,1:$$DT^XLFDT)
"RTN","LEXU",73,0)
 S LEX=$$ONE^LEXSRC(LEX,"ICD",LEXVDT)
"RTN","LEXU",74,0)
 Q:LEX="" ""
"RTN","LEXU",75,0)
 S LEXICD=$$ICDDX^ICDCODE(LEX,LEXVDT)
"RTN","LEXU",76,0)
 Q:$P(LEXICD,"^",2)="INVALID CODE" ""
"RTN","LEXU",77,0)
 Q LEX
"RTN","LEXU",78,0)
ICD(LEX,LEXVDT) ; Return all ICD codes for an expression
"RTN","LEXU",79,0)
 ;    LEX      IEN of file 757.01
"RTN","LEXU",80,0)
 ;    LEXVDT   Date to use for screening by codes
"RTN","LEXU",81,0)
 S LEXVDT=$S(+$G(LEXVDT)>0:LEXVDT,1:$$DT^XLFDT)
"RTN","LEXU",82,0)
 N LEXSRC,LEXICD
"RTN","LEXU",83,0)
 D ALL^LEXSRC(LEX,"ICD",LEXVDT) Q:+$G(LEXSRC(0))'>0 ""
"RTN","LEXU",84,0)
 N LEXI,LEXT,LEXS S LEXI=0,LEXT=""
"RTN","LEXU",85,0)
 F  S LEXI=$O(LEXSRC(LEXI)) Q:+LEXI=0  D
"RTN","LEXU",86,0)
 . S LEXS=LEXSRC(LEXI)
"RTN","LEXU",87,0)
 . S LEXICD=$$ICDDX^ICDCODE(LEXS,LEXVDT)
"RTN","LEXU",88,0)
 . Q:$P(LEXICD,"^",2)="INVALID CODE"
"RTN","LEXU",89,0)
 . Q:(LEXT_";")[(";"_LEXS_";")  S LEXT=LEXT_";"_LEXS
"RTN","LEXU",90,0)
 S:$E(LEXT,1)=";" LEXT=$E(LEXT,2,$L(LEXT)) S LEX=LEXT Q LEX
"RTN","LEXU",91,0)
CPTONE(LEX,LEXVDT) ; Return one CPT code for an expression
"RTN","LEXU",92,0)
 ;    LEX      IEN of file 757.01
"RTN","LEXU",93,0)
 ;    LEXVDT   Date to use for screening by codes
"RTN","LEXU",94,0)
 S LEXVDT=$S(+$G(LEXVDT)>0:LEXVDT,1:$$DT^XLFDT)
"RTN","LEXU",95,0)
 N LEXCPT
"RTN","LEXU",96,0)
 S LEX=$$ONE^LEXSRC(LEX,"CPT",LEXVDT)
"RTN","LEXU",97,0)
 Q:LEX="" ""
"RTN","LEXU",98,0)
 S LEXCPT=$$CPT^ICPTCOD(LEX,LEXVDT)
"RTN","LEXU",99,0)
 Q:$P(LEXCPT,"^",2)="NO SUCH ENTRY" ""
"RTN","LEXU",100,0)
 I +$P(LEXCPT,"^",7)=0 S LEX=""
"RTN","LEXU",101,0)
 Q LEX
"RTN","LEXU",102,0)
CPCONE(LEX,LEXVDT) ; Return one HCPCS code for an expression
"RTN","LEXU",103,0)
 ;    LEX      IEN of file 757.01
"RTN","LEXU",104,0)
 ;    LEXVDT   Date to use for screening by codes
"RTN","LEXU",105,0)
 S LEXVDT=$S(+$G(LEXVDT)>0:LEXVDT,1:$$DT^XLFDT)
"RTN","LEXU",106,0)
 N LEXCPT
"RTN","LEXU",107,0)
 S LEX=$$ONE^LEXSRC(LEX,"CPC",LEXVDT)
"RTN","LEXU",108,0)
 Q:LEX="" ""
"RTN","LEXU",109,0)
 S LEXCPT=$$CPT^ICPTCOD(LEX,LEXVDT)
"RTN","LEXU",110,0)
 Q:$P(LEXCPT,"^",2)="NO SUCH ENTRY" ""
"RTN","LEXU",111,0)
 I +$P(LEXCPT,"^",7)=0 S LEX=""
"RTN","LEXU",112,0)
 I LEX'?1U.4N S LEX=""
"RTN","LEXU",113,0)
 Q LEX
"RTN","LEXU",114,0)
DSMONE(LEX) ; Return one DSM code for an expression
"RTN","LEXU",115,0)
 ;    LEX      IEN of file 757.01
"RTN","LEXU",116,0)
 ;    LEXVDT   Date to use for screening by codes
"RTN","LEXU",117,0)
 ; Check for DSM-IV first
"RTN","LEXU",118,0)
 S LEX=$$ONE^LEXSRC(LEX,"DS4") I LEX'="" Q LEX
"RTN","LEXU",119,0)
 ; If not DSM-IV, then check for DSM-III
"RTN","LEXU",120,0)
 S LEX=$$ONE^LEXSRC(LEX,"DS3") Q LEX
"RTN","LEXU",121,0)
ADR(LEX) ; Mailing Address
"RTN","LEXU",122,0)
 N DIC,DTOUT,DUOUT,X,Y S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="FO-SLC.MED.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEXU",123,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="ISC-SLC.MED.VA.GOV" D ^DIC Q:+Y>0 LEX
"RTN","LEXU",124,0)
 Q "ISC-SLC.VA.GOV"
"VER")
8.0^22.0
"BLD",5836,6)
^SEQ #35
**END**
**END**
