Released PSS*1*91 SEQ #82
Extracted from mail message
**KIDS**:PSS*1.0*91^

**INSTALL NAME**
PSS*1.0*91
"BLD",5317,0)
PSS*1.0*91^PHARMACY DATA MANAGEMENT^0^3041123^y
"BLD",5317,1,0)
^^13^13^3041123^
"BLD",5317,1,1,0)
This patch contains updated Application Program Interfaces (APIs) that 
"BLD",5317,1,2,0)
will be used by calling applications that currently do direct global 
"BLD",5317,1,3,0)
reads or writes to the Pharmacy Data Management files.  A review of the 
"BLD",5317,1,4,0)
previously released APIs showed several entry points where additional 
"BLD",5317,1,5,0)
pieces of data were required to be returned.
"BLD",5317,1,6,0)
 
"BLD",5317,1,7,0)
If you have already made code modifications, or have made plans to make
"BLD",5317,1,8,0)
code modifications to use any of the new APIs, please check the latest
"BLD",5317,1,9,0)
version of the API manual to verify that the API(s) in question have an
"BLD",5317,1,10,0)
Active status. The API manual has been modified since the original version
"BLD",5317,1,11,0)
to indicate Active and Inactive APIs. If the API(s) you need have an
"BLD",5317,1,12,0)
Inactive status, please contact the Pharmacy Re-Engineering team at the
"BLD",5317,1,13,0)
Birmingham Field Office.
"BLD",5317,4,0)
^9.64PA^^
"BLD",5317,"ABPKG")
n
"BLD",5317,"KRN",0)
^9.67PA^8989.52^19
"BLD",5317,"KRN",.4,0)
.4
"BLD",5317,"KRN",.401,0)
.401
"BLD",5317,"KRN",.402,0)
.402
"BLD",5317,"KRN",.403,0)
.403
"BLD",5317,"KRN",.5,0)
.5
"BLD",5317,"KRN",.84,0)
.84
"BLD",5317,"KRN",3.6,0)
3.6
"BLD",5317,"KRN",3.8,0)
3.8
"BLD",5317,"KRN",9.2,0)
9.2
"BLD",5317,"KRN",9.8,0)
9.8
"BLD",5317,"KRN",9.8,"NM",0)
^9.68A^9^9
"BLD",5317,"KRN",9.8,"NM",1,0)
PSS50A^^0^B28870400
"BLD",5317,"KRN",9.8,"NM",2,0)
PSS50AQM^^0^B55039577
"BLD",5317,"KRN",9.8,"NM",3,0)
PSS50F^^0^B45358311
"BLD",5317,"KRN",9.8,"NM",4,0)
PSS50P7^^0^B42625601
"BLD",5317,"KRN",9.8,"NM",5,0)
PSS51P1A^^0^B44739215
"BLD",5317,"KRN",9.8,"NM",6,0)
PSS51P1B^^0^B43057007
"BLD",5317,"KRN",9.8,"NM",7,0)
PSSDI^^0^B14252092
"BLD",5317,"KRN",9.8,"NM",8,0)
PSS51P1^^0^B16199904
"BLD",5317,"KRN",9.8,"NM",9,0)
PSS52P7A^^0^B7958767
"BLD",5317,"KRN",9.8,"NM","B","PSS50A",1)

"BLD",5317,"KRN",9.8,"NM","B","PSS50AQM",2)

"BLD",5317,"KRN",9.8,"NM","B","PSS50F",3)

"BLD",5317,"KRN",9.8,"NM","B","PSS50P7",4)

"BLD",5317,"KRN",9.8,"NM","B","PSS51P1",8)

"BLD",5317,"KRN",9.8,"NM","B","PSS51P1A",5)

"BLD",5317,"KRN",9.8,"NM","B","PSS51P1B",6)

"BLD",5317,"KRN",9.8,"NM","B","PSS52P7A",9)

"BLD",5317,"KRN",9.8,"NM","B","PSSDI",7)

"BLD",5317,"KRN",19,0)
19
"BLD",5317,"KRN",19.1,0)
19.1
"BLD",5317,"KRN",101,0)
101
"BLD",5317,"KRN",409.61,0)
409.61
"BLD",5317,"KRN",771,0)
771
"BLD",5317,"KRN",870,0)
870
"BLD",5317,"KRN",8989.51,0)
8989.51
"BLD",5317,"KRN",8989.52,0)
8989.52
"BLD",5317,"KRN",8994,0)
8994
"BLD",5317,"KRN","B",.4,.4)

"BLD",5317,"KRN","B",.401,.401)

"BLD",5317,"KRN","B",.402,.402)

"BLD",5317,"KRN","B",.403,.403)

"BLD",5317,"KRN","B",.5,.5)

"BLD",5317,"KRN","B",.84,.84)

"BLD",5317,"KRN","B",3.6,3.6)

"BLD",5317,"KRN","B",3.8,3.8)

"BLD",5317,"KRN","B",9.2,9.2)

"BLD",5317,"KRN","B",9.8,9.8)

"BLD",5317,"KRN","B",19,19)

"BLD",5317,"KRN","B",19.1,19.1)

"BLD",5317,"KRN","B",101,101)

"BLD",5317,"KRN","B",409.61,409.61)

"BLD",5317,"KRN","B",771,771)

"BLD",5317,"KRN","B",870,870)

"BLD",5317,"KRN","B",8989.51,8989.51)

"BLD",5317,"KRN","B",8989.52,8989.52)

"BLD",5317,"KRN","B",8994,8994)

"BLD",5317,"QUES",0)
^9.62^^
"BLD",5317,"REQB",0)
^9.611^1^1
"BLD",5317,"REQB",1,0)
PSS*1.0*85^2
"BLD",5317,"REQB","B","PSS*1.0*85",1)

"MBREQ")
0
"PKG",517,-1)
1^1
"PKG",517,0)
PHARMACY DATA MANAGEMENT^PSS^Maintenance of Pharmacy files.
"PKG",517,20,0)
^9.402P^^
"PKG",517,22,0)
^9.49I^1^1
"PKG",517,22,1,0)
1.0^2970930^2971014^11595
"PKG",517,22,1,"PAH",1,0)
91^3041123
"PKG",517,22,1,"PAH",1,1,0)
^^13^13^3041123
"PKG",517,22,1,"PAH",1,1,1,0)
This patch contains updated Application Program Interfaces (APIs) that 
"PKG",517,22,1,"PAH",1,1,2,0)
will be used by calling applications that currently do direct global 
"PKG",517,22,1,"PAH",1,1,3,0)
reads or writes to the Pharmacy Data Management files.  A review of the 
"PKG",517,22,1,"PAH",1,1,4,0)
previously released APIs showed several entry points where additional 
"PKG",517,22,1,"PAH",1,1,5,0)
pieces of data were required to be returned.
"PKG",517,22,1,"PAH",1,1,6,0)
 
"PKG",517,22,1,"PAH",1,1,7,0)
If you have already made code modifications, or have made plans to make
"PKG",517,22,1,"PAH",1,1,8,0)
code modifications to use any of the new APIs, please check the latest
"PKG",517,22,1,"PAH",1,1,9,0)
version of the API manual to verify that the API(s) in question have an
"PKG",517,22,1,"PAH",1,1,10,0)
Active status. The API manual has been modified since the original version
"PKG",517,22,1,"PAH",1,1,11,0)
to indicate Active and Inactive APIs. If the API(s) you need have an
"PKG",517,22,1,"PAH",1,1,12,0)
Inactive status, please contact the Pharmacy Re-Engineering team at the
"PKG",517,22,1,"PAH",1,1,13,0)
Birmingham Field Office.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","PSS50A")
0^1^B28870400
"RTN","PSS50A",1,0)
PSS50A ;BIR/LDT - CONTINUATION OF API FOR INFORMATION FROM FILE 50; 5 Sep 03
"RTN","PSS50A",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91**;9/30/97
"RTN","PSS50A",3,0)
 ;External reference to PS(50.605 supported by DBIA 2138
"RTN","PSS50A",4,0)
 ;
"RTN","PSS50A",5,0)
SETSCRN ;Set Screen for inactive Drugs
"RTN","PSS50A",6,0)
 ;Naked reference below refers to ^PSDRUG(+Y,"I")
"RTN","PSS50A",7,0)
 I +$G(PSSFL)>0 S SCR("S")="S PSS5ND=$P($G(^(""I"")),""^"") I PSS5ND=""""!(PSS5ND>PSSFL)"
"RTN","PSS50A",8,0)
 I $G(PSSRTOI)=1 D
"RTN","PSS50A",9,0)
 .;Naked reference below refers to ^PSDRUG(+Y,2)
"RTN","PSS50A",10,0)
 .I SCR("S")]"" S SCR("S")=SCR("S")_" I $P($G(^(2)),""^"")" Q
"RTN","PSS50A",11,0)
 .;Naked reference below refers to ^PSDRUG(+Y,2)
"RTN","PSS50A",12,0)
 .S SCR("S")="I $P($G(^(2)),""^"")"
"RTN","PSS50A",13,0)
 I $G(PSSPK)]"" D
"RTN","PSS50A",14,0)
 .;Naked reference below refers to ^PSDRUG(+Y,2)
"RTN","PSS50A",15,0)
 .I SCR("S")]"" S SCR("S")=SCR("S")_" S PSSZ3=0 F PSSZ4=1:1:$L(PSSPK) Q:PSSZ3  I $P($G(^(2)),""^"",3)[$E(PSSPK,PSSZ4) S PSSZ3=1" Q
"RTN","PSS50A",16,0)
 .;Naked reference below refers to ^PSDRUG(+Y,2)
"RTN","PSS50A",17,0)
 .S SCR("S")="S PSSZ3=0 F PSSZ4=1:1:$L(PSSPK) Q:PSSZ3  I $P($G(^(2)),""^"",3)[$E(PSSPK,PSSZ4) S PSSZ3=1"
"RTN","PSS50A",18,0)
 ;I $G(PSSPK)]"" S SCR("S")=$S(SCR("S")]"":SCR("S")_" I $G(^PSDRUG(+Y,2)),$P($G(^PSDRUG(+Y,2)),""^"",3)[PSSPK",1:"I $G(^PSDRUG(+Y,2)),$P($G(^PSDRUG(+Y,2)),""^"",3)[PSSPK")
"RTN","PSS50A",19,0)
 Q
"RTN","PSS50A",20,0)
 ;
"RTN","PSS50A",21,0)
SETALL ;
"RTN","PSS50A",22,0)
 S ^TMP($J,LIST,+PSS(1),.01)=$G(^TMP("PSSP50",$J,50,PSS(1),.01,"I"))
"RTN","PSS50A",23,0)
 S ^TMP($J,LIST,"B",$G(^TMP("PSSP50",$J,50,PSS(1),.01,"I")),+PSS(1))=""
"RTN","PSS50A",24,0)
 S ^TMP($J,LIST,+PSS(1),2)=$G(^TMP("PSSP50",$J,50,PSS(1),2,"I"))
"RTN","PSS50A",25,0)
 S ^TMP($J,LIST,+PSS(1),2.1)=$S($G(^TMP("PSSP50",$J,50,PSS(1),2.1,"I"))="":"",1:$G(^TMP("PSSP50",$J,50,PSS(1),2.1,"I"))_"^"_$G(^TMP("PSSP50",$J,50,PSS(1),2.1,"E")))
"RTN","PSS50A",26,0)
 I $P($G(^TMP($J,LIST,+PSS(1),2.1)),"^") D
"RTN","PSS50A",27,0)
 .N PSSADDF S PSSADDF=$$SETDF^PSS50AQM($P(^TMP($J,LIST,+PSS(1),2.1),"^")) S ^TMP($J,LIST,+PSS(1),2.1)=^TMP($J,LIST,+PSS(1),2.1)_$S($P($G(PSSADDF),"^")>0:"^"_$P($G(PSSADDF),"^",3)_"^"_$P($G(PSSADDF),"^",4),1:"")
"RTN","PSS50A",28,0)
 S ^TMP($J,LIST,+PSS(1),3)=$G(^TMP("PSSP50",$J,50,PSS(1),3,"I"))
"RTN","PSS50A",29,0)
 S ^TMP($J,LIST,+PSS(1),4)=$G(^TMP("PSSP50",$J,50,PSS(1),4,"I"))
"RTN","PSS50A",30,0)
 S ^TMP($J,LIST,+PSS(1),5)=$G(^TMP("PSSP50",$J,50,PSS(1),5,"I"))
"RTN","PSS50A",31,0)
 S ^TMP($J,LIST,+PSS(1),6)=$G(^TMP("PSSP50",$J,50,PSS(1),6,"I"))
"RTN","PSS50A",32,0)
 S ^TMP($J,LIST,+PSS(1),8)=$G(^TMP("PSSP50",$J,50,PSS(1),8,"I"))
"RTN","PSS50A",33,0)
 N PSSUTN S PSSUTN=$G(^TMP("PSSP50",$J,50,PSS(1),12,"I"))
"RTN","PSS50A",34,0)
 S ^TMP($J,LIST,+PSS(1),12)=$S($G(PSSUTN)="":"",1:$G(^TMP("PSSP50",$J,50,PSS(1),12,"I"))_"^"_$G(^TMP("PSSP50",$J,50,PSS(1),12,"E")))
"RTN","PSS50A",35,0)
 I PSSUTN'="" S ^TMP($J,LIST,+PSS(1),12)=^TMP($J,LIST,+PSS(1),12)_"^"_$P($G(^DIC(51.5,PSSUTN,0)),"^",2)
"RTN","PSS50A",36,0)
 S ^TMP($J,LIST,+PSS(1),13)=$G(^TMP("PSSP50",$J,50,PSS(1),13,"I"))
"RTN","PSS50A",37,0)
 S ^TMP($J,LIST,+PSS(1),14.5)=$G(^TMP("PSSP50",$J,50,PSS(1),14.5,"I"))
"RTN","PSS50A",38,0)
 S ^TMP($J,LIST,+PSS(1),15)=$G(^TMP("PSSP50",$J,50,PSS(1),15,"I"))
"RTN","PSS50A",39,0)
 S ^TMP($J,LIST,+PSS(1),16)=$G(^TMP("PSSP50",$J,50,PSS(1),16,"I"))
"RTN","PSS50A",40,0)
 S ^TMP($J,LIST,+PSS(1),20)=$S($G(^TMP("PSSP50",$J,50,PSS(1),20,"I"))="":"",1:$G(^TMP("PSSP50",$J,50,PSS(1),20,"I"))_"^"_$G(^TMP("PSSP50",$J,50,PSS(1),20,"E")))
"RTN","PSS50A",41,0)
 S ^TMP($J,LIST,+PSS(1),21)=$G(^TMP("PSSP50",$J,50,PSS(1),21,"I"))
"RTN","PSS50A",42,0)
 S ^TMP($J,LIST,+PSS(1),22)=$S($G(^TMP("PSSP50",$J,50,PSS(1),22,"I"))="":"",1:$G(^TMP("PSSP50",$J,50,PSS(1),22,"I"))_"^"_$G(^TMP("PSSP50",$J,50,PSS(1),22,"E")))
"RTN","PSS50A",43,0)
 S ^TMP($J,LIST,+PSS(1),25)=$S($G(^TMP("PSSP50",$J,50,PSS(1),25,"I"))="":"",1:$G(^TMP("PSSP50",$J,50,PSS(1),25,"I"))_"^"_$G(^TMP("PSSP50",$J,50,PSS(1),25,"E"))_"^"_$P($G(^PS(50.605,+^TMP("PSSP50",$J,50,PSS(1),25,"I"),0)),"^",2))
"RTN","PSS50A",44,0)
 S ^TMP($J,LIST,+PSS(1),27)=$G(^TMP("PSSP50",$J,50,PSS(1),27,"I"))
"RTN","PSS50A",45,0)
 S ^TMP($J,LIST,+PSS(1),31)=$G(^TMP("PSSP50",$J,50,PSS(1),31,"I"))
"RTN","PSS50A",46,0)
 S ^TMP($J,LIST,+PSS(1),40)=$G(^TMP("PSSP50",$J,50,PSS(1),40,"I"))
"RTN","PSS50A",47,0)
 S ^TMP($J,LIST,+PSS(1),51)=$S($G(^TMP("PSSP50",$J,50,PSS(1),51,"I"))="":"",1:$G(^TMP("PSSP50",$J,50,PSS(1),51,"I"))_"^"_$G(^TMP("PSSP50",$J,50,PSS(1),51,"E")))
"RTN","PSS50A",48,0)
 S ^TMP($J,LIST,+PSS(1),52)=$S($G(^TMP("PSSP50",$J,50,PSS(1),52,"I"))="":"",1:$G(^TMP("PSSP50",$J,50,PSS(1),52,"I"))_"^"_$G(^TMP("PSSP50",$J,50,PSS(1),52,"E")))
"RTN","PSS50A",49,0)
 S ^TMP($J,LIST,+PSS(1),63)=$G(^TMP("PSSP50",$J,50,PSS(1),63,"I"))
"RTN","PSS50A",50,0)
 S ^TMP($J,LIST,+PSS(1),64)=$S('$P($G(^TMP("PSSP50",$J,50,PSS(1),64,"I")),"^"):"",1:$P($G(^TMP("PSSP50",$J,50,PSS(1),64,"I")),"^")_"^"_$P($G(^TMP("PSSP50",$J,50,PSS(1),64,"E")),"^"))
"RTN","PSS50A",51,0)
 S ^TMP($J,LIST,+PSS(1),100)=$S($G(^TMP("PSSP50",$J,50,PSS(1),100,"I"))="":"",1:$G(^TMP("PSSP50",$J,50,PSS(1),100,"I"))_"^"_$G(^TMP("PSSP50",$J,50,PSS(1),100,"E")))
"RTN","PSS50A",52,0)
 S ^TMP($J,LIST,+PSS(1),101)=$G(^TMP("PSSP50",$J,50,PSS(1),101,"I"))
"RTN","PSS50A",53,0)
 S ^TMP($J,LIST,+PSS(1),102)=$G(^TMP("PSSP50",$J,50,PSS(1),102,"I"))
"RTN","PSS50A",54,0)
 S ^TMP($J,LIST,+PSS(1),301)=$S($G(^TMP("PSSP50",$J,50,PSS(1),301,"I"))="":"",1:$G(^TMP("PSSP50",$J,50,PSS(1),301,"I"))_"^"_$G(^TMP("PSSP50",$J,50,PSS(1),301,"E")))
"RTN","PSS50A",55,0)
 S ^TMP($J,LIST,+PSS(1),302)=$G(^TMP("PSSP50",$J,50,PSS(1),302,"I"))
"RTN","PSS50A",56,0)
 Q
"RTN","PSS50A",57,0)
 ;
"RTN","PSS50A",58,0)
SETSYN ;
"RTN","PSS50A",59,0)
 S ^TMP($J,LIST,+PSS(1),"SYN",+PSS(2),.01)=$G(^TMP("PSSP50",$J,50.1,PSS(2),.01,"I"))
"RTN","PSS50A",60,0)
 S ^TMP($J,LIST,+PSS(1),"SYN",+PSS(2),1)=$S($G(^TMP("PSSP50",$J,50.1,PSS(2),1,"I"))="":"",1:^TMP("PSSP50",$J,50.1,PSS(2),1,"I")_"^"_^TMP("PSSP50",$J,50.1,PSS(2),1,"E"))
"RTN","PSS50A",61,0)
 S ^TMP($J,LIST,+PSS(1),"SYN",+PSS(2),2)=$G(^TMP("PSSP50",$J,50.1,PSS(2),2,"I"))
"RTN","PSS50A",62,0)
 S ^TMP($J,LIST,+PSS(1),"SYN",+PSS(2),403)=$G(^TMP("PSSP50",$J,50.1,PSS(2),403,"I"))
"RTN","PSS50A",63,0)
 Q
"RTN","PSS50A",64,0)
 ;
"RTN","PSS50A",65,0)
SETFMA ;
"RTN","PSS50A",66,0)
 S ^TMP($J,LIST,+PSS(1),"FRM",+PSS(2),.01)=$S($G(^TMP("PSSP50",$J,50.065,PSS(2),.01,"I"))="":"",1:^TMP("PSSP50",$J,50.065,PSS(2),.01,"I")_"^"_^TMP("PSSP50",$J,50.065,PSS(2),.01,"E"))
"RTN","PSS50A",67,0)
 Q
"RTN","PSS50A",68,0)
 ;
"RTN","PSS50A",69,0)
SETOLD ;
"RTN","PSS50A",70,0)
 S ^TMP($J,LIST,+PSS(1),"OLD",+PSS(2),.01)=$G(^TMP("PSSP50",$J,50.01,PSS(2),.01,"I"))
"RTN","PSS50A",71,0)
 S ^TMP($J,LIST,+PSS(1),"OLD",+PSS(2),.02)=$S($G(^TMP("PSSP50",$J,50.01,PSS(2),.02,"I"))="":"",1:^TMP("PSSP50",$J,50.01,PSS(2),.02,"I")_"^"_^TMP("PSSP50",$J,50.01,PSS(2),.02,"E"))
"RTN","PSS50A",72,0)
 Q
"RTN","PSS50AQM")
0^2^B55039577
"RTN","PSS50AQM",1,0)
PSS50AQM ;BIR/LDT - CONTINUATION OF API FOR INFORMATION FROM FILE 50; 5 Sep 03
"RTN","PSS50AQM",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91**;9/30/97
"RTN","PSS50AQM",3,0)
 ;External reference to PS(50.3 supported by DBIA 2127
"RTN","PSS50AQM",4,0)
 ;External reference to PS(50.605 supported by DBIA 2138
"RTN","PSS50AQM",5,0)
 ;External reference to PSNDF(50.6 supported by DBIA 2079
"RTN","PSS50AQM",6,0)
 ;External reference to PSNDF(50.68 supported by DBIA 3735
"RTN","PSS50AQM",7,0)
 ;
"RTN","PSS50AQM",8,0)
SETALL ;
"RTN","PSS50AQM",9,0)
 N PSSZNODE,PSS660,PSSNDNOD,PSS2NODE,PSSG2NOD S PSSZNODE=$G(^PSDRUG(PSS(1),0)),PSS2NODE=$G(^(2)),PSS660=$G(^(660)),PSSG2NOD=$G(^("PSG")),PSSNDNOD=$G(^("ND"))
"RTN","PSS50AQM",10,0)
 S ^TMP($J,LIST,+PSS(1),.01)=$P(PSSZNODE,"^")
"RTN","PSS50AQM",11,0)
 S ^TMP($J,LIST,"B",$P(PSSZNODE,"^"),+PSS(1))=""
"RTN","PSS50AQM",12,0)
 S ^TMP($J,LIST,+PSS(1),2)=$P(PSSZNODE,"^",2)
"RTN","PSS50AQM",13,0)
 S ^TMP($J,LIST,+PSS(1),2.1)=$S('$P(PSS2NODE,"^"):"",1:$P(PSS2NODE,"^")_"^"_$P($G(^PS(50.7,+$P(PSS2NODE,"^"),0)),"^"))
"RTN","PSS50AQM",14,0)
 N PSSADDF S PSSADDF=$P($G(^PS(50.7,+$P($G(^TMP($J,LIST,+PSS(1),2.1)),"^"),0)),"^",2) I PSSADDF>0 D
"RTN","PSS50AQM",15,0)
 .S ^TMP($J,LIST,+PSS(1),2.1)=^TMP($J,LIST,+PSS(1),2.1)_"^"_PSSADDF_"^"_$P($G(^PS(50.606,PSSADDF,0)),"^")
"RTN","PSS50AQM",16,0)
 S ^TMP($J,LIST,+PSS(1),3)=$P(PSSZNODE,"^",3)
"RTN","PSS50AQM",17,0)
 S ^TMP($J,LIST,+PSS(1),4)=$P(PSSZNODE,"^",4)
"RTN","PSS50AQM",18,0)
 S ^TMP($J,LIST,+PSS(1),5)=$P(PSSZNODE,"^",5)
"RTN","PSS50AQM",19,0)
 S ^TMP($J,LIST,+PSS(1),6)=$P(PSSZNODE,"^",6)
"RTN","PSS50AQM",20,0)
 S ^TMP($J,LIST,+PSS(1),8)=$P(PSSZNODE,"^",8)
"RTN","PSS50AQM",21,0)
 S ^TMP($J,LIST,+PSS(1),12)=$S($P(PSS660,"^",2):$P(PSS660,"^",2)_"^"_$P($G(^DIC(51.5,+$P(PSS660,"^",2),0)),"^")_"^"_$P($G(^(0)),"^",2),1:"")
"RTN","PSS50AQM",22,0)
 S ^TMP($J,LIST,+PSS(1),13)=$P(PSS660,"^",3)
"RTN","PSS50AQM",23,0)
 S ^TMP($J,LIST,+PSS(1),14.5)=$P(PSS660,"^",8)
"RTN","PSS50AQM",24,0)
 S ^TMP($J,LIST,+PSS(1),15)=$P(PSS660,"^",5)
"RTN","PSS50AQM",25,0)
 S ^TMP($J,LIST,+PSS(1),16)=$P(PSS660,"^",6)
"RTN","PSS50AQM",26,0)
 S ^TMP($J,LIST,+PSS(1),20)=$S($P(PSSNDNOD,"^"):$P(PSSNDNOD,"^")_"^"_$P($G(^PSNDF(50.6,+$P(PSSNDNOD,"^"),0)),"^"),1:"")
"RTN","PSS50AQM",27,0)
 S ^TMP($J,LIST,+PSS(1),21)=$P(PSSNDNOD,"^",2)
"RTN","PSS50AQM",28,0)
 S ^TMP($J,LIST,+PSS(1),22)=$S($P(PSSNDNOD,"^",3):$P(PSSNDNOD,"^",3)_"^"_$P($G(^PSNDF(50.68,+$P(PSSNDNOD,"^",3),0)),"^"),1:"")
"RTN","PSS50AQM",29,0)
 S ^TMP($J,LIST,+PSS(1),25)=$S($P(PSSNDNOD,"^",6):$P(PSSNDNOD,"^",6)_"^"_$P($G(^PS(50.605,+$P(PSSNDNOD,"^",6),0)),"^")_"^"_$P($G(^(0)),"^",2),1:"")
"RTN","PSS50AQM",30,0)
 S ^TMP($J,LIST,+PSS(1),27)=$P(PSSNDNOD,"^",10)
"RTN","PSS50AQM",31,0)
 S ^TMP($J,LIST,+PSS(1),31)=$P(PSS2NODE,"^",4)
"RTN","PSS50AQM",32,0)
 S ^TMP($J,LIST,+PSS(1),40)=$P($G(^PSDRUG(PSS(1),"PSO")),"^")
"RTN","PSS50AQM",33,0)
 N PSS51NF S PSS51NF=$P(PSSZNODE,"^",9)  D
"RTN","PSS50AQM",34,0)
 .I PSS51NF'="",PSS51NFD'="",PSS51NFD[(PSS51NF_":") S ^TMP($J,LIST,+PSS(1),51)=PSS51NF_"^"_$P($E(PSS51NFD,$F(PSS51NFD,(PSS51NF_":")),999),";") Q
"RTN","PSS50AQM",35,0)
 .S ^TMP($J,LIST,+PSS(1),51)=""
"RTN","PSS50AQM",36,0)
 N PSS52NF S PSS52NF=$P(PSSZNODE,"^",11)  D
"RTN","PSS50AQM",37,0)
 .I PSS52NF'="",PSS52NFD'="",PSS52NFD[(PSS52NF_":") S ^TMP($J,LIST,+PSS(1),52)=PSS52NF_"^"_$P($E(PSS52NFD,$F(PSS52NFD,(PSS52NF_":")),999),";") Q
"RTN","PSS50AQM",38,0)
 .S ^TMP($J,LIST,+PSS(1),52)=""
"RTN","PSS50AQM",39,0)
 S ^TMP($J,LIST,+PSS(1),63)=$P(PSS2NODE,"^",3)
"RTN","PSS50AQM",40,0)
 S ^TMP($J,LIST,+PSS(1),64)=$S($P(PSS2NODE,"^",6):$P(PSS2NODE,"^",6)_"^"_$P($G(^PS(50.3,+$P(PSS2NODE,"^",6),0)),"^"),1:"")
"RTN","PSS50AQM",41,0)
 N Y S Y=$P($G(^PSDRUG(PSS(1),"I")),"^") D
"RTN","PSS50AQM",42,0)
 .I Y S ^TMP($J,LIST,+PSS(1),100)=$G(Y) X ^DD("DD") S ^TMP($J,LIST,+PSS(1),100)=^TMP($J,LIST,+PSS(1),100)_"^"_$G(Y) Q
"RTN","PSS50AQM",43,0)
 .S ^TMP($J,LIST,+PSS(1),100)=""
"RTN","PSS50AQM",44,0)
 S ^TMP($J,LIST,+PSS(1),101)=$P(PSSZNODE,"^",10)
"RTN","PSS50AQM",45,0)
 S ^TMP($J,LIST,+PSS(1),102)=$P(PSS2NODE,"^",2)
"RTN","PSS50AQM",46,0)
 N PSSG2 S PSSG2=$P(PSSG2NOD,"^",2)  D
"RTN","PSS50AQM",47,0)
 .I PSSG2'="",PSSG2N'="",PSSG2N[(PSSG2_":") S ^TMP($J,LIST,+PSS(1),301)=PSSG2_"^"_$P($E(PSSG2N,$F(PSSG2N,(PSSG2_":")),999),";") Q
"RTN","PSS50AQM",48,0)
 .S ^TMP($J,LIST,+PSS(1),301)=""
"RTN","PSS50AQM",49,0)
 S ^TMP($J,LIST,+PSS(1),302)=$P(PSSG2NOD,"^",3)
"RTN","PSS50AQM",50,0)
 Q
"RTN","PSS50AQM",51,0)
 ;
"RTN","PSS50AQM",52,0)
 ;
"RTN","PSS50AQM",53,0)
SETSYN ;
"RTN","PSS50AQM",54,0)
 N PSS501C S PSS501C=0
"RTN","PSS50AQM",55,0)
 I $O(^PSDRUG(PSS(1),1,0)) N PSS501,PSS501ND  D
"RTN","PSS50AQM",56,0)
 .F PSS501=0:0 S PSS501=$O(^PSDRUG(PSS(1),1,PSS501)) Q:'PSS501  D
"RTN","PSS50AQM",57,0)
 ..S PSS501ND=$G(^PSDRUG(PSS(1),1,PSS501,0)) I $P(PSS501ND,"^")'="" S PSS501C=PSS501C+1 D
"RTN","PSS50AQM",58,0)
 ...S ^TMP($J,LIST,+PSS(1),"SYN",PSS501,.01)=$P(PSS501ND,"^")
"RTN","PSS50AQM",59,0)
 ...N PSS501NN S PSS501NN=$P(PSS501ND,"^",3)  D
"RTN","PSS50AQM",60,0)
 ....I PSS501NN'="",PSS501NX'="",PSS501NX[(PSS501NN_":") S ^TMP($J,LIST,+PSS(1),"SYN",PSS501,1)=PSS501NN_"^"_$P($E(PSS501NX,$F(PSS501NX,(PSS501NN_":")),999),";") Q
"RTN","PSS50AQM",61,0)
 ....S ^TMP($J,LIST,+PSS(1),"SYN",PSS501,1)=""
"RTN","PSS50AQM",62,0)
 ...S ^TMP($J,LIST,+PSS(1),"SYN",PSS501,2)=$P(PSS501ND,"^",2)
"RTN","PSS50AQM",63,0)
 ...S ^TMP($J,LIST,+PSS(1),"SYN",PSS501,403)=$P(PSS501ND,"^",7)
"RTN","PSS50AQM",64,0)
 S ^TMP($J,LIST,+PSS(1),"SYN",0)=$S(PSS501C:PSS501C,1:"-1^NO DATA FOUND")
"RTN","PSS50AQM",65,0)
 Q
"RTN","PSS50AQM",66,0)
 ;
"RTN","PSS50AQM",67,0)
SETFMA ;
"RTN","PSS50AQM",68,0)
 N PSS65C S PSS65C=0
"RTN","PSS50AQM",69,0)
 I $O(^PSDRUG(PSS(1),65,0)) N PSS65,PSS65ND D
"RTN","PSS50AQM",70,0)
 .F PSS65=0:0 S PSS65=$O(^PSDRUG(PSS(1),65,PSS65)) Q:'PSS65  D
"RTN","PSS50AQM",71,0)
 ..S PSS65ND=$G(^PSDRUG(PSS(1),65,PSS65,0)) I $P(PSS65ND,"^") S PSS65C=PSS65C+1 D
"RTN","PSS50AQM",72,0)
 ...S ^TMP($J,LIST,+PSS(1),"FRM",PSS65,.01)=$P(PSS65ND,"^")_"^"_$P($G(^PSDRUG(+$P(PSS65ND,"^"),0)),"^")
"RTN","PSS50AQM",73,0)
 S ^TMP($J,LIST,+PSS(1),"FRM",0)=$S(PSS65C:PSS65C,1:"-1^NO DATA FOUND")
"RTN","PSS50AQM",74,0)
 Q
"RTN","PSS50AQM",75,0)
 ;
"RTN","PSS50AQM",76,0)
SETOLD ;
"RTN","PSS50AQM",77,0)
 N PSS900C S PSS900C=0
"RTN","PSS50AQM",78,0)
 I $O(^PSDRUG(PSS(1),900,0)) N PSS900,PSS900ND D
"RTN","PSS50AQM",79,0)
 .F PSS900=0:0 S PSS900=$O(^PSDRUG(PSS(1),900,PSS900)) Q:'PSS900  D
"RTN","PSS50AQM",80,0)
 ..S PSS900ND=$G(^PSDRUG(PSS(1),900,PSS900,0)) I $P(PSS900ND,"^")'="" S PSS900C=PSS900C+1 D
"RTN","PSS50AQM",81,0)
 ...S ^TMP($J,LIST,+PSS(1),"OLD",PSS900,.01)=$P(PSS900ND,"^")
"RTN","PSS50AQM",82,0)
 ...N Y S Y=$P(PSS900ND,"^",2) I Y S ^TMP($J,LIST,+PSS(1),"OLD",PSS900,.02)=$G(Y) X ^DD("DD") S ^TMP($J,LIST,+PSS(1),"OLD",PSS900,.02)=^TMP($J,LIST,+PSS(1),"OLD",PSS900,.02)_"^"_$G(Y)
"RTN","PSS50AQM",83,0)
 S ^TMP($J,LIST,+PSS(1),"OLD",0)=$S(PSS900C:PSS900C,1:"-1^NO DATA FOUND")
"RTN","PSS50AQM",84,0)
 Q
"RTN","PSS50AQM",85,0)
SETSUB1(PSST1) ;Set sub-header nodes if there is data, and sub-header nodes do not exist
"RTN","PSS50AQM",86,0)
 N PSST2,PSST3,PSST4
"RTN","PSS50AQM",87,0)
 I $G(^PSDRUG(PSST1,1,0))="",$O(^PSDRUG(PSST1,1,0)) D
"RTN","PSS50AQM",88,0)
 .S (PSST4,PSST3)=0 F PSST2=0:0 S PSST2=$O(^PSDRUG(PSST1,1,PSST2)) Q:'PSST2  I $D(^PSDRUG(PSST1,1,PSST2,0)) S PSST3=PSST2,PSST4=PSST4+1
"RTN","PSS50AQM",89,0)
 .I PSST4 S ^PSDRUG(PSST1,1,0)="^50.1A^"_PSST3_"^"_PSST4
"RTN","PSS50AQM",90,0)
 Q
"RTN","PSS50AQM",91,0)
SETSUB2(PSST1) ;
"RTN","PSS50AQM",92,0)
 N PSST2,PSST3,PSST4
"RTN","PSS50AQM",93,0)
 I $G(^PSDRUG(PSST1,65,0))="",$O(^PSDRUG(PSST1,65,0)) D
"RTN","PSS50AQM",94,0)
 .S (PSST4,PSST3)=0 F PSST2=0:0 S PSST2=$O(^PSDRUG(PSST1,65,PSST2)) Q:'PSST2  I $D(^PSDRUG(PSST1,65,PSST2,0)) S PSST3=PSST2,PSST4=PSST4+1
"RTN","PSS50AQM",95,0)
 .I PSST4 S ^PSDRUG(PSST1,65,0)="^50.065P^"_PSST3_"^"_PSST4
"RTN","PSS50AQM",96,0)
 Q
"RTN","PSS50AQM",97,0)
SETSUB3(PSST1) ;
"RTN","PSS50AQM",98,0)
 N PSST2,PSST3,PSST4
"RTN","PSS50AQM",99,0)
 I $G(^PSDRUG(PSST1,900,0))="",$O(^PSDRUG(PSST1,900,0)) D
"RTN","PSS50AQM",100,0)
 .S (PSST4,PSST3)=0 F PSST2=0:0 S PSST2=$O(^PSDRUG(PSST1,900,PSST2)) Q:'PSST2  I $D(^PSDRUG(PSST1,900,PSST2,0)) S PSST3=PSST2,PSST4=PSST4+1
"RTN","PSS50AQM",101,0)
 .I PSST4 S ^PSDRUG(PSST1,900,0)="^50.01A^"_PSST3_"^"_PSST4
"RTN","PSS50AQM",102,0)
 Q
"RTN","PSS50AQM",103,0)
SETSUB4(PSST1) ;
"RTN","PSS50AQM",104,0)
 N PSST2,PSST3,PSST4
"RTN","PSS50AQM",105,0)
 I $G(^PSDRUG(PSST1,441,0))="",$O(^PSDRUG(PSST1,441,0)) D
"RTN","PSS50AQM",106,0)
 .S (PSST4,PSST3)=0 F PSST2=0:0 S PSST2=$O(^PSDRUG(PSST1,441,PSST2)) Q:'PSST2  I $D(^PSDRUG(PSST1,441,PSST2,0)) S PSST3=PSST2,PSST4=PSST4+1
"RTN","PSS50AQM",107,0)
 .I PSST4 S ^PSDRUG(PSST1,441,0)="^50.0441P^"_PSST3_"^"_PSST4
"RTN","PSS50AQM",108,0)
 Q
"RTN","PSS50AQM",109,0)
SETSUB5(PSST1) ;
"RTN","PSS50AQM",110,0)
 N PSST2,PSST3,PSST4
"RTN","PSS50AQM",111,0)
 I $G(^PSDRUG(PSST1,4,0))="",$O(^PSDRUG(PSST1,4,0)) D
"RTN","PSS50AQM",112,0)
 .S (PSST4,PSST3)=0 F PSST2=0:0 S PSST2=$O(^PSDRUG(PSST1,4,PSST2)) Q:'PSST2  I $D(^PSDRUG(PSST1,4,PSST2,0)) S PSST3=PSST2,PSST4=PSST4+1
"RTN","PSS50AQM",113,0)
 .I PSST4 S ^PSDRUG(PSST1,4,0)="^50.0214DA^"_PSST3_"^"_PSST4
"RTN","PSS50AQM",114,0)
 Q
"RTN","PSS50AQM",115,0)
SETSUB6(PSST1) ;
"RTN","PSS50AQM",116,0)
 N PSST2,PSST3,PSST4
"RTN","PSS50AQM",117,0)
 I $G(^PSDRUG(PSST1,"CLOZ2",0))="",$O(^PSDRUG(PSST1,"CLOZ2",0)) D
"RTN","PSS50AQM",118,0)
 .S (PSST4,PSST3)=0 F PSST2=0:0 S PSST2=$O(^PSDRUG(PSST1,"CLOZ2",PSST2)) Q:'PSST2  I $D(^PSDRUG(PSST1,"CLOZ2",PSST2,0)) S PSST3=PSST2,PSST4=PSST4+1
"RTN","PSS50AQM",119,0)
 .I PSST4 S ^PSDRUG(PSST1,"CLOZ2",0)="^50.02P^"_PSST3_"^"_PSST4
"RTN","PSS50AQM",120,0)
 Q
"RTN","PSS50AQM",121,0)
SETSUB7(PSST1) ;
"RTN","PSS50AQM",122,0)
 N PSST2,PSST3,PSST4
"RTN","PSS50AQM",123,0)
 I $G(^PSDRUG(PSST1,"DOS1",0))="",$O(^PSDRUG(PSST1,"DOS1",0)) D
"RTN","PSS50AQM",124,0)
 .S (PSST4,PSST3)=0 F PSST2=0:0 S PSST2=$O(^PSDRUG(PSST1,"DOS1",PSST2)) Q:'PSST2  I $D(^PSDRUG(PSST1,"DOS1",PSST2,0)) S PSST3=PSST2,PSST4=PSST4+1
"RTN","PSS50AQM",125,0)
 .I PSST4 S ^PSDRUG(PSST1,"DOS1",0)="^50.0903^"_PSST3_"^"_PSST4
"RTN","PSS50AQM",126,0)
 Q
"RTN","PSS50AQM",127,0)
SETSUB8(PSST1) ;
"RTN","PSS50AQM",128,0)
 N PSST2,PSST3,PSST4
"RTN","PSS50AQM",129,0)
 I $G(^PSDRUG(PSST1,"DOS2",0))="",$O(^PSDRUG(PSST1,"DOS2",0)) D
"RTN","PSS50AQM",130,0)
 .S (PSST4,PSST3)=0 F PSST2=0:0 S PSST2=$O(^PSDRUG(PSST1,"DOS2",PSST2)) Q:'PSST2  I $D(^PSDRUG(PSST1,"DOS2",PSST2,0)) S PSST3=PSST2,PSST4=PSST4+1
"RTN","PSS50AQM",131,0)
 .I PSST4 S ^PSDRUG(PSST1,"DOS2",0)="^50.0904^"_PSST3_"^"_PSST4
"RTN","PSS50AQM",132,0)
 Q
"RTN","PSS50AQM",133,0)
SETSUB9(PSST1) ;
"RTN","PSS50AQM",134,0)
 N PSST2,PSST3,PSST4
"RTN","PSS50AQM",135,0)
 I $G(^PSDRUG(PSST1,212,0))="",$O(^PSDRUG(PSST1,212,0)) D
"RTN","PSS50AQM",136,0)
 .S (PSST4,PSST3)=0 F PSST2=0:0 S PSST2=$O(^PSDRUG(PSST1,212,PSST2)) Q:'PSST2  I $D(^PSDRUG(PSST1,212,PSST2,0)) S PSST3=PSST2,PSST4=PSST4+1
"RTN","PSS50AQM",137,0)
 .I PSST4 S ^PSDRUG(PSST1,212,0)="^50.0212P^"_PSST3_"^"_PSST4
"RTN","PSS50AQM",138,0)
 Q
"RTN","PSS50AQM",139,0)
SETDF(PSSIEN) ;
"RTN","PSS50AQM",140,0)
 ;PSSIEN - IEN of entry in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50AQM",141,0)
 ;Returns NAME field (#.01) of PHARMACY ORDERABLE ITEM file (#50.7) and DOSAGE FORM
"RTN","PSS50AQM",142,0)
 N DIERR,ZZERR,PSS50P7,PSS
"RTN","PSS50AQM",143,0)
 I +$G(PSSIEN)'>0 Q -1_"^"_"NO DATA FOUND"
"RTN","PSS50AQM",144,0)
 D GETS^DIQ(50.7,+PSSIEN,".01;.02","IE","PSS50P7")
"RTN","PSS50AQM",145,0)
 I '$D(PSS50P7) Q -1_"^"_"NO DATA FOUND"
"RTN","PSS50AQM",146,0)
 Q $G(PSSIEN)_"^"_$G(PSS50P7(50.7,PSSIEN_",",.01,"I"))_"^"_$G(PSS50P7(50.7,PSSIEN_",",.02,"I"))_"^"_$G(PSS50P7(50.7,PSSIEN_",",.02,"E"))
"RTN","PSS50F")
0^3^B45358311
"RTN","PSS50F",1,0)
PSS50F ;BIR/LDT - API FOR INFORMATION FROM FILE 50; 5 Sep 03
"RTN","PSS50F",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91**;9/30/97
"RTN","PSS50F",3,0)
 ;External reference to DD(50,0,"IX" supported by DBIA 4323
"RTN","PSS50F",4,0)
 ;External reference to PRC(441 is supported by DBIA 214
"RTN","PSS50F",5,0)
 ;
"RTN","PSS50F",6,0)
OLDNM ;
"RTN","PSS50F",7,0)
 ;PSSIEN - IEN of entry in 50
"RTN","PSS50F",8,0)
 ;PSSFT - Free Text name in 50
"RTN","PSS50F",9,0)
 ;PSSFL - Inactive flag - "" - All entries
"RTN","PSS50F",10,0)
 ;                        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50F",11,0)
 ;PSSPK - Application Package's Use - "" - All entries
"RTN","PSS50F",12,0)
 ;                                         Alphabetic codes that represent the DHCP packages that consider this drug to be
"RTN","PSS50F",13,0)
 ;                                         part of their formulary.
"RTN","PSS50F",14,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the Field Number of the data
"RTN","PSS50F",15,0)
 ;       piece being returned.
"RTN","PSS50F",16,0)
 N DIERR,ZZERR,PSSP50,SCR,PSS,CNT
"RTN","PSS50F",17,0)
 I $G(LIST)']"" Q
"RTN","PSS50F",18,0)
 K ^TMP($J,LIST)
"RTN","PSS50F",19,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50F",20,0)
 I $G(PSSIEN)]"",+$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50F",21,0)
 S SCR("S")="",CNT=0
"RTN","PSS50F",22,0)
 I +$G(PSSFL)>0!($G(PSSPK)]"") N PSS5ND,PSSZ3,PSSZ4 D SETSCRN^PSS50A
"RTN","PSS50F",23,0)
 I $G(PSSIEN)]"" N PSSIEN2 S PSSIEN2=$$FIND1^DIC(50,"","A","`"_PSSIEN,,SCR("S"),"") D
"RTN","PSS50F",24,0)
 .I +PSSIEN2'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50F",25,0)
 .S ^TMP($J,LIST,0)=1
"RTN","PSS50F",26,0)
 .K ^TMP($J,"PSS50") D GETS^DIQ(50,+PSSIEN2,".01;900*","IE","^TMP($J,""PSS50""") S PSS(1)=0
"RTN","PSS50F",27,0)
 .F  S PSS(1)=$O(^TMP($J,"PSS50",50,PSS(1))) Q:'PSS(1)  D
"RTN","PSS50F",28,0)
 ..S ^TMP($J,LIST,+PSS(1),.01)=^TMP($J,"PSS50",50,PSS(1),.01,"I")
"RTN","PSS50F",29,0)
 ..S ^TMP($J,LIST,"B",^TMP($J,"PSS50",50,PSS(1),.01,"I"),+PSS(1))=""
"RTN","PSS50F",30,0)
 ..S PSS(2)=0 F  S PSS(2)=$O(^TMP($J,"PSS50",50.01,PSS(2))) Q:'PSS(2)  D SETOLDNM S CNT=CNT+1
"RTN","PSS50F",31,0)
 ..S ^TMP($J,LIST,+PSS(1),"OLD",0)=$S(CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS50F",32,0)
 I +$G(PSSIEN)'>0,$G(PSSFT)]"" D
"RTN","PSS50F",33,0)
 .I PSSFT["??" D LOOP(1) Q
"RTN","PSS50F",34,0)
 .D FIND^DIC(50,,"@;.01","QP",PSSFT,,"B",SCR("S"),,"")
"RTN","PSS50F",35,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50F",36,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS50F",37,0)
 ..S PSSIEN=+^TMP("DILIST",$J,PSSXX,0) K ^TMP($J,"PSS50") S CNT=0 D GETS^DIQ(50,+PSSIEN,".01;900*","IE","^TMP($J,""PSS50""") S PSS(1)=0
"RTN","PSS50F",38,0)
 ..F  S PSS(1)=$O(^TMP($J,"PSS50",50,PSS(1))) Q:'PSS(1)  D 
"RTN","PSS50F",39,0)
 ...S ^TMP($J,LIST,+PSS(1),.01)=^TMP($J,"PSS50",50,PSS(1),.01,"I")
"RTN","PSS50F",40,0)
 ...S ^TMP($J,LIST,"B",^TMP($J,"PSS50",50,PSS(1),.01,"I"),+PSS(1))=""
"RTN","PSS50F",41,0)
 ...S PSS(2)=0 F  S PSS(2)=$O(^TMP($J,"PSS50",50.01,PSS(2))) Q:'PSS(2)  D SETOLDNM S CNT=CNT+1
"RTN","PSS50F",42,0)
 ...S ^TMP($J,LIST,+PSS(1),"OLD",0)=$S(CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS50F",43,0)
 K ^TMP("DILIST",$J),^TMP($J,"PSS50")
"RTN","PSS50F",44,0)
 Q
"RTN","PSS50F",45,0)
 ;
"RTN","PSS50F",46,0)
LOOP(PSS) ;
"RTN","PSS50F",47,0)
 N CNT,PSSIEN S CNT=0
"RTN","PSS50F",48,0)
 S PSSIEN=0 F  S PSSIEN=$O(^PSDRUG(PSSIEN)) Q:'PSSIEN  D
"RTN","PSS50F",49,0)
 .I $P($G(^PSDRUG(PSSIEN,0)),"^")="" Q
"RTN","PSS50F",50,0)
 .I $G(PSSFL),$P($G(^PSDRUG(PSSIEN,"I")),"^"),$P($G(^("I")),"^")'>PSSFL Q
"RTN","PSS50F",51,0)
 .I $G(PSSRTOI)=1,'$P($G(^PSDRUG(PSSIEN,2)),"^") Q
"RTN","PSS50F",52,0)
 .;Naked reference below refers to ^PSDRUG(PSSIEN,2)
"RTN","PSS50F",53,0)
 .I $G(PSSPK)]"" N PSSZ5,PSSZ6 S PSSZ5=0 F PSSZ6=1:1:$L(PSSPK) Q:PSSZ5  I $P($G(^(2)),"^",3)[$E(PSSPK,PSSZ6) S PSSZ5=1
"RTN","PSS50F",54,0)
 .I $G(PSSPK)]"",'PSSZ5 Q
"RTN","PSS50F",55,0)
 .D @PSS
"RTN","PSS50F",56,0)
 S ^TMP($J,LIST,0)=$S(CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS50F",57,0)
 Q
"RTN","PSS50F",58,0)
 ;
"RTN","PSS50F",59,0)
SETOLDNM ;
"RTN","PSS50F",60,0)
 S ^TMP($J,LIST,+PSS(1),"OLD",+PSS(2),.01)=^TMP($J,"PSS50",50.01,PSS(2),.01,"I")
"RTN","PSS50F",61,0)
 S ^TMP($J,LIST,+PSS(1),"OLD",+PSS(2),.02)=$S($G(^TMP($J,"PSS50",50.01,PSS(2),.02,"I"))="":"",1:^TMP($J,"PSS50",50.01,PSS(2),.02,"I")_"^"_^TMP($J,"PSS50",50.01,PSS(2),.02,"E"))
"RTN","PSS50F",62,0)
 Q
"RTN","PSS50F",63,0)
 ;
"RTN","PSS50F",64,0)
SETLIST ;
"RTN","PSS50F",65,0)
 S ^TMP($J,LIST,+PSS(1),.01)=^TMP($J,"PSS50",50,PSS(1),.01,"I")
"RTN","PSS50F",66,0)
 S ^TMP($J,LIST,$S($G(PSSD)]"":$P(PSSD,"^"),1:"B"),^TMP($J,"PSS50",50,PSS(1),.01,"I"),+PSS(1))=""
"RTN","PSS50F",67,0)
 S ^TMP($J,LIST,+PSS(1),2.1)=$S($G(^TMP($J,"PSS50",50,PSS(1),2.1,"I"))="":"",1:^TMP($J,"PSS50",50,PSS(1),2.1,"I")_"^"_^TMP($J,"PSS50",50,PSS(1),2.1,"E"))
"RTN","PSS50F",68,0)
 S ^TMP($J,LIST,+PSS(1),100)=$S($G(^TMP($J,"PSS50",50,PSS(1),100,"I"))="":"",1:^TMP($J,"PSS50",50,PSS(1),100,"I")_"^"_^TMP($J,"PSS50",50,PSS(1),100,"E"))
"RTN","PSS50F",69,0)
 Q
"RTN","PSS50F",70,0)
 ;
"RTN","PSS50F",71,0)
SETLOOK ;
"RTN","PSS50F",72,0)
 S ^TMP($J,LIST,+PSS(2),.01)=PSS50(50,PSS(2),.01,"I")
"RTN","PSS50F",73,0)
 S ^TMP($J,LIST,$S($G(PSSCRFL)]"":$P(PSSCRFL,"^"),1:"B"),PSS50(50,PSS(2),.01,"I"),+PSS(2))=""
"RTN","PSS50F",74,0)
 S ^TMP($J,LIST,+PSS(2),2.1)=$S($G(PSS50(50,PSS(2),25,"I"))="":"",1:PSS50(50,PSS(2),25,"I")_"^"_PSS50(50,PSS(2),25,"E"))
"RTN","PSS50F",75,0)
 S ^TMP($J,LIST,+PSS(2),100)=$S($G(PSS50(50,PSS(2),100,"I"))="":"",1:PSS50(50,PSS(2),100,"I")_"^"_PSS50(50,PSS(2),100,"E"))
"RTN","PSS50F",76,0)
 S ^TMP($J,LIST,+PSS(2),101)=$S($G(PSS50(50,PSS(2),101,"I"))="":"",1:PSS50(50,PSS(2),101,"I")_"^"_PSS50(50,PSS(2),101,"E"))
"RTN","PSS50F",77,0)
 Q
"RTN","PSS50F",78,0)
 ;
"RTN","PSS50F",79,0)
ADDOLDNM(PSSIEN2,PSSONM2,PSSDT2) ;
"RTN","PSS50F",80,0)
 ;PSSIEN2 - IEN of entry in DRUG file (#50).
"RTN","PSS50F",81,0)
 ;PSSONM2 - Text of the old name.
"RTN","PSS50F",82,0)
 ;PSSDT2 - Date changed in FileMan format. 
"RTN","PSS50F",83,0)
 ;0 (zero)is returned if ADD was unsuccessful.  1 (one) will indicate successful ADD.
"RTN","PSS50F",84,0)
 ;Adding new entry to OLD NAME multiple (#50.01) of the DRUG file (#50).
"RTN","PSS50F",85,0)
 I (+$G(PSSIEN2)'>0)!($G(PSSONM2)']"") Q 0
"RTN","PSS50F",86,0)
 S:+$G(PSSDT2)'>0 PSSDT2=DT
"RTN","PSS50F",87,0)
 N PSS,QFLG
"RTN","PSS50F",88,0)
 N PSSIEN4 S PSSIEN4=$$FIND1^DIC(50,"","A","`"_PSSIEN2,,,"")
"RTN","PSS50F",89,0)
 I +PSSIEN4'>0 Q 0
"RTN","PSS50F",90,0)
 D LIST^DIC(50.01,","_PSSIEN2_",","@;.01IE;.02IE","P",,,,,,,)
"RTN","PSS50F",91,0)
 I +^TMP("DILIST",$J,0)'>0 D
"RTN","PSS50F",92,0)
 .S PSS(1,50.01,"+2,"_PSSIEN2_",",.01)=$G(PSSONM2)
"RTN","PSS50F",93,0)
 .S PSS(1,50.01,"+2,"_PSSIEN2_",",.02)=$G(PSSDT2)
"RTN","PSS50F",94,0)
 I +^TMP("DILIST",$J,0)>0 S (QFLG,PSS)=0 F  S PSS=$O(^TMP("DILIST",$J,PSS)) Q:'PSS  Q:QFLG  D
"RTN","PSS50F",95,0)
 .I $P($G(^TMP("DILIST",$J,PSS,0)),"^",2)=PSSONM2,($P($G(^(0)),"^",4)=PSSDT2) S QFLG=1 Q
"RTN","PSS50F",96,0)
 .S PSS(1,50.01,"+2,"_PSSIEN2_",",.01)=$G(PSSONM2)
"RTN","PSS50F",97,0)
 .S PSS(1,50.01,"+2,"_PSSIEN2_",",.02)=$G(PSSDT2)
"RTN","PSS50F",98,0)
 I $G(QFLG) Q 0
"RTN","PSS50F",99,0)
 D UPDATE^DIE("","PSS(1)") Q 1
"RTN","PSS50F",100,0)
 Q
"RTN","PSS50F",101,0)
EDTIFCAP(PSSIEN2,PSSVAL2) ;
"RTN","PSS50F",102,0)
 ;PSSIEN2 - IEN of entry in DRUG file (#50).
"RTN","PSS50F",103,0)
 ;PSSVAL2 - IFCAP ITEM NUMBER to be added.
"RTN","PSS50F",104,0)
 ;0 (zero)is returned if ADD was unsuccessful.  1 (one) will indicate successful ADD.
"RTN","PSS50F",105,0)
 ;Adding new entry to IFCAP ITEM NUMBER multiple (#50.01) of the DRUG file (#50).
"RTN","PSS50F",106,0)
 I (+$G(PSSIEN2)'>0)!+($G(PSSVAL2)'>0) Q 0
"RTN","PSS50F",107,0)
 N PSS,QFLG
"RTN","PSS50F",108,0)
 N PSSIEN3 S PSSIEN3=$$FIND1^DIC(441,"","A","`"_PSSVAL2,,,"")
"RTN","PSS50F",109,0)
 I +PSSIEN3'>0 Q 0
"RTN","PSS50F",110,0)
 N PSSIEN4 S PSSIEN4=$$FIND1^DIC(50,"","A","`"_PSSIEN2,,,"")
"RTN","PSS50F",111,0)
 I +PSSIEN4'>0 Q 0
"RTN","PSS50F",112,0)
 D LIST^DIC(50.0441,","_PSSIEN2_",","@;.01IE","P",,,,,,,)
"RTN","PSS50F",113,0)
 I +^TMP("DILIST",$J,0)'>0 D
"RTN","PSS50F",114,0)
 .S PSS(1,50.0441,"+2,"_PSSIEN2_",",.01)=$G(PSSVAL2)
"RTN","PSS50F",115,0)
 I +^TMP("DILIST",$J,0)>0 S (QFLG,PSS)=0 F  S PSS=$O(^TMP("DILIST",$J,PSS)) Q:'PSS  Q:QFLG  D
"RTN","PSS50F",116,0)
 .I $P($G(^TMP("DILIST",$J,PSS,0)),"^",2)=PSSVAL2 S QFLG=1 Q
"RTN","PSS50F",117,0)
 .I $O(^PSDRUG("AB",PSSVAL2,"")) S QFLG=1 Q
"RTN","PSS50F",118,0)
 .S PSS(1,50.0441,"+2,"_PSSIEN2_",",.01)=$G(PSSVAL2)
"RTN","PSS50F",119,0)
 I $G(QFLG) Q 0
"RTN","PSS50F",120,0)
 D UPDATE^DIE("","PSS(1)") Q 1
"RTN","PSS50F",121,0)
 Q
"RTN","PSS50F",122,0)
1 ;
"RTN","PSS50F",123,0)
 N CNT2 S CNT2=0
"RTN","PSS50F",124,0)
 K ^TMP($J,"PSS50") D GETS^DIQ(50,+PSSIEN,".01;900*","IE","^TMP($J,""PSS50""") S PSS(1)=0
"RTN","PSS50F",125,0)
 F  S PSS(1)=$O(^TMP($J,"PSS50",50,PSS(1))) Q:'PSS(1)  D
"RTN","PSS50F",126,0)
 .S ^TMP($J,LIST,+PSS(1),.01)=^TMP($J,"PSS50",50,PSS(1),.01,"I"),CNT=CNT+1
"RTN","PSS50F",127,0)
 .S ^TMP($J,LIST,"B",^TMP($J,"PSS50",50,PSS(1),.01,"I"),+PSS(1))=""
"RTN","PSS50F",128,0)
 .S (PSS(2),CNT2)=0 F  S PSS(2)=$O(^TMP($J,"PSS50",50.01,PSS(2))) Q:'PSS(2)  D SETOLDNM S CNT2=CNT2+1
"RTN","PSS50F",129,0)
 .S ^TMP($J,LIST,+PSS(1),"OLD",0)=$S(CNT2>0:CNT2,1:"-1^NO DATA FOUND")
"RTN","PSS50F",130,0)
 K ^TMP($J,"PSS50")
"RTN","PSS50F",131,0)
 Q
"RTN","PSS50F",132,0)
2 ;
"RTN","PSS50F",133,0)
 K ^TMP($J,"PSS50") D GETS^DIQ(50,+PSSIEN,".01;100;2.1","IE","^TMP($J,""PSS50""") S PSS(1)=0
"RTN","PSS50F",134,0)
 F  S PSS(1)=$O(^TMP($J,"PSS50",50,PSS(1))) Q:'PSS(1)  D SETLIST S CNT=CNT+1
"RTN","PSS50F",135,0)
 K ^TMP($J,"PSS50")
"RTN","PSS50F",136,0)
 Q
"RTN","PSS50F",137,0)
PARSE(PSSLUP) ; Create array of cross references, piece 2 of the array =1 for pointer fields, else 0
"RTN","PSS50F",138,0)
 I $G(PSSLUP)="" Q
"RTN","PSS50F",139,0)
 N PSSLUPA,PSSLUP1,PSSLUP2,PSSLUP3,PSSLUP4,PSSLUP5,PSSDTYPE,PSSPTER
"RTN","PSS50F",140,0)
 I $E(PSSLUP)="^" S PSSLUP=$E(PSSLUP,2,$L(PSSLUP))
"RTN","PSS50F",141,0)
 S PSSLUP1=0 F PSSLUP2=1:1:$L(PSSLUP) I $E(PSSLUP,PSSLUP2)="^" S PSSLUP1=PSSLUP1+1
"RTN","PSS50F",142,0)
 S PSSLUP1=PSSLUP1+1
"RTN","PSS50F",143,0)
 S PSSLUP4=1 F PSSLUP3=1:1:PSSLUP1 S PSSLUP5=$P(PSSLUP,"^",PSSLUP3) I PSSLUP5'="" D  S PSSLUPAR(PSSLUP4)=PSSLUP5_"^"_$G(PSSPTER),PSSLUP4=PSSLUP4+1
"RTN","PSS50F",144,0)
 .N PSSCRX,PSSCRX1 S PSSPTER=0
"RTN","PSS50F",145,0)
 .S PSSCRX="" F  S PSSCRX=$O(^DD(50,0,"IX",PSSLUP5,PSSCRX)) Q:PSSCRX=""  S PSSCRX1="" F  S PSSCRX1=$O(^DD(50,0,"IX",PSSLUP5,PSSCRX,PSSCRX1)) Q:PSSCRX1=""  D
"RTN","PSS50F",146,0)
 ..K PSSDTYPE D FIELD^DID(PSSCRX,PSSCRX1,,"TYPE","PSSDTYPE") I $G(PSSDTYPE("TYPE"))="POINTER" S PSSPTER=1
"RTN","PSS50F",147,0)
 Q
"RTN","PSS50P7")
0^4^B42625601
"RTN","PSS50P7",1,0)
PSS50P7 ;BIR/LDT - API FOR INFORMATION FROM FILE 50.7; 5 Sep 03
"RTN","PSS50P7",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91**;9/30/97
"RTN","PSS50P7",3,0)
 ;
"RTN","PSS50P7",4,0)
ZERO(PSSIEN,PSSFT,PSSFL,LIST) ;
"RTN","PSS50P7",5,0)
 ;PSSIEN - IEN of entry in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",6,0)
 ;PSSFT - Free Text name in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",7,0)
 ;PSSFL - Inactive flag - "" - All entries.
"RTN","PSS50P7",8,0)
 ;        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50P7",9,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS50P7",10,0)
 ;Field Number of the data piece being returned.
"RTN","PSS50P7",11,0)
 ;Returns NAME field (#.01), DOSAGE FORM field (#.02), IV FLAG field (#.03), INACTIVE DATE field (#.04),
"RTN","PSS50P7",12,0)
 ;DAY (nD) OR DOSE (nL) LIMIT field (#.05), MED ROUTE field (#.06), SCHEDULE TYPE fiedl (#.07),
"RTN","PSS50P7",13,0)
 ;SCHEDULE field (#.08), SUPPLY field (#.09), FORMULARY STATUS field (#5), and NON-VA MED field (#8) of
"RTN","PSS50P7",14,0)
 ;PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",15,0)
 N DIERR,ZZERR,PSS50P7,SCR,PSS
"RTN","PSS50P7",16,0)
 I $G(LIST)']"" Q
"RTN","PSS50P7",17,0)
 K ^TMP($J,LIST)
"RTN","PSS50P7",18,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",19,0)
 I $G(PSSIEN)]"",+$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",20,0)
 S SCR("S")=""
"RTN","PSS50P7",21,0)
 I +$G(PSSFL)>0 N ND D SETSCRN
"RTN","PSS50P7",22,0)
 I +$G(PSSIEN)>0 N PSSIEN2 S PSSIEN2=$$FIND1^DIC(50.7,"","A","`"_PSSIEN,,SCR("S"),"") D
"RTN","PSS50P7",23,0)
 .I +PSSIEN2'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",24,0)
 .S ^TMP($J,LIST,0)=1
"RTN","PSS50P7",25,0)
 .D GETS^DIQ(50.7,+PSSIEN2,".01;.02;.03;.04;.05;.06;.07;.08;.09;8;5","IE","PSS50P7") S PSS(1)=0
"RTN","PSS50P7",26,0)
 .F  S PSS(1)=$O(PSS50P7(50.7,PSS(1))) Q:'PSS(1)  D SETZRO^PSS50P7A
"RTN","PSS50P7",27,0)
 I +$G(PSSIEN)'>0,$G(PSSFT)]"" D
"RTN","PSS50P7",28,0)
 .I PSSFT["??" D LOOP^PSS50P7A(1) Q
"RTN","PSS50P7",29,0)
 .D FIND^DIC(50.7,,"@;.01;.02","QP",PSSFT,,"B",SCR("S"),,"")
"RTN","PSS50P7",30,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",31,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS50P7",32,0)
 ..S PSSIEN=+^TMP("DILIST",$J,PSSXX,0) K PSS50P7 D GETS^DIQ(50.7,+PSSIEN,".01;.02;.03;.04;.05;.06;.07;.08;.09;8;5","IE","PSS50P7") S PSS(1)=0
"RTN","PSS50P7",33,0)
 ..F  S PSS(1)=$O(PSS50P7(50.7,PSS(1))) Q:'PSS(1)  D SETZRO^PSS50P7A
"RTN","PSS50P7",34,0)
 K ^TMP("DILIST",$J)
"RTN","PSS50P7",35,0)
 Q
"RTN","PSS50P7",36,0)
 ;
"RTN","PSS50P7",37,0)
SYNONYM(PSSIEN,PSSFT,PSSFL,LIST) ;
"RTN","PSS50P7",38,0)
 ;PSSIEN - IEN of entry in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",39,0)
 ;PSSFT - Free Text name in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",40,0)
 ;PSSFL - Inactive flag - 0 or "" - All entries.
"RTN","PSS50P7",41,0)
 ;        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50P7",42,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS50P7",43,0)
 ;Field Number of the data piece being returned.
"RTN","PSS50P7",44,0)
 ;Returns NAME field (#.01), DOSAGE FORM field (#.02), SYNONYM subfile (#50.72), and SYNONYM field (#.01)
"RTN","PSS50P7",45,0)
 ;of PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",46,0)
 N DIERR,ZZERR,PSS50P7,SCR,PSS,CNT
"RTN","PSS50P7",47,0)
 I $G(LIST)']"" Q
"RTN","PSS50P7",48,0)
 K ^TMP($J,LIST)
"RTN","PSS50P7",49,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",50,0)
 I $G(PSSIEN)]"",+$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",51,0)
 S SCR("S")=""
"RTN","PSS50P7",52,0)
 I +$G(PSSFL)>0 N ND D SETSCRN
"RTN","PSS50P7",53,0)
 I +$G(PSSIEN)>0 N PSSIEN2 S PSSIEN2=$$FIND1^DIC(50.7,"","A","`"_PSSIEN,,SCR("S"),"") D
"RTN","PSS50P7",54,0)
 .I +PSSIEN2'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",55,0)
 .S ^TMP($J,LIST,0)=1
"RTN","PSS50P7",56,0)
 .D GETS^DIQ(50.7,+PSSIEN2,".01;.02;2*","IE","PSS50P7") S PSS(1)=0
"RTN","PSS50P7",57,0)
 .S CNT=0 F  S PSS(1)=$O(PSS50P7(50.72,PSS(1))) Q:'PSS(1)  D SETSYN^PSS50P7A S CNT=CNT+1
"RTN","PSS50P7",58,0)
 .S ^TMP($J,LIST,+PSSIEN2,"SYN",0)=$S(CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS50P7",59,0)
 .S PSS(2)=0 F  S PSS(2)=$O(PSS50P7(50.7,PSS(2))) Q:'PSS(2)  D SETZR2^PSS50P7A
"RTN","PSS50P7",60,0)
 I +$G(PSSIEN)'>0,$G(PSSFT)]"" D
"RTN","PSS50P7",61,0)
 .I PSSFT["??" D LOOP^PSS50P7A(2) Q
"RTN","PSS50P7",62,0)
 .D FIND^DIC(50.7,,"@;.01","QP",PSSFT,,"B",SCR("S"),,"")
"RTN","PSS50P7",63,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",64,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS50P7",65,0)
 ..S PSSIEN=+^TMP("DILIST",$J,PSSXX,0) K PSS50P7(50.72) K PSS50P7 D GETS^DIQ(50.7,+PSSIEN,".01;.02;2*","IE","PSS50P7") S PSS(1)=0
"RTN","PSS50P7",66,0)
 ..S CNT=0 F  S PSS(1)=$O(PSS50P7(50.72,PSS(1))) Q:'PSS(1)  D SETSYN^PSS50P7A  S CNT=CNT+1
"RTN","PSS50P7",67,0)
 ..S ^TMP($J,LIST,+PSSIEN,"SYN",0)=$S(CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS50P7",68,0)
 ..S PSS(2)=0 F  S PSS(2)=$O(PSS50P7(50.7,PSS(2))) Q:'PSS(2)  D SETZR2^PSS50P7A
"RTN","PSS50P7",69,0)
 K ^TMP("DILIST",$J)
"RTN","PSS50P7",70,0)
 Q
"RTN","PSS50P7",71,0)
 ;
"RTN","PSS50P7",72,0)
NAME(PSSIEN) ;
"RTN","PSS50P7",73,0)
 ;PSSIEN - IEN of entry in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",74,0)
 ;Returns NAME field (#.01) of PHARMACY ORDERABLE ITEM file (#50.7) and DOSAGE FORM name in external form.
"RTN","PSS50P7",75,0)
 N DIERR,ZZERR,PSS50P7,PSS
"RTN","PSS50P7",76,0)
 I +$G(PSSIEN)'>0 Q ""
"RTN","PSS50P7",77,0)
 D GETS^DIQ(50.7,+PSSIEN,".01;.02","E","PSS50P7")
"RTN","PSS50P7",78,0)
 I '$D(PSS50P7) Q ""
"RTN","PSS50P7",79,0)
 Q $G(PSS50P7(50.7,PSSIEN_",",.01,"E"))_" "_$G(PSS50P7(50.7,PSSIEN_",",.02,"E"))
"RTN","PSS50P7",80,0)
 ;
"RTN","PSS50P7",81,0)
INSTR(PSSIEN,PSSFT,PSSFL,LIST) ;
"RTN","PSS50P7",82,0)
 ;PSSIEN - IEN of entry in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",83,0)
 ;PSSFT - Free Text name in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",84,0)
 ;PSSFL - Inactive flag - "" - All entries.
"RTN","PSS50P7",85,0)
 ;        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50P7",86,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS50P7",87,0)
 ;Field Number of the data piece being returned.
"RTN","PSS50P7",88,0)
 ;Returns INS and INS1 nodes of PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",89,0)
 N DIERR,ZZERR,PSS50P7,SCR,PSS
"RTN","PSS50P7",90,0)
 I $G(LIST)']"" Q
"RTN","PSS50P7",91,0)
 K ^TMP($J,LIST)
"RTN","PSS50P7",92,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",93,0)
 I $G(PSSIEN)]"",+$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",94,0)
 S SCR("S")=""
"RTN","PSS50P7",95,0)
 I +$G(PSSFL)>0 N ND D SETSCRN
"RTN","PSS50P7",96,0)
 I +$G(PSSIEN)>0 N PSSIEN2 S PSSIEN2=$$FIND1^DIC(50.7,"","A","`"_PSSIEN,,SCR("S"),"") D
"RTN","PSS50P7",97,0)
 .I +PSSIEN2'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",98,0)
 .S ^TMP($J,LIST,0)=1
"RTN","PSS50P7",99,0)
 .D GETS^DIQ(50.7,+PSSIEN2,".01;.02;7;7.1","IE","PSS50P7") S PSS(1)=0
"RTN","PSS50P7",100,0)
 .F  S PSS(1)=$O(PSS50P7(50.7,PSS(1))) Q:'PSS(1)  D SETPTI^PSS50P7A
"RTN","PSS50P7",101,0)
 I +$G(PSSIEN)'>0,$G(PSSFT)]"" D
"RTN","PSS50P7",102,0)
 .I PSSFT["??" D LOOP^PSS50P7A(3) Q
"RTN","PSS50P7",103,0)
 .D FIND^DIC(50.7,,"@;.01","QP",PSSFT,,"B",SCR("S"),,"")
"RTN","PSS50P7",104,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",105,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS50P7",106,0)
 ..S PSSIEN=+^TMP("DILIST",$J,PSSXX,0) K PSS50P7 D GETS^DIQ(50.7,+PSSIEN,".01;.02;7;7.1","IE","PSS50P7") S PSS(1)=0
"RTN","PSS50P7",107,0)
 ..F  S PSS(1)=$O(PSS50P7(50.7,PSS(1))) Q:'PSS(1)  D SETPTI^PSS50P7A
"RTN","PSS50P7",108,0)
 K ^TMP("DILIST",$J)
"RTN","PSS50P7",109,0)
 Q
"RTN","PSS50P7",110,0)
 ;
"RTN","PSS50P7",111,0)
DRGIEN(PSSIEN,PSSFL,LIST) ;
"RTN","PSS50P7",112,0)
 ;PSSIEN - IEN of entry in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",113,0)
 ;PSSFL - Inactive flag - "" - All entries.
"RTN","PSS50P7",114,0)
 ;        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50P7",115,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS50P7",116,0)
 ;Field Number of the data piece being returned.
"RTN","PSS50P7",117,0)
 ;Returns entries from DRUG file (#50) linked to the Pharmacy Orderable Item IEN passed, GENERIC NAME field (#.01),
"RTN","PSS50P7",118,0)
 ;DEA, SPECIAL HDLG field (#3), APPLICATION PACKAGES' USE field (#63), and the INACTIVE DATE field (#100)
"RTN","PSS50P7",119,0)
 ;of DRUG file (#50).
"RTN","PSS50P7",120,0)
 N DIERR,ZZERR,PSS50P7,SCR,PSS
"RTN","PSS50P7",121,0)
 I $G(LIST)']"" Q
"RTN","PSS50P7",122,0)
 K ^TMP($J,LIST)
"RTN","PSS50P7",123,0)
 I +$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",124,0)
 S SCR("S")="I +Y'=$G(PSSIEN)"
"RTN","PSS50P7",125,0)
 ;Naked reference below refers to ^PSDRUG(+Y,"I")
"RTN","PSS50P7",126,0)
 I +$G(PSSFL)>0 S SCR("S")="S ND=$G(^(""I"")) I ((ND="""")&(+Y'=$G(PSSIEN)))!((ND>PSSFL)&(+Y'=$G(PSSIEN)))"
"RTN","PSS50P7",127,0)
 I +$G(PSSIEN)>0 D FIND^DIC(50,,"@;.01","QX",PSSIEN,,"ASP",SCR("S"),,"PSS50P7")
"RTN","PSS50P7",128,0)
 I +PSS50P7("DILIST",0)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",129,0)
 S ^TMP($J,LIST,0)=+PSS50P7("DILIST",0) S PSS(1)=0 D
"RTN","PSS50P7",130,0)
 .F  S PSS(1)=$O(PSS50P7("DILIST",PSS(1))) Q:'PSS(1)  S PSS(2)=0 F  S PSS(2)=$O(PSS50P7("DILIST",PSS(1),PSS(2))) Q:'PSS(2)  S ^TMP($J,LIST,+PSS50P7("DILIST",PSS(1),PSS(2)))=""
"RTN","PSS50P7",131,0)
 Q
"RTN","PSS50P7",132,0)
 ;
"RTN","PSS50P7",133,0)
IEN(PSSFT,PSSFL,LIST) ;
"RTN","PSS50P7",134,0)
 ;PSSFT - Free Text name in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",135,0)
 ;PSSFL - Inactive flag - "" - All entries.
"RTN","PSS50P7",136,0)
 ;        FileMan Date - Only entries with no Inactive Date or an Inactive Date greater than this date.
"RTN","PSS50P7",137,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS50P7",138,0)
 ;Field Number of the data piece being returned.
"RTN","PSS50P7",139,0)
 ;Returns NAME field (#.01), and DOSAGE FORM field (#.02) of PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",140,0)
 N DIERR,ZZERR,PSS50P7,SCR,PSS
"RTN","PSS50P7",141,0)
 I $G(LIST)']"" Q
"RTN","PSS50P7",142,0)
 K ^TMP($J,LIST)
"RTN","PSS50P7",143,0)
 I $G(PSSFT)']"" S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",144,0)
 S SCR("S")=""
"RTN","PSS50P7",145,0)
 I +$G(PSSFL)>0 D SETSCRN
"RTN","PSS50P7",146,0)
 I PSSFT["??" D LOOP^PSS50P7A(4) Q
"RTN","PSS50P7",147,0)
 I $G(PSSFT)]"" D FIND^DIC(50.7,,"@;.01;.02IE","QP",PSSFT,,"B",SCR("S"),,"")
"RTN","PSS50P7",148,0)
 I +$G(^TMP("DILIST",$J,0))'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",149,0)
 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) S PSS(2)=0 D
"RTN","PSS50P7",150,0)
 .F  S PSS(2)=$O(^TMP("DILIST",$J,PSS(2))) Q:'PSS(2)  D
"RTN","PSS50P7",151,0)
 ..S ^TMP($J,LIST,+^TMP("DILIST",$J,PSS(2),0),.01)=$P(^TMP("DILIST",$J,PSS(2),0),"^",2)
"RTN","PSS50P7",152,0)
 ..S ^TMP($J,LIST,"B",$P(^TMP("DILIST",$J,PSS(2),0),"^",2),+^TMP("DILIST",$J,PSS(2),0))=""
"RTN","PSS50P7",153,0)
 ..S ^TMP($J,LIST,+^TMP("DILIST",$J,PSS(2),0),.02)=$S($P($G(^TMP("DILIST",$J,PSS(2),0)),"^",3)]"":$P(^TMP("DILIST",$J,PSS(2),0),"^",3,4),1:"")
"RTN","PSS50P7",154,0)
 K ^TMP("DILIST",$J)
"RTN","PSS50P7",155,0)
 Q
"RTN","PSS50P7",156,0)
 ;
"RTN","PSS50P7",157,0)
LOOKUP(PSSFT,PSSD,PSSS,LIST) ;
"RTN","PSS50P7",158,0)
 ;PSSFT - Free Text name in PHARMACY ORDERABLE ITEM file (#50.7)
"RTN","PSS50P7",159,0)
 ;PSSD - Index being traversed.
"RTN","PSS50P7",160,0)
 ;PSSS - Screening information as defined in DIC("S").
"RTN","PSS50P7",161,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS50P7",162,0)
 ;Field Number of the data piece being returned.
"RTN","PSS50P7",163,0)
 ;Returns NAME field (#.01), DOSAGE FORM field (#.02), and INACTIVE DATE field (#.04) of
"RTN","PSS50P7",164,0)
 ;PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",165,0)
 N DIERR,ZZERR,PSS50P7,SCR,PSS
"RTN","PSS50P7",166,0)
 I $G(LIST)']"" Q
"RTN","PSS50P7",167,0)
 K ^TMP($J,LIST)
"RTN","PSS50P7",168,0)
 I $G(PSSFT)']"" S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS50P7",169,0)
 D LOOKUP^PSS50P7A
"RTN","PSS50P7",170,0)
 Q
"RTN","PSS50P7",171,0)
 ;
"RTN","PSS50P7",172,0)
SETSCRN ;Set Screen for inactive entries in PHARMACY ORDERABLE ITEM file (#50.7).
"RTN","PSS50P7",173,0)
 ;Naked reference below refers to ^PS(50.7,+Y,0)
"RTN","PSS50P7",174,0)
 S SCR("S")="S ND=$P($G(^(0)),U,4) I ND=""""!(ND>PSSFL)"
"RTN","PSS50P7",175,0)
 Q
"RTN","PSS51P1")
0^8^B16199904
"RTN","PSS51P1",1,0)
PSS51P1 ;BIR/LDT - API FOR INFORMATION FROM FILE 51.1; 5 Sep 03
"RTN","PSS51P1",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91**;9/30/97
"RTN","PSS51P1",3,0)
 ;
"RTN","PSS51P1",4,0)
ZERO(PSSIEN,PSSFT,PSSPP,PSSTSCH,LIST) ;
"RTN","PSS51P1",5,0)
 ;PSSIEN - IEN of entry in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",6,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",7,0)
 ;PSSPP - PACKAGE PREFIX field (#4) in ADMINISTRATION SCHEDULE file (#51.1). Screens for Administration
"RTN","PSS51P1",8,0)
 ;Schedules for the Package Prefix passed.
"RTN","PSS51P1",9,0)
 ;PSSTSCH - TYPE OF SCHEDULE field (#5) of ADMINISTRATION SCHEDULE file (#51.1). Screens for
"RTN","PSS51P1",10,0)
 ;          One-time "O" if PSSTSCH passed in.
"RTN","PSS51P1",11,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",12,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",13,0)
 ;Returns NAME field (#.01), STANDARD ADMINISTRATION TIMES field (#1), FREQUENCY (IN MINUTES) field (#2),
"RTN","PSS51P1",14,0)
 ;MAXIMUM DAYS FOR ORDERS field (#2.5), PACKAGE PREFIX field (#4), TYPE OF SCHEDULE field (#5),
"RTN","PSS51P1",15,0)
 ;STANDARD SHIFTS field (#6), OUTPATIENT EXPANSION field (#8), and OTHER LANGUAGE EXPANSIONS field (#8.1)
"RTN","PSS51P1",16,0)
 ;of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",17,0)
 N DIERR,ZZERR,PSS51P1,SCR,PSS
"RTN","PSS51P1",18,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",19,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1",20,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",21,0)
 I $G(PSSIEN)]"",+$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",22,0)
 I $G(PSSTSCH)]"",PSSTSCH'="O" S PSSTSCH=""
"RTN","PSS51P1",23,0)
 S SCR("S")="" I $G(PSSTSCH)]""!$G(PSSPP)]"" D SETSCR
"RTN","PSS51P1",24,0)
 I +$G(PSSIEN)>0 N PSSIEN2 S PSSIEN2=$$FIND1^DIC(51.1,"","A","`"_PSSIEN,"B",SCR("S"),"") D
"RTN","PSS51P1",25,0)
 .I +PSSIEN2'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",26,0)
 .S ^TMP($J,LIST,0)=1
"RTN","PSS51P1",27,0)
 .D GETS^DIQ(51.1,+PSSIEN2,".01;1;2;4;5;6;2.5;8;8.1","IE","PSS51P1") S PSS(1)=0
"RTN","PSS51P1",28,0)
 .F  S PSS(1)=$O(PSS51P1(51.1,PSS(1))) Q:'PSS(1)  D SETZRO^PSS51P1B
"RTN","PSS51P1",29,0)
 I +$G(PSSIEN)'>0,$G(PSSFT)]"" D
"RTN","PSS51P1",30,0)
 .I PSSFT["??" D LOOP^PSS51P1B(1) Q
"RTN","PSS51P1",31,0)
 .D FIND^DIC(51.1,,"@;.01;1","QP",PSSFT,,"B",SCR("S"),,"")
"RTN","PSS51P1",32,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",33,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS51P1",34,0)
 ..S PSSIEN=+^TMP("DILIST",$J,PSSXX,0) K PSS51P1 D GETS^DIQ(51.1,+PSSIEN,".01;1;2;4;5;6;2.5;8;8.1","IE","PSS51P1") S PSS(1)=0
"RTN","PSS51P1",35,0)
 ..F  S PSS(1)=$O(PSS51P1(51.1,PSS(1))) Q:'PSS(1)  D SETZRO^PSS51P1B
"RTN","PSS51P1",36,0)
 K ^TMP("DILIST",$J)
"RTN","PSS51P1",37,0)
 Q
"RTN","PSS51P1",38,0)
 ;
"RTN","PSS51P1",39,0)
WARD(PSSIEN,PSSFT,PSSIEN2,LIST) ;
"RTN","PSS51P1",40,0)
 ;PSSIEN - IEN of entry in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",41,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",42,0)
 ;PSSIEN2 - IEN of entry in WARD sub-file (#51.11)
"RTN","PSS51P1",43,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",44,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",45,0)
 ;Returns NAME field (#.01), WARD multiple (#51.11) WARD field (#.01), and WARD ADMINISTRATION TIMES field (#1)
"RTN","PSS51P1",46,0)
 ;of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",47,0)
 N DIERR,ZZERR,PSS51P1,PSS,CNT
"RTN","PSS51P1",48,0)
 S CNT=0
"RTN","PSS51P1",49,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",50,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1",51,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",52,0)
 I $G(PSSIEN)]"",+$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",53,0)
 I $G(PSSIEN2)]"",+$G(PSSIEN2)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",54,0)
 D WARD^PSS51P1C
"RTN","PSS51P1",55,0)
 Q
"RTN","PSS51P1",56,0)
 ;
"RTN","PSS51P1",57,0)
HOSP(PSSIEN,PSSFT,LIST) ;
"RTN","PSS51P1",58,0)
 ;PSSIEN - IEN of entry in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",59,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",60,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",61,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",62,0)
 ;Returns NAME field (#.01), HOSPITAL LOCATION multiple (#51.17) HOSPITAL LOCATION field (#.01), ADMINISTRATION TIMES field (#1),
"RTN","PSS51P1",63,0)
 ;and SHIFTS field (#2) of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",64,0)
 N DIERR,ZZERR,PSS51P1,SCR,PSS,CNT
"RTN","PSS51P1",65,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",66,0)
 D HOSP^PSS51P1A
"RTN","PSS51P1",67,0)
 Q
"RTN","PSS51P1",68,0)
 ;
"RTN","PSS51P1",69,0)
IEN(PSSFT,LIST) ;
"RTN","PSS51P1",70,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",71,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",72,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",73,0)
 ;Returns NAME field (#.01) and STANDARD ADMINISTRATION TIMES field (#1) of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",74,0)
 N DIERR,ZZERR,PSS51P1,SCR,PSS
"RTN","PSS51P1",75,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",76,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1",77,0)
 I $G(PSSFT)']"" S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",78,0)
 D IEN^PSS51P1A
"RTN","PSS51P1",79,0)
 Q
"RTN","PSS51P1",80,0)
 ;
"RTN","PSS51P1",81,0)
AP(PSSPP,PSSFT,PSSWDIEN,PSSTYP,LIST) ;
"RTN","PSS51P1",82,0)
 ;PSSPP - PACKAGE PREFIX in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",83,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",84,0)
 ;PSSWDIEN - IEN of entry of WARD multiple in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",85,0)
 ;PSSSTYP - TYPE OF SCHEDULE field (#5) in ADMINISTRATION SCHEDULE file (#51.1). 
"RTN","PSS51P1",86,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",87,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",88,0)
 ;Returns NAME field (#.01), STANDARD ADMINISTRATION TIMES field (#1), and PACKAGE PREFIX field (#4)
"RTN","PSS51P1",89,0)
 ;of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",90,0)
 ;If PSSWDIEN is passed in then the WARD multiple (#51.11) WARD field (#.01), and WARD ADMINISTRATION TIMES field (#1)
"RTN","PSS51P1",91,0)
 ;of ADMINISTRATION SCHEDULE file (#51.1) is returned.
"RTN","PSS51P1",92,0)
 N DIERR,ZZERR,PSS51P1,SCR,PSS,PSSIEN
"RTN","PSS51P1",93,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",94,0)
 D AP^PSS51P1A
"RTN","PSS51P1",95,0)
 Q
"RTN","PSS51P1",96,0)
 ;
"RTN","PSS51P1",97,0)
IX(PSSFT,PSSPP,LIST) ;
"RTN","PSS51P1",98,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",99,0)
 ;PSSPP - PACKAGE PREFIX in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",100,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",101,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",102,0)
 ;Returns NAME field (#.01), STANDARD ADMINISTRATION TIMES field (#1), FREQUENCY (IN MINUTES) field (#2),
"RTN","PSS51P1",103,0)
 ;MAXIMUM DAYS FOR ORDERS field (#2.5),PACKAGE PREFIX field (#4), TYPE OF SCHEDULE field (#5), STANDARD
"RTN","PSS51P1",104,0)
 ;SHIFTS field (#6), OUTPATIENT EXPANSION field (#8), and OTHER LANGUAGE EXPANSION field (#8.1) of
"RTN","PSS51P1",105,0)
 ;ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",106,0)
 N DIERR,ZZERR,PSS51P1,PSS
"RTN","PSS51P1",107,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",108,0)
 D IX^PSS51P1A
"RTN","PSS51P1",109,0)
 Q
"RTN","PSS51P1",110,0)
 ;
"RTN","PSS51P1",111,0)
ADM(PSSADM) ; admin times
"RTN","PSS51P1",112,0)
 N X S X=PSSADM
"RTN","PSS51P1",113,0)
 I $S($L($P(X,"-"))>4:1,$L(X)>119:1,$L(X)<2:1,X'>0:1,1:X'?.ANP) K X Q "^"
"RTN","PSS51P1",114,0)
 S X(1)=$P(X,"-") I X(1)'?2N,X(1)'?4N K X Q "^"
"RTN","PSS51P1",115,0)
 S X(1)=$L(X(1)) F X(2)=2:1:$L(X,"-") S X(3)=$P(X,"-",X(2)) I $S($L(X(3))'=X(1):1,X(3)>$S(X(1)=2:24,1:2400):1,1:X(3)'>$P(X,"-",X(2)-1)) K X Q
"RTN","PSS51P1",116,0)
 I '$D(X) Q "^"
"RTN","PSS51P1",117,0)
 K:$D(X) X(1),X(2),X(3) Q PSSADM
"RTN","PSS51P1",118,0)
 ;
"RTN","PSS51P1",119,0)
ALL(PSSIEN,PSSFT,LIST) ;
"RTN","PSS51P1",120,0)
 ;PSSIEN - IEN of entry in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",121,0)
 ;PSSFT - Free Text name in ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",122,0)
 ;LIST - Subscript of ^TMP array in the form ^TMP($J,LIST,Field Number where Field Number is the
"RTN","PSS51P1",123,0)
 ;       Field Number of the data piece being returned.
"RTN","PSS51P1",124,0)
 ;Returns NAME field (#.01), STANDARD ADMINISTRATION TIMES field (#1), FREQUENCY (IN MINUTES) field (#2),
"RTN","PSS51P1",125,0)
 ;MAXIMUM DAYS FOR ORDERS field (#2.5), PACKAGE PREFIX field (#4), TYPE OF SCHEDULE field (#5),
"RTN","PSS51P1",126,0)
 ;STANDARD SHIFTS field (#6), OUTPATIENT EXPANSION field (#8), OTHER LANGUAGE EXPANSIONS field (#8.1),
"RTN","PSS51P1",127,0)
 ; HOSPITAL LOCATION multiple (#51.17) HOSPITAL LOCATION field (#.01), ADMINISTRATION TIMES field (#1),
"RTN","PSS51P1",128,0)
 ;SHIFTS field (#2), WARD multiple (#51.11) WARD field (#.01), and WARD ADMINISTRATION TIMES field (#1)
"RTN","PSS51P1",129,0)
 ;of ADMINISTRATION SCHEDULE file (#51.1).
"RTN","PSS51P1",130,0)
 N DIERR,ZZERR,PSS
"RTN","PSS51P1",131,0)
 I $G(LIST)']"" Q
"RTN","PSS51P1",132,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1",133,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",134,0)
 I $G(PSSIEN)]"",+$G(PSSIEN)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1",135,0)
 D ALL^PSS51P1C
"RTN","PSS51P1",136,0)
 Q
"RTN","PSS51P1",137,0)
 ;
"RTN","PSS51P1",138,0)
SETSCR ;Set Screen for One-time schedule type
"RTN","PSS51P1",139,0)
 ;Naked reference below refers to ^PS(51.1,+Y,0)
"RTN","PSS51P1",140,0)
 I $G(PSSTSCH)]"" S SCR("S")="I $P(^(0),""^"",5)=""O"""
"RTN","PSS51P1",141,0)
 ;Naked reference below refers to ^PS(51.1,+Y,0)
"RTN","PSS51P1",142,0)
 I $G(PSSPP)]"" S SCR("S")=$S(SCR("S")]"":SCR("S")_" I $P(^(0),""^"",4)=PSSPP",1:"I $P(^(0),""^"",4)=PSSPP")
"RTN","PSS51P1",143,0)
 Q
"RTN","PSS51P1A")
0^5^B44739215
"RTN","PSS51P1A",1,0)
PSS51P1A ;BIR/LDT - API FOR INFORMATION FROM FILE 51.1 CONT.; 5 Sep 03
"RTN","PSS51P1A",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91**;9/30/97
"RTN","PSS51P1A",3,0)
 ;
"RTN","PSS51P1A",4,0)
HOSP ;
"RTN","PSS51P1A",5,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1A",6,0)
 I +$G(PSSIEN)'>0,($G(PSSFT)']"") S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",7,0)
 I +$G(PSSIEN)>0 N PSSIEN2 S PSSIEN2=$$FIND1^DIC(51.1,"","A","`"_PSSIEN,,,"") D
"RTN","PSS51P1A",8,0)
 .I +PSSIEN2'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",9,0)
 .D GETS^DIQ(51.1,+PSSIEN2,".01;7*","IE","^TMP($J,""PSS51P1""") S (PSS(1),CNT)=0
"RTN","PSS51P1A",10,0)
 .S PSSIEN=+PSSIEN2 F  S PSS(1)=$O(^TMP($J,"PSS51P1",51.17,PSS(1))) Q:'PSS(1)  D SETLOC^PSS51P1B S CNT=CNT+1
"RTN","PSS51P1A",11,0)
 .S ^TMP($J,LIST,+PSSIEN,"HOSP",0)=$S(CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS51P1A",12,0)
 .S PSS(2)=0 F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.1,PSS(2))) Q:'PSS(2)  D
"RTN","PSS51P1A",13,0)
 ..S ^TMP($J,LIST,+PSS(2),.01)=$G(^TMP($J,"PSS51P1",51.1,PSS(2),.01,"I"))
"RTN","PSS51P1A",14,0)
 ..S ^TMP($J,LIST,"B",$G(^TMP($J,"PSS51P1",51.1,PSS(2),.01,"E")),+PSS(2))=""
"RTN","PSS51P1A",15,0)
 I +$G(PSSIEN)'>0,$G(PSSFT)]"" D
"RTN","PSS51P1A",16,0)
 .I PSSFT["??" D LOOP^PSS51P1B(3) Q
"RTN","PSS51P1A",17,0)
 .D FIND^DIC(51.1,,"@;.01","QP",PSSFT,,"B",,,"")
"RTN","PSS51P1A",18,0)
 .I +$G(^TMP("DILIST",$J,0))=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",19,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS51P1A",20,0)
 ..S PSSIEN=+^TMP("DILIST",$J,PSSXX,0) K ^TMP($J,"PSS51P1") D GETS^DIQ(51.1,+PSSIEN,".01;7*","IE","^TMP($J,""PSS51P1""") S (PSS(1),CNT)=0 D
"RTN","PSS51P1A",21,0)
 ...F  S PSS(1)=$O(^TMP($J,"PSS51P1",51.17,PSS(1))) Q:'PSS(1)  D SETLOC^PSS51P1B S CNT=CNT+1
"RTN","PSS51P1A",22,0)
 ...S ^TMP($J,LIST,+PSSIEN,"HOSP",0)=$S(CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS51P1A",23,0)
 ...S PSS(2)=0 F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.1,PSS(2))) Q:'PSS(2)  D
"RTN","PSS51P1A",24,0)
 ....S ^TMP($J,LIST,+PSS(2),.01)=$G(^TMP($J,"PSS51P1",51.1,PSS(2),.01,"I"))
"RTN","PSS51P1A",25,0)
 ....S ^TMP($J,LIST,"B",$G(^TMP($J,"PSS51P1",51.1,PSS(2),.01,"E")),+PSS(2))=""
"RTN","PSS51P1A",26,0)
 K ^TMP("DILIST",$J),^TMP($J,"PSS51P1")
"RTN","PSS51P1A",27,0)
 Q
"RTN","PSS51P1A",28,0)
 ;
"RTN","PSS51P1A",29,0)
AP ;
"RTN","PSS51P1A",30,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1A",31,0)
 S SCR("S")=$S($G(PSSTYP)]"":"I $P($G(^PS(51.1,+Y,0)),""^"",5)[PSSTYP",1:"")
"RTN","PSS51P1A",32,0)
 I $G(PSSPP)']"" S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",33,0)
 I $G(PSSPP)]"",$G(PSSFT)="" D LIST^DIC(51.1,"","@;.01;1;2;2.5;4;5IE;8","P",,,,"AP"_PSSPP,SCR("S"),,) D
"RTN","PSS51P1A",34,0)
 .I +^TMP("DILIST",$J,0)'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",35,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0)
"RTN","PSS51P1A",36,0)
 .N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS51P1A",37,0)
 ..S PSSIEN=+^TMP("DILIST",$J,PSSXX,0)
"RTN","PSS51P1A",38,0)
 ..S ^TMP($J,LIST,+PSSIEN,.01)=$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",2)
"RTN","PSS51P1A",39,0)
 ..S ^TMP($J,LIST,"AP"_PSSPP,$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",2),+$G(^TMP("DILIST",$J,PSSXX,0)))=""
"RTN","PSS51P1A",40,0)
 ..S ^TMP($J,LIST,+PSSIEN,1)=$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",3)
"RTN","PSS51P1A",41,0)
 ..S ^TMP($J,LIST,+PSSIEN,2)=$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",4)
"RTN","PSS51P1A",42,0)
 ..S ^TMP($J,LIST,+PSSIEN,2.5)=$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",5)
"RTN","PSS51P1A",43,0)
 ..S ^TMP($J,LIST,+PSSIEN,4)=$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",6)
"RTN","PSS51P1A",44,0)
 ..S ^TMP($J,LIST,+PSSIEN,5)=$S($P($G(^TMP("DILIST",$J,PSSXX,0)),"^",7)="":"",1:$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",7)_"^"_$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",8))
"RTN","PSS51P1A",45,0)
 ..S ^TMP($J,LIST,+PSSIEN,8)=$P($G(^TMP("DILIST",$J,PSSXX,0)),"^",9)
"RTN","PSS51P1A",46,0)
 ..I +$G(PSSWDIEN)'>0 K ^TMP($J,"PSS51P1") D GETS^DIQ(51.1,+PSSIEN,".01;3*","IE","^TMP($J,""PSS51P1""") D
"RTN","PSS51P1A",47,0)
 ...S PSS(1)=+PSSIEN,(PSS(2),CNT)=0 F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.11,PSS(2))) Q:'PSS(2)  D SETWARD^PSS51P1B S CNT=CNT+1
"RTN","PSS51P1A",48,0)
 ...S ^TMP($J,LIST,+PSSIEN,"WARD",0)=$S(CNT>0:CNT,1:-1_"^"_"NO DATA FOUND")
"RTN","PSS51P1A",49,0)
 ..I +$G(PSSWDIEN)>0 K ^TMP($J,"PSS51P1") D GETS^DIQ(51.1,+PSSIEN,".01;3*","IE","^TMP($J,""PSS51P1""") D
"RTN","PSS51P1A",50,0)
 ...I +$D(^TMP($J,"PSS51P1",51.11))'>0 S ^TMP($J,LIST,+PSSIEN,"WARD",0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",51,0)
 ...S (PSS(2),CNT)=0 F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.11,PSS(2))) Q:'PSS(2)  D
"RTN","PSS51P1A",52,0)
 ....I PSSWDIEN=$P($G(^TMP($J,"PSS51P1",51.11,PSS(2),.01,"I")),"^") D SETWRD2^PSS51P1B Q
"RTN","PSS51P1A",53,0)
 ....S ^TMP($J,LIST,+PSSIEN,"WARD",0)="-1^NO DATA FOUND FOR PSSWDIEN #"_PSSWDIEN
"RTN","PSS51P1A",54,0)
 I $G(PSSPP)]"",$G(PSSFT)]""  D
"RTN","PSS51P1A",55,0)
 .I PSSFT["??" D LOOP^PSS51P1B(5) Q
"RTN","PSS51P1A",56,0)
 .D FIND^DIC(51.1,,"@;.01;1;2;2.5;4;5IE;8",,PSSFT,,"AP"_PSSPP,SCR("S"),,"")
"RTN","PSS51P1A",57,0)
 .I +$G(^TMP("DILIST",$J,0))'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",58,0)
 .I +^TMP("DILIST",$J,0)>0 S ^TMP($J,LIST,0)=+^TMP("DILIST",$J,0) N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,2,PSSXX)) Q:'PSSXX  D
"RTN","PSS51P1A",59,0)
 ..S PSSIEN=+^TMP("DILIST",$J,2,PSSXX)
"RTN","PSS51P1A",60,0)
 ..S ^TMP($J,LIST,+PSSIEN,.01)=$G(^TMP("DILIST",$J,"ID",PSSXX,.01))
"RTN","PSS51P1A",61,0)
 ..S ^TMP($J,LIST,"AP"_PSSPP,$G(^TMP("DILIST",$J,"ID",PSSXX,.01)),+PSSIEN)=""
"RTN","PSS51P1A",62,0)
 ..S ^TMP($J,LIST,+PSSIEN,1)=$G(^TMP("DILIST",$J,"ID",PSSXX,1))
"RTN","PSS51P1A",63,0)
 ..S ^TMP($J,LIST,+PSSIEN,2)=$G(^TMP("DILIST",$J,"ID",PSSXX,2))
"RTN","PSS51P1A",64,0)
 ..S ^TMP($J,LIST,+PSSIEN,2.5)=$G(^TMP("DILIST",$J,"ID",PSSXX,2.5))
"RTN","PSS51P1A",65,0)
 ..S ^TMP($J,LIST,+PSSIEN,4)=$G(^TMP("DILIST",$J,"ID",PSSXX,4))
"RTN","PSS51P1A",66,0)
 ..S ^TMP($J,LIST,+PSSIEN,5)=$S($G(^TMP("DILIST",$J,"ID",PSSXX,5,"I"))="":"",1:$G(^TMP("DILIST",$J,"ID",PSSXX,5,"I"))_"^"_$G(^TMP("DILIST",$J,"ID",PSSXX,5,"E")))
"RTN","PSS51P1A",67,0)
 ..S ^TMP($J,LIST,+PSSIEN,8)=$G(^TMP("DILIST",$J,"ID",PSSXX,8))
"RTN","PSS51P1A",68,0)
 ..I +$G(PSSWDIEN)'>0 K ^TMP($J,"PSS51P1") D GETS^DIQ(51.1,+PSSIEN,".01;3*","IE","^TMP($J,""PSS51P1""") D
"RTN","PSS51P1A",69,0)
 ...S PSS(1)=+PSSIEN,(PSS(2),CNT)=0 F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.11,PSS(2))) Q:'PSS(2)  D SETWARD^PSS51P1B S CNT=CNT+1
"RTN","PSS51P1A",70,0)
 ...S ^TMP($J,LIST,+PSSIEN,"WARD",0)=$S(CNT>0:CNT,1:-1_"^"_"NO DATA FOUND")
"RTN","PSS51P1A",71,0)
 ..I +$G(PSSWDIEN)>0 K ^TMP($J,"PSS51P1") D GETS^DIQ(51.1,+PSSIEN,".01;3*","IE","^TMP($J,""PSS51P1""") D
"RTN","PSS51P1A",72,0)
 ...I +$D(^TMP($J,"PSS51P1",51.11))'>0 S ^TMP($J,LIST,+PSSIEN,"WARD",0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",73,0)
 ...S (PSS(2),CNT)=0 F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.11,PSS(2))) Q:'PSS(2)  D
"RTN","PSS51P1A",74,0)
 ....I PSSWDIEN=$P($G(^TMP($J,"PSS51P1",51.11,PSS(2),.01,"I")),"^") D SETWRD2^PSS51P1B Q
"RTN","PSS51P1A",75,0)
 ....S ^TMP($J,LIST,+PSSIEN,"WARD",0)="-1^NO DATA FOUND FOR PSSWDIEN #"_PSSWDIEN
"RTN","PSS51P1A",76,0)
 K ^TMP("DILIST",$J),^TMP($J,"PSS51P1")
"RTN","PSS51P1A",77,0)
 Q
"RTN","PSS51P1A",78,0)
 ;
"RTN","PSS51P1A",79,0)
IX ;
"RTN","PSS51P1A",80,0)
 N CNT
"RTN","PSS51P1A",81,0)
 K ^TMP($J,LIST)
"RTN","PSS51P1A",82,0)
 I $G(PSSPP)']"" S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",83,0)
 I $G(PSSFT)']"" S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",84,0)
 I $G(PSSPP)]"",$G(PSSFT)]""  D
"RTN","PSS51P1A",85,0)
 .I PSSFT["??" D LOOP^PSS51P1B(6) Q
"RTN","PSS51P1A",86,0)
 .D FIND^DIC(51.1,,"@;.01","QP",PSSFT,,"AP"_PSSPP,,,"")
"RTN","PSS51P1A",87,0)
 .I +$G(^TMP("DILIST",$J,0))'>0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",88,0)
 .I +^TMP("DILIST",$J,0)>0 N PSSXX S (PSSXX,CNT)=0 F  S PSSXX=$O(^TMP("DILIST",$J,PSSXX)) Q:'PSSXX  D
"RTN","PSS51P1A",89,0)
 ..S PSSIEN=+^TMP("DILIST",$J,PSSXX,0)
"RTN","PSS51P1A",90,0)
 ..K PSS51P1 D GETS^DIQ(51.1,+PSSIEN,".01;1;2;2.5;4;5;6;8;8.1","IE","PSS51P1")
"RTN","PSS51P1A",91,0)
 ..N PSSXX S PSSXX=0 F  S PSSXX=$O(PSS51P1(51.1,PSSXX)) Q:'PSSXX  D  S CNT=CNT+1
"RTN","PSS51P1A",92,0)
 ...S ^TMP($J,LIST,+PSSXX,.01)=$G(PSS51P1(51.1,PSSXX,.01,"E"))
"RTN","PSS51P1A",93,0)
 ...S ^TMP($J,LIST,"AP"_PSSPP,$G(PSS51P1(51.1,PSSXX,.01,"E")),+PSSXX)=""
"RTN","PSS51P1A",94,0)
 ...S ^TMP($J,LIST,+PSSXX,1)=$G(PSS51P1(51.1,PSSXX,1,"E"))
"RTN","PSS51P1A",95,0)
 ...S ^TMP($J,LIST,+PSSXX,2)=$G(PSS51P1(51.1,PSSXX,2,"E"))
"RTN","PSS51P1A",96,0)
 ...S ^TMP($J,LIST,+PSSXX,2.5)=$G(PSS51P1(51.1,PSSXX,2.5,"E"))
"RTN","PSS51P1A",97,0)
 ...S ^TMP($J,LIST,+PSSXX,4)=$G(PSS51P1(51.1,PSSXX,4,"E"))
"RTN","PSS51P1A",98,0)
 ...S ^TMP($J,LIST,+PSSXX,5)=$S($G(PSS51P1(51.1,PSSXX,5,"I"))]"":$G(PSS51P1(51.1,PSSXX,5,"I"))_"^"_$G(PSS51P1(51.1,PSSXX,5,"E")),1:"")
"RTN","PSS51P1A",99,0)
 ...S ^TMP($J,LIST,+PSSXX,6)=$G(PSS51P1(51.1,PSSXX,6,"E"))
"RTN","PSS51P1A",100,0)
 ...S ^TMP($J,LIST,+PSSXX,8)=$G(PSS51P1(51.1,PSSXX,8,"E"))
"RTN","PSS51P1A",101,0)
 ...S ^TMP($J,LIST,+PSSXX,8.1)=$G(PSS51P1(51.1,PSSXX,8.1,"E"))
"RTN","PSS51P1A",102,0)
 ..S ^TMP($J,LIST,0)=$S(CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS51P1A",103,0)
 K PSS51P1
"RTN","PSS51P1A",104,0)
 K ^TMP("DILIST",$J)
"RTN","PSS51P1A",105,0)
 Q
"RTN","PSS51P1A",106,0)
 ;
"RTN","PSS51P1A",107,0)
IEN ;
"RTN","PSS51P1A",108,0)
 I $G(PSSFT)]"" D
"RTN","PSS51P1A",109,0)
 .I PSSFT["??" D LOOP^PSS51P1B(4) Q
"RTN","PSS51P1A",110,0)
 .D FIND^DIC(51.1,,"@;.01;1","QP",PSSFT,,"B",,,"PSS51P1")
"RTN","PSS51P1A",111,0)
 .I +PSS51P1("DILIST",0)=0 S ^TMP($J,LIST,0)=-1_"^"_"NO DATA FOUND" Q
"RTN","PSS51P1A",112,0)
 .I +PSS51P1("DILIST",0)>0 S ^TMP($J,LIST,0)=+PSS51P1("DILIST",0) N PSSXX S PSSXX=0 F  S PSSXX=$O(PSS51P1("DILIST",PSSXX)) Q:'PSSXX  D
"RTN","PSS51P1A",113,0)
 ..S ^TMP($J,LIST,+$G(PSS51P1("DILIST",PSSXX,0)),.01)=$P($G(PSS51P1("DILIST",PSSXX,0)),"^",2)
"RTN","PSS51P1A",114,0)
 ..S ^TMP($J,LIST,+$G(PSS51P1("DILIST",PSSXX,0)),1)=$P($G(PSS51P1("DILIST",PSSXX,0)),"^",3)
"RTN","PSS51P1A",115,0)
 ..S ^TMP($J,LIST,"B",$P($G(PSS51P1("DILIST",PSSXX,0)),"^",2),+$G(PSS51P1("DILIST",PSSXX,0)))=""
"RTN","PSS51P1A",116,0)
 K ^TMP("DILIST",$J)
"RTN","PSS51P1A",117,0)
 Q
"RTN","PSS51P1B")
0^6^B43057007
"RTN","PSS51P1B",1,0)
PSS51P1B ;BIR/LDT - API FOR INFORMATION FROM FILE 51.1 CONT.; 5 Sep 03
"RTN","PSS51P1B",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91**;9/30/97
"RTN","PSS51P1B",3,0)
 ;
"RTN","PSS51P1B",4,0)
SETZRO ;
"RTN","PSS51P1B",5,0)
 S ^TMP($J,LIST,+PSS(1),.01)=$G(PSS51P1(51.1,PSS(1),.01,"I"))
"RTN","PSS51P1B",6,0)
 S ^TMP($J,LIST,"B",$G(PSS51P1(51.1,PSS(1),.01,"I")),+PSS(1))=""
"RTN","PSS51P1B",7,0)
 S ^TMP($J,LIST,+PSS(1),1)=$G(PSS51P1(51.1,PSS(1),1,"I"))
"RTN","PSS51P1B",8,0)
 S ^TMP($J,LIST,+PSS(1),2)=$G(PSS51P1(51.1,PSS(1),2,"I"))
"RTN","PSS51P1B",9,0)
 S ^TMP($J,LIST,+PSS(1),4)=$G(PSS51P1(51.1,PSS(1),4,"I"))
"RTN","PSS51P1B",10,0)
 S ^TMP($J,LIST,+PSS(1),5)=$S($G(PSS51P1(51.1,PSS(1),5,"I"))="":"",1:PSS51P1(51.1,PSS(1),5,"I")_"^"_PSS51P1(51.1,PSS(1),5,"E"))
"RTN","PSS51P1B",11,0)
 S ^TMP($J,LIST,+PSS(1),6)=$G(PSS51P1(51.1,PSS(1),6,"I"))
"RTN","PSS51P1B",12,0)
 S ^TMP($J,LIST,+PSS(1),2.5)=$G(PSS51P1(51.1,PSS(1),2.5,"I"))
"RTN","PSS51P1B",13,0)
 S ^TMP($J,LIST,+PSS(1),8)=$G(PSS51P1(51.1,PSS(1),8,"I"))
"RTN","PSS51P1B",14,0)
 S ^TMP($J,LIST,+PSS(1),8.1)=$G(PSS51P1(51.1,PSS(1),8.1,"I"))
"RTN","PSS51P1B",15,0)
 Q
"RTN","PSS51P1B",16,0)
 ;
"RTN","PSS51P1B",17,0)
SETWARD ;
"RTN","PSS51P1B",18,0)
 S ^TMP($J,LIST,+PSS(1),"WARD",+PSS(2),.01)=$S($G(^TMP($J,"PSS51P1",51.11,PSS(2),.01,"I"))="":"",1:^TMP($J,"PSS51P1",51.11,PSS(2),.01,"I")_"^"_^TMP($J,"PSS51P1",51.11,PSS(2),.01,"E"))
"RTN","PSS51P1B",19,0)
 S ^TMP($J,LIST,+PSS(1),"WARD",+PSS(2),1)=$G(^TMP($J,"PSS51P1",51.11,PSS(2),1,"I"))
"RTN","PSS51P1B",20,0)
 Q
"RTN","PSS51P1B",21,0)
 ;
"RTN","PSS51P1B",22,0)
SETLOC ;
"RTN","PSS51P1B",23,0)
 S ^TMP($J,LIST,+PSSIEN,"HOSP",+PSS(1),.01)=$S($G(^TMP($J,"PSS51P1",51.17,PSS(1),.01,"I"))="":"",1:^TMP($J,"PSS51P1",51.17,PSS(1),.01,"I")_"^"_^TMP($J,"PSS51P1",51.17,PSS(1),.01,"E"))
"RTN","PSS51P1B",24,0)
 S ^TMP($J,LIST,+PSSIEN,"HOSP",+PSS(1),1)=$G(^TMP($J,"PSS51P1",51.17,PSS(1),1,"I"))
"RTN","PSS51P1B",25,0)
 S ^TMP($J,LIST,+PSSIEN,"HOSP",+PSS(1),2)=$G(^TMP($J,"PSS51P1",51.17,PSS(1),2,"I"))
"RTN","PSS51P1B",26,0)
 Q
"RTN","PSS51P1B",27,0)
 ;
"RTN","PSS51P1B",28,0)
LOOP(PSSLP) ;
"RTN","PSS51P1B",29,0)
 N CNT,CNT1,PSS S (CNT,PSS(3))=0
"RTN","PSS51P1B",30,0)
 F  S PSS(3)=$O(^PS(51.1,PSS(3))) Q:'PSS(3)  D @(PSSLP)
"RTN","PSS51P1B",31,0)
 S ^TMP($J,LIST,0)=$S(CNT>0:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS51P1B",32,0)
 K ^TMP("DILIST",$J)
"RTN","PSS51P1B",33,0)
 Q
"RTN","PSS51P1B",34,0)
 ;
"RTN","PSS51P1B",35,0)
SETWRD2 ;
"RTN","PSS51P1B",36,0)
 S ^TMP($J,LIST,+PSSIEN,"WARD",+PSS(2),.01)=$S($G(^TMP($J,"PSS51P1",51.11,PSS(2),.01,"I"))="":"",1:^TMP($J,"PSS51P1",51.11,PSS(2),.01,"I")_"^"_^TMP($J,"PSS51P1",51.11,PSS(2),.01,"E"))
"RTN","PSS51P1B",37,0)
 S ^TMP($J,LIST,+PSSIEN,"WARD",+PSS(2),1)=$G(^TMP($J,"PSS51P1",51.11,PSS(2),1,"I"))
"RTN","PSS51P1B",38,0)
 S ^TMP($J,LIST,+PSSIEN,"WARD",0)=1
"RTN","PSS51P1B",39,0)
 Q
"RTN","PSS51P1B",40,0)
 ;
"RTN","PSS51P1B",41,0)
1 ;
"RTN","PSS51P1B",42,0)
 I $G(PSSTSCH)]"" Q:$P($G(^PS(51.1,PSS(3),0)),"^",5)'="O"
"RTN","PSS51P1B",43,0)
 I $G(PSSPP)]"" Q:$P($G(^PS(51.1,PSS(3),0)),"^",4)'=PSSPP
"RTN","PSS51P1B",44,0)
 S PSSIEN=PSS(3) K PSS51P1 D GETS^DIQ(51.1,+PSSIEN,".01;1;2;4;5;6;2.5;8;8.1","IE","PSS51P1") S PSS(1)=0
"RTN","PSS51P1B",45,0)
 F  S PSS(1)=$O(PSS51P1(51.1,PSS(1))) Q:'PSS(1)  D SETZRO S CNT=CNT+1
"RTN","PSS51P1B",46,0)
 K PSS51P1
"RTN","PSS51P1B",47,0)
 Q
"RTN","PSS51P1B",48,0)
 ;
"RTN","PSS51P1B",49,0)
2 ;
"RTN","PSS51P1B",50,0)
 S PSSIEN=PSS(3) K ^TMP($J,"PSS51P1")
"RTN","PSS51P1B",51,0)
 I +$G(PSSIEN2)'>0 D GETS^DIQ(51.1,+PSSIEN,".01;3*","IE","^TMP($J,""PSS51P1""") S PSS(1)=0 D
"RTN","PSS51P1B",52,0)
 .F  S PSS(1)=$O(^TMP($J,"PSS51P1",51.1,PSS(1))) Q:'PSS(1)  D
"RTN","PSS51P1B",53,0)
 ..S ^TMP($J,LIST,+PSS(1),.01)=$G(^TMP($J,"PSS51P1",51.1,PSS(1),.01,"I")),CNT=CNT+1
"RTN","PSS51P1B",54,0)
 ..S ^TMP($J,LIST,"B",$G(^TMP($J,"PSS51P1",51.1,PSS(1),.01,"E")),+PSS(1))="" S (PSS(2),CNT1)=0 D
"RTN","PSS51P1B",55,0)
 ...F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.11,PSS(2))) Q:'PSS(2)  D SETWARD S CNT1=CNT1+1
"RTN","PSS51P1B",56,0)
 ...S ^TMP($J,LIST,+PSS(1),"WARD",0)=$S(CNT1>0:CNT1,1:"-1^NO DATA FOUND")
"RTN","PSS51P1B",57,0)
 I +$G(PSSIEN2)>0 D GETS^DIQ(51.1,+PSSIEN,".01","IE","^TMP($J,""PSS51P1""") D
"RTN","PSS51P1B",58,0)
 .S PSS(4)=0 F  S PSS(4)=$O(^TMP($J,"PSS51P1",51.1,PSS(4))) Q:'PSS(4)  D
"RTN","PSS51P1B",59,0)
 ..S ^TMP($J,LIST,+PSS(4),.01)=$G(^TMP($J,"PSS51P1",51.1,PSS(4),.01,"I")),CNT=CNT+1
"RTN","PSS51P1B",60,0)
 ..S ^TMP($J,LIST,"B",$G(^TMP($J,"PSS51P1",51.1,PSS(4),.01,"E")),+PSS(4))=""
"RTN","PSS51P1B",61,0)
 ..D GETS^DIQ(51.11,+PSSIEN2_","_+PSSIEN,".01;1","IE","^TMP($J,""PSS51P1""")
"RTN","PSS51P1B",62,0)
 ..S PSS(1)=+PSSIEN,(PSS(2),CNT1)=0 F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.11,PSS(2))) Q:'PSS(2)  D SETWARD^PSS51P1B S CNT1=CNT1+1
"RTN","PSS51P1B",63,0)
 ..S ^TMP($J,LIST,+PSSIEN,"WARD",0)=$S(CNT1>0:CNT1,1:"-1^NO DATA FOUND FOR PSSIEN2 #"_PSSIEN2)
"RTN","PSS51P1B",64,0)
 K ^TMP($J,"PSS51P1")
"RTN","PSS51P1B",65,0)
 Q
"RTN","PSS51P1B",66,0)
3 ;
"RTN","PSS51P1B",67,0)
 S PSSIEN=PSS(3) K ^TMP($J,"PSS51P1") D GETS^DIQ(51.1,+PSSIEN,".01;7*","IE","^TMP($J,""PSS51P1""") S (PSS(1),CNT1)=0 D
"RTN","PSS51P1B",68,0)
 .F  S PSS(1)=$O(^TMP($J,"PSS51P1",51.17,PSS(1))) Q:'PSS(1)  D SETLOC S CNT1=CNT1+1
"RTN","PSS51P1B",69,0)
 .S ^TMP($J,LIST,+PSSIEN,"HOSP",0)=$S(CNT1>0:CNT1,1:"-1^NO DATA FOUND")
"RTN","PSS51P1B",70,0)
 .S PSS(2)=0 F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.1,PSS(2))) Q:'PSS(2)  D
"RTN","PSS51P1B",71,0)
 ..S ^TMP($J,LIST,+PSS(2),.01)=$G(^TMP($J,"PSS51P1",51.1,PSS(2),.01,"I")),CNT=CNT+1
"RTN","PSS51P1B",72,0)
 ..S ^TMP($J,LIST,"B",$G(^TMP($J,"PSS51P1",51.1,PSS(2),.01,"E")),+PSS(2))=""
"RTN","PSS51P1B",73,0)
 K ^TMP($J,"PSS51P1")
"RTN","PSS51P1B",74,0)
 Q
"RTN","PSS51P1B",75,0)
4 ;
"RTN","PSS51P1B",76,0)
 S PSSIEN=PSS(3)
"RTN","PSS51P1B",77,0)
 D GETS^DIQ(51.1,+PSSIEN,".01;1","IE","PSS51P1")
"RTN","PSS51P1B",78,0)
 N PSSXX S PSSXX=0 F  S PSSXX=$O(PSS51P1(51.1,PSSXX)) Q:'PSSXX  D
"RTN","PSS51P1B",79,0)
 .S ^TMP($J,LIST,+PSSXX,.01)=$G(PSS51P1(51.1,PSSXX,.01,"E")),CNT=CNT+1
"RTN","PSS51P1B",80,0)
 .S ^TMP($J,LIST,"B",$G(PSS51P1(51.1,PSSXX,.01,"E")),+PSSXX)=""
"RTN","PSS51P1B",81,0)
 .S ^TMP($J,LIST,+PSSXX,1)=$G(PSS51P1(51.1,PSSXX,1,"E"))
"RTN","PSS51P1B",82,0)
 K PSS51P1
"RTN","PSS51P1B",83,0)
 Q
"RTN","PSS51P1B",84,0)
5 ;
"RTN","PSS51P1B",85,0)
 I $G(PSSPP)]"",$P($G(^PS(51.1,+PSS(3),0)),"^",4)'=$G(PSSPP) Q
"RTN","PSS51P1B",86,0)
 I $G(PSSTYP)]"",$P($G(^PS(51.1,+PSS(3),0)),"^",5)'[PSSTYP Q
"RTN","PSS51P1B",87,0)
 D FIND^DIC(51.1,,"@;.01;1;2;2.5;4;5IE;8","Q","`"_PSS(3),,,,"")
"RTN","PSS51P1B",88,0)
 N PSSXX S PSSXX=0 F  S PSSXX=$O(^TMP("DILIST",$J,"ID",PSSXX)) Q:'PSSXX  D
"RTN","PSS51P1B",89,0)
 .S PSSIEN=+PSS(3)
"RTN","PSS51P1B",90,0)
 .S CNT=CNT+1
"RTN","PSS51P1B",91,0)
 .S ^TMP($J,LIST,+PSSIEN,.01)=$G(^TMP("DILIST",$J,"ID",PSSXX,.01))
"RTN","PSS51P1B",92,0)
 .S ^TMP($J,LIST,"AP"_PSSPP,$G(^TMP("DILIST",$J,"ID",PSSXX,.01)),+PSSIEN)=""
"RTN","PSS51P1B",93,0)
 .S ^TMP($J,LIST,+PSSIEN,1)=$G(^TMP("DILIST",$J,"ID",PSSXX,1))
"RTN","PSS51P1B",94,0)
 .S ^TMP($J,LIST,+PSSIEN,2)=$G(^TMP("DILIST",$J,"ID",PSSXX,2))
"RTN","PSS51P1B",95,0)
 .S ^TMP($J,LIST,+PSSIEN,2.5)=$G(^TMP("DILIST",$J,"ID",PSSXX,2.5))
"RTN","PSS51P1B",96,0)
 .S ^TMP($J,LIST,+PSSIEN,4)=$G(^TMP("DILIST",$J,"ID",PSSXX,4))
"RTN","PSS51P1B",97,0)
 .S ^TMP($J,LIST,+PSSIEN,5)=$S($G(^TMP("DILIST",$J,"ID",PSSXX,5,"I"))="":"",1:$G(^TMP("DILIST",$J,"ID",PSSXX,5,"I"))_"^"_$G(^TMP("DILIST",$J,"ID",PSSXX,5,"E")))
"RTN","PSS51P1B",98,0)
 .S ^TMP($J,LIST,+PSSIEN,8)=$G(^TMP("DILIST",$J,"ID",PSSXX,8))
"RTN","PSS51P1B",99,0)
 .I +$G(PSSWDIEN)'>0 K ^TMP($J,"PSS51P1") D GETS^DIQ(51.1,+PSSIEN,".01;3*","IE","^TMP($J,""PSS51P1""") D
"RTN","PSS51P1B",100,0)
 ..S PSS(1)=+PSSIEN,(PSS(2),CNT1)=0 F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.11,PSS(2))) Q:'PSS(2)  D SETWARD^PSS51P1B S CNT1=CNT1+1
"RTN","PSS51P1B",101,0)
 ..S ^TMP($J,LIST,+PSSIEN,"WARD",0)=$S(CNT1>0:CNT1,1:-1_"^"_"NO DATA FOUND")
"RTN","PSS51P1B",102,0)
 .I +$G(PSSWDIEN)>0 K ^TMP($J,"PSS51P1") D GETS^DIQ(51.1,+PSSIEN,".01;3*","IE","^TMP($J,""PSS51P1""") D
"RTN","PSS51P1B",103,0)
 ..S (PSS(2),CNT1)=0 F  S PSS(2)=$O(^TMP($J,"PSS51P1",51.11,PSS(2))) Q:'PSS(2)  D
"RTN","PSS51P1B",104,0)
 ...I PSSWDIEN=$P($G(^TMP($J,"PSS51P1",51.11,PSS(2),.01,"I")),"^") D SETWRD2^PSS51P1B S CNT1=CNT1+1
"RTN","PSS51P1B",105,0)
 ..S ^TMP($J,LIST,+PSSIEN,"WARD",0)=$S(CNT1>0:CNT1,1:"-1^NO DATA FOUND FOR PSSWDIEN #"_PSSWDIEN)
"RTN","PSS51P1B",106,0)
 K ^TMP("DILIST",$J),^TMP($J,"PSS51P1")
"RTN","PSS51P1B",107,0)
 Q
"RTN","PSS51P1B",108,0)
 ;
"RTN","PSS51P1B",109,0)
6 ;
"RTN","PSS51P1B",110,0)
 I $G(PSSPP)]"",$P($G(^PS(51.1,+PSS(3),0)),"^",4)'=PSSPP Q
"RTN","PSS51P1B",111,0)
 K PSS51P1 D GETS^DIQ(51.1,+PSS(3),".01;1;2;2.5;4;5;6;8;8.1","IE","PSS51P1")
"RTN","PSS51P1B",112,0)
 N PSSXX S PSSXX=0 F  S PSSXX=$O(PSS51P1(51.1,PSSXX)) Q:'PSSXX  D
"RTN","PSS51P1B",113,0)
 .S ^TMP($J,LIST,+PSSXX,.01)=$G(PSS51P1(51.1,PSSXX,.01,"E")),CNT=CNT+1
"RTN","PSS51P1B",114,0)
 .S ^TMP($J,LIST,"AP"_PSSPP,$G(PSS51P1(51.1,PSSXX,.01,"E")),+PSSXX)=""
"RTN","PSS51P1B",115,0)
 .S ^TMP($J,LIST,+PSSXX,1)=$G(PSS51P1(51.1,PSSXX,1,"E"))
"RTN","PSS51P1B",116,0)
 .S ^TMP($J,LIST,+PSSXX,2)=$G(PSS51P1(51.1,PSSXX,2,"E"))
"RTN","PSS51P1B",117,0)
 .S ^TMP($J,LIST,+PSSXX,2.5)=$G(PSS51P1(51.1,PSSXX,2.5,"E"))
"RTN","PSS51P1B",118,0)
 .S ^TMP($J,LIST,+PSSXX,4)=$G(PSS51P1(51.1,PSSXX,4,"E"))
"RTN","PSS51P1B",119,0)
 .S ^TMP($J,LIST,+PSSXX,5)=$S($G(PSS51P1(51.1,PSSXX,5,"I"))]"":$G(PSS51P1(51.1,PSSXX,5,"I"))_"^"_$G(PSS51P1(51.1,PSSXX,5,"E")),1:"")
"RTN","PSS51P1B",120,0)
 .S ^TMP($J,LIST,+PSSXX,6)=$G(PSS51P1(51.1,PSSXX,6,"E"))
"RTN","PSS51P1B",121,0)
 .S ^TMP($J,LIST,+PSSXX,8)=$G(PSS51P1(51.1,PSSXX,8,"E"))
"RTN","PSS51P1B",122,0)
 .S ^TMP($J,LIST,+PSSXX,8.1)=$G(PSS51P1(51.1,PSSXX,8.1,"E"))
"RTN","PSS51P1B",123,0)
 K PSS51P1
"RTN","PSS51P1B",124,0)
 Q
"RTN","PSS52P7A")
0^9^B7958767
"RTN","PSS52P7A",1,0)
PSS52P7A ;BIR/LDT - API FOR INFORMATION FROM FILE 52.7; 5 Sep 03
"RTN","PSS52P7A",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91**;9/30/97
"RTN","PSS52P7A",3,0)
 ;
"RTN","PSS52P7A",4,0)
 ;
"RTN","PSS52P7A",5,0)
SETZERO ;
"RTN","PSS52P7A",6,0)
 S ^TMP($J,LIST,+PSS(1),.01)=$G(PSS52P7(52.7,PSS(1),.01,"I"))
"RTN","PSS52P7A",7,0)
 S ^TMP($J,LIST,"B",$G(PSS52P7(52.7,PSS(1),.01,"I")),+PSS(1))=""
"RTN","PSS52P7A",8,0)
 S ^TMP($J,LIST,+PSS(1),1)=$S($G(PSS52P7(52.7,PSS(1),1,"I"))="":"",1:PSS52P7(52.7,PSS(1),1,"I")_"^"_PSS52P7(52.7,PSS(1),1,"E"))
"RTN","PSS52P7A",9,0)
 S ^TMP($J,LIST,+PSS(1),2)=$G(PSS52P7(52.7,PSS(1),2,"I"))
"RTN","PSS52P7A",10,0)
 S ^TMP($J,LIST,+PSS(1),.02)=$G(PSS52P7(52.7,PSS(1),.02,"I"))
"RTN","PSS52P7A",11,0)
 S ^TMP($J,LIST,+PSS(1),7)=$G(PSS52P7(52.7,PSS(1),7,"I"))
"RTN","PSS52P7A",12,0)
 S ^TMP($J,LIST,+PSS(1),9)=$S($G(PSS52P7(52.7,PSS(1),9,"I"))="":"",1:PSS52P7(52.7,PSS(1),9,"I")_"^"_PSS52P7(52.7,PSS(1),9,"E"))
"RTN","PSS52P7A",13,0)
 S ^TMP($J,LIST,+PSS(1),17)=$S($G(PSS52P7(52.7,PSS(1),17,"I"))="":"",1:PSS52P7(52.7,PSS(1),17,"I")_"^"_PSS52P7(52.7,PSS(1),17,"E"))
"RTN","PSS52P7A",14,0)
 S ^TMP($J,LIST,+PSS(1),8)=$S($G(PSS52P7(52.7,PSS(1),8,"I"))="":"",1:PSS52P7(52.7,PSS(1),8,"I")_"^"_PSS52P7(52.7,PSS(1),8,"E"))
"RTN","PSS52P7A",15,0)
 Q
"RTN","PSS52P7A",16,0)
 ;
"RTN","PSS52P7A",17,0)
SETLTS ;
"RTN","PSS52P7A",18,0)
 S ^TMP($J,LIST,+PSSIEN,"ELYTES",+PSS(2),.01)=$S($G(PSS52P7(52.702,PSS(2),.01,"I"))="":"",1:PSS52P7(52.702,PSS(2),.01,"I")_"^"_PSS52P7(52.702,PSS(2),.01,"E"))
"RTN","PSS52P7A",19,0)
 S ^TMP($J,LIST,+PSSIEN,"ELYTES",+PSS(2),1)=$G(PSS52P7(52.702,PSS(2),1,"I"))
"RTN","PSS52P7A",20,0)
 Q
"RTN","PSS52P7A",21,0)
 ;
"RTN","PSS52P7A",22,0)
SETLOOK  ;
"RTN","PSS52P7A",23,0)
 S ^TMP($J,LIST,+PSS(1),.01)=$G(PSS52P7(52.7,PSS(1),.01,"I"))
"RTN","PSS52P7A",24,0)
 S ^TMP($J,LIST,"B",$G(PSS52P7(52.7,PSS(1),.01,"I")),+PSS(1))=""
"RTN","PSS52P7A",25,0)
 S ^TMP($J,LIST,+PSS(1),.02)=$G(PSS52P7(52.7,PSS(1),.02,"I"))
"RTN","PSS52P7A",26,0)
 S ^TMP($J,LIST,+PSS(1),2)=$G(PSS52P7(52.7,PSS(1),2,"I"))
"RTN","PSS52P7A",27,0)
 Q
"RTN","PSS52P7A",28,0)
 ;
"RTN","PSS52P7A",29,0)
LOOP(PSSLOOP) ;
"RTN","PSS52P7A",30,0)
 N CNT,PSSIEN S CNT=0
"RTN","PSS52P7A",31,0)
 S PSSIEN=0  F  S PSSIEN=$O(^PS(52.7,PSSIEN)) Q:'PSSIEN  D @(PSSLOOP)
"RTN","PSS52P7A",32,0)
 S ^TMP($J,LIST,0)=$S(CNT>1:CNT,1:"-1^NO DATA FOUND")
"RTN","PSS52P7A",33,0)
 Q
"RTN","PSS52P7A",34,0)
1 ;
"RTN","PSS52P7A",35,0)
 N CNT2
"RTN","PSS52P7A",36,0)
 I $G(PSSFL) S ND=$P($G(^PS(52.7,+PSSIEN,"I")),U) I ND,+ND'>PSSFL Q
"RTN","PSS52P7A",37,0)
 D GETS^DIQ(52.7,+PSSIEN,".01;1;2;.02;7;8;9;17","IE","PSS52P7") S PSS(1)=0
"RTN","PSS52P7A",38,0)
 F  S PSS(1)=$O(PSS52P7(52.7,PSS(1))) Q:'PSS(1)  D SETZERO S CNT=CNT+1 D
"RTN","PSS52P7A",39,0)
 .K PSS52P7 D GETS^DIQ(52.7,+PSSIEN,"4*","IE","PSS52P7") S (PSS(2),CNT2)=0
"RTN","PSS52P7A",40,0)
 .F  S PSS(2)=$O(PSS52P7(52.702,PSS(2))) Q:'PSS(2)  D SETLTS S CNT2=CNT2+1
"RTN","PSS52P7A",41,0)
 .S ^TMP($J,LIST,+PSSIEN,"ELYTES",0)=$S(CNT2>0:CNT2,1:"-1^NO DATA FOUND")
"RTN","PSS52P7A",42,0)
 Q
"RTN","PSS52P7A",43,0)
 ;
"RTN","PSS52P7A",44,0)
2 ;
"RTN","PSS52P7A",45,0)
 K PSS52P7 D GETS^DIQ(52.7,+PSSIEN,".01;2;.02","IE","PSS52P7") S PSS(1)=0
"RTN","PSS52P7A",46,0)
 F  S PSS(1)=$O(PSS52P7(52.7,PSS(1))) Q:'PSS(1)  D SETLOOK S CNT=CNT+1
"RTN","PSS52P7A",47,0)
 Q
"RTN","PSSDI")
0^7^B14252092
"RTN","PSSDI",1,0)
PSSDI ;BIR/LDT - API FOR FILEMAN CALLS; 5 Sep 03
"RTN","PSSDI",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**85,91**;9/30/97
"RTN","PSSDI",3,0)
 ;
"RTN","PSSDI",4,0)
DIC(PSSFILE,PSSAPP,DIC,X,DLAYGO) ;
"RTN","PSSDI",5,0)
 S PSSDIY=""
"RTN","PSSDI",6,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 Q
"RTN","PSSDI",7,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",8,0)
 I 'PSRTEST S PSSDIY=-1 Q
"RTN","PSSDI",9,0)
 I '$P(PSRTEST,"^",2) K DLAYGO I $G(DIC(0))'="" S DIC(0)=$TR(DIC(0),"L","") I $G(DIC(0))="" S PSSDIY=-1
"RTN","PSSDI",10,0)
 K DTOUT,DUOUT D ^DIC
"RTN","PSSDI",11,0)
 Q
"RTN","PSSDI",12,0)
DO(PSSFILE,PSSAPP,DIC) ;
"RTN","PSSDI",13,0)
 S PSSDIY=""
"RTN","PSSDI",14,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 Q
"RTN","PSSDI",15,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",16,0)
 I 'PSRTEST S PSSDIY=-1 Q
"RTN","PSSDI",17,0)
 K DTOUT,DUOUT D DO^DIC1
"RTN","PSSDI",18,0)
 Q
"RTN","PSSDI",19,0)
IX(PSSFILE,PSSAPP,DIC,D,X,DLAYGO) ;
"RTN","PSSDI",20,0)
 S PSSDIY=""
"RTN","PSSDI",21,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 Q
"RTN","PSSDI",22,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",23,0)
 I 'PSRTEST S PSSDIY=-1 Q
"RTN","PSSDI",24,0)
 I '$P(PSRTEST,"^",2) K DLAYGO I $G(DIC(0))'="" S DIC(0)=$TR(DIC(0),"L","") I $G(DIC(0))="" S PSSDIY=-1
"RTN","PSSDI",25,0)
 K DTOUT,DUOUT D IX^DIC
"RTN","PSSDI",26,0)
 Q
"RTN","PSSDI",27,0)
MIX(PSSFILE,PSSAPP,DIC,D,X,DLAYGO) ;
"RTN","PSSDI",28,0)
 S PSSDIY=""
"RTN","PSSDI",29,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 Q
"RTN","PSSDI",30,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",31,0)
 I 'PSRTEST S PSSDIY=-1 Q
"RTN","PSSDI",32,0)
 I '$P(PSRTEST,"^",2) K DLAYGO I $G(DIC(0))'="" S DIC(0)=$TR(DIC(0),"L","") I $G(DIC(0))="" S PSSDIY=-1
"RTN","PSSDI",33,0)
 K DTOUT,DUOUT D MIX^DIC1
"RTN","PSSDI",34,0)
 Q
"RTN","PSSDI",35,0)
FILE(PSSFILE,PSSAPP,DIC,DA,X,DINUM,DLAYGO) ;
"RTN","PSSDI",36,0)
 S PSSDIY=""
"RTN","PSSDI",37,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 Q
"RTN","PSSDI",38,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",39,0)
 I 'PSRTEST S PSSDIY=-1 Q
"RTN","PSSDI",40,0)
 I '$P(PSRTEST,"^",2) S PSSDIY=-1 Q
"RTN","PSSDI",41,0)
 K DTOUT,DUOUT,DO D FILE^DICN
"RTN","PSSDI",42,0)
 Q
"RTN","PSSDI",43,0)
DIE(PSSFILE,PSSAPP,DIE,DA,DR,DIDEL) ;
"RTN","PSSDI",44,0)
 S PSSDIY=""
"RTN","PSSDI",45,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 Q
"RTN","PSSDI",46,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",47,0)
 I 'PSRTEST S PSSDIY=-1 Q
"RTN","PSSDI",48,0)
 I '$P(PSRTEST,"^",2) S PSSDIY=-1 Q
"RTN","PSSDI",49,0)
 K DTOUT D ^DIE
"RTN","PSSDI",50,0)
 Q
"RTN","PSSDI",51,0)
EN1(PSSFILE,PSSAPP,DIC,L,FLDS,BY,FR,TO,DHD) ;
"RTN","PSSDI",52,0)
 S PSSDIY=""
"RTN","PSSDI",53,0)
 I +$G(PSSFILE)'>0 S PSSDIY=-1 Q
"RTN","PSSDI",54,0)
 N PSRTEST S PSRTEST=$$TEST(PSSFILE)
"RTN","PSSDI",55,0)
 I 'PSRTEST S PSSDIY=-1 Q
"RTN","PSSDI",56,0)
 D EN1^DIP
"RTN","PSSDI",57,0)
 Q
"RTN","PSSDI",58,0)
TEST(PSTFILE) ;
"RTN","PSSDI",59,0)
 N CNT,PSSAPP2,PSFFLAG,PSFLOOP,PSFTEST,PSLNODE,PSRSLT S PSRSLT="0^0",PSFFLAG=0
"RTN","PSSDI",60,0)
 F PSFLOOP=1:1 S PSFTEST=$P($T(FILE2+PSFLOOP),";;",2) Q:PSFTEST=""!PSFFLAG  I +PSFTEST=PSTFILE S $P(PSRSLT,"^")=1 S PSLNODE=$T(FILE2+PSFLOOP) D
"RTN","PSSDI",61,0)
 .F CNT=2:1:$L(PSLNODE,";;") S PSSAPP2=$P(PSLNODE,";;",CNT) Q:$P(PSRSLT,"^",2)=1  I PSSAPP2=$G(PSSAPP) S PSFFLAG=1,$P(PSRSLT,"^",2)=1
"RTN","PSSDI",62,0)
 Q PSRSLT
"RTN","PSSDI",63,0)
 ;
"RTN","PSSDI",64,0)
FILE2 ;For DIC call, IF PACKAGE IS LISTED, PACKAGE HAS WRITE ACCESS          
"RTN","PSSDI",65,0)
 ;;50;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",66,0)
 ;;50.1;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",67,0)
 ;;50.0214;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",68,0)
 ;;50.037;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",69,0)
 ;;50.065;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",70,0)
 ;;50.0212;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",71,0)
 ;;50.0441;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",72,0)
 ;;50.01;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",73,0)
 ;;50.02;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",74,0)
 ;;50.0903;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",75,0)
 ;;50.0904;;PSX;;PSD;;PSJ;;PSN;;PSO;;PSGW;;PSS
"RTN","PSSDI",76,0)
 ;;50.4;;PSJ;;PSS
"RTN","PSSDI",77,0)
 ;;50.606;;PSJ;;PSN;;PSS
"RTN","PSSDI",78,0)
 ;;50.7;;PSJ;;PSO;;PSN;;PSS
"RTN","PSSDI",79,0)
 ;;50.76;;PSJ;;PSO;;PSN;;PSS
"RTN","PSSDI",80,0)
 ;;50.72;;PSJ;;PSO;;PSN;;PSS
"RTN","PSSDI",81,0)
 ;;51;;PSJ;;PSS
"RTN","PSSDI",82,0)
 ;;51.01;;PSJ;;PSS
"RTN","PSSDI",83,0)
 ;;51.1;;PSJ;;PSS
"RTN","PSSDI",84,0)
 ;;51.11;;PSJ;;PSS
"RTN","PSSDI",85,0)
 ;;51.17;;PSJ;;PSS
"RTN","PSSDI",86,0)
 ;;51.2;;PSJ;;PSS
"RTN","PSSDI",87,0)
 ;;51.5;;PSS
"RTN","PSSDI",88,0)
 ;;52.6;;PSJ;;PSN;;PSS
"RTN","PSSDI",89,0)
 ;;52.61;;PSJ;;PSN;;PSS
"RTN","PSSDI",90,0)
 ;;52.62;;PSJ;;PSN;;PSS
"RTN","PSSDI",91,0)
 ;;52.63;;PSJ;;PSN;;PSS
"RTN","PSSDI",92,0)
 ;;52.64;;PSJ;;PSN;;PSS
"RTN","PSSDI",93,0)
 ;;52.7;;PSJ;;PSN;;PSS
"RTN","PSSDI",94,0)
 ;;52.702;;PSJ;;PSN;;PSS
"RTN","PSSDI",95,0)
 ;;52.703;;PSJ;;PSN;;PSS
"RTN","PSSDI",96,0)
 ;;52.704;;PSJ;;PSN;;PSS
"RTN","PSSDI",97,0)
 ;;54;;PSS;;PSO
"RTN","PSSDI",98,0)
 ;;54.1;;PSS;;PSO
"RTN","PSSDI",99,0)
 ;;9009032.3;;PSS
"RTN","PSSDI",100,0)
 ;;9009032.5;;PSS
"RTN","PSSDI",101,0)
 Q
"VER")
8.0^22.0
**END**
**END**
