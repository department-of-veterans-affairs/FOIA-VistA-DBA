$TXT Created by WANG,MARK at SUPPORT.ISC-SLC.VA.GOV  (KIDS) on MONDAY, 05/01/00 at 16:55
=============================================================================
Run Date: MAY 02, 2000                     Designation: OSI*2*12
Package : OSI - OS-OPENM                       Priority: Mandatory
Version : 2        SEQ #11                      Status: Released
=============================================================================


Subject: Updated Avanti Backup Procedures

Category: 
  - Routine

Description: 
============

 **THIS PATCH IS FOR AVANTI (Windows NT/Intersystems Cache) SITES
   RUNNING CACHE VERSION 2.1.6 OR 2.1.9 ONLY**
  
 This patch contains a Kids Build to import the routine NVSMSG.  Also
 included in this patch is a separate hostfile OSI2_12_SYS.RSA containing 
 the routines BACKIRM and DBACK*.  This file has been placed in the HINES 
 Anonymous directory under the \AVANTI\BACKUP folder.  This file should be 
 retrieved using ASCII format.  The IP Address for the Hines Anonymous 
 directory is 152.129.1.110.
  
 Routine Description:
  
 After installation of this patch, the second line of the routines will
 look like the following:
  
         ;;2.0;NVS system management utility;**patch list**; Jan 01, 1999
  
                         Checksums       
         Routine     Before      After      Patch List
         -------     ------      -----      ----------
         NVS12PRE    n/a         1715933    n/a (pre-installation)
         NVSMSG      6419975     6390248    **11,12**
         BACKIRM     n/a         n/a        (OS routine)
         DBACK       n/a         n/a        (OS routine)
         DBACKA      n/a         n/a        (OS routine)
         DBACKB      n/a         n/a        (OS routine)
  
 Brief description of changes:
  
 BACKIRM Routine:
  
 1) The Backup Log Filename has been modified to include both date and
    time.  This change will prevent a backup log from being overwitten  
    if multiple backups are performed within the same day.
  
       example:  04282000_180005.LOG
  
 2) A new line tag 'JRN' has been added to allow for Journal files to
    be backed up separately.  The line tag can be called interactively
    and will perform a tape backup of the Journal files stored in
    X:\JOURNAL to the TLZ09 (4mm).
  
       >D JRN^BACKIRM
  
 3) The backup log filename for separate Journal file backups will 
    include the letter 'J' to distinguish this type of backup from a 
    full backup.
  
       example:  04282000_180005_J.LOG
  
 4) The process for Journal file deletion has been changed to call
    the Cache utility DELFILE^JRNUTIL.  In addition to file deletion,
    this utility will also cleanup/maintain journal history stored
    in the ^SYS global.
  
 5) The $zsearch and current journal comparison code that is used to 
    identify journal files for backup/deletion has been changed to make 
    it case-insensitive.
  
 6) Additional Error Checking code has been included to capture and
    display Cache error conditions.
  
     WARNING: *** (-3,Unable to create journal file) ***
  
 7) The list of Journal files being deleted has been included in the
    Backup log to allow for comparison with Journal files that were
    backed up.
  
 NVS12PRE Routine:
  
    Patch OSI*2.0*11 included the pre-installation routine NVS11PRE that
    updated the VERSION field of the Package file entry for the OS-OPENM
    package, but neglected to equally update the CURRENT VERSION field.
    This OSI*2.0*12 pre-installation will update that field to version
    2 as well.
  
 NVSMSG Routine:
  
 1) The Subject Header in the Backup Procedure Mail Message had been
    modified to display both date and time.
  
       example:  BACKUP PROCEDURE 04/19/2000@1048
  
  
  
 Installation:
  
 No special system considerations are necessary during the installation of
 this patch other than it should not be installed while the backup procedure
 is running.  Users can be on the system during the installation of this 
 patch.
  
 Step 1: Install the BACKIRM Routine
 -----------------------------------
  
 Use ftp to retrieve the OSI2_12_SYS.RSA file from the Hines ftp server.
 This file contains the BACKIRM and DBACK* routines.  Make sure to 
 download the file using ASCII format, and save it in your 
 t:\anonymous directory.
  
 This file can be retrieved by logging on anonymous at the Hines ftp
 server at 152.129.1.110\avanti\backup.
  
 To ftp the file from a command prompt window:
  Example (your input is in brackets [] )
  
 C:\>[ftp 152.129.1.110]
 Connected to 152.129.1.110.
 220 ISC4A1 FTP Server (Version 4.2) Ready.
 User (152.129.1.110:(none)): [anonymous]
 331 Guest login OK, send ident as password.
 Password:  [enter your email address]
 230 Guest login OK, access restrictions apply.
 ftp> [cd avanti]
 250-CWD command successful.
 250 New default directory is VA1$:[ANONYMOUS.AVANTI]
 ftp> [cd backup]
 250-CWD command successful.
 250 New default directory is VA1$:[ANONYMOUS.AVANTI.BACKUP]
 ftp> [lcd t:\anonymous]   <---local change directory
 Local directory now T:\Anonymous
 ftp> [ascii]
 200 TYPE set to ASCII.
 ftp> [get osi2_12_sys.rsa]
 200 PORT command successful.
 150 Opening data connection for VA1$:[ANONYMOUS.AVANTI.BACKUP]OSI2_12_SYS.R
 (152.131.2.12,2415)
 226 Transfer complete.
 12233 bytes received in 0.57 seconds (21.46 Kbytes/sec)
 ftp> [bye]
 221 Goodbye.
  
 C:\>
  
  
 In the %SYS namespace, use the ^%RI utility to restore the routines in
 OSI2_12_sys.rsa file.  Example (your input is in  brackets [ ] ):
  
 %SYS>[D ^%RI]
  
 Input routines from Sequential
 Device: [t:\anonymous\osi2_12_sys.rsa]   Parameters: ("R")=> [press 'enter']
  
 File written by Cache for Windows NT using %RO on 02 May 2000  12:56 PM
 with extension INT and with description:
 Updated Avanti Backup Procedures - BACKIRM/DBACK* - OSI*2*12
  
 ( All Select Enter List Quit )
  
 Routine Input Option: [A]ll Routines
  
 If a selected routine has the same name as one already on file,
 shall it replace the one on file? No => [Y]es
 Recompile? Yes => [Y]es
 Display Syntax Errors? Yes => [Y]es
  
 ^ indicates routines which will replace those now on file.
 @ indicates routines which have been [re]compiled.
 - indicates routines which have not been filed.
  
  
 BACKIRM.INT^@   DBACK.INT^@     DBACKA.INT^@    DBACKB.INT^@    
  
 4 routines saved.
  
 Step 2: Installing Kid Build
 ----------------------------
  
 Log into the VAH namespace to install the rest of this patch.  Users
 can be on the system when this patch is installed.  No options or
 processes need to be stopped or paused during installation.  Menu trees do
 NOT need to be rebuilt after installation.
  
 1.  On the PackMan menu, use the 'INSTALL/CHECK MESSAGE' option.  This
 loads the patch into a Transport Global on your system.
  
 2.  On the KIDS Installation menu, use the following options to install
 the Transport Global:
  
        Verify Checksums in Transport Global
        Print Transport Global
        Compare Transport Global to Current System
        Backup a Transport Global
        Install Package(s)
  
  Select INSTALL NAME:    OSI*2.0*12    Loaded from Distribution
 <date/time>              ==========
  
 Install Questions for OSI*2.0*12
  
 Want KIDS to INHIBIT LOGONs during the install? YES// NO
                                                       ==
 Want to DISABLE Scheduled Options, Menu Options, and Protocols? YES// NO
                                                                       ==
  
                                    OSI*2.0*12                                   
  
  Install Started for OSI*2.0*12 : 
                May 01, 2000@09:31:44
  
 Build Distribution Date: Apr 27, 2000
  
  Installing Routines:
                May 01, 2000@09:31:44
  
  Updating Routine file...
  
  Updating KIDS files...
  
  OSI*2.0*12 Installed. 
                May 01, 2000@09:31:45
  
  Install Message sent #4059512
  
 --------------------------------------------------------------------------
           +------------------------------------------------------------+
   100%    |             25             50             75               |
 Complete  +------------------------------------------------------------+
  
  
  
  
  
 Install Completed

Routine Information:
====================

Routine Name:
  - NVSMSG


Routine Checksum:
Checksum from ^XTSUMBLD = 6390248 

Routine Name:
  - NVS12PRE


Routine Checksum:
Checksum from ^XTSUMBLD = 1715933

=============================================================================
User Information:                               
Entered By  : WANG,MARK                      Date Entered : JAN 12, 2000
Completed By: BOGGESS,MIKE                  Date Completed: MAY 02, 2000
Released By : MROWCZYNSKI,EDWARD            Date Released : MAY 02, 2000
=============================================================================


Packman Mail Message:
=====================

$END TXT
