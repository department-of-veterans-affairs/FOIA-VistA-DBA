$TXT Created by ORMSBY,SKIP at FM22-PATCH.FO-OAKLAND.MED.VA.GOV  (KIDS) on Monday, 04/10/06 at 12:59
=============================================================================
Run Date: MAY 03, 2006                     Designation: DI*22*148
Package : DI - VA FILEMAN                     Priority: Mandatory
Version : 22       SEQ #130                     Status: Released
                  Compliance Date: JUN 03, 2006
=============================================================================

Associated patches: (v)DI*22*145   <<= must be installed BEFORE `DI*22*148'

Subject: Browser and Cache WINDOWS version

Category: 
  - Routine

Description:
============

 This patch corrects the following issues:
  
  a.  When opening up the Browser device, the file name was not unique, 
 therefore multiple openings could cause display corruption.  The PRE-OPEN 
 EXECUTE(#19.7) field in the DEVICE (#3.5) file has been altered so that
 the value of $Job will be concatenated to the end of the standard file
 name: DDBR.
  
  b.  Because the Browser's HFS file were not being deleted when the
 Browser was finished with the file, code was placed in routine DDBRZIS,
 sub-routine POST to delete the file and all previous versions.  The 
 assumption was that all VistA sites were using Cache VMS, since there are 
 various versions of Cache in the field, the code in routine DDBRZIS
 has been commented and the code moved to the POST-CLOSE EXECUTE(#19.8)
 field in the DEVICE (#3.5) file for the Browser device.
  
 Routine: DIPOS148 Business Rules
 ================================
 a.  Is there an exact match in the DEVICE(#3.5) file equal to BROWSER?
   No: Install message: "Not able to find device named: BROWSER, no 
       editing preformed." is displayed and the post install Quits.
   Yes: Go to "b."
  
 b.  Does ^%ZOSF("OS") contain "OpenM"?
   No: Install message: "Not "OpenM", setting only the PRE-OPEN 
       EXECUTE(#19.7)." is displayed, the edit of the PRE-OPEN 
       EXECUTE(#19.7) field in the DEVICE (#3.5) file is preformed and the
       post install Quits.
   Yes: Go to "c."
  
 c.  Does $ZV contain "VMS" or "Windows"?
   No: The edit of the PRE-OPEN EXECUTE(#19.7) field is preformed and the
       post install Quits.
   Yes: Install message: "Setting POST-CLOSE EXECUTE(#19.8).", the edit of 
        the PRE-OPEN EXECUTE(#19.7) and POST-CLOSE EXECUTE(#19.8) fields in
        the DEVICE (#3.5) file is preformed and the post install Quits.
  
 In all cases when the post install Quits, the install message: "Finished  
 post install DI*22*148." is displayed.
  
 Other OS Note: The Cache command that does the file deletion is:
  S X=$ZF(-1,"del "_IO("CLOSE")_$S(X["VMS":";*",1:""))
  
 A Typical BROWSER Device Before Patch
 =====================================
 PRE-OPEN EXECUTE
 ================
  I '$$TEST^DDBRT S %ZISQUIT=1 W $C(7),!,"Browser not selectable from 
 current terminal.",!
  
 POST-CLOSE EXECUTE
 ==================
  D POST^DDBRZIS
  
 A Typical BROWSER Device After Patch
 ====================================
 PRE-OPEN EXECUTE
 ================
  N X S X=$$TEST^DDBRT S:X IO=$P(IO,".TXT")_$J_".TXT" I 'X S %
 ZISQUIT=1,X="Browser not selectable from current terminal." W $C(7),!,X
  
 POST-CLOSE EXECUTE
 ==================
  D POST^DDBRZIS I ^%ZOSF("OS")["OpenM",$G(IO("CLOSE"))'="" N X S
 X=$ZV,X=$ZF(-1,"del "_IO("CLOSE")_$S(X["VMS":";*",1:""))
  
 Documentation Changes
 =====================
  -None-
  
 Blood Bank Clearance
 ====================
 Clearance - April 10, 2006
 EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch DI*22*148 contains 
 changes to a package referenced in VHA OI SEPG SOP 192-023 Review of 
 VISTA Patches for Effects on VISTA Blood Bank Software. This patch does 
 not alter or modify any VistA Blood Bank software design safeguards or 
 safety critical elements functions.
  
 RISK ANALYSIS: Changes made by patch DI*22*148 have no effect on Blood 
 Bank software functionality, therefore RISK is none.
  
 Remedy Ticket
 =============
  136836
  
 Thanks to Test Sites 
 ====================
 BILOXI, MS (C)
 BLACK HILLS HCS
 LITTLE ROCK, AR (C)
 NORTHERN CALIFORNIA HCS
 ST CLOUD, MN
  
 Routine Summary: 
 ================
 CHECK^XTSUMBLD
   Routine Name   Before Patch    After Patch     Patch List 
   ============   ============    ===========     ==========
   DDBRZIS        2273544         2052660         145,148
   DIPOS148       **NEW**         3769883         148
  
 CHECK1^XTSUMBLD
 ===============
  See the "Routine Information" section for details.  The "B" in front of 
 the checksum denotes that the value was derived by using CHECK1^XTSUMBLD.
  
 Installation Instructions: 
 ==========================
 This patch can be installed with VISTA users online.  However, it is 
 recommended that it be Queued for a time of generally least activity.  
  
 TaskMan does not need to be STOPPED or placed in a WAIT state and 
 installation should take less than a minute.
  
      1.  Use the 'INSTALL/CHECK MESSAGE' option on the PackMan menu.  
 This option will load the KIDS package onto your system.  
  
      2.  The patch has now been loaded into a transport global on your 
 system. You now need to use KIDS to install the transport global.  
   
      3.  On the KIDS menu, under the 'Installation' menu, use the 
 following options: 
             Print Transport Global 
             Compare Transport Global to Current System 
             Verify Checksums in Transport Global 
             Backup a Transport Global 
  
      4.  On the KIDS menu, under the 'Installation' menu, use the 
 following option: 
             Select Installation Option: Install Package(s) 
             Select INSTALL NAME: DI*22.0*148
                                  ===========
         Answer 'NO' to 'Want KIDS to INHIBIT LOGONs during the install?
         Answer 'NO' to 'Want to DISABLE Scheduled Options, Menu Options,
 and Protocols? 

Routine Information:
====================
The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DDBRZIS
    Before:  B5079022  After:  B4633204  **145,148**
Routine Name: DIPOS148
    Before:       n/a  After:  B4979574  **148**

=============================================================================
User Information:
Entered By  : ORMSBY,SKIP                   Date Entered  : APR 09, 2006
Completed By: SINGH,GURBIR                  Date Completed: MAY 02, 2006
Released By : HARROD,PAUL                   Date Released : MAY 03, 2006
=============================================================================


Packman Mail Message:
=====================

$END TXT
