Released GMRV*5*1 SEQ #1
Extracted from mail message
**KIDS**:GMRV*5.0*1^

**INSTALL NAME**
GMRV*5.0*1
"BLD",4091,0)
GMRV*5.0*1^GEN. MED. REC. - VITALS^0^3031009^y
"BLD",4091,1,0)
^^2^2^3021129^^^^
"BLD",4091,1,1,0)
Please read the GMRV*5*1 patch description on FORUM for an explanation of
"BLD",4091,1,2,0)
what this patch does.
"BLD",4091,4,0)
^9.64PA^^
"BLD",4091,"ABNS",0)
^9.66A^^
"BLD",4091,"ABPKG")
^n
"BLD",4091,"INIT")
GMV1PST
"BLD",4091,"KRN",0)
^9.67PA^8989.52^19
"BLD",4091,"KRN",.4,0)
.4
"BLD",4091,"KRN",.401,0)
.401
"BLD",4091,"KRN",.402,0)
.402
"BLD",4091,"KRN",.403,0)
.403
"BLD",4091,"KRN",.5,0)
.5
"BLD",4091,"KRN",.84,0)
.84
"BLD",4091,"KRN",3.6,0)
3.6
"BLD",4091,"KRN",3.8,0)
3.8
"BLD",4091,"KRN",9.2,0)
9.2
"BLD",4091,"KRN",9.8,0)
9.8
"BLD",4091,"KRN",9.8,"NM",0)
^9.68A^17^16
"BLD",4091,"KRN",9.8,"NM",1,0)
GMVLAT0^^0^B30381121
"BLD",4091,"KRN",9.8,"NM",2,0)
GMVUTL8^^0^B2694671
"BLD",4091,"KRN",9.8,"NM",3,0)
GMVCLIN^^0^B7602247
"BLD",4091,"KRN",9.8,"NM",4,0)
GMVHB3^^0^B1133091
"BLD",4091,"KRN",9.8,"NM",5,0)
GMVRPCM^^0^B67999927
"BLD",4091,"KRN",9.8,"NM",6,0)
GMVRPCP^^0^B24862995
"BLD",4091,"KRN",9.8,"NM",7,0)
GMVTBL0^^1^
"BLD",4091,"KRN",9.8,"NM",8,0)
GMVTBL1^^1^
"BLD",4091,"KRN",9.8,"NM",9,0)
GMVTBL2^^1^
"BLD",4091,"KRN",9.8,"NM",10,0)
GMVTBL3^^1^
"BLD",4091,"KRN",9.8,"NM",11,0)
GMVTBL4^^1^
"BLD",4091,"KRN",9.8,"NM",12,0)
GMVGR1^^0^B35949185
"BLD",4091,"KRN",9.8,"NM",13,0)
GMVUTL5^^1^
"BLD",4091,"KRN",9.8,"NM",15,0)
GMVGETD2^^0^B21008972
"BLD",4091,"KRN",9.8,"NM",16,0)
GMV1PST^^0^B1300794
"BLD",4091,"KRN",9.8,"NM",17,0)
GMVUTL1^^0^B4892410
"BLD",4091,"KRN",9.8,"NM","B","GMV1PST",16)

"BLD",4091,"KRN",9.8,"NM","B","GMVCLIN",3)

"BLD",4091,"KRN",9.8,"NM","B","GMVGETD2",15)

"BLD",4091,"KRN",9.8,"NM","B","GMVGR1",12)

"BLD",4091,"KRN",9.8,"NM","B","GMVHB3",4)

"BLD",4091,"KRN",9.8,"NM","B","GMVLAT0",1)

"BLD",4091,"KRN",9.8,"NM","B","GMVRPCM",5)

"BLD",4091,"KRN",9.8,"NM","B","GMVRPCP",6)

"BLD",4091,"KRN",9.8,"NM","B","GMVTBL0",7)

"BLD",4091,"KRN",9.8,"NM","B","GMVTBL1",8)

"BLD",4091,"KRN",9.8,"NM","B","GMVTBL2",9)

"BLD",4091,"KRN",9.8,"NM","B","GMVTBL3",10)

"BLD",4091,"KRN",9.8,"NM","B","GMVTBL4",11)

"BLD",4091,"KRN",9.8,"NM","B","GMVUTL1",17)

"BLD",4091,"KRN",9.8,"NM","B","GMVUTL5",13)

"BLD",4091,"KRN",9.8,"NM","B","GMVUTL8",2)

"BLD",4091,"KRN",19,0)
19
"BLD",4091,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",4091,"KRN",19,"NM",1,0)
GMV V/M GUI^^0
"BLD",4091,"KRN",19,"NM","B","GMV V/M GUI",1)

"BLD",4091,"KRN",19.1,0)
19.1
"BLD",4091,"KRN",101,0)
101
"BLD",4091,"KRN",409.61,0)
409.61
"BLD",4091,"KRN",771,0)
771
"BLD",4091,"KRN",870,0)
870
"BLD",4091,"KRN",8989.51,0)
8989.51
"BLD",4091,"KRN",8989.52,0)
8989.52
"BLD",4091,"KRN",8994,0)
8994
"BLD",4091,"KRN",8994,"NM",0)
^9.68A^2^2
"BLD",4091,"KRN",8994,"NM",1,0)
GMV GET VITAL TYPE IEN^^0
"BLD",4091,"KRN",8994,"NM",2,0)
GMV GET CATEGORY IEN^^0
"BLD",4091,"KRN",8994,"NM","B","GMV GET CATEGORY IEN",2)

"BLD",4091,"KRN",8994,"NM","B","GMV GET VITAL TYPE IEN",1)

"BLD",4091,"KRN","B",.4,.4)

"BLD",4091,"KRN","B",.401,.401)

"BLD",4091,"KRN","B",.402,.402)

"BLD",4091,"KRN","B",.403,.403)

"BLD",4091,"KRN","B",.5,.5)

"BLD",4091,"KRN","B",.84,.84)

"BLD",4091,"KRN","B",3.6,3.6)

"BLD",4091,"KRN","B",3.8,3.8)

"BLD",4091,"KRN","B",9.2,9.2)

"BLD",4091,"KRN","B",9.8,9.8)

"BLD",4091,"KRN","B",19,19)

"BLD",4091,"KRN","B",19.1,19.1)

"BLD",4091,"KRN","B",101,101)

"BLD",4091,"KRN","B",409.61,409.61)

"BLD",4091,"KRN","B",771,771)

"BLD",4091,"KRN","B",870,870)

"BLD",4091,"KRN","B",8989.51,8989.51)

"BLD",4091,"KRN","B",8989.52,8989.52)

"BLD",4091,"KRN","B",8994,8994)

"BLD",4091,"QUES",0)
^9.62^^
"BLD",4091,"REQB",0)
^9.611^^
"INIT")
GMV1PST
"KRN",19,10377,-1)
0^1
"KRN",19,10377,0)
GMV V/M GUI^Vitals/Measurements GUI Application^^B^^^^^^^^GEN. MED. REC. - VITALS
"KRN",19,10377,1,0)
^19.06^1^1^3020326^^^^
"KRN",19,10377,1,1,0)
This option controls access to the GUI Vitals/Measurements application.
"KRN",19,10377,99.1)
59298,31347
"KRN",19,10377,"RPC",0)
^19.05P^129^109
"KRN",19,10377,"RPC",78,0)
GMV MANAGER
"KRN",19,10377,"RPC",81,0)
GMV ADD VM
"KRN",19,10377,"RPC",83,0)
GMV ALLERGY
"KRN",19,10377,"RPC",86,0)
GMV CLINIC PT
"KRN",19,10377,"RPC",87,0)
GMV CONVERT DATE
"KRN",19,10377,"RPC",89,0)
GMV CUMULATIVE REPORT
"KRN",19,10377,"RPC",91,0)
GMV ENTERED IN ERROR-PATIENT
"KRN",19,10377,"RPC",92,0)
GMV EXTRACT REC
"KRN",19,10377,"RPC",93,0)
GMV GET CURRENT TIME
"KRN",19,10377,"RPC",101,0)
GMV LATEST VITALS BY LOCATION
"KRN",19,10377,"RPC",102,0)
GMV LATEST VITALS FOR PATIENT
"KRN",19,10377,"RPC",103,0)
GMV LATEST VM
"KRN",19,10377,"RPC",105,0)
GMV MARK ERROR
"KRN",19,10377,"RPC",108,0)
GMV PT GRAPH
"KRN",19,10377,"RPC",110,0)
GMV PTSELECT
"KRN",19,10377,"RPC",111,0)
GMV QUALIFIER TABLE
"KRN",19,10377,"RPC",112,0)
GMV ROOM/BED
"KRN",19,10377,"RPC",116,0)
GMV TEAM PATIENTS
"KRN",19,10377,"RPC",118,0)
GMV V/M ALLDATA
"KRN",19,10377,"RPC",119,0)
GMV VITALS/CAT/QUAL
"KRN",19,10377,"RPC",120,0)
GMV WARD LOCATION
"KRN",19,10377,"RPC",121,0)
GMV WARD PT
"KRN",19,10377,"RPC",122,0)
GMV WARD/ROOM PATIENTS
"KRN",19,10377,"RPC",123,0)
GMV USER
"KRN",19,10377,"RPC",124,0)
GMV NUR UNIT PT
"KRN",19,10377,"RPC",125,0)
GMV CHECK DEVICE
"KRN",19,10377,"RPC",126,0)
GMV PARAMETER
"KRN",19,10377,"RPC",127,0)
ORWPT PTINQ
"KRN",19,10377,"RPC",128,0)
GMV GET CATEGORY IEN
"KRN",19,10377,"RPC",129,0)
GMV GET VITAL TYPE IEN
"KRN",19,10377,"U")
VITALS/MEASUREMENTS GUI APPLIC
"KRN",8994,1685,-1)
0^1
"KRN",8994,1685,0)
GMV GET VITAL TYPE IEN^TYPE^GMVUTL8^1^R^0
"KRN",8994,1685,1,0)
^8994.01^1^1^3021125^^^
"KRN",8994,1685,1,1,0)
Returns the IEN if the value is found in FILE 120.51. 
"KRN",8994,1685,2,0)
^8994.02A^1^1
"KRN",8994,1685,2,1,0)
GMVTYPE^1^55^1^1
"KRN",8994,1685,2,1,1,0)
^^1^1^3021125^
"KRN",8994,1685,2,1,1,1,0)
GMVTYPE = Name of Vital Type (from FILE 120.51) (e.g., WEIGHT)
"KRN",8994,1685,2,"B","GMVTYPE",1)

"KRN",8994,1685,2,"PARAMSEQ",1,1)

"KRN",8994,1685,3,0)
^^1^1^3021125^
"KRN",8994,1685,3,1,0)
Returns the IEN if GMVTYPE exists in FILE 120.51.
"KRN",8994,1686,-1)
0^2
"KRN",8994,1686,0)
GMV GET CATEGORY IEN^CATEGORY^GMVUTL8^1^R^0
"KRN",8994,1686,1,0)
^8994.01^1^1^3021125^^^^
"KRN",8994,1686,1,1,0)
Returns the IEN if the value is found in FILE 120.53.
"KRN",8994,1686,2,0)
^8994.02A^1^1
"KRN",8994,1686,2,1,0)
GMVCAT^1^45^1^1
"KRN",8994,1686,2,1,1,0)
^8994.021^1^1^3021125^^^
"KRN",8994,1686,2,1,1,1,0)
GMVCAT = Name of Category (from FILE 120.53) (e.g., METHOD)
"KRN",8994,1686,2,"B","GMVCAT",1)

"KRN",8994,1686,2,"PARAMSEQ",1,1)

"KRN",8994,1686,3,0)
^^1^1^3021125^
"KRN",8994,1686,3,1,0)
Returns the IEN if GMVCAT exists in FILE 120.53
"MBREQ")
0
"ORD",0,9.8)
9.8;;1;RTNF^XPDTA;RTNE^XPDTA
"ORD",0,9.8,0)
ROUTINE
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",44,-1)
1^1
"PKG",44,0)
GEN. MED. REC. - VITALS^GMRV^Vitals/Measurements Module of General Medical Record.
"PKG",44,20,0)
^9.402P^^
"PKG",44,22,0)
^9.49I^1^1
"PKG",44,22,1,0)
5.0^3021029
"PKG",44,22,1,"PAH",1,0)
1^3031009
"PKG",44,22,1,"PAH",1,1,0)
^^2^2^3031009
"PKG",44,22,1,"PAH",1,1,1,0)
Please read the GMRV*5*1 patch description on FORUM for an explanation of
"PKG",44,22,1,"PAH",1,1,2,0)
what this patch does.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
16
"RTN","GMV1PST")
0^16^B1300794
"RTN","GMV1PST",1,0)
GMV1PST ;HOIFO/FT-POST INSTALLATION FOR GMRV*5*1 ;10/8/03  14:01
"RTN","GMV1PST",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1**;Oct 31, 2002
"RTN","GMV1PST",3,0)
 ;
"RTN","GMV1PST",4,0)
 ; This routine uses the following IAs:
"RTN","GMV1PST",5,0)
 ; #10141 - ^XPDUTL calls (supported)
"RTN","GMV1PST",6,0)
 ; #2263  - ^XPAR calls   (supported)
"RTN","GMV1PST",7,0)
 ;
"RTN","GMV1PST",8,0)
 ; This post-installation:
"RTN","GMV1PST",9,0)
 ; Updates the parameters for the required client version
"RTN","GMV1PST",10,0)
 ;
"RTN","GMV1PST",11,0)
XPAR ; Setup preliminary parameters
"RTN","GMV1PST",12,0)
 ; This submodule is called during the KIDS installation
"RTN","GMV1PST",13,0)
 ; process.
"RTN","GMV1PST",14,0)
 ;
"RTN","GMV1PST",15,0)
 ; Variables:
"RTN","GMV1PST",16,0)
 ;  GMV:    [Private] Scratch
"RTN","GMV1PST",17,0)
 ;  GMVGUI: [Private] Current version of GUI being installed
"RTN","GMV1PST",18,0)
 ;  GMVLST: [Private] Scratch List
"RTN","GMV1PST",19,0)
 ;
"RTN","GMV1PST",20,0)
 ; New private variables
"RTN","GMV1PST",21,0)
 N GMV,GMVGUI,GMVLST
"RTN","GMV1PST",22,0)
 ; Announce my intentions
"RTN","GMV1PST",23,0)
 D BMES^XPDUTL("Updating system parameters.")
"RTN","GMV1PST",24,0)
 ; Set current client version
"RTN","GMV1PST",25,0)
 S GMVGUI="5.0.1.0"
"RTN","GMV1PST",26,0)
 ; Deactivate all previous versions from XPAR
"RTN","GMV1PST",27,0)
 D GETLST^XPAR(.GMVLST,"SYS","GMV GUI VERSION")
"RTN","GMV1PST",28,0)
 F GMV=0:0 S GMV=$O(GMVLST(GMV)) Q:'GMV  D
"RTN","GMV1PST",29,0)
 .D EN^XPAR("SYS","GMV GUI VERSION",$P(GMVLST(GMV),"^",1),0)
"RTN","GMV1PST",30,0)
 ; Add and/or activate current client versions
"RTN","GMV1PST",31,0)
 D EN^XPAR("SYS","GMV GUI VERSION","VITALS.EXE:"_GMVGUI,1)
"RTN","GMV1PST",32,0)
 D EN^XPAR("SYS","GMV GUI VERSION","VITALSMANAGER.EXE:"_GMVGUI,1)
"RTN","GMV1PST",33,0)
 Q
"RTN","GMVCLIN")
0^3^B7602247
"RTN","GMVCLIN",1,0)
GMVCLIN ;HOIFO/YH,FT-RETURNS A LIST OF PATIENTS WITH CLINIC APPOINTMENTS WITHIN A GIVEN PERIOD ;6/24/03  10:32
"RTN","GMVCLIN",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1**;Oct 31, 2002
"RTN","GMVCLIN",3,0)
 ;
"RTN","GMVCLIN",4,0)
 ; This routine uses the following IAs:
"RTN","GMVCLIN",5,0)
 ;  #3869 - ^SDAMA202 calls        (controlled)
"RTN","GMVCLIN",6,0)
 ; #10040 - ^SC( references        (supported)
"RTN","GMVCLIN",7,0)
 ; #10103 - ^XLFDT calls           (supported)
"RTN","GMVCLIN",8,0)
 ;
"RTN","GMVCLIN",9,0)
CLINPTS(RESULT,CLIN,BDATE) ; GMV CLINIC PT [RPC entry point]
"RTN","GMVCLIN",10,0)
 ; Return list of patients with clinic appointments within given period
"RTN","GMVCLIN",11,0)
 ; Input:
"RTN","GMVCLIN",12,0)
 ;   RESULT - array name to return data in
"RTN","GMVCLIN",13,0)
 ;     CLIN - clinic name
"RTN","GMVCLIN",14,0)
 ;    BDATE - TODAY, TOMORROW, YESTERDAY, PAST WEEK, OR PAST MONTH
"RTN","GMVCLIN",15,0)
 ;
"RTN","GMVCLIN",16,0)
 ;  Output:
"RTN","GMVCLIN",17,0)
 ;   RESULT(n)=DFN^patient name^clinic name^appt date/time (external)^
"RTN","GMVCLIN",18,0)
 ;             SSN^DOB (external)^sex, age^^...^^^^^...
"RTN","GMVCLIN",19,0)
 ;
"RTN","GMVCLIN",20,0)
 ;   RESULT(1)=contains any error message
"RTN","GMVCLIN",21,0)
 ;
"RTN","GMVCLIN",22,0)
 N DFN,EDATE,GMVCLIN,GMVCNT,GMVDT,GMVI,GMVJ,GMVNODE,GMVNOW
"RTN","GMVCLIN",23,0)
 N GMVOUT,GMVPAT,GMVRESLT,NAME,X
"RTN","GMVCLIN",24,0)
 K RESULT
"RTN","GMVCLIN",25,0)
 I '$D(^SC("B",CLIN)) S RESULT(1)="ERROR^No clinic identified" G QCLIN
"RTN","GMVCLIN",26,0)
 S GMVCLIN=$O(^SC("B",CLIN,0))
"RTN","GMVCLIN",27,0)
 I GMVCLIN'>0 S RESULT(1)="ERROR^No clinic identified" G QCLIN
"RTN","GMVCLIN",28,0)
 S GMVNOW=$$NOW^XLFDT,EDATE=$P(GMVNOW,".")_".24"
"RTN","GMVCLIN",29,0)
 S BDATE=$$UP^XLFSTR(BDATE)
"RTN","GMVCLIN",30,0)
 S BDATE=$S(BDATE="TODAY":"T",BDATE="TOMORROW":"T+1",BDATE="YESTERDAY":"T-1",BDATE="PAST WEEK":"T-7",BDATE="PAST MONTH":"T-30",1:"")
"RTN","GMVCLIN",31,0)
 I BDATE="" S RESULT(1)="ERROR^Error in date range." G QCLIN
"RTN","GMVCLIN",32,0)
 ; convert bdate and edate into fileman date/time
"RTN","GMVCLIN",33,0)
 D DT^DILF("T",BDATE,.BDATE,"","")
"RTN","GMVCLIN",34,0)
 I BDATE>EDATE S EDATE=BDATE_".24"
"RTN","GMVCLIN",35,0)
 ; call scheduling api to get appt data
"RTN","GMVCLIN",36,0)
 D GETPLIST^SDAMA202(GMVCLIN,"1;4;","R",BDATE,EDATE,.GMVRESLT,"")
"RTN","GMVCLIN",37,0)
 ; if GMVRESLT < 0, scheduling api returned an error
"RTN","GMVCLIN",38,0)
 I GMVRESLT<0 D  G QCLIN
"RTN","GMVCLIN",39,0)
 .S RESULT(1)="ERROR"_U_$O(^TMP($J,"SDAMA202","GETPLIST","ERROR",0))
"RTN","GMVCLIN",40,0)
 .Q
"RTN","GMVCLIN",41,0)
 ; generate error message if # of appts > 200
"RTN","GMVCLIN",42,0)
 I $D(^TMP($J,"SDAMA202","GETPLIST",201,0)) D  G QCLIN
"RTN","GMVCLIN",43,0)
 .S RESULT(1)="ERROR^Too many appointments found. Please narrow search."
"RTN","GMVCLIN",44,0)
 .Q
"RTN","GMVCLIN",45,0)
 S (GMVCNT,GMVI)=0
"RTN","GMVCLIN",46,0)
 F  S GMVI=$O(^TMP($J,"SDAMA202","GETPLIST",GMVI)) Q:'GMVI  D
"RTN","GMVCLIN",47,0)
 .S GMVNODE=^TMP($J,"SDAMA202","GETPLIST",GMVI,4) ;dfn^patient name
"RTN","GMVCLIN",48,0)
 .Q:$P(GMVNODE,U,1)=""!($P(GMVNODE,U,2)="")
"RTN","GMVCLIN",49,0)
 .S DFN=$P(GMVNODE,U,1),NAME=$P(GMVNODE,U,2)
"RTN","GMVCLIN",50,0)
 .S GMVDT=$P(^TMP($J,"SDAMA202","GETPLIST",GMVI,1),U,1) ;appt date/time
"RTN","GMVCLIN",51,0)
 .S GMVOUT(NAME,DFN)=DFN_"^"_NAME_"^"_CLIN_"^"_$$FMTE^XLFDT(GMVDT)
"RTN","GMVCLIN",52,0)
 .S GMVCNT=GMVCNT+1
"RTN","GMVCLIN",53,0)
 .Q
"RTN","GMVCLIN",54,0)
 I $D(GMVOUT) D
"RTN","GMVCLIN",55,0)
 .S GMVI=0,NAME=""
"RTN","GMVCLIN",56,0)
 .F  S NAME=$O(GMVOUT(NAME)) Q:NAME=""  D
"RTN","GMVCLIN",57,0)
 ..S DFN=0
"RTN","GMVCLIN",58,0)
 ..F  S DFN=$O(GMVOUT(NAME,DFN)) Q:'DFN  D
"RTN","GMVCLIN",59,0)
 ...S GMVPAT=""
"RTN","GMVCLIN",60,0)
 ...D PTINFO^GMVUTL3(.GMVPAT,DFN)
"RTN","GMVCLIN",61,0)
 ...S GMVI=GMVI+1,RESULT(GMVI)=GMVOUT(NAME,DFN)_"^"_GMVPAT
"RTN","GMVCLIN",62,0)
 ...Q
"RTN","GMVCLIN",63,0)
 ..Q
"RTN","GMVCLIN",64,0)
 .Q
"RTN","GMVCLIN",65,0)
QCLIN ; called from above
"RTN","GMVCLIN",66,0)
 I '$D(RESULT(1)) S RESULT(1)="No patients found"
"RTN","GMVCLIN",67,0)
 K ^TMP($J,"SDAMA202")
"RTN","GMVCLIN",68,0)
 Q
"RTN","GMVCLIN",69,0)
 ;
"RTN","GMVGETD2")
0^15^B21008972
"RTN","GMVGETD2",1,0)
GMVGETD2 ;HOIFO/YH-EXTRACT VITALS/MEASUREMENT RECORDS FOR A GIVEN DATE (CONT.) ;12/9/02  14:03
"RTN","GMVGETD2",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1**;Oct 31, 2002
"RTN","GMVGETD2",3,0)
 ;
"RTN","GMVGETD2",4,0)
 ; This routine uses the following IAs:
"RTN","GMVGETD2",5,0)
 ; <None>
"RTN","GMVGETD2",6,0)
 ;
"RTN","GMVGETD2",7,0)
SETLN ;CALLED BY GMVGETD1
"RTN","GMVGETD2",8,0)
 N GMVUSER
"RTN","GMVGETD2",9,0)
 S GJ=GJ+1,GMRDAT=^GMR(120.5,GMRVDA,0),^TMP($J,"GRPC",GJ)=GMRVDA_"^"_$E(GMRDATE,4,5)_"/"_$E(GMRDATE,6,7)_"/"_$E(GMRDATE,2,3)
"RTN","GMVGETD2",10,0)
 S GMVUSER=$$PERSON^GMVUTL1(+$P(GMRDAT,U,6)) ;user name
"RTN","GMVGETD2",11,0)
 S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_"@"_$E($P(GMRDATE,".",2)_"000000",1,2)_":"_$E($P(GMRDATE,".",2)_"000000",3,4)_"   "
"RTN","GMVGETD2",12,0)
 S GMRVTY(1)=$S(GMRVTY="T":"T: ",GMRVTY="P":"P: ",GMRVTY="R":"R: ",GMRVTY="BP":"B/P: ",GMRVTY="WT":"Wt: ",GMRVTY="HT":"Ht: ",GMRVTY="CG":"Circumference/Girth: ",GMRVTY="CVP":"Central Venous Pressure: ",GMRVTY="PO2":"Pulse Oximetry: ",1:"")
"RTN","GMVGETD2",13,0)
 I GMRVTY(1)="" S GMRVTY(1)=$S(GMRVTY="PN":"Pain: ",1:"")
"RTN","GMVGETD2",14,0)
 S GMRVTY(1)=GMRVTY(1)_"  "
"RTN","GMVGETD2",15,0)
 S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GMRVTY(1)
"RTN","GMVGETD2",16,0)
 I GMRVTY="PN" D  Q
"RTN","GMVGETD2",17,0)
 . S ^TMP($J,"GRPC",GJ)=^(GJ)_$P(GMRDAT,"^",8)_"  "_$S(+$P(GMRDAT,"^",8)=99:"Unable to respond",+$P(GMRDAT,"^",8)=10:"Worst imaginable pain",$P(GMRDAT,"^",8)="0":"No pain",1:"")_"  _"_GMVUSER
"RTN","GMVGETD2",18,0)
 I "PRBPCVPCGPO2"[GMRVTY S GMRVX=GMRVTY,GMRVX(0)=$P(GMRDAT,"^",8) D
"RTN","GMVGETD2",19,0)
 . I '(GMRVX(0)<0!(GMRVX(0)>0)!($E(GMRVX(0))="0")) S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GMRVX(0)_" " Q
"RTN","GMVGETD2",20,0)
 . D EN1^GMVSAS0
"RTN","GMVGETD2",21,0)
 . S Z=$S(GMRVTY="CG":$J($P(GMRDAT,"^",8),0,2),GMRVTY="CVP":$J($P(GMRDAT,"^",8),0,1),GMRVTY'="BP":$J($P(GMRDAT,"^",8),3,0),1:$P(GMRDAT,"^",8)) D:GMRVTY'="BP" BLNK
"RTN","GMVGETD2",22,0)
 . S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_Z_$S('$D(GMRVX(1)):" ",'GMRVX(1):"",1:"*")
"RTN","GMVGETD2",23,0)
 . I GMRVTY="CG" S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_" in ("_$J(Z/.3937,0,2)_" cm)"
"RTN","GMVGETD2",24,0)
 . I GMRVTY="CVP" S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_" cmH2O ("_$J(Z/1.36,0,1)_" mmHg)"
"RTN","GMVGETD2",25,0)
 . I GMRVTY="PO2" D
"RTN","GMVGETD2",26,0)
 . . S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_"%"
"RTN","GMVGETD2",27,0)
 . . I $P(GMRDAT,"^",10)["%"!($P(GMRDAT,"^",10)[" l/min") D
"RTN","GMVGETD2",28,0)
 . . . S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_" with supplemental O2"
"RTN","GMVGETD2",29,0)
 . . . N GMV S GMV=$P(GMRDAT,"^",10) I GMV[" l/min" S GMV=$P(GMV," l/min")_"L/min"_$P(GMV," l/min",2)
"RTN","GMVGETD2",30,0)
 . . . S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_" "_GMV
"RTN","GMVGETD2",31,0)
 I GMRVTY="T" S X=$P(GMRDAT,"^",8) D
"RTN","GMVGETD2",32,0)
 . I X'>0 S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_X Q
"RTN","GMVGETD2",33,0)
 . S GMRVX=GMRVTY,GMRVX(0)=X D EN1^GMVSAS0
"RTN","GMVGETD2",34,0)
 . D EN1^GMVUTL S:'Y Y="" S Z=$J(X,5,1) D BLNK S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_Z_" F " S Z=$J(Y,4,1) D BLNK S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_"("_Z_" C)"_$S('$D(GMRVX(1)):" ",'GMRVX(1):"",1:"*")
"RTN","GMVGETD2",35,0)
 I GMRVTY="HT" S X=$P(GMRDAT,"^",8) D
"RTN","GMVGETD2",36,0)
 . I X'>0 S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_X Q
"RTN","GMVGETD2",37,0)
 . D EN2^GMVUTL S:'Y Y="" S Z=$J(X,5,2) D BLNK S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_Z_" in " S Z=$J(Y,5,2) D BLNK S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_"("_Z_" cm)"
"RTN","GMVGETD2",38,0)
 I GMRVTY="WT" S X=$P(GMRDAT,"^",8) D
"RTN","GMVGETD2",39,0)
 . I X'>0 S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_X Q
"RTN","GMVGETD2",40,0)
 . D EN3^GMVUTL S:'Y Y="" S Z=$J(X,7,2) D BLNK S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_Z_" lb " S Z=$J(Y,6,2) D BLNK S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_"("_Z_" kg)"
"RTN","GMVGETD2",41,0)
 I (+$P(GMRDAT,"^",8)'>0)&($P(GMRDAT,"^",8)'="0") D  Q
"RTN","GMVGETD2",42,0)
 .S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_"  _"_GMVUSER
"RTN","GMVGETD2",43,0)
 .Q
"RTN","GMVGETD2",44,0)
 S GMRVITY=+$P(GMRDAT,"^",3)
"RTN","GMVGETD2",45,0)
 K GMRVARY S (GMRZZ,GMRVARY)="" I $P($G(^GMR(120.5,GMRVDA,5,0)),"^",4)>0 D
"RTN","GMVGETD2",46,0)
 . D CHAR^GMVCHAR(GMRVDA,.GMRVARY,GMRVITY) S GMRZZ=$$WRITECH^GMVCHAR(GMRVDA,.GMRVARY,9) S:GMRZZ'=""&(GMRVTY'="PO2") GMRZZ=" ("_GMRZZ_")"
"RTN","GMVGETD2",47,0)
 . S:GMRVTY="PO2" ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_" "_GMRZZ
"RTN","GMVGETD2",48,0)
 .  I GMRVTY="P",GMRZZ["DORSALIS PEDIS",$P(GMRDAT,"^",8)=1 S ^TMP($J,"GRPC",GJ)=$P(^(GJ),"*",1)_$P(^(GJ),"*",2)
"RTN","GMVGETD2",49,0)
 . S:GMRVTY'="PO2" ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_" "_GMRZZ
"RTN","GMVGETD2",50,0)
 S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_" _"_GMVUSER
"RTN","GMVGETD2",51,0)
 I GMRVTY="WT" S GMRBMI="",GMRBMI(1)=$P(GMRDAT,"^"),GMRBMI(2)=+$P(GMRDAT,"^",8) D CALBMI^GMVBMI(.GMRBMI) D:GMRBMI'=""
"RTN","GMVGETD2",52,0)
 . S GJ=GJ+1,^TMP($J,"GRPC",GJ)=$E(GMRDATE,4,5)_"/"_$E(GMRDATE,6,7)_"/"_$E(GMRDATE,2,3)
"RTN","GMVGETD2",53,0)
 . S ^TMP($J,"GRPC",GJ)="       @"_$E($P(GMRDATE,".",2)_"000000",1,2)_":"_$E($P(GMRDATE,".",2)_"000000",3,4)_"   Body Mass Index:   "_GMRBMI
"RTN","GMVGETD2",54,0)
 K Z,GMRBMI
"RTN","GMVGETD2",55,0)
 Q
"RTN","GMVGETD2",56,0)
BLNK ;
"RTN","GMVGETD2",57,0)
 F I=1:1:$L(Z) Q:$E(Z,I)'=" "
"RTN","GMVGETD2",58,0)
 S Z=$E(Z,I,$L(Z))
"RTN","GMVGETD2",59,0)
 Q
"RTN","GMVGR1")
0^12^B35949185
"RTN","GMVGR1",1,0)
GMVGR1 ;HIOFO/YH,FT-SET ^TMP($J) GLOBAL ;11/29/02  13:34
"RTN","GMVGR1",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1**;Oct 31, 2002
"RTN","GMVGR1",3,0)
 ;
"RTN","GMVGR1",4,0)
 ; This routine uses the following IAs:
"RTN","GMVGR1",5,0)
 ; #10061 - ^VADPT calls           (supported)
"RTN","GMVGR1",6,0)
 ; #10104 - ^XLFSTR calls          (supported)
"RTN","GMVGR1",7,0)
 ;
"RTN","GMVGR1",8,0)
GRAPH ;CONTINUTATION OF GMVGR0
"RTN","GMVGR1",9,0)
 S (GCNT,GCNTD,GPG)=0 D DEM^VADPT,INP^VADPT,SETV
"RTN","GMVGR1",10,0)
 F GK="H","W","T","P","R","B","I","O","PO2","CVP","CG","PN" D
"RTN","GMVGR1",11,0)
 . S ^TMP($J,"GTNM",GK)=0 F GI=0:0 S GI=$O(^TMP($J,"GMRVG",GK,GI)) Q:GI'>0  S GJ="" F X=0:0 S GJ=$O(^TMP($J,"GMRVG",GK,GI,GJ)) Q:GJ=""  S ^TMP($J,"GTNM",GK)=^TMP($J,"GTNM",GK)+1,^TMP($J,"GDT",GI)=""
"RTN","GMVGR1",12,0)
 S GTNM=0 F X=0:0 S X=$O(^TMP($J,"GDT",X)) Q:X'>0  S GTNM=GTNM+1
"RTN","GMVGR1",13,0)
 S GPG=$S(GTNM=0:1,1:GTNM\10+''(GTNM#10)),GDT1=0
"RTN","GMVGR1",14,0)
 F GPGS=1:1:GPG D
"RTN","GMVGR1",15,0)
 . F GI=1:1:200 S ^TMP($J,"GMRK","G"_GI)=""
"RTN","GMVGR1",16,0)
 . K GMRQUAL S ^TMP($J,"GMRK","G199")="Page "_GPGS D SETP,DATE S ^TMP($J,"GMRK","G200")=GMRRMBD
"RTN","GMVGR1",17,0)
 . D PAGE,EN1^GMVGR2,EN2^GMVGR3,EN3^GMVGR4,EN4^GMVGR6 S ^TMP($J,"GMRK","G50M")=0.2,^TMP($J,"GMRK","G82M")=0.6
"RTN","GMVGR1",18,0)
 D KVAR^VADPT K VA Q
"RTN","GMVGR1",19,0)
PAGE ;Set temp. and pulse starting point in the graph
"RTN","GMVGR1",20,0)
 D SETV
"RTN","GMVGR1",21,0)
 I ^TMP($J,"GMRK","G50")="" F GI=51:1:59 S ^TMP($J,"GMRK","G50")=^TMP($J,"GMRK","G"_GI),^TMP($J,"GMRK","G50M")=0.2+(1.6*(GI-50)) Q:^TMP($J,"GMRK","G50")'=""
"RTN","GMVGR1",22,0)
 I ^TMP($J,"GMRK","G82")="" F GI=83:1:91 S ^TMP($J,"GMRK","G82")=^TMP($J,"GMRK","G"_GI),^TMP($J,"GMRK","G82M")=0.6+(1.6*(GI-82)) Q:^TMP($J,"GMRK","G82")'=""
"RTN","GMVGR1",23,0)
 I $D(GMRQUAL) D LEGEND^GMVLGQU
"RTN","GMVGR1",24,0)
 K GG,GI,GMRVJ,GSYNO Q
"RTN","GMVGR1",25,0)
SETV ;Set patient data in ^TMP($J,"GMRK" global
"RTN","GMVGR1",26,0)
 S ^TMP($J,"GMRK","G194")=$S(VADM(1)'="":VADM(1),1:"         ")_"  "_$S(VADM(2)'="":$P(VADM(2),"^",2),1:" "),GDOB=$S($D(VADM(3)):$P(VADM(3),"^",2),1:" "),GAGE=$S($D(VADM(4)):VADM(4),1:" ")
"RTN","GMVGR1",27,0)
 S ^TMP($J,"GMRK","G197")=$S($D(VADM(5)):$P(VADM(5),"^",2),1:" "),^TMP($J,"GMRK","G198")=$S($D(GMRWARD(1)):"Unit: "_GMRWARD(1),1:"Unit:  ")
"RTN","GMVGR1",28,0)
 S GMRRMBD=$S('(VAIN(5)=""):"Room: "_$P(VAIN(5),"-",1,2),1:"Room:  "),^TMP($J,"GMRK","G196")=$S($D(GDOB)&($D(GAGE)):GDOB_" ("_GAGE_")",1:" ")
"RTN","GMVGR1",29,0)
 I '$D(GMRVHLOC) S GMRVHLOC=$$HOSPLOC^GMVUTL1(+$G(VAIN(4)))
"RTN","GMVGR1",30,0)
 S GMRDIV="Division: "_$$DIVISION^GMVUTL1(+GMRVHLOC)
"RTN","GMVGR1",31,0)
 Q
"RTN","GMVGR1",32,0)
DATE F GCNTD=1:1:10 S:$L(GDT1) GDT1=$O(^TMP($J,"GDT",GDT1)) S ^TMP($J,"GMRK","G"_GCNTD)=$S($L(GDT1):$E(GDT1,4,5)_"-"_$E(GDT1,6,7)_"-"_$E(GDT1,2,3),1:"") D DATE1
"RTN","GMVGR1",33,0)
 Q
"RTN","GMVGR1",34,0)
DATE1 S Y=$E($P(GDT1,".",2)_"0000",1,4),^TMP($J,"GMRK","G"_(GCNTD+16))=$S($L(GDT1):$E(Y,1,2)_":"_$E(Y,3,4),1:"") D SETD
"RTN","GMVGR1",35,0)
 Q
"RTN","GMVGR1",36,0)
SETD F GI="H","W","T","P","R","B","I","O","C","PN" S GJ=$F("WTXPXRBIOCH",GI),GK=$S($L(GDT1):$O(^TMP($J,"GMRVG",GI,GDT1,"")),1:"") D SETA
"RTN","GMVGR1",37,0)
 F GI="PO2","CVP","CG" S GJ=0,GK=$S($L(GDT1):$O(^TMP($J,"GMRVG",GI,GDT1,"")),1:"") D SETA
"RTN","GMVGR1",38,0)
 Q
"RTN","GMVGR1",39,0)
SETA ;Store measurements in ^TMP($J,"GMRK" global
"RTN","GMVGR1",40,0)
 I GK="Unavailable" S GK="Unavail"
"RTN","GMVGR1",41,0)
 I GI="PN" S ^TMP($J,"GMRK","G"_(1660+GCNTD))=GK Q
"RTN","GMVGR1",42,0)
 S (GMRSITE,GMRSITE(1),GMRINF,GMRVJ)=""
"RTN","GMVGR1",43,0)
 I GK'="" D
"RTN","GMVGR1",44,0)
 . S GMRSITE(1)=$P($G(^TMP($J,"GMRVG",GI,GDT1,GK)),"^"),GMRVJ=$P($G(^(GK)),"^",2),GMRINF=$P($G(^(GK)),"^",4)
"RTN","GMVGR1",45,0)
 . I GMRSITE(1)'="" D SYNOARY^GMVLGQU
"RTN","GMVGR1",46,0)
 I GI="H" D  Q
"RTN","GMVGR1",47,0)
 . S ^TMP($J,"GMRK","G"_(270+GCNTD))=GK_" "_GMRSITE,^TMP($J,"GMRK","G"_(290+GCNTD))=$S(GK>0:$J(GK*2.54,0,2),1:"") S:GK>0 GMRHT=(GK*2.54)/100
"RTN","GMVGR1",48,0)
 I GI="C" S ^TMP($J,"GMRK","G"_(1640+GCNTD))=GK_"  "_^TMP($J,"GMRK","G"_(1640+GCNTD)) Q
"RTN","GMVGR1",49,0)
 I GI="PO2"!(GI="CVP")!(GI="CG") D  Q
"RTN","GMVGR1",50,0)
 . I GI="PO2" D
"RTN","GMVGR1",51,0)
 . . S (GMRINF(1),GMRINF(2))="" I GMRINF'="" D PO2^GMVLGQU(.GMRINF)
"RTN","GMVGR1",52,0)
 . . S ^TMP($J,"GMRK","G"_(1100+GCNTD))=GK_$S(GMRVJ=1:"*",1:" ")
"RTN","GMVGR1",53,0)
 . . S ^TMP($J,"GMRK","G"_(1130+GCNTD))=GMRINF(1)
"RTN","GMVGR1",54,0)
 . . S ^TMP($J,"GMRK","G"_(1150+GCNTD))=GMRINF(2)
"RTN","GMVGR1",55,0)
 . . S ^TMP($J,"GMRK","G"_(1170+GCNTD))=GMRSITE
"RTN","GMVGR1",56,0)
 . . Q
"RTN","GMVGR1",57,0)
 . I GI="CVP" D
"RTN","GMVGR1",58,0)
 . . S ^TMP($J,"GMRK","G"_(1200+GCNTD))=$S(GK>0!(GK<0):$J(GK,0,1),1:GK)_$S(GMRVJ=1:"*",1:" ")
"RTN","GMVGR1",59,0)
 . . S ^TMP($J,"GMRK","G"_(1230+GCNTD))=$S(GK>0!(GK<0)!($E(GK)="0"):$J(GK/1.36,0,1),1:"")_$S(GMRVJ=1:"*",1:" ")
"RTN","GMVGR1",60,0)
 . . Q
"RTN","GMVGR1",61,0)
 . I GI="CG" D
"RTN","GMVGR1",62,0)
 . . S ^TMP($J,"GMRK","G"_(1250+GCNTD))=GK_" "_GMRSITE,^TMP($J,"GMRK","G"_(1320+GCNTD))=$S(GK>0:$J(GK/.3937,0,2),1:"")
"RTN","GMVGR1",63,0)
 . . Q
"RTN","GMVGR1",64,0)
 I GI="B",GK'="" S ^TMP($J,"GMRK","G"_(250+GCNTD))=$S($L(GMRSITE," ")>3:$P(GMRSITE," ",2,4),1:GMRSITE) S:$L(GMRSITE," ")>3 ^TMP($J,"GMRK","G"_(1640+GCNTD))=$P(GMRSITE," ")
"RTN","GMVGR1",65,0)
 I '(GI="T"!(GI="P")) D  Q
"RTN","GMVGR1",66,0)
 . I GI="C" S GMRSITE=$S($L(GMRSITE," ")>3:"  "_$P(GMRSITE," "),1:"")
"RTN","GMVGR1",67,0)
 . S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=GK_$S(GMRVJ=1&(GI'="C"):"*",1:" ")_$S(GI="B":"",1:GMRSITE) S:GI="W" ^TMP($J,"GMRK","G"_(310+GCNTD))=$S(GK>0:$J(GK/2.2,0,2),1:"")
"RTN","GMVGR1",68,0)
 . I GK>0,GI="W" D
"RTN","GMVGR1",69,0)
 . . S GMRBMI="",GMRBMI(1)=GDT1,GMRBMI(2)=GK D CALBMI^GMVBMI(.GMRBMI)
"RTN","GMVGR1",70,0)
 . . S ^TMP($J,"GMRK","G"_(330+GCNTD))=GMRBMI K GMRBMI
"RTN","GMVGR1",71,0)
 I GI="T",GK>0 S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=106-GK
"RTN","GMVGR1",72,0)
 I GK'="",GI="P","UNAVAILABLEPASSREFUSED"'[$$UP^XLFSTR(GK) D
"RTN","GMVGR1",73,0)
 . I GMRSITE(1)["RADIAL"!(GMRSITE(1)["APICAL")!(GMRSITE(1)["BRACHIAL") D
"RTN","GMVGR1",74,0)
 . . S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=170-GK/10
"RTN","GMVGR1",75,0)
 S ^TMP($J,"GMRK","G"_(GJ+1*16+GCNTD+1))=GK_$S(GMRVJ=1:"*",1:" ")_$S(GI="T":GMRSITE,GI="P"&($L(GMRSITE," ")>3):"  "_$P(GMRSITE," "),1:"")
"RTN","GMVGR1",76,0)
 I GI="T",GK>0 S ^TMP($J,"GMRK","G"_(210+GCNTD))=$S(GMRVJ=1:"T*",1:"T")
"RTN","GMVGR1",77,0)
 I GI="P",GK'="","UNAVAILABLEPASSREFUSED"'[$$UP^XLFSTR(GK) D
"RTN","GMVGR1",78,0)
 . I GMRSITE(1)["RADIAL"!(GMRSITE(1)["APICAL")!(GMRSITE(1)["BRACHIAL") S ^TMP($J,"GMRK","G"_(230+GCNTD))=$S(GMRVJ=1:"P*",1:"P")
"RTN","GMVGR1",79,0)
 . S ^TMP($J,"GMRK","G"_(1300+GCNTD))=$S($L(GMRSITE," ")>3:$P(GMRSITE," ",2,4),1:GMRSITE)
"RTN","GMVGR1",80,0)
 I GK>0,GI="T" S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=$S(^("G"_(GJ*16+GCNTD+1))<1.5:1.5,^("G"_(GJ*16+GCNTD+1))>12.7:12.7,1:^("G"_(GJ*16+GCNTD+1))) S:^("G"_(GJ*16+GCNTD+1))<1.6!(^("G"_(GJ*16+GCNTD+1))>12.6) ^TMP($J,"GMRK","G"_(210+GCNTD))="T**"
"RTN","GMVGR1",81,0)
 I GK'="",GI="P","UNAVAILABLEPASSREFUSED"'[$$UP^XLFSTR(GK) D
"RTN","GMVGR1",82,0)
 . I GMRSITE(1)["RADIAL"!(GMRSITE(1)["APICAL")!(GMRSITE(1)["BRACHIAL") D
"RTN","GMVGR1",83,0)
 . . S ^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))=$S(^("G"_(GJ*16+GCNTD+1))<1.5:1.5,^("G"_(GJ*16+GCNTD+1))>12.7:12.7,1:^("G"_(GJ*16+GCNTD+1)))
"RTN","GMVGR1",84,0)
 . . S:^TMP($J,"GMRK","G"_(GJ*16+GCNTD+1))<1.6!(^("G"_(GJ*16+GCNTD+1))>12.6) ^TMP($J,"GMRK","G"_(230+GCNTD))="P**"
"RTN","GMVGR1",85,0)
 Q
"RTN","GMVGR1",86,0)
SETP ;INITIALIZE ^TMP FOR HEIGHT, WEIGHT AND V/M QUALIFIERS
"RTN","GMVGR1",87,0)
 ;250+I: BP QUALIFIER  270+I: HEIGHT IN INCH  290+I: HEIGHT IN CM
"RTN","GMVGR1",88,0)
 ;310+I:WEIGHT IN KG  330+I: BMI
"RTN","GMVGR1",89,0)
 ;1100+I: PULSE OXIMETRY DATA  1130+I: PULSE OX. L/MIN
"RTN","GMVGR1",90,0)
 ;1150+I: PULSE OX. %  1170+I: PULSE OX. METHOD
"RTN","GMVGR1",91,0)
 ;1200+I: CVP DATA IN CM H2O  1230+I: CVP DATA IN MMHG
"RTN","GMVGR1",92,0)
 ;1250+I: C/G DATA IN INCH  1270+I: C/G QUALIFIER  1300+I: PULSE QUALIFIER
"RTN","GMVGR1",93,0)
 ;1320+I: C/G DATA IN CM 1640+I: THIRD PIECE OF BP 1660+I: PAIN
"RTN","GMVGR1",94,0)
 F I=1:1:10 D
"RTN","GMVGR1",95,0)
 . S (^TMP($J,"GMRK","G"_(210+I)),^("G"_(230+I)),^("G"_(250+I)),^("G"_(270+I)),^("G"_(290+I)),^("G"_(310+I)),^("G"_(330+I)),^("G"_(1300+I)))=""
"RTN","GMVGR1",96,0)
 . S (^TMP($J,"GMRK","G"_(1100+I)),^("G"_(1130+I)),^("G"_(1150+I)),^("G"_(1170+I)),^("G"_(1200+I)),^("G"_(1230+I)),^("G"_(1250+I)),^("G"_(1270+I)))=""
"RTN","GMVGR1",97,0)
 . S (^TMP($J,"GMRK","G"_(1320+I)),^("G"_(1640+I)),^("G"_(1660+I)))=""
"RTN","GMVGR1",98,0)
 Q
"RTN","GMVHB3")
0^4^B1133091
"RTN","GMVHB3",1,0)
GMVHB3 ;HIOFO/YH,FT-HP LASER B/P GRAPH - ID ;11/8/02  13:35
"RTN","GMVHB3",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1**;Oct 31, 2002
"RTN","GMVHB3",3,0)
 ;
"RTN","GMVHB3",4,0)
 ; This routine uses the following IAs:
"RTN","GMVHB3",5,0)
 ; <None>
"RTN","GMVHB3",6,0)
 ;
"RTN","GMVHB3",7,0)
EN1 ;PRINT B/P
"RTN","GMVHB3",8,0)
 S J=-1.4,J(1)=130 D WRTLN^GMVHG3
"RTN","GMVHB3",9,0)
 S J=-1.9,J(1)=1241 D WRTLN^GMVHG3
"RTN","GMVHB3",10,0)
 ;PRINT B/P QUALIFIERS
"RTN","GMVHB3",11,0)
 S J=-2.4,J(1)=451 D WRTLN^GMVHG3
"RTN","GMVHB3",12,0)
 ;PRINT MEAN ARTERIAL PRESSURE
"RTN","GMVHB3",13,0)
 S J=-2.9,J(1)=1221 D WRTLN^GMVHG3
"RTN","GMVHB3",14,0)
PTID ;PRINT PATIENT ID
"RTN","GMVHB3",15,0)
 W !,"SD1,277,2,1,4,9,5,1,6,5,7,4;SS;PA-1,-4.6;LB"_GMVNM_"#;PA-1,-4.9;LB"_GMVDOB_"   "_GMVGEN_"#;"
"RTN","GMVHB3",16,0)
 W !,"PA-1,-5.2;LB"_GMVWRD_"#;PA7,-5.2;LB"_GMVRMBD_"#;PA7,-5.5;LB"_^TMP($J,"GMRK","G199")_"#;"
"RTN","GMVHB3",17,0)
 W !,"PA-1,-5.5;LB"_GMRDIV_"#;PA-1,-5.8;LB"_GSTRFIN_"#;"
"RTN","GMVHB3",18,0)
 Q
"RTN","GMVLAT0")
0^1^B30381121
"RTN","GMVLAT0",1,0)
GMVLAT0 ;HOIFO/YH,FT-DISPLAY LATEST VITALS/MEASUREMENTS FOR A PATIENT ;4/14/03  13:56
"RTN","GMVLAT0",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1**;Oct 31, 2002
"RTN","GMVLAT0",3,0)
 ;
"RTN","GMVLAT0",4,0)
 ; This routine uses the following IAs:
"RTN","GMVLAT0",5,0)
 ; #10104 - ^XLFSTR calls          (supported)
"RTN","GMVLAT0",6,0)
 ;
"RTN","GMVLAT0",7,0)
EN1(DFN) ; ENTRY TO EXTRACT THE LATEST VITALS/MEASUREMENT FOR A PATIENT
"RTN","GMVLAT0",8,0)
 ;CALLED BY GETLAT^GMVGETD
"RTN","GMVLAT0",9,0)
 N GJ,GBLANK,GAPICAL,GRADIAL,GBRACH,GMVUSER
"RTN","GMVLAT0",10,0)
 S GJ=0,GBLANK=""
"RTN","GMVLAT0",11,0)
 S GAPICAL=$O(^GMRD(120.52,"B","APICAL",0)),GRADIAL=$O(^GMRD(120.52,"B","RADIAL",0)),GBRACH=$O(^GMRD(120.52,"B","BRACHIAL",0))
"RTN","GMVLAT0",12,0)
 F X="T","P","R","PO2","BP","HT","WT","CVP","CG","PN" I $D(^GMRD(120.51,"C",X))  S GMR(X)=$O(^GMRD(120.51,"C",X,"")),Y=$P($G(^GMRD(120.51,GMR(X),0)),"^") Q:Y=""
"RTN","GMVLAT0",13,0)
 K GMRDT,GMRVWT,GMRVHT
"RTN","GMVLAT0",14,0)
 S X=""
"RTN","GMVLAT0",15,0)
 F  S X=$O(GMR(X)) Q:X=""  S GMRDATS="" I GMR(X)>0 F GMRDAT=0:0 S GMRDAT=$O(^GMR(120.5,"AA",DFN,+GMR(X),GMRDAT)) Q:$S(GMRDAT'>0:1,GMRDATS>0:1,1:0)  D SETDATAR
"RTN","GMVLAT0",16,0)
 I '($D(GMRDATA)\10) S GJ=GJ+1,^TMP($J,"GRPC",GJ)="There are no results to report " G Q
"RTN","GMVLAT0",17,0)
 F X="T","P","R","PO2","BP","HT","WT","CVP","CG","PN" I $D(GMRDATA(X)) S GMRVDT="",(GMRVDT(1),GMVD)=0 F  S GMVD=$O(GMRDATA(X,GMVD)) Q:GMVD'>0  D WRTDT S GMVD(1)=0 F  S GMVD(1)=$O(GMRDATA(X,GMVD,GMVD(1))) Q:GMVD(1)'>0  D
"RTN","GMVLAT0",18,0)
 . S GMVUSER=$P($G(^GMR(120.5,+GMVD(1),0)),U,6) ;user ien
"RTN","GMVLAT0",19,0)
 . S GMVUSER=$$PERSON^GMVUTL1(GMVUSER) ;user name
"RTN","GMVLAT0",20,0)
 . S GJ=GJ+1,^TMP($J,"GRPC",GJ)="",GMRVX(0)=GMRDATA(X,GMVD,GMVD(1)) S GMRVX=X D EN1^GMVSAS0
"RTN","GMVLAT0",21,0)
  . S:GMRVDT(1)=0 ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_$S(X="BP":"B/P",X="P":"Pulse",X="R":"Resp.",X="T":"Temp.",X="HT":"Ht.",X="CG":"Circ/Girth",X="WT":"Wt.",X="PO2":"Pulse Ox",X="PN":"Pain",1:X)_":"
"RTN","GMVLAT0",22,0)
 . I GMRVDT(1)=0 S GBLANK=$$REPEAT^XLFSTR(" ",13-$L(^TMP($J,"GRPC",GJ))),^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GBLANK_"("_GMRVDT_") " S GMRVDT(1)=1
"RTN","GMVLAT0",23,0)
 . S GBLANK=$$REPEAT^XLFSTR(" ",31-$L(^TMP($J,"GRPC",GJ))),^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GBLANK
"RTN","GMVLAT0",24,0)
 . I X="T" S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GMRVX(0)_" F  ("_$J(+GMRVX(0)-32*5/9,0,1)_" C)"
"RTN","GMVLAT0",25,0)
 . I X="WT" S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GMRVX(0)_" lb  ("_$J(GMRVX(0)/2.2,0,2)_" kg)" S GMRVWT=GMRVX(0)/2.2
"RTN","GMVLAT0",26,0)
 . I X="HT" S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_$S(GMRVX(0)\12:GMRVX(0)\12_" ft ",1:"")_$S(GMRVX(0)#12:GMRVX(0)#12_" in",1:"")_" ("_$J(GMRVX(0)*2.54,0,2)_" cm)" S GMRVHT=(GMRVX(0)*2.54)/100
"RTN","GMVLAT0",27,0)
 . I X="CG" S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GMRVX(0)_" in ("_$J(+GMRVX(0)/.3937,0,2)_" cm)"
"RTN","GMVLAT0",28,0)
 . I X="CVP" S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GMRVX(0)_" cmH2O ("_$J(GMRVX(0)/1.36,0,1)_" mmHg)"
"RTN","GMVLAT0",29,0)
 . I X="PO2" S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GMRVX(0)_"% "
"RTN","GMVLAT0",30,0)
 . I X="P"!(X="R")!(X="BP") S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GMRVX(0)
"RTN","GMVLAT0",31,0)
 . I X="PN" D  S ^TMP($J,"GRPC",GJ)=^(GJ)_GMRVX(0)
"RTN","GMVLAT0",32,0)
 . . I GMRVX(0)=0 S GMRVX(0)="0 - No pain" Q
"RTN","GMVLAT0",33,0)
 . . I GMRVX(0)=99 S GMRVX(0)="99 - Unable to respond" Q
"RTN","GMVLAT0",34,0)
 . . I GMRVX(0)=10 S GMRVX(0)="Pain class - 10 Worst imaginable pain" Q
"RTN","GMVLAT0",35,0)
 . . S GMVVX(0)="Pain class "_GMRVX(0) Q
"RTN","GMVLAT0",36,0)
 . S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_$S('$D(GMRVX(1)):"",'GMRVX(1):"",1:"*") K GMRVX
"RTN","GMVLAT0",37,0)
 . D CHAR
"RTN","GMVLAT0",38,0)
 . I X="WT",$G(GMRVWT)>0,$G(GMRVHT)>0 D
"RTN","GMVLAT0",39,0)
 . . S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_"  _"_GMVUSER
"RTN","GMVLAT0",40,0)
 . . S GJ=GJ+1,GMRVHT(1)=$J(GMRVWT/(GMRVHT*GMRVHT),0,0),^TMP($J,"GRPC",GJ)="Body Mass Index:",GMVUSER="" D
"RTN","GMVLAT0",41,0)
 . . .S GBLANK=$$REPEAT^XLFSTR(" ",29-$L(^TMP($J,"GRPC",GJ))),^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_GBLANK_GMRVHT(1)_$S(GMRVHT(1)>27:"*",1:"")
"RTN","GMVLAT0",42,0)
 . . . Q
"RTN","GMVLAT0",43,0)
 . . Q
"RTN","GMVLAT0",44,0)
 .S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_"  "_$S(GMVUSER]"":"_",1:"")_GMVUSER
"RTN","GMVLAT0",45,0)
 . Q
"RTN","GMVLAT0",46,0)
Q K GMRVWT,GMRVHT,GMR,GMVD,GBP,GMRVARY,GMRVDA,GMRDATA,GMVDM,GLIN,GMRZZ
"RTN","GMVLAT0",47,0)
 K GMRVDT,GMROUT,%Y,GMRL,GMRDT,DIC,GMRDAT,GMRDATS,GMRSTR,GMRX,GMRVX,POP
"RTN","GMVLAT0",48,0)
 Q
"RTN","GMVLAT0",49,0)
SETDATAR ;
"RTN","GMVLAT0",50,0)
 S Y=0 F  S Y=$O(^GMR(120.5,"AA",DFN,GMR(X),GMRDAT,Y)) Q:Y'>0!GMRDATS  I '$D(^GMR(120.5,Y,2)),$P(^GMR(120.5,Y,0),"^",8)'="" D SETNODE
"RTN","GMVLAT0",51,0)
 D:X="BP"!(X="P") SETBP
"RTN","GMVLAT0",52,0)
 Q
"RTN","GMVLAT0",53,0)
SETNODE ;
"RTN","GMVLAT0",54,0)
 N G S GMRL=$S($D(^GMR(120.5,Y,0)):^(0),1:"")
"RTN","GMVLAT0",55,0)
 I X'="P" S G=$P(GMRL,"^",8) Q:"REFUSEDPASSUNAVAILABLE"[$$UP^XLFSTR(G)
"RTN","GMVLAT0",56,0)
 I X="P" S OK=0,G=$P(GMRL,"^",8) D  Q:'OK
"RTN","GMVLAT0",57,0)
 . I "REFUSEDPASSUNAVAILABLE"[$$UP^XLFSTR(G) Q
"RTN","GMVLAT0",58,0)
 . I '$D(^GMR(120.5,Y,5,"B")) S OK=1 Q
"RTN","GMVLAT0",59,0)
 . I $D(^GMR(120.5,Y,5,"B",GAPICAL)) S OK=1 Q
"RTN","GMVLAT0",60,0)
 . I $D(^GMR(120.5,Y,5,"B",GRADIAL)) S OK=1 Q
"RTN","GMVLAT0",61,0)
 . I $D(^GMR(120.5,Y,5,"B",GBRACH)) S OK=1 Q
"RTN","GMVLAT0",62,0)
 S GMRL1=$P(GMRL,"^") ;adding trailing zeros to time if necessary
"RTN","GMVLAT0",63,0)
 S $P(GMRL1,".",2)=$P(GMRL1,".",2)_"0000"
"RTN","GMVLAT0",64,0)
 S $P(GMRL1,".",2)=$E($P(GMRL1,".",2),1,4)
"RTN","GMVLAT0",65,0)
 S $P(GMRL,"^")=GMRL1
"RTN","GMVLAT0",66,0)
 K GMRL1
"RTN","GMVLAT0",67,0)
 I GMRL'="" S GMRDATA(X,$P(GMRL,"^"),Y)=$P(GMRL,"^",8),GMRDATS=1 I $P($G(^GMR(120.5,Y,5,0)),"^",4)>0 D CHAR^GMVCHAR(Y,.GMRVARY,GMR(X))
"RTN","GMVLAT0",68,0)
 Q
"RTN","GMVLAT0",69,0)
WRTDT ;
"RTN","GMVLAT0",70,0)
 S GMRVDT=$E(GMVD,4,5)_"/"_$E(GMVD,6,7)_"/"_$E(GMVD,2,3)_"@"_$E($P(GMVD,".",2),1,2)_$S($E($P(GMVD,".",2),3,4)'="":":"_$E($P(GMVD,".",2),3,4),1:"")
"RTN","GMVLAT0",71,0)
 Q
"RTN","GMVLAT0",72,0)
CHAR ;
"RTN","GMVLAT0",73,0)
 S GMRZZ=$$WRITECH(GMVD(1),.GMRVARY,5) S:GMRZZ'=""&(X'="PO2") GMRZZ="("_GMRZZ_")"
"RTN","GMVLAT0",74,0)
 I X="PO2",$P(^GMR(120.5,GMVD(1),0),"^",10)'="" S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_"with supplemental O2" D
"RTN","GMVLAT0",75,0)
 . S GPO2=$P(^GMR(120.5,GMVD(1),0),"^",10)
"RTN","GMVLAT0",76,0)
 . S ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_" "_$S(GPO2["l/min":$P(GPO2," l/min")_" L/min",1:"")_$S(GPO2["l/min":$P(GPO2," l/min",2),1:GPO2)
"RTN","GMVLAT0",77,0)
 . K GPO2
"RTN","GMVLAT0",78,0)
 S:GMRZZ'="" ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_" "_GMRZZ K GMRZZ Q
"RTN","GMVLAT0",79,0)
 S:$G(GMRZZ)'="" ^TMP($J,"GRPC",GJ)=^TMP($J,"GRPC",GJ)_"  "_GMRZZ K GMRZZ
"RTN","GMVLAT0",80,0)
 Q
"RTN","GMVLAT0",81,0)
SETBP ;
"RTN","GMVLAT0",82,0)
 D SETBP^GMVLATS
"RTN","GMVLAT0",83,0)
 Q
"RTN","GMVLAT0",84,0)
WRITECH(GDA,GARRY,GN)   ;
"RTN","GMVLAT0",85,0)
 ; Input data:
"RTN","GMVLAT0",86,0)
 ; GDA - Pointer to the patient vitals/measurements data file #120.5
"RTN","GMVLAT0",87,0)
 ; GARRY - qualifier data array for a measurement
"RTN","GMVLAT0",88,0)
 ;         GARRY(GDA,Print order,qualifier data)
"RTN","GMVLAT0",89,0)
 ; GN - Number of print order to print
"RTN","GMVLAT0",90,0)
 N GMRVDA,GDATA
"RTN","GMVLAT0",91,0)
 S GDATA="",GMRVDA(1)=0
"RTN","GMVLAT0",92,0)
 F  S GMRVDA(1)=$O(GARRY(GDA,GMRVDA(1))) Q:GMRVDA(1)'>0!(GMRVDA(1)>GN)  S GMRVDA(2)="" F  S GMRVDA(2)=$O(GARRY(GDA,GMRVDA(1),GMRVDA(2))) Q:GMRVDA(2)=""  D
"RTN","GMVLAT0",93,0)
 . S GDATA=GDATA_","_GMRVDA(2)
"RTN","GMVLAT0",94,0)
 . Q
"RTN","GMVLAT0",95,0)
 I $E(GDATA,1)="," S GDATA=$E(GDATA,2,$L(GDATA)) ;strip off leading comma
"RTN","GMVLAT0",96,0)
 Q GDATA
"RTN","GMVRPCM")
0^5^B67999927
"RTN","GMVRPCM",1,0)
GMVRPCM ; HOIFO/DP - RPC for Vitals Manager ;6/20/03  12:08
"RTN","GMVRPCM",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1**;Oct 31, 2002
"RTN","GMVRPCM",3,0)
 ; Integration Agreements:
"RTN","GMVRPCM",4,0)
 ; #10040 [Supported] File 44 references
"RTN","GMVRPCM",5,0)
 ; #10076 [Supported] XUSEC Calls
"RTN","GMVRPCM",6,0)
 ; #2263 [Supported] XPAR Calls
"RTN","GMVRPCM",7,0)
 ; #2541 [Supported] XUPARAM Calls
"RTN","GMVRPCM",8,0)
 ; #2692 [Controlled] ORQPTQ1
"RTN","GMVRPCM",9,0)
 ; #3227 [Private] NURAPI Calls
"RTN","GMVRPCM",10,0)
 ; #4084 [Private] File 44 AC x-ref
"RTN","GMVRPCM",11,0)
 ;
"RTN","GMVRPCM",12,0)
ADDQUAL ; [Procedure] Add qualifier to vital/category
"RTN","GMVRPCM",13,0)
 S GMVVIT=+$P(DATA,";",1),GMVCAT=+$P(DATA,";",2),GMVQUAL=+$P(DATA,";",3)
"RTN","GMVRPCM",14,0)
 I $O(^GMRD(120.52,GMVQUAL,1,"B",GMVVIT,0)) D  Q
"RTN","GMVRPCM",15,0)
 .S @RESULTS@(0)="1^Qualifier already assigned."
"RTN","GMVRPCM",16,0)
 S GMVFDA(120.521,"+1,"_GMVQUAL_",",.01)=GMVVIT
"RTN","GMVRPCM",17,0)
 S GMVFDA(120.521,"+1,"_GMVQUAL_",",.02)=GMVCAT
"RTN","GMVRPCM",18,0)
 D UPDATE^DIE("","GMVFDA","GMVIEN","GMVERR")
"RTN","GMVRPCM",19,0)
 I $G(GMVIEN(1)) S @RESULTS@(0)=+GMVIEN(1)_"^Qualifier Assigned"
"RTN","GMVRPCM",20,0)
 E  S @RESULTS@(0)="-1^Unable to assign qualifier"
"RTN","GMVRPCM",21,0)
 Q
"RTN","GMVRPCM",22,0)
DELQUAL ; [Procedure] Delete qualifier from vital/category
"RTN","GMVRPCM",23,0)
 S GMVVIT=+$P(DATA,";",1),GMVCAT=+$P(DATA,";",2),GMVQUAL=+$P(DATA,";",3)
"RTN","GMVRPCM",24,0)
 S X=$O(^GMRD(120.52,GMVQUAL,1,"B",GMVVIT,0))
"RTN","GMVRPCM",25,0)
 S GMVFDA(120.521,X_","_GMVQUAL_",",.01)="@"
"RTN","GMVRPCM",26,0)
 D FILE^DIE("","GMVFDA","GMVERR")
"RTN","GMVRPCM",27,0)
 I $D(GMVERR) S @RESULTS@(0)="-1^Unable to remove qualifier."
"RTN","GMVRPCM",28,0)
 E  S @RESULTS@(0)="1^Qualifier removed."
"RTN","GMVRPCM",29,0)
 Q
"RTN","GMVRPCM",30,0)
DELTEMP ; [Procedure] Delete Template
"RTN","GMVRPCM",31,0)
 S GMVENT=$P(DATA,U,1),GMVNAME=$P(DATA,U,2)
"RTN","GMVRPCM",32,0)
 I $$GET^XPAR(GMVENT,"GMV TEMPLATE DEFAULT")=GMVNAME D
"RTN","GMVRPCM",33,0)
 .D DEL^XPAR(GMVENT,"GMV TEMPLATE DEFAULT",1)
"RTN","GMVRPCM",34,0)
 D DEL^XPAR(GMVENT,"GMV TEMPLATE",GMVNAME,.GMVERR)
"RTN","GMVRPCM",35,0)
 I '$G(GMVERR) S @RESULTS@(0)="1^Template Removed."
"RTN","GMVRPCM",36,0)
 E  S @RESULTS@(0)="-1^"_GMVERR
"RTN","GMVRPCM",37,0)
 Q
"RTN","GMVRPCM",38,0)
GETCATS ; [Procedure] Return Listing of categories
"RTN","GMVRPCM",39,0)
 F GMVCAT=0:0 S GMVCAT=$O(^GMRD(120.52,"AA",DATA,GMVCAT)) Q:'GMVCAT  D
"RTN","GMVRPCM",40,0)
 .S GMVQUAL="",X="" F  S X=$O(^GMRD(120.52,"AA",DATA,GMVCAT,X)) Q:X=""  D
"RTN","GMVRPCM",41,0)
 ..S GMVQUAL=GMVQUAL_$S(GMVQUAL]"":", ",1:"")_X
"RTN","GMVRPCM",42,0)
 .S Y=$O(@RESULTS@(""),-1)+1
"RTN","GMVRPCM",43,0)
 .S @RESULTS@(Y)=GMVCAT_U_$P(^GMRD(120.53,GMVCAT,0),U)_U_GMVQUAL
"RTN","GMVRPCM",44,0)
 S @RESULTS@(0)=+$O(@RESULTS@(""),-1)_U_$P(^GMRD(120.51,DATA,0),U)
"RTN","GMVRPCM",45,0)
 Q
"RTN","GMVRPCM",46,0)
GETDATA ; [Procedure] Generic fileman data call
"RTN","GMVRPCM",47,0)
 ; Variable DATA = File#^IENS^Field#
"RTN","GMVRPCM",48,0)
 S @RESULTS@(0)=$$GET1^DIQ($P(DATA,U,1),$P(DATA,U,2),$P(DATA,U,3))
"RTN","GMVRPCM",49,0)
 Q
"RTN","GMVRPCM",50,0)
GETDEF ; [Procedure] Get Default Template
"RTN","GMVRPCM",51,0)
 I $G(DATA)]"" D  Q
"RTN","GMVRPCM",52,0)
 .S X=$$GET^XPAR($P(DATA,U),"GMV TEMPLATE DEFAULT")
"RTN","GMVRPCM",53,0)
 .I X="" S @RESULTS@(0)="-1^No Default Template"
"RTN","GMVRPCM",54,0)
 .E  S @RESULTS@(0)=X
"RTN","GMVRPCM",55,0)
 D ENVAL^XPAR(.GMV,"GMV TEMPLATE DEFAULT")
"RTN","GMVRPCM",56,0)
 S X="" F  S X=$O(GMV(X)) Q:X=""  D
"RTN","GMVRPCM",57,0)
 .S Y=$O(@RESULTS@(""),-1)+1
"RTN","GMVRPCM",58,0)
 .S @RESULTS@(Y)=X_U_GMV(X,1)
"RTN","GMVRPCM",59,0)
 S @RESULTS@(0)=+$O(@RESULTS@(""),-1)
"RTN","GMVRPCM",60,0)
 Q
"RTN","GMVRPCM",61,0)
GETHILO ; [Procedure] Returns an abnormal value
"RTN","GMVRPCM",62,0)
 S @RESULTS@(0)=+$$GET1^DIQ(120.57,"1,",DATA)
"RTN","GMVRPCM",63,0)
 Q
"RTN","GMVRPCM",64,0)
GETLIST ; [Procedure] Return listing of file
"RTN","GMVRPCM",65,0)
 K GMVRET,^TMP("DILIST",$J)
"RTN","GMVRPCM",66,0)
 S GMVSCRN=""
"RTN","GMVRPCM",67,0)
 I +DATA=44 S DATA2=$P(DATA,U,2),DATA=+DATA
"RTN","GMVRPCM",68,0)
 I DATA=120.51 D  ; Set screen for vitals list
"RTN","GMVRPCM",69,0)
 .S GMVSCRN="I $$VITALIEN^GMVUTL8()[("",""_+Y_"","")"
"RTN","GMVRPCM",70,0)
 I DATA=42 D  ; Screen for ward location
"RTN","GMVRPCM",71,0)
 .S GMVSCRN="I '$$INACT42^GMVUT2(+Y)"
"RTN","GMVRPCM",72,0)
 I DATA=44 D  Q  ; Clinics
"RTN","GMVRPCM",73,0)
 .N CNT S X=DATA2,CNT=0
"RTN","GMVRPCM",74,0)
 .F  S X=$O(^SC("AC","C",X)) Q:'X!(CNT>100)  D
"RTN","GMVRPCM",75,0)
 ..Q:+$G(^SC(X,"OOS"))
"RTN","GMVRPCM",76,0)
 ..S Y=$G(^SC(X,"I"))
"RTN","GMVRPCM",77,0)
 ..I Y Q:DT>+Y&($P(Y,U,2)=""!(DT<$P(Y,U,2)))
"RTN","GMVRPCM",78,0)
 ..S @RESULTS@($O(@RESULTS@(""),-1)+1)=DATA_";"_X_U_$P(^SC(X,0),U),CNT=CNT+1
"RTN","GMVRPCM",79,0)
 .S @RESULTS@(0)=+$O(@RESULTS@(""),-1)
"RTN","GMVRPCM",80,0)
 I DATA=100.21 D  Q  ; CPRS Teams
"RTN","GMVRPCM",81,0)
 .D TEAMS^ORQPTQ1(.GMVRET)
"RTN","GMVRPCM",82,0)
 .F X=0:0 S X=$O(GMVRET(X)) Q:'X  S @RESULTS@(X)=DATA_";"_GMVRET(X)
"RTN","GMVRPCM",83,0)
 .S @RESULTS@(0)=+$O(@RESULTS@(""),-1)
"RTN","GMVRPCM",84,0)
 I DATA=211.4 D  Q  ; NURS Locations
"RTN","GMVRPCM",85,0)
 .D ACTLOCS^NURAPI(.GMVRET)
"RTN","GMVRPCM",86,0)
 .F X=0:0 S X=$O(GMVRET(X)) Q:'X  S @RESULTS@(X)=DATA_";"_GMVRET(X)
"RTN","GMVRPCM",87,0)
 .S @RESULTS@(0)=+$O(@RESULTS@(""),-1)
"RTN","GMVRPCM",88,0)
 D LIST^DIC(DATA,"","@;.01","P","","","","",GMVSCRN)
"RTN","GMVRPCM",89,0)
 F X=0:0 S X=$O(^TMP("DILIST",$J,X)) Q:'X  D
"RTN","GMVRPCM",90,0)
 .S @RESULTS@(X)=DATA_";"_^TMP("DILIST",$J,X,0)
"RTN","GMVRPCM",91,0)
 S @RESULTS@(0)=+$O(@RESULTS@(""),-1)_U_$$GET1^DID(DATA,"","","NAME")
"RTN","GMVRPCM",92,0)
 K ^TMP("DILIST",$J)
"RTN","GMVRPCM",93,0)
 Q
"RTN","GMVRPCM",94,0)
GETQUAL ; [Procedure] Return listing of qualifiers in list
"RTN","GMVRPCM",95,0)
 ; DATA=VitalIEN;CatIEN
"RTN","GMVRPCM",96,0)
 ; Uses X-ref of ^GMRD(120.52,"AA",VitalIEN,CategoryIEN,QName,QIEN)
"RTN","GMVRPCM",97,0)
 S GMVIT=+$P(DATA,";",1),GMVCAT=+$P(DATA,";",2)
"RTN","GMVRPCM",98,0)
 I '$D(^GMRD(120.53,GMVCAT,0)) S @RESULTS@(0)="-1^No such category" Q
"RTN","GMVRPCM",99,0)
 I '$D(^GMRD(120.51,GMVIT,0)) S @RESULTS@(0)="-1^No such vital" Q
"RTN","GMVRPCM",100,0)
 S GMVNAM=""
"RTN","GMVRPCM",101,0)
 F  S GMVNAM=$O(^GMRD(120.52,"AA",GMVIT,GMVCAT,GMVNAM)) Q:GMVNAM=""  D
"RTN","GMVRPCM",102,0)
 .S GMVIEN=$O(^GMRD(120.52,"AA",GMVIT,GMVCAT,GMVNAM,0))  ; Assume only one of this name
"RTN","GMVRPCM",103,0)
 .S Y=$O(@RESULTS@(""),-1)+1
"RTN","GMVRPCM",104,0)
 .S @RESULTS@(Y)=GMVIEN_U_GMVNAM
"RTN","GMVRPCM",105,0)
 S @RESULTS@(0)=+$O(@RESULTS@(""),-1)_U_$P(^GMRD(120.53,GMVCAT,0),U)
"RTN","GMVRPCM",106,0)
 Q
"RTN","GMVRPCM",107,0)
GETTEMP ; [Procedure] Get Template List
"RTN","GMVRPCM",108,0)
 I $G(DATA)]"" D
"RTN","GMVRPCM",109,0)
 .S GMVENT=$$ENTITY($P(DATA,U,1)),GMVNAME=$P(DATA,U,2)
"RTN","GMVRPCM",110,0)
 .I GMVNAME="" D
"RTN","GMVRPCM",111,0)
 ..D GETLST^XPAR(.GMVTMP,GMVENT,"GMV TEMPLATE")
"RTN","GMVRPCM",112,0)
 ..F X=0:0 S X=$O(GMVTMP(X)) Q:'X  D
"RTN","GMVRPCM",113,0)
 ...S GMV(GMVENT,$P(GMVTMP(X),U,1))=$P(GMVTMP(X),U,2,10)
"RTN","GMVRPCM",114,0)
 .I GMVNAME]"" S GMV(GMVENT,GMVNAME)=$$GET^XPAR(GMVENT,"GMV TEMPLATE",GMVNAME)
"RTN","GMVRPCM",115,0)
 I $G(DATA)="" D ENVAL^XPAR(.GMV,"GMV TEMPLATE")
"RTN","GMVRPCM",116,0)
 S GMVENT="",GMVNAME=""
"RTN","GMVRPCM",117,0)
 F  S GMVENT=$O(GMV(GMVENT)) Q:GMVENT=""  D
"RTN","GMVRPCM",118,0)
 .S GMVROOT=$P(GMVENT,";",2),GMVTYPE=$$TYPE(GMVROOT),GMVIEN=+GMVENT
"RTN","GMVRPCM",119,0)
 .Q:GMVTYPE=0  ;unknown template type
"RTN","GMVRPCM",120,0)
 .Q:GMVROOT="VA(200,"&('$$GET^XPAR("SYS","GMV ALLOW USER TEMPLATES"))
"RTN","GMVRPCM",121,0)
 .I GMVROOT="VA(200,"&(GMVIEN'=DUZ) Q:'$D(^XUSEC("GMV MANAGER",DUZ))
"RTN","GMVRPCM",122,0)
 .F  S GMVNAME=$O(GMV(GMVENT,GMVNAME)) Q:GMVNAME=""  D
"RTN","GMVRPCM",123,0)
 ..S GMVOWNER=$P($G(@(U_GMVROOT_(+GMVIEN)_",0)"),"Unk"),U)
"RTN","GMVRPCM",124,0)
 ..S Y=$O(@RESULTS@(""),-1)+1
"RTN","GMVRPCM",125,0)
 ..S @RESULTS@(Y)=GMVTYPE_U_GMVENT_U_GMVOWNER_U_GMVNAME_U_GMV(GMVENT,GMVNAME)
"RTN","GMVRPCM",126,0)
 S @RESULTS@(0)=+$O(@RESULTS@(""),-1)
"RTN","GMVRPCM",127,0)
 Q
"RTN","GMVRPCM",128,0)
LOOKUP ; [Procedure] Does a lookup on a file
"RTN","GMVRPCM",129,0)
 I $P(DATA,"^",3)="" S GMVFLD="@;.01"
"RTN","GMVRPCM",130,0)
 E  S GMVFLD="@;"_$P(DATA,"^",3)
"RTN","GMVRPCM",131,0)
 S GMVFLD=$P(GMVFLD,";",1,5) ; Limit lookup to 4 display fields
"RTN","GMVRPCM",132,0)
 D FIND^DIC(+DATA,"",GMVFLD,"P",$P(DATA,"^",2),61)
"RTN","GMVRPCM",133,0)
 I ^TMP("DILIST",$J,0)<1 D  Q
"RTN","GMVRPCM",134,0)
 .S @RESULTS@(0)="-1^No entries found matching '"_$P(DATA,U,2)_"'."
"RTN","GMVRPCM",135,0)
 I ^TMP("DILIST",$J,0)>60 D  Q
"RTN","GMVRPCM",136,0)
 .S @RESULTS@(0)="-1^To many matches found, please be more specific."
"RTN","GMVRPCM",137,0)
 F X=0:0 S X=$O(^TMP("DILIST",$J,X)) Q:'X  D
"RTN","GMVRPCM",138,0)
 .S @RESULTS@(X)=+DATA_";"_^TMP("DILIST",$J,X,0)
"RTN","GMVRPCM",139,0)
 S @RESULTS@(0)=+$O(@RESULTS@(""),-1)
"RTN","GMVRPCM",140,0)
 Q
"RTN","GMVRPCM",141,0)
NEWQUAL ; [Procedure] Create New Qualifier
"RTN","GMVRPCM",142,0)
 D VAL^DIE(120.52,"+1,",".01","F",DATA,.GMVRET,"GMVFDA")
"RTN","GMVRPCM",143,0)
 I '$D(GMVFDA) S @RESULTS@(0)="-1^Invalid Qualifier Name" Q
"RTN","GMVRPCM",144,0)
 D VAL^DIE(120.52,"+1,",".02","F","xx",.GMVRET,"GMVFDA")
"RTN","GMVRPCM",145,0)
 D UPDATE^DIE("","GMVFDA","GMVIEN")
"RTN","GMVRPCM",146,0)
 S @RESULTS@(0)="120.52;"_GMVIEN(1)_"^"_DATA
"RTN","GMVRPCM",147,0)
 Q
"RTN","GMVRPCM",148,0)
NEWTEMP ; [Procedure] New Template
"RTN","GMVRPCM",149,0)
 S GMVENT=$P(DATA,"^",1),GMVNAME=$P(DATA,"^",2),GMVDESC=$P(DATA,"^",3)
"RTN","GMVRPCM",150,0)
 S GMVENT=$$ENTITY(GMVENT)
"RTN","GMVRPCM",151,0)
 S GMVTYPE=$$TYPE($P(GMVENT,";",2))
"RTN","GMVRPCM",152,0)
 S GMVOWN=$P($G(@(U_$P(GMVENT,";",2)_+GMVENT_",0)"),"Unk"),U)
"RTN","GMVRPCM",153,0)
 S:GMVDESC="" GMVDESC="No Description"
"RTN","GMVRPCM",154,0)
 D ADD^XPAR(GMVENT,"GMV TEMPLATE",GMVNAME,GMVDESC,.GMVERR)
"RTN","GMVRPCM",155,0)
 I 'GMVERR S @RESULTS@(0)=GMVTYPE_U_GMVENT_U_GMVOWN_U_GMVNAME
"RTN","GMVRPCM",156,0)
 E  S @RESULTS@(0)="-1^"_GMVERR
"RTN","GMVRPCM",157,0)
 Q
"RTN","GMVRPCM",158,0)
RENTEMP ; [Procedure] Rename a Template
"RTN","GMVRPCM",159,0)
 S GMVENT=$P(DATA,U,1),GMVOLD=$P(DATA,U,2),GMVNEW=$P(DATA,U,3)
"RTN","GMVRPCM",160,0)
 D REP^XPAR(GMVENT,"GMV TEMPLATE",GMVOLD,GMVNEW,.GMVERR)
"RTN","GMVRPCM",161,0)
 I 'GMVERR S @RESULTS@(0)="1^Renamed"
"RTN","GMVRPCM",162,0)
 E  S @RESULTS@(0)="-1^"_GMVERR Q
"RTN","GMVRPCM",163,0)
 ; Reset default template if this was a default template
"RTN","GMVRPCM",164,0)
 D:$$GET^XPAR(GMVENT,"GMV TEMPLATE DEFAULT")=GMVOLD
"RTN","GMVRPCM",165,0)
 .D EN^XPAR(GMVENT,"GMV TEMPLATE DEFAULT",1,GMVNEW)
"RTN","GMVRPCM",166,0)
 Q
"RTN","GMVRPCM",167,0)
RPC(RESULTS,OPTION,DATA) ; [Procedure] Main RPC call tag
"RTN","GMVRPCM",168,0)
 ; RPC: [GMV MANAGER]
"RTN","GMVRPCM",169,0)
 ;
"RTN","GMVRPCM",170,0)
 ; Input parameters
"RTN","GMVRPCM",171,0)
 ;  1. RESULTS [Reference/Required] RPC Return array
"RTN","GMVRPCM",172,0)
 ;  2. OPTION [Literal/Required] RPC Option to execute
"RTN","GMVRPCM",173,0)
 ;  3. DATA [Literal/Required] Other data as required for call
"RTN","GMVRPCM",174,0)
 ;
"RTN","GMVRPCM",175,0)
 N GMV,GMVCAT,GMVDESC,GMVENT,GMVERR,GMVFDA,GMVFLD,GMVIEN,GMVIT,GMVNAM,GMVNAME,GMVNEW,GMVOLD,GMVOWN,GMVOWNER,GMVQUAL,GMVROOT,GMVTYPE,GMVVAL,GMVVIT,GMVSCRN
"RTN","GMVRPCM",176,0)
 S RESULTS=$NA(^TMP("GMVMGR",$J)) K @RESULTS
"RTN","GMVRPCM",177,0)
 D:$T(@OPTION)]"" @OPTION
"RTN","GMVRPCM",178,0)
 S:'$D(@RESULTS) @RESULTS@(0)="-1^No results returned"
"RTN","GMVRPCM",179,0)
 D CLEAN^DILF
"RTN","GMVRPCM",180,0)
 Q
"RTN","GMVRPCM",181,0)
SETDATA ; [Procedure] Save New Qualifier Name/Abbv
"RTN","GMVRPCM",182,0)
 D VAL^DIE($P(DATA,U,1),$P(DATA,U,2),$P(DATA,U,3),"FH",$P(DATA,U,4),.GMVRET,"GMVFDA")
"RTN","GMVRPCM",183,0)
 D FILE^DIE("","GMVFDA")
"RTN","GMVRPCM",184,0)
 S @RESULTS@(0)="1^OK"
"RTN","GMVRPCM",185,0)
 Q
"RTN","GMVRPCM",186,0)
SETDEF ; [Procedure] Set Default Template
"RTN","GMVRPCM",187,0)
 D EN^XPAR($P(DATA,U),"GMV TEMPLATE DEFAULT",1,$P(DATA,U,2),.GMVERR)
"RTN","GMVRPCM",188,0)
 I '$G(GMVERR) S @RESULTS@(0)="1^Set As Default."
"RTN","GMVRPCM",189,0)
 E  S @RESULTS@(0)="-1^"_GMVERR
"RTN","GMVRPCM",190,0)
 Q
"RTN","GMVRPCM",191,0)
SETHILO ; [Procedure] Set abnormal value
"RTN","GMVRPCM",192,0)
 L +(^GMRD(120.57,0)):5
"RTN","GMVRPCM",193,0)
 E  S @RESULTS@(0)="-1^Site File In Use." Q
"RTN","GMVRPCM",194,0)
 S GMVFLD=$P(DATA,"^",1),GMVVAL=$P(DATA,"^",2)
"RTN","GMVRPCM",195,0)
 S GMVFDA(120.57,"1,",GMVFLD)=GMVVAL
"RTN","GMVRPCM",196,0)
 D FILE^DIE("","GMVFDA","GMVERR")
"RTN","GMVRPCM",197,0)
 L -(^GMRD(120.57,0))
"RTN","GMVRPCM",198,0)
 S @RESULTS@(0)="1^Update Complete."
"RTN","GMVRPCM",199,0)
 Q
"RTN","GMVRPCM",200,0)
SETTEMP ; [Procedure] Set Template data
"RTN","GMVRPCM",201,0)
 D EN^XPAR($P(DATA,U),"GMV TEMPLATE",$P(DATA,U,2),$P(DATA,U,3),.GMVERR)
"RTN","GMVRPCM",202,0)
 I '$G(GMVERR) S @RESULTS@(0)="1^Template Saved."
"RTN","GMVRPCM",203,0)
 E  S @RESULTS@(0)="-1^"_GMVERR
"RTN","GMVRPCM",204,0)
 Q
"RTN","GMVRPCM",205,0)
VALID ; [Procedure] Verify data validity against fileman
"RTN","GMVRPCM",206,0)
 D VAL^DIE($P(DATA,U,1),$P(DATA,U,2),$P(DATA,U,3),"H",$P(DATA,U,4),.GMVRET)
"RTN","GMVRPCM",207,0)
 I GMVRET'="^" S @RESULTS@(0)="1^Valid Data"
"RTN","GMVRPCM",208,0)
 E  S @RESULTS@(0)="-1^"_^TMP("DIERR",$J,1,"TEXT",1)
"RTN","GMVRPCM",209,0)
 Q
"RTN","GMVRPCM",210,0)
ENTITY(X) ; [Function] Convert USR, SYS, and DIV entities
"RTN","GMVRPCM",211,0)
 ; Input parameters
"RTN","GMVRPCM",212,0)
 ;  1. X [Literal/Required] XPAR generic entity to transform to variable pointer format
"RTN","GMVRPCM",213,0)
 ;
"RTN","GMVRPCM",214,0)
 Q:X="USR" DUZ_";VA(200,"
"RTN","GMVRPCM",215,0)
 Q:X="SYS" $$FIND1^DIC(4.2,"","QX",$$KSP^XUPARAM("WHERE"))_";DIC(4.2,"
"RTN","GMVRPCM",216,0)
 Q:X="DIV" DUZ(2)_";DIC(4,"
"RTN","GMVRPCM",217,0)
 Q X
"RTN","GMVRPCM",218,0)
 ;
"RTN","GMVRPCM",219,0)
TYPE(X) ; [Function] Returns the type of template
"RTN","GMVRPCM",220,0)
 ; Input parameters
"RTN","GMVRPCM",221,0)
 ;  1. X [Literal/Required] Variable pointer to evaluate
"RTN","GMVRPCM",222,0)
 ;
"RTN","GMVRPCM",223,0)
 Q:X="DIC(4.2," 1 ;Domain
"RTN","GMVRPCM",224,0)
 Q:X="DIC(4," 2 ;  Institution
"RTN","GMVRPCM",225,0)
 Q:X="SC(" 3 ;     Hospital Location
"RTN","GMVRPCM",226,0)
 Q:X="VA(200," 4 ; New Person
"RTN","GMVRPCM",227,0)
 Q 0 ;             Unknown
"RTN","GMVRPCM",228,0)
 ;
"RTN","GMVRPCM",229,0)
VT ;VitalTypeIENS
"RTN","GMVRPCM",230,0)
 N X,Y,Z
"RTN","GMVRPCM",231,0)
 S Y=0,@RESULTS@(0)="-1"
"RTN","GMVRPCM",232,0)
 F X="T","P","R","BP","HT","WT","PN","PO2","CVP","CG" D
"RTN","GMVRPCM",233,0)
 .S Z=$O(^GMRD(120.51,"C",X,0))
"RTN","GMVRPCM",234,0)
 .Q:'Z
"RTN","GMVRPCM",235,0)
 .S Y=Y+1,@RESULTS@(Y)=Z
"RTN","GMVRPCM",236,0)
 Q
"RTN","GMVRPCP")
0^6^B24862995
"RTN","GMVRPCP",1,0)
GMVRPCP ;HOIFO/DP-RPC for GMV_PtSelect.pas ;6/24/03  13:04
"RTN","GMVRPCP",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1**;Oct 31, 2002
"RTN","GMVRPCP",3,0)
 ; Integration Agreements:
"RTN","GMVRPCP",4,0)
 ; IA# 510 [Controlled] Calls to set ^DISV
"RTN","GMVRPCP",5,0)
 ; IA# 3027 [Supported] Calls to DGSEC4
"RTN","GMVRPCP",6,0)
 ; IA# 3266 [Controlled] Calls to DOB^DPTLK1
"RTN","GMVRPCP",7,0)
 ; IA# 3267 [Controlled] Calls to SSN^DPTLK1
"RTN","GMVRPCP",8,0)
 ; IA# 3593 [Supported] Calls to DPTLK6
"RTN","GMVRPCP",9,0)
 ; IA# 10035 [Supported] Calls for FILE 2 references.
"RTN","GMVRPCP",10,0)
 ; IA# 10039 [Supported] Reads of ^DIC(42,#,44)
"RTN","GMVRPCP",11,0)
 ; IA# 10061 [Supported] Calls to VADPT
"RTN","GMVRPCP",12,0)
 ;
"RTN","GMVRPCP",13,0)
ADD(X) ; [Procedure] Add line to @RESULTS@(...
"RTN","GMVRPCP",14,0)
 ; Input parameters
"RTN","GMVRPCP",15,0)
 ;  1. X [Literal/Required] Data to add to @RESULTS@(...
"RTN","GMVRPCP",16,0)
 S @RESULTS@(+$O(@RESULTS@(""),-1)+1)=X
"RTN","GMVRPCP",17,0)
 Q
"RTN","GMVRPCP",18,0)
 ;
"RTN","GMVRPCP",19,0)
LOGSEC ; [Procedure] Log Security
"RTN","GMVRPCP",20,0)
 D NOTICE^DGSEC4(.GMVRET,DFN,DATA,1)
"RTN","GMVRPCP",21,0)
 S @RESULTS@(0)=$S(GMVRET:"1^Logged",1:"-1^Unable to log")
"RTN","GMVRPCP",22,0)
 Q
"RTN","GMVRPCP",23,0)
 ;
"RTN","GMVRPCP",24,0)
RPC(RESULTS,OPTION,DFN,DATA) ; [Procedure] Main RPC call tag
"RTN","GMVRPCP",25,0)
 ; RPC: [GMV PTSELECT]
"RTN","GMVRPCP",26,0)
 ; Input parameters
"RTN","GMVRPCP",27,0)
 ;  1. RESULTS [Literal/Required] RPC return array
"RTN","GMVRPCP",28,0)
 ;  2. OPTION [Literal/Required] Call method for RPC
"RTN","GMVRPCP",29,0)
 ;  3. DFN [Literal/Required] Patient IEN
"RTN","GMVRPCP",30,0)
 ;  4. DATA [Literal/Optional] Other data as required for call
"RTN","GMVRPCP",31,0)
 S RESULTS=$NA(^TMP("GMVPTSELECT",$J)) K @RESULTS
"RTN","GMVRPCP",32,0)
 D:$T(@OPTION)]"" @OPTION
"RTN","GMVRPCP",33,0)
 D:'$D(@RESULTS)
"RTN","GMVRPCP",34,0)
 .S @RESULTS@(0)="-1^No results returned"
"RTN","GMVRPCP",35,0)
 D CLEAN^DILF
"RTN","GMVRPCP",36,0)
 Q
"RTN","GMVRPCP",37,0)
 ;
"RTN","GMVRPCP",38,0)
HOSPLOC ; [Procedure] Return location as ptr to 44 or ""
"RTN","GMVRPCP",39,0)
 N VAIN
"RTN","GMVRPCP",40,0)
 D INP^VADPT S @RESULTS@(0)=+$G(^DIC(42,+VAIN(4),44),"")
"RTN","GMVRPCP",41,0)
 Q
"RTN","GMVRPCP",42,0)
 ;
"RTN","GMVRPCP",43,0)
PTHDR ; [Procedure] Patient Infoe for Header Displays
"RTN","GMVRPCP",44,0)
 I '$D(^DPT(+$G(DFN),0)) D  Q
"RTN","GMVRPCP",45,0)
 .S @RESULTS@(0)="-1^No Such DFN ["_$G(DFN,"<Null>")_"]"
"RTN","GMVRPCP",46,0)
 S @RESULTS@(0)=+DFN,GMVIENS=(+DFN)_","
"RTN","GMVRPCP",47,0)
 S @RESULTS@(1)=$$GET1^DIQ(2,GMVIENS,.01)_"  "_$$GET1^DIQ(2,GMVIENS,.09)
"RTN","GMVRPCP",48,0)
 S @RESULTS@(2)="DOB: "_$$GET1^DIQ(2,GMVIENS,.03)_" "_$$GET1^DIQ(2,GMVIENS,.02)_", Age: "_$$GET1^DIQ(2,GMVIENS,.033)
"RTN","GMVRPCP",49,0)
 Q
"RTN","GMVRPCP",50,0)
 ;
"RTN","GMVRPCP",51,0)
PTLKUP ; [Procedure] Patient lookup handled separately for security
"RTN","GMVRPCP",52,0)
 N GMVIDX
"RTN","GMVRPCP",53,0)
 S GMVIDX=$S(DATA?9N.1"P":"SSN",1:"B^BS^BS5")
"RTN","GMVRPCP",54,0)
 D FIND^DIC(2,"","@;.01;.02;.03;.09","MP",DATA,60,GMVIDX)
"RTN","GMVRPCP",55,0)
 I $P(^TMP("DILIST",$J,0),U,3) D  Q
"RTN","GMVRPCP",56,0)
 .S @RESULTS@(0)="-1^To many patients found matching '"_DATA_"'. Please be more specific."
"RTN","GMVRPCP",57,0)
 F GMV=0:0 S GMV=$O(^TMP("DILIST",$J,GMV)) Q:'GMV  D
"RTN","GMVRPCP",58,0)
 .S @RESULTS@(GMV)=$$PTREC(+^TMP("DILIST",$J,GMV,0))
"RTN","GMVRPCP",59,0)
 I '$D(@RESULTS) S @RESULTS@(0)="-1^No patients matching '"_DATA_"'"
"RTN","GMVRPCP",60,0)
 E  S @RESULTS@(0)=+$O(@RESULTS@(""),-1)
"RTN","GMVRPCP",61,0)
 Q
"RTN","GMVRPCP",62,0)
 ;
"RTN","GMVRPCP",63,0)
PTREC(DFN) ;
"RTN","GMVRPCP",64,0)
 ; Extrinsic to return a Pt Rec  in standard list format
"RTN","GMVRPCP",65,0)
 N GMV
"RTN","GMVRPCP",66,0)
 S GMV=$G(^DPT(DFN,0))
"RTN","GMVRPCP",67,0)
 S GMV="2;"_DFN_U_$P(GMV,U,1)_U_$P(GMV,U,2)_U_$P(GMV,U,3)_U_$P(GMV,U,9)
"RTN","GMVRPCP",68,0)
 S $P(GMV,U,10)=$$DOB^DPTLK1(DFN)
"RTN","GMVRPCP",69,0)
 S $P(GMV,U,11)=$$SSN^DPTLK1(DFN)
"RTN","GMVRPCP",70,0)
 Q GMV
"RTN","GMVRPCP",71,0)
 ;
"RTN","GMVRPCP",72,0)
SELECT ; [Procedure] Select patient
"RTN","GMVRPCP",73,0)
 ; Calls required utilities to check security and
"RTN","GMVRPCP",74,0)
 ; return associated warnings/alerts about a
"RTN","GMVRPCP",75,0)
 ; patient being selected.
"RTN","GMVRPCP",76,0)
 ; Variables:
"RTN","GMVRPCP",77,0)
 ;  IENS: [Private] Fileman IENS
"RTN","GMVRPCP",78,0)
 ;  GMVDFN: [Private] Scratch
"RTN","GMVRPCP",79,0)
 ;  GMVFLD: [Private] FIeld number
"RTN","GMVRPCP",80,0)
 ;  GMVID: [Private] Identifier array
"RTN","GMVRPCP",81,0)
 ;  GMVRET: [Private] Scratch
"RTN","GMVRPCP",82,0)
 ;  GMVX: [Private] Scratch
"RTN","GMVRPCP",83,0)
 ; New private variables
"RTN","GMVRPCP",84,0)
 NEW IENS,GMVDFN,GMVFLD,GMVID,GMVRET,GMVX
"RTN","GMVRPCP",85,0)
 I '$D(^DPT(+$G(DFN),0))#2 S @RESULTS@(0)="-1^No such patient" Q
"RTN","GMVRPCP",86,0)
 S ^DISV(DUZ,"^DPT(")=DFN ;spacebar return
"RTN","GMVRPCP",87,0)
 S @RESULTS@(0)="1^Required Identifiers & messages"
"RTN","GMVRPCP",88,0)
 S IENS=DFN_","
"RTN","GMVRPCP",89,0)
 D FILE^DID(2,,"REQUIRED IDENTIFIERS","GMVIDS")
"RTN","GMVRPCP",90,0)
 F GMVX=0:0 S GMVX=$O(GMVIDS("REQUIRED IDENTIFIERS",GMVX)) Q:'GMVX  D
"RTN","GMVRPCP",91,0)
 .S GMVFLD=GMVIDS("REQUIRED IDENTIFIERS",GMVX,"FIELD")
"RTN","GMVRPCP",92,0)
 .S GMVID="$$PTID^"_$$GET1^DID(2,GMVFLD,"","LABEL")
"RTN","GMVRPCP",93,0)
 .S GMVID=GMVID_U_$$GET1^DIQ(2,IENS,GMVFLD)
"RTN","GMVRPCP",94,0)
 .D:GMVFLD=.03
"RTN","GMVRPCP",95,0)
 ..S GMVID=GMVID_" ("_$$GET1^DIQ(2,IENS,.033)_")"
"RTN","GMVRPCP",96,0)
 ..S GMVID=GMVID_U_$$DOB^DPTLK1(+IENS)
"RTN","GMVRPCP",97,0)
 .D:GMVFLD=.09
"RTN","GMVRPCP",98,0)
 ..S X=$P(GMVID,U,3),X=$E(X,1,3)_"-"_$E(X,4,5)_"-"_$E(X,6,10)
"RTN","GMVRPCP",99,0)
 ..S $P(GMVID,U,3)=X,$P(GMVID,U,4)=$$SSN^DPTLK1(+IENS)
"RTN","GMVRPCP",100,0)
 .S @RESULTS@($O(@RESULTS@(""),-1)+1)=GMVID
"RTN","GMVRPCP",101,0)
 ; Add ward and Room/Bed
"RTN","GMVRPCP",102,0)
 S GMVID="$$PTID^"_$$GET1^DID(2,.1,"","LABEL")
"RTN","GMVRPCP",103,0)
 S GMVID=GMVID_U_$$GET1^DIQ(2,IENS,.1)
"RTN","GMVRPCP",104,0)
 S @RESULTS@($O(@RESULTS@(""),-1)+1)=GMVID
"RTN","GMVRPCP",105,0)
 S GMVID="$$PTID^"_$$GET1^DID(2,.101,"","LABEL")
"RTN","GMVRPCP",106,0)
 S GMVID=GMVID_U_$$GET1^DIQ(2,IENS,.101)
"RTN","GMVRPCP",107,0)
 S @RESULTS@($O(@RESULTS@(""),-1)+1)=GMVID
"RTN","GMVRPCP",108,0)
 ; ------- Clevland Alert -------
"RTN","GMVRPCP",109,0)
 K GMVRET
"RTN","GMVRPCP",110,0)
 D GUIBS5A^DPTLK6(.GMVRET,DFN) D:GMVRET(1)=1
"RTN","GMVRPCP",111,0)
 .D ADD("$$MSGHDR^2^SAME LAST NAME AND LAST 4")
"RTN","GMVRPCP",112,0)
 .S GMVX=1
"RTN","GMVRPCP",113,0)
 .F  S GMVX=$O(GMVRET(GMVX)) Q:'GMVX!(+$G(GMVRET(GMVX)))  D
"RTN","GMVRPCP",114,0)
 ..D ADD($P(GMVRET(GMVX),U,2))
"RTN","GMVRPCP",115,0)
 .D ADD(" ")
"RTN","GMVRPCP",116,0)
 .S GMVX=1
"RTN","GMVRPCP",117,0)
 .F  S GMVX=$O(GMVRET(GMVX)) Q:'GMVX  D:+GMVRET(GMVX)
"RTN","GMVRPCP",118,0)
 ..S GMVDFN=+$P(GMVRET(GMVX),U,2)
"RTN","GMVRPCP",119,0)
 ..D ADD($$GET1^DIQ(2,GMVDFN_",",.01)_"    "_$$DOB^DPTLK1(GMVDFN)_"    "_$$SSN^DPTLK1(GMVDFN))
"RTN","GMVRPCP",120,0)
 .D ADD(" ")
"RTN","GMVRPCP",121,0)
 .D ADD("Please review carefully before continuing")
"RTN","GMVRPCP",122,0)
 .D ADD("$$MSGEND")
"RTN","GMVRPCP",123,0)
 ; ------- Sensitive Record? -------
"RTN","GMVRPCP",124,0)
 K GMVRET
"RTN","GMVRPCP",125,0)
 D PTSEC^DGSEC4(.GMVRET,DFN) D:GMVRET(1)'=0
"RTN","GMVRPCP",126,0)
 .D:GMVRET(1)=3
"RTN","GMVRPCP",127,0)
 ..D ADD("$$MSGHDR^0^CAN'T ACCESS YOUR OWN RECORD!!")
"RTN","GMVRPCP",128,0)
 .D:GMVRET(1)=-1
"RTN","GMVRPCP",129,0)
 ..D ADD("$$MSGHDR^0^INCOMPLETE INFORMATION - CAN'T PROCEED")
"RTN","GMVRPCP",130,0)
 .D:GMVRET(1)=1
"RTN","GMVRPCP",131,0)
 ..D ADD("$$MSGHDR^1^SENSITIVE RECORD ACCESS")
"RTN","GMVRPCP",132,0)
 .D:GMVRET(1)'=-1&(GMVRET(1)'=3)&(GMVRET(1)'=1)
"RTN","GMVRPCP",133,0)
 ..D ADD("$$MSGHDR^3^SENSITIVE RECORD ACCESS")
"RTN","GMVRPCP",134,0)
 .S GMVX=1
"RTN","GMVRPCP",135,0)
 .F  S GMVX=$O(GMVRET(GMVX)) Q:'GMVX  D ADD($TR(GMVRET(GMVX),"*"," "))
"RTN","GMVRPCP",136,0)
 .D ADD("$$MSGEND")
"RTN","GMVRPCP",137,0)
 ; ------- Means Test Information? -------
"RTN","GMVRPCP",138,0)
 D GUIMTD^DPTLK6(.GMVRET,DFN) D:GMVRET(1)=1
"RTN","GMVRPCP",139,0)
 .D ADD("$$MSGHDR^1^NOTICE")
"RTN","GMVRPCP",140,0)
 .F GMVX=1:0 S GMVX=$O(GMVRET(GMVX)) Q:'GMVX  D ADD(GMVRET(GMVX))
"RTN","GMVRPCP",141,0)
 .D ADD("$$MSGEND")
"RTN","GMVRPCP",142,0)
 Q
"RTN","GMVRPCP",143,0)
 ;
"RTN","GMVTBL0")
1^7
"RTN","GMVTBL1")
1^8
"RTN","GMVTBL2")
1^9
"RTN","GMVTBL3")
1^10
"RTN","GMVTBL4")
1^11
"RTN","GMVUTL1")
0^17^B4892410
"RTN","GMVUTL1",1,0)
GMVUTL1 ;HOIFO/YH,FT-EXTRACT CLINIC LIST AND MARK VITALS ENTERED IN ERROR ;6/11/03  09:25
"RTN","GMVUTL1",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1**;Oct 31, 2002
"RTN","GMVUTL1",3,0)
 ;
"RTN","GMVUTL1",4,0)
 ; This routine uses the following IAs:
"RTN","GMVUTL1",5,0)
 ;  #1246 - WIN^DGPMDDCF           (supported)
"RTN","GMVUTL1",6,0)
 ; #10039 - FILE 42 references     (supported)
"RTN","GMVUTL1",7,0)
 ; #10040 - ^SC( references        (supported)
"RTN","GMVUTL1",8,0)
 ; #10060 - FILE 200 fields        (supported)
"RTN","GMVUTL1",9,0)
 ; #10090 - FILE 4 references      (supported)
"RTN","GMVUTL1",10,0)
 ; #10104 - ^XLFSTR calls          (supported)
"RTN","GMVUTL1",11,0)
 ;
"RTN","GMVUTL1",12,0)
ERROR(RESULT,GMVDATA)  ;GMV MARK ERROR [RPC entry point]
"RTN","GMVUTL1",13,0)
 ;GMVDATA CONSISTS OF THE FOLLOWING DATA:
"RTN","GMVUTL1",14,0)
 ;FILE # 120.5 IEN^DUZ^INCORRECT DATE/TIME^INCORRECT READING^INCORRECT
"RTN","GMVUTL1",15,0)
 ;PATIENT^INVALID RECORD
"RTN","GMVUTL1",16,0)
 N GMVFDA,GMVIEN,GMVIENS
"RTN","GMVUTL1",17,0)
 I '$D(^GMR(120.5,+GMVDATA,0))#2 S RESULT="ERROR: Record Not Found" Q
"RTN","GMVUTL1",18,0)
 S GMVIENS=(+GMVDATA)_","
"RTN","GMVUTL1",19,0)
 S GMVFDA(120.5,GMVIENS,2)=1
"RTN","GMVUTL1",20,0)
 S GMVFDA(120.5,GMVIENS,3)=$P(GMVDATA,"^",2)
"RTN","GMVUTL1",21,0)
 S GMVFDA(120.506,"+1,"_GMVIENS,.01)=$P(GMVDATA,"^",3)
"RTN","GMVUTL1",22,0)
 D UPDATE^DIE("","GMVFDA","GMVIEN")
"RTN","GMVUTL1",23,0)
 S RESULT="OK"
"RTN","GMVUTL1",24,0)
 Q
"RTN","GMVUTL1",25,0)
 ;
"RTN","GMVUTL1",26,0)
ACTLOC(LOC) ; Function: returns TRUE if active hospital location
"RTN","GMVUTL1",27,0)
 N D0,X I +$G(^SC(LOC,"OOS")) Q 0                ; screen out OOS entry
"RTN","GMVUTL1",28,0)
 S D0=+$G(^SC(LOC,42)) I D0 D WIN^DGPMDDCF Q 'X  ; chk out of svc wards
"RTN","GMVUTL1",29,0)
 S X=$G(^SC(LOC,"I")) I +X=0 Q 1                 ; no inactivate date
"RTN","GMVUTL1",30,0)
 I DT>$P(X,U)&($P(X,U,2)=""!(DT<$P(X,U,2))) Q 0  ; chk reactivate date
"RTN","GMVUTL1",31,0)
 Q 1                                             ; must still be active
"RTN","GMVUTL1",32,0)
 ;
"RTN","GMVUTL1",33,0)
PERSON(X) ;RETURN PERSON'S NAME FROM FILE #200.
"RTN","GMVUTL1",34,0)
 N GMVNAME
"RTN","GMVUTL1",35,0)
 Q:'X ""
"RTN","GMVUTL1",36,0)
 S GMVNAME=$$GET1^DIQ(200,X,.01,"E")
"RTN","GMVUTL1",37,0)
 Q $S(GMVNAME'="":GMVNAME,1:"")
"RTN","GMVUTL1",38,0)
FILLER(L,S,STRING)     ; Returns the number of filler characters desired.
"RTN","GMVUTL1",39,0)
 ; L - larger number
"RTN","GMVUTL1",40,0)
 ; S - smaller number
"RTN","GMVUTL1",41,0)
 ; STRING - string of same characters (e.g., spaces)
"RTN","GMVUTL1",42,0)
 ; Use spaces if STRING is not defined.
"RTN","GMVUTL1",43,0)
 I $L(STRING)=0 S STRING=$$REPEAT^XLFSTR(" ",79) ;line of spaces
"RTN","GMVUTL1",44,0)
 Q $E(STRING,1,L-S)
"RTN","GMVUTL1",45,0)
 ;
"RTN","GMVUTL1",46,0)
HOSPLOC(GMVWARD) ; Function returns Hospital Location IEN for a ward
"RTN","GMVUTL1",47,0)
 ; Input:
"RTN","GMVUTL1",48,0)
 ;  GMVWARD - Ward (FILE 42) IEN
"RTN","GMVUTL1",49,0)
 ; Returns:
"RTN","GMVUTL1",50,0)
 ;  Hospital Location (FILE 44) IEN for the ward
"RTN","GMVUTL1",51,0)
 ;  If GMVWARD'>0 or not found, then returns "" (null)
"RTN","GMVUTL1",52,0)
 I $G(GMVWARD)'>0 Q ""  ;illegal ward ien
"RTN","GMVUTL1",53,0)
 Q $P($G(^DIC(42,+GMVWARD,44)),"^")
"RTN","GMVUTL1",54,0)
 ;
"RTN","GMVUTL1",55,0)
DIVISION(GMVLOC) ; Function returns Division name for Hospital Location
"RTN","GMVUTL1",56,0)
 ; (FILE 44) IEN
"RTN","GMVUTL1",57,0)
 ; Input:
"RTN","GMVUTL1",58,0)
 ;  GMVLOC - Hospital Location (FILE 44) IEN
"RTN","GMVUTL1",59,0)
 ; Returns:
"RTN","GMVUTL1",60,0)
 ;  Division name (FILE 4) associated with that Hospital Location
"RTN","GMVUTL1",61,0)
 ;  If GMVLOC'>0 or not found, then returns "" (null)
"RTN","GMVUTL1",62,0)
 I $G(GMVLOC)'>0 Q ""  ;illegal hospital location
"RTN","GMVUTL1",63,0)
 Q $S(GMVLOC>0:$$GET1^DIQ(4,+$$GET1^DIQ(44,+GMVLOC,3,"I"),.01,"I"),1:"")
"RTN","GMVUTL1",64,0)
 ;
"RTN","GMVUTL5")
1^13
"RTN","GMVUTL8")
0^2^B2694671
"RTN","GMVUTL8",1,0)
GMVUTL8 ;HIOFO/DS-RPC API TO RETURN ALL VITALS/CATOGORIES/QUALIFIERS ;12/4/02  16:17
"RTN","GMVUTL8",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1**;Oct 31, 2002
"RTN","GMVUTL8",3,0)
 ;
"RTN","GMVUTL8",4,0)
 ; This routine uses the following IAs:
"RTN","GMVUTL8",5,0)
 ;  #3227 - ^NURAPI calls          (private)
"RTN","GMVUTL8",6,0)
 ;
"RTN","GMVUTL8",7,0)
APTLIST(ARRAY,LOC) ; Returns a list of active patients for a nursing
"RTN","GMVUTL8",8,0)
 ; location in the array specified. [RPC entry point]
"RTN","GMVUTL8",9,0)
 ;  input:   LOC - (Required) NURS LOCATION file (#211.4) ien
"RTN","GMVUTL8",10,0)
 ;  input: ARRAY - (Required) Name of the array to return entries in
"RTN","GMVUTL8",11,0)
 ; output: ARRAY - Subscripted by sequential number with DFN in first
"RTN","GMVUTL8",12,0)
 ;                 piece and patient name in second piece.
"RTN","GMVUTL8",13,0)
 ;         example: ARRAY(#)=DFN^patient name^SSN^DOB^SEX AND AGE
"RTN","GMVUTL8",14,0)
 ;                  ^ATTENDING^VETERAN^INTERNAL DATE/TIME DECEASED
"RTN","GMVUTL8",15,0)
 ;                  ^EXTERNAL DATE/TIME DECEASED
"RTN","GMVUTL8",16,0)
 ;
"RTN","GMVUTL8",17,0)
 I $G(LOC)="" S ARRAY(1)=-1
"RTN","GMVUTL8",18,0)
 N DFN,GMVARRAY,GMVCNT,GMVPAT,PATNAME
"RTN","GMVUTL8",19,0)
 D APTLIST^NURAPI(LOC,.GMVARRAY)
"RTN","GMVUTL8",20,0)
 I $G(GMVARRAY(1))'>0 S ARRAY(1)=-1 Q
"RTN","GMVUTL8",21,0)
 S GMVCNT=0
"RTN","GMVUTL8",22,0)
 F  S GMVCNT=$O(GMVARRAY(GMVCNT)) Q:'GMVCNT  D
"RTN","GMVUTL8",23,0)
 .S DFN=$P(GMVARRAY(GMVCNT),U,1)
"RTN","GMVUTL8",24,0)
 .Q:'DFN
"RTN","GMVUTL8",25,0)
 .S PATNAME=$P(GMVARRAY(GMVCNT),U,2)
"RTN","GMVUTL8",26,0)
 .D PTINFO^GMVUTL3(.GMVPAT,DFN)
"RTN","GMVUTL8",27,0)
 .S ARRAY(GMVCNT)=DFN_U_PATNAME_U_GMVPAT
"RTN","GMVUTL8",28,0)
 .Q
"RTN","GMVUTL8",29,0)
 Q
"RTN","GMVUTL8",30,0)
TYPE(RESULT,GMVTYPE) ;GMV GET VITAL TYPE IEN [RPC entry point]
"RTN","GMVUTL8",31,0)
 ; Input:
"RTN","GMVUTL8",32,0)
 ;   RESULT = variable name to hold result
"RTN","GMVUTL8",33,0)
 ;  GMVTYPE = Name of Vital Type (from FILE 120.51) (e.g., WEIGHT)
"RTN","GMVUTL8",34,0)
 ; Output: Returns the IEN if GMVTYPE exists in FILE 120.51
"RTN","GMVUTL8",35,0)
 ;         else returns -1
"RTN","GMVUTL8",36,0)
 ;
"RTN","GMVUTL8",37,0)
 I GMVTYPE="" S RESULT=-1 Q
"RTN","GMVUTL8",38,0)
 S RESULT=+$O(^GMRD(120.51,"B",GMVTYPE,0))
"RTN","GMVUTL8",39,0)
 Q
"RTN","GMVUTL8",40,0)
CATEGORY(RESULT,GMVCAT) ;GMV GET CATEGORY IEN [RPC entry point]
"RTN","GMVUTL8",41,0)
 ; Input
"RTN","GMVUTL8",42,0)
 ;  RESULT = variable name to hold result
"RTN","GMVUTL8",43,0)
 ;  GMVCAT = Name of Category (from FILE 120.53) (e.g., METHOD)
"RTN","GMVUTL8",44,0)
 ; Output: Returns the IEN if GMVTYPE exists in FILE 120.53
"RTN","GMVUTL8",45,0)
 ;         else returns -1
"RTN","GMVUTL8",46,0)
 I GMVCAT="" S RESULT=-1 Q
"RTN","GMVUTL8",47,0)
 S RESULT=+$O(^GMRD(120.53,"B",GMVCAT,0))
"RTN","GMVUTL8",48,0)
 Q
"RTN","GMVUTL8",49,0)
VITALIEN() ;Returns the Vital Type IENS in a list separated by commas.
"RTN","GMVUTL8",50,0)
 ; ex: ",,8,9,21,20,5,3,22,1,2,19,"
"RTN","GMVUTL8",51,0)
 ;
"RTN","GMVUTL8",52,0)
 N GMVABB,GMVIEN,GMVLIST
"RTN","GMVUTL8",53,0)
 S GMVLIST=""
"RTN","GMVUTL8",54,0)
 F GMVABB="BP","T","R","P","HT","WT","CVP","CG","PO2","PN" D
"RTN","GMVUTL8",55,0)
 .S GMVIEN=$O(^GMRD(120.51,"C",GMVABB,0))
"RTN","GMVUTL8",56,0)
 .Q:'GMVIEN
"RTN","GMVUTL8",57,0)
 .S GMVLIST=GMVLIST_","_GMVIEN
"RTN","GMVUTL8",58,0)
 .Q
"RTN","GMVUTL8",59,0)
 I $L(GMVLIST)'="," S GMVLIST=GMVLIST_","
"RTN","GMVUTL8",60,0)
 Q GMVLIST
"RTN","GMVUTL8",61,0)
 ;
"VER")
8.0^22
**END**
**END**
