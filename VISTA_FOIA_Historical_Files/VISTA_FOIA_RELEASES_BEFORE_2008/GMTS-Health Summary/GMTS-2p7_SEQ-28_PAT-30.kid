Released GMTS*2.7*30 SEQ #28
Extracted from mail message
**KIDS**:GMTS*2.7*30^

**INSTALL NAME**
GMTS*2.7*30
"BLD",1285,0)
GMTS*2.7*30^HEALTH SUMMARY^0^2990512^y
"BLD",1285,1,0)
^^2^2^2990512^^^
"BLD",1285,1,1,0)
The description of this patch may be found on the National Patch Module 
"BLD",1285,1,2,0)
under GMTS*2.7*30.
"BLD",1285,4,0)
^9.64PA^142^1
"BLD",1285,4,142,0)
142
"BLD",1285,4,142,222)
y^y^f^^^^n
"BLD",1285,4,"B",142,142)

"BLD",1285,"INIT")
PST^GMTSP30
"BLD",1285,"KRN",0)
^9.67PA^19^18
"BLD",1285,"KRN",.4,0)
.4
"BLD",1285,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",1285,"KRN",.401,0)
.401
"BLD",1285,"KRN",.401,"NM",0)
^9.68A^^0
"BLD",1285,"KRN",.402,0)
.402
"BLD",1285,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",1285,"KRN",.403,0)
.403
"BLD",1285,"KRN",.5,0)
.5
"BLD",1285,"KRN",.5,"NM",0)
^9.68A^^0
"BLD",1285,"KRN",.84,0)
.84
"BLD",1285,"KRN",3.6,0)
3.6
"BLD",1285,"KRN",3.8,0)
3.8
"BLD",1285,"KRN",9.2,0)
9.2
"BLD",1285,"KRN",9.8,0)
9.8
"BLD",1285,"KRN",9.8,"NM",0)
^9.68A^28^28
"BLD",1285,"KRN",9.8,"NM",1,0)
GMTSUIX^^0^B16047155
"BLD",1285,"KRN",9.8,"NM",2,0)
GMTSULT^^0^B37325818
"BLD",1285,"KRN",9.8,"NM",3,0)
GMTSULT2^^0^B35828982
"BLD",1285,"KRN",9.8,"NM",4,0)
GMTSUMX^^0^B12765702
"BLD",1285,"KRN",9.8,"NM",5,0)
GMTSUMX2^^0^B70515223
"BLD",1285,"KRN",9.8,"NM",6,0)
GMTSUMX3^^0^B29389559
"BLD",1285,"KRN",9.8,"NM",7,0)
GMTSULT3^^0^B21834691
"BLD",1285,"KRN",9.8,"NM",8,0)
GMTSULT4^^0^B25420384
"BLD",1285,"KRN",9.8,"NM",9,0)
GMTSRAE^^0^B26945344
"BLD",1285,"KRN",9.8,"NM",10,0)
GMTSP30^^0^B765574
"BLD",1285,"KRN",9.8,"NM",11,0)
GMTSRI^^0^B678667
"BLD",1285,"KRN",9.8,"NM",12,0)
GMTSPNSL^^0^B40507409
"BLD",1285,"KRN",9.8,"NM",13,0)
GMTSRM^^0^B14333286
"BLD",1285,"KRN",9.8,"NM",14,0)
GMTS^^0^B25958869
"BLD",1285,"KRN",9.8,"NM",15,0)
GMTSADH^^0^B14551608
"BLD",1285,"KRN",9.8,"NM",16,0)
GMTSADHC^^0^B17470638
"BLD",1285,"KRN",9.8,"NM",17,0)
GMTSADOR^^0^B11519171
"BLD",1285,"KRN",9.8,"NM",18,0)
GMTSCM^^0^B11706395
"BLD",1285,"KRN",9.8,"NM",19,0)
GMTSDVR^^0^B31598496
"BLD",1285,"KRN",9.8,"NM",20,0)
GMTSLOAD^^0^B10686928
"BLD",1285,"KRN",9.8,"NM",21,0)
GMTSPD^^0^B14763337
"BLD",1285,"KRN",9.8,"NM",22,0)
GMTSPL^^0^B19167015
"BLD",1285,"KRN",9.8,"NM",23,0)
GMTSPP^^0^B17929091
"BLD",1285,"KRN",9.8,"NM",24,0)
GMTSRM5^^0^B8751202
"BLD",1285,"KRN",9.8,"NM",25,0)
GMTSUP^^0^B16988760
"BLD",1285,"KRN",9.8,"NM",26,0)
GMTSULT5^^0^B17045654
"BLD",1285,"KRN",9.8,"NM",27,0)
GMTSULT6^^0^B25750888
"BLD",1285,"KRN",9.8,"NM",28,0)
GMTSULT7^^0^B26914731
"BLD",1285,"KRN",9.8,"NM","B","GMTS",14)

"BLD",1285,"KRN",9.8,"NM","B","GMTSADH",15)

"BLD",1285,"KRN",9.8,"NM","B","GMTSADHC",16)

"BLD",1285,"KRN",9.8,"NM","B","GMTSADOR",17)

"BLD",1285,"KRN",9.8,"NM","B","GMTSCM",18)

"BLD",1285,"KRN",9.8,"NM","B","GMTSDVR",19)

"BLD",1285,"KRN",9.8,"NM","B","GMTSLOAD",20)

"BLD",1285,"KRN",9.8,"NM","B","GMTSP30",10)

"BLD",1285,"KRN",9.8,"NM","B","GMTSPD",21)

"BLD",1285,"KRN",9.8,"NM","B","GMTSPL",22)

"BLD",1285,"KRN",9.8,"NM","B","GMTSPNSL",12)

"BLD",1285,"KRN",9.8,"NM","B","GMTSPP",23)

"BLD",1285,"KRN",9.8,"NM","B","GMTSRAE",9)

"BLD",1285,"KRN",9.8,"NM","B","GMTSRI",11)

"BLD",1285,"KRN",9.8,"NM","B","GMTSRM",13)

"BLD",1285,"KRN",9.8,"NM","B","GMTSRM5",24)

"BLD",1285,"KRN",9.8,"NM","B","GMTSUIX",1)

"BLD",1285,"KRN",9.8,"NM","B","GMTSULT",2)

"BLD",1285,"KRN",9.8,"NM","B","GMTSULT2",3)

"BLD",1285,"KRN",9.8,"NM","B","GMTSULT3",7)

"BLD",1285,"KRN",9.8,"NM","B","GMTSULT4",8)

"BLD",1285,"KRN",9.8,"NM","B","GMTSULT5",26)

"BLD",1285,"KRN",9.8,"NM","B","GMTSULT6",27)

"BLD",1285,"KRN",9.8,"NM","B","GMTSULT7",28)

"BLD",1285,"KRN",9.8,"NM","B","GMTSUMX",4)

"BLD",1285,"KRN",9.8,"NM","B","GMTSUMX2",5)

"BLD",1285,"KRN",9.8,"NM","B","GMTSUMX3",6)

"BLD",1285,"KRN",9.8,"NM","B","GMTSUP",25)

"BLD",1285,"KRN",19,0)
19
"BLD",1285,"KRN",19,"NM",0)
^9.68A^^0
"BLD",1285,"KRN",19.1,0)
19.1
"BLD",1285,"KRN",19.1,"NM",0)
^9.68A^^0
"BLD",1285,"KRN",101,0)
101
"BLD",1285,"KRN",101,"NM",0)
^9.68A^^0
"BLD",1285,"KRN",409.61,0)
409.61
"BLD",1285,"KRN",771,0)
771
"BLD",1285,"KRN",869.2,0)
869.2
"BLD",1285,"KRN",870,0)
870
"BLD",1285,"KRN",8994,0)
8994
"BLD",1285,"KRN","B",.4,.4)

"BLD",1285,"KRN","B",.401,.401)

"BLD",1285,"KRN","B",.402,.402)

"BLD",1285,"KRN","B",.403,.403)

"BLD",1285,"KRN","B",.5,.5)

"BLD",1285,"KRN","B",.84,.84)

"BLD",1285,"KRN","B",3.6,3.6)

"BLD",1285,"KRN","B",3.8,3.8)

"BLD",1285,"KRN","B",9.2,9.2)

"BLD",1285,"KRN","B",9.8,9.8)

"BLD",1285,"KRN","B",19,19)

"BLD",1285,"KRN","B",19.1,19.1)

"BLD",1285,"KRN","B",101,101)

"BLD",1285,"KRN","B",409.61,409.61)

"BLD",1285,"KRN","B",771,771)

"BLD",1285,"KRN","B",869.2,869.2)

"BLD",1285,"KRN","B",870,870)

"BLD",1285,"KRN","B",8994,8994)

"BLD",1285,"QUES",0)
^9.62^^
"BLD",1285,"REQB",0)
^9.611^3^3
"BLD",1285,"REQB",1,0)
GMTS*2.7*12^2
"BLD",1285,"REQB",2,0)
GMTS*2.7*25^2
"BLD",1285,"REQB",3,0)
GMTS*2.7*28^2
"BLD",1285,"REQB","B","GMTS*2.7*12",1)

"BLD",1285,"REQB","B","GMTS*2.7*25",2)

"BLD",1285,"REQB","B","GMTS*2.7*28",3)

"FIA",142)
HEALTH SUMMARY TYPE
"FIA",142,0)
^GMT(142,
"FIA",142,0,0)
142
"FIA",142,0,1)
y^y^f^^^^n
"FIA",142,0,10)

"FIA",142,0,11)

"FIA",142,0,"RLRO")

"FIA",142,0,"VR")
2.7^GMTS
"FIA",142,142)
0
"FIA",142,142.01)
0
"FIA",142,142.14)
0
"FIA",142,142.2)
0
"INIT")
PST^GMTSP30
"MBREQ")
0
"PKG",187,-1)
1^1
"PKG",187,0)
HEALTH SUMMARY^GMTS^Integrated Health Summary Tools
"PKG",187,20,0)
^9.402P^^
"PKG",187,22,0)
^9.49I^1^1
"PKG",187,22,1,0)
2.7^2951020^2960308
"PKG",187,22,1,"PAH",1,0)
30^2990512
"PKG",187,22,1,"PAH",1,1,0)
^^2^2^2990603
"PKG",187,22,1,"PAH",1,1,1,0)
The description of this patch may be found on the National Patch Module 
"PKG",187,22,1,"PAH",1,1,2,0)
under GMTS*2.7*30.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
28
"RTN","GMTS")
0^14^B25958869
"RTN","GMTS",1,0)
GMTS ; SLC/KER - Health Summary Main Routine ; 04/19/1999
"RTN","GMTS",2,0)
 ;;2.7;Health Summary;**16,24,28,30**;Oct 20, 1995
"RTN","GMTS",3,0)
 ;
"RTN","GMTS",4,0)
MAIN ; Controls branching
"RTN","GMTS",5,0)
 ; GMTSPXGO & GMRANGE are set in 2 calling options, They aren't meant
"RTN","GMTS",6,0)
 ; to be used together.
"RTN","GMTS",7,0)
 I +$G(GMTSPXGO)'>0,$L($T(PATIENT^ORU1)),($$VERSION^XPDUTL("OR")>2.19) D MAIN^GMTSDVR Q
"RTN","GMTS",8,0)
 N DIROUT,DUOUT,ZTRTN,GMTSPX1,GMTSPX2,GMNAME,GMPSAP
"RTN","GMTS",9,0)
 S GMTSTYP=0 K DIC,DIROUT,DUOUT
"RTN","GMTS",10,0)
 S DIC("B")=$P($G(^GMT(142,+$G(^DISV(+$G(DUZ),"^GMT(142,")),0)),U)
"RTN","GMTS",11,0)
 F  Q:$D(DIROUT)!$D(DUOUT)  D SELTYP Q:GMTSTYP'>0!$D(DIROUT)!$D(DUOUT)  D
"RTN","GMTS",12,0)
 . N GMPAT,DFN,GMTSMULT
"RTN","GMTS",13,0)
 . F  Q:$D(DIROUT)  D  Q:$D(DIROUT)!$D(DUOUT)!(+$D(GMPAT)'>0)!+$G(ORVP)
"RTN","GMTS",14,0)
 . . K GMPAT,DFN
"RTN","GMTS",15,0)
 . . I +$G(ORVP) D
"RTN","GMTS",16,0)
 . . . S (DFN,GMPAT(1))=+ORVP,GMNAME=$P($G(^DPT(+DFN,0)),U) Q:GMNAME=""  S GMPATT(GMNAME,DFN)="",(GMTSPX1,GMTSPX2)=""
"RTN","GMTS",17,0)
 . . . W !!,"For patient ",GMNAME," please answer the following."
"RTN","GMTS",18,0)
 . . . I +$G(GMTSPXGO)>0 D MENU^GMTSPXU2(DFN,.GMTSPX2,.GMTSPX1)
"RTN","GMTS",19,0)
 . . . I $G(GMTSPX1)']""!($G(GMTSPX2)']"") S DIROUT=1 K GMPAT,GMPATT Q
"RTN","GMTS",20,0)
 . . . Q:$D(DIROUT)  S GMPAT(GMNAME_(9999999-GMTSPX1),+DFN)=+DFN_U_$G(GMTSPX1)_U_$G(GMTSPX2)
"RTN","GMTS",21,0)
 . . I '(+($G(ORVP))) F  Q:$D(DIROUT)  K GMPATT D SELPT Q:$D(DIROUT)!('$D(GMPATT))  S GMNAME="" F  S GMNAME=$O(GMPATT(GMNAME)) Q:GMNAME=""!$D(DIROUT)  F DFN=0:0 S DFN=$O(GMPATT(GMNAME,DFN)) Q:DFN=""  D  Q:$D(DIROUT)
"RTN","GMTS",22,0)
 . . . S (GMTSPX1,GMTSPX2)="" W !!,"For patient ",GMNAME," please answer the following."
"RTN","GMTS",23,0)
 . . . I +$G(GMTSPXGO)>0 D MENU^GMTSPXU2(DFN,.GMTSPX2,.GMTSPX1) I $G(GMTSPX1)']""!($G(GMTSPX2)']"") Q
"RTN","GMTS",24,0)
 . . . Q:$D(DIROUT)
"RTN","GMTS",25,0)
 . . . S GMPAT(GMNAME_(9999999-GMTSPX1),+DFN)=+DFN_U_$G(GMTSPX1)_U_$G(GMTSPX2)
"RTN","GMTS",26,0)
 . . Q:$D(DIROUT)!(+$D(GMPAT)'>0)
"RTN","GMTS",27,0)
 . . I +$G(GMRANGE)>0 D GETRANGE^GMTSU(.GMTSPX1,.GMTSPX2) Q:$G(GMTSPX1)=""!($G(GMTSPX2)="")
"RTN","GMTS",28,0)
 . . Q:$D(DIROUT)
"RTN","GMTS",29,0)
 . . D RESUB^GMTSDVR(.GMPAT)
"RTN","GMTS",30,0)
 . . S GMPSAP=$$RXAP^GMTSPD2 Q:$D(DIROUT)!$D(DTOUT)
"RTN","GMTS",31,0)
 . . S ZTRTN="PQ^GMTS"
"RTN","GMTS",32,0)
 . . D HSOUT^GMTSDVR,END W !
"RTN","GMTS",33,0)
 K GMTSTYP,GMTSTITL,GMTSEG,GMTSEGI,GMTSEGC,GMX,DFN,X,Y,I,GMP,GMPATT
"RTN","GMTS",34,0)
 Q
"RTN","GMTS",35,0)
SELTYP ; Select a Health Summary Type for printing
"RTN","GMTS",36,0)
 Q:GMTSTYP=-1  S DIC=142,DIC("A")="Select Health Summary Type: ",DIC(0)="AEQM",DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION"""
"RTN","GMTS",37,0)
 S Y=$$TYPE^GMTSULT K DIC S GMTSTYP=+Y,GMTSTITL=$S($D(^GMT(142,+Y,"T")):^("T"),1:"") S:GMTSTITL="" GMTSTITL=$P(Y,"^",2)
"RTN","GMTS",38,0)
 I GMTSTYP>0,$S($D(^GMT(142,GMTSTYP,1,0))=0:1,$O(^(0))'>0:1,1:0) W !,"This Summary Type includes no components...Please choose another." G SELTYP
"RTN","GMTS",39,0)
SELTYP1 ; Loop through HS Type and call LOADSEG to get each component record
"RTN","GMTS",40,0)
 K GMTSEG,GMTSEGI S (GMI,S1)=0 F  S S1=$O(^GMT(142,GMTSTYP,1,S1)) Q:'S1  S GMX=^(S1,0) D LOADSEG
"RTN","GMTS",41,0)
 S GMTSEGC=GMI K S1,S2,GMI
"RTN","GMTS",42,0)
 Q
"RTN","GMTS",43,0)
LOADSEG ; Load ENABLED COMPONENTS into GMTSEG array
"RTN","GMTS",44,0)
 S GMTS0=^GMT(142.1,$P(GMX,"^",2),0)
"RTN","GMTS",45,0)
 S GMI=GMI+1,GMTSEG(GMI)=GMX,GMTSEGI($P(GMX,U,2))=GMI D SELFILE
"RTN","GMTS",46,0)
 Q
"RTN","GMTS",47,0)
SELPT ; Select a patient for printing of Health Summary
"RTN","GMTS",48,0)
 N DUOUT K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW"),^("ORLP"),GMP
"RTN","GMTS",49,0)
 D PATIENT^ORU1(.GMP),PATCOPY^GMTSDVR(.GMP,.GMPATT)
"RTN","GMTS",50,0)
 Q
"RTN","GMTS",51,0)
SELFILE ; Loop through SELECTION ITEM multiple and load GMTSEG( with ITEMS
"RTN","GMTS",52,0)
 S S2=0 F  S S2=$O(^GMT(142,GMTSTYP,1,S1,1,S2)) Q:'S2  S ENTRY=^(S2,0),GMTSEG(GMI,+$P(@(U_$P(ENTRY,";",2)_"0)"),U,2),S2)=$P(ENTRY,";") I S2=1 S GMTSEG(GMI,+$P(@(U_$P(ENTRY,";",2)_"0)"),U,2),0)=U_$P(ENTRY,";",2)
"RTN","GMTS",53,0)
 Q
"RTN","GMTS",54,0)
PQ ; Queued subroutine for HS by patient
"RTN","GMTS",55,0)
 N DFN,GMTS,GMTS1,GMTS2,GMTSAGE,GMTSDOB,GMTSDTM,GMTSLO,GMTSLPG,GMTSPNM
"RTN","GMTS",56,0)
 N GMTSRB,GMTSSN,GMTSTOF,GMTSWARD,GMTJ,I,IX0,J,M4,P17,SEX
"RTN","GMTS",57,0)
 N TRFAC,VAERR,VAIN
"RTN","GMTS",58,0)
 S GMTJ=0 F  S GMTJ=$O(GMPAT(GMTJ)) Q:GMTJ'>0!$D(DIROUT)  D
"RTN","GMTS",59,0)
 . S DFN=+$G(GMPAT(GMTJ))
"RTN","GMTS",60,0)
 . I +$G(GMTSPXGO)>0 S GMTSPX1=$P($G(GMPAT(GMTJ)),U,2) D
"RTN","GMTS",61,0)
 . . S GMTSPX2=$P($G(GMPAT(GMTJ)),U,3)
"RTN","GMTS",62,0)
 . . I +GMTSPX1'>0!+GMTSPX2'>0 K GMTSPX1,GMTSPX2
"RTN","GMTS",63,0)
 . N GMDUOUT
"RTN","GMTS",64,0)
 . D EN^GMTS1
"RTN","GMTS",65,0)
 . Q:$D(DIROUT)!+$G(GMDUOUT)
"RTN","GMTS",66,0)
 . D ACTPROF^GMTSDVR(DFN)
"RTN","GMTS",67,0)
 Q
"RTN","GMTS",68,0)
HSOUT ; Output Summary, with DEVICE handling
"RTN","GMTS",69,0)
 K ZTSK
"RTN","GMTS",70,0)
 I $D(^XUSEC("GMTS VIEW ONLY",DUZ)) D EN^GMTS1 Q
"RTN","GMTS",71,0)
 K IOP S %ZIS="PQ" D ^%ZIS Q:POP
"RTN","GMTS",72,0)
 G:$D(IO("Q")) QUE
"RTN","GMTS",73,0)
NOQUE ; Print non-queued output to selected device
"RTN","GMTS",74,0)
 D EN^GMTS1
"RTN","GMTS",75,0)
 D ^%ZISC
"RTN","GMTS",76,0)
 Q
"RTN","GMTS",77,0)
QUE ; Call TaskMan to Queue output
"RTN","GMTS",78,0)
 K IO("Q"),ZTSAVE F %="DFN","GMTS*","ENTRY" S ZTSAVE(%)=""
"RTN","GMTS",79,0)
 S ZTRTN="EN^GMTS1",ZTDESC="HEALTH SUMMARY",ZTIO=ION
"RTN","GMTS",80,0)
 D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued!",1:"Request Cancelled!")
"RTN","GMTS",81,0)
 K ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE D ^%ZISC
"RTN","GMTS",82,0)
 S IOP="HOME" D ^%ZIS
"RTN","GMTS",83,0)
 Q
"RTN","GMTS",84,0)
END ; Clean up environmental variables and EXIT Health Summary
"RTN","GMTS",85,0)
 K %T,DIC,GMTS,GMTSLO,GMTSPNM,GMTSRB,GMTSWARD,GMTSDOB,DIC,X,Y,VA,VAIN,VAINDT,VADM,VAEL,VAPA,VAERR,GMTSSN,GMTS0,GMTS1,GMTS2
"RTN","GMTS",86,0)
 K GMTSAGE,GMTSTIM,GMTSEGN,GMTSEGH,GMTSEGL,GMTSHDR,GMTSNPG,GMTSPG,GMTSQIT,GMTSX,ENTRY,Z1,GMTSDTM,GMTSLOCK,GMTSLPG,SEX,POP,C,GMTSTOF
"RTN","GMTS",87,0)
 Q
"RTN","GMTS",88,0)
ENCWA ;Entry point printing components
"RTN","GMTS",89,0)
 ;GMTSPRM can be set to any component abbreviations except ones that 
"RTN","GMTS",90,0)
 ;require selection items. Needs to be valid component abbreviation 
"RTN","GMTS",91,0)
 ;from the "C" x-ref of File 142.1.
"RTN","GMTS",92,0)
 ;
"RTN","GMTS",93,0)
 ;call with DFN,GMTSPRM="CD,CN,CW,ADR",GMTSTITL="TITLE"
"RTN","GMTS",94,0)
 ;          GMTSPX1=Optional internal FM date for range ending date
"RTN","GMTS",95,0)
 ;          GMTSPX2=Optional internal FM date for range beginning date
"RTN","GMTS",96,0)
 ;  NOTE: Optional date range variables are both required if a date range
"RTN","GMTS",97,0)
 ;        is desired.
"RTN","GMTS",98,0)
 N GMI,GMJ,GMTSEG,GMTSEGI,GMTSEGC
"RTN","GMTS",99,0)
 S GMTS1="9999999",GMTS2="6666666",GMI=0,GMTSPNF=1
"RTN","GMTS",100,0)
 I '$D(GMTSPRM) W !,"The parameter GMTSPRM is undefined.",! Q
"RTN","GMTS",101,0)
 I '$D(GMTSTITL) W !,"The parameter GMTSTITL is undefined.",! Q
"RTN","GMTS",102,0)
 I '+$G(DFN) W !,"The parameter DFN is undefined.",! Q
"RTN","GMTS",103,0)
 F GMJ=1:1:$L(GMTSPRM,",") S ABB=$P(GMTSPRM,",",GMJ) D LOAD Q:GMJ=-1
"RTN","GMTS",104,0)
 S GMTSEGC=GMI K ABB,IFN
"RTN","GMTS",105,0)
 D EN^GMTS1
"RTN","GMTS",106,0)
 D END K GMTSEG,GMTSEGI,GMTSEGC,GMTSTITL,GMTSPRM,GMTSPNF
"RTN","GMTS",107,0)
 Q
"RTN","GMTS",108,0)
LOAD ; Load GMTSEG() using GMTSPRM abbreviations
"RTN","GMTS",109,0)
 S IFN=$O(^GMT(142.1,"C",ABB,"")) Q:IFN=""
"RTN","GMTS",110,0)
 S GMI=GMI+1,GMTSEG(GMI)=GMI_"^"_IFN,GMTSEGI(IFN)=GMI
"RTN","GMTS",111,0)
 Q
"RTN","GMTSADH")
0^15^B14551608
"RTN","GMTSADH",1,0)
GMTSADH ;SLC/JER,MAM - Ad Hoc Summary Driver ; 04/19/1999
"RTN","GMTSADH",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSADH",3,0)
MAIN N C,DFN,GMTSEG,GMTSEGI,GMTSEGC,GMTSQIT,GMTSTYP,GMTSTITL,GMW,X,Y
"RTN","GMTSADH",4,0)
 N DIC,DIPGM,I,POP,%,DIROUT,DUOUT,DTOUT,ZTRTN
"RTN","GMTSADH",5,0)
 N GMTSQIT,FROM,GMI,I1,ISVALID,LRDFN,PTR,SEX,TO,VAOA,VASD,VASV
"RTN","GMTSADH",6,0)
 I $L($T(PATIENT^ORU1)),($$VERSION^XPDUTL("OR")>2.19) D MAIN^GMTSADHC Q
"RTN","GMTSADH",7,0)
 S DIC=142,DIC(0)="MZF",X="GMTS HS ADHOC OPTION"
"RTN","GMTSADH",8,0)
 S Y=$$TYPE^GMTSULT K DIC S GMTSTYP=+Y,GMTSTITL="AD HOC"
"RTN","GMTSADH",9,0)
 F  K GMTSEG,GMTSEGI,GMTSEGC D BUILD D  Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT) 
"RTN","GMTSADH",10,0)
 . N GMPAT,DFN,GMTSMULT
"RTN","GMTSADH",11,0)
 . F  D  Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)!(+$D(GMPAT)'>0)
"RTN","GMTSADH",12,0)
 . . Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)
"RTN","GMTSADH",13,0)
 . . K GMPAT,GMTSMULT
"RTN","GMTSADH",14,0)
 . . F  Q:$D(DIROUT)  K DFN W ! D SELPT^GMTS Q:DFN'>0  S GMPAT(GMNAME,+DFN)=+DFN
"RTN","GMTSADH",15,0)
 . . Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)!(+$D(GMPAT)'>0)
"RTN","GMTSADH",16,0)
 . . D RESUB^GMTSDVR(.GMPAT)
"RTN","GMTSADH",17,0)
 . . S ZTRTN="PQ^GMTS"
"RTN","GMTSADH",18,0)
 . . N DUOUT
"RTN","GMTSADH",19,0)
 . . D HSOUT^GMTSDVR,END^GMTS W !
"RTN","GMTSADH",20,0)
 Q
"RTN","GMTSADH",21,0)
BUILD ; Conducts Dialogue to build ad hoc summary
"RTN","GMTSADH",22,0)
 N GMI,GMJ,GMW,X,XQORM,Y
"RTN","GMTSADH",23,0)
 Q:$D(GMTSQIT)!($D(DIROUT))
"RTN","GMTSADH",24,0)
 W @IOF
"RTN","GMTSADH",25,0)
 S XQORM("S")="I $D(^GMT(142,DA(1),1,DA,0)),($P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""T"")",XQORM("M")=6
"RTN","GMTSADH",26,0)
 S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="AD",XQORM("A")="Select NEW set of COMPONENT(S): ",XQORM("??")="D HELP^GMTSADH" D ^XQORM I Y'>0 S DIROUT=1 Q
"RTN","GMTSADH",27,0)
 I +Y,(X?1"^^".E) D RJUMP^GMTSUP1 G BUILD
"RTN","GMTSADH",28,0)
 S GMTSEGC=Y
"RTN","GMTSADH",29,0)
 S (X,GMI,GMJ)=0 F  S GMI=$O(Y(GMI)) Q:'GMI  D LOAD
"RTN","GMTSADH",30,0)
 D GETLIM^GMTSADH1
"RTN","GMTSADH",31,0)
 Q
"RTN","GMTSADH",32,0)
LOAD ; Load enabled components into GMTSEG
"RTN","GMTSADH",33,0)
 N SREC,STRN
"RTN","GMTSADH",34,0)
 S STRN=+Y(GMI),SREC=^GMT(142,GMTSTYP,1,STRN,0)
"RTN","GMTSADH",35,0)
LOAD1 ; Load an individual component into GMTSEG( and GMTSEGI(
"RTN","GMTSADH",36,0)
 S GMJ=GMJ+1,GMTSEG(GMJ)=SREC,GMTSEGI($P(SREC,U,2))=GMJ D LOADSEL
"RTN","GMTSADH",37,0)
 Q
"RTN","GMTSADH",38,0)
LOADSEL ; Loads GMTSEG(J,FN,IFN), when Selection items are present
"RTN","GMTSADH",39,0)
 N S2,SJ,SEL
"RTN","GMTSADH",40,0)
 S S2=0,SJ=GMJ
"RTN","GMTSADH",41,0)
 F  S S2=$O(^GMT(142,GMTSTYP,1,STRN,1,S2)) Q:'S2  S SEL=^(S2,0),GMTSEG(GMJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),S2)=$P(SEL,";") I S2=1 S GMTSEG(SJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),0)=U_$P(SEL,";",2)
"RTN","GMTSADH",42,0)
 Q
"RTN","GMTSADH",43,0)
HELP ; 
"RTN","GMTSADH",44,0)
 N GMJ,GMTSTXT,HLP
"RTN","GMTSADH",45,0)
 S HLP=$S(X="??":"HTX2",X="?":"HTX1",1:"") I $L(HLP) W ! F GMJ=1:1 S GMTSTXT=$T(@HLP+GMJ) Q:GMTSTXT["ZZZZ"  W !,$P(GMTSTXT,";",3,99)
"RTN","GMTSADH",46,0)
 I X="???" W !! D HELP2^GMTSUP1
"RTN","GMTSADH",47,0)
 D REDISP
"RTN","GMTSADH",48,0)
 Q
"RTN","GMTSADH",49,0)
REDISP ; Ask Whether or not to redisplay menu
"RTN","GMTSADH",50,0)
 N I,DIR,X,Y
"RTN","GMTSADH",51,0)
 S DIR(0)="Y",DIR("A")="Redisplay items",DIR("B")="YES" D ^DIR Q:'Y
"RTN","GMTSADH",52,0)
 W @IOF
"RTN","GMTSADH",53,0)
 D DISP^XQORM1 W !
"RTN","GMTSADH",54,0)
 Q
"RTN","GMTSADH",55,0)
HTX1 ;;Help Text for "?" and "??"
"RTN","GMTSADH",56,0)
 ;;Select ONE or MORE items from the menu, separated by commas.
"RTN","GMTSADH",57,0)
 ;;
"RTN","GMTSADH",58,0)
 ;;Enter: ??  to see HELP for MULTIPLE SELECTION
"RTN","GMTSADH",59,0)
 ;;       ??? to see HELP for "^^"-jump
"RTN","GMTSADH",60,0)
 ;;
"RTN","GMTSADH",61,0)
 ;;ZZZZ
"RTN","GMTSADH",62,0)
HTX2 ; HELP for ??
"RTN","GMTSADH",63,0)
 ;;
"RTN","GMTSADH",64,0)
 ;;The Health Summary components you select at this prompt create
"RTN","GMTSADH",65,0)
 ;;an ADHOC Health Summary.
"RTN","GMTSADH",66,0)
 ;;
"RTN","GMTSADH",67,0)
 ;;Select ONE or MORE items from the menu, separated by commas.
"RTN","GMTSADH",68,0)
 ;;
"RTN","GMTSADH",69,0)
 ;;ALL items may be selected by typing "ALL".
"RTN","GMTSADH",70,0)
 ;;
"RTN","GMTSADH",71,0)
 ;;EXCEPTIONS may be entered by preceding them with a minus.
"RTN","GMTSADH",72,0)
 ;;  For example, "ALL,-THIS,-THAT" selects all but "THIS" and "THAT".
"RTN","GMTSADH",73,0)
 ;;
"RTN","GMTSADH",74,0)
 ;;NOTE: Menu items are ordered alphabetically by the Component NAME.
"RTN","GMTSADH",75,0)
 ;;      However, the displayed text is the Header Name which generally 
"RTN","GMTSADH",76,0)
 ;;      is different from the Component Name. Component may be picked
"RTN","GMTSADH",77,0)
 ;;      by their abbreviation, Header Name or Component Name.
"RTN","GMTSADH",78,0)
 ;;
"RTN","GMTSADH",79,0)
 ;;ZZZZ
"RTN","GMTSADHC")
0^16^B17470638
"RTN","GMTSADHC",1,0)
GMTSADHC ; SLC/JER,KER - Ad Hoc Summary Driver ; 04/19/1999
"RTN","GMTSADHC",2,0)
 ;;2.7;Health Summary;**6,27,28,30**;Oct 20, 1995
"RTN","GMTSADHC",3,0)
MAIN N I,XQORSPEW
"RTN","GMTSADHC",4,0)
 S DIC=142,DIC(0)="MZF",X="GMTS HS ADHOC OPTION"
"RTN","GMTSADHC",5,0)
 S Y=$$TYPE^GMTSULT K DIC Q:+Y'>0  S GMTSTYP=+Y,GMTSTITL="AD HOC"
"RTN","GMTSADHC",6,0)
 F  D  Q:$D(DUOUT)!$D(DIROUT)!'$D(GMTSEG)
"RTN","GMTSADHC",7,0)
 . K GMTSEG,GMTSEGI,GMTSEGC
"RTN","GMTSADHC",8,0)
 . D BUILD
"RTN","GMTSADHC",9,0)
 . Q:$D(DUOUT)!$D(DIROUT)!'$D(GMTSEG)
"RTN","GMTSADHC",10,0)
 . N GMPAT,GMP
"RTN","GMTSADHC",11,0)
 . F  Q:$D(DIROUT)  D  Q:$D(DUOUT)!$D(DIROUT)!(+$D(GMPAT)'>0)!+$G(ORVP)
"RTN","GMTSADHC",12,0)
 . . K GMP,GMPAT
"RTN","GMTSADHC",13,0)
 . . I +$G(ORVP) S GMPAT(1)=+ORVP
"RTN","GMTSADHC",14,0)
 . . E  F  Q:$D(DIROUT)  K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW"),^("ORLP"),GMP D PATIENT^ORU1(.GMP),PATCOPY^GMTSDVR(.GMP,.GMPAT) Q:$S($D(DUOUT):1,$D(DIROUT):1,'+$G(GMP):1,$P($G(^VA(200,DUZ,100.1)),U,6)]"":1,1:0)  D
"RTN","GMTSADHC",15,0)
 . . . W !!,"Another patient(s) can be selected."
"RTN","GMTSADHC",16,0)
 . . Q:$D(DUOUT)!$D(DIROUT)!(+$D(GMPAT)'>0)
"RTN","GMTSADHC",17,0)
 . . D RESUB^GMTSDVR(.GMPAT)
"RTN","GMTSADHC",18,0)
 . . S ZTRTN="PQ^GMTSADHC"
"RTN","GMTSADHC",19,0)
 . . W !
"RTN","GMTSADHC",20,0)
 . . D HSOUT^GMTSDVR
"RTN","GMTSADHC",21,0)
 K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW"),^("ORLP")
"RTN","GMTSADHC",22,0)
 Q
"RTN","GMTSADHC",23,0)
PQ ; Queued subroutine to print Ad Hoc HS for each patient
"RTN","GMTSADHC",24,0)
 N GMTS,GMTS1,GMTS2,GMTSAGE,GMTSDOB,GMTSDTM,GMTSLO,GMTSLPG
"RTN","GMTSADHC",25,0)
 N GMTSPHDR,GMTSPNM,GMTSRB,GMTSSN,GMTSTOF,GMTSWARD,VADM,VAERR,VAIN,VAROOT
"RTN","GMTSADHC",26,0)
 S GMPAT=0 F  S GMPAT=$O(GMPAT(GMPAT)) Q:GMPAT'>0  D  Q:$D(GMTSQIT)!$D(DIROUT)
"RTN","GMTSADHC",27,0)
 . S DFN=+$G(GMPAT(GMPAT)) D EN^GMTS1
"RTN","GMTSADHC",28,0)
 Q
"RTN","GMTSADHC",29,0)
BUILD ; Conducts Dialogue to build ad hoc summary
"RTN","GMTSADHC",30,0)
 N GMI,GMJ,X,XQORM,Y
"RTN","GMTSADHC",31,0)
 Q:$D(GMTSQIT)!($D(DIROUT))
"RTN","GMTSADHC",32,0)
 W @IOF
"RTN","GMTSADHC",33,0)
 S XQORM("S")="I $D(^GMT(142,DA(1),1,DA,0)),($P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""T"")",XQORM("M")=6
"RTN","GMTSADHC",34,0)
 S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="AD",XQORM("A")="Select NEW set of COMPONENT(S): ",XQORM("??")="D HELP^GMTSADH" D ^XQORM I Y'>0 S GMTSQIT="" Q
"RTN","GMTSADHC",35,0)
 I +Y,(X?1"^^".E) D RJUMP^GMTSUP1 G BUILD
"RTN","GMTSADHC",36,0)
 S GMTSEGC=Y
"RTN","GMTSADHC",37,0)
 S (X,GMI,GMJ)=0 F  S GMI=$O(Y(GMI)) Q:'GMI  D LOAD
"RTN","GMTSADHC",38,0)
 D GETLIM^GMTSADH1
"RTN","GMTSADHC",39,0)
 Q
"RTN","GMTSADHC",40,0)
LOAD ; Load enabled components into GMTSEG
"RTN","GMTSADHC",41,0)
 N SREC,STRN
"RTN","GMTSADHC",42,0)
 S STRN=+Y(GMI),SREC=^GMT(142,GMTSTYP,1,STRN,0)
"RTN","GMTSADHC",43,0)
LOAD1 S GMJ=GMJ+1,GMTSEG(GMJ)=SREC,GMTSEGI($P(SREC,U,2))=GMJ D LOADSEL
"RTN","GMTSADHC",44,0)
 Q
"RTN","GMTSADHC",45,0)
LOADSEL ; Loads GMTSEG(J,FN,IFN), when Selection items are present
"RTN","GMTSADHC",46,0)
 N S2,SJ,SEL
"RTN","GMTSADHC",47,0)
 S S2=0,SJ=GMJ
"RTN","GMTSADHC",48,0)
 F  S S2=$O(^GMT(142,GMTSTYP,1,STRN,1,S2)) Q:'S2  S SEL=^(S2,0),GMTSEG(GMJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),S2)=$P(SEL,";") I S2=1 S GMTSEG(SJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),0)=U_$P(SEL,";",2)
"RTN","GMTSADHC",49,0)
 Q
"RTN","GMTSADHC",50,0)
HELP ; 
"RTN","GMTSADHC",51,0)
 N GMJ,GMTSTXT,HLP
"RTN","GMTSADHC",52,0)
 S HLP=$S(X="??":"HTX2",X="?":"HTX1",1:"") I $L(HLP) W ! F GMJ=1:1 S GMTSTXT=$T(@HLP+GMJ) Q:GMTSTXT["ZZZZ"  W !,$P(GMTSTXT,";",3,99)
"RTN","GMTSADHC",53,0)
 I X="???" W !! D HELP2^GMTSUP1
"RTN","GMTSADHC",54,0)
 D REDISP
"RTN","GMTSADHC",55,0)
 Q
"RTN","GMTSADHC",56,0)
REDISP ; Ask Whether or not to redisplay menu
"RTN","GMTSADHC",57,0)
 N I,DIR,X,Y
"RTN","GMTSADHC",58,0)
 S DIR(0)="Y",DIR("A")="Redisplay items",DIR("B")="YES" D ^DIR Q:'Y
"RTN","GMTSADHC",59,0)
 W @IOF
"RTN","GMTSADHC",60,0)
 D DISP^XQORM1 W !
"RTN","GMTSADHC",61,0)
 Q
"RTN","GMTSADHC",62,0)
HTX1 ;;Help Text for "?" and "??"
"RTN","GMTSADHC",63,0)
 ;;Select ONE or MORE items from the menu, separated by commas.
"RTN","GMTSADHC",64,0)
 ;;
"RTN","GMTSADHC",65,0)
 ;;Enter: ??  to see HELP for MULTIPLE SELECTION
"RTN","GMTSADHC",66,0)
 ;;       ??? to see HELP for "^^"-jump
"RTN","GMTSADHC",67,0)
 ;;
"RTN","GMTSADHC",68,0)
 ;;ZZZZ
"RTN","GMTSADHC",69,0)
HTX2 ; HELP for ??
"RTN","GMTSADHC",70,0)
 ;;
"RTN","GMTSADHC",71,0)
 ;;The Health Summary components you select at this prompt create
"RTN","GMTSADHC",72,0)
 ;;an ADHOC Health Summary.
"RTN","GMTSADHC",73,0)
 ;;
"RTN","GMTSADHC",74,0)
 ;;Select ONE or MORE items from the menu, separated by commas.
"RTN","GMTSADHC",75,0)
 ;;
"RTN","GMTSADHC",76,0)
 ;;ALL items may be selected by typing "ALL".
"RTN","GMTSADHC",77,0)
 ;;
"RTN","GMTSADHC",78,0)
 ;;EXCEPTIONS may be entered by preceding them with a minus.
"RTN","GMTSADHC",79,0)
 ;;  For example, "ALL,-THIS,-THAT" selects all but "THIS" and "THAT".
"RTN","GMTSADHC",80,0)
 ;;
"RTN","GMTSADHC",81,0)
 ;;NOTE: Menu items are ordered alphabetically by the Component NAME.
"RTN","GMTSADHC",82,0)
 ;;      However, the displayed text is the Header Name which generally 
"RTN","GMTSADHC",83,0)
 ;;      is different from the Component Name. Component may be picked
"RTN","GMTSADHC",84,0)
 ;;      by their abbreviation, Header Name or Component Name.
"RTN","GMTSADHC",85,0)
 ;;
"RTN","GMTSADHC",86,0)
 ;;ZZZZ
"RTN","GMTSADOR")
0^17^B11519171
"RTN","GMTSADOR",1,0)
GMTSADOR ;SLC/JER - Ad Hoc Summary Driver ; 04/19/1999
"RTN","GMTSADOR",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSADOR",3,0)
MAIN ;External call to allow user to define components and defaults through
"RTN","GMTSADOR",4,0)
 ;the AD Hoc menu interface and print health summaries for a programmer-
"RTN","GMTSADOR",5,0)
 ;specified patient and device. Called with:
"RTN","GMTSADOR",6,0)
 ;  DFN=Patient internal file record number (optional)
"RTN","GMTSADOR",7,0)
 ;      For OE/RR interface sets DFN to Patient DFN in the ORVP variable.
"RTN","GMTSADOR",8,0)
 ;      If not defined a patient will be prompted for.
"RTN","GMTSADOR",9,0)
 ;
"RTN","GMTSADOR",10,0)
 N C,GMTSEG,GMTSEGI,GMTSEGC,GMTSQIT,GMTSTYP,GMTSTITL,GMW,X,Y
"RTN","GMTSADOR",11,0)
 N DIC,DIPGM,I,POP,%,GMTSMULT
"RTN","GMTSADOR",12,0)
 S DIC=142,DIC(0)="MZF",X="GMTS HS ADHOC OPTION" S Y=$$TYPE^GMTSULT K DIC Q:+Y'>0  S GMTSTYP=+Y,GMTSTITL="AD HOC"
"RTN","GMTSADOR",13,0)
 I $G(DFN)'>0 S DFN=$S($D(ORVP):$P(ORVP,";"),1:"") D:+DFN'>0 SELPT^GMTS
"RTN","GMTSADOR",14,0)
 Q:+DFN'>0
"RTN","GMTSADOR",15,0)
 F  K GMTSEG,GMTSEGI,GMTSEGC D BUILD Q:$D(GMTSQIT)!($D(DIROUT))  D HSOUT^GMTS,END^GMTS S:$D(DTOUT) GMTSQIT="" Q:$D(GMTSQIT)!($D(DIROUT))
"RTN","GMTSADOR",16,0)
 D END
"RTN","GMTSADOR",17,0)
 Q
"RTN","GMTSADOR",18,0)
BUILD ; Conducts Dialogue to build ad hoc summary
"RTN","GMTSADOR",19,0)
 N GMI,GMJ,GMW,X,XQORM,Y
"RTN","GMTSADOR",20,0)
 Q:$D(GMTSQIT)!($D(DIROUT))
"RTN","GMTSADOR",21,0)
 W @IOF
"RTN","GMTSADOR",22,0)
 S XQORM("S")="I $D(^GMT(142,DA(1),1,DA,0)),($P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""Y"")"
"RTN","GMTSADOR",23,0)
 S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="DA",XQORM("A")="Select COMPONENT(S): ",XQORM("??")="D HELP^GMTSADH" D ^XQORM I Y'>0 S GMTSQIT="" Q
"RTN","GMTSADOR",24,0)
 I +Y,(X?1"^^".E) D RJUMP^GMTSUP1 G BUILD
"RTN","GMTSADOR",25,0)
 S GMTSEGC=Y
"RTN","GMTSADOR",26,0)
 S (X,GMI,GMJ)=0 F  S GMI=$O(Y(GMI)) Q:'GMI  D LOAD
"RTN","GMTSADOR",27,0)
 D GETLIM^GMTSADH1
"RTN","GMTSADOR",28,0)
 Q
"RTN","GMTSADOR",29,0)
LOAD ; Load enabled components into GMTSEG
"RTN","GMTSADOR",30,0)
 N SREC,STRN
"RTN","GMTSADOR",31,0)
 S STRN=+Y(GMI),SREC=^GMT(142,GMTSTYP,1,STRN,0)
"RTN","GMTSADOR",32,0)
LOAD1 S GMJ=GMJ+1,GMTSEG(GMJ)=SREC,GMTSEGI($P(SREC,U,2))=GMJ D LOADSEL
"RTN","GMTSADOR",33,0)
 Q
"RTN","GMTSADOR",34,0)
LOADSEL ; Loads GMTSEG(J,FN,IFN), when Selection items are present
"RTN","GMTSADOR",35,0)
 N S2,SJ,SEL
"RTN","GMTSADOR",36,0)
 S S2=0,SJ=GMJ
"RTN","GMTSADOR",37,0)
 F  S S2=$O(^GMT(142,GMTSTYP,1,STRN,1,S2)) Q:'S2  S SEL=^(S2,0),GMTSEG(GMJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),S2)=$P(SEL,";") I S2=1 S GMTSEG(SJ,+$P(@(U_$P(SEL,";",2)_"0)"),U,2),0)=U_$P(SEL,";",2)
"RTN","GMTSADOR",38,0)
 Q
"RTN","GMTSADOR",39,0)
END ; Cleans up any residual locals
"RTN","GMTSADOR",40,0)
 K GMTSQIT,FROM,GMI,I1,ISVALID,LRDFN,PTR,SEX,TO,VAOA,VASD,VASV,X
"RTN","GMTSADOR",41,0)
 Q
"RTN","GMTSADOR",42,0)
HELP ; 
"RTN","GMTSADOR",43,0)
 N GMJ,GMTSTXT,HLP
"RTN","GMTSADOR",44,0)
 S HLP=$S(X="??":"HTX2",X="?":"HTX1",1:"") I $L(HLP) W ! F GMJ=1:1 S GMTSTXT=$T(@HLP+GMJ) Q:GMTSTXT["ZZZZ"  W !,$P(GMTSTXT,";",3,99)
"RTN","GMTSADOR",45,0)
 I X="???" W !! D HELP2^GMTSUP1
"RTN","GMTSADOR",46,0)
 D REDISP
"RTN","GMTSADOR",47,0)
 Q
"RTN","GMTSADOR",48,0)
REDISP ; Ask Whether or not to redisplay menu
"RTN","GMTSADOR",49,0)
 N I,DIR,X,Y
"RTN","GMTSADOR",50,0)
 S DIR(0)="Y",DIR("A")="Redisplay items",DIR("B")="YES" D ^DIR Q:'Y
"RTN","GMTSADOR",51,0)
 W @IOF
"RTN","GMTSADOR",52,0)
 D DISP^XQORM1 W !
"RTN","GMTSADOR",53,0)
 Q
"RTN","GMTSADOR",54,0)
HTX1 ;;Help Text for "?"
"RTN","GMTSADOR",55,0)
 ;;Select ONE or MORE items from the menu, separated by commas.
"RTN","GMTSADOR",56,0)
 ;;
"RTN","GMTSADOR",57,0)
 ;;Enter: ??  to see HELP for MULTIPLE SELECTION
"RTN","GMTSADOR",58,0)
 ;;       ??? to see HELP for "^^"-jump
"RTN","GMTSADOR",59,0)
 ;;
"RTN","GMTSADOR",60,0)
 ;;ZZZZ
"RTN","GMTSADOR",61,0)
HTX2 ; HELP for ??
"RTN","GMTSADOR",62,0)
 ;;
"RTN","GMTSADOR",63,0)
 ;;The Health Summary components you select at this prompt create
"RTN","GMTSADOR",64,0)
 ;;an ADHOC Health Summary.
"RTN","GMTSADOR",65,0)
 ;;
"RTN","GMTSADOR",66,0)
 ;;Select ONE or MORE items from the menu, separated by commas.
"RTN","GMTSADOR",67,0)
 ;;
"RTN","GMTSADOR",68,0)
 ;;ALL items may be selected by typing "ALL".
"RTN","GMTSADOR",69,0)
 ;;
"RTN","GMTSADOR",70,0)
 ;;EXCEPTIONS may be entered by preceding them with a minus.
"RTN","GMTSADOR",71,0)
 ;;  For example, "ALL,-THIS,-THAT" selects all but "THIS" and "THAT".
"RTN","GMTSADOR",72,0)
 ;;
"RTN","GMTSADOR",73,0)
 ;;ZZZZ
"RTN","GMTSCM")
0^18^B11706395
"RTN","GMTSCM",1,0)
GMTSCM ;SLC/JER - Create/Modify Health Summary Comp ; 04/19/1999
"RTN","GMTSCM",2,0)
 ;;2.7;Health Summary;**7,30**;Oct 20, 1995
"RTN","GMTSCM",3,0)
MAIN ; Controls branching
"RTN","GMTSCM",4,0)
 N %,C,D,D0,GMCMP,GMTSQIT,X,Y,DIRUT
"RTN","GMTSCM",5,0)
 I +$G(DUZ(2))'>0 W !,"DUZ(2) must be set to your division.",! Q
"RTN","GMTSCM",6,0)
 F  D  Q:$D(GMTSQIT)
"RTN","GMTSCM",7,0)
 . N DA,DIC,DIE,DR,GMCMP,X,Y,GMDA,DLAYGO,DIDEL,GMSITE
"RTN","GMTSCM",8,0)
 . S GMSITE=$P($$SITE^VASITE(),U,3)
"RTN","GMTSCM",9,0)
 . S:GMSITE'>0 GMSITE=DUZ(2)
"RTN","GMTSCM",10,0)
 . S:+$P($G(^GMT(142.1,0)),U,3)'>100000 $P(^GMT(142.1,0),U,3)=GMSITE_"000"
"RTN","GMTSCM",11,0)
 . S DIC=142.1,DIC(0)="AEMQLZ",DIC("A")="Select COMPONENT: "
"RTN","GMTSCM",12,0)
 . S DIC("S")="I $S(DUZ(2)=5000:1,(+$G(Y)'<100001)&(+$G(Y)'>9999999):1,1:0)"
"RTN","GMTSCM",13,0)
 . S DLAYGO=142.1
"RTN","GMTSCM",14,0)
 . D ^DIC I +Y'>0 S GMTSQIT="" Q
"RTN","GMTSCM",15,0)
 . S GMDA=+Y
"RTN","GMTSCM",16,0)
 . I +$P(Y,U,3) S GMCMP(0)=$P(Y,U,2) D COPY(.GMCMP)
"RTN","GMTSCM",17,0)
 . S DIDEL=142.1
"RTN","GMTSCM",18,0)
 . I $D(GMCMP)=11 S GMCMP=+GMDA D  Q
"RTN","GMTSCM",19,0)
 . . I $D(GMCMP(3.5))>9 D
"RTN","GMTSCM",20,0)
 . . . N %X,%Y
"RTN","GMTSCM",21,0)
 . . . S %X="GMCMP(3.5,",%Y="^GMT(142.1,"_+GMDA_",3.5," D %XY^%RCR
"RTN","GMTSCM",22,0)
 . . S DIE="^GMT(142.1,",DA=+GMDA
"RTN","GMTSCM",23,0)
 . . S DR=".01;1///^S X=$P(GMCMP(0),U,2);2///"_$P(GMCMP(0),U,3)_";4///"_$P(GMCMP(0),U,5)_";6///"_$P(GMCMP(0),U,7)_";10///"_$P(GMCMP(0),U,10)_";11///"_$P(GMCMP(0),U,11)_";12///"_$P(GMCMP(0),U,12)
"RTN","GMTSCM",24,0)
 . . S DR=DR_";3;3.5;I X=""^""!(X=""^^"") S DIRUT=1,Y=""@1"";1;2;4;10;11;12;6;9;@1"
"RTN","GMTSCM",25,0)
 . . D ^DIE I $D(Y)>9!($D(DIRUT))!'$D(DA) S GMTSQIT="" Q
"RTN","GMTSCM",26,0)
 . . I $D(GMCMP("SEL")) D
"RTN","GMTSCM",27,0)
 . . . S DIE="^GMT(142.1,"_+DA_",1,",DA(1)=DA,DA=1,DR=".01///"_$P(GMCMP("SEL"),U)_";1///"_$P(GMCMP("SEL"),U,2) S:'$D(@(DIE_"0)")) ^(0)="^142.17P^^" D ^DIE  I $D(Y)>9 S GMTSQIT="" Q
"RTN","GMTSCM",28,0)
 . . S DIE="^GMT(142.1,",(GMCMP,DA)=+GMDA,DR=7
"RTN","GMTSCM",29,0)
 . . D ^DIE I $D(Y)>9!($D(DIRUT)) S GMTSQIT="" Q
"RTN","GMTSCM",30,0)
 . . I $D(DA) D  Q
"RTN","GMTSCM",31,0)
 . . . W ! I $$ADHOC D ENADHOC^GMTSRM W !!,">>> Returning to Create/Modify Health Summary Component Option.",!
"RTN","GMTSCM",32,0)
 . S DIE="^GMT(142.1,",(GMCMP,DA)=+GMDA,DR=".01;1;3;3.5;I X=""^""!(X=""^^"") S DIRUT=1,Y=""@1"";2;4;10;11;12;6;9;7;@1"
"RTN","GMTSCM",33,0)
 . D ^DIE I $D(Y)>9!($D(DIRUT)) S GMTSQIT="" Q
"RTN","GMTSCM",34,0)
 . I $D(DA) D  Q
"RTN","GMTSCM",35,0)
 . . W ! I $$ADHOC,'$D(DIRUT) D ENADHOC^GMTSRM W !!,">>> Returning to Create/Modify Health Summary Component Option.",!
"RTN","GMTSCM",36,0)
 . . I $D(DIRUT) S GMTSQIT="" Q
"RTN","GMTSCM",37,0)
 . D CLEANUP^GMTSDD
"RTN","GMTSCM",38,0)
 Q
"RTN","GMTSCM",39,0)
COPY(GMCMP) ; Duplicate existing Health Summary Component
"RTN","GMTSCM",40,0)
 N %,DIC,DIR,GMI,I,X,XQORM,XQORSPEW,Y
"RTN","GMTSCM",41,0)
 S DIR(0)="Y",DIR("A")="Do you wish to duplicate an existing COMPONENT"
"RTN","GMTSCM",42,0)
 S DIR("B")="YES" D ^DIR Q:+Y'>0
"RTN","GMTSCM",43,0)
 S DIC=142,DIC(0)="XF",X="GMTS HS ADHOC OPTION" S Y=$$TYPE^GMTSULT Q:+Y'>0
"RTN","GMTSCM",44,0)
 S XQORM=+Y_";GMT(142,",XQORM(0)="1AD",XQORM("A")="Enter COMPONENT to Duplicate: "
"RTN","GMTSCM",45,0)
 W ! D ^XQORM Q:+Y'>0
"RTN","GMTSCM",46,0)
 S GMCMP=+$P($G(^GMT(142,+XQORM,1,+Y(1),0)),U,2)
"RTN","GMTSCM",47,0)
 S GMCMP(0)=GMCMP(0)_U_$P($G(^GMT(142.1,+GMCMP,0)),U,2,12)
"RTN","GMTSCM",48,0)
 I $O(^GMT(142.1,+GMCMP,3.5,0)) D
"RTN","GMTSCM",49,0)
 . S GMCMP(3.5,0)=$G(^GMT(142.1,+GMCMP,3.5,0))
"RTN","GMTSCM",50,0)
 . S GMI=0 F  S GMI=$O(^GMT(142.1,+GMCMP,3.5,GMI)) Q:+GMI'>0  D
"RTN","GMTSCM",51,0)
 . . S GMCMP(3.5,GMI,0)=$G(^(GMI,0))
"RTN","GMTSCM",52,0)
 I $O(^GMT(142.1,+GMCMP,1,0)) S GMCMP("SEL")=$G(^GMT(142.1,+GMCMP,1,$O(^(0)),0))
"RTN","GMTSCM",53,0)
 Q
"RTN","GMTSCM",54,0)
ADHOC() ; Ask user whether or not to ADD new component to AD HOC
"RTN","GMTSCM",55,0)
 N %,DIR,X,Y
"RTN","GMTSCM",56,0)
 S DIR(0)="Y",DIR("A")="ADD new Component to the AD HOC Health Summary"
"RTN","GMTSCM",57,0)
 S DIR("B")="NO" D ^DIR
"RTN","GMTSCM",58,0)
 Q Y
"RTN","GMTSDVR")
0^19^B31598496
"RTN","GMTSDVR",1,0)
GMTSDVR ; SLC/JER,KER - Health Summary Driver ; 04/19/1999
"RTN","GMTSDVR",2,0)
 ;;2.7;Health Summary;**6,16,27,28,30**;Oct 20, 1995
"RTN","GMTSDVR",3,0)
MAIN ; Control branching
"RTN","GMTSDVR",4,0)
 N C,I,GMTYP,VADM,VAROOT,ZTRTN,GMPSAP
"RTN","GMTSDVR",5,0)
 K DIROUT,DUOUT
"RTN","GMTSDVR",6,0)
 F  D  Q:$D(DUOUT)!$D(DIROUT)!($D(GMTYP)'>9)
"RTN","GMTSDVR",7,0)
 . D SELTYP Q:$D(DUOUT)!$D(DIROUT)!($D(GMTYP)'>9)
"RTN","GMTSDVR",8,0)
 . N GMPAT,GMP
"RTN","GMTSDVR",9,0)
 . F  Q:$D(DIROUT)  D  Q:$D(DUOUT)!$D(DIROUT)!(+$D(GMPAT)'>0)!(+($G(ORVP))>0)
"RTN","GMTSDVR",10,0)
 . . K GMP,GMPAT
"RTN","GMTSDVR",11,0)
 . . I +($G(ORVP)) S GMPAT(1)=+($G(ORVP))
"RTN","GMTSDVR",12,0)
 . . E  F  Q:$D(DIROUT)  K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW"),^("ORLP"),GMP D PATIENT^ORU1(.GMP),PATCOPY(.GMP,.GMPAT) Q:$S($D(DUOUT):1,$D(DIROUT):1,'+$G(GMP):1,$P($G(^VA(200,DUZ,100.1)),U,6)]"":1,1:0)  D
"RTN","GMTSDVR",13,0)
 . . . W !!,"Another patient(s) can be selected."
"RTN","GMTSDVR",14,0)
 . . Q:$D(DUOUT)!$D(DIROUT)!(+$D(GMPAT)'>0)
"RTN","GMTSDVR",15,0)
 . . N GMTSPX1,GMTSPX2
"RTN","GMTSDVR",16,0)
 . . I +$G(GMRANGE)>0 D GETRANGE^GMTSU(.GMTSPX2,.GMTSPX1) Q:$G(GMTSPX1)=""!($G(GMTSPX2)="")
"RTN","GMTSDVR",17,0)
 . . Q:$D(DUOUT)!$D(DIROUT)
"RTN","GMTSDVR",18,0)
 . . D RESUB(.GMPAT)
"RTN","GMTSDVR",19,0)
 . . S GMPSAP=$$RXAP^GMTSPD2 Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)
"RTN","GMTSDVR",20,0)
 . . S ZTRTN="PQ^GMTSDVR"
"RTN","GMTSDVR",21,0)
 . . D HSOUT
"RTN","GMTSDVR",22,0)
 K ^XUTL("OR",$J,"ORU"),^("ORV"),^("ORW"),^("ORLP")
"RTN","GMTSDVR",23,0)
 Q
"RTN","GMTSDVR",24,0)
PATCOPY(GMP,GMPAT) ;Copies patients retrieved from ^ORU1 in GMP array
"RTN","GMTSDVR",25,0)
 ;                to GMPAT array
"RTN","GMTSDVR",26,0)
 N IFN,GMDFN
"RTN","GMTSDVR",27,0)
 S IFN=0
"RTN","GMTSDVR",28,0)
 ; GMPAT(NAME,GMDFN) - want array in alphabetic order by patient
"RTN","GMTSDVR",29,0)
 F  S IFN=$O(GMP(IFN)) Q:IFN'>0  D
"RTN","GMTSDVR",30,0)
 . S GMDFN=+$G(GMP(IFN))
"RTN","GMTSDVR",31,0)
 . ; Getting name from ^DPT because name returned from ^ORUS sometimes
"RTN","GMTSDVR",32,0)
 . ; has trailing spaces which could allow duplicate recs for a patient
"RTN","GMTSDVR",33,0)
 . S GMPAT($P($G(^DPT(GMDFN,0)),U),+GMDFN)=+GMDFN
"RTN","GMTSDVR",34,0)
 Q
"RTN","GMTSDVR",35,0)
RESUB(GMP) ;Subscripts in GMP array are convert to one numeric subscript.
"RTN","GMTSDVR",36,0)
 ;        Done inorder to have GMP array in alphabetic order by patient.
"RTN","GMTSDVR",37,0)
 N NAME,GMDFN,CNT
"RTN","GMTSDVR",38,0)
 S CNT=0,NAME=""
"RTN","GMTSDVR",39,0)
 F  S NAME=$O(GMP(NAME)) Q:NAME']""  D
"RTN","GMTSDVR",40,0)
 . S GMDFN=0
"RTN","GMTSDVR",41,0)
 . F  S GMDFN=$O(GMP(NAME,GMDFN)) Q:GMDFN'>0  D
"RTN","GMTSDVR",42,0)
 . . S CNT=CNT+1
"RTN","GMTSDVR",43,0)
 . . S GMP(CNT)=GMP(NAME,GMDFN)
"RTN","GMTSDVR",44,0)
 . . K GMP(NAME,GMDFN)
"RTN","GMTSDVR",45,0)
 Q
"RTN","GMTSDVR",46,0)
ENXQ ; External call for tasked HS print
"RTN","GMTSDVR",47,0)
 ; Input: GMTSTYP=Record # of HS type in file 142
"RTN","GMTSDVR",48,0)
 ;            DFN=Record # of patient in file 2
"RTN","GMTSDVR",49,0)
 ;        GMTSPX1=Optional internal FM date for range ending date
"RTN","GMTSDVR",50,0)
 ;        GMTSPX2=Optional internal FM date for range beginning date
"RTN","GMTSDVR",51,0)
 ;  NOTE: Optional date range variables are both required if a date range
"RTN","GMTSDVR",52,0)
 ;        is desired.
"RTN","GMTSDVR",53,0)
 ; To call from TaskMan:
"RTN","GMTSDVR",54,0)
 ;        S ZTRTN="ENXQ^GMTSDVR",ZTSAVE("GMTSTYP")="",ZTSAVE("DFN")=""
"RTN","GMTSDVR",55,0)
 ;        D ^%ZTLOAD
"RTN","GMTSDVR",56,0)
 D ENX(DFN,GMTSTYP,$G(GMTSPX2),$G(GMTSPX1))
"RTN","GMTSDVR",57,0)
 Q
"RTN","GMTSDVR",58,0)
ENX(DFN,GMTSTYP,GMTSPX2,GMTSPX1) ; External call to print a Health Summary
"RTN","GMTSDVR",59,0)
 ; call with: GMTSTYP=HEALTH SUMMARY TYPE file record number
"RTN","GMTSDVR",60,0)
 ;                DFN=PATIENT file record number
"RTN","GMTSDVR",61,0)
 ;
"RTN","GMTSDVR",62,0)
 ;            GMTSPX1=Optional internal FM date for range ending date
"RTN","GMTSDVR",63,0)
 ;            GMTSPX2=Optional internal FM date for range beginning date
"RTN","GMTSDVR",64,0)
 ;  NOTE: Optional date range variables are both required if a date range
"RTN","GMTSDVR",65,0)
 ;        is desired.
"RTN","GMTSDVR",66,0)
 N DI,DX,DY,GMQUIT,GMTYP,GMPAT,VADM,VAIN,VAROOT
"RTN","GMTSDVR",67,0)
 F  Q:($D(^GMT(142,+GMTSTYP,1))>9)&$D(^DPT(DFN))!+$G(GMQUIT)  D
"RTN","GMTSDVR",68,0)
 . I $D(^GMT(142,+GMTSTYP,1))'>9 D
"RTN","GMTSDVR",69,0)
 . . I $D(ZTQUEUED) S GMQUIT=1 Q
"RTN","GMTSDVR",70,0)
 . . W !?3,"Invalid HEALTH SUMMARY TYPE." D SELTYP S GMTSTYP=+$G(GMTYP(1))
"RTN","GMTSDVR",71,0)
 . I '$D(^DPT(DFN)) D
"RTN","GMTSDVR",72,0)
 . . I $D(ZTQUEUED) S GMQUIT=1 Q
"RTN","GMTSDVR",73,0)
 . . W !?3,"Invalid PATIENT ID." D PATIENT^ORU1(.GMPAT) S DFN=+$G(GMPAT(1))
"RTN","GMTSDVR",74,0)
 Q:+$G(GMQUIT)
"RTN","GMTSDVR",75,0)
 S:$D(GMTYP)'>9 GMTYP(0)=1,GMTYP(1)=+$G(GMTSTYP)_U_$P($G(^GMT(142,+GMTSTYP,0)),U)
"RTN","GMTSDVR",76,0)
 S:$D(GMPAT)'>9 GMPAT=1,GMPAT(0)=1,GMPAT(1)=DFN_U_$P($G(^DPT(DFN,0)),U)
"RTN","GMTSDVR",77,0)
 D PQ
"RTN","GMTSDVR",78,0)
 Q
"RTN","GMTSDVR",79,0)
SELTYP ; Select Health Summary Type(s)
"RTN","GMTSDVR",80,0)
 N DIC,X,Y
"RTN","GMTSDVR",81,0)
 S DIC=142,DIC("A")="Select Health Summary Type: ",DIC(0)="AEMQZ"
"RTN","GMTSDVR",82,0)
 S DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION"""
"RTN","GMTSDVR",83,0)
 I $D(GMTYP)<10 S DIC("B")=$S($D(^DISV(DUZ,"^GMT(142,"))=10:$G(^DISV(DUZ,"^GMT(142,",$O(^("^GMT(142,",0)))),1:$P($G(^GMT(142,+$G(^DISV(DUZ,"^GMT(142,")),0)),U))
"RTN","GMTSDVR",84,0)
 K GMTYP S Y=$$TYPE^GMTSULT Q:+Y'>0
"RTN","GMTSDVR",85,0)
 I $S($D(^GMT(142,+Y,1,0))=0:1,$O(^(0))'>0:1,1:0) W !,"The Summary Type "_$P(Y,U,2)_" includes no components...Please choose another",! Q
"RTN","GMTSDVR",86,0)
 S GMTYP(0)=1,GMTYP(1)=Y_U_$P(Y,U,2)_U_$P(Y,U,2)_U_$P(Y,U,2)
"RTN","GMTSDVR",87,0)
 Q
"RTN","GMTSDVR",88,0)
PQ ; Queued subroutine for HS by patient
"RTN","GMTSDVR",89,0)
 N DFN,GMTI,GMTS,GMTS1,GMTS2,GMTSAGE,GMTSDOB,GMTSDTM,GMTSLO,GMTSLPG,GMTSPNM
"RTN","GMTSDVR",90,0)
 N GMTSRB,GMTSSN,GMTSTOF,GMTSTYP,GMTSTITL,GMTSWARD,GMTJ,I,IX0,J,M4,P17,SEX
"RTN","GMTSDVR",91,0)
 N GMTSPHDR,TRFAC,VAERR,VAIN
"RTN","GMTSDVR",92,0)
 S GMTI=0 F  S GMTI=$O(GMTYP(GMTI)) Q:GMTI'>0!$D(DIROUT)  D
"RTN","GMTSDVR",93,0)
 .N GMTSEG,GMTSEGC,GMTSEGI
"RTN","GMTSDVR",94,0)
 .S GMTSTYP=+$G(GMTYP(GMTI)),GMTSTITL=$G(^GMT(142,+GMTSTYP,"T"))
"RTN","GMTSDVR",95,0)
 .S:'$L(GMTSTITL) GMTSTITL=$P(GMTYP(GMTI),U,2)
"RTN","GMTSDVR",96,0)
 .D LOADSEG
"RTN","GMTSDVR",97,0)
 .S GMTJ=0 F  S GMTJ=$O(GMPAT(GMTJ)) Q:GMTJ'>0!$D(DIROUT)  D
"RTN","GMTSDVR",98,0)
 . . S DFN=+$G(GMPAT(GMTJ))
"RTN","GMTSDVR",99,0)
 . . N GMDUOUT
"RTN","GMTSDVR",100,0)
 . . D EN^GMTS1
"RTN","GMTSDVR",101,0)
 . . Q:$D(DIROUT)!+$G(GMDUOUT)
"RTN","GMTSDVR",102,0)
 . . D ACTPROF^GMTSDVR(DFN)
"RTN","GMTSDVR",103,0)
 Q
"RTN","GMTSDVR",104,0)
LOADSEG ;LOAD ENABLED COMPONENTS INTO GMTSEG ARRAY
"RTN","GMTSDVR",105,0)
 N GMTI,GMTJ,GMX
"RTN","GMTSDVR",106,0)
 S (GMTI,GMTJ)=0 F  S GMTJ=$O(^GMT(142,GMTSTYP,1,GMTJ)) Q:GMTJ'>0  S GMX=^(GMTJ,0) D
"RTN","GMTSDVR",107,0)
 .S GMTI=GMTI+1,GMTSEG(GMTI)=GMX,GMTSEGI($P(GMX,U,2))=GMTI D SELFILE
"RTN","GMTSDVR",108,0)
 S GMTSEGC=GMTI
"RTN","GMTSDVR",109,0)
 Q
"RTN","GMTSDVR",110,0)
SELFILE ; Get Selection item information for GMTSEG(
"RTN","GMTSDVR",111,0)
 N GMTK,ITEM,FST
"RTN","GMTSDVR",112,0)
 S GMTK=0,FST=1
"RTN","GMTSDVR",113,0)
 F  S GMTK=$O(^GMT(142,GMTSTYP,1,GMTJ,1,GMTK)) Q:GMTK'>0  S ITEM=^(GMTK,0),GMTSEG(GMTI,+$P(@(U_$P(ITEM,";",2)_"0)"),U,2),GMTK)=$P(ITEM,";") I $G(FST) S GMTSEG(GMTI,+$P(@(U_$P(ITEM,";",2)_"0)"),U,2),0)=U_$P(ITEM,";",2) K FST
"RTN","GMTSDVR",114,0)
 Q
"RTN","GMTSDVR",115,0)
HSOUT ; Output summary, with device control
"RTN","GMTSDVR",116,0)
 ; Call with: ZTRTN
"RTN","GMTSDVR",117,0)
 I $D(^XUSEC("GMTS VIEW ONLY",DUZ)) D @ZTRTN Q
"RTN","GMTSDVR",118,0)
 N %ZIS,IOP
"RTN","GMTSDVR",119,0)
 S %ZIS="PQ" D ^%ZIS Q:POP
"RTN","GMTSDVR",120,0)
 G:$D(IO("Q")) QUE
"RTN","GMTSDVR",121,0)
NOQUE D @ZTRTN
"RTN","GMTSDVR",122,0)
 D ^%ZISC
"RTN","GMTSDVR",123,0)
 Q
"RTN","GMTSDVR",124,0)
QUE ; Queue output
"RTN","GMTSDVR",125,0)
 N %,ZTDESC,ZTDTH,ZTIO,ZTSAVE,ZTSK
"RTN","GMTSDVR",126,0)
 Q:'$D(ZTRTN)  K IO("Q"),ZTSAVE F %="DFN","GM*","ENTRY","O*" S ZTSAVE(%)=""
"RTN","GMTSDVR",127,0)
 S ZTDESC="HEALTH SUMMARY",ZTIO=ION
"RTN","GMTSDVR",128,0)
 D ^%ZTLOAD W !,$S($D(ZTSK):"Request Queued!",1:"Request Cancelled!")
"RTN","GMTSDVR",129,0)
 K ZTSK,ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE D ^%ZISC
"RTN","GMTSDVR",130,0)
 S IOP="HOME" D ^%ZIS
"RTN","GMTSDVR",131,0)
 Q
"RTN","GMTSDVR",132,0)
ACTPROF(GMDFN) ; Check & print Action Profile for patient if +$G(GMPSAP)
"RTN","GMTSDVR",133,0)
 N DFN,PSTYPE,PSONOPG,PSOPAR,PSOINST
"RTN","GMTSDVR",134,0)
 I +$G(GMPSAP) D
"RTN","GMTSDVR",135,0)
 . S (PSTYPE,PSONOPG)=1,DFN=GMDFN
"RTN","GMTSDVR",136,0)
 . S $P(PSOPAR,U)=$S($P($G(^GMT(142.99,1,0)),U,5)="Y":1,1:0)
"RTN","GMTSDVR",137,0)
 . S PSOINST=$S(+$G(PSOINST):PSOINST,1:+$P($G(^DIC(4,+$P($G(^XMB(1,1,"XUS")),U,17),99)),U))
"RTN","GMTSDVR",138,0)
 . D DFN^PSOSD1
"RTN","GMTSDVR",139,0)
 . S DFN=GMDFN ;Have to reset DFN because ^PSOSD1 call kills it and it is
"RTN","GMTSDVR",140,0)
 . ; needed for the ^GMTSPL call.
"RTN","GMTSDVR",141,0)
 . D PAGE^GMTSPL
"RTN","GMTSLOAD")
0^20^B10686928
"RTN","GMTSLOAD",1,0)
GMTSLOAD ;SLC/JER - Loads Ad Hoc Summary Type ; 04/19/1999
"RTN","GMTSLOAD",2,0)
 ;;2.7;Health Summary;**23,30**;Oct 20, 1995
"RTN","GMTSLOAD",3,0)
MAIN ; Controls branching and execution
"RTN","GMTSLOAD",4,0)
 N DIC,DIR,GMI,GMW,GMTJ,GMTNM,GMTSEG,GMTSFUNC,GMTSI,GMTSIFN,GMTSWHL,INCLUDE,S2,X,Y
"RTN","GMTSLOAD",5,0)
 W !!,"This option rebuilds the Ad Hoc Health Summary to include ALL components",!
"RTN","GMTSLOAD",6,0)
 W "alphabetized by name.  If you wish, you may exclude DISABLED components.",!
"RTN","GMTSLOAD",7,0)
 S DIR(0)="Y",DIR("A")="Do you wish to continue",DIR("B")="NO",DIR("?")="Answer ""Y"" or ""N"", ""NO"" to exit this option." D ^DIR Q:Y=0  W !
"RTN","GMTSLOAD",8,0)
 I $S($D(DIRUT):1,$D(DIROUT):1,1:0) Q
"RTN","GMTSLOAD",9,0)
 S DIR("?")="Answer ""Y"" or ""N"", ""YES"" to include DISABLED components."
"RTN","GMTSLOAD",10,0)
 S DIR("A")="Should DISABLED components be included",DIR("B")="YES" D ^DIR
"RTN","GMTSLOAD",11,0)
 I $S($D(DIRUT):1,$D(DIROUT):1,1:0) Q
"RTN","GMTSLOAD",12,0)
 S INCLUDE=Y
"RTN","GMTSLOAD",13,0)
ENPOST ; Entry point from Post-init
"RTN","GMTSLOAD",14,0)
 ; call with INCLUDE=0 to exclude DISABLED components
"RTN","GMTSLOAD",15,0)
 ; call with INCLUDE=1 to include DISABLED components
"RTN","GMTSLOAD",16,0)
 N NEWREC,GMTSTYP,DLAYGO
"RTN","GMTSLOAD",17,0)
 S DLAYGO=142
"RTN","GMTSLOAD",18,0)
 S DIC=142,DIC(0)="LXF",X="GMTS HS ADHOC OPTION" S Y=$$TYPE^GMTSULT K DIC
"RTN","GMTSLOAD",19,0)
 I +Y'>0 D NOFILE Q
"RTN","GMTSLOAD",20,0)
 S (GMTSIFN,GMTSTYP)=+Y,NEWREC=+$P(Y,U,3)
"RTN","GMTSLOAD",21,0)
 S:'$D(^GMT(142,GMTSIFN,1,0)) ^(0)="^142.01IA^0^0"
"RTN","GMTSLOAD",22,0)
 S GMTNM="" F GMI=1:1 S GMTNM=$O(^GMT(142.1,"B",GMTNM)) Q:GMTNM']""  S GMTJ=$O(^(GMTNM,0)) Q:GMTJ'>0  D LOAD
"RTN","GMTSLOAD",23,0)
 S GMTSI=0 I 'NEWREC F  S GMTSI=$O(^GMT(142,GMTSIFN,1,GMTSI)) Q:GMTSI'>0  D PURGE^GMTSRN
"RTN","GMTSLOAD",24,0)
 D BMES^XPDUTL(" ")
"RTN","GMTSLOAD",25,0)
 D BMES^XPDUTL("Rebuilding Ad Hoc Summary")
"RTN","GMTSLOAD",26,0)
 D RNMBR^GMTSRN
"RTN","GMTSLOAD",27,0)
 D BMES^XPDUTL("Done.")
"RTN","GMTSLOAD",28,0)
 Q
"RTN","GMTSLOAD",29,0)
NOFILE ; Handles case where GMTS HS ADHOC OPTION Summary Type is missing
"RTN","GMTSLOAD",30,0)
 D BMES^XPDUTL(" ")
"RTN","GMTSLOAD",31,0)
 D BMES^XPDUTL("** GMTS AD HOC OPTION Summary Type is missing **")
"RTN","GMTSLOAD",32,0)
 Q
"RTN","GMTSLOAD",33,0)
LOAD ; Loads GMTSEG(GMI)=SEQUENCE^COMPONENT^OCCURRENCE LIMIT^TIME LIMIT^
"RTN","GMTSLOAD",34,0)
 ;   NULL^HOSP LOC DISPLAYED^ICD TEXT DISPLAYED^PROVIDER NARR DISPLAYED
"RTN","GMTSLOAD",35,0)
 N OCC,TIME,GMSEQ,HOSPLOC,ICDTEXT,PROVNARR
"RTN","GMTSLOAD",36,0)
 Q:'$D(^GMT(142.1,GMTJ,0))
"RTN","GMTSLOAD",37,0)
 S GMSEQ=$O(^GMT(142,"AE",GMTJ,GMTSTYP,0))
"RTN","GMTSLOAD",38,0)
 I GMSEQ>0 D
"RTN","GMTSLOAD",39,0)
 . S OCC=$S($P(^GMT(142.1,GMTJ,0),U,5)="Y":$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,3),1:"")
"RTN","GMTSLOAD",40,0)
 . S TIME=$S($P(^GMT(142.1,GMTJ,0),U,3)="Y":$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,4),1:"")
"RTN","GMTSLOAD",41,0)
 . S HOSPLOC=$S($P(^GMT(142.1,GMTJ,0),U,10)="Y":$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,6),1:"")
"RTN","GMTSLOAD",42,0)
 . S ICDTEXT=$S($P(^GMT(142.1,GMTJ,0),U,11)="Y":$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,7),1:"")
"RTN","GMTSLOAD",43,0)
 . S PROVNARR=$S($P(^GMT(142.1,GMTJ,0),U,12)="Y":$P($G(^GMT(142,GMTSTYP,1,GMSEQ,0)),U,8),1:"")
"RTN","GMTSLOAD",44,0)
 E  D
"RTN","GMTSLOAD",45,0)
 . S OCC=$S($P(^GMT(142.1,GMTJ,0),U,5)="Y":10,1:"")
"RTN","GMTSLOAD",46,0)
 . S TIME=$S($P(^GMT(142.1,GMTJ,0),U,3)="Y":"1Y",1:"")
"RTN","GMTSLOAD",47,0)
 . S HOSPLOC=$S($P(^GMT(142.1,GMTJ,0),U,10)="Y":"Y",1:"")
"RTN","GMTSLOAD",48,0)
 . S ICDTEXT=$S($P(^GMT(142.1,GMTJ,0),U,11)="Y":"L",1:"")
"RTN","GMTSLOAD",49,0)
 . S PROVNARR=$S($P(^GMT(142.1,GMTJ,0),U,12)="Y":"Y",1:"")
"RTN","GMTSLOAD",50,0)
 D SETSEG
"RTN","GMTSLOAD",51,0)
 Q
"RTN","GMTSLOAD",52,0)
SETSEG ; Set GMTSEG(GMI)
"RTN","GMTSLOAD",53,0)
 N OFF
"RTN","GMTSLOAD",54,0)
 S OFF=$S($P(^GMT(142.1,GMTJ,0),U,6)="P":1,$P(^(0),U,6)="T":1,1:0)
"RTN","GMTSLOAD",55,0)
 I (INCLUDE=0),(OFF=1) Q
"RTN","GMTSLOAD",56,0)
 S GMTSEG(GMI)=(5*GMI)_U_GMTJ_U_OCC_U_TIME_U_U_HOSPLOC_U_ICDTEXT_U_PROVNARR
"RTN","GMTSLOAD",57,0)
 I GMSEQ>0 D SETSEL
"RTN","GMTSLOAD",58,0)
 Q
"RTN","GMTSLOAD",59,0)
SETSEL ; Sets up selection items in GMTSEG(GMI,GMSEL)=Selection item
"RTN","GMTSLOAD",60,0)
 N GMSEL,GMITEM,GMW,S2
"RTN","GMTSLOAD",61,0)
 S GMSEL=0 F  S GMSEL=$O(^GMT(142,GMTSTYP,1,+GMSEQ,1,GMSEL)) Q:GMSEL'>0  S GMITEM=^(GMSEL,0) S GMTSEG(GMI,GMSEL)=GMITEM
"RTN","GMTSLOAD",62,0)
 Q
"RTN","GMTSP30")
0^10^B765574
"RTN","GMTSP30",1,0)
GMTSP30 ;SLC/RMP - GMTS*2.7*30 Post Install                ; 04/19/1999
"RTN","GMTSP30",2,0)
 ;;2.7;Health Summary;**30**;Apr 19, 1999
"RTN","GMTSP30",3,0)
 Q
"RTN","GMTSP30",4,0)
PST ; Post Install Health Summary v 2.7, Pathc 30
"RTN","GMTSP30",5,0)
EN N DA,X,Y S X=" Reindexing Health Summary Type file, #142"
"RTN","GMTSP30",6,0)
 W:'$D(XPDNM) !!,X D:$D(XPDNM) BMES^XPDUTL(X)
"RTN","GMTSP30",7,0)
 N DA,DIC,DIK S DA=$O(^GMT(142,"!"),-1),(DIC,DIK)="^GMT(142,"
"RTN","GMTSP30",8,0)
 F  S DA=$O(^GMT(142,DA)) Q:DA=""  K:$L(DA)&(+DA=0) ^GMT(142,DA)
"RTN","GMTSP30",9,0)
 S DA=0 F  S DA=$O(^GMT(142,DA)) Q:+DA=0  D IX1^DIK W "."
"RTN","GMTSP30",10,0)
 S X=" " W:'$D(XPDNM) ! D:$D(XPDNM) MES^XPDUTL(X)
"RTN","GMTSP30",11,0)
 Q
"RTN","GMTSPD")
0^21^B14763337
"RTN","GMTSPD",1,0)
GMTSPD ; SLC/JER,KER - Interactive Print-by-Location ; 04/19/1999
"RTN","GMTSPD",2,0)
 ;;2.7;Health Summary;**28,30**;Oct 20, 1995
"RTN","GMTSPD",3,0)
MAIN ; Controls branching
"RTN","GMTSPD",4,0)
 N GMPSAP,GMTSCDT,GMTSTYP,GMLOC,GMTSSC
"RTN","GMTSPD",5,0)
 S GMTSTYP=0 K DIROUT
"RTN","GMTSPD",6,0)
 F  D  Q:+GMTSTYP'>0!$D(DIROUT)
"RTN","GMTSPD",7,0)
 . S GMTSTYP=+$$SELTYP Q:+GMTSTYP'>0!$D(DIROUT)
"RTN","GMTSPD",8,0)
 . F  D  Q:+$G(GMTSSC)'>0!$D(DIROUT)!$D(DUOUT)
"RTN","GMTSPD",9,0)
 . . K GMTSSC
"RTN","GMTSPD",10,0)
 . . D SELLOC(.GMTSSC) Q:+$G(GMTSSC)'>0!$D(DIROUT)!$D(DUOUT)
"RTN","GMTSPD",11,0)
 . . D CHKLOC(.GMTSSC) Q:$O(GMTSSC(0))'>0!$D(DIROUT)!$D(DTOUT)!$D(DUOUT)
"RTN","GMTSPD",12,0)
 . . S GMPSAP=$$RXAP^GMTSPD2 Q:$D(DIROUT)!$D(DUOUT)!$D(DTOUT)
"RTN","GMTSPD",13,0)
 . . N DIROUT
"RTN","GMTSPD",14,0)
 . . D HSOUT^GMTSPD2 W !
"RTN","GMTSPD",15,0)
 Q
"RTN","GMTSPD",16,0)
SELTYP() ; Select Health Summary type
"RTN","GMTSPD",17,0)
 N DIC,X,Y
"RTN","GMTSPD",18,0)
 I $D(^DISV(DUZ,"^GMT(142,")),+$G(GMTSTYP)=0 S DIC("B")=$P($G(^GMT(142,+$G(^DISV(DUZ,"^GMT(142,")),0)),U)
"RTN","GMTSPD",19,0)
 S DIC=142,DIC("A")="Select Health Summary Type: "
"RTN","GMTSPD",20,0)
 S DIC(0)="AEQM",DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION"""
"RTN","GMTSPD",21,0)
 S Y=$$TYPE^GMTSULT I +Y'>0,X="^^" S DIROUT=1
"RTN","GMTSPD",22,0)
 I +Y>0,$S($D(^GMT(142,+Y,1,0))=0:1,$O(^(0))'>0:1,1:0) D
"RTN","GMTSPD",23,0)
 . W !,"This Summary Type includes no components...Please choose another."
"RTN","GMTSPD",24,0)
 Q Y
"RTN","GMTSPD",25,0)
SELLOC(GMX) ; Select multiple Hospital Location
"RTN","GMTSPD",26,0)
 N DIC,LOC,Y,X
"RTN","GMTSPD",27,0)
 S DIC=44,DIC(0)="AEMQZ",DIC("A")="Select Hospital Location: "
"RTN","GMTSPD",28,0)
 S DIC("S")="I ""WCOR""[$P(^(0),U,3)"
"RTN","GMTSPD",29,0)
 F  D  Q:+$G(GMX(+$G(Y)))'>0!$D(DIROUT)!$D(DTOUT)!$D(DUOUT)
"RTN","GMTSPD",30,0)
 . D ^DIC
"RTN","GMTSPD",31,0)
 . I +Y'>0 S:X="^^" DIROUT=1 Q
"RTN","GMTSPD",32,0)
 . S GMX(+Y)=$P(Y,U,1,2)_U_$P(Y(0),U,3)
"RTN","GMTSPD",33,0)
 . S $P(GMX,U)=+Y
"RTN","GMTSPD",34,0)
 . I "COR"[$P(Y(0),U,3) S $P(GMX,U,3)="COR"
"RTN","GMTSPD",35,0)
 . S DIC("A")="Select Next Hospital Location: "
"RTN","GMTSPD",36,0)
 Q
"RTN","GMTSPD",37,0)
CHKLOC(LOC) ;Get date range for Clinics and Operating Rooms.
"RTN","GMTSPD",38,0)
 ; Checks that there are patients at the locations.
"RTN","GMTSPD",39,0)
 I $P(LOC,U,3)="COR" D  Q:$D(DIROUT)!$D(DTOUT)!$D(DUOUT)
"RTN","GMTSPD",40,0)
 . S $P(LOC,U,4)=$$SELDATE
"RTN","GMTSPD",41,0)
 W !
"RTN","GMTSPD",42,0)
 S GMLOC=0
"RTN","GMTSPD",43,0)
 F  S GMLOC=$O(LOC(GMLOC)) Q:+GMLOC'>0  D
"RTN","GMTSPD",44,0)
 . I "COR"[$P(LOC(+GMLOC),U,3) S $P(LOC(+GMLOC),U,4)=$P(LOC,U,4,5)
"RTN","GMTSPD",45,0)
 . I $$CKPAT(LOC(+GMLOC))'>0 D
"RTN","GMTSPD",46,0)
 . . W !,"No patients found at ",$$LOCTXT^GMTSPD2($P(LOC(+GMLOC),U,3))," ",$P(LOC(+GMLOC),U,2)
"RTN","GMTSPD",47,0)
 . . N GMB,GME
"RTN","GMTSPD",48,0)
 . . I $P(LOC(+GMLOC),U,4)>0 D
"RTN","GMTSPD",49,0)
 . . . S X=$P(LOC(+GMLOC),U,4) D REGDT4^GMTSU S GMB=X
"RTN","GMTSPD",50,0)
 . . I $P(LOC(+GMLOC),U,5)>0 D
"RTN","GMTSPD",51,0)
 . . . S X=$P(LOC(+GMLOC),U,5) D REGDT4^GMTSU S GME=X
"RTN","GMTSPD",52,0)
 . . W $S($G(GME)]"":" on "_GMB_" to "_GME,$G(GMB)]"":" on "_GMB,1:"")
"RTN","GMTSPD",53,0)
 . . W "."
"RTN","GMTSPD",54,0)
 . . K LOC(+GMLOC)
"RTN","GMTSPD",55,0)
 W !
"RTN","GMTSPD",56,0)
 Q
"RTN","GMTSPD",57,0)
SELDATE() ; Allows entry of Visit/Surgery date or date range
"RTN","GMTSPD",58,0)
 ; for Print-by-Clinic
"RTN","GMTSPD",59,0)
 ; LTYPE=Location type (e.g., OR or Clinic)
"RTN","GMTSPD",60,0)
 N %,%H,%I,DIR,DEFDT,X,Y,GMBEG,GMEND
"RTN","GMTSPD",61,0)
 S (GMBEG,GMEND)=0
"RTN","GMTSPD",62,0)
 D NOW^%DTC S (X,DT)=$P(%,".") D REGDT4^GMTSU S DEFDT=X
"RTN","GMTSPD",63,0)
 S DIR(0)="D^::EX",DIR("B")=DEFDT
"RTN","GMTSPD",64,0)
 S DIR("A")="Please enter the beginning Visit or Surgery date"
"RTN","GMTSPD",65,0)
 D ^DIR
"RTN","GMTSPD",66,0)
 I Y="^^" S DIROUT=1
"RTN","GMTSPD",67,0)
 S GMBEG=Y
"RTN","GMTSPD",68,0)
 I +GMBEG>0 D
"RTN","GMTSPD",69,0)
 . S X=$P(GMBEG,".") D REGDT4^GMTSU S DEFDT=X
"RTN","GMTSPD",70,0)
 . S DIR(0)="DO^::EX",DIR("B")=DEFDT
"RTN","GMTSPD",71,0)
 . S DIR("A")="Please enter the ending Visit or Surgery date"
"RTN","GMTSPD",72,0)
 . D ^DIR
"RTN","GMTSPD",73,0)
 . I Y="^^" S DIROUT=1
"RTN","GMTSPD",74,0)
 . S GMEND=Y
"RTN","GMTSPD",75,0)
 Q $S(+GMEND>0&(GMEND>GMBEG):GMBEG_U_GMEND,+GMEND>0&(GMEND<GMBEG):GMEND_U_GMBEG,+GMEND>0&(GMEND=GMBEG):GMBEG,1:0)
"RTN","GMTSPD",76,0)
CKPAT(LOC) ; Checks for patients at selected location
"RTN","GMTSPD",77,0)
 ;   LOC=Ptr. to file 44^LOCATION NAME^LOCATION TYPE^BEG DATE^END DATE
"RTN","GMTSPD",78,0)
 N %,%H,%T,LTYPE,X1,X2,X,Y,GMY,GMBEG
"RTN","GMTSPD",79,0)
 S LTYPE=$P(LOC,U,3)
"RTN","GMTSPD",80,0)
 I LTYPE="W" D
"RTN","GMTSPD",81,0)
 . S LOC=$P($G(^DIC(42,+$G(^SC(+LOC,42)),0)),U)
"RTN","GMTSPD",82,0)
 . S GMY=$S($G(LOC)']"":0,$O(^DPT("CN",LOC,0)):1,1:0)
"RTN","GMTSPD",83,0)
 I $L(LOC,U)=4!($L(LOC,U)=5) D
"RTN","GMTSPD",84,0)
 . S GMY=0
"RTN","GMTSPD",85,0)
 . I +$P(LOC,U,5) S X1=$P(LOC,U,5),X2=1 D C^%DTC
"RTN","GMTSPD",86,0)
 . I +$P(LOC,U,5)'>0 S X1=$P(LOC,U,4),X2=1 D C^%DTC
"RTN","GMTSPD",87,0)
 . I LTYPE="C",+$O(^SC(+LOC,"S",$P(LOC,U,4))),(+$O(^($P(LOC,U,4)))'>X) S GMY=1
"RTN","GMTSPD",88,0)
 . I LTYPE="OR" D
"RTN","GMTSPD",89,0)
 . . N OLOC S GMY=0,OLOC=+$O(^SRS("B",+LOC,0))
"RTN","GMTSPD",90,0)
 . . I +OLOC,+$P(LOC,U,5)'>0,$O(^SRF("AOR",+OLOC,+$P(LOC,U,4),0)) S GMY=1
"RTN","GMTSPD",91,0)
 . . I +OLOC,+$P(LOC,U,5) D
"RTN","GMTSPD",92,0)
 . . . S GMBEG=$P(LOC,U,4)
"RTN","GMTSPD",93,0)
 . . . F  D  Q:GMBEG>$P(LOC,U,5)!(GMY>0)
"RTN","GMTSPD",94,0)
 . . . . I $O(^SRF("AOR",+OLOC,+GMBEG,0)) S GMY=1
"RTN","GMTSPD",95,0)
 . . . . E  S X1=GMBEG,X2=1 D C^%DTC S GMBEG=X
"RTN","GMTSPD",96,0)
 Q $G(GMY)
"RTN","GMTSPL")
0^22^B19167015
"RTN","GMTSPL",1,0)
GMTSPL ; SLC/JER,KER - Print/Queue HS for Patient Lists ; 04/19/1999
"RTN","GMTSPL",2,0)
 ;;2.7;Health Summary;**7,27,28,30**;Oct 20, 1995
"RTN","GMTSPL",3,0)
 ;
"RTN","GMTSPL",4,0)
 ; Call with:  GMTSTYP=Ptr to file 142, and
"RTN","GMTSPL",5,0)
 ; GMTSSC=Ptr to file 44^Hosp Loc Name^Hosp Loc Type^
"RTN","GMTSPL",6,0)
 ;     Optional begin Visit/Surgery Date^Optional end Visit/Surgery Date
"RTN","GMTSPL",7,0)
 ; GMTSSC()=GMTSSC - An array for multiple locations (GMTSPD)
"RTN","GMTSPL",8,0)
 ; [GMPSAP]=Optional flag set to 1 if OP Rx Action Profile is to print
"RTN","GMTSPL",9,0)
MAIN ; Controls for processing multiple locations
"RTN","GMTSPL",10,0)
 N MULTLOC
"RTN","GMTSPL",11,0)
 I +$O(GMTSSC(0))'>0 D MAINCTRL
"RTN","GMTSPL",12,0)
 I +$O(GMTSSC(0)) D
"RTN","GMTSPL",13,0)
 . S MULTLOC=0
"RTN","GMTSPL",14,0)
 . F  S MULTLOC=$O(GMTSSC(MULTLOC)) Q:+MULTLOC'>0!$D(DIROUT)  D
"RTN","GMTSPL",15,0)
 . . S GMTSSC=GMTSSC(+MULTLOC)
"RTN","GMTSPL",16,0)
 . . D MAINCTRL
"RTN","GMTSPL",17,0)
 Q
"RTN","GMTSPL",18,0)
MAINCTRL ; Controls Branching
"RTN","GMTSPL",19,0)
 N DFN,GMTDFN,GMLTYPE,GMTSLTR,GMPNM,PSOPAR,PSONOPG,PSOINST,PSTYPE
"RTN","GMTSPL",20,0)
 K ^TMP("GMTSPL",$J)
"RTN","GMTSPL",21,0)
 U IO
"RTN","GMTSPL",22,0)
 S GMLTYPE=$P(GMTSSC,U,3)
"RTN","GMTSPL",23,0)
 I GMLTYPE="C" D CLINIC(GMTSSC)
"RTN","GMTSPL",24,0)
 I GMLTYPE="W" D WARD(GMTSSC)
"RTN","GMTSPL",25,0)
 I GMLTYPE="OR" D OR(GMTSSC)
"RTN","GMTSPL",26,0)
 I $L($P(GMTSSC,U,2)),($E(IOST,1)'="C") S GMTSLTR=$E($P(GMTSSC,U,2),1,10) D ^GMTSLTR
"RTN","GMTSPL",27,0)
 I $O(^TMP("GMTSPL",$J,0))="" D NOPAT($P(GMTSSC,U,2)) Q
"RTN","GMTSPL",28,0)
 S GMPNM="" F  S GMPNM=$O(^TMP("GMTSPL",$J,GMPNM)) Q:(GMPNM="")!($D(DIROUT))  D
"RTN","GMTSPL",29,0)
 . S GMTDFN=0 F  S GMTDFN=$O(^TMP("GMTSPL",$J,GMPNM,GMTDFN)) Q:(GMTDFN'>0)!($D(DIROUT))  D
"RTN","GMTSPL",30,0)
 . . N GMDUOUT
"RTN","GMTSPL",31,0)
 . . S DFN=GMTDFN D DRIVER Q:$D(DIROUT)!+$G(GMDUOUT)
"RTN","GMTSPL",32,0)
 . . I +$G(GMPSAP) D
"RTN","GMTSPL",33,0)
 . . . S (PSTYPE,PSONOPG)=1
"RTN","GMTSPL",34,0)
 . . . S $P(PSOPAR,U)=$S($P($G(^GMT(142.99,1,0)),U,5)="Y":1,1:0)
"RTN","GMTSPL",35,0)
 . . . S PSOINST=$S(+$G(PSOINST):PSOINST,1:+$P($G(^DIC(4,+$P($G(^XMB(1,1,"XUS")),U,17),99)),U))
"RTN","GMTSPL",36,0)
 . . . D DFN^PSOSD1,PAGE
"RTN","GMTSPL",37,0)
 K ^TMP("GMTSPL",$J)
"RTN","GMTSPL",38,0)
 Q
"RTN","GMTSPL",39,0)
PAGE ; Pause at BOP for interactive users
"RTN","GMTSPL",40,0)
 N DIR,X,Y
"RTN","GMTSPL",41,0)
 Q:$E(IOST)'="C"!(IOT="HFS")!((IOSL>998)&($G(GMPAT(+$O(GMPAT(""),-1)))'=$G(DFN)))
"RTN","GMTSPL",42,0)
 I IOSL>($Y+5) F  W ! Q:IOSL<($Y+6)!($Y'<22)
"RTN","GMTSPL",43,0)
 S DIR(0)="FO^1:1",DIR("A")="Press RETURN to continue or '^' to exit"
"RTN","GMTSPL",44,0)
 S DIR("?")="Enter '^' to quit present report or '^^' to quit to menu"
"RTN","GMTSPL",45,0)
 D ^DIR
"RTN","GMTSPL",46,0)
 Q
"RTN","GMTSPL",47,0)
NOPAT(LOC) ; Handles selection of unpopulated Hospital location
"RTN","GMTSPL",48,0)
 N %,%H,%I,%T,%Y,GMTS,GMTSDTM,GMTSHDR,GMTSPG,GMTSTITL,GMTSDTM,GMTSLFG,X,Y
"RTN","GMTSPL",49,0)
 D NOW^%DTC S X=% D REGDTM4^GMTSU S GMTSDTM=X
"RTN","GMTSPL",50,0)
 S DIC=142,DIC(0)="NXF",X=+GMTSTYP S Y=$$TYPE^GMTSULT K DIC
"RTN","GMTSPL",51,0)
 S GMTSTITL=$S($D(^GMT(142,+Y,"T")):^("T"),1:$P(Y,U,2)),GMTSLFG=1
"RTN","GMTSPL",52,0)
 W @IOF D HEADER^GMTSUP W !!,"No Patients found at ",LOC," location.",!
"RTN","GMTSPL",53,0)
 Q
"RTN","GMTSPL",54,0)
CLINIC(LOC) ; Gets list of next-day appointments for selected clinic
"RTN","GMTSPL",55,0)
 N %,%H,%I,%T,%Y,DFN,GMI,GMJ,X,X1,X2,VDT,Y,GMPNM,GMDT,GMBDT,GMEDT
"RTN","GMTSPL",56,0)
 S VDT=+$P(LOC,U,4)
"RTN","GMTSPL",57,0)
 I 'VDT D NOW^%DTC S VDT=X
"RTN","GMTSPL",58,0)
 S X=+VDT D REGDT4^GMTSU S GMBDT=X
"RTN","GMTSPL",59,0)
 S X=+$P(LOC,U,5) D REGDT4^GMTSU S GMEDT=X
"RTN","GMTSPL",60,0)
 S X1=$S(+$P(LOC,U,5)>0:$P(LOC,U,5),1:VDT),X2=1 D C^%DTC
"RTN","GMTSPL",61,0)
 S GMI=VDT F  S GMI=$O(^SC(+LOC,"S",GMI)) Q:+GMI'>0!(GMI>X)  D
"RTN","GMTSPL",62,0)
 . S GMJ=0 F  S GMJ=$O(^SC(+LOC,"S",GMI,1,GMJ)) Q:+GMJ'>0  D
"RTN","GMTSPL",63,0)
 . . I '$L($P($G(^SC(+LOC,"S",GMI,1,GMJ,0)),U,9)) D
"RTN","GMTSPL",64,0)
 . . . S DFN=+$G(^SC(+LOC,"S",GMI,1,GMJ,0)) Q:DFN'>0
"RTN","GMTSPL",65,0)
 . . . S GMPNM=$P($G(^DPT(+DFN,0)),U)
"RTN","GMTSPL",66,0)
 . . . N X
"RTN","GMTSPL",67,0)
 . . . S X=+GMI D REGDT4^GMTSU S GMDT=X
"RTN","GMTSPL",68,0)
 . . . S ^TMP("GMTSPL",$J,GMPNM,+DFN)=$S($D(^TMP("GMTSPL",$J,GMPNM,+DFN)):GMBDT_" TO "_GMEDT,1:GMDT)
"RTN","GMTSPL",69,0)
 Q
"RTN","GMTSPL",70,0)
WARD(LOC) ; Gets list of patients for a specified ward
"RTN","GMTSPL",71,0)
 N DFN,GMLOC,X,Y,GMDT
"RTN","GMTSPL",72,0)
 S GMLOC=$P($G(^DIC(42,+$G(^SC(+LOC,42)),0)),U)
"RTN","GMTSPL",73,0)
 I $S('$L(GMLOC):1,'$O(^DPT("CN",GMLOC,0)):1,1:0) Q
"RTN","GMTSPL",74,0)
 S DFN=0 F  S DFN=$O(^DPT("CN",GMLOC,DFN)) Q:+DFN'>0  D
"RTN","GMTSPL",75,0)
 . N X
"RTN","GMTSPL",76,0)
 . S X=+$G(DT) D REGDT4^GMTSU S GMDT=X
"RTN","GMTSPL",77,0)
 . S ^TMP("GMTSPL",$J,$P($G(^DPT(+DFN,0)),U),+DFN)=GMDT
"RTN","GMTSPL",78,0)
 Q
"RTN","GMTSPL",79,0)
OR(LOC) ; Gets list of patients scheduled for surgery on specified date
"RTN","GMTSPL",80,0)
 N DFN,GMI,GMJ,GMPNM,GMDT,%,%H,%I,%T,%Y,X,X1,X2,Y
"RTN","GMTSPL",81,0)
 S GMI=+$O(^SRS("B",+LOC,0)) I +GMI'>0 G ORX
"RTN","GMTSPL",82,0)
 S GMBEG=$P(LOC,U,4)-.0001,GMEND=$S(+$P(LOC,U,5)>0:$P(LOC,U,5),1:$P(LOC,U,4))
"RTN","GMTSPL",83,0)
 F  S GMBEG=$O(^SRF("AOR",+GMI,+GMBEG)) Q:+GMBEG'>0!(+GMBEG>+GMEND)  D
"RTN","GMTSPL",84,0)
 . S GMJ=0 F  S GMJ=$O(^SRF("AOR",+GMI,+GMBEG,GMJ)) Q:+GMJ'>0  D
"RTN","GMTSPL",85,0)
 . . S DFN=+$G(^SRF(+GMJ,0)) Q:DFN'>0
"RTN","GMTSPL",86,0)
 . . S GMPNM=$P($G(^DPT(+DFN,0)),U)
"RTN","GMTSPL",87,0)
 . . N X
"RTN","GMTSPL",88,0)
 . . S X=+GMBEG D REGDT4^GMTSU S GMDT=X
"RTN","GMTSPL",89,0)
 . . S ^TMP("GMTSPL",$J,GMPNM,+DFN)=$S($D(^TMP("GMTSPL",$J,GMPNM,+DFN)):^(+DFN)_", "_GMDT,1:GMDT)
"RTN","GMTSPL",90,0)
ORX Q
"RTN","GMTSPL",91,0)
DRIVER ; Sets variables necessary for GMTS1 and calls ^%ZTLOAD
"RTN","GMTSPL",92,0)
 N %T,C,D0,GMTS,GMTS0,GMTS1,GMTS2,GMTSDOB,GMTSDTM,GMTSLO,GMTSLOCK,GMTSLPG
"RTN","GMTSPL",93,0)
 N GMTSEG,GMTSEGC,GMTSEGI,GMTSPNM,GMTSRB,GMTSSN,GMTSTITL,GMTSWARD,GMTSX
"RTN","GMTSPL",94,0)
 N GMTSPHDR,GMTSAGE,GMTSTOF,GMW,I,SEX,VA,VADM,VAIN,VAINDT,VAROOT,X,Y
"RTN","GMTSPL",95,0)
 S GMTSCDT(0)=^TMP("GMTSPL",$J,GMPNM,+DFN)
"RTN","GMTSPL",96,0)
 S DIC=142,DIC(0)="NXF",X=GMTSTYP S Y=$$TYPE^GMTSULT K DIC
"RTN","GMTSPL",97,0)
 S GMTSTITL=$S($G(^GMT(142,+Y,"T"))]"":^("T"),1:$P(Y,U,2))
"RTN","GMTSPL",98,0)
 D:$D(GMTSEG)'>9 SELTYP1^GMTS D EN^GMTS1
"RTN","GMTSPL",99,0)
 Q
"RTN","GMTSPNSL")
0^12^B40507409
"RTN","GMTSPNSL",1,0)
GMTSPNSL ; SLC/JER - Selected Progress Note Component ; 04/19/1999
"RTN","GMTSPNSL",2,0)
 ;;2.7;Health Summary;**12,30**;Oct 20, 1995
"RTN","GMTSPNSL",3,0)
MAIN ; Control branching
"RTN","GMTSPNSL",4,0)
 N GMTSI,GMTSJ,GMTSCNT,GMTSXTRA,GMTSREC,PN,TIUDOC,TIUSTAT
"RTN","GMTSPNSL",5,0)
 K ^TMP("TIU",$J)
"RTN","GMTSPNSL",6,0)
 S GMTSI=0
"RTN","GMTSPNSL",7,0)
 F  S GMTSI=$O(GMTSEG(+GMTSEGN,8925.1,GMTSI)) Q:+GMTSI'>0  D
"RTN","GMTSPNSL",8,0)
 . S TIUDOC(GMTSI)=+$G(GMTSEG(+GMTSEGN,8925.1,GMTSI))
"RTN","GMTSPNSL",9,0)
 D MAIN^TIULAPIS(DFN,.TIUDOC,"ALL",GMTS1,GMTS2,GMTSNDM,1)
"RTN","GMTSPNSL",10,0)
 I '$D(^TMP("TIU",$J)) Q
"RTN","GMTSPNSL",11,0)
 S GMTSI=0
"RTN","GMTSPNSL",12,0)
 F  S GMTSI=$O(^TMP("TIU",$J,GMTSI)) Q:+GMTSI'>0  D
"RTN","GMTSPNSL",13,0)
 . S GMTSJ=0
"RTN","GMTSPNSL",14,0)
 . F  S GMTSJ=$O(^TMP("TIU",$J,GMTSI,GMTSJ)) Q:+GMTSJ'>0  D
"RTN","GMTSPNSL",15,0)
 . . S GMTSK=0
"RTN","GMTSPNSL",16,0)
 . . F  S GMTSK=$O(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK)) Q:+GMTSK'>0  D
"RTN","GMTSPNSL",17,0)
 . . . N PN
"RTN","GMTSPNSL",18,0)
 . . . D WRTREC(GMTSI,GMTSJ,GMTSK)
"RTN","GMTSPNSL",19,0)
 . . . I $D(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"PROBLEM")) D WRTPROB(GMTSI,GMTSJ,GMTSK)
"RTN","GMTSPNSL",20,0)
 . . . D WRTTEXT(GMTSI,GMTSJ,GMTSK)
"RTN","GMTSPNSL",21,0)
 . . . D WRTSIG(GMTSI,GMTSJ,GMTSK)
"RTN","GMTSPNSL",22,0)
 . . . I +$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1601,"I")) D AMENDMNT^GMTSPNS1(GMTSI,GMTSJ,GMTSK)
"RTN","GMTSPNSL",23,0)
 . . . I $D(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"ZADD")) D ADDEND^GMTSPNS1(GMTSI,GMTSJ,GMTSK)
"RTN","GMTSPNSL",24,0)
 K ^TMP("TIU",$J)
"RTN","GMTSPNSL",25,0)
 Q
"RTN","GMTSPNSL",26,0)
WRTREC(GMTSI,GMTSJ,GMTSK) ; Writes record header
"RTN","GMTSPNSL",27,0)
VARI ;Sets variables
"RTN","GMTSPNSL",28,0)
 S GMTSCNT=+$G(GMTSCNT)+1
"RTN","GMTSPNSL",29,0)
 S PN("DATE")=^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1301,"I")
"RTN","GMTSPNSL",30,0)
 I PN("DATE")]"" S PN("DATE")=$$DATE^TIULS(PN("DATE"),"MM/DD/YY HR:MIN")
"RTN","GMTSPNSL",31,0)
 S PN("DOCTYPE")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,.01,"E"))
"RTN","GMTSPNSL",32,0)
 S PN("AUTHOR")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1202,"E"))
"RTN","GMTSPNSL",33,0)
 S PN("EXPSIGNR")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1204,"E"))
"RTN","GMTSPNSL",34,0)
 S PN("LOC")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1205,"E"))
"RTN","GMTSPNSL",35,0)
 S PN("EXPCOSNR")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1208,"E"))
"RTN","GMTSPNSL",36,0)
 S PN("SIGDT")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1501,"I"))
"RTN","GMTSPNSL",37,0)
 I PN("SIGDT")]"" S PN("SIGDT")=$$DATE^TIULS(PN("SIGDT"),"MM/DD/YY HR:MIN")
"RTN","GMTSPNSL",38,0)
 S SIGNEDBY=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1502,"I"))
"RTN","GMTSPNSL",39,0)
 S PN("SIGBLK")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1503,"E"))
"RTN","GMTSPNSL",40,0)
 S PN("STITLE")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1504,"E"))
"RTN","GMTSPNSL",41,0)
 S COSGEDBY=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1508,"I"))
"RTN","GMTSPNSL",42,0)
 S PN("COSDT")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1507,"I"))
"RTN","GMTSPNSL",43,0)
 I PN("COSDT")]"" S PN("COSDT")=$$DATE^TIULS(PN("COSDT"),"MM/DD/YY HR:MIN")
"RTN","GMTSPNSL",44,0)
 S PN("COBLK")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1509,"E"))
"RTN","GMTSPNSL",45,0)
 S PN("COTITLE")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1510,"E"))
"RTN","GMTSPNSL",46,0)
 S PN("SUBJ")=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1701,"E"))
"RTN","GMTSPNSL",47,0)
 I $G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1505,"I"))="C" D
"RTN","GMTSPNSL",48,0)
 . S PN("SCHART")="Signed on Chart",PN("SCHARTBY")="."
"RTN","GMTSPNSL",49,0)
 . S:$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1512,"E"))'="" PN("SCHARTBY")=" by:      "_$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1512,"E"))
"RTN","GMTSPNSL",50,0)
 I $G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1511,"I"))="C" D
"RTN","GMTSPNSL",51,0)
 . S PN("COCHART")="Cosigned on Chart",PN("COCHARTBY")="."
"RTN","GMTSPNSL",52,0)
 . S:$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1513,"E"))'="" PN("COCHARTBY")=" by:      "_$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1513,"E"))
"RTN","GMTSPNSL",53,0)
 S:$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1202,"I"))'=$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1502,"I")) PN("AUTH")="AUTHOR:  "_PN("AUTHOR")
"RTN","GMTSPNSL",54,0)
WRITE ;Header lines
"RTN","GMTSPNSL",55,0)
 I GMTSCNT>1 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",56,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W PN("DATE"),?21,"Title:  ",$$UP^XLFSTR(PN("DOCTYPE"))
"RTN","GMTSPNSL",57,0)
 I $D(PN("AUTH")) D CKP^GMTSUP Q:$D(GMTSQIT)  W !?21,PN("AUTH")
"RTN","GMTSPNSL",58,0)
 I PN("SUBJ")'="" D CKP^GMTSUP Q:$D(GMTSQIT)  W !?19,"Subject:  ",PN("SUBJ")
"RTN","GMTSPNSL",59,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",60,0)
 Q
"RTN","GMTSPNSL",61,0)
WRTTEXT(GMTSI,GMTSJ,GMTSR) ; Write Progress Note text
"RTN","GMTSPNSL",62,0)
 N GMTSK S GMTSK=0
"RTN","GMTSPNSL",63,0)
 F  S GMTSK=$O(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSR,"TEXT",GMTSK)) Q:+GMTSK'>0  D
"RTN","GMTSPNSL",64,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !,$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSR,"TEXT",GMTSK,0))
"RTN","GMTSPNSL",65,0)
 Q
"RTN","GMTSPNSL",66,0)
WRTSIG(GMTSI,GMTSJ,GMTSK) ;Writes Signatures 
"RTN","GMTSPNSL",67,0)
 I ^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1501,"I")="" D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"**DRAFT COPY - DRAFT COPY -- ABOVE NOTE IS UNSIGNED --"
"RTN","GMTSPNSL",68,0)
 I  W " DRAFT COPY - DRAFT COPY**"
"RTN","GMTSPNSL",69,0)
 I $D(PN("SCHART")) D CKP^GMTSUP Q:$D(GMTSQIT)  W !?2,PN("SCHART"),PN("SCHARTBY")
"RTN","GMTSPNSL",70,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",71,0)
 I PN("SIGBLK")'="" D
"RTN","GMTSPNSL",72,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !,$J("Signed by:",21) W:$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1505,"I"))="E" " /es/ "
"RTN","GMTSPNSL",73,0)
 . W ?27,PN("SIGBLK")
"RTN","GMTSPNSL",74,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !?27,PN("STITLE")
"RTN","GMTSPNSL",75,0)
 . I $L(PN("STITLE"))>37 D CKP^GMTSUP Q:$D(GMTSQIT)  W ! I 1
"RTN","GMTSPNSL",76,0)
 . E  W " "
"RTN","GMTSPNSL",77,0)
 . W $G(PN("SIGDT"))
"RTN","GMTSPNSL",78,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",79,0)
 . I $P($$BEEP^TIULC1(+SIGNEDBY),U) W !?34," Analog Pager:  ",$P($$BEEP^TIULC1(+SIGNEDBY),U)
"RTN","GMTSPNSL",80,0)
 . I $P($$BEEP^TIULC1(+SIGNEDBY),U,2) W !?34,"Digital Pager:  ",$P($$BEEP^TIULC1(+SIGNEDBY),U,2)
"RTN","GMTSPNSL",81,0)
 I $G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,.05,"E"))="UNCOSIGNED" D
"RTN","GMTSPNSL",82,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !?27,"** REQUIRES COSIGNATURE **"
"RTN","GMTSPNSL",83,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",84,0)
 I $D(PN("COCHART")) D CKP^GMTSUP Q:$D(GMTSQIT)  W !,$J(PN("COCHART"),20),PN("COCHARTBY") D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",85,0)
 I PN("COBLK")'="" D
"RTN","GMTSPNSL",86,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !,$J("Cosigned By:",21)
"RTN","GMTSPNSL",87,0)
 . W:$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,1511,"I"))="E" " /es/ "
"RTN","GMTSPNSL",88,0)
 . W ?27,PN("COBLK")
"RTN","GMTSPNSL",89,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !?27,PN("COTITLE")
"RTN","GMTSPNSL",90,0)
 . I $L(PN("COTITLE"))>37 D CKP^GMTSUP Q:$D(GMTSQIT)  W ! I 1
"RTN","GMTSPNSL",91,0)
 . E  W " "
"RTN","GMTSPNSL",92,0)
 . W $G(PN("COSDT"))
"RTN","GMTSPNSL",93,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",94,0)
 . I $P($$BEEP^TIULC1(+COSGEDBY),U) D CKP^GMTSUP Q:$D(GMTSQIT)  W !?34," Analog Pager:  ",$P($$BEEP^TIULC1(+COSGEDBY),U)
"RTN","GMTSPNSL",95,0)
 . I $P($$BEEP^TIULC1(+COSGEDBY),U,2) D CKP^GMTSUP Q:$D(GMTSQIT)  W !?34,"Digital Pager:  ",$P($$BEEP^TIULC1(+COSGEDBY),U,2)
"RTN","GMTSPNSL",96,0)
 I +$O(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"EXTRASGNR",0)) D
"RTN","GMTSPNSL",97,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !,$J("Concurrence:",21)
"RTN","GMTSPNSL",98,0)
 S GMTSXTRA=0
"RTN","GMTSPNSL",99,0)
 F  S GMTSXTRA=+$O(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"EXTRASGNR",GMTSXTRA)) Q:+GMTSXTRA'>0  D
"RTN","GMTSPNSL",100,0)
 . I +$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"EXTRASGNR",GMTSXTRA,"DATE"))'>0 Q
"RTN","GMTSPNSL",101,0)
 . I +GMTSXTRA>1 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",102,0)
 . W ?22,"/es/ ",$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"EXTRASGNR",GMTSXTRA,"NAME"))
"RTN","GMTSPNSL",103,0)
 . W !?27,$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"EXTRASGNR",GMTSXTRA,"TITLE"))
"RTN","GMTSPNSL",104,0)
 . I $L($G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"EXTRASGNR",GMTSXTRA,"TITLE")))>51 D
"RTN","GMTSPNSL",105,0)
 . . D CKP^GMTSUP Q:$D(GMTSQIT)  W !?28
"RTN","GMTSPNSL",106,0)
 . E  W " "
"RTN","GMTSPNSL",107,0)
 . W $$DATE^TIULS($G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"EXTRASGNR",GMTSXTRA,"DATE")),"MM/DD/CCYY HR:MIN")
"RTN","GMTSPNSL",108,0)
 . N BEEP
"RTN","GMTSPNSL",109,0)
 . S BEEP=$$BEEP^TIULC1(+$G(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"EXTRASGNR",GMTSXTRA,"EXTRA")))
"RTN","GMTSPNSL",110,0)
 . I +BEEP D CKP^GMTSUP Q:$D(GMTSQIT)  W !?34,"Analog Pager:  ",$P(BEEP,U)
"RTN","GMTSPNSL",111,0)
 . I +$P(BEEP,U,2) D CKP^GMTSUP Q:$D(GMTSQIT)  W !?33,"Digital Pager: ",$P(BEEP,U,2)
"RTN","GMTSPNSL",112,0)
 . D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",113,0)
 I +$O(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"EXTRASGNR",0))=0 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",114,0)
 Q
"RTN","GMTSPNSL",115,0)
WRTPROB(GMTSI,GMTSJ,GMTSK) ;Writes list of problems associated with note
"RTN","GMTSPNSL",116,0)
 N GMTSPR
"RTN","GMTSPNSL",117,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !,"PROBLEM(S):  "
"RTN","GMTSPNSL",118,0)
 S GMTSPR=0
"RTN","GMTSPNSL",119,0)
 F  S GMTSPR=$O(^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"PROBLEM",GMTSPR)) Q:+GMTSPR'>0  D
"RTN","GMTSPNSL",120,0)
 .  D:GMTSPR>1 CKP^GMTSUP Q:$D(GMTSQIT)  W !?15,^TMP("TIU",$J,GMTSI,GMTSJ,GMTSK,"PROBLEM",GMTSPR,0)
"RTN","GMTSPNSL",121,0)
 D CKP^GMTSUP Q:$D(GMTSQIT)  W !
"RTN","GMTSPNSL",122,0)
 Q
"RTN","GMTSPP")
0^23^B17929091
"RTN","GMTSPP",1,0)
GMTSPP ;SLC/MAM/KER - Define HS Print-by-Location Parameters ; 04/19/1999
"RTN","GMTSPP",2,0)
 ;;2.7;Health Summary;**2,30**;Oct 20, 1995
"RTN","GMTSPP",3,0)
 ;
"RTN","GMTSPP",4,0)
MAIN ;
"RTN","GMTSPP",5,0)
 K DIC,DIE,DIR
"RTN","GMTSPP",6,0)
 S DIC=19.2,DIC(0)="F",X="GMTS TASK STARTUP" D ^DIC I Y<0 D ALERT K X,Y G MAIN1
"RTN","GMTSPP",7,0)
 S OPTIFN=+Y I $D(^DIC(19.2,OPTIFN,0)),$P(^(0),U)'="" S Y=$P(^(0),U,2) K OPTIFN
"RTN","GMTSPP",8,0)
 I Y>DT D QUEOK K Y G MAIN1
"RTN","GMTSPP",9,0)
 D ALERT
"RTN","GMTSPP",10,0)
MAIN1 F  D GETDATA Q:$D(PPQIT)!$D(DTOUT)
"RTN","GMTSPP",11,0)
 K CLINIC,DIROUT,DIRUT,DTOUT,DUOUT,GMTSIFN,GMTSLOC,J1,J2,NEWTYP,PPQIT,X,B,C,D0,DI,DIJ,DISYS,DP,DQ,P
"RTN","GMTSPP",12,0)
 Q
"RTN","GMTSPP",13,0)
QUEOK ; Informs user of print time if summaries have been queued to print
"RTN","GMTSPP",14,0)
 D DD^%DT S QTIM=Y K Y
"RTN","GMTSPP",15,0)
 W !!,"For your information:",!
"RTN","GMTSPP",16,0)
 W "Health Summary Batches are queued to print nightly at ",QTIM,!
"RTN","GMTSPP",17,0)
 W "and should be available for distribution by early morning.",!
"RTN","GMTSPP",18,0)
 K QTIM
"RTN","GMTSPP",19,0)
 Q
"RTN","GMTSPP",20,0)
ALERT ; Warns user that summaries have not been queued to print
"RTN","GMTSPP",21,0)
 W !!,"                                ***Alert***",!!
"RTN","GMTSPP",22,0)
 W "Health Summary batches have not been queued to print or date is not current.",!
"RTN","GMTSPP",23,0)
 W "Please ask your IRM SERVICE to queue option GMTS TASK STARTUP",!
"RTN","GMTSPP",24,0)
 W "to run nightly.  Parameters may be set now but will not produce",!
"RTN","GMTSPP",25,0)
 W "Health Summaries until option is queued."
"RTN","GMTSPP",26,0)
 Q
"RTN","GMTSPP",27,0)
GETDATA ; Selects Loc/Type pair; Edits, deletes or sets new parameters for pair
"RTN","GMTSPP",28,0)
 S DIC=44,DIC(0)="AEMQZ",DIC("A")="Select Hospital Location: ",DIC("S")="I ""WCOR""[$P(^(0),U,3)" W ! D ^DIC K DIC
"RTN","GMTSPP",29,0)
 I Y=-1 K X,Y S PPQIT=1 Q
"RTN","GMTSPP",30,0)
 S GMTSLOC=+Y,GMTSLNM=$P(Y,U,2),CLINIC=$S("COR"[$P(Y(0),U,3):1,1:0) K X,Y
"RTN","GMTSPP",31,0)
 I $O(^GMT(142,"D",GMTSLOC,0)) D DISPLAY
"RTN","GMTSPP",32,0)
 K GMTSLNM
"RTN","GMTSPP",33,0)
 S DIC=142,DIC(0)="AEQ",DIC("A")="Select Health Summary Type: " S Y=$$TYPE^GMTSULT K DIC
"RTN","GMTSPP",34,0)
 I X="" K X,Y Q
"RTN","GMTSPP",35,0)
 I Y=-1 K X,Y S PPQIT=1 Q
"RTN","GMTSPP",36,0)
 S GMTSIFN=+Y,NEWTYP=1,TYP1=0
"RTN","GMTSPP",37,0)
 F  S TYP1=$O(^GMT(142,"D",GMTSLOC,TYP1)) Q:TYP1=""  I GMTSIFN=TYP1 S NEWTYP=0 Q
"RTN","GMTSPP",38,0)
 S GMTSUM=$P(Y,U,2),GMTSNEW=0,EXISTS=1,GMTSQIT=0 K X,Y D LIST^GMTSRM
"RTN","GMTSPP",39,0)
 K GMTSNEW,EXISTS,GMTSQIT,GMTSUM,TYP1
"RTN","GMTSPP",40,0)
 Q:$D(DUOUT)  I $D(DIRUT) S PPQIT=1 Q
"RTN","GMTSPP",41,0)
 I NEWTYP=1 D NEW Q
"RTN","GMTSPP",42,0)
 S DIR(0)="Y",DIR("A")="Do you wish to delete this Health Summary Type from the nightly print",DIR("B")="NO"
"RTN","GMTSPP",43,0)
 W ! D ^DIR K DIR
"RTN","GMTSPP",44,0)
 Q:$D(DUOUT)  I $D(DIRUT) S PPQIT=1 Q
"RTN","GMTSPP",45,0)
 S DIE="^GMT(142,"_GMTSIFN_",20,",DIE("NO^")="OUTOK",DA(1)=GMTSIFN
"RTN","GMTSPP",46,0)
 S DA=$O(^GMT(142,"D",GMTSLOC,GMTSIFN,0)),DEL=0
"RTN","GMTSPP",47,0)
 I Y=1 S DR=".01///@",DEL=1
"RTN","GMTSPP",48,0)
 K X,Y
"RTN","GMTSPP",49,0)
 E  S:CLINIC DR=".02;I $P($G(^GMT(142.99,1,0)),U,2)'=""Y"" S Y=""@1"";.03;@1;.04//0" S:'CLINIC DR=".02;I $P($G(^GMT(142.99,1,0)),U,2)'=""Y"" S Y=0;.03" W !
"RTN","GMTSPP",50,0)
 D ^DIE
"RTN","GMTSPP",51,0)
 I DEL W !!,"**Print for Health Summary Type deleted**"
"RTN","GMTSPP",52,0)
 K DIE,DA,DR,X,Y,DEL
"RTN","GMTSPP",53,0)
 Q
"RTN","GMTSPP",54,0)
DISPLAY ; Displays Health Summary Types already associated with Location
"RTN","GMTSPP",55,0)
 W !!,"At present the following Health Summary Types are printed for ",GMTSLNM,":"
"RTN","GMTSPP",56,0)
 W !?70,"Action",!?2,"Type",?32,"Device" W:CLINIC ?54,"Days Ahead" W ?70,"Profile",!
"RTN","GMTSPP",57,0)
 S DEVFLG=0
"RTN","GMTSPP",58,0)
 S TYP=0 F J1=1:1 S TYP=$O(^GMT(142,"D",GMTSLOC,TYP)) Q:TYP=""  D WRITE
"RTN","GMTSPP",59,0)
 I DEVFLG W !!,"*This Type will not print since Device is invalid or has not been entered"
"RTN","GMTSPP",60,0)
 W !!,"You may edit a Health Summary Type from the list or enter a new Type",!
"RTN","GMTSPP",61,0)
 K TYP,DEVFLG
"RTN","GMTSPP",62,0)
 Q
"RTN","GMTSPP",63,0)
WRITE ; Writes Health Summary Type with parameters
"RTN","GMTSPP",64,0)
 S TYPNM=$P(^GMT(142,TYP,0),U),LOCIFN=$O(^GMT(142,"D",GMTSLOC,TYP,0))
"RTN","GMTSPP",65,0)
 S DATA=^GMT(142,TYP,20,LOCIFN,0),DEV=$P(DATA,U,2)
"RTN","GMTSPP",66,0)
 S X="`"_DEV,DIC=3.5,DIC(0)="" D ^DIC
"RTN","GMTSPP",67,0)
 I +Y'>0 S DEVFLG=1
"RTN","GMTSPP",68,0)
 S DEVNM=$S(+Y>0:$P(Y,U,2),DEV="":"None",1:DEV_" (Invalid)")
"RTN","GMTSPP",69,0)
 W !,$S(+Y'>0:"*",1:" "),TYPNM,?32,$E(DEVNM,1,21),?59,$P(DATA,U,4),?72,$S($P(DATA,U,3)="Y":"Yes",1:"No") K DIC,X,Y
"RTN","GMTSPP",70,0)
 ;I CLINIC S DAYS=$P(DATA,U,4) S:DAYS="" DAYS=0 W ?59,DAYS
"RTN","GMTSPP",71,0)
 K DATA,DAYS,DEV,DEVNM,LOCIFN,TYPNM
"RTN","GMTSPP",72,0)
 Q
"RTN","GMTSPP",73,0)
NEW ; Sets parameters for new Health Summary Type
"RTN","GMTSPP",74,0)
 S (NI,LI)=0 I $D(^GMT(142,GMTSIFN,20,0)) F  S NI=$O(^GMT(142,GMTSIFN,20,NI)) Q:NI'>0  S LI=NI
"RTN","GMTSPP",75,0)
 S:'$D(^GMT(142,GMTSIFN,20,0)) ^(0)="^142.2P^^"
"RTN","GMTSPP",76,0)
 S DIE="^GMT(142,"_GMTSIFN_",20,",DA(1)=GMTSIFN,DA=LI+1,DIE("NO^")="OUTOK"
"RTN","GMTSPP",77,0)
 I CLINIC S DR=".01////"_GMTSLOC_";.02;I $P($G(^GMT(142.99,1,0)),U,2)'=""Y"" S Y=""@1"";.03;@1;.04//0"
"RTN","GMTSPP",78,0)
 E  S DR=".01////"_GMTSLOC_";.02;I $P($G(^GMT(142.99,1,0)),U,2)'=""Y"" S Y=0;.03"
"RTN","GMTSPP",79,0)
 W ! D ^DIE K DIE,DA,DR,X,Y,NI,LI,J3
"RTN","GMTSPP",80,0)
 Q
"RTN","GMTSRAE")
0^9^B26945344
"RTN","GMTSRAE",1,0)
GMTSRAE ;SLC/JER HIN/GJC Selected Radiology Extract ; 04/19/1999
"RTN","GMTSRAE",2,0)
 ;;2.7;Health Summary;**14,25,30**;Oct 20, 1995
"RTN","GMTSRAE",3,0)
 ;
"RTN","GMTSRAE",4,0)
MAINSEL(MODE,TEST) ; Controls branching and execution for components with
"RTN","GMTSRAE",5,0)
 ; selection items
"RTN","GMTSRAE",6,0)
 N GMIDT,GMCNT,GMPN
"RTN","GMTSRAE",7,0)
 K ^TMP("RAE",$J)
"RTN","GMTSRAE",8,0)
 S GMCNT=0,GMIDT=GMTS1+.9999,GMTS2=GMTS2+.9999
"RTN","GMTSRAE",9,0)
 F  S GMIDT=$O(^RADPT(DFN,"DT","AP",TEST,GMIDT)) Q:GMIDT'>0!(GMIDT>GMTS2)!(GMCNT=MAX)  D
"RTN","GMTSRAE",10,0)
 . Q:'$D(^RADPT(DFN,"DT",GMIDT,0))  ; missing data node, quit
"RTN","GMTSRAE",11,0)
 . N GM7002,GMPSET,GMXSET
"RTN","GMTSRAE",12,0)
 . S GM7002=$G(^RADPT(DFN,"DT",GMIDT,0)),GMXSET=+$P(GM7002,"^",5)
"RTN","GMTSRAE",13,0)
 . S GMPN=0 F  S GMPN=$O(^RADPT(DFN,"DT","AP",TEST,GMIDT,GMPN)) Q:GMPN'>0!(GMCNT=MAX)  D
"RTN","GMTSRAE",14,0)
 . . S GMCNT=GMCNT+1 D GET
"RTN","GMTSRAE",15,0)
 Q
"RTN","GMTSRAE",16,0)
MAIN(MODE) ; Controls branching and execution
"RTN","GMTSRAE",17,0)
 N GMIDT,GMCNT,GMPN
"RTN","GMTSRAE",18,0)
 K ^TMP("RAE",$J)
"RTN","GMTSRAE",19,0)
 S GMCNT=0,GMIDT=GMTS1+.9999,GMTS2=GMTS2+.9999
"RTN","GMTSRAE",20,0)
 F  S GMIDT=$O(^RADPT(DFN,"DT",GMIDT)) Q:GMIDT'>0!(GMIDT>GMTS2)!(GMCNT=MAX)  D
"RTN","GMTSRAE",21,0)
 . Q:'$D(^RADPT(DFN,"DT",GMIDT,0))  ; missing data node, quit
"RTN","GMTSRAE",22,0)
 . N GM7002,GMPSET,GMXSET
"RTN","GMTSRAE",23,0)
 . S GM7002=$G(^RADPT(DFN,"DT",GMIDT,0)),GMXSET=+$P(GM7002,"^",5)
"RTN","GMTSRAE",24,0)
 . S GMPN=0 F  S GMPN=$O(^RADPT(DFN,"DT",GMIDT,"P",GMPN)) Q:GMPN'>0!(GMCNT=MAX)  D
"RTN","GMTSRAE",25,0)
 . . S GMCNT=GMCNT+1 D GET
"RTN","GMTSRAE",26,0)
 Q
"RTN","GMTSRAE",27,0)
GET ; Gets data associated with study and sets ^TMP("RAE",$J,
"RTN","GMTSRAE",28,0)
 ; global variable definitions:
"RTN","GMTSRAE",29,0)
 ; where: GMIDT=reverse exam date/time & GMPN=case ien
"RTN","GMTSRAE",30,0)
 ;
"RTN","GMTSRAE",31,0)
 ; ^TMP("RAE",$J,GMIDT,"EXAMSET")  indicates if all exams for this
"RTN","GMTSRAE",32,0)
 ;                                 date/time are part of an exam set
"RTN","GMTSRAE",33,0)
 ;
"RTN","GMTSRAE",34,0)
 ; ^TMP("RAE",$J,GMIDT,"PRINTSET") indicates if all exams for this
"RTN","GMTSRAE",35,0)
 ;                                 exam set share the same report
"RTN","GMTSRAE",36,0)
 ;
"RTN","GMTSRAE",37,0)
 ; only if the report is verified -OR- released will these nodes be set
"RTN","GMTSRAE",38,0)
 ;
"RTN","GMTSRAE",39,0)
 ; ^TMP("RAE",$J,GMIDT,GMPN,"D",seq #) = Dx codes (seq # = 1: Pri. Dx)
"RTN","GMTSRAE",40,0)
 ; ^TMP("RAE",$J,GMIDT,GMPN,"D",seq #) = Dx codes (seq # > 1: Sec. Dx)
"RTN","GMTSRAE",41,0)
 ; ^TMP("RAE",$J,GMIDT,GMPN,"H",line #)= Clinical History line #
"RTN","GMTSRAE",42,0)
 ; ^TMP("RAE",$J,GMIDT,GMPN,"I",line #)= Impression Text line #
"RTN","GMTSRAE",43,0)
 ; ^TMP("RAE",$J,GMIDT,GMPN,"R",line #)= Report Text line #
"RTN","GMTSRAE",44,0)
 ;
"RTN","GMTSRAE",45,0)
 N DA,DIC,DIQ,DR,GMCPT,GMED,GMRP,GMRPI,GMST,GMPTR,GMRSTAT,GMIRSTAT,GMI
"RTN","GMTSRAE",46,0)
 N GMRAD,GMRRAD,GMSRAD,GMTECH
"RTN","GMTSRAE",47,0)
 S GMED=+$P(GM7002,"^")
"RTN","GMTSRAE",48,0)
 S:GMXSET&('$D(^TMP("RAE",$J,GMIDT,"EXAMSET"))) ^TMP("RAE",$J,GMIDT,"EXAMSET")=""
"RTN","GMTSRAE",49,0)
 S DIC="^RADPT("_DFN_",""DT"","_GMIDT_",""P"",",DA=GMPN,DIQ="GMRAD("
"RTN","GMTSRAE",50,0)
 S DIQ(0)="IE",DR="2;3;12;13;15;17;25"
"RTN","GMTSRAE",51,0)
 S GMTECH=+$O(^RADPT(DFN,"DT",GMIDT,"P",GMPN,"TC",0)) ; grab first tech
"RTN","GMTSRAE",52,0)
 I GMTECH S DR=DR_";175",DR(70.12)=.01,DA(70.12)=GMTECH
"RTN","GMTSRAE",53,0)
 D EN^DIQ1
"RTN","GMTSRAE",54,0)
 S GMRP=$G(GMRAD(70.03,GMPN,2,"E")),GMRPI=$G(GMRAD(70.03,GMPN,2,"I")),GMST=$G(GMRAD(70.03,GMPN,3,"E"))
"RTN","GMTSRAE",55,0)
 I GMTECH S GMTECH(0)=$E($G(GMRAD(70.12,GMTECH,.01,"E")),1,18)
"RTN","GMTSRAE",56,0)
 S GMRRAD=$E($G(GMRAD(70.03,GMPN,12,"E")),1,18)
"RTN","GMTSRAE",57,0)
 S GMSRAD=$E($G(GMRAD(70.03,GMPN,15,"E")),1,18)
"RTN","GMTSRAE",58,0)
 S GMPTR=$G(GMRAD(70.03,GMPN,17,"I"))
"RTN","GMTSRAE",59,0)
 S GMPSET=$G(GMRAD(70.03,GMPN,25,"I")) ; if GMPSET="":single exam
"RTN","GMTSRAE",60,0)
 ; if GMPSET=1:exam set, single rpt if GMPSET=2:exam set, combined rpt
"RTN","GMTSRAE",61,0)
 S DIC=DIC_DA_",""M"",",DA=0 F  S DA=$O(@(DIC_DA_")")) Q:+DA'>0  D
"RTN","GMTSRAE",62,0)
 . S DR=".01" D EN^DIQ1
"RTN","GMTSRAE",63,0)
 I +GMPTR>0 S DIC="^RARPT(",DA=GMPTR,DIQ="GMRAD(",DIQ(0)="IE",DR="5" D EN^DIQ1
"RTN","GMTSRAE",64,0)
 S GMRSTAT=$G(GMRAD(74,+GMPTR,5,"E"))
"RTN","GMTSRAE",65,0)
 S GMIRSTAT=$G(GMRAD(74,+GMPTR,5,"I"))
"RTN","GMTSRAE",66,0)
 I $L(GMIRSTAT),("VR"[$E(GMIRSTAT)) D GETDX(GMPN_","_GMIDT_","_DFN_",")
"RTN","GMTSRAE",67,0)
 S GMCPT=$P($G(^RAMIS(71,+GMRPI,0)),U,9)
"RTN","GMTSRAE",68,0)
 S GMCPT=$S(+GMCPT>0:$P($$CPT^ICPTCOD(+GMCPT),"^",2),1:"")
"RTN","GMTSRAE",69,0)
 S ^TMP("RAE",$J,GMIDT,GMPN,0)=GMED_U_GMRP_U_GMST_U_GMRSTAT_U_GMRRAD_U_GMSRAD_U_GMCPT_U_$G(GMTECH(0))
"RTN","GMTSRAE",70,0)
 S GMI=0 F  S GMI=$O(GMRAD(70.1,GMI)) Q:+GMI'>0  D
"RTN","GMTSRAE",71,0)
 . S ^TMP("RAE",$J,GMIDT,GMPN,"M",GMI)=$G(GMRAD(70.1,GMI,.01,"E"))
"RTN","GMTSRAE",72,0)
 I GMIRSTAT'="V",($E(IOST)="P") D  Q  ; Only verified reports can be printed
"RTN","GMTSRAE",73,0)
 . S:GMPSET=2 ^TMP("RAE",$J,GMIDT,"PRINTSET")="" ; still needs to be set
"RTN","GMTSRAE",74,0)
 . Q
"RTN","GMTSRAE",75,0)
 I $S(GMIRSTAT="V":0,GMIRSTAT="R":0,1:1) D  Q  ; Only verified and Released/Unverified can be seen on the terminal
"RTN","GMTSRAE",76,0)
 . S:GMPSET=2 ^TMP("RAE",$J,GMIDT,"PRINTSET")="" ; still needs to be set
"RTN","GMTSRAE",77,0)
 . Q
"RTN","GMTSRAE",78,0)
 Q:$D(^TMP("RAE",$J,GMIDT,"PRINTSET"))  ; Print set, same report
"RTN","GMTSRAE",79,0)
 I $D(^RARPT(+GMPTR,"I",0)) D GETIMP
"RTN","GMTSRAE",80,0)
 I $G(MODE)=2,$D(^RARPT(+GMPTR,"H",0)) D GETHIS
"RTN","GMTSRAE",81,0)
 I $G(MODE)=2,$D(^RARPT(+GMPTR,"R",0)) D GETREP
"RTN","GMTSRAE",82,0)
 S:GMPSET=2 ^TMP("RAE",$J,GMIDT,"PRINTSET")=""
"RTN","GMTSRAE",83,0)
 Q
"RTN","GMTSRAE",84,0)
GETIMP ; Gets Radiologist's Impression
"RTN","GMTSRAE",85,0)
 N GMLN,X
"RTN","GMTSRAE",86,0)
 K ^UTILITY($J,"W") S GMLN=0 F  S GMLN=$O(^RARPT(GMPTR,"I",GMLN)) Q:GMLN'>0  S X=^RARPT(GMPTR,"I",GMLN,0) D FORMAT
"RTN","GMTSRAE",87,0)
 I $D(^UTILITY($J,"W")) F GMLN=1:1:^UTILITY($J,"W",3) S ^TMP("RAE",$J,GMIDT,GMPN,"I",GMLN)=^UTILITY($J,"W",3,GMLN,0)
"RTN","GMTSRAE",88,0)
 K ^UTILITY($J,"W")
"RTN","GMTSRAE",89,0)
 Q
"RTN","GMTSRAE",90,0)
GETHIS ; Gets Clinical History
"RTN","GMTSRAE",91,0)
 N GMLN,X
"RTN","GMTSRAE",92,0)
 K ^UTILITY($J,"W") S GMLN=0 F  S GMLN=$O(^RARPT(GMPTR,"H",GMLN)) Q:GMLN'>0  S X=^RARPT(GMPTR,"H",GMLN,0) D FORMAT
"RTN","GMTSRAE",93,0)
 I $D(^UTILITY($J,"W")) F GMLN=1:1:^UTILITY($J,"W",3) S ^TMP("RAE",$J,GMIDT,GMPN,"H",GMLN)=^UTILITY($J,"W",3,GMLN,0)
"RTN","GMTSRAE",94,0)
 K ^UTILITY($J,"W")
"RTN","GMTSRAE",95,0)
 Q
"RTN","GMTSRAE",96,0)
GETREP ; Gets Radiologist's Report
"RTN","GMTSRAE",97,0)
 N GMLN,X
"RTN","GMTSRAE",98,0)
 K ^UTILITY($J,"W") S GMLN=0 F  S GMLN=$O(^RARPT(GMPTR,"R",GMLN)) Q:GMLN'>0  S X=^RARPT(GMPTR,"R",GMLN,0) D FORMAT
"RTN","GMTSRAE",99,0)
 I $D(^UTILITY($J,"W")) F GMLN=1:1:^UTILITY($J,"W",3) S ^TMP("RAE",$J,GMIDT,GMPN,"R",GMLN)=^UTILITY($J,"W",3,GMLN,0)
"RTN","GMTSRAE",100,0)
 K ^UTILITY($J,"W")
"RTN","GMTSRAE",101,0)
 Q
"RTN","GMTSRAE",102,0)
FORMAT ; Calls ^DIWP to format each line of text
"RTN","GMTSRAE",103,0)
 N DIWF,DIWL,DIWR,I,J,Y,Z
"RTN","GMTSRAE",104,0)
 S DIWL=3,DIWR=($S(MODE=1:76,1:80))
"RTN","GMTSRAE",105,0)
 D ^DIWP
"RTN","GMTSRAE",106,0)
 Q
"RTN","GMTSRAE",107,0)
GETDX(GMIEN) ; Set the data node with diagnostic code info.
"RTN","GMTSRAE",108,0)
 ;
"RTN","GMTSRAE",109,0)
 ; ^TMP("RAE",$J,GMIDT,GMPN,"D",seq #) = Dx codes (seq # = 1: Pri. Dx)
"RTN","GMTSRAE",110,0)
 ; ^TMP("RAE",$J,GMIDT,GMPN,"D",seq #) = Dx codes (seq # > 1: Sec. Dx)
"RTN","GMTSRAE",111,0)
 ; Input: GMIEN=case ien_","_rev exam date/time_","_patient dfn_","
"RTN","GMTSRAE",112,0)
 ;
"RTN","GMTSRAE",113,0)
 S ^TMP("RAE",$J,$P(GMIEN,",",2),$P(GMIEN,","),"D",1)=$G(GMRAD(70.03,$P(GMIEN,","),13,"E")) ; Get the Primary Dx code
"RTN","GMTSRAE",114,0)
 N GMI,GMII,GMSDX S GMI=1
"RTN","GMTSRAE",115,0)
 D GETS^DIQ(70.03,GMIEN,"13.1*","E","GMSDX") S GMII=""
"RTN","GMTSRAE",116,0)
 F  S GMII=$O(GMSDX(70.14,GMII)) Q:GMII=""  D
"RTN","GMTSRAE",117,0)
 . S GMI=GMI+1
"RTN","GMTSRAE",118,0)
 . S ^TMP("RAE",$J,$P(GMIEN,",",2),$P(GMIEN,","),"D",GMI)=$G(GMSDX(70.14,GMII,.01,"E")) ; Get the Secondary Dx code
"RTN","GMTSRAE",119,0)
 . Q
"RTN","GMTSRAE",120,0)
 Q
"RTN","GMTSRI")
0^11^B678667
"RTN","GMTSRI",1,0)
GMTSRI ;SLC/DLT - Health Summary Type Inquiry ; 04/19/1999
"RTN","GMTSRI",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSRI",3,0)
 ;
"RTN","GMTSRI",4,0)
 S U="^",DIC="^GMT(142,",DIC(0)="AEMQF"
"RTN","GMTSRI",5,0)
 S DIC("A")="Select Health Summary Type: "
"RTN","GMTSRI",6,0)
 S Y=$$TYPE^GMTSULT K DIC("A") G:Y=-1 END S (FR,TO)=$P(Y,"^",2)
"RTN","GMTSRI",7,0)
 S BY=".01",DHD="[GMTS TYPE INQ HEADER]-[GMTS TYPE INQ FOOTER]",FLDS="[GMTS TYPE INQ]",L=0 D EN1^DIP
"RTN","GMTSRI",8,0)
END Q
"RTN","GMTSRM")
0^13^B14333286
"RTN","GMTSRM",1,0)
GMTSRM ;SLC/DLT - Create/Modify Health Summary Type ; 04/19/1999
"RTN","GMTSRM",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSRM",3,0)
MAIN ;Main loop to modify multiple health summary types
"RTN","GMTSRM",4,0)
 N %,DTOUT,DUOUT,DIRUT,EXISTS,GMTSFUNC,GMTSQIT,P
"RTN","GMTSRM",5,0)
 S GMTSQIT=0 F  S EXISTS=0 D SELTYP Q:GMTSQIT
"RTN","GMTSRM",6,0)
 Q
"RTN","GMTSRM",7,0)
SELTYP ; Select Health Summary Type to Edit
"RTN","GMTSRM",8,0)
 N CHANGE,DA,DIC,DIE,DLAYGO,DR,DUOUT,EXISTS,GMTSUM,GMTSNEW,GMTSMGR
"RTN","GMTSRM",9,0)
 N GMTSEG,GMTSIFN,SELCNT,X,Y
"RTN","GMTSRM",10,0)
 W ! S U="^",DIC="^GMT(142,",DIC(0)="AEMQL"
"RTN","GMTSRM",11,0)
 S DIC("A")="Select Health Summary Type: "
"RTN","GMTSRM",12,0)
 S DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION""",DLAYGO=142
"RTN","GMTSRM",13,0)
 S Y=$$TYPE^GMTSULT K DIC S:+Y'>0 GMTSQIT=1 Q:+Y'>0  S (GMTSIFN,DA)=+Y
"RTN","GMTSRM",14,0)
 S GMTSUM=$P(Y,U,2),GMTSNEW=+$P(Y,U,3),GMTSMGR=$S($D(^XUSEC("GMTSMGR",DUZ)):1,1:0)
"RTN","GMTSRM",15,0)
 I 'GMTSMGR,($P(^GMT(142,+DA,0),U,2)]"") D  Q:'GMTSMGR
"RTN","GMTSRM",16,0)
 . S GMTSMGR=$D(^XUSEC($P(^(0),U,2),DUZ))
"RTN","GMTSRM",17,0)
 . W:'GMTSMGR !,$C(7),"This summary report is currently locked to prevent alteration.",!
"RTN","GMTSRM",18,0)
 I 'GMTSMGR,'GMTSNEW,($P(^GMT(142,+DA,0),U,3)'=DUZ) W !,$C(7),"Alteration of this summary report is restricted to its owner.",!,"See the Clinical Coordinator if you need additional help." Q
"RTN","GMTSRM",19,0)
 S DIE="^GMT(142,",(GMTSIFN,DA)=+Y,DR="[GMTS EDIT HLTH SUM TYPE]" D ^DIE
"RTN","GMTSRM",20,0)
 I '$D(^GMT(142,+GMTSIFN,0))!$D(Y)!$D(DUOUT)!$D(DIROUT)!$D(DTOUT) S GMTSQIT=1 Q
"RTN","GMTSRM",21,0)
 I 'GMTSNEW,($O(^GMT(142,+GMTSIFN,1,0))) S EXISTS=1 D LIST,EXISTS Q
"RTN","GMTSRM",22,0)
 D SELCMP^GMTSRM5 Q:GMTSQIT  D LIST:EXISTS,EXISTS
"RTN","GMTSRM",23,0)
 Q
"RTN","GMTSRM",24,0)
ENADHOC ; Entry point for AD HOC edit
"RTN","GMTSRM",25,0)
 N %,C,CHANGE,DA,DIC,DIE,DR,DUOUT,EXISTS,I,GMTSIFN,GMTSN,GMTSNCNT,GMTSNEW
"RTN","GMTSRM",26,0)
 N GMTSIFN,GMTSUM,P,SELCNT
"RTN","GMTSRM",27,0)
 N GMTSQIT,GMTSFUNC,X,Y
"RTN","GMTSRM",28,0)
 W !!,">>> EDITING the GMTS HS ADHOC OPTION Health Summary Type"
"RTN","GMTSRM",29,0)
 S (GMTSNEW,GMTSQIT)=0
"RTN","GMTSRM",30,0)
 S DIC=142,DIC(0)="XZF",X="GMTS HS ADHOC OPTION"
"RTN","GMTSRM",31,0)
 S Y=$$TYPE^GMTSULT I +Y'>0 D ^GMTSLOAD Q:$D(DIRUT)!$D(DIROUT)  G ENADHOC
"RTN","GMTSRM",32,0)
 S GMTSIFN=+Y,GMTSUM=$P(Y,U,2),EXISTS=1
"RTN","GMTSRM",33,0)
 S DIE="^GMT(142,",DA=GMTSIFN,DR=".08T" D ^DIE
"RTN","GMTSRM",34,0)
 Q:$D(Y)
"RTN","GMTSRM",35,0)
 D LIST,EXISTS
"RTN","GMTSRM",36,0)
 Q
"RTN","GMTSRM",37,0)
EXISTS ;Edit an existing health summary type
"RTN","GMTSRM",38,0)
 N CNT,NXTCMP
"RTN","GMTSRM",39,0)
 Q:$D(DUOUT)
"RTN","GMTSRM",40,0)
 S NXTCMP=0 ;NXTCMP tracks whether any component changes may have been made.
"RTN","GMTSRM",41,0)
 S NXTCMP(0)=0 F CNT=$$GETCNT(GMTSIFN):0 D NXTCMP^GMTSRM1,LIST:GMTSQIT Q:GMTSQIT!($D(DUOUT))  K GMTSQIT,GMTSNEW,TWEENER,SOACTION
"RTN","GMTSRM",42,0)
 I NXTCMP>0 W !,"Please hold on while I resequence the summary order" D COPY^GMTSRN,RNMBR^GMTSRN:CHANGE
"RTN","GMTSRM",43,0)
 Q
"RTN","GMTSRM",44,0)
LIST ; Lists existing summary parameters
"RTN","GMTSRM",45,0)
 N B,DIC,DIR,IOP,Y,FR,TO,BY,DHD,FLDS,L
"RTN","GMTSRM",46,0)
 I GMTSQIT'=2 Q:($D(DUOUT)!(GMTSQIT=1))  ;List after return from NXTCMP^GMTSRM1
"RTN","GMTSRM",47,0)
 I GMTSQIT=2,(NXTCMP=0) S GMTSQIT=0 Q
"RTN","GMTSRM",48,0)
 I 'GMTSNEW W ! S DIC=142,DIR(0)="Y",DIR("A")="Do you wish to review the Summary Type structure before continuing",DIR("B")="NO" D ^DIR K DIR I 'Y S:GMTSQIT=2 DUOUT="" S:GMTSQIT=2 GMTSQIT="D" S:$D(DUOUT) GMTSQIT=1 Q
"RTN","GMTSRM",49,0)
 I $D(GMTSQIT),GMTSQIT=2 S GMTSQIT=0 ;Allow for reiterative updates of Components.
"RTN","GMTSRM",50,0)
 S IOP="HOME",DIC=142,(FR,TO)=GMTSUM,BY=".01",DHD="[GMTS TYPE INQ HEADER]-[GMTS TYPE INQ FOOTER]",FLDS="[GMTS TYPE INQ]",L=0 D EN1^DIP
"RTN","GMTSRM",51,0)
 Q
"RTN","GMTSRM",52,0)
GETCNT(GMTSIFN) ; Determine default summary order for new component
"RTN","GMTSRM",53,0)
 N LI,LCNT
"RTN","GMTSRM",54,0)
 S LI=0,LCNT=5 F  S LI=$O(^GMT(142,+GMTSIFN,1,LI)) Q:+LI'>0  S LCNT=$P(LI,".")+5
"RTN","GMTSRM",55,0)
 Q LCNT
"RTN","GMTSRM5")
0^24^B8751202
"RTN","GMTSRM5",1,0)
GMTSRM5 ;SLC/DLT - Create/Modify - Copy from existing type ; 04/19/1999
"RTN","GMTSRM5",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSRM5",3,0)
 ;
"RTN","GMTSRM5",4,0)
SELCMP ;Select components from existing health summary type
"RTN","GMTSRM5",5,0)
 N DIC,DIR,GMI,GMTSEG,GMTSEGI,GMTSTITL,GMTSTYP,I,SEQ,X,XQORM,Y
"RTN","GMTSRM5",6,0)
 W ! S DIR(0)="Y",DIR("A")="Do you wish to copy COMPONENTS from an existing Health Summary Type",DIR("B")="YES" D ^DIR S:+Y'>0 EXISTS=0 S:$D(DTOUT)!($D(DIROUT)) GMTSQIT=1 K DIR Q:+Y'>0
"RTN","GMTSRM5",7,0)
 W ! S GMTSQIT=0,DIC=142,DIC(0)="AEFQMZ",DIC("A")="Select Health Summary Type to copy from: "
"RTN","GMTSRM5",8,0)
 S Y=$$TYPE^GMTSULT K DIC S:Y=-1 GMTSQIT=1 Q:GMTSQIT  S GMTSTYP=+Y,GMTSTITL=$P(Y,U,2)
"RTN","GMTSRM5",9,0)
 W @IOF,"The Following Components are Available:",!
"RTN","GMTSRM5",10,0)
 S XQORM("S")="I $P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""Y"""
"RTN","GMTSRM5",11,0)
 S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="DA",XQORM("A")="Select COMPONENTS(S): ",XQORM("??")="D HELP^GMTSRM2" D ^XQORM I Y'>0 S GMTSQIT=1 K XQORM,Y Q
"RTN","GMTSRM5",12,0)
 S (X,GMI,SEQ)=0 F  S GMI=$O(Y(GMI)) Q:'GMI  S X=^GMT(142,GMTSTYP,1,+Y(GMI),0) I $P(X,U,2) S SEQ=SEQ+1,GMTSEG(SEQ)=X,GMTSEGI($P(X,U,2))=SEQ D SETUPSEL
"RTN","GMTSRM5",13,0)
 ;Load global from GMTSEG() array.
"RTN","GMTSRM5",14,0)
 S:'$D(^GMT(142,GMTSIFN,1,0)) ^(0)="^142.01IA^0^0"
"RTN","GMTSRM5",15,0)
 W !!,"Loading components into the Health Summary Type with defaults"
"RTN","GMTSRM5",16,0)
 S EXISTS=1
"RTN","GMTSRM5",17,0)
 S SEQ=0 F  S SEQ=$O(GMTSEG(SEQ)) Q:'SEQ  D LOADCMP
"RTN","GMTSRM5",18,0)
 Q
"RTN","GMTSRM5",19,0)
LOADCMP ; Call DIE to stuff STRUCTURE multiple for each component
"RTN","GMTSRM5",20,0)
 N ISEQ,DA,DIE,DR,CNT,SDA,S2
"RTN","GMTSRM5",21,0)
 S (ISEQ,DA)=SEQ*5,DIE="^GMT(142,"_GMTSIFN_",1,",DA(1)=GMTSIFN
"RTN","GMTSRM5",22,0)
 S DR=".01///"_DA_";1///"_$P(GMTSEG(SEQ),U,2)_";2///"_$P(GMTSEG(SEQ),U,3)_";3///"_$P(GMTSEG(SEQ),U,4)_";5///"_$P(GMTSEG(SEQ),U,5)_";6///"_$P(GMTSEG(SEQ),U,6)_";7///"_$P(GMTSEG(SEQ),U,7)_";8///"_$P(GMTSEG(SEQ),U,8) D ^DIE
"RTN","GMTSRM5",23,0)
 S (CNT,S2)=0 F  S S2=$O(GMTSEG(SEQ,S2)) Q:'S2  D LOADSEL
"RTN","GMTSRM5",24,0)
 I CNT>0 S:'$D(^GMT(142,GMTSIFN,1,ISEQ,1,0)) ^(0)="^142.14V^"_SDA_"^"_CNT
"RTN","GMTSRM5",25,0)
 Q
"RTN","GMTSRM5",26,0)
LOADSEL ; Loads selection item multiple
"RTN","GMTSRM5",27,0)
 N DIE,DA,DR
"RTN","GMTSRM5",28,0)
 S:'$D(^GMT(142,GMTSIFN,1,ISEQ,1,0)) ^(0)="^142.14V^^"
"RTN","GMTSRM5",29,0)
 S DIE="^GMT(142,"_GMTSIFN_",1,"_ISEQ_",1,",DA(2)=GMTSIFN,DA(1)=ISEQ,DA=S2,DR=".01////"_"^S X=GMTSEG(SEQ,S2)" D ^DIE S SDA=DA,CNT=CNT+1
"RTN","GMTSRM5",30,0)
 Q
"RTN","GMTSRM5",31,0)
SETUPSEL ;Setup default selection items into new summary type
"RTN","GMTSRM5",32,0)
 N S2,SEL
"RTN","GMTSRM5",33,0)
 S S2=0 F  S S2=$O(^GMT(142,GMTSTYP,1,+Y(GMI),1,S2)) Q:'S2  S SEL=^(S2,0) S GMTSEG(SEQ,S2)=SEL
"RTN","GMTSRM5",34,0)
 Q
"RTN","GMTSUIX")
0^1^B16047155
"RTN","GMTSUIX",1,0)
GMTSUIX ; SLC/KER - Health Summary Set/Kill Indexes        ; 04/19/1999
"RTN","GMTSUIX",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSUIX",3,0)
 ;;
"RTN","GMTSUIX",4,0)
 Q
"RTN","GMTSUIX",5,0)
STNT ; Set word indexes for Health Summary Type NAME and TITLE
"RTN","GMTSUIX",6,0)
 N GMTSTR,GMTSIEN,GMTSPSN,GMTSCNT,GMTSWORD S GMTSTR=$G(X) Q:'$L(GMTSTR)  S GMTSIEN=+($G(DA)) Q:+GMTSIEN=0
"RTN","GMTSUIX",7,0)
 S GMTSCNT=1 F GMTSPSN=1:1:$L(GMTSTR)+1 D
"RTN","GMTSUIX",8,0)
 . S GMTSWORD=$E(GMTSTR,GMTSPSN) I "(,.?! '-/&:;)"[GMTSWORD D
"RTN","GMTSUIX",9,0)
 . . S GMTSWORD=$E($E(GMTSTR,GMTSCNT,GMTSPSN-1),1,30),GMTSCNT=GMTSPSN+1 I $L(GMTSWORD)>0 D
"RTN","GMTSUIX",10,0)
 . . . S @("^GMT(142,""AW"","""_$$UP(GMTSWORD)_""","_GMTSIEN_")")=""
"RTN","GMTSUIX",11,0)
 Q
"RTN","GMTSUIX",12,0)
KTNT ; Kill word indexes for Health Summary Type NAME and TITLE
"RTN","GMTSUIX",13,0)
 N GMTSTR,GMTSIEN,GMTSPSN,GMTSCNT,GMTSWORD S GMTSTR=$G(X) Q:'$L(GMTSTR)  S GMTSIEN=+($G(DA)) Q:+GMTSIEN=0
"RTN","GMTSUIX",14,0)
 S GMTSCNT=1 F GMTSPSN=1:1:$L(GMTSTR)+1 D
"RTN","GMTSUIX",15,0)
 . S GMTSWORD=$E(GMTSTR,GMTSPSN) I "(,.?! '-/&:;)"[GMTSWORD D
"RTN","GMTSUIX",16,0)
 . . S GMTSWORD=$E($E(GMTSTR,GMTSCNT,GMTSPSN-1),1,30),GMTSCNT=GMTSPSN+1 I $L(GMTSWORD)>0 D
"RTN","GMTSUIX",17,0)
 . . . K @("^GMT(142,""AW"","""_$$UP(GMTSWORD)_""","_GMTSIEN_")")
"RTN","GMTSUIX",18,0)
 Q
"RTN","GMTSUIX",19,0)
STO ; Set word indexes for Health Summary Type OWNER
"RTN","GMTSUIX",20,0)
 N GMTSTR,GMTSIEN,GMTSPSN,GMTSCNT,GMTSWORD
"RTN","GMTSUIX",21,0)
 S GMTSTR=+($G(X)) Q:GMTSTR'>0  Q:GMTSTR>0&(GMTSTR<1)  S GMTSTR=$P($G(^VA(200,+GMTSTR,0)),U,1) Q:'$L(GMTSTR)  S GMTSIEN=+($G(DA)) Q:+GMTSIEN=0
"RTN","GMTSUIX",22,0)
 S GMTSCNT=1 F GMTSPSN=1:1:$L(GMTSTR)+1 D
"RTN","GMTSUIX",23,0)
 . S GMTSWORD=$E(GMTSTR,GMTSPSN) I "(,.?! '-/&:;)"[GMTSWORD D
"RTN","GMTSUIX",24,0)
 . . S GMTSWORD=$E($E(GMTSTR,GMTSCNT,GMTSPSN-1),1,30),GMTSCNT=GMTSPSN+1 I $L(GMTSWORD)>0 D
"RTN","GMTSUIX",25,0)
 . . . S @("^GMT(142,""AW"","""_$$UP(GMTSWORD)_""","_GMTSIEN_")")=""
"RTN","GMTSUIX",26,0)
 Q
"RTN","GMTSUIX",27,0)
KTO ; Kill word indexes for Health Summary Type OWNER
"RTN","GMTSUIX",28,0)
 N GMTSTR,GMTSIEN,GMTSPSN,GMTSCNT,GMTSWORD
"RTN","GMTSUIX",29,0)
 S GMTSTR=+($G(X)) Q:GMTSTR'>0  Q:GMTSTR>0&(GMTSTR<1)  S GMTSTR=$P($G(^VA(200,+GMTSTR,0)),U,1) Q:'$L(GMTSTR)  S GMTSIEN=+($G(DA)) Q:+GMTSIEN=0
"RTN","GMTSUIX",30,0)
 S GMTSCNT=1 F GMTSPSN=1:1:$L(GMTSTR)+1 D
"RTN","GMTSUIX",31,0)
 . S GMTSWORD=$E(GMTSTR,GMTSPSN) I "(,.?! '-/&:;)"[GMTSWORD D
"RTN","GMTSUIX",32,0)
 . . S GMTSWORD=$E($E(GMTSTR,GMTSCNT,GMTSPSN-1),1,30),GMTSCNT=GMTSPSN+1 I $L(GMTSWORD)>0 D
"RTN","GMTSUIX",33,0)
 . . . K @("^GMT(142,""AW"","""_$$UP(GMTSWORD)_""","_GMTSIEN_")")
"RTN","GMTSUIX",34,0)
 Q
"RTN","GMTSUIX",35,0)
STL ; Set word indexes for Health Summary Type LOCATION
"RTN","GMTSUIX",36,0)
 N GMTSTR,GMTSIEN,GMTSPSN,GMTSCNT,GMTSWORD S GMTSTR=$P($G(^SC(+($G(X)),0)),U,1) Q:'$L(GMTSTR)  S GMTSIEN1=+($G(DA(1))) Q:+GMTSIEN1=0  S GMTSIEN2=+($G(DA)) Q:+GMTSIEN2=0
"RTN","GMTSUIX",37,0)
 S GMTSCNT=1 F GMTSPSN=1:1:$L(GMTSTR)+1 D
"RTN","GMTSUIX",38,0)
 . S GMTSWORD=$E(GMTSTR,GMTSPSN) I "(,.?! '-/&:;)"[GMTSWORD D
"RTN","GMTSUIX",39,0)
 . . S GMTSWORD=$E($E(GMTSTR,GMTSCNT,GMTSPSN-1),1,30),GMTSCNT=GMTSPSN+1 I $L(GMTSWORD)>0 D
"RTN","GMTSUIX",40,0)
 . . .S @("^GMT(142,""AW"","""_$$UP(GMTSWORD)_""","_GMTSIEN1_","_GMTSIEN2_")")=""
"RTN","GMTSUIX",41,0)
 Q
"RTN","GMTSUIX",42,0)
KTL ; Kill word indexes for Health Summary Type LOCATION
"RTN","GMTSUIX",43,0)
 N GMTSTR,GMTSIEN,GMTSPSN,GMTSCNT,GMTSWORD S GMTSTR=$P($G(^SC(+($G(X)),0)),U,1) Q:'$L(GMTSTR)  S GMTSIEN1=+($G(DA(1))) Q:+GMTSIEN1=0  S GMTSIEN2=+($G(DA)) Q:+GMTSIEN2=0
"RTN","GMTSUIX",44,0)
 S GMTSCNT=1 F GMTSPSN=1:1:$L(GMTSTR)+1 D
"RTN","GMTSUIX",45,0)
 . S GMTSWORD=$E(GMTSTR,GMTSPSN) I "(,.?! '-/&:;)"[GMTSWORD D
"RTN","GMTSUIX",46,0)
 . . S GMTSWORD=$E($E(GMTSTR,GMTSCNT,GMTSPSN-1),1,30),GMTSCNT=GMTSPSN+1 I $L(GMTSWORD)>0 D
"RTN","GMTSUIX",47,0)
 . . . K @("^GMT(142,""AW"","""_$$UP(GMTSWORD)_""","_GMTSIEN1_","_GMTSIEN2_")")
"RTN","GMTSUIX",48,0)
 Q
"RTN","GMTSUIX",49,0)
RXT ; Re-index Health Summary Type file #142
"RTN","GMTSUIX",50,0)
 W !,"Re-indexing Health Summary Type file #142"
"RTN","GMTSUIX",51,0)
 N DIK,DA,IX S DA=0 F  S DA=$O(^GMT(142,DA)) Q:+DA=0  D
"RTN","GMTSUIX",52,0)
 . S IX="~" F  S IX=$O(^GMT(142,DA,1,IX),-1) Q:+IX>0!(IX="")  I IX="0" K:$E(IX,1)?1U!($E(IX,1)?1L) ^GMT(142,DA,1,IX)
"RTN","GMTSUIX",53,0)
 . S IX="~" F  S IX=$O(^GMT(142,DA,20,IX),-1) Q:+IX>0!(IX="")  I IX="0" K:$E(IX,1)?1U!($E(IX,1)?1L) ^GMT(142,DA,20,IX)
"RTN","GMTSUIX",54,0)
 S IX="~" F  S IX=$O(^GMT(142,IX),-1) Q:+IX>0!(IX="")  I IX'="0" K:$E(IX,1)?1U!($E(IX,1)?1L) ^GMT(142,IX)
"RTN","GMTSUIX",55,0)
 W ! S DA=0 F  S DA=$O(^GMT(142,DA)) Q:+DA=0  S DIK="^GMT(142," D IX1^DIK W "."
"RTN","GMTSUIX",56,0)
 Q
"RTN","GMTSUIX",57,0)
UP(X) ; Uppercase
"RTN","GMTSUIX",58,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSUIX",59,0)
TRIM(X) ; Trim Spaces
"RTN","GMTSUIX",60,0)
 S X=$G(X) Q:X="" X F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSUIX",61,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSUIX",62,0)
 F  Q:X'["  "  S X=$P(X,"  ",1)_" "_$P(X,"  ",2,229)
"RTN","GMTSUIX",63,0)
 Q X
"RTN","GMTSULT")
0^2^B37325818
"RTN","GMTSULT",1,0)
GMTSULT ; SLC/KER - HS Type Lookup                      ; 04/19/1999
"RTN","GMTSULT",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSULT",3,0)
 ;;
"RTN","GMTSULT",4,0)
 N DIC,DTOUT,DUOUT,DIRUT D DICHK S DIC(0)="AEMQZ" S Y=$$TYPE^GMTSULT
"RTN","GMTSULT",5,0)
 Q
"RTN","GMTSULT",6,0)
 ;                   
"RTN","GMTSULT",7,0)
EN ; Lookup (general)
"RTN","GMTSULT",8,0)
 Q:$G(DIC(0))["I"
"RTN","GMTSULT",9,0)
 K DTOUT,DUOUT
"RTN","GMTSULT",10,0)
 N GMTSDICW,GMTSDICS,GMTSDIC,GMTSLGO,GMTSDIC0,GMTSDICB,GMTSDEF,GMTSWY,GMTSDISV,GMTSDICA,GMTSLERR,GMTSE,GMTSQ,GMTSX,DIR,DIRUT,DIROUT,GMTS
"RTN","GMTSULT",11,0)
 S GMTSE=$$ECHO D LD S U="^"
"RTN","GMTSULT",12,0)
 S (GMTSDEF,GMTSQ)=0,GMTSX=$G(X) S:$L(GMTSDIC0)&(GMTSDIC0'["A") GMTSQ=1 K Y
"RTN","GMTSULT",13,0)
 ;                   
"RTN","GMTSULT",14,0)
 ; Get X
"RTN","GMTSULT",15,0)
 ;   Ask the entry          DIC(0)["A" (INPUT^GMTSULT5)
"RTN","GMTSULT",16,0)
 S:GMTSDIC0'["A"&($L(GMTSX)) X=GMTSX
"RTN","GMTSULT",17,0)
 K GMTSLERR S:GMTSDIC0["A"!('$L(GMTSX)) X=$$INPUT^GMTSULT5
"RTN","GMTSULT",18,0)
 I $D(DTOUT)!($D(DUOUT)) S Y=-1 S:$D(DTOUT) DTOUT=1 S:$D(DUOUT) DUOUT=1 Q
"RTN","GMTSULT",19,0)
 ;   Is X an IEN            From Spacebar-Return
"RTN","GMTSULT",20,0)
 I $$XIEN(X) D  Q
"RTN","GMTSULT",21,0)
 . K Y S Y=+($$XIEN(X)) D Y^GMTSULT6(+Y),RD,CLR
"RTN","GMTSULT",22,0)
 ;   No Input or Error      X="" or X["^" or '$D(X)
"RTN","GMTSULT",23,0)
 I $D(DTOUT)!($D(DUOUT))!($D(DIRUT))!($D(DIROUT))!($G(X)="")!($G(X)["^") D  Q
"RTN","GMTSULT",24,0)
 . K Y W !!,?5 W:'$L($G(GMTSLERR)) "No Health Summary Type selected"
"RTN","GMTSULT",25,0)
 . W:$L($G(GMTSLERR)) GMTSLERR W ! S Y=-1 D RD,CLR
"RTN","GMTSULT",26,0)
 ;   Exact Match Required   DIC(0)["X"
"RTN","GMTSULT",27,0)
 I GMTSDIC0["X",$L(X) D  Q
"RTN","GMTSULT",28,0)
 . K Y S Y=-1,GMTSX=$$EM^GMTSULT2(X) D:+GMTSX>0 Y^GMTSULT6(+GMTSX) D RD,CLR
"RTN","GMTSULT",29,0)
 ;                   
"RTN","GMTSULT",30,0)
 ; Select
"RTN","GMTSULT",31,0)
 ;   Get Selection List
"RTN","GMTSULT",32,0)
 D LIST^GMTSULT2(X)
"RTN","GMTSULT",33,0)
 ;   Select from multiple entries
"RTN","GMTSULT",34,0)
 D:+($G(^TMP("GMTSULT",$J,0)))>1 MULTI^GMTSULT6
"RTN","GMTSULT",35,0)
 ;   Select from one entry
"RTN","GMTSULT",36,0)
 D:+($G(^TMP("GMTSULT",$J,0)))=1 ONE^GMTSULT6
"RTN","GMTSULT",37,0)
 S:'$D(Y)!(+($G(Y))'>0) Y=-1
"RTN","GMTSULT",38,0)
 ;                   
"RTN","GMTSULT",39,0)
 ; DLAYGO allowed
"RTN","GMTSULT",40,0)
 ;   Add entry
"RTN","GMTSULT",41,0)
 I $L(X),Y=-1,$G(GMTSDIC0)["L",+($G(GMTSLGO))=142 D
"RTN","GMTSULT",42,0)
 . Q:$L(X)<3!($L(X)>30)  K Y(0) N DLAYGO,GMTSOD0,GMTSOX S GMTSOD0=DIC(0),GMTSOX=X
"RTN","GMTSULT",43,0)
 . N X,DA,DIC,DIK S DIC(0)="LM",(DIK,DIC)="^GMT(142,",DLAYGO=142,X=GMTSOX
"RTN","GMTSULT",44,0)
 . L +^GMT(142):2 W:'$T !,"  Can not add Health Summary Type, the file is in ",!,"  use by another user.  Please try again later."
"RTN","GMTSULT",45,0)
 . D:$T ADD L -^GMT(142) S (GMTSDIC0,DIC(0))=GMTSOD0
"RTN","GMTSULT",46,0)
 D RD,CLR
"RTN","GMTSULT",47,0)
 Q
"RTN","GMTSULT",48,0)
ADD ;   Add Health Summary Type
"RTN","GMTSULT",49,0)
 S DA=$O(^GMT(142,"!"),-1) F  Q:'$D(^GMT(142,DA))  S DA=DA+1
"RTN","GMTSULT",50,0)
 I DA'>0!($D(^GMT(142,DA))) S Y=-1 Q
"RTN","GMTSULT",51,0)
 S $P(^GMT(142,DA,0),"^",1)=X D SI I '$D(^GMT(142,"B",$E(X,1,30),DA)) D KI K ^GMT(142,DA) S Y=-1 Q
"RTN","GMTSULT",52,0)
 S Y=DA_"^"_X_"^1"
"RTN","GMTSULT",53,0)
 Q
"RTN","GMTSULT",54,0)
SI ;   Set Indexes
"RTN","GMTSULT",55,0)
 D MS N GMTSIEN,GMTSIX,GMTSOX,GMTSCD S GMTSIEN=+($G(DA)),GMTSOX=$G(X) Q:GMTSIEN'>0  Q:'$D(^GMT(142,GMTSIEN,0))  Q:'$L(X)  N X,DA
"RTN","GMTSULT",56,0)
 S DA=GMTSIEN,GMTSIX=0 F  S GMTSIX=$O(^TMP($J,142,.01,1,GMTSIX)) Q:+GMTSIX=0  D
"RTN","GMTSULT",57,0)
 . S X=$G(^TMP($J,142,.01,1,GMTSIX,1)) D ^DIM Q:'$D(X)  S GMTSCD=X,X=GMTSOX,DA=GMTSIEN X GMTSCD
"RTN","GMTSULT",58,0)
 D MK
"RTN","GMTSULT",59,0)
 Q
"RTN","GMTSULT",60,0)
KI ;   Kill Indexes
"RTN","GMTSULT",61,0)
 D MS N GMTSIEN,GMTSIX,GMTSOX,GMTSCD S GMTSIEN=+($G(DA)),GMTSOX=$G(X) N X,DA
"RTN","GMTSULT",62,0)
 S DA=GMTSIEN,GMTSIX=0 F  S GMTSIX=$O(^TMP($J,142,.01,1,GMTSIX)) Q:+GMTSIX=0  D
"RTN","GMTSULT",63,0)
 . S X=$G(^TMP($J,142,.01,1,GMTSIX,2)) D ^DIM Q:'$D(X)
"RTN","GMTSULT",64,0)
 . S GMTSCD=X,X=GMTSOX W !,GMTSCD,?60,X,?70,DA
"RTN","GMTSULT",65,0)
 D MK
"RTN","GMTSULT",66,0)
 Q
"RTN","GMTSULT",67,0)
MS ;   Merge Set
"RTN","GMTSULT",68,0)
 M ^TMP($J,142,.01,1)=^DD(142,.01,1) Q
"RTN","GMTSULT",69,0)
MK ;   Merge Kill
"RTN","GMTSULT",70,0)
 K ^TMP($J,141,.01,1) Q
"RTN","GMTSULT",71,0)
 ;                   
"RTN","GMTSULT",72,0)
 ; Sample Lookups
"RTN","GMTSULT",73,0)
DIC ;   DIC call (all types)
"RTN","GMTSULT",74,0)
 S DIC=142,DIC("A")="Select Health Summary Type: ",DIC(0)="AEQM" D ^DIC Q
"RTN","GMTSULT",75,0)
DIC2 ;   DIC call less Ad Hoc
"RTN","GMTSULT",76,0)
 S DIC=142,DIC("A")="Select Health Summary Type: ",DIC(0)="AEQM",DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION""" D ^DIC Q
"RTN","GMTSULT",77,0)
SL1 ;   Special Lookup (all types)
"RTN","GMTSULT",78,0)
 N DIC S DIC=142,DIC("A")="Select Health Summary Type: ",DIC(0)="AEQ" S Y=$$TYPE^GMTSULT Q
"RTN","GMTSULT",79,0)
SL2 ;   Special Lookup less Ad Hoc
"RTN","GMTSULT",80,0)
 N DIC S DIC=142,DIC("A")="Select Health Summary Type: ",DIC(0)="AEQ",DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION""" S Y=$$TYPE^GMTSULT Q
"RTN","GMTSULT",81,0)
SL3 ;   Special Lookup less Ad Hoc (w DLAYGO)
"RTN","GMTSULT",82,0)
 N DIC S DIC=142,DIC("A")="Select Health Summary Type: ",DIC(0)="AEQL",DLAYGO=142,DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION""" S Y=$$TYPE^GMTSULT Q
"RTN","GMTSULT",83,0)
SL4 ;   Special Lookup less Ad Hoc (w Exact Match req, DLAYGO)
"RTN","GMTSULT",84,0)
 N DIC S DIC=142,DIC("A")="Select Health Summary Type: ",DIC(0)="OAEQL",DLAYGO=142,DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION""" S Y=$$TYPE^GMTSULT Q
"RTN","GMTSULT",85,0)
 ;                   
"RTN","GMTSULT",86,0)
TYPE(GMTSI) ; Get Health Summary Type
"RTN","GMTSULT",87,0)
 ;                   
"RTN","GMTSULT",88,0)
 ;  S Y=$$TYPE^GMTSULT
"RTN","GMTSULT",89,0)
 ;                   
"RTN","GMTSULT",90,0)
 ;  Mandatory Preset Variables
"RTN","GMTSULT",91,0)
 ;                   
"RTN","GMTSULT",92,0)
 ;    DIC(0)
"RTN","GMTSULT",93,0)
 ;                   
"RTN","GMTSULT",94,0)
 ;  Optional Preset Variables
"RTN","GMTSULT",95,0)
 ;                   
"RTN","GMTSULT",96,0)
 ;    DIC("A")
"RTN","GMTSULT",97,0)
 ;    DIC("B")
"RTN","GMTSULT",98,0)
 ;    DLAYGO
"RTN","GMTSULT",99,0)
 ;                   
"RTN","GMTSULT",100,0)
 ;  Returns the Internal Entry Number of the
"RTN","GMTSULT",101,0)
 ;  selected Health Summary Type
"RTN","GMTSULT",102,0)
 ;                   
"RTN","GMTSULT",103,0)
 K Y S:$L($G(X)) X=$G(X) D EN^GMTSULT S GMTSI=-1 S:+($G(Y))>0&($D(^GMT(142,+($G(Y)),0))) GMTSI=$G(Y) Q GMTSI
"RTN","GMTSULT",104,0)
 ;                   
"RTN","GMTSULT",105,0)
EN2 ; Lookup (Not Ad Hoc Summary)
"RTN","GMTSULT",106,0)
 D NA D EN Q
"RTN","GMTSULT",107,0)
NA ; DIC("S") (Not Ad Hoc Summary)
"RTN","GMTSULT",108,0)
 S DIC("S")="I $P(^(0),U)'=""GMTS HS ADHOC OPTION""" Q
"RTN","GMTSULT",109,0)
XIEN(X) ; Is X in a Y or `IEN format  Quit +IEN
"RTN","GMTSULT",110,0)
 N GMTSX,GMTSL,GMTSI,GMTSNAM,GMTSY
"RTN","GMTSULT",111,0)
 S GMTSX=$G(X),GMTSL=$E(GMTSX,1),GMTSI=$E(GMTSX,2,$L(GMTSX))
"RTN","GMTSULT",112,0)
 I GMTSL="`",+GMTSI>0,$D(^GMT(142,+GMTSI,0)),$L($P($G(^GMT(142,+GMTSI,0)),"^",1)) S X=GMTSI Q X
"RTN","GMTSULT",113,0)
 I +GMTSX=GMTSX,$D(^GMT(142,+GMTSX,0)),$L($P($G(^GMT(142,+GMTSX,0)),"^",1)) S X=GMTSX Q X
"RTN","GMTSULT",114,0)
 S GMTSI=$S($D(^GMT(142,+GMTSX,0)):+X,1:-1)
"RTN","GMTSULT",115,0)
 S GMTSNAM=$P($G(^GMT(142,+GMTSX,0)),"^",1)
"RTN","GMTSULT",116,0)
 I GMTSI=+GMTSX&(GMTSNAM=$P(GMTSX,"^",2)) S X=GMTSI Q X
"RTN","GMTSULT",117,0)
 Q 0
"RTN","GMTSULT",118,0)
LD ; Load DIC Variables
"RTN","GMTSULT",119,0)
 D DICHK S (DIC,GMTSDIC)="^GMT(142,",GMTSDIC0="AEM"
"RTN","GMTSULT",120,0)
 S:$L($G(DLAYGO)) GMTSLGO=$G(DLAYGO)
"RTN","GMTSULT",121,0)
 S GMTSDICA="Select HEALTH SUMMARY TYPE:  " K Y
"RTN","GMTSULT",122,0)
 S:$L($G(DIC("W"))) GMTSDICW=DIC("W")
"RTN","GMTSULT",123,0)
 S:$L($G(DIC("S"))) GMTSDICS=DIC("S")
"RTN","GMTSULT",124,0)
 S:$L($G(DIC("A"))) GMTSDICA=DIC("A")
"RTN","GMTSULT",125,0)
 S:$L($G(DIC("B"))) GMTSDICB=DIC("B")
"RTN","GMTSULT",126,0)
 S:$L($G(DIC(0))) GMTSDIC0=DIC(0)
"RTN","GMTSULT",127,0)
 Q
"RTN","GMTSULT",128,0)
DICHK ; Check DIC variables
"RTN","GMTSULT",129,0)
 N GMTSDISV,GMTSUSR,GMTSB
"RTN","GMTSULT",130,0)
 K DIC("DR"),DIC("P"),DIC("V"),DINUM,DTOUT,DUOUT
"RTN","GMTSULT",131,0)
 S GMTSUSR=+($G(DUZ)),GMTSDISV=+($G(^DISV(GMTSUSR,"^GMT(142,")))
"RTN","GMTSULT",132,0)
 S GMTSB=$P($G(^GMT(142,+GMTSDISV,0)),"^",1)
"RTN","GMTSULT",133,0)
 S:'$L($G(DIC(0))) DIC(0)="AEMZB" S:'$L($G(DIC)) DIC="^GMT(142,"
"RTN","GMTSULT",134,0)
 I +($G(GMTSE))=0 F  Q:DIC(0)'["E"  S DIC(0)=$P(DIC(0),"E",1)_$P(DIC(0),"E",2)
"RTN","GMTSULT",135,0)
 S:'$L($G(DIC("A"))) DIC("A")="Select HEALTH SUMMARY TYPE:  "
"RTN","GMTSULT",136,0)
 Q
"RTN","GMTSULT",137,0)
RD ; Restore DIC Variables
"RTN","GMTSULT",138,0)
 S:$L($G(GMTSDIC)) DIC=GMTSDIC
"RTN","GMTSULT",139,0)
 S:$L($G(GMTSDICS)) DIC("S")=GMTSDICS
"RTN","GMTSULT",140,0)
 S:$L($G(GMTSDICW)) DIC("W")=GMTSDICW
"RTN","GMTSULT",141,0)
 S:$L($G(GMTSDICA)) DIC("A")=GMTSDICA S:$L($G(GMTSDICB)) DIC("B")=GMTSDICB S:$L($G(GMTSDIC0)) DIC(0)=GMTSDIC0
"RTN","GMTSULT",142,0)
 I $L($G(X)),X["`" D
"RTN","GMTSULT",143,0)
 . N GMTSI,GMTSL S GMTSL=$E(X,1),GMTSI=$E(X,2,$L(X))
"RTN","GMTSULT",144,0)
 . I GMTSL="`",+GMTSI>0,$D(^GMT(142,+GMTSI,0)),$L($P($G(^GMT(142,+GMTSI,0)),"^",1)) S X=$P($G(^GMT(142,+GMTSI,0)),"^",1)
"RTN","GMTSULT",145,0)
 K GMTSDICS,GMTSDIC,GMTSDIC0,GMTSDICB,GMTSDISV,GMTSDICA Q
"RTN","GMTSULT",146,0)
ECHO(X) ; Echo Results (writes/reads)
"RTN","GMTSULT",147,0)
 S X=$$ROK("XWBLIB") Q:'X 1 S X=$$BROKER^XWBLIB Q:X 0 Q 1
"RTN","GMTSULT",148,0)
ROK(X) ; Routine OK (in UCI)
"RTN","GMTSULT",149,0)
 S X=$G(X) Q:'$L(X) 0 Q:$L(X)>8 0 X ^%ZOSF("TEST") Q:$T 1 Q 0
"RTN","GMTSULT",150,0)
CLR ;   Kill all global arrays used (this session)
"RTN","GMTSULT",151,0)
 K ^TMP("GMTSULT",$J),^TMP("GMTSULT2",$J) Q
"RTN","GMTSULT",152,0)
CLEAN ;   Kill temporary global array used
"RTN","GMTSULT",153,0)
 K ^TMP("GMTSULT2",$J) Q
"RTN","GMTSULT",154,0)
 ; Miscellaneous
"RTN","GMTSULT2")
0^3^B35828982
"RTN","GMTSULT2",1,0)
GMTSULT2 ; SLC/KER - HS Type Lookup (Search/List)   ; 04/19/1999
"RTN","GMTSULT2",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSULT2",3,0)
 ;
"RTN","GMTSULT2",4,0)
 Q
"RTN","GMTSULT2",5,0)
LIST(X) ; Get global array of Health Summary Types
"RTN","GMTSULT2",6,0)
 ;                      
"RTN","GMTSULT2",7,0)
 ;  LIST^GMTSULT2(<search string>)
"RTN","GMTSULT2",8,0)
 ;                      
"RTN","GMTSULT2",9,0)
 ;  ^TMP("GMTSULT",$J,#)
"RTN","GMTSULT2",10,0)
 ;                    
"RTN","GMTSULT2",11,0)
 ;     Piece 1 =  Internal Entry Number (IEN) in file 142
"RTN","GMTSULT2",12,0)
 ;     Piece 2 =  Health Summary Type Name
"RTN","GMTSULT2",13,0)
 ;     Piece 3 =  Health Summary Type Title
"RTN","GMTSULT2",14,0)
 ;     Piece 4 =  Health Summary Type Owner
"RTN","GMTSULT2",15,0)
 ;     Piece 5 =  Location Using Health Summary Type
"RTN","GMTSULT2",16,0)
 ;     Piece 6 =  Number of Components in Summary Type
"RTN","GMTSULT2",17,0)
 ;     Piece 7 =  Recommended Display Text (for 
"RTN","GMTSULT2",18,0)
 ;                selection or list box)
"RTN","GMTSULT2",19,0)
 ;                      
"RTN","GMTSULT2",20,0)
 ;  List Builder can use variable DIC("S") and DIC(0)
"RTN","GMTSULT2",21,0)
 ;                      
"RTN","GMTSULT2",22,0)
 ;     DIC("S") Screen out entries for selection/list
"RTN","GMTSULT2",23,0)
 ;                      
"RTN","GMTSULT2",24,0)
 ;     Processes DIC(0) N, OE (combination),X or B
"RTN","GMTSULT2",25,0)
 ;                      
"RTN","GMTSULT2",26,0)
 ;     Does not process DIC(0) components C or M.  Cross
"RTN","GMTSULT2",27,0)
 ;     reference suppression (C) is automatic in a multi-
"RTN","GMTSULT2",28,0)
 ;     term lookup, and the use of multiple indexes is
"RTN","GMTSULT2",29,0)
 ;     implied in the lookup and DD file structure.
"RTN","GMTSULT2",30,0)
 ;                      
"RTN","GMTSULT2",31,0)
 D CLR^GMTSULT N GMTSEO,GMTSEQ,GMTSIF,GMTSBI,GMTSIEN,GMTSWRDS,GMTSDS,GMTSD0
"RTN","GMTSULT2",32,0)
 S GMTSEO=+($$EMO),GMTSEQ=+($$EMQ),GMTSIF=+($$IF($G(X))),GMTSBI=+($$BI)
"RTN","GMTSULT2",33,0)
 S:$L($G(DIC("S")))&('$L($G(GMTSDICS))) GMTSDICS=$G(DIC("S")),GMTSDS=1
"RTN","GMTSULT2",34,0)
 S:$L($G(DIC(0)))&('$L($G(GMTSDIC0))) GMTSDIC0=$G(DIC(0)),GMTSD0=1
"RTN","GMTSULT2",35,0)
 I GMTSIF S GMTSIEN=$$IENF(X) I +GMTSIEN>0 D IENS(GMTSIEN) G:$D(^TMP("GMTSULT",$J,1)) LQ
"RTN","GMTSULT2",36,0)
 I GMTSBI D B^GMTSULT7 G LQ
"RTN","GMTSULT2",37,0)
 D PAR,FND,REO^GMTSULT3 Q
"RTN","GMTSULT2",38,0)
LQ ; Quit List
"RTN","GMTSULT2",39,0)
 K:+($G(GMTSDS))>0 GMTSDICS K:+($G(GMTSD0))>0 GMTSDIC0
"RTN","GMTSULT2",40,0)
 Q
"RTN","GMTSULT2",41,0)
 ;                      
"RTN","GMTSULT2",42,0)
FND ; Find Health Summary Types (word search)
"RTN","GMTSULT2",43,0)
 N GMTSB,GMTSC,GMTSCTL,GMTSFND,GMTSI,GMTSI1,GMTSI2,GMTSI3,GMTSDS,GMTSD0,GMTSLEX,GMTSLEXM,GMTSASM,GMTSCMP,GMTSLOC,GMTSNAM,GMTSOK,GMTSRC,GMTSOW,GMTSTMP,GMTSTTL,GMTSWDS,GMTSRD,GMTSWRD,Y
"RTN","GMTSULT2",44,0)
 ;   Echo             E or broker
"RTN","GMTSULT2",45,0)
 S GMTSTMP=+($G(GMTSE)),GMTSIF=0 S:'$D(GMTSE) GMTSTMP=$$ECHO^GMTSULT N GMTSE S GMTSE=GMTSTMP,U="^"
"RTN","GMTSULT2",46,0)
 ;   Exact Match      X
"RTN","GMTSULT2",47,0)
 S GMTSLEX=$$EM(X) D:$G(GMTSDIC0)["X"&(GMTSLEX'>0) CLR^GMTSULT G:$G(GMTSDIC0)["X"&(GMTSLEX'>0) FNDQ
"RTN","GMTSULT2",48,0)
 S:+GMTSLEX>0 ^TMP("GMTSULT2",$J,"EM")=+GMTSLEX,^TMP("GMTSULT2",$J,"IEN",+GMTSLEX)=""
"RTN","GMTSULT2",49,0)
 ;   One Exact Match  OE
"RTN","GMTSULT2",50,0)
 S GMTSLEXM=0 S:$G(GMTSDIC0)["O"&($G(GMTSDIC0)["E") GMTSLEXM=1
"RTN","GMTSULT2",51,0)
 ;   Word Search
"RTN","GMTSULT2",52,0)
 S GMTSWDS=$O(GMTSWRDS(" "),-1) S GMTSWRD=$G(GMTSWRDS(1)) G:'$L(GMTSWRD) FNDQ S GMTSCTL=GMTSWRD,GMTSWRD=$E(GMTSWRD,1,($L(GMTSWRD)-1))_$C($A($E(GMTSWRD,$L(GMTSWRD)))-1)_"~"
"RTN","GMTSULT2",53,0)
 F  S GMTSWRD=$O(^GMT(142,"AW",GMTSWRD)) Q:GMTSWRD=""!($E(GMTSWRD,1,$L(GMTSCTL))'=GMTSCTL)  D
"RTN","GMTSULT2",54,0)
 . S (GMTSC,GMTSI1)=0 F  S GMTSI1=$O(^GMT(142,"AW",GMTSWRD,GMTSI1)) Q:+GMTSI1=0  D
"RTN","GMTSULT2",55,0)
 . . N GMTSIEN,GMTSKWRD S GMTSIEN=GMTSI1,GMTSKWRD=GMTSWRD D SM^GMTSULT3
"RTN","GMTSULT2",56,0)
 ;   Check for exact match in results
"RTN","GMTSULT2",57,0)
 S GMTSI=+($G(^TMP("GMTSULT2",$J,"EMI"))),GMTSB=$G(^TMP("GMTSULT2",$J,"EMB")) I GMTSI>0,$L(GMTSB)>0 D
"RTN","GMTSULT2",58,0)
 . S ^TMP("GMTSULT2",$J,"E")=$G(^TMP("GMTSULT2",$J,GMTSI)) K ^TMP("GMTSULT2",$J,GMTSI),^TMP("GMTSULT2",$J,"B",GMTSB),^TMP("GMTSULT2",$J,"EMB"),^TMP("GMTSULT2",$J,"EMI"),^TMP("GMTSULT2",$J,"EM")
"RTN","GMTSULT2",59,0)
FNDQ ; Find Quit
"RTN","GMTSULT2",60,0)
 K:+($G(GMTSDS))>0 GMTSDICS K:+($G(GMTSD0))>0 GMTSDIC0
"RTN","GMTSULT2",61,0)
 Q
"RTN","GMTSULT2",62,0)
 ;                      
"RTN","GMTSULT2",63,0)
PAR ; Parse User Input
"RTN","GMTSULT2",64,0)
 K GMTSWRDS N GMTSC,GMTSCT,GMTSPSN,GMTSTR,GMTSWRD
"RTN","GMTSULT2",65,0)
 S U="^",GMTSTR=$G(X) Q:'$L(GMTSTR)  S GMTSC=1,GMTSCT=0 F GMTSPSN=1:1:$L(GMTSTR)+1 D
"RTN","GMTSULT2",66,0)
 . S GMTSWRD=$E(GMTSTR,GMTSPSN) I "(,.?! '-/&:;)"[GMTSWRD S GMTSWRD=$E($E(GMTSTR,GMTSC,GMTSPSN-1),1,30),GMTSC=GMTSPSN+1 I $L(GMTSWRD)>0 S GMTSCT=GMTSCT+1,GMTSWRDS(GMTSCT)=$$UP(GMTSWRD)
"RTN","GMTSULT2",67,0)
 Q
"RTN","GMTSULT2",68,0)
IENF(X) ; Internal Entry Number Find
"RTN","GMTSULT2",69,0)
 N GMTS0,GMTSI S GMTSI=$G(X),X=$G(X),GMTS0=$G(DIC(0)) S:$E(X,1)="`" GMTSI=$E(GMTSI,2,$L(GMTSI)) S GMTSI=+GMTSI
"RTN","GMTSULT2",70,0)
 I GMTS0["N",+GMTSI>0,$D(^GMT(142,+GMTSI,0)) S X=+GMTSI Q X
"RTN","GMTSULT2",71,0)
 I $E(X,1)="`",+GMTSI>0,$D(^GMT(142,+GMTSI,0)) S X=+GMTSI Q X
"RTN","GMTSULT2",72,0)
 Q -1
"RTN","GMTSULT2",73,0)
IENS(X) ; Internal Entry Number Save
"RTN","GMTSULT2",74,0)
 N GMTSI1,GMTSI2,GMTSI3,GMTSIEN S (GMTSIEN,GMTSI1)=+X Q:+GMTSI1=0  Q:'$D(^GMT(142,+GMTSI1,0))
"RTN","GMTSULT2",75,0)
 D SM^GMTSULT3,REO^GMTSULT3
"RTN","GMTSULT2",76,0)
 Q
"RTN","GMTSULT2",77,0)
CM(X) ; Get Number of Components
"RTN","GMTSULT2",78,0)
 S X=+($G(X)) Q:X=0 "No components" Q:'$D(^GMT(142,+X,1)) "No components"
"RTN","GMTSULT2",79,0)
 N GMTSI,GMTSC S (GMTSC,GMTSI)=0 F  S GMTSI=$O(^GMT(142,+X,1,GMTSI)) Q:+GMTSI=0  S GMTSC=GMTSC+1
"RTN","GMTSULT2",80,0)
 S X=$S(+GMTSC>1:(+GMTSC_" components"),+GMTSC=1:(+GMTSC_" component"),1:"No components")
"RTN","GMTSULT2",81,0)
 Q X
"RTN","GMTSULT2",82,0)
EM(X) ; Exact Match when DIC(0) contains X
"RTN","GMTSULT2",83,0)
 S X=$G(X) Q:'$L(X) -1 N GMTSC,GMTSI,GMTSM,GMTSN,GMTSO,GMTSU S U="^"
"RTN","GMTSULT2",84,0)
 S GMTSU=$$UP(X),(GMTSC,GMTSO)=$$UP($E(X,1,30)),GMTSM=0,GMTSO=$E(GMTSO,1,($L(GMTSO)-1))_$C($A($E(GMTSO,$L(GMTSO)))-1)_"~",GMTSM=0
"RTN","GMTSULT2",85,0)
 F  S GMTSO=$O(^GMT(142,"AB",GMTSO)) Q:GMTSO=""!(GMTSO'[GMTSC)  D  Q:+GMTSM>0
"RTN","GMTSULT2",86,0)
 . S GMTSI=0 F  S GMTSI=$O(^GMT(142,"AB",GMTSO,GMTSI)) Q:+GMTSI=0  D  Q:+GMTSM>0
"RTN","GMTSULT2",87,0)
 . . S GMTSN=$P($G(^GMT(142,+GMTSI,0)),U,1) S:$$UP(GMTSN)=GMTSU GMTSM=GMTSI_U_GMTSN
"RTN","GMTSULT2",88,0)
 S:+GMTSM=0 GMTSM=-1 S X=GMTSM D Y^GMTSULT6(+GMTSM)
"RTN","GMTSULT2",89,0)
 Q X
"RTN","GMTSULT2",90,0)
 ;                      
"RTN","GMTSULT2",91,0)
DICS(S,X,DA) ; Check DIC("S") Screen
"RTN","GMTSULT2",92,0)
 ;   LAYGO allowed (no screen)
"RTN","GMTSULT2",93,0)
 I +($G(GMTSLGO))=142,$G(GMTSDIC0)["L" Q 1
"RTN","GMTSULT2",94,0)
 ;   LAYGO not allowed (screen)
"RTN","GMTSULT2",95,0)
 N Y,GMTST,GMTSOX,GMTSDICS S GMTSDICS=$G(S),GMTSOX=$G(X) S X=GMTSDICS Q:'$L(GMTSDICS) 1
"RTN","GMTSULT2",96,0)
 D ^DIM Q:'$L($G(X)) 1
"RTN","GMTSULT2",97,0)
 S (Y,DA)=+($G(DA)),GMTST=$G(^GMT(142,+Y,0)),X=GMTSOX X GMTSDICS S X=$T Q X
"RTN","GMTSULT2",98,0)
 ;                      
"RTN","GMTSULT2",99,0)
 ; Processing flags
"RTN","GMTSULT2",100,0)
EMQ(X) ;   Exact match flag
"RTN","GMTSULT2",101,0)
 N GMTS0 S X=0,GMTS0=$G(DIC(0)) Q:'$L(GMTS0) X
"RTN","GMTSULT2",102,0)
 S:$G(GMTS0)["X" X=1 Q X
"RTN","GMTSULT2",103,0)
EMO(X) ;   Exact match flag, only one
"RTN","GMTSULT2",104,0)
 N GMTS0 S X=0 S GMTS0=$G(DIC(0)) Q:'$L(GMTS0) X
"RTN","GMTSULT2",105,0)
 S:$G(GMTS0)["O"&($G(GMTS0)["E") X=1 Q X
"RTN","GMTSULT2",106,0)
BI(X) ;   Use the B Index flag
"RTN","GMTSULT2",107,0)
 N GMTS0 S X=0 S GMTS0=$G(DIC(0)) Q:'$L(GMTS0) X
"RTN","GMTSULT2",108,0)
 S:$G(GMTS0)["B" X=1 Q X
"RTN","GMTSULT2",109,0)
IF(X) ;   Internal Entry Number Flag
"RTN","GMTSULT2",110,0)
 N GMTS0,GMTSI S GMTSI=0,GMTS0=$G(DIC(0)) Q:'$L($G(X)) 0
"RTN","GMTSULT2",111,0)
 I $E(X,1)="`",$L($G(^GMT(142,+($E(X,2,$L(X))),0))) S GMTSI=1
"RTN","GMTSULT2",112,0)
 I +X>0,$L($G(^GMT(142,+X,0))),GMTS0["N" S GMTSI=1
"RTN","GMTSULT2",113,0)
 S X=GMTSI Q X
"RTN","GMTSULT2",114,0)
 ;                      
"RTN","GMTSULT2",115,0)
 ; TMP Global
"RTN","GMTSULT2",116,0)
TMP ;   Show first ^TMP Global
"RTN","GMTSULT2",117,0)
 N GMTSND,GMTSNC,GMTSNQ,GMTSC,GMTSTMP
"RTN","GMTSULT2",118,0)
 S GMTSC=0,GMTSTMP="",GMTSNQ="^TMP(""GMTSULT2"","_$J_")",GMTSNC="^TMP(""GMTSULT2"","_$J_","
"RTN","GMTSULT2",119,0)
 F  S GMTSNQ=$Q(@GMTSNQ) Q:GMTSNQ=""!(GMTSNQ'[GMTSNC)  D
"RTN","GMTSULT2",120,0)
 . S GMTSC=GMTSC+1 W:GMTSC=1 ! S GMTSND=@GMTSNQ W !,GMTSNQ,"=",GMTSND
"RTN","GMTSULT2",121,0)
 W:GMTSC>0 !
"RTN","GMTSULT2",122,0)
TMP2 ;   Show second ^TMP Global
"RTN","GMTSULT2",123,0)
 S GMTSC=0,GMTSNQ="^TMP(""GMTSULT"","_$J_")",GMTSNC="^TMP(""GMTSULT"","_$J_","
"RTN","GMTSULT2",124,0)
 F  S GMTSNQ=$Q(@GMTSNQ) Q:GMTSNQ=""!(GMTSNQ'[GMTSNC)  D
"RTN","GMTSULT2",125,0)
 . S GMTSC=GMTSC+1 W:'$D(GMTSTMP)&(GMTSC=1) ! S GMTSND=@GMTSNQ W !,GMTSNQ,"=",GMTSND
"RTN","GMTSULT2",126,0)
 W:GMTSC>0 !
"RTN","GMTSULT2",127,0)
 Q
"RTN","GMTSULT2",128,0)
 ; Miscellaneous
"RTN","GMTSULT2",129,0)
UP(X) ;   Uppercase
"RTN","GMTSULT2",130,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSULT2",131,0)
OW(X) ;   Mix Case (owner name)
"RTN","GMTSULT2",132,0)
 Q:$G(X)'["," $$EN^GMTSUMX($G(X))
"RTN","GMTSULT2",133,0)
 Q $$EN^GMTSUMX(($P($G(X),",",1)_", "_$P($G(X),",",2)))
"RTN","GMTSULT2",134,0)
MX(X) ;   Mix Case
"RTN","GMTSULT2",135,0)
 Q $$EN^GMTSUMX(X)
"RTN","GMTSULT3")
0^7^B21834691
"RTN","GMTSULT3",1,0)
GMTSULT3 ; SLC/KER - HS Type Lookup (Save)          ; 04/19/1999
"RTN","GMTSULT3",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSULT3",3,0)
 ;
"RTN","GMTSULT3",4,0)
 Q
"RTN","GMTSULT3",5,0)
SM ; Save match
"RTN","GMTSULT3",6,0)
 ;                      
"RTN","GMTSULT3",7,0)
 ;   GMTSIEN    Type Internal Entry Number
"RTN","GMTSULT3",8,0)
 ;   GMTSKWRD   Keyword from AW index
"RTN","GMTSULT3",9,0)
 ;   GMTSWRDS   Parsed word array
"RTN","GMTSULT3",10,0)
 ;   GMTSEO     Exact Match (One)      OE
"RTN","GMTSULT3",11,0)
 ;   GMTSEQ     Exact Match Required   X
"RTN","GMTSULT3",12,0)
 ;   GMTSIF     Interal Entry Number   N
"RTN","GMTSULT3",13,0)
 ;                      
"RTN","GMTSULT3",14,0)
 S GMTSIEN=+($G(GMTSIEN)),GMTSKWRD=$G(GMTSKWRD),GMTSEO=+($G(GMTSEO)),GMTSEQ=+($G(GMTSEQ)),GMTSIF=+($G(GMTSIF)),U="^"
"RTN","GMTSULT3",15,0)
 N GMTSCOMP,GMTSWRD,GMTSWDS,GMTSEQ,GMTSLOK,GMTSOK,GMTSLT,GMTSLI,GMTSASM,GMTSI1,GMTSI2,GMTSI3,GMTSNAM,GMTSTTL,GMTSOW,GMTSLOC,GMTSCMP,GMTSRC
"RTN","GMTSULT3",16,0)
 S (GMTSNAM,GMTSTTL,GMTSOW,GMTSLOC,GMTSCMP,GMTSRC)="",GMTSLOK=0,GMTSRC="Name",GMTSWRD=$G(GMTSWRDS(1)),GMTSWDS=+($O(GMTSWRDS(" "),-1))
"RTN","GMTSULT3",17,0)
 ; Get Internal Entry Number (IEN)
"RTN","GMTSULT3",18,0)
 S GMTSI1=+($G(GMTSIEN)) Q:'$D(^GMT(142,GMTSI1,0))
"RTN","GMTSULT3",19,0)
 ; Check Screen - DIC("S")
"RTN","GMTSULT3",20,0)
 S GMTSOK=1 I $L($G(GMTSDICS)) S GMTSOK=$$DICS^GMTSULT2(GMTSDICS,X,GMTSI1) Q:'GMTSOK
"RTN","GMTSULT3",21,0)
 ; Get Health Summary Type
"RTN","GMTSULT3",22,0)
 ;   Components
"RTN","GMTSULT3",23,0)
 S GMTSCMP=$$CM^GMTSULT2(+GMTSI1)
"RTN","GMTSULT3",24,0)
 ;   Name
"RTN","GMTSULT3",25,0)
 S GMTSNAM=$P($G(^GMT(142,+GMTSI1,0)),U,1)
"RTN","GMTSULT3",26,0)
 ;   Title
"RTN","GMTSULT3",27,0)
 S GMTSTTL=$P($G(^GMT(142,+GMTSI1,"T")),U,1)
"RTN","GMTSULT3",28,0)
 S:$L(GMTSTTL) GMTSRC="Title"
"RTN","GMTSULT3",29,0)
 ;   Owner
"RTN","GMTSULT3",30,0)
 S GMTSOW=+($P($G(^GMT(142,+GMTSI1,0)),U,3)) S:GMTSOW<1 GMTSOW="" S:+GMTSOW>0 GMTSOW=$P($G(^VA(200,+GMTSOW,0)),U,1)
"RTN","GMTSULT3",31,0)
 I $L($G(GMTSKWRD)) S:$L(GMTSOW)&(GMTSOW[GMTSKWRD) GMTSRC="Title/Owner"
"RTN","GMTSULT3",32,0)
 ;   Name/Title
"RTN","GMTSULT3",33,0)
 D NT^GMTSULT4
"RTN","GMTSULT3",34,0)
 ;   Location
"RTN","GMTSULT3",35,0)
 D LC^GMTSULT4
"RTN","GMTSULT3",36,0)
 S:'$L($G(GMTSLT("C")))&($L($G(GMTSLI("C")))) GMTSLOC=$G(GMTSLI("C"))
"RTN","GMTSULT3",37,0)
 ; Get Composite String
"RTN","GMTSULT3",38,0)
 D CMA^GMTSULT4
"RTN","GMTSULT3",39,0)
 ; Find words in string
"RTN","GMTSULT3",40,0)
 S GMTSFND=0 I GMTSWDS>0 F GMTSI=1:1:GMTSWDS D
"RTN","GMTSULT3",41,0)
 . Q:'$L(GMTSWRDS(GMTSI))
"RTN","GMTSULT3",42,0)
 . S:GMTSCOMP[$$UP^GMTSULT2(GMTSWRDS(GMTSI)) GMTSFND=GMTSFND+1
"RTN","GMTSULT3",43,0)
 . S:$L(GMTSOW)&(GMTSOW[$$UP^GMTSULT2(GMTSWRDS(GMTSI))) GMTSRC="Title/Owner"
"RTN","GMTSULT3",44,0)
 ;
"RTN","GMTSULT3",45,0)
 ; If input is not an Internal Entry Number    +GMTSIF=0
"RTN","GMTSULT3",46,0)
 ; and not all of the words were found          GMTSFND'=GMTSWDS
"RTN","GMTSULT3",47,0)
 ; then quit
"RTN","GMTSULT3",48,0)
 ;
"RTN","GMTSULT3",49,0)
 Q:'(+($G(GMTSIF)))&(GMTSFND'=GMTSWDS)
"RTN","GMTSULT3",50,0)
 ;                      
"RTN","GMTSULT3",51,0)
 ; Save Health Summary Type
"RTN","GMTSULT3",52,0)
 ;   Exact match only        DIC(0)["O" & DIC(0)["E"
"RTN","GMTSULT3",53,0)
 I '(+($G(GMTSIF))),+($G(GMTSEO)),($$UP^GMTSULT2(GMTSNAM)'=$$UP^GMTSULT2(X)&($$UP^GMTSULT2(GMTSLOC)'=$$UP^GMTSULT2(X))) Q
"RTN","GMTSULT3",54,0)
 S:$L(GMTSLOC) GMTSRC="Location"
"RTN","GMTSULT3",55,0)
 ;   Quit if Health Summary is already saved
"RTN","GMTSULT3",56,0)
 Q:$D(^TMP("GMTSULT2",$J,"IEN",+GMTSI1))&(+($G(^TMP("GMTSULT2",$J,"EM")))'=+GMTSI1)
"RTN","GMTSULT3",57,0)
 ;                      
"RTN","GMTSULT3",58,0)
 ;   Assemble string and store in TMP Global
"RTN","GMTSULT3",59,0)
 ;      IEN^Name^Title^Owner^Location^Components^Source
"RTN","GMTSULT3",60,0)
 S GMTSC=+($O(^TMP("GMTSULT2",$J," "),-1))+1
"RTN","GMTSULT3",61,0)
 S GMTSASM=GMTSI1_U_GMTSNAM_U_GMTSTTL_U_GMTSOW_U_GMTSLOC_U_GMTSCMP_U_GMTSRC
"RTN","GMTSULT3",62,0)
 S ^TMP("GMTSULT2",$J,"IEN",+GMTSI1)="",^TMP("GMTSULT2",$J,GMTSC)=GMTSASM,^TMP("GMTSULT2",$J,"B",(GMTSNAM_" "),GMTSC)=""
"RTN","GMTSULT3",63,0)
 S:+($G(^TMP("GMTSULT2",$J,"EM")))=GMTSI1 ^TMP("GMTSULT2",$J,"EMI")=GMTSC,^TMP("GMTSULT2",$J,"EMB")=GMTSNAM_" "
"RTN","GMTSULT3",64,0)
 Q
"RTN","GMTSULT3",65,0)
 ;                      
"RTN","GMTSULT3",66,0)
REO ; Reorder List
"RTN","GMTSULT3",67,0)
 S GMTSEO=+($G(GMTSEO)),GMTSEQ=+($G(GMTSEQ)),GMTSIF=+($G(GMTSIF))
"RTN","GMTSULT3",68,0)
 N GMTSC,GMTSFND,GMTSG,GMTSI,GMTSIEN,GMTSKEY,GMTSL,GMTSCMP,GMTSOW,GMTSTTL,GMTSLOC,GMTSMN,GMTSNM
"RTN","GMTSULT3",69,0)
 S GMTSI=0,GMTSFND=""
"RTN","GMTSULT3",70,0)
 ;   Add exact match to the top of the selection list
"RTN","GMTSULT3",71,0)
 I '$D(^TMP("GMTSULT2",$J,"E")),+($G(GMTSEO)) K ^TMP("GMTSULT2",$J)
"RTN","GMTSULT3",72,0)
 I $D(^TMP("GMTSULT2",$J,"E")) D
"RTN","GMTSULT3",73,0)
 . S GMTSI=0,GMTSC="E" D ADD
"RTN","GMTSULT3",74,0)
 . S ^TMP("GMTSULT",$J,0)=GMTSI
"RTN","GMTSULT3",75,0)
 . K ^TMP("GMTSULT2",$J,"E")
"RTN","GMTSULT3",76,0)
 . ;   Kill global (quit) if Exact Match is found
"RTN","GMTSULT3",77,0)
 . ;     and DIR(0) either contains OE or X
"RTN","GMTSULT3",78,0)
 . K:+($G(GMTSEQ)) ^TMP("GMTSULT2",$J) K:+($G(GMTSEO)) ^TMP("GMTSULT2",$J)
"RTN","GMTSULT3",79,0)
 ;   Kill global (quit) if Exact Match is not
"RTN","GMTSULT3",80,0)
 ;     found and DIR(0)["OE"
"RTN","GMTSULT3",81,0)
 I '$D(^TMP("GMTSULT2",$J,"E")),+($G(GMTSEO)) K ^TMP("GMTSULT2",$J)
"RTN","GMTSULT3",82,0)
 ;   Add remaining entries in Alphabetical Order
"RTN","GMTSULT3",83,0)
 F  S GMTSFND=$O(^TMP("GMTSULT2",$J,"B",GMTSFND)) Q:GMTSFND=""  D
"RTN","GMTSULT3",84,0)
 . S GMTSC=0 F  S GMTSC=$O(^TMP("GMTSULT2",$J,"B",GMTSFND,GMTSC)) Q:+GMTSC=0  D
"RTN","GMTSULT3",85,0)
 . . D ADD
"RTN","GMTSULT3",86,0)
 D CLEAN^GMTSULT
"RTN","GMTSULT3",87,0)
 Q
"RTN","GMTSULT3",88,0)
 ;                      
"RTN","GMTSULT3",89,0)
ADD ; Add to list in appropriate order
"RTN","GMTSULT3",90,0)
 N GMTS0,GMTS1,GMTS2,GMTS3,GMTS4,GMTS5,GMTS6,GMTS7
"RTN","GMTSULT3",91,0)
 S GMTSI=+($G(GMTSI))+1,GMTS0=$G(^TMP("GMTSULT2",$J,GMTSC))
"RTN","GMTSULT3",92,0)
 ;                      
"RTN","GMTSULT3",93,0)
 ;   Piece    Data Element
"RTN","GMTSULT3",94,0)
 ;                      
"RTN","GMTSULT3",95,0)
 ;     1      Internal Entry Number
"RTN","GMTSULT3",96,0)
 S (GMTS1,GMTSIEN)=+($P(GMTS0,U,1))
"RTN","GMTSULT3",97,0)
 ;     2      Health Summary Name
"RTN","GMTSULT3",98,0)
 S (GMTSG,GMTSMN,GMTS2)=$$MX^GMTSULT2($P(GMTS0,U,2))
"RTN","GMTSULT3",99,0)
 S GMTSNM=$$UP^GMTSULT2(GMTSMN)
"RTN","GMTSULT3",100,0)
 ;     3      Health Summary Title
"RTN","GMTSULT3",101,0)
 S (GMTS3,GMTSTTL)=$$MX^GMTSULT2($P(GMTS0,U,3)),GMTSTTL=GMTSTTL_")"
"RTN","GMTSULT3",102,0)
 ;     4      Health Summary Owner
"RTN","GMTSULT3",103,0)
 S (GMTS4,GMTSOW)=$$MX^GMTSULT2($P(GMTS0,U,4)),GMTSOW=GMTSOW_")"
"RTN","GMTSULT3",104,0)
 ;     5      Health Summary Location
"RTN","GMTSULT3",105,0)
 S (GMTS5,GMTSLOC)=$$MX^GMTSULT2($P(GMTS0,U,5)),GMTSLOC=GMTSLOC_")"
"RTN","GMTSULT3",106,0)
 ;     6      Health Summary Components
"RTN","GMTSULT3",107,0)
 S (GMTS6,GMTSCMP)=$P(GMTS0,U,6)
"RTN","GMTSULT3",108,0)
 S GMTSL=$P(GMTS0,U,4)
"RTN","GMTSULT3",109,0)
 ;     7      Recommended Display Text
"RTN","GMTSULT3",110,0)
 S GMTSKEY=$$UP^GMTSULT2($P(GMTS0,U,7))
"RTN","GMTSULT3",111,0)
 ;   Recommended Display Text
"RTN","GMTSULT3",112,0)
 D RDT^GMTSULT4
"RTN","GMTSULT3",113,0)
 ;   Assemble string and store in TMP Global
"RTN","GMTSULT3",114,0)
 ;      IEN^Name^Title^Owner^Location^Components^Display Text
"RTN","GMTSULT3",115,0)
 S:$L(GMTSG)&(GMTSG'[")")&(GMTSG'["(")&(+GMTS6=0)&($L(GMTS6)) GMTSG=GMTSG_" ("_GMTS6_")" S GMTS7=GMTSG
"RTN","GMTSULT3",116,0)
 S ^TMP("GMTSULT",$J,GMTSI)=GMTS1_U_GMTS2_U_GMTS3_U_GMTS4_U_GMTS5_U_GMTS6_U_GMTS7
"RTN","GMTSULT3",117,0)
 S ^TMP("GMTSULT",$J,0)=GMTSI
"RTN","GMTSULT3",118,0)
 Q
"RTN","GMTSULT4")
0^8^B25420384
"RTN","GMTSULT4",1,0)
GMTSULT4 ; SLC/KER - HS Type Lookup (Array)         ; 04/19/1999
"RTN","GMTSULT4",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSULT4",3,0)
 ;
"RTN","GMTSULT4",4,0)
 Q
"RTN","GMTSULT4",5,0)
NT ; In Name/Title Array
"RTN","GMTSULT4",6,0)
 Q:$D(GMTSINPT)  Q:+GMTSWDS'>0
"RTN","GMTSULT4",7,0)
 K GMTSLT D CMN S GMTSFND=0,GMTSLT("W")=+($G(GMTSWDS))
"RTN","GMTSULT4",8,0)
 F GMTSI=1:1:GMTSWDS D
"RTN","GMTSULT4",9,0)
 . Q:'$L(GMTSWRDS(GMTSI))  S:$$UP(GMTSCOMP)[$$UP(GMTSWRDS(GMTSI)) GMTSFND=GMTSFND+1,GMTSLT(GMTSI1)=(+($G(GMTSLT(GMTSI1)))+1)
"RTN","GMTSULT4",10,0)
 I GMTSFND>0,GMTSFND=GMTSWDS,'$D(GMTSLT(GMTSI1)) S GMTSLT(0)=+($G(GMTSLT(0)))+1
"RTN","GMTSULT4",11,0)
 ; Reorder
"RTN","GMTSULT4",12,0)
 S GMTSFND=0 F  S GMTSFND=$O(GMTSLT(GMTSFND)) Q:+GMTSFND=0  D
"RTN","GMTSULT4",13,0)
 . S:+($G(GMTSLT(GMTSFND)))>0&(+($G(GMTSLT(GMTSFND)))=+($G(GMTSLT("W")))) GMTSLT("B",+GMTSFND)=""
"RTN","GMTSULT4",14,0)
 . K:+($G(GMTSLT(GMTSFND)))>0&(+($G(GMTSLT(GMTSFND)))'=+($G(GMTSLT("W")))) GMTSLT(+GMTSFND)
"RTN","GMTSULT4",15,0)
 K GMTSLT("W") K:'$D(GMTSLT("B")) GMTSLT
"RTN","GMTSULT4",16,0)
 S:$D(GMTSLT("B")) GMTSLT("C")=$$MX($P($G(^GMT(142,+($G(GMTSIEN)),0)),"^",1))
"RTN","GMTSULT4",17,0)
 ;W:$D(GMTSLT) !! ZW GMTSLT
"RTN","GMTSULT4",18,0)
 Q
"RTN","GMTSULT4",19,0)
LC ; Location Array  (Needs either GMTSIEN or GMTSI1)
"RTN","GMTSULT4",20,0)
 Q:$D(GMTSINPT)  Q:+GMTSWDS'>0
"RTN","GMTSULT4",21,0)
 I '$D(GMTSI1),$D(GMTSIEN),$D(^GMT(142,+($G(GMTSIEN)),0)) N GMTSI1 S GMTSI1=+($G(GMTSIEN))
"RTN","GMTSULT4",22,0)
 Q:'$D(GMTSI1)
"RTN","GMTSULT4",23,0)
 N GMTSF,GMTSI,GMTSI2,GMTSI3,GMTSL K GMTSLI
"RTN","GMTSULT4",24,0)
 S GMTSI2=0  F  S GMTSI2=$O(^GMT(142,GMTSI1,20,GMTSI2)) Q:+GMTSI2=0  D
"RTN","GMTSULT4",25,0)
 . S GMTSI3=+($G(^GMT(142,GMTSI1,20,GMTSI2,0)))
"RTN","GMTSULT4",26,0)
 . S GMTSL=$P($G(^SC(+GMTSI3,0)),"^",1)
"RTN","GMTSULT4",27,0)
 . S GMTSF=0 I GMTSWDS>0 S GMTSLI("W")=+($G(GMTSWDS)) F GMTSI=1:1:GMTSWDS D
"RTN","GMTSULT4",28,0)
 . . Q:'$L(GMTSWRDS(GMTSI))  S:$$UP(GMTSL)[$$UP(GMTSWRDS(GMTSI)) GMTSF=GMTSF+1
"RTN","GMTSULT4",29,0)
 . I GMTSF=GMTSWDS D
"RTN","GMTSULT4",30,0)
 . . S:'$D(GMTSLI(GMTSI1,GMTSI2)) GMTSLI(0)=+($G(GMTSLI(0)))+1
"RTN","GMTSULT4",31,0)
 . . S GMTSLI(GMTSI2)=GMTSF_"^"_GMTSL
"RTN","GMTSULT4",32,0)
 . . S GMTSLI("I")=GMTSI1
"RTN","GMTSULT4",33,0)
 S GMTSF=0 F  S GMTSF=$O(GMTSLI(GMTSF)) Q:+GMTSF=0  D
"RTN","GMTSULT4",34,0)
 . S:+($G(GMTSLI(GMTSF)))>0&(+($G(GMTSLI(GMTSF)))=+($G(GMTSLI("W")))) GMTSLI("B",+GMTSF)=""
"RTN","GMTSULT4",35,0)
 . K:+($G(GMTSLI(GMTSF)))>0&(+($G(GMTSLI(GMTSF)))'=+($G(GMTSLI("W")))) GMTSLI(+GMTSF)
"RTN","GMTSULT4",36,0)
 K:'$D(GMTSLI("B")) GMTSLI
"RTN","GMTSULT4",37,0)
 I $D(GMTSLI("B"))  D
"RTN","GMTSULT4",38,0)
 . N GMTSI,GMTSC,GMTST S GMTSC=0,GMTST=+($G(GMTSLI(0))) Q:GMTST=0
"RTN","GMTSULT4",39,0)
 . S GMTSI="",GMTSF=0 F  S GMTSF=$O(GMTSLI(GMTSF)) Q:+GMTSF=0  D
"RTN","GMTSULT4",40,0)
 . . S GMTSC=GMTSC+1
"RTN","GMTSULT4",41,0)
 . . S:GMTSI'=""&(GMTSC>1)&(GMTSC'=GMTST) GMTSI=GMTSI_", "_$$MX($P(GMTSLI(GMTSF),"^",2))
"RTN","GMTSULT4",42,0)
 . . S:GMTSI'=""&(GMTSC>1)&(GMTSC=GMTST) GMTSI=GMTSI_" and "_$$MX($P(GMTSLI(GMTSF),"^",2))
"RTN","GMTSULT4",43,0)
 . . S:GMTSI="" GMTSI=$$MX($P(GMTSLI(GMTSF),"^",2))
"RTN","GMTSULT4",44,0)
 . S GMTSLI("C")=GMTSI
"RTN","GMTSULT4",45,0)
 K:'$D(GMTSLI("C")) GMTSLI K GMTSLI("W")
"RTN","GMTSULT4",46,0)
 ;I $D(GMTSLI) W !!,+($G(GMTSIEN)),!! ZW GMTSLI
"RTN","GMTSULT4",47,0)
 Q
"RTN","GMTSULT4",48,0)
CMA ; Composite string (name only)
"RTN","GMTSULT4",49,0)
 N GMTSNO D CM Q
"RTN","GMTSULT4",50,0)
CMN ; Composite string (name only)
"RTN","GMTSULT4",51,0)
 N GMTSNO S GMTSNO="" D CM Q
"RTN","GMTSULT4",52,0)
CM ; Composite string
"RTN","GMTSULT4",53,0)
 S GMTSCOMP="",GMTSIEN=+($G(GMTSIEN)) G:GMTSIEN=0 CMQ
"RTN","GMTSULT4",54,0)
 N GMTSWL,GMTSL,GMTS2
"RTN","GMTSULT4",55,0)
 D:$D(GMTSNAM) CMP($$UP($$UP(GMTSNAM))) D:'$D(GMTSNAM) CMP($$UP($P($G(^GMT(142,+GMTSIEN,0)),"^",1)))
"RTN","GMTSULT4",56,0)
 D:$D(GMTSTTL) CMP($$UP($G(GMTSTTL))) D:'$D(GMTSTTL) CMP($$UP($P($G(^GMT(142,+GMTSIEN,"T")),"^",1)))
"RTN","GMTSULT4",57,0)
 D:$D(GMTSOW) CMP($$UP($G(GMTSOW))) I '$D(GMTSOW),+($P($G(^GMT(142,+GMTSIEN,0)),"^",3))>1 D CMP($$UP($P($G(^VA(200,+($P($G(^GMT(142,+GMTSIEN,0)),"^",3)),0)),"^",1)))
"RTN","GMTSULT4",58,0)
 G:$D(GMTSNO) CMQ
"RTN","GMTSULT4",59,0)
 S GMTS2=0  F  S GMTS2=$O(^GMT(142,GMTSIEN,20,GMTS2)) Q:+GMTS2=0  D
"RTN","GMTSULT4",60,0)
 . S GMTSL=+($G(^GMT(142,GMTSIEN,20,GMTS2,0)))
"RTN","GMTSULT4",61,0)
 . S GMTSL=$P($G(^SC(+GMTSL,0)),"^",1) D CMP($$UP(GMTSL))
"RTN","GMTSULT4",62,0)
CMQ ; Quit
"RTN","GMTSULT4",63,0)
 D CMC Q
"RTN","GMTSULT4",64,0)
CMP(X) ; Composite string parse
"RTN","GMTSULT4",65,0)
 N GMTSX,GMTSP,GMTSC,GMTSW S GMTSX=$G(X) Q:'$L(GMTSX)
"RTN","GMTSULT4",66,0)
 S GMTSC=1 F GMTSP=1:1:$L(GMTSX)+1 D
"RTN","GMTSULT4",67,0)
 . S GMTSW=$E(GMTSX,GMTSP) I "(,.?! '-/&:;)"[GMTSW D
"RTN","GMTSULT4",68,0)
 . . S GMTSW=$E($E(GMTSX,GMTSC,GMTSP-1),1,30),GMTSC=GMTSP+1 I $L(GMTSW)>0 D
"RTN","GMTSULT4",69,0)
 . . . S:$L(GMTSW) GMTSWL(GMTSW)=""
"RTN","GMTSULT4",70,0)
 Q
"RTN","GMTSULT4",71,0)
CMC ; Composite Compile
"RTN","GMTSULT4",72,0)
 S GMTSCOMP="" N GMTSW S GMTSW="" F  S GMTSW=$O(GMTSWL(GMTSW)) Q:GMTSW=""  S GMTSCOMP=GMTSCOMP_" "_$$UP(GMTSW)
"RTN","GMTSULT4",73,0)
 F  Q:$E(GMTSCOMP,1)'=" "  S GMTSCOMP=$E(GMTSCOMP,2,$L(GMTSCOMP))
"RTN","GMTSULT4",74,0)
 Q
"RTN","GMTSULT4",75,0)
RDT ;   Recommended Display Text
"RTN","GMTSULT4",76,0)
 ;     Name (used by Location)
"RTN","GMTSULT4",77,0)
 I GMTSKEY["LOC" D
"RTN","GMTSULT4",78,0)
 . Q:'$L(GMTS5)
"RTN","GMTSULT4",79,0)
 . S:$$UP(GMTS2)'=$$UP(GMTS5) GMTSG=GMTSMN_" (used by "_GMTSLOC
"RTN","GMTSULT4",80,0)
 . S:$$UP(GMTSMN)=$$UP(GMTSLOC) GMTSG=GMTSMN
"RTN","GMTSULT4",81,0)
 ;     Name (Title)
"RTN","GMTSULT4",82,0)
 I GMTSKEY["TITL",GMTSKEY'["OWN" D
"RTN","GMTSULT4",83,0)
 . Q:'$L(GMTS3)
"RTN","GMTSULT4",84,0)
 . I $$UP(GMTS3)=$$UP(GMTS2) S GMTSG=GMTS2 Q
"RTN","GMTSULT4",85,0)
 . S:GMTSKEY["TITL"&($$UP(GMTSMN)'=$$UP(GMTSL)) GMTSG=GMTSMN_" ("_$$MX(GMTS3)_")"
"RTN","GMTSULT4",86,0)
 . S:GMTSKEY["TITL"&($$UP(GMTSMN)=$$UP(GMTSL)) GMTSG=GMTSMN
"RTN","GMTSULT4",87,0)
 I GMTSKEY["TITL",GMTSKEY["OWN" D
"RTN","GMTSULT4",88,0)
 . Q:'$L(GMTS3)
"RTN","GMTSULT4",89,0)
 . ;     Name (Title, Owner) if Title'=Name and Owner
"RTN","GMTSULT4",90,0)
 . S:$$UP(GMTSMN)'=$$UP(GMTS3)&($L(GMTS4)) GMTSG=GMTSMN_" ("_$$MX(GMTS3)_", HS Owner "_$$OW(GMTSOW)
"RTN","GMTSULT4",91,0)
 . ;     Name (Title) if Title'=Name and no Owner
"RTN","GMTSULT4",92,0)
 . S:$$UP(GMTSMN)'=$$UP(GMTS3)&('$L(GMTS4)) GMTSG=GMTSMN_" ("_$$MX(GMTSTTL)
"RTN","GMTSULT4",93,0)
 . ;     Name (Owner) if Title=Name and Owner
"RTN","GMTSULT4",94,0)
 . S:$$UP(GMTSMN)=$$UP(GMTS3)&($L(GMTS4)) GMTSG=GMTSMN_" (HS Owner "_$$OW(GMTSOW)
"RTN","GMTSULT4",95,0)
 . S:$$UP(GMTSMN)=$$UP(GMTS3)&('$L(GMTS4)) GMTSG=GMTSMN
"RTN","GMTSULT4",96,0)
 ;                      
"RTN","GMTSULT4",97,0)
 ;   Assemble string and store in TMP Global
"RTN","GMTSULT4",98,0)
 ;      IEN^Name^Title^Owner^Location^Components^Display Text
"RTN","GMTSULT4",99,0)
 S:$L(GMTSG)&(GMTSG'[")")&(GMTSG'["(")&(+GMTS6=0)&($L(GMTS6)) GMTSG=GMTSG_" ("_GMTS6_")" S GMTS7=GMTSG
"RTN","GMTSULT4",100,0)
 S ^TMP("GMTSULT",$J,GMTSI)=GMTS1_U_GMTS2_U_GMTS3_U_GMTS4_U_GMTS5_U_GMTS6_U_GMTS7
"RTN","GMTSULT4",101,0)
 S ^TMP("GMTSULT",$J,0)=GMTSI
"RTN","GMTSULT4",102,0)
 Q
"RTN","GMTSULT4",103,0)
 ;                      
"RTN","GMTSULT4",104,0)
 ; Miscellaneous
"RTN","GMTSULT4",105,0)
UP(X) ;   Uppercase
"RTN","GMTSULT4",106,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSULT4",107,0)
OW(X) ;   Mix Case (owner name)
"RTN","GMTSULT4",108,0)
 Q:$G(X)'["," $$EN^GMTSUMX($G(X))
"RTN","GMTSULT4",109,0)
 Q $$EN^GMTSUMX(($P($G(X),",",1)_", "_$P($G(X),",",2)))
"RTN","GMTSULT4",110,0)
MX(X) ;   Mix Case
"RTN","GMTSULT4",111,0)
 Q $$EN^GMTSUMX(X)
"RTN","GMTSULT5")
0^26^B17045654
"RTN","GMTSULT5",1,0)
GMTSULT5 ; SLC/KER - HS Type Lookup (User Input)  ; 04/19/1999
"RTN","GMTSULT5",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSULT5",3,0)
 ;;
"RTN","GMTSULT5",4,0)
 Q
"RTN","GMTSULT5",5,0)
 ;                        
"RTN","GMTSULT5",6,0)
INPUT(X) ; Get User's Input
"RTN","GMTSULT5",7,0)
 N Y,GMTSDISV,GMTSB,GMTSD,DIR S GMTSDISV=0 D GDISV
"RTN","GMTSULT5",8,0)
 S DIR(0)="FAO^1:30^N GMTS S X=$$DEF^GMTSULT5(X) S GMTS=$$INPT^GMTSULT5(X) K:'GMTS X"
"RTN","GMTSULT5",9,0)
 S DIR("?")="^D IN1^GMTSULT5",DIR("??")="^D IN2^GMTSULT5"
"RTN","GMTSULT5",10,0)
 S:'$L($G(GMTSDICA)) DIR("A")="Select HEALTH SUMMARY TYPE:  " S:$L($G(GMTSDICA)) DIR("A")=GMTSDICA
"RTN","GMTSULT5",11,0)
 S GMTSD=0 S:$L($G(GMTSDICB)) DIR("A")=DIR("A")_$G(GMTSDICB)_"//  "
"RTN","GMTSULT5",12,0)
 I $L($G(DIR("B"))) W !,DIR("A") S X=DIR("B") Q X
"RTN","GMTSULT5",13,0)
 D ^DIR K:X=""&($L($G(GMTSDICB)))&('$D(DTOUT)) DIRUT
"RTN","GMTSULT5",14,0)
 S:X=""&($L($G(GMTSDICB))) (X,Y)=GMTSDICB,GMTSDEF=1 Q:$D(DTOUT)!($D(DUOUT)) X
"RTN","GMTSULT5",15,0)
 S:X=" "&($L(Y))&($G(GMTSDIC0)'["F")&(GMTSDISV>0) X=GMTSDISV
"RTN","GMTSULT5",16,0)
 S:+Y>0&($D(^GMT(142,+Y,0))) X="`"_+Y
"RTN","GMTSULT5",17,0)
 S:+($G(GMTSD))>0&($D(^GMT(142,+GMTSD,0))) X="`"_GMTSD
"RTN","GMTSULT5",18,0)
 Q X
"RTN","GMTSULT5",19,0)
 ;                        
"RTN","GMTSULT5",20,0)
 ; Help
"RTN","GMTSULT5",21,0)
IN1 ;   Single Question Mark Help ? for User Input
"RTN","GMTSULT5",22,0)
 N %,%A,%B,%B1,%B2,%B3,%BA,%C,%E,%G,%H,%I,%J,%N,%P,%S,%T,%W,%X,%Y,%BU,%J1,%A0,%W0,%D1,%D2,%DT,%K,%M
"RTN","GMTSULT5",23,0)
 I X=" "&($G(GMTSDIC0)'["F") D  Q
"RTN","GMTSULT5",24,0)
 . D GDISV
"RTN","GMTSULT5",25,0)
 . S:+($G(GMTSDISV))>0 X=$P($G(^GMT(142,+($G(GMTSDISV)),0)),U,1),(Y,GMTSD)=+GMTSDISV
"RTN","GMTSULT5",26,0)
 D GHT Q
"RTN","GMTSULT5",27,0)
IN2 ;   Double Question Mark Help ? with listing
"RTN","GMTSULT5",28,0)
 N %,%A,%B,%B1,%B2,%B3,%BA,%C,%E,%G,%H,%I,%J,%N,%P,%S,%T,%W,%X,%Y,%BU,%J1,%A0,%W0,%D1,%D2,%DT,%K,%M
"RTN","GMTSULT5",29,0)
 W !!,"Choose from:"
"RTN","GMTSULT5",30,0)
 N GMTSHS,GMTSC,GMTSCT,GMTSIEN,GMTSOK,GMTSTR,GMTSTL,GMTST,GMTSPL,GMTSTT,GMTSRR
"RTN","GMTSULT5",31,0)
 S (GMTSC,GMTST)=0,GMTSCT=1,GMTSHS="",GMTSPL=+($G(IOSL))-8 S:GMTSPL'>0 GMTSPL=18
"RTN","GMTSULT5",32,0)
 S GMTSTT=0,GMTSHS="" F  S GMTSHS=$O(^GMT(142,"B",GMTSHS)) Q:GMTSHS=""  S GMTSIEN=0 F  S GMTSIEN=$O(^GMT(142,"B",GMTSHS,GMTSIEN)) Q:+GMTSIEN=0  S GMTSTT=GMTSTT+1
"RTN","GMTSULT5",33,0)
 S GMTSRR=GMTSTT F  S GMTSHS=$O(^GMT(142,"B",GMTSHS)) Q:GMTSHS=""!('GMTSCT)  Q:GMTST>0  D  Q:'GMTSCT  Q:GMTST>0
"RTN","GMTSULT5",34,0)
 . S GMTSIEN=0 F  S GMTSIEN=$O(^GMT(142,"B",GMTSHS,GMTSIEN)) Q:+GMTSIEN=0!('GMTSCT)  Q:GMTST>0  D  Q:'GMTSCT  Q:+GMTST>0
"RTN","GMTSULT5",35,0)
 . . S GMTSTL="",GMTSOK=1,GMTSTR=$P($G(^GMT(142,GMTSIEN,0)),U,1) Q:'$L(GMTSTR)
"RTN","GMTSULT5",36,0)
 . . S GMTSOK=1 I $L($G(GMTSDICS)) S GMTSOK=$$DICS^GMTSULT2(GMTSDICS,X,GMTSIEN) Q:'GMTSOK
"RTN","GMTSULT5",37,0)
 . . F  Q:$L(GMTSTR)>33  S GMTSTR=GMTSTR_" "
"RTN","GMTSULT5",38,0)
 . . S GMTSTL=$P($G(^GMT(142,GMTSIEN,"T")),U,1)
"RTN","GMTSULT5",39,0)
 . . S:$L(GMTSTL) GMTSTR=GMTSTR_GMTSTL
"RTN","GMTSULT5",40,0)
 . . S GMTSC=GMTSC+1,GMTSRR=GMTSRR-1 W !,?3,GMTSTR I +GMTSC>GMTSPL D IN2C S GMTSC=0
"RTN","GMTSULT5",41,0)
 W ! D:GMTST'>1 GHT Q
"RTN","GMTSULT5",42,0)
IN2C ;   Ask to Continue Listing
"RTN","GMTSULT5",43,0)
 N X W !,?3,"""^"" TO STOP:" R X:300
"RTN","GMTSULT5",44,0)
 S:'$T!(X["^") GMTSC=0 S:X["^" GMTST=1
"RTN","GMTSULT5",45,0)
 S:X["^^" GMTST=2 Q
"RTN","GMTSULT5",46,0)
GHT ;   General Help Text
"RTN","GMTSULT5",47,0)
 W !,?5,"Answer with Health Summary Type name, title, owner or hospital"
"RTN","GMTSULT5",48,0)
 W !,?5,"location using the summary.  Your response must be at least 2"
"RTN","GMTSULT5",49,0)
 W !,?5,"characters and no more than 30 characters and must not contain"
"RTN","GMTSULT5",50,0)
 W !,?5,"an embedded uparrow" Q
"RTN","GMTSULT5",51,0)
 ;                        
"RTN","GMTSULT5",52,0)
 ; Defaults values
"RTN","GMTSULT5",53,0)
DEF(X) ;   Default
"RTN","GMTSULT5",54,0)
 S X=$G(X)
"RTN","GMTSULT5",55,0)
 I +X>0,$D(^GMT(142,+X,0)),($G(GMTSDIC0)["N"!($G(GMTSDIC0)["N")) D  Q X
"RTN","GMTSULT5",56,0)
 . S (Y,GMTSD)=+X,X=$P($G(^GMT(142,+Y,0)),U,1)
"RTN","GMTSULT5",57,0)
 I $E(X,1)="`",+($E(X,2,$L(X)))>0,$D(^GMT(142,+($E(X,2,$L(X))),0)) D  Q X
"RTN","GMTSULT5",58,0)
 . S (Y,GMTSD)=+($E(X,2,$L(X))),X=$P($G(^GMT(142,+Y,0)),U,1)
"RTN","GMTSULT5",59,0)
 I X=" "&($G(GMTSDIC0)'["F") D
"RTN","GMTSULT5",60,0)
 . D GDISV S:+($G(GMTSDISV))>0 X=$P($G(^GMT(142,+($G(GMTSDISV)),0)),U,1),(Y,GMTSD)=+GMTSDISV
"RTN","GMTSULT5",61,0)
 Q X
"RTN","GMTSULT5",62,0)
GDISV ;   Get Default Value (Spacebar-Return)
"RTN","GMTSULT5",63,0)
 Q:+($G(DUZ))=0  Q:'$L($P($G(^VA(200,+($G(DUZ)),0)),"^",1))
"RTN","GMTSULT5",64,0)
 Q:'$D(^DISV(+($G(DUZ)),"^GMT(142,"))  S GMTSDISV=+($G(^DISV(+($G(DUZ)),"^GMT(142,")))
"RTN","GMTSULT5",65,0)
 Q
"RTN","GMTSULT5",66,0)
 ;                        
"RTN","GMTSULT5",67,0)
 ; Miscellaneous
"RTN","GMTSULT5",68,0)
INPT(X) ;   Input Transform
"RTN","GMTSULT5",69,0)
 N %,%A,%B,%B1,%B2,%B3,%BA,%C,%E,%G,%H,%I,%J,%N,%P,%S,%T,%W,%X,%Y,%BU,%J1,%A0,%W0,%D1,%D2,%DT,%K,%M
"RTN","GMTSULT5",70,0)
 N GMTSINPT,GMTSI,GMTST S (GMTST,X)=$G(X) I $L(X)=1,X'=" " Q 0
"RTN","GMTSULT5",71,0)
 I X=" "&($G(GMTSDIC0)'["F") D
"RTN","GMTSULT5",72,0)
 . D GDISV S:+($G(GMTSDISV))>0 X=$P($G(^GMT(142,+($G(GMTSDISV)),0)),U,1),(Y,GMTSD)=+GMTSDISV
"RTN","GMTSULT5",73,0)
 K ^TMP("GMTSULT",$J),^TMP("GMTSULT2",$J) S GMTSINPT="" D LIST^GMTSULT2(X) S X=$S($D(^TMP("GMTSULT",$J,0)):1,1:0)
"RTN","GMTSULT5",74,0)
 I +X=0,$L($G(GMTST))>2,$L($G(GMTST))<31,+($G(GMTSLGO))=142,$G(GMTSDIC0)["L" S X=1 Q X
"RTN","GMTSULT5",75,0)
 K ^TMP("GMTSULT",$J),^TMP("GMTSULT2",$J) Q X
"RTN","GMTSULT6")
0^27^B25750888
"RTN","GMTSULT6",1,0)
GMTSULT6 ; SLC/KER - HS Type Lookup (Select)     ; 04/19/1999
"RTN","GMTSULT6",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSULT6",3,0)
 ;;
"RTN","GMTSULT6",4,0)
 Q
"RTN","GMTSULT6",5,0)
 ;                          
"RTN","GMTSULT6",6,0)
MULTI ; Selection when Multiple Entries are found
"RTN","GMTSULT6",7,0)
 I $L($G(GMTSDICB)),GMTSDEF=1 D DEF Q
"RTN","GMTSULT6",8,0)
 S GMTSDICW=$$DICW($G(GMTSDICW)) K:'$L(GMTSDICW) GMTSDICW
"RTN","GMTSULT6",9,0)
 N GMTSIEN,GMTSE,GMTSO,GMTST,GMTSTOT,GMTSM S GMTSTOT=^TMP("GMTSULT",$J,0) Q:+GMTSTOT=0  I +GMTSTOT=1 D ONE Q
"RTN","GMTSULT6",10,0)
 W ! W:+GMTSTOT>1 !,GMTSTOT," Health Summary Types found"
"RTN","GMTSULT6",11,0)
 N GMTSI,GMTSS,GMTSEX,X,GMTSTR,GMTSTR2,GMTSTR3,GMTSLEN S GMTSLEN=75,GMTSS=0,GMTSEX=0
"RTN","GMTSULT6",12,0)
 ;   List 5 at a time
"RTN","GMTSULT6",13,0)
 F GMTSI=1:1:^TMP("GMTSULT",$J,0) Q:((GMTSS>0)&(GMTSS<GMTSI+1))  Q:GMTSEX  D  Q:GMTSEX
"RTN","GMTSULT6",14,0)
 . S GMTSE=$G(^TMP("GMTSULT",$J,GMTSI))
"RTN","GMTSULT6",15,0)
 . S GMTSM=GMTSI W:GMTSI#5=1 ! W !,$J(GMTSI,4),".  "
"RTN","GMTSULT6",16,0)
 . S GMTSIEN=+GMTSE,(GMTST,GMTSTR)=$P(GMTSE,U,7),GMTSO=$P(GMTSE,U,2)
"RTN","GMTSULT6",17,0)
 . S:'$L(GMTSTR)&($L(GMTSO)) GMTSTR=GMTSO
"RTN","GMTSULT6",18,0)
 . D WRM1
"RTN","GMTSULT6",19,0)
 . W:GMTSI#5=0 ! S:GMTSI#5=0 GMTSS=$$SEL(GMTSM) S:GMTSS["^" GMTSEX=1
"RTN","GMTSULT6",20,0)
 I GMTSI#5'=0,+GMTSS=0 W ! S GMTSS=$$SEL(GMTSM) S:GMTSS["^" GMTSEX=1
"RTN","GMTSULT6",21,0)
 I 'GMTSEX,+GMTSS>0 D  Q
"RTN","GMTSULT6",22,0)
 . N GMTSNAM K Y S Y=+($G(^TMP("GMTSULT",$J,+GMTSS)))
"RTN","GMTSULT6",23,0)
 . S GMTSNAM=$P($G(^GMT(142,+Y,0)),"^",1) I '$L(GMTSNAM) K Y S Y=-1 Q
"RTN","GMTSULT6",24,0)
 . D Y(+Y)
"RTN","GMTSULT6",25,0)
 K Y S Y=-1
"RTN","GMTSULT6",26,0)
 Q
"RTN","GMTSULT6",27,0)
WRM1 ;   Write one entry of muli selection
"RTN","GMTSULT6",28,0)
 N Y,GMTS S Y=+GMTSIEN,GMTS=$G(^GMT(142,+Y,0))
"RTN","GMTSULT6",29,0)
 I '$D(GMTSDICW) W:$L(GMTSTR)'>GMTSLEN GMTSTR D:$L(GMTSTR)>GMTSLEN LONG Q
"RTN","GMTSULT6",30,0)
 I $D(GMTSDICW),$G(GMTSDIC0)'["S" W $P(GMTS,"^",1),"  " X GMTSDICW Q
"RTN","GMTSULT6",31,0)
 I $D(GMTSDICW),$G(GMTSDIC0)["S" X GMTSDICW Q
"RTN","GMTSULT6",32,0)
 Q
"RTN","GMTSULT6",33,0)
SEL(X) ;   Select multiple
"RTN","GMTSULT6",34,0)
 N Y,GMTSM,DTOUT,DUOUT,DIRUT,DIROUT S GMTSM=+($G(X)) Q:GMTSM=0 -1
"RTN","GMTSULT6",35,0)
 S:+($O(^TMP("GMTSULT",$J,+($G(GMTSI)))))>0 DIR("A")="Press <RETURN> for more, '^' to exit, or Select 1-"_GMTSM_":  "
"RTN","GMTSULT6",36,0)
 S:+($O(^TMP("GMTSULT",$J,+($G(GMTSI)))))'>0 DIR("A")="Select 1-"_GMTSM_":  "
"RTN","GMTSULT6",37,0)
 S (DIR("?"),DIR("??"))="Answer must be from 1 to "_GMTSM_", or <Return> to continue  "
"RTN","GMTSULT6",38,0)
 S DIR(0)="NAO^1:"_GMTSM_":0" D ^DIR S:$D(DTOUT)!(X[U) X=U K DIR Q X
"RTN","GMTSULT6",39,0)
 Q
"RTN","GMTSULT6",40,0)
 ;                          
"RTN","GMTSULT6",41,0)
ONE ; One entry on the selection list
"RTN","GMTSULT6",42,0)
 I $L($G(GMTSDICB)),GMTSDEF=1 D DEF Q
"RTN","GMTSULT6",43,0)
 N GMTSEX,GMTSIEN,GMTSTR,GMTSTR2,GMTSY,GMTSX,GMTSLEN,DIR,X
"RTN","GMTSULT6",44,0)
 S GMTSLEN=75,Y=0 S:GMTSQ!($G(GMTSDIC0)["E") GMTSQ=1,Y=1,GMTSEX=0
"RTN","GMTSULT6",45,0)
 ;   No Echo or if Ask
"RTN","GMTSULT6",46,0)
 S GMTSIEN=+($G(^TMP("GMTSULT",$J,1)))
"RTN","GMTSULT6",47,0)
 I 'GMTSQ!($G(GMTSDIC0)["A") D
"RTN","GMTSULT6",48,0)
 . N X S GMTSTR=$P($G(^TMP("GMTSULT",$J,1)),U,7)
"RTN","GMTSULT6",49,0)
 . S:'$L(GMTSTR) GMTSTR=$P($G(^TMP("GMTSULT",$J,1)),U,2)
"RTN","GMTSULT6",50,0)
 . D WRO1 S Y=$$OK S:Y["^" GMTSEX=1
"RTN","GMTSULT6",51,0)
 I 'GMTSEX,+Y>0 D  Q
"RTN","GMTSULT6",52,0)
 . N GMTSNAM K Y S Y=+($G(^TMP("GMTSULT",$J,1)))
"RTN","GMTSULT6",53,0)
 . S GMTSNAM=$P($G(^GMT(142,+Y,0)),"^",1) I '$L(GMTSNAM) K Y S Y=-1 Q
"RTN","GMTSULT6",54,0)
 . D Y(+Y)
"RTN","GMTSULT6",55,0)
 K Y S Y=-1
"RTN","GMTSULT6",56,0)
 Q
"RTN","GMTSULT6",57,0)
WRO1 ;   Write one entry of single selection
"RTN","GMTSULT6",58,0)
 W !!,"  " N Y,GMTS S Y=+GMTSIEN,GMTS=$G(^GMT(142,+Y,0))
"RTN","GMTSULT6",59,0)
 I '$D(GMTSDICW) W:$L(GMTSTR)'>GMTSLEN GMTSTR D:$L(GMTSTR)>GMTSLEN LONG W ! Q
"RTN","GMTSULT6",60,0)
 I $D(GMTSDICW),$G(GMTSDIC0)'["S" W $P(GMTS,"^",1),"  " X GMTSDICW W ! Q
"RTN","GMTSULT6",61,0)
 I $D(GMTSDICW),$G(GMTSDIC0)["S" X GMTSDICW W ! Q
"RTN","GMTSULT6",62,0)
 Q
"RTN","GMTSULT6",63,0)
OK(X) ;   Select one if DIC(0)["A" Ask OK
"RTN","GMTSULT6",64,0)
 N DIR,DTOUT,DUOUT,DIROUT S DIR(0)="YAO",DIR("B")="YES"
"RTN","GMTSULT6",65,0)
 S DIR("A")="  OK?  " D ^DIR S:X'["^" X=+Y S:$D(DTOUT)!($D(DUOUT)) X="^" S:X["^" X="^" Q X
"RTN","GMTSULT6",66,0)
 ;                          
"RTN","GMTSULT6",67,0)
DEF ; Select Default Entry
"RTN","GMTSULT6",68,0)
 N GMTSNAM K Y S Y=+($G(^TMP("GMTSULT",$J,1)))
"RTN","GMTSULT6",69,0)
 S GMTSNAM=$P($G(^GMT(142,+Y,0)),"^",1) I '$L(GMTSNAM) K Y S Y=-1 Q
"RTN","GMTSULT6",70,0)
 D Y(+Y)
"RTN","GMTSULT6",71,0)
 Q
"RTN","GMTSULT6",72,0)
 ;                       
"RTN","GMTSULT6",73,0)
 ; Display
"RTN","GMTSULT6",74,0)
LONG ;   Handle a long string
"RTN","GMTSULT6",75,0)
 N GMTSP,GMTSOK,GMTSCHR,GMTSPSN,GMTSTO,GMTSREM,GMTSLN,GMTSOLD S GMTSLN=0,GMTSOLD=GMTSTR,GMTSP=5
"RTN","GMTSULT6",76,0)
 F  Q:$L(GMTSTR)<(GMTSLEN+1)  D PARSE Q:$L(GMTSTR)<(GMTSLEN+1)
"RTN","GMTSULT6",77,0)
 S GMTSLN=GMTSLN+1 W:GMTSLN>1 ! W ?GMTSP,GMTSTR
"RTN","GMTSULT6",78,0)
 Q
"RTN","GMTSULT6",79,0)
PARSE ;   Parse a long string to screen length
"RTN","GMTSULT6",80,0)
 S GMTSOK=0,GMTSCHR="" F GMTSPSN=GMTSLEN:-1:0 Q:+GMTSOK=1  D  Q:+GMTSOK=1
"RTN","GMTSULT6",81,0)
 . I $E(GMTSTR,GMTSPSN)=" " S GMTSCHR=" ",GMTSOK=1 Q
"RTN","GMTSULT6",82,0)
 . I $E(GMTSTR,GMTSPSN)="," S GMTSCHR=",",GMTSOK=1 Q
"RTN","GMTSULT6",83,0)
 . I $E(GMTSTR,GMTSPSN)="/" S GMTSCHR="/",GMTSOK=1 Q
"RTN","GMTSULT6",84,0)
 . I $E(GMTSTR,GMTSPSN)="-" S GMTSCHR="-",GMTSOK=1 Q
"RTN","GMTSULT6",85,0)
 I GMTSCHR=" " S GMTSTO=$E(GMTSTR,1,GMTSPSN-1),GMTSREM=$E(GMTSTR,GMTSPSN+1,$L(GMTSTR))
"RTN","GMTSULT6",86,0)
 I GMTSCHR="," S GMTSTO=$E(GMTSTR,1,GMTSPSN),GMTSREM=$E(GMTSTR,(GMTSPSN+1),$L(GMTSTR)) S:$E(GMTSREM,1)=" " GMTSREM=$E(GMTSREM,2,$L(GMTSREM))
"RTN","GMTSULT6",87,0)
 I GMTSCHR="/" S GMTSTO=$E(GMTSTR,1,GMTSPSN),GMTSREM=$E(GMTSTR,(GMTSPSN+1),$L(GMTSTR)) S:$E(GMTSREM,1)=" " GMTSREM=$E(GMTSREM,2,$L(GMTSREM))
"RTN","GMTSULT6",88,0)
 I GMTSCHR="-" S GMTSTO=$E(GMTSTR,1,GMTSPSN),GMTSREM=$E(GMTSTR,(GMTSPSN+1),$L(GMTSTR)) S:$E(GMTSREM,1)=" " GMTSREM=$E(GMTSREM,2,$L(GMTSREM))
"RTN","GMTSULT6",89,0)
 S GMTSTR=GMTSREM,GMTSLN=GMTSLN+1 W:GMTSLN>1 ! W ?GMTSP,GMTSTO
"RTN","GMTSULT6",90,0)
 Q
"RTN","GMTSULT6",91,0)
DICW(X) ;   Check for valid DIC("W")
"RTN","GMTSULT6",92,0)
 S X=$G(X) Q:'$L(X) ""
"RTN","GMTSULT6",93,0)
 D ^DIM I '$D(X) Q ""
"RTN","GMTSULT6",94,0)
 Q X
"RTN","GMTSULT6",95,0)
 ;                       
"RTN","GMTSULT6",96,0)
 ; Post Selection
"RTN","GMTSULT6",97,0)
Y(X) ;   Set Y
"RTN","GMTSULT6",98,0)
 K Y S X=+($G(X))
"RTN","GMTSULT6",99,0)
 S:X'>0!('$D(^GMT(142,+X,0))) Y=-1 Q:X'>0!('$D(^GMT(142,+X,0)))
"RTN","GMTSULT6",100,0)
 S Y=+X_"^"_$P($G(^GMT(142,+X,0)),"^",1)
"RTN","GMTSULT6",101,0)
 S:$G(GMTSDIC0)["Z"!($G(DIC(0))["Z") Y(0)=$G(^GMT(142,+X,0)),Y(0,0)=$P($G(^GMT(142,+X,0)),"^",1),Y(0,1)=$$MX(Y(0,0))
"RTN","GMTSULT6",102,0)
 I +($G(GMTSWY))=0 W:$G(GMTSDIC0)["E"!($G(DIC(0))["E") "  ",$P($G(^GMT(142,+X,0)),"^",1) S GMTSWY=1
"RTN","GMTSULT6",103,0)
 D:$G(GMTSDIC0)'["F"&($G(DIC(0))'["F") SDISV
"RTN","GMTSULT6",104,0)
 Q
"RTN","GMTSULT6",105,0)
SDISV ;   Save Default Value (Spacebar-Return)
"RTN","GMTSULT6",106,0)
 Q:$G(GMTSDIC0)["F"  Q:+($G(DUZ))=0  Q:'$L($P($G(^VA(200,+($G(DUZ)),0)),"^",1))  Q:+($G(Y))=0  Q:'$D(^GMT(142,+($G(Y)),0))
"RTN","GMTSULT6",107,0)
 S ^DISV(+($G(DUZ)),"^GMT(142,")=+($G(Y))
"RTN","GMTSULT6",108,0)
 Q
"RTN","GMTSULT6",109,0)
MX(X) ; Mix Case
"RTN","GMTSULT6",110,0)
 Q $$EN^GMTSUMX(X)
"RTN","GMTSULT7")
0^28^B26914731
"RTN","GMTSULT7",1,0)
GMTSULT7 ; SLC/KER - HS Type Lookup ("B" index)     ; 04/19/1999
"RTN","GMTSULT7",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSULT7",3,0)
 Q
"RTN","GMTSULT7",4,0)
 ;                      
"RTN","GMTSULT7",5,0)
B ; Search "B" Index
"RTN","GMTSULT7",6,0)
 ;                      
"RTN","GMTSULT7",7,0)
 ;   Needs GMTSEQ and GMTSEO
"RTN","GMTSULT7",8,0)
 ;                      
"RTN","GMTSULT7",9,0)
 ;     GMTSEQ=1 Exact match reqired
"RTN","GMTSULT7",10,0)
 ;              Stop search if found
"RTN","GMTSULT7",11,0)
 ;              Continue partial-exact search if not found
"RTN","GMTSULT7",12,0)
 ;                      
"RTN","GMTSULT7",13,0)
 ;     GMTSEO=1 Exact match, only one entry
"RTN","GMTSULT7",14,0)
 ;              Stop search if found and return single entry
"RTN","GMTSULT7",15,0)
 ;              Do not continue if not found
"RTN","GMTSULT7",16,0)
 ;                      
"RTN","GMTSULT7",17,0)
 D CLR^GMTSULT S X=$G(X) Q:'$L(X)  N GMTSKL1,GMTSKL2,GMTSIV,GMTSIEN,GMTSDS,GMTSD0,GMTSDW,GMTSC,GMTSE
"RTN","GMTSULT7",18,0)
 S GMTSKL1=$$LO($E(X,1)),GMTSKL2=$$UP(GMTSKL1),U="^",(GMTSE,GMTSC)=0
"RTN","GMTSULT7",19,0)
 S:$L($G(DIC("S")))&('$L($G(GMTSDICS))) GMTSDICS=$G(DIC("S")),GMTSDS=1
"RTN","GMTSULT7",20,0)
 S:$L($G(DIC(0)))&('$L($G(GMTSDIC0))) GMTSDIC0=$G(DIC(0)),GMTSD0=1
"RTN","GMTSULT7",21,0)
 S:$L($G(DIC("W")))&('$L($G(GMTSDICW))) GMTSDICW=$G(DIC("W")),GMTSDW=1
"RTN","GMTSULT7",22,0)
 D:$G(GMTSDIC0)'["M" CLR^GMTSULT
"RTN","GMTSULT7",23,0)
 S GMTSIV=$C($A(GMTSKL1)-1)_"~" F  S GMTSIV=$O(^GMT(142,"B",GMTSIV)) Q:GMTSIV=""!($E(GMTSIV,1)'=GMTSKL1)  Q:GMTSE  D  Q:GMTSE
"RTN","GMTSULT7",24,0)
 . Q:$$UP($E(X,1,30))'=$$UP($E(GMTSIV,1,$L(X)))  S GMTSIEN=0 F  S GMTSIEN=$O(^GMT(142,"B",GMTSIV,GMTSIEN)) Q:+GMTSIEN=0  Q:GMTSE  D CK  Q:GMTSE
"RTN","GMTSULT7",25,0)
 S GMTSIV=$C($A(GMTSKL2)-1)_"~" F  S GMTSIV=$O(^GMT(142,"B",GMTSIV)) Q:GMTSIV=""!($E(GMTSIV,1)'=GMTSKL2)  Q:GMTSE  D  Q:GMTSE
"RTN","GMTSULT7",26,0)
 . Q:$$UP($E(X,1,30))'=$$UP($E(GMTSIV,1,$L(X)))  S GMTSIEN=0 F  S GMTSIEN=$O(^GMT(142,"B",GMTSIV,GMTSIEN)) Q:+GMTSIEN=0  Q:GMTSE  D CK  Q:GMTSE
"RTN","GMTSULT7",27,0)
BQ ; Quit "B" Index search
"RTN","GMTSULT7",28,0)
 K:+($G(GMTSDS))>0 GMTSDICS K:+($G(GMTSD0))>0 GMTSDIC0 K:+($G(GMTSDW))>0 GMTSDICW
"RTN","GMTSULT7",29,0)
 D REO
"RTN","GMTSULT7",30,0)
 Q
"RTN","GMTSULT7",31,0)
 ;                      
"RTN","GMTSULT7",32,0)
 ; Build list
"RTN","GMTSULT7",33,0)
CK ;   Check Entry
"RTN","GMTSULT7",34,0)
 N GMTSCK,GMTSNM,GMTSTL,GMTSOW,GMTSCMP,GMTSOKS,GMTSDT,GMTSDT2 S GMTSTL=$P($G(^GMT(142,+GMTSIEN,"T")),U,1),GMTSNM=$P($G(^GMT(142,+GMTSIEN,0)),U,1)
"RTN","GMTSULT7",35,0)
 S GMTSDT=GMTSNM S:$$UP(GMTSNM)'=$$UP(GMTSTL)&($L(GMTSTL)) GMTSDT=GMTSNM_" ("_GMTSTL_")"
"RTN","GMTSULT7",36,0)
 S GMTSOW=+($P($G(^GMT(142,+GMTSIEN,0)),U,3)) S:GMTSOW<1 GMTSOW="" S:+GMTSOW>0 GMTSOW=$P($G(^VA(200,+GMTSOW,0)),U,1)
"RTN","GMTSULT7",37,0)
 S GMTSCMP=$$CM^GMTSULT2(GMTSIEN) S:$D(GMTSDICW) GMTSDT=GMTSNM S GMTSDT=$$MX(GMTSDT),GMTSOKS=+($$DICS^GMTSULT2($G(GMTSDICS),GMTSNM,+GMTSIEN)) Q:'GMTSOKS  S GMTSCK="GMTSNM"
"RTN","GMTSULT7",38,0)
 I +($G(GMTSEO)) I $L($G(X))>0,$$UP($G(X))=$$UP($G(GMTSNM)) S GMTSE=1,GMTSCK="GMTSNM" D EA Q
"RTN","GMTSULT7",39,0)
 I $L($G(X))>0,$$UP($G(X))=$$UP($G(GMTSNM)) S GMTSCK="GMTSNM" D EA Q
"RTN","GMTSULT7",40,0)
 D MA Q
"RTN","GMTSULT7",41,0)
MA ;   Add Match
"RTN","GMTSULT7",42,0)
 Q:$D(^TMP("GMTSULT2",$J,"IEN",+GMTSIEN))
"RTN","GMTSULT7",43,0)
 S GMTSC=+($G(GMTSC))+1,^TMP("GMTSULT2",$J,GMTSC)=$$ASM,^TMP("GMTSULT2",$J,0)=GMTSC,^TMP("GMTSULT2",$J,"B",(GMTSNM_" "),GMTSC)=""
"RTN","GMTSULT7",44,0)
 Q
"RTN","GMTSULT7",45,0)
EA ;   Add Exact Match
"RTN","GMTSULT7",46,0)
 S GMTSC=+($G(GMTSC))+1 S GMTSCMP=$$CM^GMTSULT2(GMTSIEN) S ^TMP("GMTSULT2",$J,"EM")=+GMTSIEN,^TMP("GMTSULT2",$J,"IEN",+GMTSIEN)="",^TMP("GMTSULT2",$J,"B",(GMTSNM_" "),GMTSC)="",^TMP("GMTSULT2",$J,"EMI")=GMTSC
"RTN","GMTSULT7",47,0)
 S ^TMP("GMTSULT2",$J,"EMB")=GMTSNM_" ",^TMP("GMTSULT2",$J,GMTSC)=$$ASM,^TMP("GMTSULT2",$J,0)=GMTSC,^TMP("GMTSULT2",$J,"B",(GMTSNM_" "))=""
"RTN","GMTSULT7",48,0)
 Q
"RTN","GMTSULT7",49,0)
ASM(X) ;   Assemble string to store in list
"RTN","GMTSULT7",50,0)
 N GMTST S GMTST=$G(GMTSTL) S:$L($G(GMTSDT))&($G(GMTSDT)'=$G(GMTST)) GMTST=GMTSDT
"RTN","GMTSULT7",51,0)
 S X=+($G(GMTSIEN)),X=X_U_$G(GMTSNM)_U_$G(GMTSTL)_U_$G(GMTSOW)_U_U_$G(GMTSCMP)_U_GMTST
"RTN","GMTSULT7",52,0)
 Q X
"RTN","GMTSULT7",53,0)
 ;                      
"RTN","GMTSULT7",54,0)
REO ; Reorder List
"RTN","GMTSULT7",55,0)
 N GMTSC,GMTSFND,GMTSG,GMTSI,GMTSIEN,GMTSKEY,GMTSL,GMTSCMP,GMTSOW,GMTSTTL,GMTSLOC,GMTSMN,GMTSNM
"RTN","GMTSULT7",56,0)
 S GMTSI=0,GMTSFND=""
"RTN","GMTSULT7",57,0)
 ;   Add exact match to the top of the selection list
"RTN","GMTSULT7",58,0)
 I '$D(^TMP("GMTSULT2",$J,"EMI")),+($G(GMTSEO)) K ^TMP("GMTSULT2",$J)
"RTN","GMTSULT7",59,0)
 I $D(^TMP("GMTSULT2",$J,"EMI")) D
"RTN","GMTSULT7",60,0)
 . S GMTSI=0,GMTSC=$G(^TMP("GMTSULT2",$J,"EMI")) D ADD
"RTN","GMTSULT7",61,0)
 . S ^TMP("GMTSULT",$J,0)=GMTSI K ^TMP("GMTSULT2",$J,"EMI")
"RTN","GMTSULT7",62,0)
 . ;   Kill global (quit) if Exact Match is found
"RTN","GMTSULT7",63,0)
 . ;     and DIR(0) either contains OE or X
"RTN","GMTSULT7",64,0)
 . K:+($G(GMTSEQ)) ^TMP("GMTSULT2",$J) K:+($G(GMTSEO)) ^TMP("GMTSULT2",$J)
"RTN","GMTSULT7",65,0)
 ;   Kill global (quit) if Exact Match is not 
"RTN","GMTSULT7",66,0)
 ;     found and DIR(0)["OE"
"RTN","GMTSULT7",67,0)
 I '$D(^TMP("GMTSULT2",$J,"EMI")),+($G(GMTSEO)) K ^TMP("GMTSULT2",$J)
"RTN","GMTSULT7",68,0)
 ;   Add other entries in Alphabetical Order
"RTN","GMTSULT7",69,0)
 S GMTSFND=0 Q:'$D(^TMP("GMTSULT2",$J,"B"))  F  S GMTSFND=$O(^TMP("GMTSULT2",$J,"B",GMTSFND)) Q:GMTSFND=""  D
"RTN","GMTSULT7",70,0)
 . S GMTSC=0 F  S GMTSC=$O(^TMP("GMTSULT2",$J,"B",GMTSFND,GMTSC)) Q:+GMTSC=0  D ADD
"RTN","GMTSULT7",71,0)
 D CLEAN^GMTSULT
"RTN","GMTSULT7",72,0)
 Q
"RTN","GMTSULT7",73,0)
ADD ;   Add to the reordered list
"RTN","GMTSULT7",74,0)
 N GMTS0,GMTS1,GMTS2,GMTS3,GMTS4,GMTS5,GMTS6,GMTS7
"RTN","GMTSULT7",75,0)
 S GMTSI=+($G(GMTSI))+1,GMTS0=$G(^TMP("GMTSULT2",$J,GMTSC)) S (GMTSG,GMTSMN,GMTS2)=$$MX($P(GMTS0,U,2)) S (GMTS1,GMTSIEN)=+($P(GMTS0,U,1)) S GMTSNM=$$UP(GMTSMN)
"RTN","GMTSULT7",76,0)
 S (GMTS4,GMTSOW)=$$MX($P(GMTS0,U,4)),GMTSOW=GMTSOW_")" S (GMTS3,GMTSTTL)=$$MX($P(GMTS0,U,3)),GMTSTTL=GMTSTTL_")" S (GMTS5,GMTSLOC)=$$MX($P(GMTS0,U,5)),GMTSLOC=GMTSLOC_")"
"RTN","GMTSULT7",77,0)
 S (GMTS6,GMTSCMP)=$P(GMTS0,U,6),GMTSL=$P(GMTS0,U,4),GMTSG=$P(GMTS0,U,7)
"RTN","GMTSULT7",78,0)
 S:$L(GMTSG)&(GMTSG'[")")&(GMTSG'["(")&(+GMTS6=0)&($L(GMTS6)) GMTSG=GMTSG_" ("_GMTS6_")"
"RTN","GMTSULT7",79,0)
 S GMTS7=GMTSG S ^TMP("GMTSULT",$J,GMTSI)=GMTS1_U_GMTS2_U_GMTS3_U_GMTS4_U_GMTS5_U_GMTS6_U_GMTS7
"RTN","GMTSULT7",80,0)
 S ^TMP("GMTSULT",$J,0)=GMTSI
"RTN","GMTSULT7",81,0)
 Q
"RTN","GMTSULT7",82,0)
 ; Miscellaneous
"RTN","GMTSULT7",83,0)
UP(X) ;   Uppercase
"RTN","GMTSULT7",84,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSULT7",85,0)
LO(X) ;   Lowercase
"RTN","GMTSULT7",86,0)
 Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSULT7",87,0)
MX(X) ;   Mix Case
"RTN","GMTSULT7",88,0)
 Q $$EN^GMTSUMX(X)
"RTN","GMTSUMX")
0^4^B12765702
"RTN","GMTSUMX",1,0)
GMTSUMX ; SLC/KER - Convert Text to Mix Case   ; 04/19/1999
"RTN","GMTSUMX",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSUMX",3,0)
 Q
"RTN","GMTSUMX",4,0)
EN(X) ; Convert Case
"RTN","GMTSUMX",5,0)
 N Y,GMTSOK,GMTSOC,GMTSWORD,GMTSPC,GMTSLEAD,GMTSTLR,GMTSTR,GMTSCTR,GMTSPRE
"RTN","GMTSUMX",6,0)
 S (GMTSTR,GMTSWORD,GMTSPC)="",X=$$UP(X)
"RTN","GMTSUMX",7,0)
 ; Parse by Spaces
"RTN","GMTSUMX",8,0)
 F GMTSCTR=1:1:$L(X," ") D
"RTN","GMTSUMX",9,0)
 . S GMTSWORD=$P(X," ",GMTSCTR)
"RTN","GMTSUMX",10,0)
 . S (GMTSPC,GMTSLEAD,GMTSTLR)=""
"RTN","GMTSUMX",11,0)
 . I $E(GMTSWORD,1)="(" S GMTSWORD=$E(GMTSWORD,2,$L(GMTSWORD)),GMTSLEAD="("
"RTN","GMTSUMX",12,0)
 . I $E(GMTSWORD,$L(GMTSWORD))=")" S GMTSWORD=$E(GMTSWORD,1,($L(GMTSWORD)-1)),GMTSTLR=")"
"RTN","GMTSUMX",13,0)
 . ; String contains special characters
"RTN","GMTSUMX",14,0)
 . S GMTSOK=1 F GMTSOC="(",")","-","*","+","{","}","[","]","/","\","|","," S:GMTSWORD[GMTSOC GMTSOK=0 Q:'GMTSOK
"RTN","GMTSUMX",15,0)
 . I 'GMTSOK D SP
"RTN","GMTSUMX",16,0)
 . I GMTSOK D GMTSWORD
"RTN","GMTSUMX",17,0)
 . S:GMTSLEAD'="" GMTSWORD=GMTSLEAD_GMTSWORD
"RTN","GMTSUMX",18,0)
 . S:GMTSTLR'="" GMTSWORD=GMTSWORD_GMTSTLR
"RTN","GMTSUMX",19,0)
 . S GMTSTR=GMTSTR_" "_GMTSWORD
"RTN","GMTSUMX",20,0)
 S X=$$TRIM(GMTSTR) Q X
"RTN","GMTSUMX",21,0)
SP ; Special Characters
"RTN","GMTSUMX",22,0)
 I GMTSWORD="W/O" S GMTSWORD="w/o" Q
"RTN","GMTSUMX",23,0)
 N GMTSOK,GMTSWD1,GMTSWD2,GMTSW,GMTSWCTR,GMTSCHR S GMTSWD1=GMTSWORD,GMTSWD2="",GMTSW=""
"RTN","GMTSUMX",24,0)
 F GMTSWCTR=1:1:$L(GMTSWD1) D
"RTN","GMTSUMX",25,0)
 . S GMTSCHR=$E(GMTSWD1,GMTSWCTR) I "()-*+{}[]/\|,"[GMTSCHR,$L(GMTSW) D  Q
"RTN","GMTSUMX",26,0)
 . . S GMTSPRE="" S:$E(GMTSW,1,2)="ZZ"&($L(GMTSW)>2) GMTSPRE="ZZ",GMTSW=$E(GMTSW,3,$L(GMTSW))
"RTN","GMTSUMX",27,0)
 . . S GMTSW=GMTSPRE_$$CASE(GMTSW,GMTSCHR)
"RTN","GMTSUMX",28,0)
 . . S GMTSWD2=GMTSWD2_GMTSW_GMTSCHR,GMTSW=""
"RTN","GMTSUMX",29,0)
 . S GMTSW=GMTSW_GMTSCHR
"RTN","GMTSUMX",30,0)
 I $L(GMTSW) D
"RTN","GMTSUMX",31,0)
 . N GMTSPSN F GMTSPSN=1:1:$L(GMTSW) Q:"()-*+{}[]/\|,"'[$E(GMTSW,GMTSPSN)
"RTN","GMTSUMX",32,0)
 . N GMTSOW,GMTSLW S GMTSLW=$E(GMTSW,0,(GMTSPSN-1))
"RTN","GMTSUMX",33,0)
 . S GMTSOW=$E(GMTSW,GMTSPSN,$L(GMTSW))
"RTN","GMTSUMX",34,0)
 . S GMTSPRE="" S:$E(GMTSOW,1,2)="ZZ"&($L(GMTSOW)>2) GMTSPRE="ZZ",GMTSOW=$E(GMTSOW,3,$L(GMTSOW))
"RTN","GMTSUMX",35,0)
 . S GMTSOW=GMTSPRE_$$CASE(GMTSOW,$E($G(GMTSWD2),$L($G(GMTSWD2))))
"RTN","GMTSUMX",36,0)
 . S GMTSW=GMTSLW_GMTSOW
"RTN","GMTSUMX",37,0)
 . S GMTSWD2=GMTSWD2_GMTSW
"RTN","GMTSUMX",38,0)
 S GMTSWORD=GMTSWD2 S:GMTSCTR=1 GMTSWORD=$$LD(GMTSWORD)
"RTN","GMTSUMX",39,0)
 K GMTSWD1,GMTSWD2
"RTN","GMTSUMX",40,0)
 Q
"RTN","GMTSUMX",41,0)
GMTSWORD ; Convert word
"RTN","GMTSUMX",42,0)
 S GMTSPRE="" S:$E(GMTSWORD,1,2)="ZZ"&($L(GMTSWORD)>2) GMTSPRE="ZZ",GMTSWORD=$E(GMTSWORD,3,$L(GMTSWORD))
"RTN","GMTSUMX",43,0)
 S GMTSWORD=GMTSPRE_$$CASE(GMTSWORD,"")
"RTN","GMTSUMX",44,0)
 Q
"RTN","GMTSUMX",45,0)
CASE(X,J) ; Set to Mixed/lower/UPPER case
"RTN","GMTSUMX",46,0)
 N GMTSTAG,GMTSRTN,Y S X=$$UP($G(X)),Y="",GMTSTAG=$L(X),GMTSRTN="GMTSUMX2"
"RTN","GMTSUMX",47,0)
 S:+GMTSTAG>4 GMTSRTN="GMTSUMX3" S:+GMTSTAG>9 GMTSTAG="M"
"RTN","GMTSUMX",48,0)
 Q:+GMTSTAG=0&(GMTSTAG'="M") X
"RTN","GMTSUMX",49,0)
 S GMTSRTN=GMTSTAG_"^"_GMTSRTN D @GMTSRTN
"RTN","GMTSUMX",50,0)
 I $L(Y) S X=Y Q X
"RTN","GMTSUMX",51,0)
 S X=$$MX(X)
"RTN","GMTSUMX",52,0)
 Q X
"RTN","GMTSUMX",53,0)
LO(X) Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX",54,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSUMX",55,0)
MX(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX",56,0)
LD(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$E(X,2,$L(X))
"RTN","GMTSUMX",57,0)
TRIM(X) S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSUMX",58,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSUMX",59,0)
 Q X
"RTN","GMTSUMX",60,0)
CHK ;
"RTN","GMTSUMX",61,0)
 N GMTSIEN S GMTSIEN=0 F  S GMTSIEN=$O(^GMT(142,GMTSIEN)) Q:+GMTSIEN=0  D
"RTN","GMTSUMX",62,0)
 . N GMTSTXT S GMTSTXT=$P($G(^GMT(142,GMTSIEN,0)),"^",1)
"RTN","GMTSUMX",63,0)
 . I $L(GMTSTXT) W !!,GMTSTXT,!,$$EN^GMTSUMX(GMTSTXT)
"RTN","GMTSUMX",64,0)
 Q
"RTN","GMTSUMX2")
0^5^B70515223
"RTN","GMTSUMX2",1,0)
GMTSUMX2 ; SLC/KER - Convert Text to Mix Case (1-4) ; 04/19/1999
"RTN","GMTSUMX2",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSUMX2",3,0)
 ;         
"RTN","GMTSUMX2",4,0)
1 I "^B^C^D^E^F^G^H^I^J^K^M^N^O^P^Q^S^T^U^V^X^Y^Z^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",5,0)
 I "^W^L^R^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",6,0)
 I "^MM^CM^IN^FT^CM^CC^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",7,0)
 Q
"RTN","GMTSUMX2",8,0)
2 ; 2 Characters
"RTN","GMTSUMX2",9,0)
 S J=$G(J)
"RTN","GMTSUMX2",10,0)
 I J'="",J'=" ","^OR^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",11,0)
 S:X="DA" Y="dA" S:X="DC" Y="dC" S:X="DG" Y="dG" S:X="DT" Y="dT" S:X="DU" Y="dU" S:X="GB" Y="gB" S:X="GC" Y="gC" S:X="GH" Y="gH" S:X="KB" Y="kB" Q:$L($G(Y))
"RTN","GMTSUMX2",12,0)
 S:X="KD" Y="kD" S:X="PH" Y="pH" S:X="PX" Y="pX" Q:$L($G(Y))
"RTN","GMTSUMX2",13,0)
 I "^WO^W/^IN^IS^IT^AT^OR^TO^OF^ON^BE^BY^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",14,0)
 I "^DG^DI^DS^EC^EN^ES^FB^FH^HL^IB^LA^LR^MC^NS^OR^PX^RA^RG^RT^SD^SR^SW^VA^WV^XH^XM^XT^XU^YS^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",15,0)
 I "^BA^BT^CD^CH^CM^CN^CP^CR^CY^BW^7S^OL^CA^MC^EP^II^RO^ZP^ZY^SH^ES^MF^GP^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",16,0)
 I "^CW^DD^DI^DS^EM^HF^IM^LH^LO^OD^OE^PN^RI^RP^RS^SP^SR^ST^SW^TP^TR^TS^VS^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",17,0)
 I "^ST^"[X S Y=$$MX(X) Q
"RTN","GMTSUMX2",18,0)
 I "^EP^AA^AB^AC^AD^AF^AG^AH^AP^AR^AV^BA^BB^BC^BE^BG^BH^BK^BL^BM^BP^BR^BS^BW^CA^CB^CD^CE^CF^CG^CH^CI^CK^CL^CO^CP^CR^CS^CT^CV^DB^DD^DL^DM^DN^DP^DQ^DR^EA^EB^EC^EF^EM^EO^EP^ET^FA^FD^FK^FR^FU^GA^GI^GL^GP^GR^GS^GT^HA^HB^HC^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",19,0)
 I "^HC^HL^HO^HP^HR^HS^HT^HU^HX^IA^IB^IE^IF^II^IL^IP^IV^IX^KO^KS^LA^LD^LE^LF^LH^LL^LR^LY^MA^MB^MC^ME^MF^MI^MK^MP^MR^MS^MT^NA^NB^NF^NG^NH^NK^NL^NP^NS^NT^OC^OD^OH^OP^OX^PA^PC^PD^PE^PF^PG^PI^PK^PL^PM^PP^PR^PS^PT^PZ^RA^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",20,0)
 I "^RA^RC^RF^RH^RI^RP^RR^RS^RX^SA^SB^SC^SD^SE^SF^SG^SH^SI^SK^SL^SM^SP^SR^SS^SV^TA^TB^TC^TF^TH^TI^TK^TL^TP^TT^UK^UV^VA^VC^VH^VI^VO^VP^VZ^WB^WS^XI^YM^YY^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",21,0)
 I "^AN^AS^AT^BY^CM^DE^IN^MG^NO^OF^ON^OR^SQ^TO^UP^YL^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",22,0)
 Q
"RTN","GMTSUMX2",23,0)
3 ; 3 Characters
"RTN","GMTSUMX2",24,0)
 S:X="BRZ" Y="BrZ" S:X="COA" Y="CoA" S:X="COM" Y="CoM" S:X="EIF" Y="eIF" S:X="HGH" Y="hGH" S:X="HPR" Y="HPr" S:X="IGA" Y="IgA" S:X="IGD" Y="IgD" S:X="IGE" Y="IgE" Q:$L($G(Y))
"RTN","GMTSUMX2",25,0)
 S:X="IGG" Y="IgG" S:X="IGM" Y="IgM" S:X="IIB" Y="IIb" S:X="KDA" Y="kDa" S:X="MEC" Y="MeC" S:X="MEO" Y="MeO" S:X="NAC" Y="NAc" S:X="NIA" Y="NIa" S:X="OET" Y="OEt" Q:$L($G(Y))
"RTN","GMTSUMX2",26,0)
 S:X="OME" Y="OMe" S:X="PNA" Y="pNA" S:X="PRP" Y="PrP" S:X="SMB" Y="SmB" S:X="VPG" Y="VPg" Q:$L($G(Y))
"RTN","GMTSUMX2",27,0)
 I "^APR^AUG^BAY^FEB^HOT^JAN^JCT^JUL^JUN^LAS^LOS^MAR^MAY^MTN^NEW^NOV^OCT^OUT^SAN^SEP^SKY^"[X S Y=$$MX(X) Q
"RTN","GMTSUMX2",28,0)
 I "^ALL^AND^ARE^BUT^SET^NOW^ANY^HAD^DUE^MED^TOO^FAR^OWN^ITS^HIM^OUR^HIS^HER^NEW^LOW^ITS^MAY^HOW^OUT^WAS^W/O^FOR^NOT^THE^CAN^PUT^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",29,0)
 I "^ADC^ADR^ADT^BDS^BLO^BPN^BSR^CRS^OER^OEX^CVF^CVP^DCS^DEM^EDL^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",30,0)
 I "^MIC^NSR^NTM^OPC^ORC^PLA^PLI^PLL^PRC^SCD^SHF^SLT^SPN^SRI^SRO^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",31,0)
 I "^SVS^VSO^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",32,0)
 I "^ICU^NOS^NEC^SLC^ISC^A3A^A3F^A7R^DPT^DVB^ECT^ECX^EDR^EEO^GEC^IBD^IBJ^CPT^ICD^IMR^IVM^LA7^LEX^LRS^LRX^MC2^MPR^NUR^PCE^ORA^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",33,0)
 I "^NLM^DIC^DIR^DIK^XMB^ORB^PRC^PRS^PSA^PSD^PSG^PSJ^PSN^PSO^PSS^PSU^PSX^QAC^QAM^QAN^QAO^QAP^QAQ^QAR^QIE^QIP^RTY^SPN^TIU^USR^VAQ^VON^XPD^XUC^XWB^YSA^ZDG^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",34,0)
 I "^ABA^ABC^ABO^ABP^ACE^ACP^ADA^ADH^ADV^ADP^AFO^AII^ALS^AMC^AMP^ANF^ANP^ASA^ATF^ATP^ATX^AVP^AVT^AZT^BAM^BCG^BCP^BDB^BDS^BIM^BLS^BMP^BNP^BOC^BPV^BRL^BSA^BSP^CAD^CAF^CAM^CAP^CAT^CAZ^CBC^CBZ^CCK^CDP^CDR^CEA^CEF^CFA^CGP^CGS^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",35,0)
 I "^CGS^CHO^CMC^CMF^CMP^CMV^CNP^CNS^CPE^CPK^CRF^CRH^CSF^CTP^CYT^DAB^DAP^DAT^DBP^DDE^DDT^DFA^DHP^DIP^DJD^DME^DNA^DNP^DTP^EAP^EBP^EBV^ECE^ECG^EEE^EEG^EGF^EHV^EIA^EKG^EMD^EMG^EMS^ENA^ENK^FAC^FAD^FAP^FDA^FDP^FGF^FMN^FSH^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",36,0)
 I "^FSH^FSP^FTC^GAP^GDP^GLP^GMP^GPC^GPD^GRF^GRP^GSH^GTH^GTP^GVP^HBP^HCG^HCL^HCO^HCT^HCV^HDL^HFO^HHV^HIB^HIV^HLA^HLH^HMG^HNF^HNP^HOE^HPA^HPC^HPV^HRP^HSA^HSV^IAA^ICI^ICP^IDA^IFN^IGF^IIA^III^IMP^ITF^IUD^JMV^KAP^KLH^LAI^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",37,0)
 I "^LAI^LAP^LAV^LDH^LDL^LPH^LSD^LSO^MAA^MAM^MAP^MBP^MCA^MCP^MDL^MDP^MDV^MEA^MEN^MEP^MHC^MIF^MIP^MPA^MPS^MRA^MRC^MRI^MRP^MSA^MSH^MTP^NAD^NAG^NAP^NBD^NCA^NCS^NEC^NGF^NHE^NKA^NMN^NOS^NPY^NSC^NYU^OMP^OMT^ORF^OTF^PAF^PAL^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",38,0)
 I "^PAL^PAP^PAS^PBP^PCA^PCP^PEG^PEP^PET^PHA^PIP^PIV^PKI^PLP^POC^PPD^PPP^PRV^PSA^PSP^PTB^PTC^PTH^PTT^PTX^RAB^RAG^RAP^RBC^RBP^RGD^RII^RMI^RNA^RNP^RSV^SAA^SAM^SAP^SCP^SDZ^SEO^SER^SFV^SHV^SIV^SKF^SKN^SMP^SOD^SOS^SPM^SRV^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",39,0)
 I "^RAS^SRV^STP^TAG^TAP^TCF^TCP^TDP^TEF^TEM^TFA^TGF^TMV^TNF^TNP^TPA^TPN^TRH^TRP^TSA^TSH^TTP^TTR^UDP^UMP^URO^USF^UTP^VII^VIP^VLA^VSG^VZV^WBC^WGA^WHO^XII^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",40,0)
 I "^MAA^MPP^NEC^NOS^ZTA^CPD^R/O^MDA^3MC^ACP^SLC^ISC^III^ATP^CMP^AAF^APV^LSD^PCP^HTP^RNA^DNA^ISC^NLM^IMP^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",41,0)
 I "^ONE^TWO^SIX^TEN^AND^ANY^BIS^BUT^CIS^DES^DUE^FOR^NON^NOT^OXO^PER^PRE^PRO^PSI^THE^USE^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",42,0)
 Q
"RTN","GMTSUMX2",43,0)
4 ; 4 Characters
"RTN","GMTSUMX2",44,0)
 S:X="APOA" Y="ApoA" S:X="BBVI" Y="BbvI" S:X="BPTH" Y="bPTH" S:X="BSUE" Y="BsuE" S:X="CAMP" Y="cAMP" S:X="CGMP" Y="cGMP" S:X="COTE" Y="CotE" S:X="DATP" Y="dATP" Q:$L($G(Y))
"RTN","GMTSUMX2",45,0)
 S:X="DCMP" Y="dCMP" S:X="DCTP" Y="dCTP" S:X="DGMP" Y="dGMP" S:X="DGTP" Y="dGTP" S:X="DSBA" Y="dsbA" S:X="DTDP" Y="dTDP" S:X="DTTP" Y="dTTP" S:X="DUMP" Y="dUMP" Q:$L($G(Y))
"RTN","GMTSUMX2",46,0)
 S:X="DURD" Y="dUrd" S:X="DUTP" Y="dUTP" S:X="ECAI" Y="EcaI" S:X="ECOK" Y="EcoK" S:X="ERBB" Y="erbB" S:X="FELV" Y="FeLV" S:X="FMET" Y="fMet" S:X="GNRH" Y="GnRH" Q:$L($G(Y))
"RTN","GMTSUMX2",47,0)
 S:X="GPII" Y="gpII" S:X="HARG" Y="hArg" S:X="HELA" Y="HeLa" S:X="HGRF" Y="hGRF" S:X="HHAI" Y="HhaI" S:X="HPAI" Y="HpaI" S:X="HPTH" Y="hPTH" S:X="IIIA" Y="IIIa" Q:$L($G(Y))
"RTN","GMTSUMX2",48,0)
 S:X="KPNI" Y="KpnI" S:X="MCRB" Y="McrB" S:X="MESH" Y="MeSH" S:X="MRNA" Y="mRNA" S:X="NHET" Y="NHEt" S:X="NHME" Y="NHMe" S:X="OBZL" Y="OBzl" S:X="OTBU" Y="OtBu" Q:$L($G(Y))
"RTN","GMTSUMX2",49,0)
 S:X="PGLU" Y="pGlu" S:X="PSTI" Y="PstI" S:X="REGA" Y="regA" S:X="RRNA" Y="rRNA" S:X="SCEI" Y="SceI" S:X="TAQI" Y="TaqI" S:X="TRFA" Y="TrfA" S:X="TRKA" Y="trkA" Q:$L($G(Y))
"RTN","GMTSUMX2",50,0)
 S:X="TRKB" Y="trkB" S:X="TRNA" Y="tRNA" Q:$L($G(Y))
"RTN","GMTSUMX2",51,0)
 I "^BATH^CITH^CITY^EAST^ERIE^FORT^HOME^IOWA^IRON^JUAN^JULY^JUNE^LAKE^LOMA^LONG^LYON^PALM^PALO^PARK^RENO^ROCK^SALT^SIDE^WACO^WEST^YORK^"[X S Y=$$MX(X) Q
"RTN","GMTSUMX2",52,0)
 I "^BADR^BDEM^BMIC^EADT^MAGI^MEDA^MEDB^MEDC^MEDF^MHPE^RXIV^RXOP^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",53,0)
 I "^RXUD^SCL1^SCL2^SCL3^SCL4^SCLU^SNSR^SVSO^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",54,0)
 I "^^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",55,0)
 I "^^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",56,0)
 I "^A1B5^A1BG^A4A7^A4A8^A6K7^ABSV^ACKQ^DENT^DGHI^DGPW^DGY1^DGY3^DGYA^DGYB^DGYC^DGYD^DGYF^DGYG^DGYJ^DGYK^DGYL^DGYN^DGYO^DGYP^DGYQ^DGYR^DGYS^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",57,0)
 I "^DGYU^DGYV^DGYW^DGYX^DGYZ^DIPK^DVBA^DVBC^DVBQ^DVBT^DVBU^DVBW^DVBX^DVBY^EEOA^EEOP^ENXE^ENXF^ENXG^ENXI^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",58,0)
 I "^ENXJ^ENXK^FBAA^GECD^GECP^GECS^GMAA^GMD1^GMN1^GMN2^GMN3^GMN4^GMN5^GMPL^GMPT^GMRA^GMRC^GMRD^GMRE^GMRG"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",59,0)
 I "^GMRP^GMRQ^GMRR^GMRS^GMRV^GMRY^GMTS^HBHC^IBDE^IBDP^IBQL^IBQY^IBY3^IBY4^IBY5^IBY6^IBY7^IBY8^IBY9^IBYA^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",60,0)
 I "^IBYB^IBYC^IBYD^IBYE^IBYF^IBYG^IBYH^IBYK^IBYL^IBYN^ICPT^LBRN^LBRT^LBRY^LR00^LR01^LR03^LRAR^LRLS^MCXX^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",61,0)
 I "^NURA^NURC^NURE^NURQ^NURX^ONCO^PRCA^PRCP^PRMQ^PRPF^PRSX^PRX0^PRX1^PRX8^PRXB^PRXC^PRXE^PRXF^PRXG^PRXI^PRXJ^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",62,0)
 I "^PRXK^PRXP^PRYA^PRYB^PRYC^PRYD^PRYF^PRYH^PRYJ^PRYL^PRYN^PRYP^PSA1^PSD1^PSGW^PSIV^PSJ1^PSJ4^PSOA^PSOB^PSOC^PSOD^PSOE^PSOG^PSOH^PSOJ^PSOL^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",63,0)
 I "^PSOY^PSW1^PSXC^QAN1^QAR1^QAR2^QARF^QARY^RAAA^RAAB^RAAC^RAAE^RAAF^RMPC^RMPF^RMPJ^RMPR^RMPT^RTYB^RTYC^RTYD^SDYA^SDYM^SDYN^SDYP^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",64,0)
 I "^SOWA^SOWC^SOWK^SROA^SRRS^SRRT^TIUJ^TIUW^TIUX^VALM^VEEM^VSIT^XQOR^XUFI^YS01^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",65,0)
 I "^AIDS^ANCA^ARPP^ATLV^BPDE^BUSI^CENP^CGRP^COOH^CPAP^CPEP^DHEA^DMBA^DSIP^DTPA^EBNA^EDTA^ERCC^ERCP^ESRD^FANA^FITC^FKBP^GABA^GATA^GHRH^GLUT^GYKI^HCMV^HIDA^HMSN^HSAN^HTLV^IDDM^INTP^IPPB^KAFO^LATS^LHRH^MAGE^MLVP^MPTP^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",66,0)
 I "^ANIT^CAMP^DOPS^MPTP^HETE^OERR^GMPT^GMPL^MTLU^UMLS^BPDE^DMBA^PABA^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",67,0)
 I "^MPTP^NADH^NADP^NAPS^NETT^NGFI^NRDC^NSCL^PAPS^POMC^PSAP^RTEM^SACH^SGOT^SNAP^SRIF^SRIH^TAPA^TATA^TCDD^TENS^TIMP^TLSO^UDPG^VIII^VLDL^WHFO^XIII^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX2",68,0)
 I "^USED^EACH^FOUR^FIVE^NINE^HOUR^INTO^LESS^LIKE^MORE^ONLY^OPEN^OVER^PART^SITE^THAN^TYPE^WITH^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",69,0)
 I "^BEST^IT'S^LATE^SITE^FROM^SOME^WITH^UPON^THEY^THEN^INTO^MORE^THAN^THAT^THIS^THUS^HAVE^BEEN^NOTE^DONE^MUST^MERE^SURE^KIND^WHEN^WHAT^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",70,0)
 I "^LOST^LIKE^OURS^ALSO^EACH^ONLY^HERE^SUCH^SAME^LESS^AREA^MANY^EVEN^LEFT^MOST^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX2",71,0)
 Q
"RTN","GMTSUMX2",72,0)
 ;          
"RTN","GMTSUMX2",73,0)
LO(X) Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX2",74,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSUMX2",75,0)
MX(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX3")
0^6^B29389559
"RTN","GMTSUMX3",1,0)
GMTSUMX3 ; SLC/KER - Convert Text to Mix Case (5+) ; 04/19/1999
"RTN","GMTSUMX3",2,0)
 ;;2.7;Health Summary;**30**;Oct 20, 1995
"RTN","GMTSUMX3",3,0)
 ;;
"RTN","GMTSUMX3",4,0)
 ;              
"RTN","GMTSUMX3",5,0)
5 ; 5 Characters
"RTN","GMTSUMX3",6,0)
 S:X="CAMPS" Y="cAMPS" S:X="CVIBI" Y="CviBI" S:X="DNASE" Y="DNase" S:X="ECORI" Y="EcoRI" S:X="GROEL" Y="GroEL" S:X="HAEII" Y="HaeII" S:X="HBSAG" Y="HBsAg" Q:$L($G(Y))
"RTN","GMTSUMX3",7,0)
 S:X="HINFI" Y="HinfI" S:X="HNRNP" Y="hnRNP" S:X="HPAII" Y="HpaII" S:X="HPGRF" Y="hpGRF" S:X="MBOII" Y="MboII" S:X="MELEU" Y="MeLeu" S:X="MEPHE" Y="MePhe" Q:$L($G(Y))
"RTN","GMTSUMX3",8,0)
 S:X="MEPRO" Y="MePro" S:X="NEUAC" Y="NeuAc" S:X="PTHRP" Y="PTHrP" S:X="RNASE" Y="RNase" S:X="SALGI" Y="SalGI" S:X="SNRNP" Y="snRNP" Q:$L($G(Y))
"RTN","GMTSUMX3",9,0)
 I "^APRIL^ARBOR^BARRE^BEACH^BLACK^BLUFF^BRONX^CLOUD^CREEK^DIEGO^DRIVE^FALLS^FARGO^GOISE^GRAND^HAVEN^HILLS^HINES^JUNCT^LINDA^LOUIS^LYONS^MARCH^MEADE^MIAMI^MILES^NORTH^OMAHA^PASSO^PERRY^PINES^PITTS^POINT^PUGET^RIVER^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",10,0)
 I "^RIVER^SAINT^SALEM^SIOUX^SOUND^SOUTH^TAMPA^TEXAS^TOGUS^TOMAH^VEGAS^WALLA^WAYNE^WHITE^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",11,0)
 I "^CALLA^CCAAT^CTLSO^DPDPE^HKAFO^IGFBP^NADPH^NIDDM^PACAP^SAIDS^SPECT^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX3",12,0)
 I "^DOPAC^ZPACK^"[X S Y=$$UP(X) Q
"RTN","GMTSUMX3",13,0)
 I "^ACUTE^BELOW^FIRST^FOUND^HOURS^LOWER^MAJOR^OTHER^SITES^STATE^THIRD^THREE^UPPER^"[$$UP(X) S Y=$$LO(X) Q
"RTN","GMTSUMX3",14,0)
 I "^GIVEN^FORTH^THESE^WHERE^OFTEN^AFTER^RIGHT^WOULD^COULD^OUTER^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",15,0)
 Q
"RTN","GMTSUMX3",16,0)
6 ; 6 Characters
"RTN","GMTSUMX3",17,0)
 S:X="DESGLY" Y="desGly" S:X="ECORII" Y="EcoRII" S:X="GALNAC" Y="GalNAc" S:X="GLCNAC" Y="GlcNAc" S:X="GTPASE" Y="GTPase" S:X="LEFORT" Y="LeFort" S:X="MURNAC" Y="MurNAc" Q:$L($G(Y))
"RTN","GMTSUMX3",18,0)
 S:X="PTDINS" Y="PtdIns" S:X="STYLTI" Y="StyLTI" S:X="UVRABC" Y="uvrABC" Q:$L($G(Y))
"RTN","GMTSUMX3",19,0)
 I "^ANGLES^AUGUST^BATTLE^BILOXI^BONHAM^BOSTON^BUTLER^CASTLE^CLINIC^DALLAS^DAYTON^DENVER^DUBLIN^DURHAM^FRESNO^HEALTH^HGHLND^HOWARD^HUDSON^ISLAND^JERSEY^KANSAS^LESSER^LITTLE^MANILA^MARION^MARLIN^MOINES^ORANGE^POPLAR^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",20,0)
 I "^POPLAR^SPRING^TACOMA^TEMPLE^TOPEKA^TUCSON^VALLEY^WILKES^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",21,0)
 I "^PEPPTS^"[$$UP(X) S Y=$$UP(X) Q
"RTN","GMTSUMX3",22,0)
 I "^CLOSED^CYCLIC^DEGREE^DEVICE^DURING^EFFECT^EXCEPT^FACTOR^LENGTH^"[$$UP(X) S Y=$$LO(X) Q
"RTN","GMTSUMX3",23,0)
 I "^MOLDED^BEFORE^ITSELF^WITHIN^REGION^RETURN^SECOND^SINGLE^"[$$UP(X) S Y=$$LO(X) Q
"RTN","GMTSUMX3",24,0)
 Q
"RTN","GMTSUMX3",25,0)
7 ; 7 Characters
"RTN","GMTSUMX3",26,0)
 I "^ALTOONA^ANTONIO^ATLANTA^AUGUSTA^BATAVIA^BECKLEY^BEDFORD^BUFFALO^CENTRAL^CHICAGO^EASTERN^FLORIDA^GEORGIA^GREATER^HAMPTON^HOUSTON^JACKSON^JANUARY^LEBANON^LINCOLN^MADISON^MEMPHIS^OCTOBER^ORLEANS^PATIENT^PHOENIX^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",27,0)
 I "^PHOENIX^SAGINAW^SEATTLE^SPOKANE^SPRINGS^WESTERN^WICHITA^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",28,0)
 I "^EFFECTS^BETWEEN^ONESELF^HERSELF^HIMSELF^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",29,0)
 I "^ANOTHER^THEREBY^WITHOUT^MENTION^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",30,0)
 Q
"RTN","GMTSUMX3",31,0)
8 ; 8 Characters
"RTN","GMTSUMX3",32,0)
 I "^BROCKTON^BROOKLYN^CHEYENNE^COLUMBIA^COLUMBUS^DANVILLE^DECEMBER^FAYETTVL^FEBRUARY^HARRISON^HIGHLAND^HONOLULU^JUNCTION^MARTINEZ^MARYLAND^MONTROSE^MOUNTAIN^MOUNTIAN^MUSKOGEE^NEBRASKA^NORTHERN^OKLAHOMA^PORTLAND^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",33,0)
 I "^PORTLAND^PRESCOTT^RICHMOND^ROSEBURG^SHERIDAN^SOUTHERN^SYRACUSE^TUSKEGEE^VETERANS^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",34,0)
 I "^ALTHOUGH^INJURING^INCLUDES^EXCLUDES^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",35,0)
 Q
"RTN","GMTSUMX3",36,0)
9 ; 9 Characters
"RTN","GMTSUMX3",37,0)
 I "^ASHEVILLE^BALTIMORE^CLEVELAND^FRANCISCO^KERRVILLE^KNOXVILLE^LEXINGTON^LIVERMORE^MILWAUKEE^NASHVILLE^NEWINGTON^NORTHPORT^SALISBURY^SEPTEMBER^SEPULVEDA^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",38,0)
 I "^OTHERWISE^SPECIFIED^INCLUDING^EXCLUDING^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",39,0)
 Q
"RTN","GMTSUMX3",40,0)
M ; 10 or more Characters
"RTN","GMTSUMX3",41,0)
10 S:X="GDPMANNOSE" Y="GDPmannose" S:X="UDPGLUCOSE" Y="UDPglucose" Q:$L($G(Y))
"RTN","GMTSUMX3",42,0)
 I "^BIRMINGHAM^CALIFORNIA^CHARLESTON^CINCINNATI^CLARKSBURG^HEALTHCARE^HUNTINGTON^LOUISVILLE^MANCHESTER^MONTGOMERY^PITTSBURGH^PROVIDENCE^SHREVEPORT^TUSCALOOSA^UNIVERSITY^WASHINGTON^WILMINGTON^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",43,0)
11 I "^CANANDAIGUA^CHILLICOTHE^COATESVILLE^CONNECTICUT^GAINESVILLE^LEAVENWORTH^MARTINSBURG^MINNEAPOLIS^NORTHAMPTON^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",44,0)
 I "^UNSPECIFIED^"[X S Y=$$LO(X) Q
"RTN","GMTSUMX3",45,0)
12 I "^INDIANAPOLIS^MURFREESBORO^PHILADELPHIA^"[$$UP(X) S Y=$$MX(X) Q
"RTN","GMTSUMX3",46,0)
 Q
"RTN","GMTSUMX3",47,0)
 Q
"RTN","GMTSUMX3",48,0)
 ;          
"RTN","GMTSUMX3",49,0)
LO(X) Q $TR(X,"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX3",50,0)
UP(X) Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","GMTSUMX3",51,0)
MX(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$TR($E(X,2,$L(X)),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")
"RTN","GMTSUMX3",52,0)
LD(X) Q $TR($E(X,1),"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")_$E(X,2,$L(X))
"RTN","GMTSUMX3",53,0)
TRIM(X) S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMTSUMX3",54,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMTSUMX3",55,0)
 Q X
"RTN","GMTSUP")
0^25^B16988760
"RTN","GMTSUP",1,0)
GMTSUP ; SLC/JER,KER - Utilities for Paging HS ; 04/19/1999
"RTN","GMTSUP",2,0)
 ;;2.7;Health Summary;**2,7,21,27,28,30**;Oct 20, 1995
"RTN","GMTSUP",3,0)
 ;
"RTN","GMTSUP",4,0)
CKP ; Check page position, pause and prompt
"RTN","GMTSUP",5,0)
 Q:$D(GMTSQIT)
"RTN","GMTSUP",6,0)
 S GMTSNPG=0
"RTN","GMTSUP",7,0)
 I $G(GMTSWRIT)=1 D
"RTN","GMTSUP",8,0)
 . D BREAK
"RTN","GMTSUP",9,0)
 . S GMTSWRIT=0
"RTN","GMTSUP",10,0)
 I IOT="HFS" D BREAK:(GMTSEGN'=$G(GMTSLCMP)) Q
"RTN","GMTSUP",11,0)
 Q:+$G(GMTSLPG)'>0&($Y'>(IOSL-GMTSLO))
"RTN","GMTSUP",12,0)
 I $E(IOST,1)="C" S:'$D(GMTSTOF) GMTSTOF=1 D CKP1
"RTN","GMTSUP",13,0)
 I '$D(GMTSQIT) W @IOF D HEADER,BREAK S GMTSNPG=1,GMTSTOF=GMTSEGN
"RTN","GMTSUP",14,0)
 I $D(GMTSQIT),(GMTSQIT]""),($D(GMTSTYP)) W @IOF D HEADER S GMTSTOF=GMTSEGN
"RTN","GMTSUP",15,0)
 Q
"RTN","GMTSUP",16,0)
CKP1 ;Help Display of Optional Components for Navigation
"RTN","GMTSUP",17,0)
 N DA,I,J,K,L,X,XQORM,Y,GMTSY,TYP,DIC
"RTN","GMTSUP",18,0)
 I $S('$D(GMTSTYP):1,$D(GMTOPT):1,1:0) N DIR S DIR(0)="E" D ^DIR K DIR S:$D(DUOUT)!(GMTSLPG) GMTSQIT="" Q
"RTN","GMTSUP",19,0)
 S TYP=GMTSTYP
"RTN","GMTSUP",20,0)
 S DIC=142,DIC(0)="MZF",X="GMTS HS ADHOC OPTION" S Y=$$TYPE^GMTSULT
"RTN","GMTSUP",21,0)
 S GMTSTYP=+Y K DIC,X,Y
"RTN","GMTSUP",22,0)
 S XQORM=GMTSTYP_";GMT(142,",XQORM(0)="1AF\+",XQORM("A")="Press <RET> to continue, ^ to exit, or select component: "
"RTN","GMTSUP",23,0)
 S XQORM("??")="D HELP^GMTSUP1" I GMTSLPG W "* END * "
"RTN","GMTSUP",24,0)
 S XQORM("S")="I $D(^GMT(142,DA(1),1,DA,0)),($P(^GMT(142.1,$P(^GMT(142,DA(1),1,DA,0),U,2),0),U,6)'=""T"")"
"RTN","GMTSUP",25,0)
 D ^XQORM W ! D @$S(Y=1:"BRNCH",1:"EVAL")
"RTN","GMTSUP",26,0)
 I $D(GMTSY),(GMTSY=0) K GMTSY G CKP1
"RTN","GMTSUP",27,0)
 S GMTSTYP=TYP
"RTN","GMTSUP",28,0)
 Q
"RTN","GMTSUP",29,0)
BREAK ; Writes the component header
"RTN","GMTSUP",30,0)
 S:'$D(GMTSLCMP) GMTSLCMP=0
"RTN","GMTSUP",31,0)
 S GMTS="",GMTSNPG=1,$P(GMTS,"-",79-$L(GMTSEGH_GMTSEGL)/2)="",GMTS=GMTS_" "_GMTSEGH_GMTSEGL_" "_GMTS I $Y'>(IOSL-GMTSLO)!(IOT="HFS") W !,GMTS,! W:$Y'>(IOSL-GMTSLO) ?34,$S(GMTSEGN=GMTSLCMP:"(continued)",1:""),! S GMTSLCMP=GMTSEGN
"RTN","GMTSUP",32,0)
 Q
"RTN","GMTSUP",33,0)
HEADER ; Print Running Header
"RTN","GMTSUP",34,0)
 N GMTSVDT,DATA
"RTN","GMTSUP",35,0)
 ; GMTSCDT(0) may contain multiple dates that could cause a line to
"RTN","GMTSUP",36,0)
 ; wrap inappropriately. If this creates a problem, a change will be
"RTN","GMTSUP",37,0)
 ; required to accommodate it.
"RTN","GMTSUP",38,0)
 S DATA=""
"RTN","GMTSUP",39,0)
 I +$G(GMTSPXD1)&+$G(GMTSPXD2) D
"RTN","GMTSUP",40,0)
 . S DATA="Printed for data "
"RTN","GMTSUP",41,0)
 . I GMTSPXD1=GMTSPXD2 S DATA=DATA_"on "_GMTSPXD1 Q
"RTN","GMTSUP",42,0)
 . S DATA=DATA_"from "_GMTSPXD2_" to "_GMTSPXD1
"RTN","GMTSUP",43,0)
 I $D(GMTSCDT(0)) S GMTSVDT=GMTSCDT(0) S:GMTSDTM'["Printed:" GMTSDTM="Printed: "_GMTSDTM
"RTN","GMTSUP",44,0)
 W !,$S($L($P($G(GMTSSC),U,2)):"Location: "_$P(GMTSSC,U,2)_" ",1:""),$S($D(GMTSVDT):GMTSVDT,1:""),DATA,?(79-$L(GMTSDTM)),GMTSDTM
"RTN","GMTSUP",45,0)
 S:'$D(GMTSPG) GMTSPG=0 S GMTSPG=GMTSPG+1,GMTSHDR=" CONFIDENTIAL "_GMTSTITL_" SUMMARY "_$S($E(IOST,1)="C":"",1:"  pg. "_GMTSPG) S GMTS="",$P(GMTS,"*",(77-$L(GMTSHDR))\2)="*" S GMTSHDR=GMTS_" "_GMTSHDR_" "_GMTS
"RTN","GMTSUP",46,0)
 W !,GMTSHDR,"*"
"RTN","GMTSUP",47,0)
 I '$D(GMTSLFG) D
"RTN","GMTSUP",48,0)
 . ;GMTSPHDR (patient header) is setup in DEM^GMTSU.
"RTN","GMTSUP",49,0)
 . I $G(GMTSPHDR("TWO")) D
"RTN","GMTSUP",50,0)
 .. W !,GMTSPHDR("NMSSN"),?GMTSPHDR("DOBS"),GMTSPHDR("DOB"),!?GMTSPHDR("WARDRBS"),GMTSPHDR("WARDRB"),!
"RTN","GMTSUP",51,0)
 . E  W !,GMTSPHDR("NMSSN"),?GMTSPHDR("WARDRBS"),GMTSPHDR("WARDRB"),?GMTSPHDR("DOBS"),GMTSPHDR("DOB"),!
"RTN","GMTSUP",52,0)
 W:+$G(VADM(6)) ?26,"** DECEASED   "_$P(VADM(6),U,2)_" **"
"RTN","GMTSUP",53,0)
 Q
"RTN","GMTSUP",54,0)
BRNCH ;Checks for appropriate abbreviation to branch to a different component
"RTN","GMTSUP",55,0)
 N GMTINX,LIM,CREC,SBS
"RTN","GMTSUP",56,0)
 I Y,("+-"[X) S:X="-" GMTSEGN=GMTSTOF-1 S (GMTSY,GMTSQIT)=1,GMTSLPG=0 Q
"RTN","GMTSUP",57,0)
 I X="^^" S DIROUT=1,GMTSQIT="" Q
"RTN","GMTSUP",58,0)
 I Y,(X?1"^^".E) D  Q
"RTN","GMTSUP",59,0)
 .N GMTSAV
"RTN","GMTSUP",60,0)
 .S GMTSAV=X D RJUMP^GMTSUP1
"RTN","GMTSUP",61,0)
 .I GMTSAV'["?" S (GMTSQIT,GMTSY)=1,GMTSEGN=GMTSTOF-1,GMTSLPG=0
"RTN","GMTSUP",62,0)
 .E  S GMTSY=0
"RTN","GMTSUP",63,0)
 S GMTINX=$S($D(^GMT(142,GMTSTYP,1,+Y(1),0)):$P(^(0),U,2),1:"")
"RTN","GMTSUP",64,0)
 I 'GMTINX S GMTSY=0 Q
"RTN","GMTSUP",65,0)
 I '$D(GMTSEGI(GMTINX)) N GMI,GMJ,GMTSDFLT S GMI=1,GMJ=GMTSEGC,GMTSDFLT=1 D LOAD^GMTSADH S GMTSEGC=GMTSEGC+1
"RTN","GMTSUP",66,0)
 I '$D(GMTSEGI(GMTINX)) S GMTINX="",GMTSY=0 Q
"RTN","GMTSUP",67,0)
 S LIM=$P(Y(1),U,4) I LIM'["=" G NOLIM
"RTN","GMTSUP",68,0)
 S CREC=^GMT(142.1,GMTINX,0),SBS=GMTSEGI(GMTINX) D CMPLIM^GMTSADH2
"RTN","GMTSUP",69,0)
 I $D(DIROUT) S GMTSQIT="" Q
"RTN","GMTSUP",70,0)
NOLIM S GMTSEGN=GMTSEGI(GMTINX)-1,(GMTSY,GMTSQIT)=1,GMTSLPG=0
"RTN","GMTSUP",71,0)
 Q
"RTN","GMTSUP",72,0)
 ;
"RTN","GMTSUP",73,0)
EVAL ; Evaluate input to determine quit or continue
"RTN","GMTSUP",74,0)
 Q:'$D(X)
"RTN","GMTSUP",75,0)
 S:$D(DTOUT) DIROUT=1 I $S(X="^^":1,GMTSLPG:1,$D(DIROUT):1,X="^":1,1:0) S GMTSQIT=""
"RTN","GMTSUP",76,0)
 I +$G(GMPSAP),(X="^") S GMDUOUT=1
"RTN","GMTSUP",77,0)
 Q
"VER")
8.0^21.0
"^DD",142,142,0)
FIELD^^99^9
"^DD",142,142,0,"DDA")
N
"^DD",142,142,0,"DT")
2950119
"^DD",142,142,0,"IX","AB",142,.01)

"^DD",142,142,0,"IX","AE",142.01,1)

"^DD",142,142,0,"IX","AM",142,99)

"^DD",142,142,0,"IX","AW",142,.01)

"^DD",142,142,0,"IX","AW2",142,.02)

"^DD",142,142,0,"IX","AW3",142.2,.01)

"^DD",142,142,0,"IX","AWO",142,.06)

"^DD",142,142,0,"IX","B",142,.01)

"^DD",142,142,0,"IX","C",142,.06)

"^DD",142,142,0,"IX","D",142.2,.01)

"^DD",142,142,0,"IX","E",142,.02)

"^DD",142,142,0,"NM","HEALTH SUMMARY TYPE")

"^DD",142,142,0,"PT",43,43)

"^DD",142,142,0,"PT",71,13)

"^DD",142,142,0,"PT",350.9,2.08)

"^DD",142,142,0,"PT",350.9,2.09)

"^DD",142,142,0,"PT",357.6,.11)

"^DD",142,142,0,"PT",358.6,.11)

"^DD",142,142,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",142,142,.01,1,0)
^.1
"^DD",142,142,.01,1,1,0)
142^B
"^DD",142,142,.01,1,1,1)
S ^GMT(142,"B",$E(X,1,30),DA)=""
"^DD",142,142,.01,1,1,2)
K ^GMT(142,"B",$E(X,1,30),DA)
"^DD",142,142,.01,1,1,"%D",0)
^^2^2^2950731^^
"^DD",142,142,.01,1,1,"%D",1,0)
This REGULAR "B" cross-reference is used for Health Summary Type look-up
"^DD",142,142,.01,1,1,"%D",2,0)
by name.
"^DD",142,142,.01,1,2,0)
142^AW^MUMPS
"^DD",142,142,.01,1,2,1)
D STNT^GMTSUIX
"^DD",142,142,.01,1,2,2)
D KTNT^GMTSUIX
"^DD",142,142,.01,1,2,"DT")
2981214
"^DD",142,142,.01,1,3,0)
142^AB^MUMPS
"^DD",142,142,.01,1,3,1)
S ^GMT(142,"AB",$$UP^XLFSTR($E(X,1,30)),DA)=""
"^DD",142,142,.01,1,3,2)
K ^GMT(142,"AB",$$UP^XLFSTR($E(X,1,30)),DA)
"^DD",142,142,.01,1,3,"%D",0)
^^3^3^2990201^
"^DD",142,142,.01,1,3,"%D",1,0)
^GMT(142,"AB",UP,IEN) - Where UP is an uppercase version of the Health 
"^DD",142,142,.01,1,3,"%D",2,0)
Summary Type and IEN is the location where the Health Summary Type is 
"^DD",142,142,.01,1,3,"%D",3,0)
stored.
"^DD",142,142,.01,1,3,"DT")
2990201
"^DD",142,142,.01,3)
Answer must be 3-30 characters in length.
"^DD",142,142,.01,21,0)
^^7^7^2950728^^^^
"^DD",142,142,.01,21,1,0)
Enter the NAME of the Health Summary Type.  This name will appear
"^DD",142,142,.01,21,2,0)
in the health summary header.  The word "CONFIDENTIAL" will appear
"^DD",142,142,.01,21,3,0)
in front of this name and the word "SUMMARY" will appear at the end
"^DD",142,142,.01,21,4,0)
to complete the header.  For example:
"^DD",142,142,.01,21,5,0)
 
"^DD",142,142,.01,21,6,0)
    Name entered: ICU
"^DD",142,142,.01,21,7,0)
Generated header: CONFIDENTIAL ICU SUMMARY
"^DD",142,142,.01,"DEL",1,0)
I $P(^GMT(142,DA,0),U,4)="Y" W $C(7),!,"CANNOT DELETE THIS HEALTH SUMMARY TYPE!!  IT IS USED BY THE AD HOC OPTION"
"^DD",142,142,.01,"DT")
2990201
"^DD",142,142,.02,0)
TITLE^F^^T;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<3) X
"^DD",142,142,.02,1,0)
^.1
"^DD",142,142,.02,1,1,0)
142^E
"^DD",142,142,.02,1,1,1)
S ^GMT(142,"E",$E(X,1,30),DA)=""
"^DD",142,142,.02,1,1,2)
K ^GMT(142,"E",$E(X,1,30),DA)
"^DD",142,142,.02,1,1,"%D",0)
^^2^2^2920227^
"^DD",142,142,.02,1,1,"%D",1,0)
This whole-file, regular FileMan cross-reference is used for look-ups
"^DD",142,142,.02,1,1,"%D",2,0)
of Health Summary Types by TITLE.
"^DD",142,142,.02,1,2,0)
142^AW2^MUMPS
"^DD",142,142,.02,1,2,1)
D STNT^GMTSUIX
"^DD",142,142,.02,1,2,2)
D KTNT^GMTSUIX
"^DD",142,142,.02,1,2,"DT")
2981214
"^DD",142,142,.02,3)
ANSWER MUST BE 3-30 CHARACTERS IN LENGTH
"^DD",142,142,.02,21,0)
5^^7^7^2920928^^^^
"^DD",142,142,.02,21,1,0)
Enter the TITLE only if you wish to replace NAME with title in the health
"^DD",142,142,.02,21,2,0)
summary header.  For Example:
"^DD",142,142,.02,21,3,0)
 
"^DD",142,142,.02,21,4,0)
    Name entered: ICU
"^DD",142,142,.02,21,5,0)
   Title entered: INTENSIVE CARE UNIT
"^DD",142,142,.02,21,6,0)
Generated header: CONFIDENTIAL INTENSIVE CARE UNIT SUMMARY
"^DD",142,142,.02,21,7,0)
 
"^DD",142,142,.02,"DT")
2981214
"^DD",142,142,.05,0)
LOCK^FX^^0;2^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>30!($L(X)<1) X I $D(X) Q:$D(^DIC(19.1,"B",X))  W !,$C(7),"Lock name must match exactly with a key in the SECURITY KEY file." K X
"^DD",142,142,.05,3)
Enter the name of the security key required to modify this summary type
"^DD",142,142,.05,21,0)
^^9^9^2950731^^^^
"^DD",142,142,.05,21,1,0)
When a Health Summary Type contains a Lock, edit access is normally
"^DD",142,142,.05,21,2,0)
restricted to persons who hold a security key in the SECURITY KEY
"^DD",142,142,.05,21,3,0)
file which is the same as the Lock value. If a Health Summary Type
"^DD",142,142,.05,21,4,0)
contains a Lock, users who hold that security key are NOT restricted
"^DD",142,142,.05,21,5,0)
by Ownership. A holder of the GMTSMGR security key is NOT restricted
"^DD",142,142,.05,21,6,0)
by Locks or Ownership.
"^DD",142,142,.05,21,7,0)
 
"^DD",142,142,.05,21,8,0)
NOTE: Generic Health Summary Types issued with the Health Summary
"^DD",142,142,.05,21,9,0)
package contain the Lock GMTSMGR.
"^DD",142,142,.05,"DT")
2950731
"^DD",142,142,.06,0)
OWNER^P200'^VA(200,^0;3^Q
"^DD",142,142,.06,1,0)
^.1
"^DD",142,142,.06,1,1,0)
142^C
"^DD",142,142,.06,1,1,1)
S ^GMT(142,"C",$E(X,1,30),DA)=""
"^DD",142,142,.06,1,1,2)
K ^GMT(142,"C",$E(X,1,30),DA)
"^DD",142,142,.06,1,1,"%D",0)
^^2^2^2920227^
"^DD",142,142,.06,1,1,"%D",1,0)
This whole-file, regular FileMan cross-reference is used by the Health
"^DD",142,142,.06,1,1,"%D",2,0)
Summary Type selection to look-up summary types by OWNER.
"^DD",142,142,.06,1,2,0)
142^AWO^MUMPS
"^DD",142,142,.06,1,2,1)
D STO^GMTSUIX
"^DD",142,142,.06,1,2,2)
D KTO^GMTSUIX
"^DD",142,142,.06,1,2,"DT")
2990422
"^DD",142,142,.06,21,0)
15^^14^14^2950728^^
"^DD",142,142,.06,21,1,0)
Edit access to each health summary type is normally restricted to
"^DD",142,142,.06,21,2,0)
its Owner.
"^DD",142,142,.06,21,3,0)
 
"^DD",142,142,.06,21,4,0)
Exception 1: Holders of the GMTSMGR security key are NOT restricted
"^DD",142,142,.06,21,5,0)
             by Ownership.
"^DD",142,142,.06,21,6,0)
 
"^DD",142,142,.06,21,7,0)
Exception 2: If a health summary type contains a lock, users who hold
"^DD",142,142,.06,21,8,0)
             that lock key are NOT restricted by Ownership.
"^DD",142,142,.06,21,9,0)
 
"^DD",142,142,.06,21,10,0)
NOTE: When a new health summary type is created, the creator's entry
"^DD",142,142,.06,21,11,0)
number in the new Person File is AUTOMATICALLY entered as Owner unless
"^DD",142,142,.06,21,12,0)
the creator holds the GMTSMGR security key.  A creator who holds the
"^DD",142,142,.06,21,13,0)
GMTSMGR key may enter an Owner (IFN from new Person file) of his/her
"^DD",142,142,.06,21,14,0)
choice.
"^DD",142,142,.06,"DT")
2990422
"^DD",142,142,.07,0)
RESTRICT DELETION^SI^Y:YES;^0;4^Q
"^DD",142,142,.07,21,0)
^^3^3^2920914^
"^DD",142,142,.07,21,1,0)
This field is referred to by the Create/Modify and Delete Health Summary
"^DD",142,142,.07,21,2,0)
Type options for the screening of certain summary types (esp., GMTS HS
"^DD",142,142,.07,21,3,0)
ADHOC OPTION) from deletion.
"^DD",142,142,.07,"DT")
2901227
"^DD",142,142,.08,0)
SUPPRESS COMP WITHOUT DATA^S^Y:yes;N:no;^0;5^Q
"^DD",142,142,.08,.1)
SUPPRESS PRINT OF COMPONENTS WITHOUT DATA
"^DD",142,142,.08,21,0)
^^6^6^2950731^^
"^DD",142,142,.08,21,1,0)
This field allows health summary types to be set up to suppress printing
"^DD",142,142,.08,21,2,0)
of components that contain no data when health summaries are printed from
"^DD",142,142,.08,21,3,0)
a device. When health summary types are displayed on the screen,
"^DD",142,142,.08,21,4,0)
components that contain no data will still be displayed with a "No data
"^DD",142,142,.08,21,5,0)
available" message. This is done to eliminate any confusion that may occur
"^DD",142,142,.08,21,6,0)
when jumping between components.
"^DD",142,142,.08,"DT")
2950815
"^DD",142,142,1,0)
STRUCTURE^142.01IA^^1;0
"^DD",142,142,1,21,0)
^^4^4^2950829^^^^
"^DD",142,142,1,21,1,0)
This multiple contains the components to be included in any given health
"^DD",142,142,1,21,2,0)
summary type, along with the time and occurrence limits, selection items
"^DD",142,142,1,21,3,0)
to be used, hospital location displayed, ICD text displayed, and provider
"^DD",142,142,1,21,4,0)
narrative displayed.
"^DD",142,142,20,0)
LOCATION(S) USING THE SUMMARY^142.2P^^20;0
"^DD",142,142,20,21,0)
^^3^3^2950731^^^^
"^DD",142,142,20,21,1,0)
Allows the entry of the hospital location (ward or clinic) which has
"^DD",142,142,20,21,2,0)
requested automatic nightly queueing of one or more health summary
"^DD",142,142,20,21,3,0)
types to a specified device.
"^DD",142,142,99,0)
TIMESTAMP^F^^99;1^K:$L(X)>15!($L(X)<1) X
"^DD",142,142,99,1,0)
^.1
"^DD",142,142,99,1,1,0)
142^AM^MUMPS
"^DD",142,142,99,1,1,1)
D SET^GMTSDD
"^DD",142,142,99,1,1,2)
D KILL^GMTSDD
"^DD",142,142,99,1,1,"%D",0)
^^5^5^2950731^
"^DD",142,142,99,1,1,"%D",1,0)
This MUMPS type cross-reference is used to maintain the navigational menus
"^DD",142,142,99,1,1,"%D",2,0)
when changes occur in the structure of a given Health Summary Type. The
"^DD",142,142,99,1,1,"%D",3,0)
executed code will rebuild navigational menus when the TIMESTAMP field is
"^DD",142,142,99,1,1,"%D",4,0)
modified. The ^XUTL("XQORM", global is used by the Unwinder utility to
"^DD",142,142,99,1,1,"%D",5,0)
generate the ad hoc and navigational menus.
"^DD",142,142,99,3)
Answer must be 1-15 characters in length.
"^DD",142,142,99,9)
^
"^DD",142,142,99,21,0)
^^6^6^2950731^
"^DD",142,142,99,21,1,0)
This is the $H formatted time associated with the most recent modification
"^DD",142,142,99,21,2,0)
to this health summary type. It is compared with the timestamp in the
"^DD",142,142,99,21,3,0)
^XUTL( multiple associated with this summary type, when ^XQORM is called
"^DD",142,142,99,21,4,0)
to generate help menus for interactive navigation. If a difference exists,
"^DD",142,142,99,21,5,0)
then the menus are "recompiled." This field is NOT to be edited
"^DD",142,142,99,21,6,0)
interactively under any circumstances!
"^DD",142,142,99,"DT")
2900111
"^DD",142,142.01,0)
STRUCTURE SUB-FIELD^^8^9
"^DD",142,142.01,0,"DT")
2950119
"^DD",142,142.01,0,"ID",1)
S %I=Y,Y=$S('$D(^(0)):"",$D(^GMT(142.1,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(142.1,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",142,142.01,0,"IX","AM",142.01,.01)

"^DD",142,142.01,0,"IX","AM1",142.01,1)

"^DD",142,142.01,0,"IX","AM5",142.01,5)

"^DD",142,142.01,0,"IX","B",142.01,.01)

"^DD",142,142.01,0,"IX","C",142.01,1)

"^DD",142,142.01,0,"NM","STRUCTURE")

"^DD",142,142.01,0,"UP")
142
"^DD",142,142.01,.01,0)
SUMMARY ORDER^MRNJ8,3XO^^0;1^K:+X'=X!(X>9999.999)!(X<.001)!(X'?1.4N.E) X S:$D(X) DINUM=X
"^DD",142,142.01,.01,1,0)
^.1
"^DD",142,142.01,.01,1,1,0)
142.01^B
"^DD",142,142.01,.01,1,1,1)
S ^GMT(142,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",142,142.01,.01,1,1,2)
K ^GMT(142,DA(1),1,"B",$E(X,1,30),DA)
"^DD",142,142.01,.01,1,1,"%D",0)
^^3^3^2920302^^
"^DD",142,142.01,.01,1,1,"%D",1,0)
This REGULAR "B" cross-reference is created by FileMan and because the
"^DD",142,142.01,.01,1,1,"%D",2,0)
multiple is DINUM'ed by SUMMARY ORDER, it serves little useful function
"^DD",142,142.01,.01,1,1,"%D",3,0)
in either look-up or sorting.
"^DD",142,142.01,.01,1,2,0)
142.01^AM^MUMPS
"^DD",142,142.01,.01,1,2,1)
D REDOX^GMTSDD
"^DD",142,142.01,.01,1,2,2)
D REDOX^GMTSDD
"^DD",142,142.01,.01,1,2,"%D",0)
^^4^4^2950731^^^^
"^DD",142,142.01,.01,1,2,"%D",1,0)
This MUMPS-type cross-reference is used to rebuild the ad hoc and
"^DD",142,142.01,.01,1,2,"%D",2,0)
navigational menus when the sequence of components within any Health
"^DD",142,142.01,.01,1,2,"%D",3,0)
Summary Type is changed. The ^XUTL("XQORM", global is used by the Unwinder
"^DD",142,142.01,.01,1,2,"%D",4,0)
utility to generate the ad hoc and navigational menus.
"^DD",142,142.01,.01,2)
S Y(0)=Y S Y=Y
"^DD",142,142.01,.01,2.1)
S Y=Y
"^DD",142,142.01,.01,3)
Type a Number between .001 and 9999.999
"^DD",142,142.01,.01,21,0)
^^4^4^2950821^^^^
"^DD",142,142.01,.01,21,1,0)
This is the sequence in which each successive component is to appear
"^DD",142,142.01,.01,21,2,0)
within the health summary.  By default, it will be an integer number,
"^DD",142,142.01,.01,21,3,0)
beginning with five, and incremented by five, so as to allow insertion
"^DD",142,142.01,.01,21,4,0)
of new components as necessary.
"^DD",142,142.01,.01,"DT")
2900418
"^DD",142,142.01,1,0)
COMPONENT NAME^RP142.1'^GMT(142.1,^0;2^Q
"^DD",142,142.01,1,1,0)
^.1
"^DD",142,142.01,1,1,1,0)
142.01^C
"^DD",142,142.01,1,1,1,1)
S ^GMT(142,DA(1),1,"C",$E(X,1,30),DA)=""
"^DD",142,142.01,1,1,1,2)
K ^GMT(142,DA(1),1,"C",$E(X,1,30),DA)
"^DD",142,142.01,1,1,1,"%D",0)
^^4^4^2920714^^^
"^DD",142,142.01,1,1,1,"%D",1,0)
This REGULAR FileMan type cross-reference is used both in look-ups of
"^DD",142,142.01,1,1,1,"%D",2,0)
components and to determine whether the selected component already
"^DD",142,142.01,1,1,1,"%D",3,0)
exists in the current Health Summary Type during the Create/Modify
"^DD",142,142.01,1,1,1,"%D",4,0)
process.
"^DD",142,142.01,1,1,2,0)
142.01^AM1^MUMPS
"^DD",142,142.01,1,1,2,1)
D REDOX^GMTSDD
"^DD",142,142.01,1,1,2,2)
D REDOX^GMTSDD
"^DD",142,142.01,1,1,2,"%D",0)
^^4^4^2950731^
"^DD",142,142.01,1,1,2,"%D",1,0)
This MUMPS type cross-reference is used to recompile the navigational and
"^DD",142,142.01,1,1,2,"%D",2,0)
ad hoc menus when components are added to/deleted from a given Health
"^DD",142,142.01,1,1,2,"%D",3,0)
Summary Type. The ^XUTL("XQORM", global is used by the Unwinder utility to
"^DD",142,142.01,1,1,2,"%D",4,0)
generate the ad hoc and navigational menus.
"^DD",142,142.01,1,1,3,0)
142^AE
"^DD",142,142.01,1,1,3,1)
S ^GMT(142,"AE",$E(X,1,30),DA(1),DA)=""
"^DD",142,142.01,1,1,3,2)
K ^GMT(142,"AE",$E(X,1,30),DA(1),DA)
"^DD",142,142.01,1,1,3,"%D",0)
^^4^4^2920302^^
"^DD",142,142.01,1,1,3,"%D",1,0)
This cross-reference is used by the routine ^GMTSDD to build the navigational
"^DD",142,142.01,1,1,3,"%D",2,0)
menu for each Health Summary Type, and by ^GMTSLOAD when saving the current
"^DD",142,142.01,1,1,3,"%D",3,0)
default parameters, prior to deleting and rebuilding the Ad Hoc Health
"^DD",142,142.01,1,1,3,"%D",4,0)
Summary Type.
"^DD",142,142.01,1,3)
Enter the name of the segment (e.g., DEMOGRAPHICS)
"^DD",142,142.01,1,21,0)
^^3^3^2950829^^^
"^DD",142,142.01,1,21,1,0)
This is the name of the next health summary component to be included in
"^DD",142,142.01,1,21,2,0)
the report (e.g., SURGERY REPORTS, or CHEMISTRY & HEMATOLOGY).  Valid
"^DD",142,142.01,1,21,3,0)
abbreviations (e.g., SR or CH) or partial names may also be entered.
"^DD",142,142.01,1,"DT")
2900329
"^DD",142,142.01,2,0)
OCCURRENCE LIMIT^NJ5,0^^0;3^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N) X
"^DD",142,142.01,2,3)
Enter occurrence limit of information to display.  Omit if no limit.  Occurrence limit displays are based on most recent information first. 
"^DD",142,142.01,2,21,0)
^^6^6^2940418^^
"^DD",142,142.01,2,21,1,0)
This is an integer number describing the number of occurrences (e.g., lab
"^DD",142,142.01,2,21,2,0)
orders, surgeries, radiology procedures, etc.) to be reported by the
"^DD",142,142.01,2,21,3,0)
component.  For example, if 5 is entered the component will only present
"^DD",142,142.01,2,21,4,0)
the five most recent occurrences.  If no limit is entered, the component
"^DD",142,142.01,2,21,5,0)
will report as many occurrences as may be found within the specified
"^DD",142,142.01,2,21,6,0)
time interval.
"^DD",142,142.01,3,0)
TIME LIMIT^FX^^0;4^S X=$$UP^XLFSTR(X) K:$L(X)>5!($L(X)<1)!'((X?1N.N1U)!(X?1N.N1"D")!(X?1N.N1"W")!(X?1N.N1"M")!(X?1N.N1"Y")) X
"^DD",142,142.01,3,3)
Enter time limit to display (e.g., 20D, 8W, 3M, 5Y).  Omit if no limit. Time limit displays are based on most recent information first.
"^DD",142,142.01,3,21,0)
^^8^8^2940914^
"^DD",142,142.01,3,21,1,0)
This is a code describing how far back the component should search for a
"^DD",142,142.01,3,21,2,0)
given patient's data.  It will be a number, followed by the letter D for
"^DD",142,142.01,3,21,3,0)
days, W for weeks, M for months or Y for years (e.g., 30D would denote the
"^DD",142,142.01,3,21,4,0)
past 30 days' patient data should be included in the component).  If no
"^DD",142,142.01,3,21,5,0)
limit is indicated, the component assumes an indefinite time interval.
"^DD",142,142.01,3,21,6,0)
Exceptions are the Outpatient, Unit Dose and Intravenous Pharmacy
"^DD",142,142.01,3,21,7,0)
components, which will show active orders only when no time limit is
"^DD",142,142.01,3,21,8,0)
entered.
"^DD",142,142.01,3,"DT")
2950823
"^DD",142,142.01,4,0)
SELECTION ITEM^142.14AV^^1;0
"^DD",142,142.01,4,21,0)
^^7^7^2960910^^^^
"^DD",142,142.01,4,21,1,0)
If the component allows selection of specific items, they will be selected
"^DD",142,142.01,4,21,2,0)
here.  Component examples are Lab Tests Selected, Lab Cumulative's
"^DD",142,142.01,4,21,3,0)
Selected, Radiology Impressions Selected, and Vital Signs Selected.
"^DD",142,142.01,4,21,4,0)
 
"^DD",142,142.01,4,21,5,0)
You will be asked to enter selection items such as Lab Tests, Radiology
"^DD",142,142.01,4,21,6,0)
Procedures, Vital Sign Types, Measurement Panel, Clinical
"^DD",142,142.01,4,21,7,0)
Reminder/Maintenance, Health Factor, depending on the component.
"^DD",142,142.01,4,21,8,0)
Factor, depending on the component.
"^DD",142,142.01,4,22)

"^DD",142,142.01,5,0)
HEADER NAME^F^^0;5^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>20!($L(X)<2) X
"^DD",142,142.01,5,1,0)
^.1
"^DD",142,142.01,5,1,1,0)
142.01^AM5^MUMPS
"^DD",142,142.01,5,1,1,1)
D REDOX^GMTSDD
"^DD",142,142.01,5,1,1,2)
D REDOX^GMTSDD
"^DD",142,142.01,5,1,1,"%D",0)
^^3^3^2950731^
"^DD",142,142.01,5,1,1,"%D",1,0)
This MUMPS type cross reference will recompile the AD HOC menu when an
"^DD",142,142.01,5,1,1,"%D",2,0)
entry is modified. The ^XUTL("XQORM", global is used by the Unwinder
"^DD",142,142.01,5,1,1,"%D",3,0)
utility to generate the ad hoc menu.
"^DD",142,142.01,5,1,1,"DT")
2911212
"^DD",142,142.01,5,3)
Answer must be 2-20 characters in length.
"^DD",142,142.01,5,21,0)
^^4^4^2911127^^^^
"^DD",142,142.01,5,21,1,0)
This is the name that will appear in both menus and headers within this
"^DD",142,142.01,5,21,2,0)
Health Summary type.  (e.g., if you are setting up the LAB SELECTED
"^DD",142,142.01,5,21,3,0)
CUMULATIVE component, and would like it to include the tests from a Chem 7,
"^DD",142,142.01,5,21,4,0)
you might enter Chem 7).
"^DD",142,142.01,5,"DT")
2911212
"^DD",142,142.01,6,0)
HOSPITAL LOCATION DISPLAYED^S^Y:yes;N:no;^0;6^Q
"^DD",142,142.01,6,3)
Enter Yes if Hospital Location abbreviation should appear in this component.
"^DD",142,142.01,6,21,0)
^^4^4^2950728^^^
"^DD",142,142.01,6,21,1,0)
This field controls whether or not the hospital location abbreviation will
"^DD",142,142.01,6,21,2,0)
be displayed in any components where hospital location applies (e.g., PCE
"^DD",142,142.01,6,21,3,0)
Outpatient Encounters, PCE Outpatient Diagnosis). The text displayed is
"^DD",142,142.01,6,21,4,0)
obtained from the Hospital Location file.
"^DD",142,142.01,6,"DT")
2940418
"^DD",142,142.01,7,0)
ICD TEXT DISPLAYED^S^L:long text;S:short text;C:code only;T:text only;N:none;^0;7^Q
"^DD",142,142.01,7,3)
Indicate whether the long form, short form, code only, text only, or no form of ICD diagnosis text should appear in applicable components.
"^DD",142,142.01,7,21,0)
^^7^7^2950728^
"^DD",142,142.01,7,21,1,0)
This field controls hows ICD text is displayed in components where ICD
"^DD",142,142.01,7,21,2,0)
Text applies (e.g., PCE Outpatient Encounters, PCE Outpatient Diagnosis
"^DD",142,142.01,7,21,3,0)
and Problem List All). The applicable component display/print can be
"^DD",142,142.01,7,21,4,0)
customized to include ICD Text in the following format: code and long
"^DD",142,142.01,7,21,5,0)
description, code and short description, code only, long description only
"^DD",142,142.01,7,21,6,0)
or nothing. This control is independent of whether provider narrative is
"^DD",142,142.01,7,21,7,0)
displayed -- either or both may be specified.
"^DD",142,142.01,7,"DT")
2950119
"^DD",142,142.01,8,0)
PROVIDER NARRATIVE DISPLAYED^S^Y:yes;N:no;^0;8^Q
"^DD",142,142.01,8,3)
Enter 'N' to eliminate the provider narrative from component display.
"^DD",142,142.01,8,21,0)
^^6^6^2950728^
"^DD",142,142.01,8,21,1,0)
This field controls whether provider narrative is displayed or not. It
"^DD",142,142.01,8,21,2,0)
applies to components where provider narrative is applicable (e.g., PCE
"^DD",142,142.01,8,21,3,0)
Outpatient Encounters, PCE Outpatient Diagnosis, Problem List All). This
"^DD",142,142.01,8,21,4,0)
control is independent of whether or not ICD text is displayed -- either
"^DD",142,142.01,8,21,5,0)
or both may be specified. If not specified, provider narrative will be
"^DD",142,142.01,8,21,6,0)
displayed by default.
"^DD",142,142.01,8,"DT")
2940419
"^DD",142,142.14,0)
SELECTION ITEM SUB-FIELD^^.01^1
"^DD",142,142.14,0,"DT")
2920928
"^DD",142,142.14,0,"IX","B",142.14,.01)

"^DD",142,142.14,0,"NM","SELECTION ITEM")

"^DD",142,142.14,0,"UP")
142.01
"^DD",142,142.14,.01,0)
SELECTION ITEM^MV^^0;1^Q
"^DD",142,142.14,.01,1,0)
^.1
"^DD",142,142.14,.01,1,1,0)
142.14^B
"^DD",142,142.14,.01,1,1,1)
S ^GMT(142,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",142,142.14,.01,1,1,2)
K ^GMT(142,DA(2),1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",142,142.14,.01,1,1,3)
Required Index for Variable Pointer
"^DD",142,142.14,.01,1,1,"%D",0)
^^2^2^2920302^
"^DD",142,142.14,.01,1,1,"%D",1,0)
This REGULAR FileMan type cross-reference is used in look-ups of selection
"^DD",142,142.14,.01,1,1,"%D",2,0)
items during the Create/Modify and parameter collection dialogues.
"^DD",142,142.14,.01,3)
Selection items can only be selected when appropriate for the component.
"^DD",142,142.14,.01,21,0)
^^7^7^2960910^^^^
"^DD",142,142.14,.01,21,1,0)
When a given component allows the selection of specific items, (e.g., lab
"^DD",142,142.14,.01,21,2,0)
tests, radiology procedures, vital measurements, measurement panels,
"^DD",142,142.14,.01,21,3,0)
clinical reminders/maintenance items, health factors, etc.), you may
"^DD",142,142.14,.01,21,4,0)
select the item by simply entering its name (e.g., POTASSIUM, or PULSE, as
"^DD",142,142.14,.01,21,5,0)
appropriate). If a limit has been specified for the number of items to be
"^DD",142,142.14,.01,21,6,0)
selected, then the build health summary option will restrict you to that
"^DD",142,142.14,.01,21,7,0)
number.
"^DD",142,142.14,.01,"DT")
2920928
"^DD",142,142.14,.01,"V",0)
^.12P^8^7
"^DD",142,142.14,.01,"V",1,0)
60^LABORATORY TEST^1^L^y^n
"^DD",142,142.14,.01,"V",1,1)
S DIC("S")="I ($P(^(0),U,4)=""CH""),(""BO""[$P(^(0),U,3))"
"^DD",142,142.14,.01,"V",1,2)
Only Chemistry & Hematology tests may be selected.
"^DD",142,142.14,.01,"V",2,0)
120.51^VITAL TYPE^2^V^n^n
"^DD",142,142.14,.01,"V",3,0)
71^RADIOLOGY TEST^3^R^n^n
"^DD",142,142.14,.01,"V",5,0)
9001017^MEASUREMENT PANEL^4^M^^n
"^DD",142,142.14,.01,"V",6,0)
811.9^CLINICAL REMINDER/MAINTENANCE^5^C^y^n
"^DD",142,142.14,.01,"V",6,1)
S DIC("S")="I +$P(^(0),U,6)'=1"
"^DD",142,142.14,.01,"V",6,2)
Allow selection of items that aren't inactive.
"^DD",142,142.14,.01,"V",7,0)
9999999.64^HEALTH FACTOR^6^F^y^n
"^DD",142,142.14,.01,"V",7,1)
S DIC("S")="I $P(^(0),U,10)=""C"",+$P(^(0),U,11)'=1"
"^DD",142,142.14,.01,"V",7,2)
Forces selection of health factor categories rather than individual health factors and forces selection of health factor categories that aren't inactive.
"^DD",142,142.14,.01,"V",8,0)
8925.1^PROGRESS NOTE TITLE^8^PN^y^n
"^DD",142,142.14,.01,"V",8,1)
S DIC("S")="I $P(^TIU(8925.1,+Y,0),U,4)=""DOC"",+$$ISA^TIULX(+Y,3)"
"^DD",142,142.14,.01,"V",8,2)
Only a PROGRESS NOTE TITLE may be selected.
"^DD",142,142.14,.01,"V",9,0)
81^CPT^7^CPT^n^n
"^DD",142,142.2,0)
LOCATION(S) USING THE SUMMARY SUB-FIELD^^.04^4
"^DD",142,142.2,0,"DT")
2920210
"^DD",142,142.2,0,"IX","B",142.2,.01)

"^DD",142,142.2,0,"NM","LOCATION(S) USING THE SUMMARY")

"^DD",142,142.2,0,"UP")
142
"^DD",142,142.2,.01,0)
LOCATION(S) USING THE SUMMARY^MP44'^SC(^0;1^Q
"^DD",142,142.2,.01,1,0)
^.1
"^DD",142,142.2,.01,1,1,0)
142.2^B
"^DD",142,142.2,.01,1,1,1)
S ^GMT(142,DA(1),20,"B",$E(X,1,30),DA)=""
"^DD",142,142.2,.01,1,1,2)
K ^GMT(142,DA(1),20,"B",$E(X,1,30),DA)
"^DD",142,142.2,.01,1,1,"%D",0)
^^2^2^2920302^
"^DD",142,142.2,.01,1,1,"%D",1,0)
This REGULAR FileMan type cross-reference is used for look-ups of locations
"^DD",142,142.2,.01,1,1,"%D",2,0)
for which Health Summaries are scheduled.
"^DD",142,142.2,.01,1,2,0)
142^D
"^DD",142,142.2,.01,1,2,1)
S ^GMT(142,"D",$E(X,1,30),DA(1),DA)=""
"^DD",142,142.2,.01,1,2,2)
K ^GMT(142,"D",$E(X,1,30),DA(1),DA)
"^DD",142,142.2,.01,1,2,"%D",0)
^^2^2^2920302^^^^
"^DD",142,142.2,.01,1,2,"%D",1,0)
This whole-file, REGULAR FileMan cross-reference is used for look-ups
"^DD",142,142.2,.01,1,2,"%D",2,0)
of the Health Summary types which are queued for each location.
"^DD",142,142.2,.01,1,3,0)
142^AW3^MUMPS
"^DD",142,142.2,.01,1,3,1)
D STL^GMTSUIX
"^DD",142,142.2,.01,1,3,2)
D KTL^GMTSUIX
"^DD",142,142.2,.01,1,3,"DT")
2981214
"^DD",142,142.2,.01,21,0)
^^3^3^2920214^^
"^DD",142,142.2,.01,21,1,0)
Enter the name of the hospital location (ward or clinic) which is to have
"^DD",142,142.2,.01,21,2,0)
this health summary type generated on a nightly basis to the device
"^DD",142,142.2,.01,21,3,0)
specified below.
"^DD",142,142.2,.01,"DT")
2981214
"^DD",142,142.2,.02,0)
DEVICE FOR NIGHTLY PRINT^P3.5'^%ZIS(1,^0;2^Q
"^DD",142,142.2,.02,3)
Specify the printer nearest LOCATION.
"^DD",142,142.2,.02,21,0)
^^3^3^2950731^^
"^DD",142,142.2,.02,21,1,0)
Enter the name of the device on which the summaries for this location
"^DD",142,142.2,.02,21,2,0)
are to be queued to run each night. Preferably the printer nearest to
"^DD",142,142.2,.02,21,3,0)
the specified location.
"^DD",142,142.2,.02,"DT")
2900904
"^DD",142,142.2,.03,0)
PRINT ACTION PROFILE^S^Y:yes;N:no;^0;3^Q
"^DD",142,142.2,.03,3)
Enter 'Y'es to queue the OUTPATIENT Action Profile with Health Summary
"^DD",142,142.2,.03,21,0)
^^3^3^2920210^
"^DD",142,142.2,.03,21,1,0)
This flag will cause the scheduled option GMTS TASK STARTUP to queue the
"^DD",142,142.2,.03,21,2,0)
OUTPATIENT PHARMACY Action Profile "in tandem" with the Health Summary
"^DD",142,142.2,.03,21,3,0)
for any location where the Health Summary may be queued to print.
"^DD",142,142.2,.03,"DT")
2920210
"^DD",142,142.2,.04,0)
PRINT DAYS AHEAD^NJ2,0^^0;4^K:+X'=X!(X>10)!(X<0)!(X?.E1"."1N.N) X
"^DD",142,142.2,.04,3)
0 means available early morning on day of clinic, 1 means available early morning one day before clinic,etc
"^DD",142,142.2,.04,21,0)
^^5^5^2901017^
"^DD",142,142.2,.04,21,1,0)
Determines the number of days prior to scheduled appointments you wish
"^DD",142,142.2,.04,21,2,0)
to have health summaries printed for a given clinic.  That is, if you
"^DD",142,142.2,.04,21,3,0)
wish to have summaries printed on the night before the patients are
"^DD",142,142.2,.04,21,4,0)
scheduled for clinic, enter 0.  If you wish them to be printed two days
"^DD",142,142.2,.04,21,5,0)
in advance of scheduled visits enter 2, etc.
"^DD",142,142.2,.04,"DT")
2900904
"^DIC",142,142,0)
HEALTH SUMMARY TYPE^142
"^DIC",142,142,0,"GL")
^GMT(142,
"^DIC",142,142,"%D",0)
^^11^11^2980401^^^^
"^DIC",142,142,"%D",1,0)
This file contains the structure of a Health Summary.  Components from the
"^DIC",142,142,"%D",2,0)
Health Summary Components file (142.1) may be selected and restricted by
"^DIC",142,142,"%D",3,0)
number of occurrences or time limits. The original creator of a type of 
"^DIC",142,142,"%D",4,0)
Health Summary is the owner of that type.  Health Summaries that are
"^DIC",142,142,"%D",5,0)
"owned" may not be modified or deleted by anyone else, except the Clinical
"^DIC",142,142,"%D",6,0)
Coordinator.  "Owned" Health Summaries may be used by other users to
"^DIC",142,142,"%D",7,0)
print patient information.  
"^DIC",142,142,"%D",8,0)
  
"^DIC",142,142,"%D",9,0)
The GMTSMGR security key is included on generic Health Summaries sent out 
"^DIC",142,142,"%D",10,0)
with the Health Summary Package.  These types of Health Summaries should 
"^DIC",142,142,"%D",11,0)
not be deleted.
"^DIC",142,142,"%D",12,0)
 
"^DIC",142,142,"%D",13,0)
Fields 2,3,4,5 and 6 are used ONLY by Indian Health Service.
"^DIC",142,142,"%D",14,0)
Specifically, fields 4 (MEASUREMENT PANEL) and 6 (SURVEILLANCE PANEL)
"^DIC",142,142,"%D",15,0)
point to files 9001017 and 9001018 respectively, which WILL NOT be
"^DIC",142,142,"%D",16,0)
present at non-PCC sites.
"^DIC",142,"B","HEALTH SUMMARY TYPE",142)

**END**
**END**
