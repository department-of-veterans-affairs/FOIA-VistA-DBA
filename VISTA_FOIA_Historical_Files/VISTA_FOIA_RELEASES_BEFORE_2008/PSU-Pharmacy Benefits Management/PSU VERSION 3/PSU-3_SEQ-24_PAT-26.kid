Released PSU*3*26 SEQ #24
Extracted from mail message
**KIDS**:PSU*3.0*26^

**INSTALL NAME**
PSU*3.0*26
"BLD",4813,0)
PSU*3.0*26^PHARMACY BENEFITS MANAGEMENT^0^3030827^y
"BLD",4813,1,0)
^^1^1^3030611^
"BLD",4813,1,1,0)
REMOVE FORM FEEDS
"BLD",4813,4,0)
^9.64PA^^0
"BLD",4813,"ABPKG")
n
"BLD",4813,"KRN",0)
^9.67PA^8989.52^19
"BLD",4813,"KRN",.4,0)
.4
"BLD",4813,"KRN",.401,0)
.401
"BLD",4813,"KRN",.402,0)
.402
"BLD",4813,"KRN",.403,0)
.403
"BLD",4813,"KRN",.5,0)
.5
"BLD",4813,"KRN",.84,0)
.84
"BLD",4813,"KRN",3.6,0)
3.6
"BLD",4813,"KRN",3.8,0)
3.8
"BLD",4813,"KRN",9.2,0)
9.2
"BLD",4813,"KRN",9.8,0)
9.8
"BLD",4813,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",4813,"KRN",9.8,"NM",1,0)
PSUAR5^^0^B3204835
"BLD",4813,"KRN",9.8,"NM",2,0)
PSUDEM0^^0^B23882040
"BLD",4813,"KRN",9.8,"NM",3,0)
PSUIV5^^0^B8577319
"BLD",4813,"KRN",9.8,"NM",4,0)
PSUOP6^^0^B12743470
"BLD",4813,"KRN",9.8,"NM","B","PSUAR5",1)
 
"BLD",4813,"KRN",9.8,"NM","B","PSUDEM0",2)
 
"BLD",4813,"KRN",9.8,"NM","B","PSUIV5",3)
 
"BLD",4813,"KRN",9.8,"NM","B","PSUOP6",4)
 
"BLD",4813,"KRN",19,0)
19
"BLD",4813,"KRN",19,"NM",0)
^9.68A^^0
"BLD",4813,"KRN",19.1,0)
19.1
"BLD",4813,"KRN",101,0)
101
"BLD",4813,"KRN",409.61,0)
409.61
"BLD",4813,"KRN",771,0)
771
"BLD",4813,"KRN",771,"NM",0)
^9.68A^^0
"BLD",4813,"KRN",870,0)
870
"BLD",4813,"KRN",8989.51,0)
8989.51
"BLD",4813,"KRN",8989.52,0)
8989.52
"BLD",4813,"KRN",8994,0)
8994
"BLD",4813,"KRN","B",.4,.4)
 
"BLD",4813,"KRN","B",.401,.401)
 
"BLD",4813,"KRN","B",.402,.402)
 
"BLD",4813,"KRN","B",.403,.403)
 
"BLD",4813,"KRN","B",.5,.5)
 
"BLD",4813,"KRN","B",.84,.84)
 
"BLD",4813,"KRN","B",3.6,3.6)
 
"BLD",4813,"KRN","B",3.8,3.8)
 
"BLD",4813,"KRN","B",9.2,9.2)
 
"BLD",4813,"KRN","B",9.8,9.8)
 
"BLD",4813,"KRN","B",19,19)
 
"BLD",4813,"KRN","B",19.1,19.1)
 
"BLD",4813,"KRN","B",101,101)
 
"BLD",4813,"KRN","B",409.61,409.61)
 
"BLD",4813,"KRN","B",771,771)
 
"BLD",4813,"KRN","B",870,870)
 
"BLD",4813,"KRN","B",8989.51,8989.51)
 
"BLD",4813,"KRN","B",8989.52,8989.52)
 
"BLD",4813,"KRN","B",8994,8994)
 
"BLD",4813,"QUES",0)
^9.62^^
"BLD",4813,"REQB",0)
^9.611^1^1
"BLD",4813,"REQB",1,0)
PSU*3.0*19^1
"BLD",4813,"REQB","B","PSU*3.0*19",1)
 
"MBREQ")
0
"PKG",541,-1)
1^1
"PKG",541,0)
PHARMACY BENEFITS MANAGEMENT^PSU^PHARMACY BENEFITS MANAGEMENT
"PKG",541,20,0)
^9.402P^^
"PKG",541,22,0)
^9.49I^1^1
"PKG",541,22,1,0)
3.0^2981015^3010116^66481
"PKG",541,22,1,"PAH",1,0)
26^3030827
"PKG",541,22,1,"PAH",1,1,0)
^^1^1^3030827
"PKG",541,22,1,"PAH",1,1,1,0)
REMOVE FORM FEEDS
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")
 
"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","PSUAR5")
0^1^B3204835
"RTN","PSUAR5",1,0)
PSUAR5 ;BIR/PDW - PRINT CYCLE CONTROLLER ;25 AUG 1998
"RTN","PSUAR5",2,0)
 ;;3.0;PHARMACY BENEFITS MANAGMENT;**26**;Oct 15, 1998
"RTN","PSUAR5",3,0)
EN ;EP for printing reports
"RTN","PSUAR5",4,0)
 N PSUQUIT
"RTN","PSUAR5",5,0)
 S PSUPG=0
"RTN","PSUAR5",6,0)
CATRPT ;
"RTN","PSUAR5",7,0)
 ; Printing Device should be opened by PSUDBQUE by now & IO set
"RTN","PSUAR5",8,0)
 ;For summary print for each division
"RTN","PSUAR5",9,0)
 I '$D(PSUARSUB) S PSUARSUB="PSUAR_"_PSUJOB
"RTN","PSUAR5",10,0)
 S PSUDIV=0 F  S PSUDIV=$O(^XTMP(PSUARSUB,"REPORT1",PSUDIV)) Q:PSUDIV=""  D
"RTN","PSUAR5",11,0)
 . S L="" F  S L=$O(^XTMP(PSUARSUB,"REPORT1",PSUDIV,L)) Q:L=""  S X=^(L) U IO W !,X I L=2 W !,?60,"PAGE: 1"
"RTN","PSUAR5",12,0)
 .;VMP-IOFO BAY PINES;ELR;PSU*3.0*26 - REMOVED FORM FEED
"RTN","PSUAR5",13,0)
 . ;U IO W @IOF
"RTN","PSUAR5",14,0)
 ;
"RTN","PSUAR5",15,0)
 ;
"RTN","PSUAR5",16,0)
DRUGRPT ; Print Drug Summary
"RTN","PSUAR5",17,0)
 S PSUDIV=0 F  S PSUDIV=$O(^XTMP(PSUARSUB,"REPORT2",PSUDIV)) Q:PSUDIV=""  D
"RTN","PSUAR5",18,0)
 . S PSUPG("PG")=1 D PGHDR S L=7 F  S L=$O(^XTMP(PSUARSUB,"REPORT2",PSUDIV,L)) Q:L=""  S X=^(L) U IO W !,X I $Y+4>IOSL D PG Q:$G(PSUQUIT)
"RTN","PSUAR5",19,0)
 . U IO W @IOF
"RTN","PSUAR5",20,0)
 Q
"RTN","PSUAR5",21,0)
 ;
"RTN","PSUAR5",22,0)
PG ;EP  Page controller
"RTN","PSUAR5",23,0)
 S PSUQUIT=0
"RTN","PSUAR5",24,0)
 I $Y<(IOSL-4) Q
"RTN","PSUAR5",25,0)
 S:'$D(PSUPG("PG")) PSUPG("PG")=0 S PSUPG("PG")=PSUPG("PG")+1
"RTN","PSUAR5",26,0)
 I $E(IOST)="C" K DIR S DIR(0)="E" D ^DIR I ($G(DIROUT)!$G(DUOUT)!$G(DTOUT)!$G(DROUT)) S PSUQUIT=1
"RTN","PSUAR5",27,0)
 ;
"RTN","PSUAR5",28,0)
PGHDR ; Write Page Header (SUBJECT of MAILMESSAGE)
"RTN","PSUAR5",29,0)
 U IO W @IOF
"RTN","PSUAR5",30,0)
 F I=1,2 W !,^XTMP(PSUARSUB,"REPORT2",PSUDIV,I)
"RTN","PSUAR5",31,0)
 W !,?60,"Page: ",PSUPG("PG")
"RTN","PSUAR5",32,0)
 ;S PSUPG("PG")=PSUPG("PG")+1
"RTN","PSUAR5",33,0)
 F I=4:1:7 I $D(^XTMP(PSUARSUB,"REPORT2",PSUDIV,I)) W !,^(I)
"RTN","PSUAR5",34,0)
 Q
"RTN","PSUDEM0")
0^2^B23882040
"RTN","PSUDEM0",1,0)
PSUDEM0 ;BIR/DAM - Patient Demographics Summary Print Routine ; 20 DEC 2001
"RTN","PSUDEM0",2,0)
 ;;3.0;PHARMACY BENEFITS MANAGEMENT;**19,26**;Oct 15, 1998
"RTN","PSUDEM0",3,0)
 ;
"RTN","PSUDEM0",4,0)
 ;
"RTN","PSUDEM0",5,0)
PRINT ;Print header for pt demographics
"RTN","PSUDEM0",6,0)
 Q
"RTN","PSUDEM0",7,0)
 ;
"RTN","PSUDEM0",8,0)
OPV ;EN   Outpatient Visit "No Data" message.  Called only when
"RTN","PSUDEM0",9,0)
 ; user answers 'yes'
"RTN","PSUDEM0",10,0)
 ;to "Do you want to receive this in a MailMan message?" AND when there
"RTN","PSUDEM0",11,0)
 ;is no data to report.
"RTN","PSUDEM0",12,0)
 ;
"RTN","PSUDEM0",13,0)
 Q:$D(^XTMP("PSU_"_PSUJOB,"PSUFLAG3"))
"RTN","PSUDEM0",14,0)
 Q:PSUSMRY        ;Don't print if user wants summary only
"RTN","PSUDEM0",15,0)
 Q:$D(^XTMP("PSU_"_PSUJOB,"PSUOPV"))
"RTN","PSUDEM0",16,0)
 ;
"RTN","PSUDEM0",17,0)
 W @IOF
"RTN","PSUDEM0",18,0)
 D DT^DILF("E",PSUSDT,.EXTD)
"RTN","PSUDEM0",19,0)
 S PSURP("START")=EXTD(0)
"RTN","PSUDEM0",20,0)
 D DT^DILF("E",PSUEDT,.EXTD)
"RTN","PSUDEM0",21,0)
 S PSURP("END")=EXTD(0)
"RTN","PSUDEM0",22,0)
 ;
"RTN","PSUDEM0",23,0)
 S PSUOVSUB="PSUOPV_"_PSUJOB
"RTN","PSUDEM0",24,0)
 S ^XTMP(PSUOVSUB,"PSUOPV",PSUSNDR,1)="Outpatient Visits for "_PSURP("START")_" through "_PSURP("END")
"RTN","PSUDEM0",25,0)
 S ^XTMP(PSUOVSUB,"PSUOPV",PSUSNDR,2)=" "
"RTN","PSUDEM0",26,0)
 S ^XTMP(PSUOVSUB,"PSUOPV",PSUSNDR,3)="No data to report"
"RTN","PSUDEM0",27,0)
 ;
"RTN","PSUDEM0",28,0)
 U IO
"RTN","PSUDEM0",29,0)
 ;
"RTN","PSUDEM0",30,0)
 ;F I=1:1:3 W !
"RTN","PSUDEM0",31,0)
 S PSUL=0
"RTN","PSUDEM0",32,0)
 F  S PSUL=$O(^XTMP(PSUOVSUB,"PSUOPV",PSUSNDR,PSUL)) Q:PSUL=""  D
"RTN","PSUDEM0",33,0)
 .S X=^XTMP(PSUOVSUB,"PSUOPV",PSUSNDR,PSUL) W !,X
"RTN","PSUDEM0",34,0)
 .I PSUL=1 W " for ",$P(^XTMP("PSU_"_PSUJOB,"PSUSITE"),U,2),!,?72,"PAGE:  1"
"RTN","PSUDEM0",35,0)
 ;
"RTN","PSUDEM0",36,0)
 Q
"RTN","PSUDEM0",37,0)
 ;
"RTN","PSUDEM0",38,0)
PTF ;EN  Inpatient Visit "No Data" message. 
"RTN","PSUDEM0",39,0)
 ;Called only when user answers 'YES'
"RTN","PSUDEM0",40,0)
 ;to "Do you want to receive this in a MailMan message?" AND when there
"RTN","PSUDEM0",41,0)
 ;is no data to report.
"RTN","PSUDEM0",42,0)
 ;
"RTN","PSUDEM0",43,0)
 Q:$D(^XTMP("PSU_"_PSUJOB,"PSUFLAG3"))
"RTN","PSUDEM0",44,0)
 Q:PSUSMRY      ;Don't print if user wants summary only
"RTN","PSUDEM0",45,0)
 Q:$D(^XTMP("PSU_"_PSUJOB,"PSUIPV"))
"RTN","PSUDEM0",46,0)
 ;
"RTN","PSUDEM0",47,0)
 W @IOF
"RTN","PSUDEM0",48,0)
 D DT^DILF("E",PSUSDT,.EXTD)
"RTN","PSUDEM0",49,0)
 S PSURP("START")=EXTD(0)
"RTN","PSUDEM0",50,0)
 D DT^DILF("E",PSUEDT,.EXTD)
"RTN","PSUDEM0",51,0)
 S PSURP("END")=EXTD(0)
"RTN","PSUDEM0",52,0)
 ;
"RTN","PSUDEM0",53,0)
 S PSUIVSUB="PSUIPV_"_PSUJOB
"RTN","PSUDEM0",54,0)
 S ^XTMP(PSUIVSUB,"PSUIPV",PSUSNDR,1)="Inpatient PTF Records for "_PSURP("START")_" through "_PSURP("END")
"RTN","PSUDEM0",55,0)
 S ^XTMP(PSUIVSUB,"PSUIPV",PSUSNDR,2)=" "
"RTN","PSUDEM0",56,0)
 S ^XTMP(PSUIVSUB,"PSUIPV",PSUSNDR,3)="No data to report"
"RTN","PSUDEM0",57,0)
 ;
"RTN","PSUDEM0",58,0)
 U IO
"RTN","PSUDEM0",59,0)
 ;
"RTN","PSUDEM0",60,0)
 ;F I=1:1:3 W !
"RTN","PSUDEM0",61,0)
 S PSUL=0
"RTN","PSUDEM0",62,0)
 F  S PSUL=$O(^XTMP(PSUIVSUB,"PSUIPV",PSUSNDR,PSUL)) Q:PSUL=""  D
"RTN","PSUDEM0",63,0)
 .S X=^XTMP(PSUIVSUB,"PSUIPV",PSUSNDR,PSUL) W !,X
"RTN","PSUDEM0",64,0)
 .I PSUL=1 W " for ",$P(^XTMP("PSU_"_PSUJOB,"PSUSITE"),U,2),!,?72,"PAGE:  1"
"RTN","PSUDEM0",65,0)
 ;
"RTN","PSUDEM0",66,0)
 Q
"RTN","PSUDEM0",67,0)
 ;
"RTN","PSUDEM0",68,0)
PRO ;EN   Provider information print routine. Prints summary report. 
"RTN","PSUDEM0",69,0)
 ;Called only when user answers 'NO'
"RTN","PSUDEM0",70,0)
 ;to "Do you want to receive this in a MailMan message?" 
"RTN","PSUDEM0",71,0)
 ;
"RTN","PSUDEM0",72,0)
 D DT^DILF("E",PSUSDT,.EXTD)
"RTN","PSUDEM0",73,0)
 S PSURP("START")=EXTD(0)
"RTN","PSUDEM0",74,0)
 D DT^DILF("E",PSUEDT,.EXTD)
"RTN","PSUDEM0",75,0)
 S PSURP("END")=EXTD(0)
"RTN","PSUDEM0",76,0)
 ;
"RTN","PSUDEM0",77,0)
 S PSUPGS("PG")=1
"RTN","PSUDEM0",78,0)
 ;
"RTN","PSUDEM0",79,0)
 S PSUPROSB="PSUPRO_"_PSUJOB
"RTN","PSUDEM0",80,0)
 D PGHDR
"RTN","PSUDEM0",81,0)
 ;
"RTN","PSUDEM0",82,0)
 S N=0,K=3
"RTN","PSUDEM0",83,0)
 F  S N=$O(^XTMP("PSU_"_PSUJOB,"PSUSUM",N)) Q:N=""  D
"RTN","PSUDEM0",84,0)
 .M ^XTMP(PSUPROSB,"PSUPRO",PSUSNDR,K)=^XTMP("PSU_"_PSUJOB,"PSUSUM",N)
"RTN","PSUDEM0",85,0)
 .S K=K+1                      ;Set Provider summary into XTMP global
"RTN","PSUDEM0",86,0)
 ;
"RTN","PSUDEM0",87,0)
 ;
"RTN","PSUDEM0",88,0)
 S PSUL=0
"RTN","PSUDEM0",89,0)
 F  S PSUL=$O(^XTMP(PSUPROSB,"PSUPRO",PSUSNDR,PSUL)) Q:PSUL=""  D
"RTN","PSUDEM0",90,0)
 .I LNCNT+4>IOSL D PGHDR
"RTN","PSUDEM0",91,0)
 .S X=^XTMP(PSUPROSB,"PSUPRO",PSUSNDR,PSUL) W !,X
"RTN","PSUDEM0",92,0)
 .S LNCNT=LNCNT+1
"RTN","PSUDEM0",93,0)
 ;
"RTN","PSUDEM0",94,0)
 K ^XTMP("PSU_"_PSUJOB,"PSUSUM")
"RTN","PSUDEM0",95,0)
 Q
"RTN","PSUDEM0",96,0)
 ;
"RTN","PSUDEM0",97,0)
PGHDR ;Page header for Provider summary message
"RTN","PSUDEM0",98,0)
 ;VMP-IOFO BAY PINES;ELR;PSU*3.0*26 REMOVE FORM FEED
"RTN","PSUDEM0",99,0)
 ;U IO W @IOF
"RTN","PSUDEM0",100,0)
 W "Provider Information for "_PSURP("START")_" through "_PSURP("END")_" for "_$P(^XTMP("PSU_"_PSUJOB,"PSUSITE"),U,2)
"RTN","PSUDEM0",101,0)
 W !,?68,"PAGE: "_PSUPGS("PG")
"RTN","PSUDEM0",102,0)
 S PSUPGS("PG")=PSUPGS("PG")+1
"RTN","PSUDEM0",103,0)
 F PSUH=9:1:12 W !,$G(^XTMP(PSUPROSB,"PSUPRO",PSUSNDR,PSUH))
"RTN","PSUDEM0",104,0)
 S LNCNT=5
"RTN","PSUDEM0",105,0)
 Q
"RTN","PSUDEM0",106,0)
 ;
"RTN","PSUDEM0",107,0)
IVSUM ;EN   Print routine for all Pt. Demographics Summary reports.  
"RTN","PSUDEM0",108,0)
 ;Prints NO Data
"RTN","PSUDEM0",109,0)
 ;and Summary report to screen if user answers 'N' to "Do you want a
"RTN","PSUDEM0",110,0)
 ;copy of this message sent to you in mailman?"
"RTN","PSUDEM0",111,0)
 ;
"RTN","PSUDEM0",112,0)
 D INST^PSUDEM1
"RTN","PSUDEM0",113,0)
 D COMM
"RTN","PSUDEM0",114,0)
 U IO
"RTN","PSUDEM0",115,0)
 W @IOF
"RTN","PSUDEM0",116,0)
 ;
"RTN","PSUDEM0",117,0)
 S PSUIVSUB="PSUPD_"_PSUJOB
"RTN","PSUDEM0",118,0)
 S ^XTMP(PSUIVSUB,"PSUPD",PSUSNDR,1)="Patient Demographics Summary for "_PSURP("START")_" through "_PSURP("END")
"RTN","PSUDEM0",119,0)
 S ^XTMP(PSUIVSUB,"PSUPD",PSUSNDR,2)=" "
"RTN","PSUDEM0",120,0)
 ;
"RTN","PSUDEM0",121,0)
 ;Do the following if there is no data to report
"RTN","PSUDEM0",122,0)
 I $D(^XTMP("PSU_"_PSUJOB,"PSUNONE")) D  Q
"RTN","PSUDEM0",123,0)
 .S ^XTMP(PSUIVSUB,"PSUPD",PSUSNDR,3)="No data to report"
"RTN","PSUDEM0",124,0)
 .S PSUL=0
"RTN","PSUDEM0",125,0)
 .F  S PSUL=$O(^XTMP(PSUIVSUB,"PSUPD",PSUSNDR,PSUL)) Q:PSUL=""  D
"RTN","PSUDEM0",126,0)
 ..S X=^XTMP(PSUIVSUB,"PSUPD",PSUSNDR,PSUL) W !,X
"RTN","PSUDEM0",127,0)
 ..I PSUL=2 W " for ",$P(^XTMP("PSU_"_PSUJOB,"PSUSITE"),U,2),!,?69,"Page:  1"
"RTN","PSUDEM0",128,0)
 ;
"RTN","PSUDEM0",129,0)
 ;Do the following if there is data to report in a summary
"RTN","PSUDEM0",130,0)
 S N=0,K=3
"RTN","PSUDEM0",131,0)
 F  S N=$O(^XTMP("PSU_"_PSUJOB,"PSUSUMA",N)) Q:N=""  D
"RTN","PSUDEM0",132,0)
 .M ^XTMP(PSUIVSUB,"PSUPD",PSUSNDR,K)=^XTMP("PSU_"_PSUJOB,"PSUSUMA",N)
"RTN","PSUDEM0",133,0)
 .S K=K+1      ;Set Provider summary into XTMP global
"RTN","PSUDEM0",134,0)
 ;
"RTN","PSUDEM0",135,0)
 ;
"RTN","PSUDEM0",136,0)
 S PSUL=0
"RTN","PSUDEM0",137,0)
 F  S PSUL=$O(^XTMP(PSUIVSUB,"PSUPD",PSUSNDR,PSUL)) Q:PSUL=""  D
"RTN","PSUDEM0",138,0)
 .S X=^XTMP(PSUIVSUB,"PSUPD",PSUSNDR,PSUL) W !,X
"RTN","PSUDEM0",139,0)
 .I PSUL=2 W " for ",$P(^XTMP("PSU_"_PSUJOB,"PSUSITE"),U,2),!,?69,"Page:  1"
"RTN","PSUDEM0",140,0)
 ;
"RTN","PSUDEM0",141,0)
 Q
"RTN","PSUDEM0",142,0)
 ;
"RTN","PSUDEM0",143,0)
COMM ;Common variables among all print subroutines
"RTN","PSUDEM0",144,0)
 ;
"RTN","PSUDEM0",145,0)
 D DT^DILF("E",PSUSDT,.EXTD)
"RTN","PSUDEM0",146,0)
 S PSURP("START")=EXTD(0)
"RTN","PSUDEM0",147,0)
 D DT^DILF("E",PSUEDT,.EXTD)
"RTN","PSUDEM0",148,0)
 S PSURP("END")=EXTD(0)
"RTN","PSUDEM0",149,0)
 ;
"RTN","PSUDEM0",150,0)
 Q
"RTN","PSUIV5")
0^3^B8577319
"RTN","PSUIV5",1,0)
PSUIV5 ;BIR/PDW - Pharmacy Benefits Mgt IV Printer Output ;10 JUL 1999
"RTN","PSUIV5",2,0)
 ;;3.0;PHARMACY BENEFITS MANAGEMENT;**1,7,19,26**;Oct 15, 1998
"RTN","PSUIV5",3,0)
 ;DBIA(s)
"RTN","PSUIV5",4,0)
 ; Reference to file #40.8 supported by DBIA 2438
"RTN","PSUIV5",5,0)
 ;
"RTN","PSUIV5",6,0)
EN ;EP entry for IV statistical output
"RTN","PSUIV5",7,0)
 NEW PSUI,PSUH,PSUL,PSUM,PSUPGS,ENDIT
"RTN","PSUIV5",8,0)
 D DT^DILF("E",PSUSDT,.EXTD)
"RTN","PSUIV5",9,0)
 S PSURP("START")=EXTD(0)
"RTN","PSUIV5",10,0)
 D DT^DILF("E",PSUEDT,.EXTD)
"RTN","PSUIV5",11,0)
 S PSURP("END")=EXTD(0)
"RTN","PSUIV5",12,0)
 I '$D(^XTMP(PSUIVSUB,"STATSUM")) D NOSUM
"RTN","PSUIV5",13,0)
 S PSUFACN=""
"RTN","PSUIV5",14,0)
 F  S PSUFACN=$O(^XTMP(PSUIVSUB,"STATSUM",PSUFACN)) Q:PSUFACN=""  D
"RTN","PSUIV5",15,0)
 .D PRTSUM
"RTN","PSUIV5",16,0)
 .I PSUSMRY Q  ;Quit if user requests the summary report only
"RTN","PSUIV5",17,0)
 .D PRTDRUG
"RTN","PSUIV5",18,0)
 ;
"RTN","PSUIV5",19,0)
 D PULL^PSUCP
"RTN","PSUIV5",20,0)
 F I=1:1:$L(PSUOPTS,",") S PSUMOD($P(PSUOPTS,",",I))=""
"RTN","PSUIV5",21,0)
 ;
"RTN","PSUIV5",22,0)
 I $D(PSUMOD(1))&'$D(PSUMOD(2)) D
"RTN","PSUIV5",23,0)
 .I '$D(PSUMOD(4)) D
"RTN","PSUIV5",24,0)
 ..D IVSUM^PSUDEM0
"RTN","PSUIV5",25,0)
 ;
"RTN","PSUIV5",26,0)
 Q
"RTN","PSUIV5",27,0)
PRTSUM ;Print the statistical summary report
"RTN","PSUIV5",28,0)
 U IO
"RTN","PSUIV5",29,0)
 ;VMP-IOFO BAY PINES;ELR;PSU*3.0*26 REMOVED FORM FEED
"RTN","PSUIV5",30,0)
 ;W @IOF
"RTN","PSUIV5",31,0)
 D GETNAME
"RTN","PSUIV5",32,0)
 S X=^XTMP(PSUIVSUB,"STATSUM",PSUFACN,1)
"RTN","PSUIV5",33,0)
 W !,X_" for "_PSUDIVNM
"RTN","PSUIV5",34,0)
 W !!,?68,"Page: 1"  ;Statistical summary will always be 1 page only
"RTN","PSUIV5",35,0)
 S PSUL=1
"RTN","PSUIV5",36,0)
 F  S PSUL=$O(^XTMP(PSUIVSUB,"STATSUM",PSUFACN,PSUL)) Q:PSUL=""  D
"RTN","PSUIV5",37,0)
 .W !,^XTMP(PSUIVSUB,"STATSUM",PSUFACN,PSUL)
"RTN","PSUIV5",38,0)
 ;
"RTN","PSUIV5",39,0)
 Q
"RTN","PSUIV5",40,0)
PRTDRUG ;Print the Statistical Drug Report
"RTN","PSUIV5",41,0)
 I '$D(^XTMP(PSUIVSUB,"DRUGSUM")) D NODRUG
"RTN","PSUIV5",42,0)
 S PSUPGS("PG")=1
"RTN","PSUIV5",43,0)
 D PGHDR
"RTN","PSUIV5",44,0)
 S PSUL=5
"RTN","PSUIV5",45,0)
 F  S PSUL=$O(^XTMP(PSUIVSUB,"DRUGSUM",PSUFACN,PSUL)) Q:PSUL=""  D
"RTN","PSUIV5",46,0)
 .I LNCNT+4>IOSL D PGHDR
"RTN","PSUIV5",47,0)
 .W !,^XTMP(PSUIVSUB,"DRUGSUM",PSUFACN,PSUL)
"RTN","PSUIV5",48,0)
 .S LNCNT=LNCNT+1
"RTN","PSUIV5",49,0)
 ;
"RTN","PSUIV5",50,0)
 Q
"RTN","PSUIV5",51,0)
PGHDR ;Print headings for statistical report
"RTN","PSUIV5",52,0)
 U IO
"RTN","PSUIV5",53,0)
 W @IOF
"RTN","PSUIV5",54,0)
 W !,^XTMP(PSUIVSUB,"DRUGSUM",PSUFACN,1)
"RTN","PSUIV5",55,0)
 W " for ",PSUDIVNM
"RTN","PSUIV5",56,0)
 W !!,?68,"Page: ",PSUPGS("PG")
"RTN","PSUIV5",57,0)
 S PSUPGS("PG")=PSUPGS("PG")+1
"RTN","PSUIV5",58,0)
 F PSUH=2:1:5 W !,$G(^XTMP(PSUIVSUB,"DRUGSUM",PSUFACN,PSUH))
"RTN","PSUIV5",59,0)
 S LNCNT=5
"RTN","PSUIV5",60,0)
 Q
"RTN","PSUIV5",61,0)
NOSUM ;Set up no data to report global if there is no statistical data
"RTN","PSUIV5",62,0)
 S ^XTMP(PSUIVSUB,"STATSUM",PSUSNDR,1)="IV Statistical Data Summary for "_PSURP("START")_" through "_PSURP("END")
"RTN","PSUIV5",63,0)
 S ^XTMP(PSUIVSUB,"STATSUM",PSUSNDR,2)=""
"RTN","PSUIV5",64,0)
 S ^XTMP(PSUIVSUB,"STATSUM",PSUSNDR,3)="No data to report"
"RTN","PSUIV5",65,0)
 S PSUFACN=PSUSNDR
"RTN","PSUIV5",66,0)
 Q
"RTN","PSUIV5",67,0)
NODRUG ;Set up the no data to report temp global if there is no drug data
"RTN","PSUIV5",68,0)
 S ^XTMP(PSUIVSUB,"DRUGSUM",PSUSNDR,1)="IV Statistical Data for "_PSURP("START")_" through "_PSURP("END")
"RTN","PSUIV5",69,0)
 S ^XTMP(PSUIVSUB,"DRUGSUM",PSUSNDR,2)=""
"RTN","PSUIV5",70,0)
 S ^XTMP(PSUIVSUB,"DRUGSUM",PSUSNDR,3)="No data to report"
"RTN","PSUIV5",71,0)
 S PSUFACN=PSUSNDR
"RTN","PSUIV5",72,0)
GETNAME ;Get the facility name
"RTN","PSUIV5",73,0)
 S X=PSUFACN,DIC=40.8,DIC(0)="X",D="C" D IX^DIC ;**1
"RTN","PSUIV5",74,0)
 S X=+Y S PSUDIVNM=$$VAL^PSUTL(40.8,X,.01)
"RTN","PSUIV5",75,0)
 Q
"RTN","PSUOP6")
0^4^B12743470
"RTN","PSUOP6",1,0)
PSUOP6 ;BIR/REG - PSU PBM Outpatient Pharmacy Printer Output ;10 JUL 1999
"RTN","PSUOP6",2,0)
 ;;3.0;PHARMACY BENEFITS MANAGEMENT;**1,7,19,26**;Oct 15, 1998
"RTN","PSUOP6",3,0)
 ;
"RTN","PSUOP6",4,0)
 ;DBIA(s)
"RTN","PSUOP6",5,0)
 ; Reference to file #59 supported by DBIA 2510
"RTN","PSUOP6",6,0)
 ;
"RTN","PSUOP6",7,0)
 ;PRINT CYCLE CONTROLLER FOR OUTPATIENT PHARMACY SUMMARY REPORT
"RTN","PSUOP6",8,0)
 ;
"RTN","PSUOP6",9,0)
EP ;
"RTN","PSUOP6",10,0)
 NEW PSUI,PSUH,PSUL,PSUM,PSUPGS
"RTN","PSUOP6",11,0)
 D DT^DILF("E",PSUSDT,.EXTD)
"RTN","PSUOP6",12,0)
 S PSURP("START")=EXTD(0)
"RTN","PSUOP6",13,0)
 D DT^DILF("E",PSUEDT,.EXTD)
"RTN","PSUOP6",14,0)
 S PSURP("END")=EXTD(0)
"RTN","PSUOP6",15,0)
 U IO
"RTN","PSUOP6",16,0)
 ;
"RTN","PSUOP6",17,0)
PRTSUMS ;
"RTN","PSUOP6",18,0)
 ; Find first Division/Facility in the summary by division
"RTN","PSUOP6",19,0)
 ; then DO the PRTALL routine
"RTN","PSUOP6",20,0)
 S PSUOPSUB="PSUOP_"_PSUJOB
"RTN","PSUOP6",21,0)
 I '$D(^XTMP(PSUOPSUB,"STATSUM")) D
"RTN","PSUOP6",22,0)
 .S ^XTMP("PSU_"_PSUJOB,"PSUNONE2")=""
"RTN","PSUOP6",23,0)
 .S ^XTMP(PSUOPSUB,"STATSUM",PSUSNDR,1)="Outpatient Statistical Data Summary for "_PSURP("START")_" through "_PSURP("END")
"RTN","PSUOP6",24,0)
 .S ^XTMP(PSUOPSUB,"STATSUM",PSUSNDR,2)=" "
"RTN","PSUOP6",25,0)
 .S ^XTMP(PSUOPSUB,"STATSUM",PSUSNDR,3)="No data to report"
"RTN","PSUOP6",26,0)
 ;
"RTN","PSUOP6",27,0)
 S PSUFACN=""
"RTN","PSUOP6",28,0)
 ;VMP-IOFO BAY PINES;ELR;PSU*3.0*26
"RTN","PSUOP6",29,0)
 NEW PSUFIRST
"RTN","PSUOP6",30,0)
 F  S PSUFACN=$O(^XTMP(PSUOPSUB,"STATSUM",PSUFACN)) Q:PSUFACN=""  D PRTALL
"RTN","PSUOP6",31,0)
 ;
"RTN","PSUOP6",32,0)
 D PULL^PSUCP
"RTN","PSUOP6",33,0)
 F I=1:1:$L(PSUOPTS,",") S PSUMOD($P(PSUOPTS,",",I))=""
"RTN","PSUOP6",34,0)
 ;
"RTN","PSUOP6",35,0)
 ;Call Pt. Demographics summary report/No data when user selects
"RTN","PSUOP6",36,0)
 ;(1)IV and (2)UD and (4)Rx
"RTN","PSUOP6",37,0)
 ;(1)IV and (4)Rx
"RTN","PSUOP6",38,0)
 ;(2)UD and (4)Rx
"RTN","PSUOP6",39,0)
 I $D(PSUMOD(1))!$D(PSUMOD(2)) D IVSUM^PSUDEM0
"RTN","PSUOP6",40,0)
 ;
"RTN","PSUOP6",41,0)
 ;Call Pt. Demographics summary report/No data when user selects
"RTN","PSUOP6",42,0)
 ;(4)IV alone.
"RTN","PSUOP6",43,0)
 I '$D(PSUMOD(1))&'$D(PSUMOD(2)) D IVSUM^PSUDEM0
"RTN","PSUOP6",44,0)
 ;
"RTN","PSUOP6",45,0)
 ; Find the first Division/Facility in the summary by drug by division
"RTN","PSUOP6",46,0)
 ; then DO the PRTDRUG routine
"RTN","PSUOP6",47,0)
 Q:PSUSMRY  ; 'summary only' was selected don't print 'by drug'
"RTN","PSUOP6",48,0)
 S PSUFACN=""
"RTN","PSUOP6",49,0)
 I '$D(^XTMP(PSUOPSUB,"DRUGSUM")) D
"RTN","PSUOP6",50,0)
 .S ^XTMP(PSUOPSUB,"DRUGSUM",PSUSNDR,1)="Outpatient Statistical Data for "_PSURP("START")_" through "_PSURP("END")
"RTN","PSUOP6",51,0)
 .S ^XTMP(PSUOPSUB,"DRUGSUM",PSUSNDR,2)="                                                                        Page"
"RTN","PSUOP6",52,0)
 .S ^XTMP(PSUOPSUB,"DRUGSUM",PSUSNDR,3)="No data to report"
"RTN","PSUOP6",53,0)
 F  S PSUFACN=$O(^XTMP(PSUOPSUB,"DRUGSUM",PSUFACN)) Q:PSUFACN=""  D PRTDRUG
"RTN","PSUOP6",54,0)
PRTSUMX ; EXIT PSUOP6
"RTN","PSUOP6",55,0)
 W @IOF
"RTN","PSUOP6",56,0)
 ;
"RTN","PSUOP6",57,0)
 Q 
"RTN","PSUOP6",58,0)
 ;
"RTN","PSUOP6",59,0)
PRTALL ; Print the Drug summary of all drugs by Division/Facility
"RTN","PSUOP6",60,0)
 S X=PSUFACN,DIC=59,DIC(0)="XM" D ^DIC ;**1
"RTN","PSUOP6",61,0)
 S X=+Y S PSUDIVNM=$$VAL^PSUTL(59,X,.01)
"RTN","PSUOP6",62,0)
 ;VMP-IOFO BAY PINES;ELR;PSU*3.0*26; REMOVE FORM FEED FIRST TIME THROUGH
"RTN","PSUOP6",63,0)
 I $G(PSUFIRST) W @IOF
"RTN","PSUOP6",64,0)
 S PSUFIRST=1
"RTN","PSUOP6",65,0)
 F I=1:1:3 W !
"RTN","PSUOP6",66,0)
 S PSUL=""
"RTN","PSUOP6",67,0)
 F  S PSUL=$O(^XTMP(PSUOPSUB,"STATSUM",PSUFACN,PSUL)) Q:PSUL=""  D
"RTN","PSUOP6",68,0)
 .W !,^XTMP(PSUOPSUB,"STATSUM",PSUFACN,PSUL)
"RTN","PSUOP6",69,0)
 .I PSUL=1 W " for ",PSUDIVNM,!,?72,"Page: 1" ; will only ever be one page
"RTN","PSUOP6",70,0)
 Q
"RTN","PSUOP6",71,0)
 ; 
"RTN","PSUOP6",72,0)
PRTDRUG ; Print the Drug summary by Drug by Division/Facility
"RTN","PSUOP6",73,0)
 ; Set page number to 0
"RTN","PSUOP6",74,0)
 S PSUPGS("PG")=0
"RTN","PSUOP6",75,0)
 S X=PSUFACN,DIC=59,DIC(0)="XM" D ^DIC
"RTN","PSUOP6",76,0)
 S X=+Y S PSUDIVNM=$$VAL^PSUTL(59,X,.01)
"RTN","PSUOP6",77,0)
 D PGHDR ; Perform 1st page heading
"RTN","PSUOP6",78,0)
 S PSUL=6 ; Report body starts at line 7
"RTN","PSUOP6",79,0)
 F  S PSUL=$O(^XTMP(PSUOPSUB,"DRUGSUM",PSUFACN,PSUL)) Q:PSUL=""  D
"RTN","PSUOP6",80,0)
 .I $Y+4>IOSL D PGHDR
"RTN","PSUOP6",81,0)
 .W !,^XTMP(PSUOPSUB,"DRUGSUM",PSUFACN,PSUL)
"RTN","PSUOP6",82,0)
 ;
"RTN","PSUOP6",83,0)
 Q
"RTN","PSUOP6",84,0)
 ;
"RTN","PSUOP6",85,0)
PGHDR ;Increment page number and Write Page Heading
"RTN","PSUOP6",86,0)
 ; Writes header lines 1 & 2, then page number, then lines 3 through 6
"RTN","PSUOP6",87,0)
 U IO W @IOF
"RTN","PSUOP6",88,0)
 F I=1:1:3 W !
"RTN","PSUOP6",89,0)
 W !,^XTMP(PSUOPSUB,"DRUGSUM",PSUFACN,1) ;Print 1st line
"RTN","PSUOP6",90,0)
 W " for ",PSUDIVNM ; add division name
"RTN","PSUOP6",91,0)
 S PSUPGS("PG")=PSUPGS("PG")+1
"RTN","PSUOP6",92,0)
 W !,$P(^XTMP(PSUOPSUB,"DRUGSUM",PSUFACN,2),":",1),": ",PSUPGS("PG"),! ;Print page number
"RTN","PSUOP6",93,0)
 F PSUH=3:1:6 W !,$G(^XTMP(PSUOPSUB,"DRUGSUM",PSUFACN,PSUH)) ;Print next 5 lines  
"RTN","PSUOP6",94,0)
 Q
"RTN","PSUOP6",95,0)
 ;
"VER")
8.0^22
**END**
**END**
