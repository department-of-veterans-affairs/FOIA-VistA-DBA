Released TIU*1*209 SEQ #194
Extracted from mail message
**KIDS**:TIU*1.0*209^

**INSTALL NAME**
TIU*1.0*209
"BLD",6265,0)
TIU*1.0*209^TEXT INTEGRATION UTILITIES^0^3060324^y
"BLD",6265,1,0)
^^2^2^3060228^
"BLD",6265,1,1,0)
The description of this patch may be found in the national patch module 
"BLD",6265,1,2,0)
under patch TIU*1.0*209.
"BLD",6265,4,0)
^9.64PA^^
"BLD",6265,"KRN",0)
^9.67PA^8989.52^19
"BLD",6265,"KRN",.4,0)
.4
"BLD",6265,"KRN",.401,0)
.401
"BLD",6265,"KRN",.402,0)
.402
"BLD",6265,"KRN",.403,0)
.403
"BLD",6265,"KRN",.5,0)
.5
"BLD",6265,"KRN",.84,0)
.84
"BLD",6265,"KRN",3.6,0)
3.6
"BLD",6265,"KRN",3.8,0)
3.8
"BLD",6265,"KRN",9.2,0)
9.2
"BLD",6265,"KRN",9.8,0)
9.8
"BLD",6265,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",6265,"KRN",9.8,"NM",1,0)
TIUPS209^^0^52105626
"BLD",6265,"KRN",9.8,"NM","B","TIUPS209",1)

"BLD",6265,"KRN",19,0)
19
"BLD",6265,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",6265,"KRN",19,"NM",1,0)
TIU ACTIVE TITLE CLEANUP^^0
"BLD",6265,"KRN",19,"NM",2,0)
TIU IRM MAINTENANCE MENU^^2
"BLD",6265,"KRN",19,"NM","B","TIU ACTIVE TITLE CLEANUP",1)

"BLD",6265,"KRN",19,"NM","B","TIU IRM MAINTENANCE MENU",2)

"BLD",6265,"KRN",19.1,0)
19.1
"BLD",6265,"KRN",101,0)
101
"BLD",6265,"KRN",409.61,0)
409.61
"BLD",6265,"KRN",771,0)
771
"BLD",6265,"KRN",870,0)
870
"BLD",6265,"KRN",8989.51,0)
8989.51
"BLD",6265,"KRN",8989.52,0)
8989.52
"BLD",6265,"KRN",8994,0)
8994
"BLD",6265,"KRN","B",.4,.4)

"BLD",6265,"KRN","B",.401,.401)

"BLD",6265,"KRN","B",.402,.402)

"BLD",6265,"KRN","B",.403,.403)

"BLD",6265,"KRN","B",.5,.5)

"BLD",6265,"KRN","B",.84,.84)

"BLD",6265,"KRN","B",3.6,3.6)

"BLD",6265,"KRN","B",3.8,3.8)

"BLD",6265,"KRN","B",9.2,9.2)

"BLD",6265,"KRN","B",9.8,9.8)

"BLD",6265,"KRN","B",19,19)

"BLD",6265,"KRN","B",19.1,19.1)

"BLD",6265,"KRN","B",101,101)

"BLD",6265,"KRN","B",409.61,409.61)

"BLD",6265,"KRN","B",771,771)

"BLD",6265,"KRN","B",870,870)

"BLD",6265,"KRN","B",8989.51,8989.51)

"BLD",6265,"KRN","B",8989.52,8989.52)

"BLD",6265,"KRN","B",8994,8994)

"BLD",6265,"QUES",0)
^9.62^^
"BLD",6265,"REQB",0)
^9.611^1^1
"BLD",6265,"REQB",1,0)
TEXT INTEGRATION UTILITIES 1.0^2
"BLD",6265,"REQB","B","TEXT INTEGRATION UTILITIES 1.0",1)

"KRN",19,13218,-1)
2^2
"KRN",19,13218,0)
TIU IRM MAINTENANCE MENU^TIU Maintenance Menu^^M^33238^^^^^^^506^y^1^1
"KRN",19,13218,10,0)
^19.01IP^12^7
"KRN",19,13218,10,12,0)
17178^6
"KRN",19,13218,10,12,"^")
TIU ACTIVE TITLE CLEANUP
"KRN",19,13218,"U")
TIU MAINTENANCE MENU
"KRN",19,17178,-1)
0^1
"KRN",19,17178,0)
TIU ACTIVE TITLE CLEANUP^Active Title Cleanup Report^^R^^^^^^^^TEXT INTEGRATION UTILITIES
"KRN",19,17178,25)
EN^TIUPS209
"KRN",19,17178,"U")
ACTIVE TITLE CLEANUP REPORT
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",506,-1)
1^1
"PKG",506,0)
TEXT INTEGRATION UTILITIES^TIU^Text Integration Utilities 
"PKG",506,20,0)
^9.402P^^
"PKG",506,22,0)
^9.49I^1^1
"PKG",506,22,1,0)
1.0^2970620^2970916^3316
"PKG",506,22,1,"PAH",1,0)
209^3060324
"PKG",506,22,1,"PAH",1,1,0)
^^2^2^3060324
"PKG",506,22,1,"PAH",1,1,1,0)
The description of this patch may be found in the national patch module 
"PKG",506,22,1,"PAH",1,1,2,0)
under patch TIU*1.0*209.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","TIUPS209")
0^1^B52105626
"RTN","TIUPS209",1,0)
TIUPS209 ; SLC/AJB - Active Titles Report & Cleanup ; 03/24/06
"RTN","TIUPS209",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**209**;Jun 20, 1997
"RTN","TIUPS209",3,0)
 ;
"RTN","TIUPS209",4,0)
 Q
"RTN","TIUPS209",5,0)
EN ; control segment
"RTN","TIUPS209",6,0)
 N ANS,HDR,RECS,RPT,TEMP,TMP,TIUNAME,TIUOMIT,TIUUNK
"RTN","TIUPS209",7,0)
 W @IOF
"RTN","TIUPS209",8,0)
 D ASKUSER(.ANS,"Inactivate the unused Document Titles at this time") Q:$G(ANS("EXIT"))="YES"
"RTN","TIUPS209",9,0)
 D
"RTN","TIUPS209",10,0)
 .N POP,TIUDESC,TIURTN,TIUSAVE
"RTN","TIUPS209",11,0)
 .S TIUDESC="TIUPS209 Active Title Report & Cleanup",TIURTN="REPORT^TIUPS209",TIUSAVE("*")=""
"RTN","TIUPS209",12,0)
 .W ! D PREP,EN^XUTMDEVQ(TIURTN,TIUDESC,.TIUSAVE)
"RTN","TIUPS209",13,0)
 Q
"RTN","TIUPS209",14,0)
ASKUSER(ANS,DIR,TIUQUIT) ; ask the user if they want to update titles now
"RTN","TIUPS209",15,0)
 I $G(ANS("EXIT"))="YES"!($G(ANS("INACT"))="NO") Q
"RTN","TIUPS209",16,0)
 N DIRUT,DTOUT,DUOUT,POP,X,Y
"RTN","TIUPS209",17,0)
 S DIR(0)="Y"
"RTN","TIUPS209",18,0)
 S DIR("A")=DIR,DIR("B")="NO"
"RTN","TIUPS209",19,0)
 S DIR("?",1)="Entering 'YES' will inactivate all titles unused in the past year;"
"RTN","TIUPS209",20,0)
 S DIR("?",2)="their STATUS will be changed to INACTIVE.",DIR("?",3)=""
"RTN","TIUPS209",21,0)
 S DIR("?")="Entering 'NO' will create the report without making any changes."
"RTN","TIUPS209",22,0)
 D ^DIR I $D(DUOUT)!($D(DTOUT)) S ANS("EXIT")="YES" Q
"RTN","TIUPS209",23,0)
 S ANS("INACT")=Y(0) Q:+$G(TIUQUIT)
"RTN","TIUPS209",24,0)
 I ANS("INACT")="YES" D
"RTN","TIUPS209",25,0)
 . W !!,"All active titles that have not been used in the previous 365 days"
"RTN","TIUPS209",26,0)
 . W !,"will be set to INACTIVE.",!
"RTN","TIUPS209",27,0)
 . W !,"You may select individual DOCUMENT TITLES that will NOT be set"
"RTN","TIUPS209",28,0)
 . W !,"to INACTIVE by this cleanup.",!
"RTN","TIUPS209",29,0)
 . D ASKUSER(.ANS,"Are you sure you want to change their status to INACTIVE",1)
"RTN","TIUPS209",30,0)
 . I ANS("INACT")="YES" D OMIT
"RTN","TIUPS209",31,0)
 Q
"RTN","TIUPS209",32,0)
GETLAST(TIUDA) ; finds last date a document title is used
"RTN","TIUPS209",33,0)
 N TIUD0,TIUD12,TIUDB,TIUDT,TIUSTAT,TIUX,TIUY
"RTN","TIUPS209",34,0)
 S TIUY=0_U_"N/A"_U_"N/A"_U_TIUDA
"RTN","TIUPS209",35,0)
 S (TIUDT,TIUSTAT)=0 F  S TIUSTAT=$O(^TIU(8925,"ALL","ANY",TIUDA,TIUSTAT)) Q:'+TIUSTAT  D
"RTN","TIUPS209",36,0)
 . S (TIUX,TIUY)="",TIUX=$O(^TIU(8925,"ALL","ANY",TIUDA,TIUSTAT,TIUX))
"RTN","TIUPS209",37,0)
 . S:+TIUX TIUY=$O(^TIU(8925,"ALL","ANY",TIUDA,TIUSTAT,TIUX,TIUY))
"RTN","TIUPS209",38,0)
 . S:+TIUY TIUSTAT(TIUX)=TIUY
"RTN","TIUPS209",39,0)
 S TIUX="",TIUX=$O(TIUSTAT(TIUX)) I +TIUX S TIUDB=TIUSTAT(TIUX),TIUD0=$G(^TIU(8925,TIUDB,0)),TIUD12=$G(^TIU(8925,TIUDB,12)) I '+TIUD0 S TIUUNK(TIUDB)=""
"RTN","TIUPS209",40,0)
 I +$G(TIUD12) S TIUY=0_U_+$P(TIUD12,".")_U_$P(TIUD12,U,2)_U_+TIUDA
"RTN","TIUPS209",41,0)
 Q TIUY
"RTN","TIUPS209",42,0)
OUTPUT ; prints report
"RTN","TIUPS209",43,0)
 N NUM S NUM=""
"RTN","TIUPS209",44,0)
 F  S NUM=$O(HDR(NUM)) Q:NUM=""  W HDR(NUM),!
"RTN","TIUPS209",45,0)
 F  S NUM=$O(RPT(NUM)) Q:NUM=""  W RPT(NUM),!
"RTN","TIUPS209",46,0)
 Q
"RTN","TIUPS209",47,0)
PREP ; prepares list of document titles
"RTN","TIUPS209",48,0)
 N TIUD0,TIUDA,TIUTITLE
"RTN","TIUPS209",49,0)
 S TIUNAME=$NA(^TMP("TIUPS209",$J)),TIUNAME(1)=$NA(^TEMP("TIUPS209",$J)),(TIUDA,TIUTITLE)="",RECS("TOTAL")=0
"RTN","TIUPS209",50,0)
 K @TIUNAME,@TIUNAME(1) ; cleans globals before use
"RTN","TIUPS209",51,0)
 F  S TIUTITLE=$O(^TIU(8925.1,"B",TIUTITLE)) Q:TIUTITLE=""  F  S TIUDA=$O(^TIU(8925.1,"B",TIUTITLE,TIUDA)) Q:'+TIUDA  S TIUD0=$G(^TIU(8925.1,TIUDA,0)) I $P(TIUD0,U,4)="DOC" S @TIUNAME@(TIUDA)=0,RECS("TOTAL")=RECS("TOTAL")+1
"RTN","TIUPS209",52,0)
 Q
"RTN","TIUPS209",53,0)
REPORT ;
"RTN","TIUPS209",54,0)
 N SPACER,TIU,TIUCNT,TIUDA,TIULVL,TIUTITLE
"RTN","TIUPS209",55,0)
 ;
"RTN","TIUPS209",56,0)
 ; get documents used in the last year
"RTN","TIUPS209",57,0)
 ;
"RTN","TIUPS209",58,0)
 S TIU("EDT")=$P($$NOW^XLFDT,".")_".24",TIU("SDT")=$P($$FMADD^XLFDT($$NOW^XLFDT,-365),"."),TIU("START")=$$NOW^XLFDT,TIUDA=""
"RTN","TIUPS209",59,0)
 F  S TIU("SDT")=$O(^TIU(8925,"F",TIU("SDT"))) Q:'+TIU("SDT")!(TIU("SDT")>TIU("EDT"))  F  S TIUDA=$O(^TIU(8925,"F",TIU("SDT"),TIUDA)) Q:'+TIUDA  D
"RTN","TIUPS209",60,0)
 . N TIUD0,TIUD12 S TIUD0=$G(^TIU(8925,TIUDA,0)),TIUD12=$G(^TIU(8925,TIUDA,12))
"RTN","TIUPS209",61,0)
 . I '+$D(@TIUNAME@(+TIUD0)) S @TIUNAME@(+TIUD0)=0
"RTN","TIUPS209",62,0)
 . I '+TIUD0 S TIUUNK(TIUDA)=""
"RTN","TIUPS209",63,0)
 . S @TIUNAME@(+TIUD0)=(@TIUNAME@(+TIUD0)+1)_U_+$P(TIUD12,".")_U_$P(TIUD12,U,2)_U_+TIUD0
"RTN","TIUPS209",64,0)
 ;
"RTN","TIUPS209",65,0)
 ; sort documents
"RTN","TIUPS209",66,0)
 ;
"RTN","TIUPS209",67,0)
 S (RECS("INACT"),RECS("ACT"))=0,TIUDA="" F  S TIUDA=$O(@TIUNAME@(TIUDA)) Q:TIUDA=""  D
"RTN","TIUPS209",68,0)
 . I '+@TIUNAME@(TIUDA) S RECS("INACT")=RECS("INACT")+1,@TIUNAME(1)@("A",$P(^TIU(8925.1,TIUDA,0),U))=$$GETLAST(TIUDA) Q
"RTN","TIUPS209",69,0)
 . S RECS("ACT")=RECS("ACT")+1,@TIUNAME(1)@("B",$S(+$L($P($G(^TIU(8925.1,TIUDA,0)),U)):$P(^TIU(8925.1,TIUDA,0),U),1:"UNKNOWN"))=@TIUNAME@(TIUDA) ; $P(^TIU(8925.1,TIUDA,0),U)
"RTN","TIUPS209",70,0)
 S TIU("STOP")=$$NOW^XLFDT,TIU("ELAPSED")=$FN($$FMDIFF^XLFDT(TIU("START"),TIU("STOP"),2)/60,"-")
"RTN","TIUPS209",71,0)
 ;
"RTN","TIUPS209",72,0)
 ; prepare report
"RTN","TIUPS209",73,0)
 ;
"RTN","TIUPS209",74,0)
 S HDR(1)="Elapsed Time:    "_(TIU("ELAPSED")\1)_" minute(s) "_($FN((TIU("ELAPSED")#1)*60,"-",0))_" second(s)"
"RTN","TIUPS209",75,0)
 S HDR(2)=""
"RTN","TIUPS209",76,0)
 S SPACER="",$P(SPACER," ",(8-$L(RECS("INACT"))))=" "
"RTN","TIUPS209",77,0)
 S HDR(3)="# of Records:      Unused Titles "_SPACER_RECS("INACT")
"RTN","TIUPS209",78,0)
 S SPACER="",$P(SPACER," ",(8-$L(RECS("ACT"))))=" "
"RTN","TIUPS209",79,0)
 S HDR(4)="                     Used Titles "_SPACER_RECS("ACT")
"RTN","TIUPS209",80,0)
 S SPACER="",$P(SPACER," ",(8-$L(RECS("TOTAL"))))=" "
"RTN","TIUPS209",81,0)
 S HDR(5)="                    Total Titles "_SPACER_RECS("TOTAL")
"RTN","TIUPS209",82,0)
 S HDR(6)=""
"RTN","TIUPS209",83,0)
 S RPT(1)="       Current User:  "_($$GET1^DIQ(200,+$G(DUZ),.01))
"RTN","TIUPS209",84,0)
 S RPT(2)="       Current Date:  "_($$HTE^XLFDT($H))
"RTN","TIUPS209",85,0)
 S RPT(3)="Date range searched:  "_($$FMTE^XLFDT($P($$FMADD^XLFDT($$NOW^XLFDT,-365),"."),"D"))_" - "_($$FMTE^XLFDT(TIU("EDT"),"D"))
"RTN","TIUPS209",86,0)
 S RPT(4)=""
"RTN","TIUPS209",87,0)
 S RPT(5)="                                         # of"
"RTN","TIUPS209",88,0)
 S RPT(6)="Document Title                           Docs  Last DT Used  Author/Dictator"
"RTN","TIUPS209",89,0)
 S RPT(7)="--------------                           ----  ------------  ---------------"
"RTN","TIUPS209",90,0)
 ;
"RTN","TIUPS209",91,0)
 ; inactivate if selected
"RTN","TIUPS209",92,0)
 ;
"RTN","TIUPS209",93,0)
 D:$G(ANS("INACT"))="YES" UPDATE
"RTN","TIUPS209",94,0)
 ;
"RTN","TIUPS209",95,0)
 ; process report body
"RTN","TIUPS209",96,0)
 ;
"RTN","TIUPS209",97,0)
 S (TIULVL,TIUTITLE)="",TIUCNT=7
"RTN","TIUPS209",98,0)
 F  S TIULVL=$O(@TIUNAME(1)@(TIULVL)) Q:TIULVL=""  F  S TIUTITLE=$O(@TIUNAME(1)@(TIULVL,TIUTITLE)) Q:TIUTITLE=""  D
"RTN","TIUPS209",99,0)
 . N TIUDISP,TIUTIT,TIUTMP
"RTN","TIUPS209",100,0)
 . S TIUTMP=@TIUNAME(1)@(TIULVL,TIUTITLE)
"RTN","TIUPS209",101,0)
 . D  I TIULVL="A",$P($G(^TIU(8925.1,$P(TIUTMP,U,4),0)),U,7)=13 Q
"RTN","TIUPS209",102,0)
 . . S:$P($G(^TIU(8925.1,$P(TIUTMP,U,4),0)),U,7)=13 TIUTMP(1)=" [currently inactive]"
"RTN","TIUPS209",103,0)
 . . S:$P($G(^TIU(8925.1,$P(TIUTMP,U,4),0)),U,4)'="DOC" TIUTMP(1)=" *["_$S(+$L($$GET1^DIQ(8925.1,$P(TIUTMP,U,4),.04)):$$GET1^DIQ(8925.1,$P(TIUTMP,U,4),.04),1:"missing")_"]*"
"RTN","TIUPS209",104,0)
 . S TIUTIT=$$WRAP^TIULS(TIUTITLE_$G(TIUTMP(1)),40)
"RTN","TIUPS209",105,0)
 . S TIUDISP=$$SETSTR^VALM1($P(TIUTIT,"|"),"",1,40)
"RTN","TIUPS209",106,0)
 . S TIUDISP=$$SETSTR^VALM1(+TIUTMP,TIUDISP,42,5)
"RTN","TIUPS209",107,0)
 . S TIUDISP=$$SETSTR^VALM1($$FMTE^XLFDT($P(TIUTMP,U,2)),TIUDISP,48,12)
"RTN","TIUPS209",108,0)
 . S TIUDISP=$$SETSTR^VALM1($S(+$P(TIUTMP,U,3):$$GET1^DIQ(200,$P(TIUTMP,U,3),.01),1:$P(TIUTMP,U,3)),TIUDISP,62,17)
"RTN","TIUPS209",109,0)
 . S TIUCNT=TIUCNT+1,RPT(TIUCNT)=TIUDISP
"RTN","TIUPS209",110,0)
 . I $L(TIUTIT,"|")>1 S TIUCNT=TIUCNT+1,RPT(TIUCNT)="     "_$P(TIUTIT,"|",2)
"RTN","TIUPS209",111,0)
 ;
"RTN","TIUPS209",112,0)
 I +$D(TIUUNK) D
"RTN","TIUPS209",113,0)
 . N TIUDA
"RTN","TIUPS209",114,0)
 . S TIUCNT=TIUCNT+1,RPT(TIUCNT)=""
"RTN","TIUPS209",115,0)
 . S TIUCNT=TIUCNT+1,RPT(TIUCNT)="The following DOCUMENT IENs have an incorrect #.01 Field (DOCUMENT TYPE)."
"RTN","TIUPS209",116,0)
 . S TIUCNT=TIUCNT+1,RPT(TIUCNT)=""
"RTN","TIUPS209",117,0)
 . S TIUDA="" F  S TIUDA=$O(TIUUNK(TIUDA)) Q:'+TIUDA  S TIUCNT=TIUCNT+1,RPT(TIUCNT)=TIUDA
"RTN","TIUPS209",118,0)
 ;
"RTN","TIUPS209",119,0)
 ; print report
"RTN","TIUPS209",120,0)
 ;
"RTN","TIUPS209",121,0)
 D OUTPUT,^%ZISC
"RTN","TIUPS209",122,0)
 ;
"RTN","TIUPS209",123,0)
 ; clean globals
"RTN","TIUPS209",124,0)
 ;
"RTN","TIUPS209",125,0)
 K @TIUNAME,@TIUNAME(1)
"RTN","TIUPS209",126,0)
 Q
"RTN","TIUPS209",127,0)
UPDATE ; updates status field of TIU Document Title to INACTIVE
"RTN","TIUPS209",128,0)
 N TIUDA S TIUDA=0 F  S TIUDA=$O(@TIUNAME@(TIUDA)) Q:'TIUDA  I '+@TIUNAME@(TIUDA),'+$D(TIUOMIT(TIUDA)) S $P(^TIU(8925.1,TIUDA,0),U,7)=13
"RTN","TIUPS209",129,0)
 Q
"RTN","TIUPS209",130,0)
OMIT ;
"RTN","TIUPS209",131,0)
 N TIUCONT,TIUQUIT
"RTN","TIUPS209",132,0)
 F  D  Q:$G(TIUQUIT)=1!($G(TIUCONT)=1)
"RTN","TIUPS209",133,0)
 . N DIC,DIR,POP,TIUCNT,X,Y
"RTN","TIUPS209",134,0)
 . W !!,"Enter the DOCUMENT TITLE(S) that will NOT be INACTIVATED",!
"RTN","TIUPS209",135,0)
 . W "during the cleanup process.",!!
"RTN","TIUPS209",136,0)
 . W "Enter RETURN or '^' to finish selections.",!
"RTN","TIUPS209",137,0)
 . S TIUCNT=0,DIC="^TIU(8925.1,",DIC("S")="I $P(^(0),U,4)=""DOC"""
"RTN","TIUPS209",138,0)
 . S DIC(0)="AEMQ",DIC("A")="Enter DOCUMENT TITLE: "
"RTN","TIUPS209",139,0)
 . F  D ^DIC Q:Y=-1  D  Q:$G(TIUQUIT)=1
"RTN","TIUPS209",140,0)
 . . S TIUCNT=TIUCNT+1,TIUOMIT(+Y)="" S:TIUCNT=1 DIC("A")="                 and  "
"RTN","TIUPS209",141,0)
 . Q:$G(TIUQUIT)=1
"RTN","TIUPS209",142,0)
 . I TIUCNT=0 W !!,"No selections made.",! S DIR("A")="Enter RETURN to continue or '^' to exit",DIR(0)="E" D ^DIR S TIUQUIT=1 Q
"RTN","TIUPS209",143,0)
 . W !!,$S(TIUCNT>1:"The following DOCUMENT TITLES will NOT be INACTIVATED: ",1:"The following DOCUMENT TITLE will NOT be INACTIVATED: "),!!
"RTN","TIUPS209",144,0)
 . S X="" F  S X=$O(TIUOMIT(X)) Q:X=""  W ?5,$$GET1^DIQ(8925.1,X_",",.01),!
"RTN","TIUPS209",145,0)
 . S DIR(0)="Y",DIR("A")="Is this correct",DIR("B")="YES"
"RTN","TIUPS209",146,0)
 . D ^DIR I +Y'=1 W !! K TIUOMIT S:Y=U TIUQUIT=1 Q
"RTN","TIUPS209",147,0)
 . S TIUCONT=1
"RTN","TIUPS209",148,0)
 Q
"VER")
8.0^22.0
**END**
**END**
