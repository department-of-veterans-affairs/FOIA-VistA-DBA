Released SD*5.3*339 SEQ #297
Extracted from mail message
**KIDS**:SD*5.3*339^

**INSTALL NAME**
SD*5.3*339
"BLD",5334,0)
SD*5.3*339^SCHEDULING^0^3040514^y
"BLD",5334,1,0)
^^1^1^3040114^
"BLD",5334,1,1,0)
CPT Codes not printing and Error Message Cleanup
"BLD",5334,4,0)
^9.64PA^^
"BLD",5334,"ABPKG")
n
"BLD",5334,"KRN",0)
^9.67PA^8989.52^19
"BLD",5334,"KRN",.4,0)
.4
"BLD",5334,"KRN",.401,0)
.401
"BLD",5334,"KRN",.402,0)
.402
"BLD",5334,"KRN",.403,0)
.403
"BLD",5334,"KRN",.5,0)
.5
"BLD",5334,"KRN",.84,0)
.84
"BLD",5334,"KRN",3.6,0)
3.6
"BLD",5334,"KRN",3.8,0)
3.8
"BLD",5334,"KRN",9.2,0)
9.2
"BLD",5334,"KRN",9.8,0)
9.8
"BLD",5334,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",5334,"KRN",9.8,"NM",1,0)
SCRPW51^^0^B24998789
"BLD",5334,"KRN",9.8,"NM",2,0)
SCRPW8^^0^B60477728
"BLD",5334,"KRN",9.8,"NM",3,0)
SDAMBMR2^^0^B23768902
"BLD",5334,"KRN",9.8,"NM",4,0)
SCRPW9^^0^B55655282
"BLD",5334,"KRN",9.8,"NM","B","SCRPW51",1)

"BLD",5334,"KRN",9.8,"NM","B","SCRPW8",2)

"BLD",5334,"KRN",9.8,"NM","B","SCRPW9",4)

"BLD",5334,"KRN",9.8,"NM","B","SDAMBMR2",3)

"BLD",5334,"KRN",19,0)
19
"BLD",5334,"KRN",19.1,0)
19.1
"BLD",5334,"KRN",101,0)
101
"BLD",5334,"KRN",409.61,0)
409.61
"BLD",5334,"KRN",771,0)
771
"BLD",5334,"KRN",870,0)
870
"BLD",5334,"KRN",8989.51,0)
8989.51
"BLD",5334,"KRN",8989.52,0)
8989.52
"BLD",5334,"KRN",8994,0)
8994
"BLD",5334,"KRN","B",.4,.4)

"BLD",5334,"KRN","B",.401,.401)

"BLD",5334,"KRN","B",.402,.402)

"BLD",5334,"KRN","B",.403,.403)

"BLD",5334,"KRN","B",.5,.5)

"BLD",5334,"KRN","B",.84,.84)

"BLD",5334,"KRN","B",3.6,3.6)

"BLD",5334,"KRN","B",3.8,3.8)

"BLD",5334,"KRN","B",9.2,9.2)

"BLD",5334,"KRN","B",9.8,9.8)

"BLD",5334,"KRN","B",19,19)

"BLD",5334,"KRN","B",19.1,19.1)

"BLD",5334,"KRN","B",101,101)

"BLD",5334,"KRN","B",409.61,409.61)

"BLD",5334,"KRN","B",771,771)

"BLD",5334,"KRN","B",870,870)

"BLD",5334,"KRN","B",8989.51,8989.51)

"BLD",5334,"KRN","B",8989.52,8989.52)

"BLD",5334,"KRN","B",8994,8994)

"BLD",5334,"QUES",0)
^9.62^^
"BLD",5334,"REQB",0)
^9.611^3^3
"BLD",5334,"REQB",1,0)
SD*5.3*144^2
"BLD",5334,"REQB",2,0)
SD*5.3*176^2
"BLD",5334,"REQB",3,0)
SD*5.3*180^2
"BLD",5334,"REQB","B","SD*5.3*144",1)

"BLD",5334,"REQB","B","SD*5.3*176",2)

"BLD",5334,"REQB","B","SD*5.3*180",3)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
339^3040514
"PKG",16,22,1,"PAH",1,1,0)
^^1^1^3040514
"PKG",16,22,1,"PAH",1,1,1,0)
CPT Codes not printing and Error Message Cleanup
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","SCRPW51")
0^1^B24998789
"RTN","SCRPW51",1,0)
SCRPW51 ;RENO/KEITH - Encounters by DSS Identifier/DSS ID by Frequency (OP0, OP1, OP2) ; 15 Jul 98  02:38PM
"RTN","SCRPW51",2,0)
 ;;5.3;Scheduling;**144,339**;AUG 13, 1993
"RTN","SCRPW51",3,0)
 D RQUE^SCRPW50("START^SCRPW51","Encounters by DSS Identifier/DSS ID by Frequency (OP0, OP1, OP2)",1) Q
"RTN","SCRPW51",4,0)
 ;
"RTN","SCRPW51",5,0)
START ;Print report
"RTN","SCRPW51",6,0)
 K ^TMP("SCRPW",$J) S (SDSTOP,SDOUT)=0,SDT=SD("FYD")
"RTN","SCRPW51",7,0)
 F  S SDT=$O(^SCE("B",SDT)) Q:'SDT!SDOUT!(SDT>SD("EDT"))  S SDOE=0 F  S SDOE=$O(^SCE("B",SDT,SDOE)) Q:'SDOE!SDOUT  S SDOE0=$$GETOE^SDOE(SDOE),SDIV=$P(SDOE0,U,11) I $$VALID() D SET(SDIV) D:SDMD SET(0)
"RTN","SCRPW51",8,0)
 G:SDOUT EXIT S (SDVCT,SDIV)=""
"RTN","SCRPW51",9,0)
 F  S SDIV=$O(^TMP("SCRPW",$J,SDIV)) Q:SDIV=""  D DLIST,STOP Q:SDOUT  D SUB0 S SDSC="" F  S SDSC=$O(^TMP("SCRPW",$J,SDIV,SDSC)) Q:'SDSC!SDOUT  F SDMF="M","F" D SUBT
"RTN","SCRPW51",10,0)
 G:SDOUT EXIT S SDLINE="",$P(SDLINE,"-",(IOM+1))="" D NOW^%DTC S Y=% X ^DD("DD") S SDPNOW=$P(Y,":",1,2),SDTIT(1)="<*>  ENCOUNTERS BY DSS IDENTIFIER (OP0, OP1, OP2)  <*>",SDPG=0 D:$E(IOST)="C" DISP0^SCRPW23
"RTN","SCRPW51",11,0)
 S SDFY=1700+(100*$E(SD("FYD")))+$E(SD("FYD"),2,3)
"RTN","SCRPW51",12,0)
 I '$D(^TMP("SCRPW",$J)) S SDPAGE=1,SDX="No activity found within report parameters." S SDIV=0 D DHDR^SCRPW40(1,.SDTIT),HDR G:SDOUT EXIT W !!?(IOM-$L(SDX)\2),SDX G EXIT  ;SD*5.3*339 added required input parameters to SCRPW40 call
"RTN","SCRPW51",13,0)
 G:SDOUT EXIT S SDIVN="" F  S SDIVN=$O(SDIV(SDIVN)) Q:SDIVN=""!SDOUT  S SDIV=SDIV(SDIVN) D DPRT(.SDIV)
"RTN","SCRPW51",14,0)
 G:SDOUT EXIT I SDVCT>1 S SDIV=0 D DPRT(.SDIV)
"RTN","SCRPW51",15,0)
EXIT G EXIT^SCRPW52
"RTN","SCRPW51",16,0)
 ;
"RTN","SCRPW51",17,0)
SUB0 F SDMF="M","F" D
"RTN","SCRPW51",18,0)
 .S (SDCT,DFN)=0 F  S DFN=$O(^TMP("SCRPW",$J,SDIV,SDMF,DFN)) Q:'DFN  S SDCT=SDCT+1
"RTN","SCRPW51",19,0)
 .S ^TMP("SCRPW",$J,SDIV,SDMF,"UNI")=SDCT Q
"RTN","SCRPW51",20,0)
 Q
"RTN","SCRPW51",21,0)
 ;
"RTN","SCRPW51",22,0)
SUBT S (SDUNI,DFN)=0 F  S DFN=$O(^TMP("SCRPW",$J,SDIV,SDSC,"SEX",SDMF,DFN)) Q:'DFN  S SDUNI=SDUNI+1
"RTN","SCRPW51",23,0)
 S ^TMP("SCRPW",$J,SDIV,SDSC,"SEX",SDMF,"UNI")=SDUNI
"RTN","SCRPW51",24,0)
 Q
"RTN","SCRPW51",25,0)
 ;
"RTN","SCRPW51",26,0)
DPRT(SDIV) ;Print division
"RTN","SCRPW51",27,0)
 ;Required input: SDIV=division ifn or '0' for combined divisions
"RTN","SCRPW51",28,0)
 D DHDR^SCRPW40(2,.SDTIT) S SDTIT(1)="<*>  ENCOUNTERS BY DSS IDENTIFIER (OP0, 0P1)  <*>"
"RTN","SCRPW51",29,0)
 F SDI=0:1:11 S SDRTOT(SDI)=0
"RTN","SCRPW51",30,0)
 S SDGTOT=0,SDPAGE=1 D HDR,HD1 Q:SDOUT  S SDSC=0 F  S SDSC=$O(^TMP("SCRPW",$J,SDIV,SDSC)) Q:'SDSC!SDOUT  D PLINE
"RTN","SCRPW51",31,0)
 Q:SDOUT  W ! F SDI=1:1:132 W "="
"RTN","SCRPW51",32,0)
 W !,"TOTAL:" F SDYMO=0:1:11 W ?(9+(9*SDYMO)),$J(SDRTOT(SDYMO),7,0)
"RTN","SCRPW51",33,0)
 W ?117,$J(SDGTOT,15,0)
"RTN","SCRPW51",34,0)
 D ^SCRPW52
"RTN","SCRPW51",35,0)
 Q
"RTN","SCRPW51",36,0)
 ;
"RTN","SCRPW51",37,0)
PLINE ;Print output line
"RTN","SCRPW51",38,0)
 Q:'$D(^TMP("SCRPW",$J,SDIV,SDSC,"P"))  N SDYMO
"RTN","SCRPW51",39,0)
 S SDYMO=0 F  S SDYMO=$O(^TMP("SCRPW",$J,SDIV,SDSC,"P","YMO",SDYMO)) Q:'SDYMO  S SDYMO($$MO())=^TMP("SCRPW",$J,SDIV,SDSC,"P","YMO",SDYMO)
"RTN","SCRPW51",40,0)
 D:$Y>(IOSL-4) HDR,HD1 Q:SDOUT
"RTN","SCRPW51",41,0)
 S SDTCT=0 W !?2,SDSC F SDYMO=0:1:11 D
"RTN","SCRPW51",42,0)
 .S SDCT=+$G(SDYMO(SDYMO)),SDTCT=SDTCT+SDCT,SDRTOT(SDYMO)=SDRTOT(SDYMO)+SDCT,SDGTOT=SDGTOT+SDCT W ?(9+(9*SDYMO)),$J(SDCT,7,0) Q
"RTN","SCRPW51",43,0)
 W ?117,$J(SDTCT,15,0)
"RTN","SCRPW51",44,0)
 Q
"RTN","SCRPW51",45,0)
 ;
"RTN","SCRPW51",46,0)
MO() ;Determine FY month
"RTN","SCRPW51",47,0)
 N X S X=+$E(SDYMO,4,5),X=$S(X>9:$E(X,2),1:X+2) Q X
"RTN","SCRPW51",48,0)
 ;
"RTN","SCRPW51",49,0)
HDR ;Print header
"RTN","SCRPW51",50,0)
 I $E(IOST)="C",SDPG N DIR S DIR(0)="E" W ! D ^DIR S SDOUT=Y'=1 Q:SDOUT
"RTN","SCRPW51",51,0)
 D STOP Q:SDOUT  W:SDPG!($E(IOST)="C") $$XY^SCRPW50(IOF,1,0) W:$X $$XY^SCRPW50("",0,0)
"RTN","SCRPW51",52,0)
 N SDI S SDI=0 W SDLINE F  S SDI=$O(SDTIT(SDI)) Q:'SDI  W !?(IOM-$L(SDTIT(SDI))\2),SDTIT(SDI)
"RTN","SCRPW51",53,0)
 W !,SDLINE,!,"For Fiscal Year activity through ",SD("PEDT"),!,"Date printed: ",SDPNOW,?(IOM-6-$L(SDPAGE)),"Page: ",SDPAGE,!,SDLINE S SDPAGE=SDPAGE+1,SDPG=1 Q
"RTN","SCRPW51",54,0)
 ;
"RTN","SCRPW51",55,0)
HD1 ;Print subheader
"RTN","SCRPW51",56,0)
 Q:SDOUT  W !,"DSS ID",?9 S SDM1=0 F SDMO=10,11,12,"01","02","03","04","05","06","07","08","09" D
"RTN","SCRPW51",57,0)
 .W ?(9+(9*SDM1)),SDMO,"/",$S(SDM1<3:SDFY,1:SDFY+1) S SDM1=SDM1+1 Q
"RTN","SCRPW51",58,0)
 W ?122,"FYTD TOTAL",!,"-------" F SDM1=0:1:11 W ?(9+(9*SDM1)),"-------"
"RTN","SCRPW51",59,0)
 W ?117,"---------------" Q
"RTN","SCRPW51",60,0)
 ;
"RTN","SCRPW51",61,0)
DLIST ;Create alphabetic list of divisions found
"RTN","SCRPW51",62,0)
 Q:'SDIV  S SDX=$P($G(^DG(40.8,SDIV,0)),U) S:'$L(SDX) SDX="*** UNKNOWN ***" S SDIV(SDX)=SDIV,SDVCT=SDVCT+1 Q
"RTN","SCRPW51",63,0)
 ;
"RTN","SCRPW51",64,0)
VALID() ;Check encounter record
"RTN","SCRPW51",65,0)
 I SDIV,$$DIV(),$P(SDOE0,U,2),'$P(SDOE0,U,6),$P(SDOE0,U,12)=2 Q 1
"RTN","SCRPW51",66,0)
 Q 0
"RTN","SCRPW51",67,0)
 ;
"RTN","SCRPW51",68,0)
DIV() ;Check division
"RTN","SCRPW51",69,0)
 Q:'SDDIV 1  Q $D(SDDIV(SDIV))
"RTN","SCRPW51",70,0)
 ;
"RTN","SCRPW51",71,0)
STOP ;Check for stop task request
"RTN","SCRPW51",72,0)
 S:$D(ZTQUEUED) (SDOUT,ZTSTOP)=$S($$S^%ZTLOAD:1,1:0) Q
"RTN","SCRPW51",73,0)
 ;
"RTN","SCRPW51",74,0)
SET(SDIV) ;Set division lists
"RTN","SCRPW51",75,0)
 ;Required input: SDIV=division ifn or '0' for summary
"RTN","SCRPW51",76,0)
 S SDSTOP=SDSTOP+1 I SDSTOP#2000=0 D STOP^SCRPW40 Q:SDOUT
"RTN","SCRPW51",77,0)
 N SDX,SDI,SDPSC,SDSSC
"RTN","SCRPW51",78,0)
 D SCPC^SCRPW25(.SDX) S SDI=$O(SDX("")),SDPSC=$P(SDX(SDI),U) Q:'SDPSC
"RTN","SCRPW51",79,0)
 K SDX D SCSC^SCRPW25(.SDX) S SDI=$O(SDX("")),SDSSC=$P(SDX(SDI),U)
"RTN","SCRPW51",80,0)
 S SDMF=$P($G(^DPT($P(SDOE0,U,2),0)),U,2) I '$L(SDMF)!("MF"'[SDMF) Q
"RTN","SCRPW51",81,0)
 S SDSCN=$P($G(^DIC(40.7,+SDPSC,0)),U,2) D:SDSCN SET1(SDSCN,"P")
"RTN","SCRPW51",82,0)
 S SDSCN=$P($G(^DIC(40.7,+SDSSC,0)),U,2) D:SDSCN SET1(SDSCN,"S")
"RTN","SCRPW51",83,0)
 Q
"RTN","SCRPW51",84,0)
 ;
"RTN","SCRPW51",85,0)
SET1(SDC,SDPS) ;Set TMP global
"RTN","SCRPW51",86,0)
 ;Required input: SDC=stop code AMIS number
"RTN","SCRPW51",87,0)
 ;Optional input: SDPS='P' or 'S' to indicate primary or secondary
"RTN","SCRPW51",88,0)
 S ^TMP("SCRPW",$J,SDIV,SDC,SDPS,"ENC")=$G(^TMP("SCRPW",$J,SDIV,SDC,SDPS,"ENC"))+1
"RTN","SCRPW51",89,0)
 S ^TMP("SCRPW",$J,SDIV,SDC,"SEX",SDMF)=$G(^TMP("SCRPW",$J,SDIV,SDC,"SEX",SDMF))+1
"RTN","SCRPW51",90,0)
 S ^TMP("SCRPW",$J,SDIV,SDC,"SEX",SDMF,$P(SDOE0,U,2))=""
"RTN","SCRPW51",91,0)
 S ^TMP("SCRPW",$J,SDIV,SDMF,$P(SDOE0,U,2))="" Q:SDPS="S"
"RTN","SCRPW51",92,0)
 S ^TMP("SCRPW",$J,SDIV,SDMF,"ENC")=$G(^TMP("SCRPW",$J,SDIV,SDMF,"ENC"))+1
"RTN","SCRPW51",93,0)
 S ^TMP("SCRPW",$J,SDIV,SDC,SDPS,"YMO",+$E(SDOE0,1,5))=$G(^TMP("SCRPW",$J,SDIV,SDC,SDPS,"YMO",+$E(SDOE0,1,5)))+1 Q
"RTN","SCRPW8")
0^2^B60477728
"RTN","SCRPW8",1,0)
SCRPW8 ;RENO/KEITH - Outpatient Encounter Workload Statistics ; 04 Feb 99  4:53 PM
"RTN","SCRPW8",2,0)
 ;;5.3;Scheduling;**139,145,144,176,339**;AUG 13, 1993
"RTN","SCRPW8",3,0)
QS ;Queue outpatient encounter workload report
"RTN","SCRPW8",4,0)
 D PARM^SCRPW9 Q
"RTN","SCRPW8",5,0)
 ;
"RTN","SCRPW8",6,0)
PST ;Print stats
"RTN","SCRPW8",7,0)
 N X,Y,%
"RTN","SCRPW8",8,0)
 D NOW^%DTC S Y=% X ^DD("DD") S SDPAGE=1,SDPNOW=$P(Y,":",1,2),SDDT=SDDTF,SDMC=$O(^DG(43,0)),SDMC=$G(^DG(43,+SDMC,"GL")),SDMD=$P(SDMC,U,2),(SDOUT,SDSTOP,SDFF)=0
"RTN","SCRPW8",9,0)
 S SDDNAM=$P($G(^DG(40.8,+$$PRIM^VASITE(),0)),U,7),SDDNAM=$$GET1^DIQ(4,+SDDNAM,.01) S:'$L(SDDNAM) SDDNAM=$P($G(^DG(40.8,+$P(SDMC,U,3),0)),U)
"RTN","SCRPW8",10,0)
 F I="SCRPW","SCRPWD","SCRPWC" K ^TMP(I,$J)
"RTN","SCRPW8",11,0)
 F  S SDDT=$O(^SCE("B",SDDT)) Q:'SDDT!(SDDT>SDDTL)!SDOUT  S SDOE=0 D
"RTN","SCRPW8",12,0)
 .F  S SDOE=$O(^SCE("B",SDDT,SDOE)) Q:'SDOE!SDOUT  S SDOE0=$$GETOE^SDOE(SDOE) I $L(SDOE0),'$P(SDOE0,U,6),$P(SDOE0,U,2),$P(SDOE0,U,11),$P(SDOE0,U,12) S SDDIV=$$DIV(),SDCG=$$CLGR() D COUNT
"RTN","SCRPW8",13,0)
 .Q
"RTN","SCRPW8",14,0)
 I '$D(^TMP("SCRPW",$J)) D XHDR S SDX="No activity found within the parameters specified." W !!?(80-$L(SDX)\2),SDX G EXIT
"RTN","SCRPW8",15,0)
 F SDS1="SCRPW","SCRPWD","SCRPWC" S SDS2="" F  S SDS2=$O(^TMP(SDS1,$J,SDS2)) Q:SDS2=""!SDOUT  D STCT
"RTN","SCRPW8",16,0)
 G:SDOUT EXIT D:$E(IOST)="C" DISP0^SCRPW23
"RTN","SCRPW8",17,0)
 F SDS1="SCRPW","SCRPWD","SCRPWC" S SDS2="" F  S SDS2=$O(^TMP(SDS1,$J,SDS2)) Q:SDS2=""!SDOUT  D PRPT
"RTN","SCRPW8",18,0)
 G:SDOUT EXIT
"RTN","SCRPW8",19,0)
 D:SDZ(0) DPRT^SCRPW9("SCRPW",SDDNAM) G:SDOUT EXIT D:SDUL UNARL^SCRPW9("SCRPW",SDDNAM) G EXIT
"RTN","SCRPW8",20,0)
 ;
"RTN","SCRPW8",21,0)
STCT S (SDUNCO,SDCT,DFN)=0 D STOP Q:SDOUT
"RTN","SCRPW8",22,0)
 F  S DFN=$O(^TMP(SDS1,$J,SDS2,"VISIT","ACC",DFN)) Q:'DFN  S SDUNCO=SDUNCO+1,SDDT=0 F  S SDDT=$O(^TMP(SDS1,$J,SDS2,"VISIT","ACC",DFN,SDDT)) Q:'SDDT  S SDCT=SDCT+1
"RTN","SCRPW8",23,0)
 S ^TMP(SDS1,$J,SDS2,"UNIQUE","UNCO")=SDUNCO,^TMP(SDS1,$J,SDS2,"VISIT","OWK")=SDCT,(SDUNAR,SDCT,DFN)=0
"RTN","SCRPW8",24,0)
 S DFN=0 F  S DFN=$O(^TMP(SDS1,$J,SDS2,"VISIT","OWK",DFN)) Q:'DFN  D NCT1
"RTN","SCRPW8",25,0)
 S DFN=0 F  S DFN=$O(^TMP(SDS1,$J,SDS2,"VISIT","NWK",DFN)) Q:'DFN  D CT1
"RTN","SCRPW8",26,0)
 S ^TMP(SDS1,$J,SDS2,"UNIQUE","UNAR")=SDUNAR,^TMP(SDS1,$J,SDS2,"VISIT","NWK")=SDCT Q
"RTN","SCRPW8",27,0)
 ;
"RTN","SCRPW8",28,0)
PRPT ;Print statistics page
"RTN","SCRPW8",29,0)
 D STOP Q:SDOUT
"RTN","SCRPW8",30,0)
 S SDCT=0 F SDI=1,2,3,11,14 S SDCT=SDCT+$G(^TMP(SDS1,$J,SDS2,SDI))
"RTN","SCRPW8",31,0)
 D XHDR Q:SDOUT  D SHDR("O U T P A T I E N T   E N C O U N T E R   W O R K L O A D") Q:SDOUT  F SDI=11,14,3,1 D LIST(SDI) Q:SDOUT
"RTN","SCRPW8",32,0)
 I $D(^TMP(SDS1,$J,SDS2,2)) D:$Y>(IOSL-4) XHDR Q:SDOUT  W !?10,"CHECKED OUT" S SDI=0 F  S SDI=$O(^TMP(SDS1,$J,SDS2,2,SDI)) Q:'SDI!SDOUT  S SDSTAT=$O(^TMP(SDS1,$J,SDS2,2,SDI,"")) D COT
"RTN","SCRPW8",33,0)
 D TOT S (SDI,SDCT)=0 F SDI=4,5,6,7,8,9,12,13 S SDCT=SDCT+$G(^TMP(SDS1,$J,SDS2,SDI))
"RTN","SCRPW8",34,0)
 W !! D SHDR("N O N - W O R K L O A D") Q:SDOUT  F SDI=8,12,4,6,5,7,9,10,13 D LIST(SDI) Q:SDOUT
"RTN","SCRPW8",35,0)
 D TOT W !! D SHDR(($$HD2()_"   O U T P A T I E N T   V I S I T S")) Q:SDOUT  S SDCT=^TMP(SDS1,$J,SDS2,"VISIT","NWK")+^TMP(SDS1,$J,SDS2,"VISIT","OWK")
"RTN","SCRPW8",36,0)
 D:$Y>(IOSL-4) XHDR Q:SDOUT  W !?10,"Act. Req./not accepted visits",?47,$J(^TMP(SDS1,$J,SDS2,"VISIT","NWK"),12),?62,$J($S(SDCT=0:0,1:(^TMP(SDS1,$J,SDS2,"VISIT","NWK")*100/SDCT)),8,2)
"RTN","SCRPW8",37,0)
 D:$Y>(IOSL-4) XHDR Q:SDOUT  W !?10,"Transmitted, accepted visits",?47,$J(^TMP(SDS1,$J,SDS2,"VISIT","OWK"),12),?62,$J($S(SDCT=0:0,1:(^TMP(SDS1,$J,SDS2,"VISIT","OWK")*100/SDCT)),8,2)
"RTN","SCRPW8",38,0)
 D TOT
"RTN","SCRPW8",39,0)
 W !! D SHDR(($$HD2()_"   O U T P A T I E N T   U N I Q U E S")) Q:SDOUT
"RTN","SCRPW8",40,0)
 S SDUNCO=^TMP(SDS1,$J,SDS2,"UNIQUE","UNCO"),SDUNAR=^TMP(SDS1,$J,SDS2,"UNIQUE","UNAR"),SDCT=SDUNCO+SDUNAR
"RTN","SCRPW8",41,0)
 D:$Y>(IOSL-4) XHDR Q:SDOUT  W !?10,"Act. Req./not accepted unique pts.",?47,$J(SDUNAR,12),?62,$J($S(SDCT=0:0,1:SDUNAR*100/SDCT),8,2)
"RTN","SCRPW8",42,0)
 D:$Y>(IOSL-4) XHDR Q:SDOUT  W !?10,"Transmitted, accepted unique pts.",?47,$J(SDUNCO,12),?62,$J($S(SDCT=0:0,1:SDUNCO*100/SDCT),8,2) D TOT
"RTN","SCRPW8",43,0)
 Q
"RTN","SCRPW8",44,0)
 ;
"RTN","SCRPW8",45,0)
XHDR I $E(IOST)="C",SDPAGE>1 N DIR S DIR(0)="E" D ^DIR S SDOUT=Y'=1 Q:SDOUT
"RTN","SCRPW8",46,0)
 S SDLINE="",$P(SDLINE,"-",81)="" W:SDPAGE>1!($E(IOST)="C") $$XY^SCRPW50(IOF,1,0) W:$X $$XY^SCRPW50("",0,0) W SDLINE,!?15,"<*>  OUTPATIENT ENCOUNTER WORKLOAD STATISTICS  <*>"
"RTN","SCRPW8",47,0)
 I $D(^TMP("SCRPW",$J)) S X=$$HD1() W !?(80-$L(X)\2),X
"RTN","SCRPW8",48,0)
 W !,SDLINE,!,"For encounter dates ",SDDTPF," to ",SDDTPL,!,"Date printed: ",SDPNOW,?(74-$L(SDPAGE)),"Page: ",SDPAGE,!,SDLINE,! S SDPAGE=SDPAGE+1
"RTN","SCRPW8",49,0)
 Q
"RTN","SCRPW8",50,0)
 ;
"RTN","SCRPW8",51,0)
EXIT K SDTOE0,SDUNCO,SDUNAR,SDCT,DFN,SDDT,SDDTF,SDDTL,SDDTPF,SDDTPL,SDI,SDLINE,SDOE,SDOE0,SDPNOW,SDSTAT,SDSTX,SDTOE,SDTOEE,SDTOE1,SDTX,SDTXS,SDX,SDZ,DTOUT,X,Y,ZTDESC,ZTRTN,ZTSAVE
"RTN","SCRPW8",52,0)
 D KVA^VADPT K X1,X2,SDH,SDHL,SDPNAM,SDSSN,SDPAGE,SDPT0,SDUL,DUOUT,SDARCT,SDST,SDPNOW,SDMD,SDMC,SDDIV,SDDNAM,SDS1,SDS2,SDCG,SDCLGR F I="SCRPW","SCRPWD","SCRPWC" K ^TMP(I,$J)
"RTN","SCRPW8",53,0)
 K I,SDFF,SDOUT,SDSTOP D END^SCRPW50 Q
"RTN","SCRPW8",54,0)
 ;
"RTN","SCRPW8",55,0)
HD1() ;Report subheader 1
"RTN","SCRPW8",56,0)
 Q $S(SDS1="SCRPW":"For station: ",SDS1="SCRPWD":"For division: ",1:"For clinic group: ")_SDS2
"RTN","SCRPW8",57,0)
 ;
"RTN","SCRPW8",58,0)
HD2() ;Report subheader 2
"RTN","SCRPW8",59,0)
 Q $S(SDS1="SCRPW":"F A C I L I T Y",SDS1="SCRPWD":"D I V I S I O N",1:"C L I N I C   G R O U P")
"RTN","SCRPW8",60,0)
 ;
"RTN","SCRPW8",61,0)
DIV() ;Return division name
"RTN","SCRPW8",62,0)
 N X S X=$P($G(^DG(40.8,+$P(SDOE0,U,11),0)),U) Q $S('$L(X):"***UNKNOWN***",1:X)
"RTN","SCRPW8",63,0)
 ;
"RTN","SCRPW8",64,0)
CLGR() ;Return CLINIC GROUP pointer
"RTN","SCRPW8",65,0)
 N X S X=$P($G(^SC(+$P(SDOE0,U,4),0)),U,31),X=$P($G(^SD(409.67,+X,0)),U) Q $S('$L(X):"***NONE ASSIGNED***",1:X)
"RTN","SCRPW8",66,0)
 ;
"RTN","SCRPW8",67,0)
NCT1 I '$D(^TMP(SDS1,$J,SDS2,"VISIT","ACC",DFN)) S SDUNAR=SDUNAR+1 D:SDUL&(SDS1="SCRPW") UL("OWK")
"RTN","SCRPW8",68,0)
 S SDDT=0 F  S SDDT=$O(^TMP(SDS1,$J,SDS2,"VISIT","OWK",DFN,SDDT)) Q:'SDDT  I '$D(^TMP(SDS1,$J,SDS2,"VISIT","ACC",DFN,SDDT)) S SDCT=SDCT+1
"RTN","SCRPW8",69,0)
 Q
"RTN","SCRPW8",70,0)
 ;
"RTN","SCRPW8",71,0)
CT1 I '$D(^TMP(SDS1,$J,SDS2,"VISIT","OWK",DFN)),'$D(^TMP(SDS1,$J,SDS2,"VISIT","ACC",DFN)) S SDUNAR=SDUNAR+1 D:SDUL&(SDS1="SCRPW") UL("NWK")
"RTN","SCRPW8",72,0)
 S SDDT=0 F  S SDDT=$O(^TMP(SDS1,$J,SDS2,"VISIT","NWK",DFN,SDDT)) Q:'SDDT  I '$D(^TMP(SDS1,$J,SDS2,"VISIT","OWK",DFN,SDDT)),'$D(^TMP(SDS1,$J,SDS2,"VISIT","ACC",DFN,SDDT)) S SDCT=SDCT+1
"RTN","SCRPW8",73,0)
 Q
"RTN","SCRPW8",74,0)
 ;
"RTN","SCRPW8",75,0)
UL(SDI) D ^VADPT S SDDT=0 F  S SDDT=$O(^TMP(SDS1,$J,SDS2,"VISIT",SDI,DFN,SDDT)) Q:'SDDT  S ^TMP(SDS1,$J,SDS2,"VISIT","UNARL",VADM(1),DFN,$P(VADM(2),U),SDDT)=""
"RTN","SCRPW8",76,0)
 Q
"RTN","SCRPW8",77,0)
 ;
"RTN","SCRPW8",78,0)
TOT W !?47,"============  =========",!?39,"TOTAL:",?47,$J(SDCT,12),?64,"100.00" Q
"RTN","SCRPW8",79,0)
 ;
"RTN","SCRPW8",80,0)
SHDR(SDTX) D:$Y>(IOSL-6) XHDR Q:SDOUT  W !!?(80-$L(SDTX)\2),SDTX,!?(80-$L(SDTX)\2) F SDX=1:1:$L(SDTX) W "-"
"RTN","SCRPW8",81,0)
 W !!?39,"Status",?54,"Count",?63,"Percent",!?10,"-----------------------------------  ------------  ---------" Q
"RTN","SCRPW8",82,0)
 ;
"RTN","SCRPW8",83,0)
LIST(SDI) Q:'$D(^TMP(SDS1,$J,SDS2,SDI))  D:$Y>(IOSL-4) XHDR Q:SDOUT
"RTN","SCRPW8",84,0)
 W !?10,$P(^SD(409.63,SDI,0),U),?47,$J(^TMP(SDS1,$J,SDS2,SDI),12),?62,$J($S(SDCT=0:0,1:(^TMP(SDS1,$J,SDS2,SDI)*100/SDCT)),8,2)
"RTN","SCRPW8",85,0)
 Q
"RTN","SCRPW8",86,0)
 ;
"RTN","SCRPW8",87,0)
COT D:$Y>(IOSL-4) XHDR Q:SDOUT  W !?15,SDSTAT,?47,$J(^TMP(SDS1,$J,SDS2,2,SDI,SDSTAT),12),?62,$J($S(SDCT=0:0,1:(^TMP(SDS1,$J,SDS2,2,SDI,SDSTAT)*100/SDCT)),8,2) Q
"RTN","SCRPW8",88,0)
 ;
"RTN","SCRPW8",89,0)
STOP ;Check for stop task request
"RTN","SCRPW8",90,0)
 S:$G(ZTQUEUED) (SDOUT,ZTSTOP)=$S($$S^%ZTLOAD:1,1:0) Q
"RTN","SCRPW8",91,0)
 ;
"RTN","SCRPW8",92,0)
COUNT ;Count encounters
"RTN","SCRPW8",93,0)
 S SDSTOP=SDSTOP+1 I SDSTOP#3000=0 D STOP Q:SDOUT
"RTN","SCRPW8",94,0)
 D C1("SCRPW",SDDNAM) D:SDMD C1("SCRPWD",SDDIV) D:SDCLGR C1("SCRPWC",SDCG) Q
"RTN","SCRPW8",95,0)
 ;
"RTN","SCRPW8",96,0)
C1(SDS1,SDS2) ;Set ^TMP global
"RTN","SCRPW8",97,0)
 ;Required input: SDS1,SDS2=subscript values
"RTN","SCRPW8",98,0)
 S DFN=$P(SDOE0,U,2),SDSTAT=+$P(SDOE0,U,12) I SDZ(0),SDZ(4)=SDDIV,SDS1="SCRPW" D DETAIL
"RTN","SCRPW8",99,0)
 S ^TMP(SDS1,$J,SDS2,SDSTAT)=$G(^TMP(SDS1,$J,SDS2,SDSTAT))+1
"RTN","SCRPW8",100,0)
 Q:SDSTAT=4  D:"11423"[SDSTAT VIS Q
"RTN","SCRPW8",101,0)
 ;
"RTN","SCRPW8",102,0)
VIS S ^TMP(SDS1,$J,SDS2,"VISIT",$S(SDSTAT=2:"OWK",1:"NWK"),DFN,$P(SDDT,"."))="" Q:SDSTAT'=2
"RTN","SCRPW8",103,0)
 S SDSTX=$$STX(SDOE,SDOE0),^TMP(SDS1,$J,SDS2,SDSTAT,$P(SDSTX,U),$P(SDSTX,U,2))=$G(^TMP(SDS1,$J,SDS2,SDSTAT,$P(SDSTX,U),$P(SDSTX,U,2)))+1
"RTN","SCRPW8",104,0)
 Q:$P(SDSTX,U)'=8  S ^TMP(SDS1,$J,SDS2,"VISIT","ACC",DFN,$P(SDDT,"."))=""
"RTN","SCRPW8",105,0)
 Q
"RTN","SCRPW8",106,0)
 ;
"RTN","SCRPW8",107,0)
STX(SDOE,SDOE0) ;Determine transmission status
"RTN","SCRPW8",108,0)
 ;Required input: SDOE=OUTPATIENT ENCOUNTER record IFN
"RTN","SCRPW8",109,0)
 ;Required input: SDOE0=zeroeth node of OUTPATIENT ENCOUNTER
"RTN","SCRPW8",110,0)
 N SDTOE,SDTOEE
"RTN","SCRPW8",111,0)
 Q:$P(SDOE0,U,12)'=2 "0^Not checked-out^Not checked-out"
"RTN","SCRPW8",112,0)
 S SDTOE=$O(^SD(409.73,"AENC",SDOE,0)) Q:'SDTOE!'$D(^SD(409.73,+SDTOE,0)) "1^No transmission record^No tx. record"
"RTN","SCRPW8",113,0)
 S SDTOE1=$G(^SD(409.73,SDTOE,1)),SDTOE0=^SD(409.73,SDTOE,0) I '$P(SDTOE0,U,4),'$P(SDTOE1,U) Q "2^Not required, not transmitted^Not req., not tx."
"RTN","SCRPW8",114,0)
 ; SD*5.3*339 added second I SDTOEE below
"RTN","SCRPW8",115,0)
 S SDTOEE=$O(^SD(409.75,"B",SDTOE,0)) I SDTOEE S SDTOEE=$P($G(^SD(409.75,SDTOEE,0)),U,2) I SDTOEE S SDTOEE=$P($G(^SD(409.76,SDTOEE,0)),U,2) Q:SDTOEE="V" "3^Rejected for transmission^Rejected for tx."
"RTN","SCRPW8",116,0)
 Q:'$P(SDTOE1,U) "4^Awaiting transmission^Awaiting tx."
"RTN","SCRPW8",117,0)
 S SDTXS=$P(SDTOE1,U,5) Q:'$L(SDTXS) "5^Transmitted, no acknowledgment^Tx., no ack."
"RTN","SCRPW8",118,0)
 Q:SDTXS="R" "6^Transmitted, rejected^Tx., rejected"
"RTN","SCRPW8",119,0)
 Q:SDTXS'="A" "7^Transmitted, error^Tx., error"
"RTN","SCRPW8",120,0)
 Q "8^Transmitted, accepted^Tx., accepted"
"RTN","SCRPW8",121,0)
 ;
"RTN","SCRPW8",122,0)
DETAIL ;Set global for detailed list
"RTN","SCRPW8",123,0)
 D ^VADPT S SDPNAM=VADM(1),SDSSN=$P(VADM(2),U)
"RTN","SCRPW8",124,0)
 I SDZ(1)="U",SDSTAT'=4 S:"11423"[SDSTAT ^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN,SDSSN)="" Q
"RTN","SCRPW8",125,0)
 I SDZ(1)="V",SDSTAT'=4 S:"11423"[SDSTAT ^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN,SDSSN,$P(SDDT,"."))="" Q
"RTN","SCRPW8",126,0)
 Q:'$D(SDZ(2))  ; SD*5.3*339
"RTN","SCRPW8",127,0)
 I SDZ(2)'=2,SDZ(2)=SDSTAT D DSET Q
"RTN","SCRPW8",128,0)
 Q:SDZ(2)'=2!(SDSTAT'=2)  I 'SDZ(3) D DSET Q
"RTN","SCRPW8",129,0)
 D:+$$STX(SDOE,SDOE0)=SDZ(3) DSET Q
"RTN","SCRPW8",130,0)
 ;
"RTN","SCRPW8",131,0)
DSET S ^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN,SDSSN,SDDT,SDOE)=+$P(SDOE0,U,4) Q
"RTN","SCRPW9")
0^4^B55655282
"RTN","SCRPW9",1,0)
SCRPW9 ;RENO/KEITH - Outpatient Encounter Workload Statistics (cont.) ; 15 Jul 98  02:38PM
"RTN","SCRPW9",2,0)
 ;;5.3;Scheduling;**139,144,339**;AUG 13, 1993
"RTN","SCRPW9",3,0)
UNARL(SDS1,SDS2) ;Print list of 'action required'/not accepted uniques
"RTN","SCRPW9",4,0)
 ;Required input: SDS1,SDS2=subscript values
"RTN","SCRPW9",5,0)
 S SDPAGE=1 D UHDR Q:SDOUT  I '$D(^TMP(SDS1,$J,SDS2,"VISIT","UNARL")) W !!,"No 'action required'/not accepted unique patients identified." Q
"RTN","SCRPW9",6,0)
 S SDARCT=0,SDPNAM="" F  S SDPNAM=$O(^TMP(SDS1,$J,SDS2,"VISIT","UNARL",SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP(SDS1,$J,SDS2,"VISIT","UNARL",SDPNAM,DFN)) Q:'DFN!SDOUT  D UNP
"RTN","SCRPW9",7,0)
 Q:SDOUT  D:$Y>(IOSL-3) UHDR Q:SDOUT  W !!,SDARCT," 'action required'/not accepted unique patient",$S(SDARCT=1:"",1:"s")," identified." Q
"RTN","SCRPW9",8,0)
 ;
"RTN","SCRPW9",9,0)
UNP S SDSSN=$O(^TMP(SDS1,$J,SDS2,"VISIT","UNARL",SDPNAM,DFN,"")) D:$Y>(IOSL-4) UHDR Q:SDOUT  W !,$E(SDPNAM,1,18),?20,SDSSN
"RTN","SCRPW9",10,0)
 S SDARCT=SDARCT+1,(SDDT,SDI)=0 F  S SDDT=$O(^TMP(SDS1,$J,SDS2,"VISIT","UNARL",SDPNAM,DFN,SDSSN,SDDT)) Q:'SDDT!SDOUT  D:$Y>(IOSL-4) UHDR Q:SDOUT  S Y=SDDT X ^DD("DD") W:SDI ! W ?31,Y S SDI=1 D UNP1
"RTN","SCRPW9",11,0)
 Q
"RTN","SCRPW9",12,0)
 ;
"RTN","SCRPW9",13,0)
UNP1 N SDII,SDDT1 S SDII=0,SDDT1=SDDT F  S SDDT1=$O(^SCE("ADFN",DFN,SDDT1)) Q:'SDDT1!(SDDT1>(SDDT+.9999))!SDOUT  D
"RTN","SCRPW9",14,0)
 .S SDOE=0 F  S SDOE=$O(^SCE("ADFN",DFN,SDDT1,SDOE)) Q:'SDOE!SDOUT  S SDOE0=$$GETOE^SDOE(SDOE) I $L(SDOE0),'$P(SDOE0,U,6) D UNP2
"RTN","SCRPW9",15,0)
 .Q
"RTN","SCRPW9",16,0)
 Q
"RTN","SCRPW9",17,0)
 ;
"RTN","SCRPW9",18,0)
UNP2 N SDCL,SDST Q:'$P(SDOE0,U,4)  S SDCL=$P($G(^SC($P(SDOE0,U,4),0)),U),SDST=$P(SDOE0,U,12) Q:'SDST!(SDST=8)!(SDST=12)  S SDST=$S(SDST'=2:$P(^SD(409.63,SDST,0),U),1:$P($$STX^SCRPW8(SDOE,SDOE0),U,3))
"RTN","SCRPW9",19,0)
 D:$Y>(IOSL-4) UHDR Q:SDOUT  W:SDII ! W ?44,$E(SDCL,1,17),?63,$E(SDST,1,17) S SDII=SDII+1 Q
"RTN","SCRPW9",20,0)
 ;
"RTN","SCRPW9",21,0)
UHDR I $E(IOST)="C" N DIR S DIR(0)="E" D ^DIR S SDOUT=Y'=1 Q:SDOUT
"RTN","SCRPW9",22,0)
 D STOP^SCRPW8 Q:SDOUT
"RTN","SCRPW9",23,0)
 W $$XY^SCRPW50(IOF,1,0),SDLINE,!?8,"<*>  LIST OF 'ACTION REQUIRED'/NOT ACCEPTED UNIQUE PATIENTS  <*>",!?(66-$L(SDDNAM)\2),"For station: ",SDDNAM
"RTN","SCRPW9",24,0)
 W !,SDLINE,!,"For encounter dates ",SDDTPF," to ",SDDTPL,!,"Date printed: ",SDPNOW,?(74-$L(SDPAGE)),"Page: ",SDPAGE,!,SDLINE,! S SDPAGE=SDPAGE+1
"RTN","SCRPW9",25,0)
 W:$D(^TMP(SDS1,$J,SDS2,"VISIT","UNARL")) !,"Name:",?20,"SSN:",?31,"Date:",?44,"Location:",?63,"Reason:",! Q
"RTN","SCRPW9",26,0)
 ;
"RTN","SCRPW9",27,0)
DETAIL ;Ask questions for detail of encounters or uniques for a division
"RTN","SCRPW9",28,0)
 K SDZ S SDZ(0)=0 K DIR S DIR(0)="Y",DIR("A")="Would you like to print a detailed list of activity for a division",DIR("B")="NO" W ! D ^DIR I $D(DTOUT)!$D(DUOUT) S SDZ(0)=-1 Q
"RTN","SCRPW9",29,0)
 S SDZ(0)=Y Q:'Y  W !!!,$C(7),"   WARNING: Selection high activity areas will result in lengthy output!",!
"RTN","SCRPW9",30,0)
 K DIR S DIR(0)="S^U:UNIQUES;V:VISITS;E:ENCOUNTERS",DIR("A")="Select type of list" D ^DIR I $D(DTOUT)!$D(DUOUT) S SDZ(0)=-1 Q
"RTN","SCRPW9",31,0)
 S SDZ(1)=Y G:Y'="E" ZDIV
"RTN","SCRPW9",32,0)
DET1 K DIC S DIC="^SD(409.63,",DIC(0)="AEMQ",DIC("S")="I Y<4!(Y=8!(Y=12!(Y=14)))",DIC("A")="Select encounter status: " W ! D ^DIC I $D(DTOUT)!$D(DUOUT)!($G(Y)<1) S SDZ(0)=-1 Q
"RTN","SCRPW9",33,0)
 S SDZ(2)=$P(Y,U) G:SDZ(2)'=2 ZDIV K DIR S DIR("A")="Select transmission status for CHECKED OUT encounters"
"RTN","SCRPW9",34,0)
 S DIR(0)="S^A:All transmission statuses;1:No transmission record;2:Not required, not transmitted;3:Rejected for transmission;4:Awaiting transmission;"
"RTN","SCRPW9",35,0)
 S DIR(0)=DIR(0)_"5:Transmitted, no acknowledgment;6:Transmitted, rejected;7:Transmitted, error;8:Transmitted, accepted"
"RTN","SCRPW9",36,0)
 W ! D ^DIR I $D(DTOUT)!$D(DUOUT) S SDZ(0)=-1 Q  ;SD*5.3*339 add sub-zero
"RTN","SCRPW9",37,0)
 S SDZ(3)=+Y
"RTN","SCRPW9",38,0)
ZDIV ;Get division for detail
"RTN","SCRPW9",39,0)
 I '$P($G(^DG(43,1,"GL")),U,2) S SDZ(4)=$P(^DG(40.8,$$PRIM^VASITE(),0),U) Q
"RTN","SCRPW9",40,0)
 K DIC S DIC="^DG(40.8,",DIC("A")="Select Medical Center division for detail: ",DIC(0)="AEMQ" W ! D ^DIC I $D(DTOUT)!$D(DUOUT) S SDZ(0)=-1 Q
"RTN","SCRPW9",41,0)
 I Y<1 W $C(7),"    Required for patient detail!" G ZDIV
"RTN","SCRPW9",42,0)
 S SDZ(4)=$P(Y,U,2) Q
"RTN","SCRPW9",43,0)
 ;
"RTN","SCRPW9",44,0)
DPRT(SDS1,SDS2) ;Detail print
"RTN","SCRPW9",45,0)
 ;Required input: SDS1,SDS2=subscript values
"RTN","SCRPW9",46,0)
 K SDH S SDPAGE=1,SDH(1)="<*>  DETAILED LIST OF DIVISION "_$S(SDZ(1)="U":"UNIQUES",SDZ(1)="V":"VISITS",1:"ENCOUNTERS")_"  <*>",SDH(2)="For division: "_SDZ(4)
"RTN","SCRPW9",47,0)
 I $G(SDZ(2)) S SDH(3)="Encounters with "_$P(^SD(409.63,SDZ(2),0),U)_" status"
"RTN","SCRPW9",48,0)
 I $G(SDZ(2))=2 S SDH(4)="Transmission status: "_$P($T(TXS+SDZ(3)),";",2)
"RTN","SCRPW9",49,0)
 D DHDR Q:SDOUT  I '$D(^TMP(SDS1,$J,SDS2,"DETAIL")) W !,"No records found in this category." Q
"RTN","SCRPW9",50,0)
 S SDCT=0 D @SDZ(1) Q
"RTN","SCRPW9",51,0)
 ;
"RTN","SCRPW9",52,0)
U ;Print uniques
"RTN","SCRPW9",53,0)
 S SDPNAM="" F  S SDPNAM=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN)) Q:'DFN!SDOUT  D U1
"RTN","SCRPW9",54,0)
 Q:SDOUT  W !!,SDCT," uniques identified." Q
"RTN","SCRPW9",55,0)
 ;
"RTN","SCRPW9",56,0)
U1 S SDCT=SDCT+1,SDSSN=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN,"")) D:$Y>(IOSL-4) DHDR Q:SDOUT  W !,$E(SDPNAM,1,18),?21,SDSSN Q
"RTN","SCRPW9",57,0)
 ;
"RTN","SCRPW9",58,0)
V ;Print visits
"RTN","SCRPW9",59,0)
 S SDPNAM="" F  S SDPNAM=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN)) Q:'DFN!SDOUT  S SDSSN=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN,"")) D V1
"RTN","SCRPW9",60,0)
 Q:SDOUT  W !!,SDCT," visits identified." Q
"RTN","SCRPW9",61,0)
 ;
"RTN","SCRPW9",62,0)
V1 D:$Y>(IOSL-4) DHDR Q:SDOUT  W !,$E(SDPNAM,1,18),?21,SDSSN S (SDDT,SDI)=0 F  S SDDT=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN,SDSSN,SDDT)) Q:'SDDT!SDOUT  D
"RTN","SCRPW9",63,0)
 .D:$Y>(IOSL-3) DHDR Q:SDOUT  S Y=SDDT X ^DD("DD") W:SDI ! W ?32,Y S SDCT=SDCT+1,SDI=SDI+1
"RTN","SCRPW9",64,0)
 .Q
"RTN","SCRPW9",65,0)
 Q
"RTN","SCRPW9",66,0)
 ;
"RTN","SCRPW9",67,0)
E ;Print encounters
"RTN","SCRPW9",68,0)
 S SDPNAM="" F  S SDPNAM=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM)) Q:SDPNAM=""!SDOUT  S DFN=0 F  S DFN=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN)) Q:'DFN!SDOUT  S SDSSN=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN,"")) D E1
"RTN","SCRPW9",69,0)
 Q:SDOUT  W !!,SDCT," encounters identified." Q
"RTN","SCRPW9",70,0)
 ;
"RTN","SCRPW9",71,0)
E1 D:$Y>(IOSL-4) DHDR Q:SDOUT  W !,$E(SDPNAM,1,18),?21,SDSSN
"RTN","SCRPW9",72,0)
 S (SDDT,SDI)=0 F  S SDDT=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN,SDSSN,SDDT)) Q:'SDDT!SDOUT  S SDOE=0 F  S SDOE=$O(^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN,SDSSN,SDDT,SDOE)) Q:'SDOE!SDOUT  D E2
"RTN","SCRPW9",73,0)
 Q
"RTN","SCRPW9",74,0)
 ;
"RTN","SCRPW9",75,0)
E2 D:$Y>(IOSL-3) DHDR Q:SDOUT  S SDHL=^TMP(SDS1,$J,SDS2,"DETAIL",SDPNAM,DFN,SDSSN,SDDT,SDOE),SDHL=$P($G(^SC(+SDHL,0)),U),Y=SDDT X ^DD("DD") W:SDI ! W ?32,$P(Y,":",1,2),?50,SDHL S SDCT=SDCT+1,SDI=SDI+1 Q
"RTN","SCRPW9",76,0)
 ;
"RTN","SCRPW9",77,0)
DHDR I $E(IOST)="C" N DIR S DIR(0)="E" D ^DIR S SDOUT=Y'=1 Q:SDOUT
"RTN","SCRPW9",78,0)
 D STOP^SCRPW8 Q:SDOUT
"RTN","SCRPW9",79,0)
 W $$XY^SCRPW50(IOF,1,0),SDLINE S I=0 F  S I=$O(SDH(I)) Q:'I  W !?(80-$L(SDH(I))\2),SDH(I)
"RTN","SCRPW9",80,0)
 W !,SDLINE,!,"For date range: ",SDDTPF," to ",SDDTPL,!,"Date printed: ",SDPNOW,?(74-$L(SDPAGE)),"Page: ",SDPAGE,!,SDLINE,! S SDPAGE=SDPAGE+1 Q
"RTN","SCRPW9",81,0)
 ;
"RTN","SCRPW9",82,0)
TXS ;All transmission statuses
"RTN","SCRPW9",83,0)
 ;No transmission record
"RTN","SCRPW9",84,0)
 ;Not required, not transmitted
"RTN","SCRPW9",85,0)
 ;Rejected for transmission
"RTN","SCRPW9",86,0)
 ;Awaiting transmission
"RTN","SCRPW9",87,0)
 ;Transmitted, no acknowledgment
"RTN","SCRPW9",88,0)
 ;Transmitted, rejected
"RTN","SCRPW9",89,0)
 ;Transmitted, error
"RTN","SCRPW9",90,0)
 ;Transmitted, accepted
"RTN","SCRPW9",91,0)
 ;
"RTN","SCRPW9",92,0)
PARM ;Prompt for report parameters
"RTN","SCRPW9",93,0)
 D TITL^SCRPW50("Outpatient Encounter Workload Statistics")
"RTN","SCRPW9",94,0)
 N %DT,DIR,DIC D SUBT^SCRPW50("*** Date Range Selection ***")
"RTN","SCRPW9",95,0)
FDT W ! S %DT="AEPX",%DT("A")="Beginning date:  FIRST// ",%DT(0)=2961001 D ^%DT G:X=U!$D(DTOUT) EXIT^SCRPW8 I X="" S (Y,SDDTF)=2961001 X ^DD("DD") W "  ",Y,! S SDDTPF=Y G LDT
"RTN","SCRPW9",96,0)
 G:Y<1 FDT S SDDTF=Y X ^DD("DD") S SDDTPF=Y W !
"RTN","SCRPW9",97,0)
LDT S %DT("A")="Ending date:  LAST// " D ^%DT G:X=U!$D(DTOUT) EXIT^SCRPW8 I X="" S X1=DT,X2=-1 D C^%DTC S (Y,SDDTL)=X X ^DD("DD") W "  ",Y,! S SDDTPL=Y G ASK
"RTN","SCRPW9",98,0)
 I Y<SDDTF W !!,$C(7),"Ending date must be after beginning date!",! G LDT
"RTN","SCRPW9",99,0)
 G:Y<1 LDT S SDDTL=Y X ^DD("DD") S SDDTPL=Y,SDDTL=SDDTL_".999999"
"RTN","SCRPW9",100,0)
ASK D SUBT^SCRPW50("*** Additional Detail Selection ***")
"RTN","SCRPW9",101,0)
 W ! K DIR S DIR(0)="Y",DIR("A")="Break out workload by clinic group",DIR("B")="NO",DIR("?")="Specify if subtotals by encounter location CLINIC GROUP should be provided." D ^DIR G:$D(DTOUT)!$D(DUOUT) EXIT^SCRPW8 S SDCLGR=Y
"RTN","SCRPW9",102,0)
 D DETAIL^SCRPW9 W ! G:SDZ(0)=-1 EXIT^SCRPW8
"RTN","SCRPW9",103,0)
 K DIR S DIR(0)="Y",DIR("A")="List facility 'action required'/not accepted unique patients",DIR("B")="NO" D ^DIR G:$D(DTOUT)!$D(DUOUT) EXIT^SCRPW8 S SDUL=Y W !
"RTN","SCRPW9",104,0)
QUE S ZTRTN="PST^SCRPW8",ZTDESC="Outpatient Encounter Workload" F SDI="SDCLGR","SDDTF","SDDTPF","SDDTL","SDDTPL","SDUL","SDDUL","SDZ(" S ZTSAVE(SDI)=""
"RTN","SCRPW9",105,0)
 D EN^XUTMDEVQ(ZTRTN,ZTDESC,.ZTSAVE) G EXIT^SCRPW8
"RTN","SDAMBMR2")
0^3^B23768902
"RTN","SDAMBMR2",1,0)
SDAMBMR2 ;ALB/MLI - PRINT AMBULATORY PROCEDURES MANAGEMENT REPORTS ; 4/27/00 12:14pm
"RTN","SDAMBMR2",2,0)
 ;;5.3;Scheduling;**28,140,132,180,339**;Aug 13, 1993
"RTN","SDAMBMR2",3,0)
HD S SDPG=SDPG+1 W @IOF,!?20,"AMBULATORY PROCEDURE MANAGEMENT REPORTS",!!,"DATE RANGE: ",SDB,"-",SDE,?50,"DATE PRINTED: ",SDNOW,!,$S(SDFL:SDSTR_" NAME:",1:"ALL "_SDSTR_"S"),?16,SDT,?71,"PAGE: ",$J(SDPG,3) Q
"RTN","SDAMBMR2",4,0)
DT S SDB=SDB+.1,SDE=SDE-.9,SDB=$TR($$FMTE^XLFDT(SDB,"5DF")," ","0"),SDE=$TR($$FMTE^XLFDT(SDE,"5DF")," ","0") Q
"RTN","SDAMBMR2",5,0)
1 S SDSTR=$S(SDSC="C":"CLINIC",1:"SERVICE") D DT G 2:SDRT="E" I SDSC="C" S I=0 F I1=0:0 S I=$S(VAUTC:$O(^TMP($J,I)),1:$O(VAUTC(I))) Q:I=""!SDFG  I $D(^TMP($J,I,"T")),^("T") S SDT=I,SDFL=1 D P^SDAMBMR3 Q:SDFG
"RTN","SDAMBMR2",6,0)
 I SDSC="S" F I="M","N","P","R","S" I SDAS!$D(SDS(I)) I ^TMP($J,I,"T") D SET,P^SDAMBMR3 Q:SDFG
"RTN","SDAMBMR2",7,0)
 D TOT Q
"RTN","SDAMBMR2",8,0)
2 G 3:SDPN="N" S I=0
"RTN","SDAMBMR2",9,0)
 F I1=0:0 D:I'=0 P^SDAMBMR3 Q:SDFG  S I=$O(^TMP($J,"*PRO",I)) Q:I=""!(SDSC="S"&I)!SDFG  D SET,HD2 Q:SDFG  F J=0:0 D:J T S J=$O(^TMP($J,"*PRO",I,J)) Q:J=""  D CD,PN:SDPT=1 D:$Y>(IOSL-5) HD2 Q:SDFG
"RTN","SDAMBMR2",10,0)
 D TOT Q
"RTN","SDAMBMR2",11,0)
3 S (SDFL,I)=0,SDSTR=$S(SDSC="C":"CLINIC",1:"SERVICE")
"RTN","SDAMBMR2",12,0)
 F I1=0:0 D:SDFL P^SDAMBMR3 S SDFL=0,I=$O(^TMP($J,"*PTC",I)) Q:I=""!SDFG  D SET,HD3 Q:SDFG  D CONT
"RTN","SDAMBMR2",13,0)
 D TOT Q
"RTN","SDAMBMR2",14,0)
CONT S J=0 F J1=0:0 S J=$O(^TMP($J,"*PTC",I,J)) Q:J=""!SDFG  S K=0 F K1=0:0 S K=$O(^TMP($J,"*PTC",I,J,K)) Q:K=""  D C D:$Y>(IOSL-5) HD3 Q:SDFG
"RTN","SDAMBMR2",15,0)
 Q
"RTN","SDAMBMR2",16,0)
PN S L=0,K="A"
"RTN","SDAMBMR2",17,0)
 F K1=0:0 S K=$O(^TMP($J,"*PRO",I,J,K)) Q:K=""!SDFG  F L1=0:0 S L=$O(^TMP($J,"*PRO",I,J,K,L)) Q:L=""!SDFG  F M=0:0 S M=$O(^TMP($J,"*PRO",I,J,K,L,M)) Q:M=""  S SDINFO=^(M) D PNAME D:$Y>(IOSL-5) HD2 Q:SDFG
"RTN","SDAMBMR2",18,0)
 Q
"RTN","SDAMBMR2",19,0)
 ;
"RTN","SDAMBMR2",20,0)
PNAME N %
"RTN","SDAMBMR2",21,0)
 F %=1:1:$P(SDINFO,U,4) W !,?8,$E(K,1,18),?28,$P(SDINFO,U,10),?39,"AGE: ",$J($P(SDINFO,U,2),3),?49,$S($P(SDINFO,U)=1:"VETERAN",1:"NON-VET"),?58,$P(SDINFO,U,3),?61 S VADAT("W")=M D ^VADATE W VADATE("E")
"RTN","SDAMBMR2",22,0)
 Q
"RTN","SDAMBMR2",23,0)
 ;
"RTN","SDAMBMR2",24,0)
 ;If prompt "Sort by 'P'rocedure or patient 'N'ame: P//PROCEDURE"
"RTN","SDAMBMR2",25,0)
 ;CPTMOD is called to print Procedure (CPT) codes and associated
"RTN","SDAMBMR2",26,0)
 ;Modifiers.
"RTN","SDAMBMR2",27,0)
CD N BLKLN,MODCODE,MODINFO,MODTEXT,MODVAL,SDJJ,KK
"RTN","SDAMBMR2",28,0)
 S (BLKLN,MODVAL)=0,SDHI=I D HD2:($Y>(IOSL-5)) Q:SDFG
"RTN","SDAMBMR2",29,0)
 S J=$P($$CPT^ICPTCOD(J,0),"^",1)  ; equals IEN for CPT
"RTN","SDAMBMR2",30,0)
 S KK=$P($$CPT^ICPTCOD(J,0),"^",2)  ; SD*5.3*339 external CPT value
"RTN","SDAMBMR2",31,0)
 W !!,$G(KK)  ; SD*5.3*339 print external CPT code
"RTN","SDAMBMR2",32,0)
 S I=J D N W ?7,$E(SDN,1,72) S I=SDHI
"RTN","SDAMBMR2",33,0)
 Q:'SDMOD
"RTN","SDAMBMR2",34,0)
 I $D(^TMP($J,"*PRO",I,J,0)) S MODVAL=$P(^TMP($J,"*PRO",I,J,0),"^",2,99)
"RTN","SDAMBMR2",35,0)
 I $D(^TMP($J,"*PRO",I,J,1)) S MODVAL=$P(^TMP($J,"*PRO",I,J,1),"^",2,99)
"RTN","SDAMBMR2",36,0)
 Q:'MODVAL
"RTN","SDAMBMR2",37,0)
 F SDJJ=1:1:$L(MODVAL,"^") S MODINFO=$P(MODVAL,"^",SDJJ)  D
"RTN","SDAMBMR2",38,0)
 . S MODINFO=$$MOD^ICPTMOD(MODINFO,"I",,1)
"RTN","SDAMBMR2",39,0)
 . Q:MODINFO'>0
"RTN","SDAMBMR2",40,0)
 . S MODCODE="-"_$P(MODINFO,"^",2)
"RTN","SDAMBMR2",41,0)
 . S MODTEXT=$P(MODINFO,"^",3)
"RTN","SDAMBMR2",42,0)
 . W !?2,MODCODE,?8,$E(MODTEXT,1,65)
"RTN","SDAMBMR2",43,0)
 . Q
"RTN","SDAMBMR2",44,0)
 W !
"RTN","SDAMBMR2",45,0)
 Q
"RTN","SDAMBMR2",46,0)
HD2 Q:SDFG  I IOST?1"C-".E R !?20,"Enter <RETURN> to continue",SDFG1:DTIME I SDFG1["^"!'$T S SDFG=1 Q
"RTN","SDAMBMR2",47,0)
 D HD W !!?25,"SUMMARY OF PROCEDURES PERFORMED",! K Y S $P(Y,"-",81)="" W Y Q
"RTN","SDAMBMR2",48,0)
HD3 Q:SDFG  I IOST?1"C-".E R !?20,"Enter <RETURN> to continue",SDFG1:DTIME I SDFG1["^"!'$T S SDFG=1 Q
"RTN","SDAMBMR2",49,0)
 D HD W !!?31,"SUMMARY BY PATIENT",!,"NAME",?27,"SSN",?38,"AGE",?43,"VET/NON",?53,"SEX",?60,"DATE/TIME OF STOP",! K Y S $P(Y,"-",81)="" W Y
"RTN","SDAMBMR2",50,0)
SET S SDT=$S(SDSC="C":I,I="M":"MEDICINE",I="N":"NEUROLOGY",I="P":"PSYCHIATRY",I="R":"REHAB MEDICINE",I="S":"SURGERY",I="Z":"NONE",1:"UNKNOWN"),SDFL=1 Q
"RTN","SDAMBMR2",51,0)
T W !?8,"TOTAL PROCEDURES==>",?30,"VETERAN:",?39,$J($S($D(^TMP($J,"*PRO",I,J,1)):$P(^(1),"^",1),1:0),4),?47,"NON-VETERAN:",$J($S($D(^(0)):$P(^(0),"^",1),1:0),4)
"RTN","SDAMBMR2",52,0)
 W ?69,"TOTAL:",?76,$J($S($D(^TMP($J,"*PRO",I,J,0))&$D(^(1)):$P(^(0),"^",1)+$P(^(1),"^",1),'$D(^(0)):$P(^(1),"^",1),1:$P(^(0),"^",1)),4) Q
"RTN","SDAMBMR2",53,0)
C F L=-1:0 S L=$O(^TMP($J,"*PTC",I,J,K,L)) Q:L=""  F M=0:0 S M=$O(^TMP($J,"*PTC",I,J,K,L,M)) Q:M=""  M SDINFO=^(M) D C2
"RTN","SDAMBMR2",54,0)
 Q
"RTN","SDAMBMR2",55,0)
C2 W !!,$E(J,1,24),?27,$P(SDINFO,U,10) ; 10th piece is ssn
"RTN","SDAMBMR2",56,0)
 W ?38,$P(SDINFO,U),?43,$S(L=1:"VETERAN",1:"NON-VET"),?52,$S($P(SDINFO,U,2)="M":" MALE",1:"FEMALE"),?60 S VADAT("W")=M D ^VADATE W VADATE("E") D LIST
"RTN","SDAMBMR2",57,0)
 Q
"RTN","SDAMBMR2",58,0)
 ;
"RTN","SDAMBMR2",59,0)
 ;If "Sort by 'P'rocedure or patient 'N'ame: P//NAME" the patient name
"RTN","SDAMBMR2",60,0)
 ;,Procedure (CPT) Codes and Modifiers will be printed.
"RTN","SDAMBMR2",61,0)
LIST N BLKLN,MODCODE,MODINFO,MODTEXT,MODVAL,SDJJ
"RTN","SDAMBMR2",62,0)
 S BLKLN=1
"RTN","SDAMBMR2",63,0)
 F PR=11:1 S SDPRO=$P(SDINFO,U,PR) Q:'SDPRO  D
"RTN","SDAMBMR2",64,0)
 . S SDHI=I D HD:($Y>(IOSL)) Q:SDFG
"RTN","SDAMBMR2",65,0)
 . W !?5,$P($$CPT^ICPTCOD(SDPRO,0),U) S I=SDPRO D N
"RTN","SDAMBMR2",66,0)
 . W ?12,$E(SDN,1,67) S I=SDHI
"RTN","SDAMBMR2",67,0)
 . Q:'SDMOD
"RTN","SDAMBMR2",68,0)
 . S MODVAL=SDINFO(PR-10)
"RTN","SDAMBMR2",69,0)
 . F SDJJ=1:1:$L(MODVAL,"^") S MODINFO=$P(MODVAL,"^",SDJJ)  D
"RTN","SDAMBMR2",70,0)
 . . S MODINFO=$$MOD^ICPTMOD(MODINFO,"I",,1)
"RTN","SDAMBMR2",71,0)
 . . Q:MODINFO'>0
"RTN","SDAMBMR2",72,0)
 . . S MODCODE="-"_$P(MODINFO,"^",2)
"RTN","SDAMBMR2",73,0)
 . . S MODTEXT=$P(MODINFO,"^",3)
"RTN","SDAMBMR2",74,0)
 . . W !?7,MODCODE,?13,$E(MODTEXT,1,65)
"RTN","SDAMBMR2",75,0)
 . . Q
"RTN","SDAMBMR2",76,0)
 . W !
"RTN","SDAMBMR2",77,0)
 . Q
"RTN","SDAMBMR2",78,0)
 Q
"RTN","SDAMBMR2",79,0)
TOT Q:SDFG  K I S SDT="",SDFL=0 D P^SDAMBMR3 Q
"RTN","SDAMBMR2",80,0)
 ;
"RTN","SDAMBMR2",81,0)
 ;Retrieves the Procedure (CPT) Code description by calling API
"RTN","SDAMBMR2",82,0)
 ;CPTD^ICPTCOD
"RTN","SDAMBMR2",83,0)
N N DATA,SDIX,SDDATA,SDCOUNT
"RTN","SDAMBMR2",84,0)
 S SDN="",DATA=""
"RTN","SDAMBMR2",85,0)
 ;F  S DATA=$O(DESCR(DATA)) Q:'DATA  S SDN=SDN_" "_DESCR(DATA) Q:$L(SDN)>72
"RTN","SDAMBMR2",86,0)
 ;SDDATA will contain the returned information from the call to CPTD^ICPTCOD.
"RTN","SDAMBMR2",87,0)
 ;This is an extrinsic function, and can't be called with a "Do" statement.
"RTN","SDAMBMR2",88,0)
 S SDDATA=$$CPTD^ICPTCOD(I,"DESCR")
"RTN","SDAMBMR2",89,0)
 S SDCOUNT=$P(SDDATA,"^",1)
"RTN","SDAMBMR2",90,0)
 F SDIX=1:1:SDCOUNT S SDN=SDN_" "_DESCR(SDIX) Q:$L(SDN)>72
"RTN","SDAMBMR2",91,0)
 S SDN=$E(SDN,1,72)
"RTN","SDAMBMR2",92,0)
 Q
"VER")
8.0^22
**END**
**END**
