Released PXRM*1.5*10 SEQ #10
Extracted from mail message
**KIDS**:PXRM*1.5*10^

**INSTALL NAME**
PXRM*1.5*10
"BLD",3503,0)
PXRM*1.5*10^CLINICAL REMINDERS^0^3020415^y
"BLD",3503,1,0)
^^2^2^3020405^^^^
"BLD",3503,1,1,0)
This patch makes changes to MST synchronization and dialog so that
"BLD",3503,1,2,0)
dates passed to the MST API will not be rejected by the API.
"BLD",3503,4,0)
^9.64PA^^0
"BLD",3503,"INI")

"BLD",3503,"INID")
^
"BLD",3503,"INIT")

"BLD",3503,"KRN",0)
^9.67PA^8989.52^19
"BLD",3503,"KRN",.4,0)
.4
"BLD",3503,"KRN",.4,"NM",0)
^9.68A^^0
"BLD",3503,"KRN",.401,0)
.401
"BLD",3503,"KRN",.402,0)
.402
"BLD",3503,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",3503,"KRN",.403,0)
.403
"BLD",3503,"KRN",.5,0)
.5
"BLD",3503,"KRN",.84,0)
.84
"BLD",3503,"KRN",3.6,0)
3.6
"BLD",3503,"KRN",3.8,0)
3.8
"BLD",3503,"KRN",9.2,0)
9.2
"BLD",3503,"KRN",9.8,0)
9.8
"BLD",3503,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",3503,"KRN",9.8,"NM",1,0)
PXRMMST^^0^B68157558
"BLD",3503,"KRN",9.8,"NM",2,0)
PXRMRPCC^^0^B8208823
"BLD",3503,"KRN",9.8,"NM",3,0)
PXRMPINF^^0^B10259937
"BLD",3503,"KRN",9.8,"NM","B","PXRMMST",1)

"BLD",3503,"KRN",9.8,"NM","B","PXRMPINF",3)

"BLD",3503,"KRN",9.8,"NM","B","PXRMRPCC",2)

"BLD",3503,"KRN",19,0)
19
"BLD",3503,"KRN",19,"NM",0)
^9.68A^^0
"BLD",3503,"KRN",19.1,0)
19.1
"BLD",3503,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",3503,"KRN",101,0)
101
"BLD",3503,"KRN",101,"NM",0)
^9.68A^^
"BLD",3503,"KRN",409.61,0)
409.61
"BLD",3503,"KRN",771,0)
771
"BLD",3503,"KRN",870,0)
870
"BLD",3503,"KRN",8989.51,0)
8989.51
"BLD",3503,"KRN",8989.52,0)
8989.52
"BLD",3503,"KRN",8994,0)
8994
"BLD",3503,"KRN","B",.4,.4)

"BLD",3503,"KRN","B",.401,.401)

"BLD",3503,"KRN","B",.402,.402)

"BLD",3503,"KRN","B",.403,.403)

"BLD",3503,"KRN","B",.5,.5)

"BLD",3503,"KRN","B",.84,.84)

"BLD",3503,"KRN","B",3.6,3.6)

"BLD",3503,"KRN","B",3.8,3.8)

"BLD",3503,"KRN","B",9.2,9.2)

"BLD",3503,"KRN","B",9.8,9.8)

"BLD",3503,"KRN","B",19,19)

"BLD",3503,"KRN","B",19.1,19.1)

"BLD",3503,"KRN","B",101,101)

"BLD",3503,"KRN","B",409.61,409.61)

"BLD",3503,"KRN","B",771,771)

"BLD",3503,"KRN","B",870,870)

"BLD",3503,"KRN","B",8989.51,8989.51)

"BLD",3503,"KRN","B",8989.52,8989.52)

"BLD",3503,"KRN","B",8994,8994)

"BLD",3503,"QUES",0)
^9.62^^
"BLD",3503,"REQB",0)
^9.611^1^1
"BLD",3503,"REQB",1,0)
PXRM*1.5*9^2
"BLD",3503,"REQB","B","PXRM*1.5*9",1)

"MBREQ")
0
"PKG",364,-1)
1^1
"PKG",364,0)
CLINICAL REMINDERS^PXRM^Clinical Reminders^^^3020327
"PKG",364,20,0)
^9.402P^^
"PKG",364,22,0)
^9.49I^1^1
"PKG",364,22,1,0)
1.5^3000619^3000622^1342
"PKG",364,22,1,"PAH",1,0)
10^3020415
"PKG",364,22,1,"PAH",1,1,0)
^^2^2^3020415
"PKG",364,22,1,"PAH",1,1,1,0)
This patch makes changes to MST synchronization and dialog so that
"PKG",364,22,1,"PAH",1,1,2,0)
dates passed to the MST API will not be rejected by the API.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","PXRMMST")
0^1^B68157558
"RTN","PXRMMST",1,0)
PXRMMST ; SLC/PKR - Routines for dealing with MST. ;04/12/2002
"RTN","PXRMMST",2,0)
 ;;1.5;CLINICAL REMINDERS;**7,10**;Jun 19, 2000
"RTN","PXRMMST",3,0)
 ;
"RTN","PXRMMST",4,0)
 ;=======================================================================
"RTN","PXRMMST",5,0)
GSYINFO(TYPE) ;Return the Clinical Reminders MST synchronization date
"RTN","PXRMMST",6,0)
 ;and number of updates made. The format is an up-arrow delimited
"RTN","PXRMMST",7,0)
 ;string. The first piece is the date and the second is the number
"RTN","PXRMMST",8,0)
 ;of updates. If TYPE is "I" then the data for the initial
"RTN","PXRMMST",9,0)
 ;synchronization is returned. For any other value the data for the
"RTN","PXRMMST",10,0)
 ;last daily synchronization is returned.
"RTN","PXRMMST",11,0)
 I $G(TYPE)="I" Q $P($G(^PXRM(800,1,"MST")),U,1,2) Q
"RTN","PXRMMST",12,0)
 Q $P($G(^PXRM(800,1,"MST")),U,3,4)
"RTN","PXRMMST",13,0)
 ;
"RTN","PXRMMST",14,0)
 ;=======================================================================
"RTN","PXRMMST",15,0)
QUE ;Queue the MST synchronization job.
"RTN","PXRMMST",16,0)
 N DIR,DTOUT,DUOUT,MINDT,SDTIME,STIME,X,Y
"RTN","PXRMMST",17,0)
 S MINDT=$$NOW^XLFDT
"RTN","PXRMMST",18,0)
 W !,"Queue the Clinical Reminders MST synchronization."
"RTN","PXRMMST",19,0)
 S DIR("A",1)="Enter the date and time you want the job to start."
"RTN","PXRMMST",20,0)
 S DIR("A")="It must be after "_$$FMTE^XLFDT(MINDT,"5Z")_" "
"RTN","PXRMMST",21,0)
 S DIR(0)="DAU"_U_MINDT_"::RSX"
"RTN","PXRMMST",22,0)
 D ^DIR
"RTN","PXRMMST",23,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PXRMMST",24,0)
 S SDTIME=Y
"RTN","PXRMMST",25,0)
 K DIR
"RTN","PXRMMST",26,0)
 S DIR(0)="YA"
"RTN","PXRMMST",27,0)
 S DIR("A")="Do you want to run the MST synchronization at the same time every day? "
"RTN","PXRMMST",28,0)
 S DIR("B")="Y"
"RTN","PXRMMST",29,0)
 D ^DIR
"RTN","PXRMMST",30,0)
 I $D(DTOUT)!$D(DUOUT) Q
"RTN","PXRMMST",31,0)
 I Y S STIME="1."_$P(SDTIME,".",2)
"RTN","PXRMMST",32,0)
 E  S STIME=-1
"RTN","PXRMMST",33,0)
 ;
"RTN","PXRMMST",34,0)
 ;Put the task into the queue.
"RTN","PXRMMST",35,0)
 K ZTSAVE
"RTN","PXRMMST",36,0)
 ;S ZTSAVE("START")=SDTIME
"RTN","PXRMMST",37,0)
 S ZTSAVE("STIME")=STIME
"RTN","PXRMMST",38,0)
 S ZTRTN="SYNCH^PXRMMST"
"RTN","PXRMMST",39,0)
 S ZTDESC="Clinical Reminders MST synchronization job"
"RTN","PXRMMST",40,0)
 S ZTDTH=SDTIME
"RTN","PXRMMST",41,0)
 S ZTIO=""
"RTN","PXRMMST",42,0)
 D ^%ZTLOAD
"RTN","PXRMMST",43,0)
 W !,"Task number ",ZTSK," queued."
"RTN","PXRMMST",44,0)
 Q
"RTN","PXRMMST",45,0)
 ;
"RTN","PXRMMST",46,0)
 ;=======================================================================
"RTN","PXRMMST",47,0)
STATUS(DFN,TEST,DATE,VALUE,TEXT) ;Computed finding for checking a
"RTN","PXRMMST",48,0)
 ;patient's MST status.
"RTN","PXRMMST",49,0)
 N IEN,TEMP
"RTN","PXRMMST",50,0)
 S TEMP=$$GETSTAT^DGMSTAPI(DFN)
"RTN","PXRMMST",51,0)
 S IEN=$P(TEMP,U,1)
"RTN","PXRMMST",52,0)
 I IEN=-1 D  Q
"RTN","PXRMMST",53,0)
 . S TEST=0
"RTN","PXRMMST",54,0)
 . S VALUE=""
"RTN","PXRMMST",55,0)
 . S DATE=DT
"RTN","PXRMMST",56,0)
 I IEN=0 D  Q
"RTN","PXRMMST",57,0)
 . S TEST=0
"RTN","PXRMMST",58,0)
 . S VALUE=$P(TEMP,U,2)
"RTN","PXRMMST",59,0)
 . S DATE=$P(TEMP,U,3)
"RTN","PXRMMST",60,0)
 . S TEXT="No MST status found"
"RTN","PXRMMST",61,0)
 ;If we get to here then a valid entry was found.
"RTN","PXRMMST",62,0)
 S TEST=1
"RTN","PXRMMST",63,0)
 S VALUE=$P(TEMP,U,2)
"RTN","PXRMMST",64,0)
 S DATE=$P(TEMP,U,3)
"RTN","PXRMMST",65,0)
 Q
"RTN","PXRMMST",66,0)
 ;
"RTN","PXRMMST",67,0)
 ;=======================================================================
"RTN","PXRMMST",68,0)
STCODE(TERM) ;Return the MST status code based on the term name.
"RTN","PXRMMST",69,0)
 N STCODE
"RTN","PXRMMST",70,0)
 S STCODE=$S(TERM="MST DECLINES REPORT":"D",TERM="MST NEGATIVE REPORT":"N",TERM="MST POSITIVE REPORT":"Y",1:"U")
"RTN","PXRMMST",71,0)
 Q STCODE
"RTN","PXRMMST",72,0)
 ;
"RTN","PXRMMST",73,0)
 ;=======================================================================
"RTN","PXRMMST",74,0)
SYNCH ;Synchronize the MST history file.
"RTN","PXRMMST",75,0)
 N INID,LTIME,NUMUPD,START,TEMP
"RTN","PXRMMST",76,0)
 ;STIME is passed from QUE via ZTSAVE.
"RTN","PXRMMST",77,0)
 D UPDSTAT(.NUMUPD,.START)
"RTN","PXRMMST",78,0)
 ;If the initial sync data has been stored then update the daily
"RTN","PXRMMST",79,0)
 ;data.
"RTN","PXRMMST",80,0)
 S INID=+$P($G(^PXRM(800,1,"MST")),U,1)
"RTN","PXRMMST",81,0)
 I INID>0 D
"RTN","PXRMMST",82,0)
 . S $P(^PXRM(800,1,"MST"),U,3)=$$NOW^XLFDT
"RTN","PXRMMST",83,0)
 . S $P(^PXRM(800,1,"MST"),U,4)=NUMUPD
"RTN","PXRMMST",84,0)
 . S $P(^PXRM(800,1,"MST"),U,6)=START
"RTN","PXRMMST",85,0)
 E  D
"RTN","PXRMMST",86,0)
 . S $P(^PXRM(800,1,"MST"),U,1)=$$NOW^XLFDT
"RTN","PXRMMST",87,0)
 . S $P(^PXRM(800,1,"MST"),U,2)=NUMUPD
"RTN","PXRMMST",88,0)
 . S $P(^PXRM(800,1,"MST"),U,5)=START
"RTN","PXRMMST",89,0)
 ;
"RTN","PXRMMST",90,0)
 ;Cleanup the task stuff.
"RTN","PXRMMST",91,0)
 I STIME=-1 S ZTREQ="@" Q
"RTN","PXRMMST",92,0)
 E  D
"RTN","PXRMMST",93,0)
 . S TEMP=$G(^PXRM(800,1,"MST"))
"RTN","PXRMMST",94,0)
 . S LTIME=+$P(TEMP,U,3)
"RTN","PXRMMST",95,0)
 . I LTIME=0 S LTIME=+$P(TEMP,U,1)
"RTN","PXRMMST",96,0)
 .;Adding STIME sets the new starting time at exactly one day following
"RTN","PXRMMST",97,0)
 .;the previous starting time.
"RTN","PXRMMST",98,0)
 . S $P(ZTREQ,U,1)=$P(LTIME,".",1)+STIME
"RTN","PXRMMST",99,0)
 Q
"RTN","PXRMMST",100,0)
 ;
"RTN","PXRMMST",101,0)
 ;=======================================================================
"RTN","PXRMMST",102,0)
SYNREP ;Provide a report of the synchronization data.
"RTN","PXRMMST",103,0)
 N EDTIME,EITIME,IDATE,LDATE,NIUPD,NLUPD,TEMP
"RTN","PXRMMST",104,0)
 S TEMP=$G(^PXRM(800,1,"MST"))
"RTN","PXRMMST",105,0)
 S IDATE=$$FMTE^XLFDT($P(TEMP,U,1))
"RTN","PXRMMST",106,0)
 I IDATE=0 S IDATE="none"
"RTN","PXRMMST",107,0)
 S NIUPD=$P(TEMP,U,2)
"RTN","PXRMMST",108,0)
 S EITIME=$$FMDIFF^XLFDT($P(TEMP,U,1),$P(TEMP,U,5),2)
"RTN","PXRMMST",109,0)
 S LDATE=$$FMTE^XLFDT($P(TEMP,U,3))
"RTN","PXRMMST",110,0)
 I LDATE=0 S LDATE="none"
"RTN","PXRMMST",111,0)
 S NLUPD=$P(TEMP,U,4)
"RTN","PXRMMST",112,0)
 S EDTIME=$$FMDIFF^XLFDT($P(TEMP,U,3),$P(TEMP,U,6),2)
"RTN","PXRMMST",113,0)
 W !!,"Clinical Reminders MST Synchronization Report"
"RTN","PXRMMST",114,0)
 W !,"---------------------------------------------"
"RTN","PXRMMST",115,0)
 W !,"Initial synchronization date: ",IDATE
"RTN","PXRMMST",116,0)
 W !,"Number of updates made: ",NIUPD
"RTN","PXRMMST",117,0)
 I EITIME>60 D
"RTN","PXRMMST",118,0)
 . S EITIME=$$FMDIFF^XLFDT($P(TEMP,U,1),$P(TEMP,U,5),3)
"RTN","PXRMMST",119,0)
 . W !,"Elapsed time: ",EITIME
"RTN","PXRMMST",120,0)
 E  W !,"Elapsed time: ",EITIME," secs"
"RTN","PXRMMST",121,0)
 W !!,"Last daily synchronization date: ",LDATE
"RTN","PXRMMST",122,0)
 W !,"Number of updates made: ",NLUPD
"RTN","PXRMMST",123,0)
 I EDTIME>60 D
"RTN","PXRMMST",124,0)
 . S EDTIME=$$FMDIFF^XLFDT($P(TEMP,U,3),$P(TEMP,U,6),3)
"RTN","PXRMMST",125,0)
 . W !,"Elapsed time: ",EDTIME
"RTN","PXRMMST",126,0)
 E  W !,"Elapsed time: ",EDTIME," secs"
"RTN","PXRMMST",127,0)
 Q
"RTN","PXRMMST",128,0)
 ;
"RTN","PXRMMST",129,0)
 ;=======================================================================
"RTN","PXRMMST",130,0)
UPDATE(DFN,VISIT,SOURCE,STCODE,TYPE) ;Make an update to the MST History file.
"RTN","PXRMMST",131,0)
 N DATE,MSTDATE,PROV,STAT,TEMP,UPDSTAT,VPRVIEN
"RTN","PXRMMST",132,0)
 S UPDSTAT=-1
"RTN","PXRMMST",133,0)
 ;If the update is because of a protocol event use NOW for the
"RTN","PXRMMST",134,0)
 ;date/time. If it is being done as part of a synchronization use
"RTN","PXRMMST",135,0)
 ;the date the visit was created.
"RTN","PXRMMST",136,0)
 I TYPE="PROTOCOL" S DATE=$$NOW^XLFDT
"RTN","PXRMMST",137,0)
 E  S DATE=$P($G(^AUPNVSIT(VISIT,0)),U,2)
"RTN","PXRMMST",138,0)
 ;If the date does not contain the time use noon.
"RTN","PXRMMST",139,0)
 I DATE'["." S DATE=DATE_".12"
"RTN","PXRMMST",140,0)
 S STAT=$$GETSTAT^DGMSTAPI(DFN)
"RTN","PXRMMST",141,0)
 S MSTDATE=$S($P(STAT,U,1)>0:$P(STAT,U,3),1:0)
"RTN","PXRMMST",142,0)
 I DATE>MSTDATE D
"RTN","PXRMMST",143,0)
 .;Determine the provider.
"RTN","PXRMMST",144,0)
 . S TEMP="^"_$P(SOURCE,";",2)_$P(SOURCE,";",1)_",12)"
"RTN","PXRMMST",145,0)
 . S PROV=$P($G(@TEMP),U,4)
"RTN","PXRMMST",146,0)
 . I PROV="" D
"RTN","PXRMMST",147,0)
 .. S VPRVIEN=+$O(^AUPNVPRV("AD",VISIT,""))
"RTN","PXRMMST",148,0)
 .. I VPRVIEN>0 S PROV=$P(^AUPNVPRV(VPRVIEN,0),U,1)
"RTN","PXRMMST",149,0)
 . S UPDSTAT=$$NEWSTAT^DGMSTAPI(DFN,STCODE,DATE,PROV)
"RTN","PXRMMST",150,0)
 . I +UPDSTAT=-1 D
"RTN","PXRMMST",151,0)
 .. N FN,GBL,IEN,NAME,TARGET,XMSUB,VADM
"RTN","PXRMMST",152,0)
 .. K ^TMP("PXRMXMZ",$J)
"RTN","PXRMMST",153,0)
 .. S XMSUB="CLINICAL REMINDER MST UPDATE PROBLEM"
"RTN","PXRMMST",154,0)
 .. S ^TMP("PXRMXMZ",$J,1,0)="NEWSTAT^DGMSTAPI returned the following error:"
"RTN","PXRMMST",155,0)
 .. S ^TMP("PXRMXMZ",$J,2,0)=$P(TEMP,U,2)
"RTN","PXRMMST",156,0)
 .. S ^TMP("PXRMXMZ",$J,3,0)="The following data was passed to NEWSTAT^DGMSTAPI"
"RTN","PXRMMST",157,0)
 .. S ^TMP("PXRMXMZ",$J,4,0)="DFN= "_DFN
"RTN","PXRMMST",158,0)
 .. S ^TMP("PXRMXMZ",$J,5,0)="Status code= "_STCODE
"RTN","PXRMMST",159,0)
 .. S ^TMP("PXRMXMZ",$J,6,0)="Date= "_DATE
"RTN","PXRMMST",160,0)
 .. S ^TMP("PXRMXMZ",$J,7,0)="Provider= "_PROV
"RTN","PXRMMST",161,0)
 .. S ^TMP("PXRMXMZ",$J,8,0)="Data source= "_SOURCE
"RTN","PXRMMST",162,0)
 .. S ^TMP("PXRMXMZ",$J,9,0)="This corresponds to the following:"
"RTN","PXRMMST",163,0)
 .. D DEM^VADPT
"RTN","PXRMMST",164,0)
 .. S ^TMP("PXRMXMZ",$J,10,0)="Patient= "_VADM(1)
"RTN","PXRMMST",165,0)
 .. S ^TMP("PXRMXMZ",$J,11,0)="SSN= "_$P(VADM(2),U,2)
"RTN","PXRMMST",166,0)
 .. S ^TMP("PXRMXMZ",$J,12,0)="MST Status= "_$$EXTERNAL^DILFD(29.11,3,"",STCODE)
"RTN","PXRMMST",167,0)
 .. S ^TMP("PXRMXMZ",$J,13,0)="Date= "_$$FMTE^XLFDT(DATE,"5Z")
"RTN","PXRMMST",168,0)
 .. I PROV="" S TEMP="Unknown"
"RTN","PXRMMST",169,0)
 .. E  S TEMP=$$GET1^DIQ(200,PROV,.01,"","","")
"RTN","PXRMMST",170,0)
 .. I TEMP="" S TEMP="Unknown"
"RTN","PXRMMST",171,0)
 .. S ^TMP("PXRMXMZ",$J,14,0)="Provider= "_TEMP
"RTN","PXRMMST",172,0)
 .. S GBL="^"_$P($P(SOURCE,";",2),"(",1)
"RTN","PXRMMST",173,0)
 .. S TEMP=GBL_"(0)"
"RTN","PXRMMST",174,0)
 .. S FN=+$P(@TEMP,U,2)
"RTN","PXRMMST",175,0)
 .. S TEMP=GBL_"("_$P(SOURCE,";",1)_",0)"
"RTN","PXRMMST",176,0)
 .. S TEMP=$G(@TEMP)
"RTN","PXRMMST",177,0)
 .. S IEN=$P(TEMP,U,1)
"RTN","PXRMMST",178,0)
 .. D FIELD^DID(FN,.01,"N","POINTER","TARGET")
"RTN","PXRMMST",179,0)
 .. S GBL="^"_$P(TARGET("POINTER"),"(",1)
"RTN","PXRMMST",180,0)
 .. S TEMP=GBL_"(0)"
"RTN","PXRMMST",181,0)
 .. S FN=$P(@TEMP,U,1)
"RTN","PXRMMST",182,0)
 .. S TEMP=GBL_"("_IEN_",0)"
"RTN","PXRMMST",183,0)
 .. S NAME=$P(@TEMP,U,1)
"RTN","PXRMMST",184,0)
 .. S ^TMP("PXRMXMZ",$J,14,0)="Data type= "_FN
"RTN","PXRMMST",185,0)
 .. S ^TMP("PXRMXMZ",$J,15,0)="Name= "_NAME
"RTN","PXRMMST",186,0)
 .. D SEND^PXRMMSG(XMSUB)
"RTN","PXRMMST",187,0)
 Q UPDSTAT
"RTN","PXRMMST",188,0)
 ;
"RTN","PXRMMST",189,0)
 ;=======================================================================
"RTN","PXRMMST",190,0)
UPDPAT(DFN,VISIT,VFL) ;Update the MST history file for a single patient
"RTN","PXRMMST",191,0)
 ;using term mappings. Called from DATACHG^PXRMPINF which is invoked
"RTN","PXRMMST",192,0)
 ;by the protocol PXK VISIT DATA EVENT.
"RTN","PXRMMST",193,0)
 N AFTER,BEFORE,DGBL,SP,STCODE,SIEN,SOURCE
"RTN","PXRMMST",194,0)
 N TEMP,TERM,TERMIEN,VF
"RTN","PXRMMST",195,0)
 ;Search all the MST terms to build patient lists.
"RTN","PXRMMST",196,0)
 F TERM="MST DECLINES REPORT","MST NEGATIVE REPORT","MST POSITIVE REPORT" D
"RTN","PXRMMST",197,0)
 . S TERMIEN=$O(^PXRMD(811.5,"B",TERM,""))
"RTN","PXRMMST",198,0)
 . S VF=""
"RTN","PXRMMST",199,0)
 . F  S VF=$O(VFL(VF)) Q:VF=""  D
"RTN","PXRMMST",200,0)
 .. I VFL(VF)=U Q
"RTN","PXRMMST",201,0)
 .. S DGBL=$P(VFL(VF),U,1)
"RTN","PXRMMST",202,0)
 .. I '$D(^PXRMD(811.5,TERMIEN,20,"E",DGBL)) Q
"RTN","PXRMMST",203,0)
 .. S SIEN=""
"RTN","PXRMMST",204,0)
 .. F  S SIEN=$O(^TMP("PXKCO",$J,VISIT,VF,SIEN)) Q:SIEN=""  D
"RTN","PXRMMST",205,0)
 ... S AFTER=$G(^TMP("PXKCO",$J,VISIT,VF,SIEN,0,"AFTER"))
"RTN","PXRMMST",206,0)
 ... S BEFORE=$G(^TMP("PXKCO",$J,VISIT,VF,SIEN,0,"BEFORE"))
"RTN","PXRMMST",207,0)
 ... I AFTER=BEFORE Q
"RTN","PXRMMST",208,0)
 ... S SP=$P(AFTER,U,1)
"RTN","PXRMMST",209,0)
 ... I SP="" Q
"RTN","PXRMMST",210,0)
 ... I '$D(^PXRMD(811.5,TERMIEN,20,"E",DGBL,SP)) Q
"RTN","PXRMMST",211,0)
 ... S SOURCE=SIEN_";"_$P(VFL(VF),U,2)
"RTN","PXRMMST",212,0)
 ...;The status code depends on the term name.
"RTN","PXRMMST",213,0)
 ... S STCODE=$$STCODE(TERM)
"RTN","PXRMMST",214,0)
 ... S TEMP=$$UPDATE(DFN,VISIT,SOURCE,STCODE,"PROTOCOL")
"RTN","PXRMMST",215,0)
 Q
"RTN","PXRMMST",216,0)
 ;
"RTN","PXRMMST",217,0)
 ;=======================================================================
"RTN","PXRMMST",218,0)
UPDSTAT(NUMUPD,START) ;Update the MST history file using term mappings.
"RTN","PXRMMST",219,0)
 N DFN,FIEVAL,FINDING,INDEX,STCODE,SOURCE
"RTN","PXRMMST",220,0)
 N TERM,TERMIEN,UPDSTAT,VDATE,VISIT
"RTN","PXRMMST",221,0)
 ;Set the start time for the synchronization.
"RTN","PXRMMST",222,0)
 S START=$$NOW^XLFDT
"RTN","PXRMMST",223,0)
 S INDEX="PXRM_MST_LIST"
"RTN","PXRMMST",224,0)
 S NUMUPD=0
"RTN","PXRMMST",225,0)
 ;Search all the MST terms to build patient lists.
"RTN","PXRMMST",226,0)
 F TERM="MST DECLINES REPORT","MST NEGATIVE REPORT","MST POSITIVE REPORT" D
"RTN","PXRMMST",227,0)
 . K ^TMP(INDEX,$J)
"RTN","PXRMMST",228,0)
 .;The status code depends on the term name.
"RTN","PXRMMST",229,0)
 . S STCODE=$$STCODE(TERM)
"RTN","PXRMMST",230,0)
 . S TERMIEN=$O(^PXRMD(811.5,"B",TERM,""))
"RTN","PXRMMST",231,0)
 . D PATLIST^PXRMTERM(INDEX,TERMIEN,1,"","",.FIEVAL)
"RTN","PXRMMST",232,0)
 . S DFN=0
"RTN","PXRMMST",233,0)
 . F  S DFN=+$O(^TMP(INDEX,$J,DFN)) Q:DFN=0  D
"RTN","PXRMMST",234,0)
 .. S VDATE=$O(^TMP(INDEX,$J,DFN,""))
"RTN","PXRMMST",235,0)
 .. S FINDING=$O(^TMP(INDEX,$J,DFN,VDATE,""))
"RTN","PXRMMST",236,0)
 .. S VISIT=$$ATTVALUE^PXRMUTIL(^TMP(INDEX,$J,DFN,VDATE,FINDING),"VISIT",U,"~")
"RTN","PXRMMST",237,0)
 .. S SOURCE=$$ATTVALUE^PXRMUTIL(^TMP(INDEX,$J,DFN,VDATE,FINDING),"SOURCE",U,"~")
"RTN","PXRMMST",238,0)
 .. S UPDSTAT=$$UPDATE(DFN,VISIT,SOURCE,STCODE,"SYNCH")
"RTN","PXRMMST",239,0)
 .. I UPDSTAT'=-1 S NUMUPD=NUMUPD+1
"RTN","PXRMMST",240,0)
 K ^TMP(INDEX,$J)
"RTN","PXRMMST",241,0)
 Q
"RTN","PXRMMST",242,0)
 ;
"RTN","PXRMPINF")
0^3^B10259937
"RTN","PXRMPINF",1,0)
PXRMPINF ; SLC/PKR - Routines relating to patient information. ;04/12/2002
"RTN","PXRMPINF",2,0)
 ;;1.5;CLINICAL REMINDERS;**2,10**;Jun 19, 2000
"RTN","PXRMPINF",3,0)
 ;
"RTN","PXRMPINF",4,0)
 ;=======================================================================
"RTN","PXRMPINF",5,0)
DATACHG ;This entry point is called whenever patient data has changed.
"RTN","PXRMPINF",6,0)
 ;It is attached to the following event points:
"RTN","PXRMPINF",7,0)
 ;PXK VISIT DATA EVENT
"RTN","PXRMPINF",8,0)
 ;
"RTN","PXRMPINF",9,0)
 I '$D(^TMP("PXKCO",$J)) Q
"RTN","PXRMPINF",10,0)
 N DATA,DFN,DGBL,NODE,PXRMDFN,VIEN,VISIT,VF,VFL,VGBL
"RTN","PXRMPINF",11,0)
 S DFN=""
"RTN","PXRMPINF",12,0)
 ;Look for PXK VISIT DATA EVENT data.
"RTN","PXRMPINF",13,0)
 S VISIT=$O(^TMP("PXKCO",$J,""))
"RTN","PXRMPINF",14,0)
 S VIEN=$O(^TMP("PXKCO",$J,VISIT,"VST",""))
"RTN","PXRMPINF",15,0)
 S NODE=$O(^TMP("PXKCO",$J,VISIT,"VST",VIEN,""))
"RTN","PXRMPINF",16,0)
 S DATA=$G(^TMP("PXKCO",$J,VISIT,"VST",VIEN,NODE,"AFTER"))
"RTN","PXRMPINF",17,0)
 I DATA="" S DATA=$G(^TMP("PXKCO",$J,VISIT,"VST",VIEN,NODE,"BEFORE"))
"RTN","PXRMPINF",18,0)
 S DFN=$P(DATA,U,5)
"RTN","PXRMPINF",19,0)
 S PXRMDFN="PXRMDFN"_DFN
"RTN","PXRMPINF",20,0)
 D KILLPC(PXRMDFN)
"RTN","PXRMPINF",21,0)
 ;
"RTN","PXRMPINF",22,0)
 ;Build the list of V Files.
"RTN","PXRMPINF",23,0)
 S VF=""
"RTN","PXRMPINF",24,0)
 F  S VF=$O(^TMP("PXKCO",$J,VISIT,VF)) Q:VF=""  D
"RTN","PXRMPINF",25,0)
 . S DGBL=$S(VF="CPT":"PXD(811.2,",VF="HF":"AUTTHF(",VF="IMM":"AUTTIMM(",VF="PED":"AUTTEDT(",VF="POV":"PXD(811.2,",VF="SK":"AUTTSK(",VF="XAM":"AUTTEXAM(",1:"")
"RTN","PXRMPINF",26,0)
 . S VGBL=$S(VF="CPT":"AUPNVCPT(",VF="HF":"AUPNVHF(",VF="IMM":"AUPNVIMM(",VF="PED":"AUPNVPED(",VF="POV":"AUPNVPOV(",VF="SK":"AUPNVSK(",VF="XAM":"AUPNVXAM(",1:"")
"RTN","PXRMPINF",27,0)
 . S VFL(VF)=DGBL_U_VGBL
"RTN","PXRMPINF",28,0)
 ;
"RTN","PXRMPINF",29,0)
 ;Call the routines that need to process the data.
"RTN","PXRMPINF",30,0)
 D UPDPAT^PXRMMST(DFN,VISIT,.VFL)
"RTN","PXRMPINF",31,0)
 Q
"RTN","PXRMPINF",32,0)
 ;
"RTN","PXRMPINF",33,0)
 ;=======================================================================
"RTN","PXRMPINF",34,0)
DEM(DFN) ;Load the patient demographics.
"RTN","PXRMPINF",35,0)
 I $L(DFN)'>0 Q "NO PATIENT"
"RTN","PXRMPINF",36,0)
 N DATEBLT,EXPDATE,NOW,PATIENT,TEMP
"RTN","PXRMPINF",37,0)
 S PXRMDFN="PXRMDFN"_DFN
"RTN","PXRMPINF",38,0)
 ;Since the Kernel Installation Guide suggests running XUTL once every
"RTN","PXRMPINF",39,0)
 ;7 days we need to check for expired patient caches.
"RTN","PXRMPINF",40,0)
 S TEMP=$G(^XTMP(PXRMDFN,0))
"RTN","PXRMPINF",41,0)
 S DATEBLT=+$P(TEMP,U,2)
"RTN","PXRMPINF",42,0)
 S EXPDATE=+$P(TEMP,U,1)
"RTN","PXRMPINF",43,0)
 ;If the patient's problem list has been modified since the cache was
"RTN","PXRMPINF",44,0)
 ;last built kill it.
"RTN","PXRMPINF",45,0)
 S NOW=$$NOW^XLFDT
"RTN","PXRMPINF",46,0)
 I (NOW>EXPDATE)!((+$$MOD^GMPLUTL3(DFN))>(DATEBLT)) D KILLPC(PXRMDFN)
"RTN","PXRMPINF",47,0)
 ;
"RTN","PXRMPINF",48,0)
 I '$$LOCKPC(PXRMDFN) Q "NO LOCK"
"RTN","PXRMPINF",49,0)
 I $D(^XTMP(PXRMDFN,0)) D
"RTN","PXRMPINF",50,0)
 . S PATIENT=^XTMP(PXRMDFN,"PATIENT")
"RTN","PXRMPINF",51,0)
 . S PXRMSSN=^XTMP(PXRMDFN,"SSN")
"RTN","PXRMPINF",52,0)
 . S PXRMDOB=^XTMP(PXRMDFN,"DOB")
"RTN","PXRMPINF",53,0)
 . S PXRMAGE=^XTMP(PXRMDFN,"AGE")
"RTN","PXRMPINF",54,0)
 . S PXRMSEX=^XTMP(PXRMDFN,"SEX")
"RTN","PXRMPINF",55,0)
 . S PXRMDOD=^XTMP(PXRMDFN,"DOD")
"RTN","PXRMPINF",56,0)
 . S PXRMRACE=^XTMP(PXRMDFN,"RACE")
"RTN","PXRMPINF",57,0)
 E  D
"RTN","PXRMPINF",58,0)
 . D DEM^VADPT
"RTN","PXRMPINF",59,0)
 . S (PATIENT,^XTMP(PXRMDFN,"PATIENT"))=VADM(1)
"RTN","PXRMPINF",60,0)
 . S (PXRMSSN,^XTMP(PXRMDFN,"SSN"))=VADM(2)
"RTN","PXRMPINF",61,0)
 . S (PXRMDOB,^XTMP(PXRMDFN,"DOB"))=$P(VADM(3),U,1)
"RTN","PXRMPINF",62,0)
 . S (PXRMAGE,^XTMP(PXRMDFN,"AGE"))=VADM(4)
"RTN","PXRMPINF",63,0)
 . S (PXRMSEX,^XTMP(PXRMDFN,"SEX"))=VADM(5)
"RTN","PXRMPINF",64,0)
 . S (PXRMDOD,^XTMP(PXRMDFN,"DOD"))=$P(VADM(6),U,1)
"RTN","PXRMPINF",65,0)
 . S (PXRMRACE,^XTMP(PXRMDFN,"RACE"))=$P(VADM(8),U,2)
"RTN","PXRMPINF",66,0)
 . D KVA^VADPT
"RTN","PXRMPINF",67,0)
 . S ^XTMP(PXRMDFN,0)=$$FMADD^XLFDT(NOW,1)_U_NOW_U_"PXRM PATIENT DATA CACHE"
"RTN","PXRMPINF",68,0)
 ;If PXRMDATE has a value then the reminder is evaluated as if PXRMDATE
"RTN","PXRMPINF",69,0)
 ;is the current date.
"RTN","PXRMPINF",70,0)
 I +$G(PXRMDATE)>0 D
"RTN","PXRMPINF",71,0)
 . S PXRMAGE=$$AGE^PXRMAGE(PXRMDOB,PXRMDATE)
"RTN","PXRMPINF",72,0)
 I $L(PATIENT)'>0 Q "NO PATIENT"
"RTN","PXRMPINF",73,0)
 E  Q 1
"RTN","PXRMPINF",74,0)
 ;
"RTN","PXRMPINF",75,0)
 ;=======================================================================
"RTN","PXRMPINF",76,0)
KILLPC(PXRMDFN) ;Kill the patient cache. See DBA 3411 (Inpatient Pharmacy)
"RTN","PXRMPINF",77,0)
 N LOCK
"RTN","PXRMPINF",78,0)
 S LOCK=$$LOCKPC(PXRMDFN)
"RTN","PXRMPINF",79,0)
 I LOCK D
"RTN","PXRMPINF",80,0)
 . K ^XTMP(PXRMDFN)
"RTN","PXRMPINF",81,0)
 . D UNLOCKPC(PXRMDFN)
"RTN","PXRMPINF",82,0)
 Q
"RTN","PXRMPINF",83,0)
 ;
"RTN","PXRMPINF",84,0)
 ;=======================================================================
"RTN","PXRMPINF",85,0)
LOCKPC(PXRMDFN) ;Lock the patient cache.
"RTN","PXRMPINF",86,0)
 N IND,LOCK
"RTN","PXRMPINF",87,0)
 S LOCK=0
"RTN","PXRMPINF",88,0)
 F IND=1:1:30 Q:LOCK  D
"RTN","PXRMPINF",89,0)
 . L +^XTMP(PXRMDFN):1
"RTN","PXRMPINF",90,0)
 . S LOCK=$T
"RTN","PXRMPINF",91,0)
 Q LOCK
"RTN","PXRMPINF",92,0)
 ;
"RTN","PXRMPINF",93,0)
 ;=======================================================================
"RTN","PXRMPINF",94,0)
UNLOCKPC(PXRMDFN) ;Unlock the patient cache.
"RTN","PXRMPINF",95,0)
 L -^XTMP(PXRMDFN)
"RTN","PXRMPINF",96,0)
 Q
"RTN","PXRMPINF",97,0)
 ;
"RTN","PXRMRPCC")
0^2^B8208823
"RTN","PXRMRPCC",1,0)
PXRMRPCC ;SLC/PJH - PXRM REMINDER DIALOG ;04/12/2002
"RTN","PXRMRPCC",2,0)
 ;;1.5;CLINICAL REMINDERS;**2,7,10**;Jun 19, 2000
"RTN","PXRMRPCC",3,0)
 ;
"RTN","PXRMRPCC",4,0)
ACTIVE(ORY,ORREM) ;Check if active dialog exist for reminders
"RTN","PXRMRPCC",5,0)
 ;
"RTN","PXRMRPCC",6,0)
 ; input parameter ORREM is array of reminder ien [.01#811.9]
"RTN","PXRMRPCC",7,0)
 N DDIS,DIEN,OCNT,RIEN,RSTA
"RTN","PXRMRPCC",8,0)
 S OCNT=0,RIEN=0
"RTN","PXRMRPCC",9,0)
 ;Get reminder ien from array
"RTN","PXRMRPCC",10,0)
 F  S RIEN=$O(ORREM(RIEN)) Q:'RIEN  D
"RTN","PXRMRPCC",11,0)
 .;Dialog ien for reminder
"RTN","PXRMRPCC",12,0)
 .S DIEN=$P($G(^PXD(811.9,RIEN,51)),U),RSTA=0
"RTN","PXRMRPCC",13,0)
 .;Dialog status
"RTN","PXRMRPCC",14,0)
 .I DIEN S DDIS=$P($G(^PXRMD(801.41,DIEN,0)),U,3)
"RTN","PXRMRPCC",15,0)
 .;If dialog and dialog not disabled
"RTN","PXRMRPCC",16,0)
 .I DIEN,DDIS="" S RSTA=1
"RTN","PXRMRPCC",17,0)
 .;Return reminder and if active dialog exists
"RTN","PXRMRPCC",18,0)
 .S OCNT=OCNT+1,ORY(OCNT)=RIEN_U_RSTA
"RTN","PXRMRPCC",19,0)
 Q
"RTN","PXRMRPCC",20,0)
 ;
"RTN","PXRMRPCC",21,0)
 ;
"RTN","PXRMRPCC",22,0)
DIALOG(ORY,ORREM) ;Load reminder dialog associated with the reminder
"RTN","PXRMRPCC",23,0)
 ;
"RTN","PXRMRPCC",24,0)
 ; input parameter ORREM - reminder ien [.01,#811.9]
"RTN","PXRMRPCC",25,0)
 ;
"RTN","PXRMRPCC",26,0)
 N DATA,DIEN
"RTN","PXRMRPCC",27,0)
 S DIEN=$G(^PXD(811.9,ORREM,51))
"RTN","PXRMRPCC",28,0)
 ;
"RTN","PXRMRPCC",29,0)
 ;Quit if no dialog for this reminder
"RTN","PXRMRPCC",30,0)
 I 'DIEN S ORY(1)="-1^no dialog for this reminder" Q
"RTN","PXRMRPCC",31,0)
 ;
"RTN","PXRMRPCC",32,0)
 ;Check if a reminder dialog and enabled
"RTN","PXRMRPCC",33,0)
 S DATA=$G(^PXRMD(801.41,DIEN,0))
"RTN","PXRMRPCC",34,0)
 ;
"RTN","PXRMRPCC",35,0)
 I $P(DATA,U,4)'="R" S ORY(1)="-1^reminder dialog invalid" Q
"RTN","PXRMRPCC",36,0)
 ;
"RTN","PXRMRPCC",37,0)
 I $P(DATA,U,3) S ORY(1)="-1^reminder dialog disabled" Q
"RTN","PXRMRPCC",38,0)
 ;
"RTN","PXRMRPCC",39,0)
 ;Load dialog lines into local array
"RTN","PXRMRPCC",40,0)
 D LOAD^PXRMDLL(DIEN)
"RTN","PXRMRPCC",41,0)
 Q
"RTN","PXRMRPCC",42,0)
 ;
"RTN","PXRMRPCC",43,0)
HDR(ORY,ORLOC) ;Progress Note Header by location/service/user
"RTN","PXRMRPCC",44,0)
 N ORSRV,PASS
"RTN","PXRMRPCC",45,0)
 S ORSRV=$G(^VA(200,DUZ,5)) I +ORSRV>0 S ORSRV=$P(ORSRV,U)
"RTN","PXRMRPCC",46,0)
 S PASS=DUZ_";VA(200,"
"RTN","PXRMRPCC",47,0)
 I +$G(ORLOC) S PASS=PASS_"^LOC.`"_ORLOC
"RTN","PXRMRPCC",48,0)
 I ORSRV S PASS=PASS_"^SRV.`"_+$G(ORSRV)
"RTN","PXRMRPCC",49,0)
 S ORY=$$GET^XPAR(PASS_"^DIV^SYS^PKG","PXRM PROGRESS NOTE HEADERS",1,"Q")
"RTN","PXRMRPCC",50,0)
 Q
"RTN","PXRMRPCC",51,0)
 ;
"RTN","PXRMRPCC",52,0)
PROMPT(ORY,ORDLG,ORDCUR,ORFTYP) ;Load additional prompts for a dialog element
"RTN","PXRMRPCC",53,0)
 ;
"RTN","PXRMRPCC",54,0)
 ; input parameters
"RTN","PXRMRPCC",55,0)
 ;
"RTN","PXRMRPCC",56,0)
 ; ORDLG  - dialog element ien [.01,#801.41]
"RTN","PXRMRPCC",57,0)
 ; ORDCUR - 0 = current, 1 = Historical for taxonomies only
"RTN","PXRMRPCC",58,0)
 ; ORFTYP - finding type (CPT/POV) for taxonomies only
"RTN","PXRMRPCC",59,0)
 ;
"RTN","PXRMRPCC",60,0)
 ; These fields can be found in the output array of DIALOG^PXRMRPCC
"RTN","PXRMRPCC",61,0)
 ;
"RTN","PXRMRPCC",62,0)
 D LOAD^PXRMDLLA(ORDLG,ORDCUR,$G(ORFTYP))
"RTN","PXRMRPCC",63,0)
 Q 
"RTN","PXRMRPCC",64,0)
 ;
"RTN","PXRMRPCC",65,0)
RES(ORY,ORREM) ; Reminder Resources/Inquiry
"RTN","PXRMRPCC",66,0)
 ;
"RTN","PXRMRPCC",67,0)
 ; input parameter ORREM - reminder ien [.01,#811.9]
"RTN","PXRMRPCC",68,0)
 ;
"RTN","PXRMRPCC",69,0)
 D REMVAR^PXRMINQ(.ORY,ORREM)
"RTN","PXRMRPCC",70,0)
 Q
"RTN","PXRMRPCC",71,0)
 ;
"RTN","PXRMRPCC",72,0)
MH(ORY,OTEST) ; Mental Health dialog
"RTN","PXRMRPCC",73,0)
 ;
"RTN","PXRMRPCC",74,0)
 ; Input mental health instrument NAME
"RTN","PXRMRPCC",75,0)
 ;
"RTN","PXRMRPCC",76,0)
 N YS,ARRAY S YS("CODE")=OTEST D SHOWALL^YTAPI3(.ARRAY,.YS) ; DBIA 2895
"RTN","PXRMRPCC",77,0)
 ;
"RTN","PXRMRPCC",78,0)
 N FNODE,FSUB,IC,NODE,OCNT,SUB
"RTN","PXRMRPCC",79,0)
 S SUB="ARRAY",OCNT=0
"RTN","PXRMRPCC",80,0)
 F  S SUB=$Q(@SUB) Q:SUB=""  D
"RTN","PXRMRPCC",81,0)
 .S FSUB=$P($P(SUB,"(",2),")"),FNODE=""
"RTN","PXRMRPCC",82,0)
 .F IC=1:1 S NODE=$P(FSUB,",",IC) Q:NODE=""  D
"RTN","PXRMRPCC",83,0)
 ..I $E(NODE)="""" S NODE=$P(NODE,"""",2)
"RTN","PXRMRPCC",84,0)
 ..S $P(FNODE,";",IC)=NODE
"RTN","PXRMRPCC",85,0)
 .Q:FNODE=""
"RTN","PXRMRPCC",86,0)
 .S OCNT=OCNT+1,ORY(OCNT)=FNODE_U_@SUB
"RTN","PXRMRPCC",87,0)
 Q
"RTN","PXRMRPCC",88,0)
 ;
"RTN","PXRMRPCC",89,0)
MHR(ORY,RESULT,ORES) ; Mental Health score and P/N text
"RTN","PXRMRPCC",90,0)
 ;
"RTN","PXRMRPCC",91,0)
 ; Input MH result IEN and mental health instrument response
"RTN","PXRMRPCC",92,0)
 ;
"RTN","PXRMRPCC",93,0)
 D ^PXRMDLR
"RTN","PXRMRPCC",94,0)
 ;
"RTN","PXRMRPCC",95,0)
 Q
"RTN","PXRMRPCC",96,0)
 ;
"RTN","PXRMRPCC",97,0)
MHS(ORY,YS) ; Mental Health save response
"RTN","PXRMRPCC",98,0)
 ;
"RTN","PXRMRPCC",99,0)
 ; Input mental health instrument response
"RTN","PXRMRPCC",100,0)
 N ARRAY
"RTN","PXRMRPCC",101,0)
 D SAVEIT^YTAPI1(.ARRAY,.YS) ; DBIA 2893
"RTN","PXRMRPCC",102,0)
 I ARRAY(1)'="[DATA]" S ORY(1)="-1^"_ARRAY(1)_ARRAY(2)
"RTN","PXRMRPCC",103,0)
 I ARRAY(1)="[DATA]" S ORY(1)=ARRAY(1)_ARRAY(2)
"RTN","PXRMRPCC",104,0)
 Q
"RTN","PXRMRPCC",105,0)
 ;
"RTN","PXRMRPCC",106,0)
MST(ORY,DFN,DGMSTDT,DGMSTSC,DGMSTPR,FTYP,FIEN,RESULT) ; File MST status
"RTN","PXRMRPCC",107,0)
 ;This is obsolete and can be removed when the GUI is changed not
"RTN","PXRMRPCC",108,0)
 ;to use it.
"RTN","PXRMRPCC",109,0)
 Q
"RTN","PXRMRPCC",110,0)
 ;
"VER")
8.0^22.0
**END**
**END**
