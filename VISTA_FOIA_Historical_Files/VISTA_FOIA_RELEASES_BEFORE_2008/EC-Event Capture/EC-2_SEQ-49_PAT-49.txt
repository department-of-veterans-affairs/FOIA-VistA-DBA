$TXT Created by MORRISON,JENNIFER at MNTVBB.FO-ALBANY.MED.VA.GOV  (KIDS) on Friday, 10/17/03 at 17:14
=============================================================================
Run Date: NOV 04, 2003                     Designation: EC*2*49
Package : EC - EVENT CAPTURE                  Priority: Mandatory
Version : 2        SEQ #49                      Status: Released
                  Compliance Date: DEC 05, 2003
=============================================================================

Associated patches: (v)EC*2*47     <<= must be installed BEFORE `EC*2*49'

Subject: ECS NOIS FIXES

Category: 
  - Routine

Description:
============

 This patch addresses NOISes related to the ECS GUI and roll-n-scroll.
  
 NOIS
 ----
 1. POR-0203-50719  EC GUI SPREADSHEET UPLOAD ALLOWS VOL IN DECIMALS
    Site reported that the EC GUI spreadsheet accepts fractional values in 
    the volume column.  Routine ECV4RPC was corrected to allow integer values 
    only.  Site also stated that the GUI data entry options, 'Data Entry by 
    Patient' and 'Data Entry by Procedure' will allow a user to enter a 
    fractional value but files the value as 1.  Delphi routines 
    UfrmEditPatientProc, UfrmEditProcPatients2, and UfrmECScreenLocation were 
    corrected.
  
 2. CPH-0103-42401  Getting errors with new GUI
    Sites reported that the EC GUI spreadsheet -
    o accepts and files a future date for a procedure.  Routine ECV4RPC was 
      corrected to not allow future dates.
    o does not display a warning message for deceased patients.  Routines 
      ECU1RPC, ECV1RPC, and ECV2RPC, and Delphi routine 'mainspread', were 
      modified to produce a warning message and override the entry of 
      deceased patients.
  
 3. BRX-0203-10581  ECX GUI upload problem
    Sites reported that when uploading an encounter in the GUI spreadsheet
    if the provider person class has an expiration date, the spreadsheet 
    gives an error message stating 'Provider does not have an active person 
    class', even though the date is in the future.   Routine ECV4RPC was 
    corrected to make the appropriate checks.
 
 4. HIN-0203-41973  ERROR: Record Num' is not a valid integer val
    Site reported getting the error message 'Record Number is not Valid 
    Integer Value' when trying to the upload spreadsheet.  Research showed that
    when there is only one row to load in the spreadsheet, the 1st column 
    header sometimes gets wiped out.  Delphi form 'mainspread' was modified
    to correct this problem.  The 'Open' file icon and 'Open' option on the 
    File menu were coded to be disabled once a file is open.  The spreadsheet 
    was also changed to enable editing for corrections and disabling when empty.
   
 5. BHS-0403-10964  Spreadsheet upload errors
    Site reported errors uploading their spreadsheet.  Error caused as a 
    result of client and server versions not being in synh.  Delphi routine 
    UfrmECMain was changed to call RPC EC GETVERSION to determine the server 
    version.  Code was added to check the server version against the client 
    version to determine whether user can proceed with logon.  MUMPS routine 
    ECUURPC was modified to add RPC code.
    
 6. ATG-0503-32005  Edit Patient Procedure screen clears some values
    POR-0503-51934  Editing in ECS GUI (Patch 46 w/newest exe) ER
    MIN-0503-42112  Provider name not retained when entering proce
    Sites reported that when editing using EC GUI Data Entry By Patient 
    option, the procedure and provider fields are clearing when the Procedure 
    Date field is changed or tabbed over. If the Procedure Date field is 
    changed a message, "Changing the date of an existing Procedure may 
    affect data that was previously entered" is displayed.  Delphi forms 
    UfrmEditPatientProc and UfrmEditProcPatients2 were changed to correct the 
    problem.
   
 7. REN-0503-61535 PROVIDER ENTRY
    Site reported that when Event Capture is accessed from CPRS, the provider 
    is defaulted to the provider from CPRS; however, when filing the record,
    they get an error.  Delphi form UfrmEditPatientProc was modified to 
    remove the default provider passed by CPRS since the provider may not 
    have an active person class.
   
 8. SAG-0903-42083 INVALID CODES entering in batch.
    WAS-1003-21031 PROCEDURE/CPT INVALID
    Site reported that uploading the GUI spreadsheet with alpha input in the 
    Procedure Code field generates the error 'Procedure/CPT Invalid'. A
    bug was found in routine ECV3RPC that was introduced by EC*2.0*47 (CSV 
    release).  The problem occurs when an EC National Procedure Code does not 
    point to a CPT code, causing the API $$CPT^ICPTCOD to return a value 
    of -1, which in turn triggered the "Procedure/CPT invalid" error.
   
 
 Test Sites
 ----------
 Atlanta
 Murfreesboro
 Little Rock
 VISN23
   
   
 CLIENT FILES
 ============
 The following Client PC software is exported as part of this patch and
 MUST be installed with the patch.
  
   File Name              Contents                Retrieval Format
   ---------              --------                ----------------
   EC2_0P49.EXE           EC GUI Executable       BINARY
  
 The EC GUI executable 'ec2_0p49.exe' for patch EC*2.0*49 can be found at
 the following locations.
    Albany            10.1.19.5         anonymous.software
    Hines             10.3.29.201       anonymous.software
    Salt Lake City    10.5.21.65        anonymous.software
  or
    Albany               ftp.fo-albany.med.va.gov
    Hines                ftp.fo-hines.med.va.gov
    Salt Lake City       ftp.fo-slc.med.va.gov
    
   
 TEST SITES: Please download the client executable from Albany anonymous.pub 
 directory.
   
   
  ROUTINE SUMMARY:
  ================
  The following is a list of the routine(s) included in this patch.  The
  second line of each of these routine(s) will look like:
  
      <tab>;;2.0; EVENT CAPTURE ;**[patch list]**;8 May 96
  
                             CHECK^XTSUMBLD results
  Routine name      Before Patch          After Patch         Patch List
  ============      ============          ===========         ==========
  ECEFPAT               11408511             11547175     25,32,39,42,47,49
  ECU1RPC                3432272              3615165          25,30,49
  ECUMRPC2               5513220              5443253     25,30,42,46,47,49
  ECUURPC                 930290              1558618          25,42,49
  ECV1RPC                1884992              1894952          25,33,49
  ECV2RPC                5532411              5788811          25,30,49
  ECV3RPC                5958943              5993368          25,47,49
  ECV4RPC                8790557              9184697          25,33,49
 
   
     
 INSTALLATION INSTRUCTIONS:
 ==========================
 This patch can be loaded with users on the system.
  
 Installation will take less than 5 minutes.
  
 1.  Use the INSTALL/CHECK MESSAGE option on the PackMan menu to unload
     the KIDS distribution included with this message.
  
 2.  Review your mapped set. If any of the routines listed in the ROUTINE
     SUMMARY section are mapped, they should be removed from the mapped set
     at this time.
  
 3.  From the Kernel Installation and Distribution System Menu, select
     the Installation menu.
  
 4.  From this menu, you may elect to use the following options
     (when prompted for INSTALL NAME, enter EC*2.0*49):
     a.  Compare Transport Global to Current System  - this option will
         allow you to view all changes that will be made when the patch
         is installed.  It compares all components of the patch (routines,
         DDs, templates, etc.).
     b.  Verify Checksums in Transport Global - this option will
         allow you to ensure the integrity of the routines that are in
         the transport global.
     c.  Print Transport Global - this option will allow you to view the
         components of the KIDS build.
  
 5.  Use the Install Package(s) option and select the package EC*2.0*49.
  
 6.  When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
     Protocols? YES//', respond YES.  When prompted to select the options
     you would like to place out of order, enter the following:
         EC GUI Context ... [EC GUI CONTEXT]
  
 7.  If a routine was unmapped as part of step 2, it should be returned
     to the mapped set once the installation has run to completion.

Routine Information:
====================

Routine Name:
  - ECV4RPC


Routine Checksum:

Routine Name:
  - ECV2RPC


Routine Checksum:

Routine Name:
  - ECV1RPC


Routine Checksum:

Routine Name:
  - ECU1RPC


Routine Checksum:

Routine Name:
  - ECUURPC


Routine Checksum:

Routine Name:
  - ECEFPAT


Routine Checksum:

Routine Name:
  - ECV3RPC


Routine Checksum:

Routine Name:
  - ECUMRPC2


Routine Checksum:

=============================================================================
User Information:
Entered By  : MORRISON,JENNIFER             Date Entered  : APR 22, 2003
Completed By: LAVERTY,TIM                   Date Completed: OCT 30, 2003
Released By : STRICKLAND,JOAN C             Date Released : NOV 04, 2003
=============================================================================


Packman Mail Message:
=====================

$END TXT
