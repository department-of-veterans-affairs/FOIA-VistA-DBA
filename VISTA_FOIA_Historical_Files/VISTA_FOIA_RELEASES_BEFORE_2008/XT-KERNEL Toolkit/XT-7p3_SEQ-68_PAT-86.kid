Released XT*7.3*86 SEQ #68
Extracted from mail message
**KIDS**:XT*7.3*86^

**INSTALL NAME**
XT*7.3*86
"BLD",5209,0)
XT*7.3*86^TOOLKIT^0^3040227^y
"BLD",5209,1,0)
^^2^2^3040211^^^
"BLD",5209,1,1,0)
Patch #86 for the Kernel Tool kit.  Applies to the National CPRS Response 
"BLD",5209,1,2,0)
time monitor.
"BLD",5209,4,0)
^9.64PA^177100.12^1
"BLD",5209,4,177100.12,0)
177100.12
"BLD",5209,4,177100.12,222)
y^n^f^^^^n
"BLD",5209,4,"B",177100.12,177100.12)

"BLD",5209,"INIT")
AWCMCPS2
"BLD",5209,"KRN",0)
^9.67PA^8989.52^19
"BLD",5209,"KRN",.4,0)
.4
"BLD",5209,"KRN",.401,0)
.401
"BLD",5209,"KRN",.402,0)
.402
"BLD",5209,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",5209,"KRN",.402,"NM",1,0)
AWCM EDIT PARAM FILE    FILE #177100.12^177100.12^0
"BLD",5209,"KRN",.402,"NM","B","AWCM EDIT PARAM FILE    FILE #177100.12",1)

"BLD",5209,"KRN",.403,0)
.403
"BLD",5209,"KRN",.5,0)
.5
"BLD",5209,"KRN",.84,0)
.84
"BLD",5209,"KRN",3.6,0)
3.6
"BLD",5209,"KRN",3.8,0)
3.8
"BLD",5209,"KRN",9.2,0)
9.2
"BLD",5209,"KRN",9.8,0)
9.8
"BLD",5209,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",5209,"KRN",9.8,"NM",1,0)
AWCMCPR1^^0^B77844723
"BLD",5209,"KRN",9.8,"NM",2,0)
AWCMCPR3^^0^B33499521
"BLD",5209,"KRN",9.8,"NM",3,0)
AWCMCPST^^0^B6716732
"BLD",5209,"KRN",9.8,"NM",4,0)
AWCMFTP^^0^B30709030
"BLD",5209,"KRN",9.8,"NM",5,0)
AWCMFTP1^^0^B17410452
"BLD",5209,"KRN",9.8,"NM",6,0)
AWCMCPS2^^0^B491811
"BLD",5209,"KRN",9.8,"NM","B","AWCMCPR1",1)

"BLD",5209,"KRN",9.8,"NM","B","AWCMCPR3",2)

"BLD",5209,"KRN",9.8,"NM","B","AWCMCPS2",6)

"BLD",5209,"KRN",9.8,"NM","B","AWCMCPST",3)

"BLD",5209,"KRN",9.8,"NM","B","AWCMFTP",4)

"BLD",5209,"KRN",9.8,"NM","B","AWCMFTP1",5)

"BLD",5209,"KRN",19,0)
19
"BLD",5209,"KRN",19.1,0)
19.1
"BLD",5209,"KRN",101,0)
101
"BLD",5209,"KRN",409.61,0)
409.61
"BLD",5209,"KRN",771,0)
771
"BLD",5209,"KRN",870,0)
870
"BLD",5209,"KRN",8989.51,0)
8989.51
"BLD",5209,"KRN",8989.52,0)
8989.52
"BLD",5209,"KRN",8994,0)
8994
"BLD",5209,"KRN","B",.4,.4)

"BLD",5209,"KRN","B",.401,.401)

"BLD",5209,"KRN","B",.402,.402)

"BLD",5209,"KRN","B",.403,.403)

"BLD",5209,"KRN","B",.5,.5)

"BLD",5209,"KRN","B",.84,.84)

"BLD",5209,"KRN","B",3.6,3.6)

"BLD",5209,"KRN","B",3.8,3.8)

"BLD",5209,"KRN","B",9.2,9.2)

"BLD",5209,"KRN","B",9.8,9.8)

"BLD",5209,"KRN","B",19,19)

"BLD",5209,"KRN","B",19.1,19.1)

"BLD",5209,"KRN","B",101,101)

"BLD",5209,"KRN","B",409.61,409.61)

"BLD",5209,"KRN","B",771,771)

"BLD",5209,"KRN","B",870,870)

"BLD",5209,"KRN","B",8989.51,8989.51)

"BLD",5209,"KRN","B",8989.52,8989.52)

"BLD",5209,"KRN","B",8994,8994)

"BLD",5209,"QUES",0)
^9.62^^
"BLD",5209,"REQB",0)
^9.611^3^2
"BLD",5209,"REQB",2,0)
TIU*1.0*181^2
"BLD",5209,"REQB",3,0)
OR*3.0*214^2
"BLD",5209,"REQB","B","OR*3.0*214",3)

"BLD",5209,"REQB","B","TIU*1.0*181",2)

"FIA",177100.12)
CPRS MONITOR
"FIA",177100.12,0)
^AWC(177100.12,
"FIA",177100.12,0,0)
177100.12P
"FIA",177100.12,0,1)
y^n^f^^^^n
"FIA",177100.12,0,10)

"FIA",177100.12,0,11)

"FIA",177100.12,0,"RLRO")

"FIA",177100.12,0,"VR")
7.3^XT
"FIA",177100.12,177100.12)
0
"INIT")
AWCMCPS2
"KRN",.402,2853697,-1)
0^1
"KRN",.402,2853697,0)
AWCM EDIT PARAM FILE^3040131.0857^^177100.12^^^3040201
"KRN",.402,2853697,"DR",1,177100.12)
1.2;1.5;1;2;3;4;5;6;7;8;9;10;11;12;13;14;17;18;19;20;21;22;23;24;25;
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",359,-1)
1^1
"PKG",359,0)
TOOLKIT^XT^PROGRAMMERS OPTIONS, MULTI. TERM LOOKUP
"PKG",359,22,0)
^9.49I^1^1
"PKG",359,22,1,0)
7.3^2950403^2950823
"PKG",359,22,1,"PAH",1,0)
86^3040227^132
"PKG",359,22,1,"PAH",1,1,0)
^^2^2^3040227
"PKG",359,22,1,"PAH",1,1,1,0)
Patch #86 for the Kernel Tool kit.  Applies to the National CPRS Response 
"PKG",359,22,1,"PAH",1,1,2,0)
time monitor.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","AWCMCPR1")
0^1^B77844723
"RTN","AWCMCPR1",1,0)
AWCMCPR1        ;VISN 7/THM-CPRS MONITOR ;Feb 27, 2004
"RTN","AWCMCPR1",2,0)
 ;;7.3;TOOLKIT;**84,86**;Jan 09, 2004
"RTN","AWCMCPR1",3,0)
 ;
"RTN","AWCMCPR1",4,0)
 W !!,$C(7),"You cannot run this program directly.",!,"Application use only !!",!! H 2 Q  ;enter properly
"RTN","AWCMCPR1",5,0)
 ;
"RTN","AWCMCPR1",6,0)
STRT1 ; tiu
"RTN","AWCMCPR1",7,0)
 N AWCDTA S AWCDTA=$G(^AWC(177100.12,1,0))
"RTN","AWCMCPR1",8,0)
 I $P(AWCDTA,U,17)'=1 G ENDQ ;master switch
"RTN","AWCMCPR1",9,0)
 I $P(AWCDTA,U,2)'=1 G ENDQ ;tiu
"RTN","AWCMCPR1",10,0)
 S AWCTYPE=1,AWCSTRT=$H
"RTN","AWCMCPR1",11,0)
 Q
"RTN","AWCMCPR1",12,0)
 ;
"RTN","AWCMCPR1",13,0)
STRT2 ; lab
"RTN","AWCMCPR1",14,0)
 N AWCDTA S AWCDTA=$G(^AWC(177100.12,1,0))
"RTN","AWCMCPR1",15,0)
 I $P(AWCDTA,U,17)'=1 G ENDQ ;master switch
"RTN","AWCMCPR1",16,0)
 I $P(AWCDTA,U,3)'=1 G ENDQ ;lab
"RTN","AWCMCPR1",17,0)
 S AWCTYPE=2,AWCSTRT=$H
"RTN","AWCMCPR1",18,0)
 Q
"RTN","AWCMCPR1",19,0)
 ;
"RTN","AWCMCPR1",20,0)
STRT3 ; reminders
"RTN","AWCMCPR1",21,0)
 N AWCDTA S AWCDTA=$G(^AWC(177100.12,1,0))
"RTN","AWCMCPR1",22,0)
 I $P(AWCDTA,U,17)'=1 G ENDQ ;master switch
"RTN","AWCMCPR1",23,0)
 I $P(AWCDTA,U,4)'=1 G ENDQ ;reminders
"RTN","AWCMCPR1",24,0)
 S AWCTYPE=3,AWCSTRT=$H
"RTN","AWCMCPR1",25,0)
 K AWCDTA
"RTN","AWCMCPR1",26,0)
 Q
"RTN","AWCMCPR1",27,0)
 ;
"RTN","AWCMCPR1",28,0)
END ; record the data
"RTN","AWCMCPR1",29,0)
 ; quit if turning on/back on in middle of transaction (AWCTYPE or AWCSTRT missing)
"RTN","AWCMCPR1",30,0)
 I '$D(AWCTYPE)!('$D(AWCSTRT)) G ENDQ
"RTN","AWCMCPR1",31,0)
 S AWCDTA=$G(^AWC(177100.12,1,0))
"RTN","AWCMCPR1",32,0)
 I $P(AWCDTA,U,17)'=1 G ENDQ ;master switch
"RTN","AWCMCPR1",33,0)
 I $P(AWCDTA,U,2)'=1 G ENDQ  ;tiu
"RTN","AWCMCPR1",34,0)
 I $P(AWCDTA,U,3)'=1 G ENDQ  ;lab
"RTN","AWCMCPR1",35,0)
 I $P(AWCDTA,U,4)'=1 G ENDQ  ;reminder
"RTN","AWCMCPR1",36,0)
 S AWCEND=$H
"RTN","AWCMCPR1",37,0)
 L +^XTMP("AWCCPRS",.5):1 G:'$T ENDQ
"RTN","AWCMCPR1",38,0)
 S AWCDA=+$G(^XTMP("AWCCPRS",.5))
"RTN","AWCMCPR1",39,0)
 I AWCDA>50000000 S AWCDA=0 ; reset to zero at fifty million entries
"RTN","AWCMCPR1",40,0)
 S AWCDA=AWCDA+1,^XTMP("AWCCPRS",.5)=AWCDA
"RTN","AWCMCPR1",41,0)
 L -^XTMP("AWCCPRS",.5)
"RTN","AWCMCPR1",42,0)
 S AWCFMDT=$$HTFM^XLFDT(AWCSTRT)
"RTN","AWCMCPR1",43,0)
 S ^XTMP("AWCCPRS",AWCFMDT,AWCDA,0)=AWCSTRT_U_AWCEND_U_DUZ_U_(+$G(DUZ(2)))_U_AWCTYPE
"RTN","AWCMCPR1",44,0)
 ;
"RTN","AWCMCPR1",45,0)
ENDQ K AWCDTA,AWCSEC,AWCFMDT,AWCTYPE,AWCSTRT,AWCEND,DO,DD,DIC,DIE,AWCDA
"RTN","AWCMCPR1",46,0)
 Q
"RTN","AWCMCPR1",47,0)
 ;
"RTN","AWCMCPR1",48,0)
PPAGE ; entry point to create updated .htm file
"RTN","AWCMCPR1",49,0)
 ; possible values for AWCX are VMS, VMSC, or NT
"RTN","AWCMCPR1",50,0)
 S AWCX="",AWCOS=$P(^%ZOSF("OS"),U)
"RTN","AWCMCPR1",51,0)
 I AWCOS["VAX DSM" S AWCX="VMS"
"RTN","AWCMCPR1",52,0)
 I AWCOS["OpenM-VMS" S AWCX="VMSC"
"RTN","AWCMCPR1",53,0)
 I AWCOS["OpenM" S AWCX="VMSC"
"RTN","AWCMCPR1",54,0)
 ; To double check for OS
"RTN","AWCMCPR1",55,0)
 I $T(OS^%ZOSV)'="" D
"RTN","AWCMCPR1",56,0)
 . I $$OS^%ZOSV()="VMS" S AWCX="VMSC"
"RTN","AWCMCPR1",57,0)
 . I $$OS^%ZOSV()="NT" S AWCX="NT"
"RTN","AWCMCPR1",58,0)
 ;
"RTN","AWCMCPR1",59,0)
 K TMP("AWC") D DT^DICRW
"RTN","AWCMCPR1",60,0)
 Q:'$D(^AWC(177100.12,1,0))  ;param file not set up
"RTN","AWCMCPR1",61,0)
 ; extract the parameters
"RTN","AWCMCPR1",62,0)
 S AWCDTA=$G(^AWC(177100.12,1,0))
"RTN","AWCMCPR1",63,0)
 S AWCDTA1=$G(^AWC(177100.12,1,1))
"RTN","AWCMCPR1",64,0)
 S AWCDHRS=$P(AWCDTA,U,7) I AWCDHRS="" S AWCDHRS=8  ;# hours to display
"RTN","AWCMCPR1",65,0)
 S X=$P(AWCDTA,U,8) S AWCMXSEC=$S(X]"":X,1:30) ;number of seconds to display
"RTN","AWCMCPR1",66,0)
 S X=$P(AWCDTA,U,9) S AWCTIULN=$S(X]"":X,1:"192,0,0") ;rgb code tiu line
"RTN","AWCMCPR1",67,0)
 S X=$P(AWCDTA,U,10) S AWCLABLN=$S(X]"":X,1:"0,192,0") ;rgb code lab line
"RTN","AWCMCPR1",68,0)
 S X=$P(AWCDTA,U,11) S AWCREMLN=$S(X]"":X,1:"0,0,192") ;rgb code reminder line
"RTN","AWCMCPR1",69,0)
 S X=$P(AWCDTA,U,12) S AWCGRDON=$S(X="y":"true",X="n":"false",1:"true")
"RTN","AWCMCPR1",70,0)
 S X=$P(AWCDTA,U,13) S AWCBKGRN=$S(X]"":X,1:"230,230,230") ;rgb code
"RTN","AWCMCPR1",71,0)
 S X=$P(AWCDTA1,U,3) S AWCMSRV=$S(X]"":X,1:"") ;server
"RTN","AWCMCPR1",72,0)
 S X=$P(AWCDTA1,U,4) S AWCMUSR=$S(X]"":X,1:"") ;user
"RTN","AWCMCPR1",73,0)
 S X=$P(AWCDTA1,U,5) S AWCMPW=$S(X]"":X,1:"")  ;passwd
"RTN","AWCMCPR1",74,0)
 ;
"RTN","AWCMCPR1",75,0)
 K AWCDTA D NOW^%DTC S (AWCENDDT,AWCCURTM)=%,AWCTSEC=3600*AWCDHRS
"RTN","AWCMCPR1",76,0)
 S AWCI1=$P(%H,",",1),AWCI2=$P(%H,",",2)
"RTN","AWCMCPR1",77,0)
 S AWCI2=(AWCI2-AWCTSEC) I AWCI2<0 S AWCI2=AWCI2+86400,AWCI1=AWCI1-1
"RTN","AWCMCPR1",78,0)
 S %H=AWCI1_","_AWCI2 D YMD^%DTC S AWCBEGDT=X_%
"RTN","AWCMCPR1",79,0)
 S X=$E(%,2,4),X=X_"0",X=$S($L(X)<4:X_"0",1:X) ;format to four digits, including any leading zeros
"RTN","AWCMCPR1",80,0)
 S AWCBEGTM=+X
"RTN","AWCMCPR1",81,0)
 S X=$P(AWCCURTM,".",2),X=($E(X,1,3)_"0"),X=$S($L(X)<4:X_"0",1:X) ;format to four digits as above
"RTN","AWCMCPR1",82,0)
 S AWCENDTM=+X K ^TMP("AWCTTIM",$J)
"RTN","AWCMCPR1",83,0)
 ; This loop skips 60 due to adding 10 to starting number. These two lines
"RTN","AWCMCPR1",84,0)
 ; cause it to print 0-50 min, skipping 60, like this: 210 220,230,240,250,300
"RTN","AWCMCPR1",85,0)
 I AWCBEGTM>AWCENDTM F X=AWCBEGTM:10:2350 S ^TMP("AWCTTIM",$J,(-9999+X))="" S:$E(X,($L(X)-1),$L(X))=50 X=X+40 S:X=2360 X="0" ;before midnight
"RTN","AWCMCPR1",86,0)
 I AWCBEGTM>AWCENDTM F X=0:10:AWCENDTM S ^TMP("AWCTTIM",$J,X)="" S:$E(X,($L(X)-1),$L(X))=50 X=X+40 ;after midnight
"RTN","AWCMCPR1",87,0)
 I AWCENDTM>AWCBEGTM F X=AWCBEGTM:10:AWCENDTM S ^TMP("AWCTTIM",$J,X)="" I $E(X,($L(X)-1),($L(X)))=50 S X=X+40 ;normal times
"RTN","AWCMCPR1",88,0)
 ;
"RTN","AWCMCPR1",89,0)
SORT ; sort the data into a TMP file
"RTN","AWCMCPR1",90,0)
 K ^TMP($J)
"RTN","AWCMCPR1",91,0)
 F AWCSRTDT=(AWCBEGDT-.000001):0 S AWCSRTDT=$O(^XTMP("AWCCPRS",AWCSRTDT)) Q:AWCSRTDT=""!(AWCSRTDT>AWCENDDT)  DO
"RTN","AWCMCPR1",92,0)
 .F DA=0:0 S DA=$O(^XTMP("AWCCPRS",AWCSRTDT,DA)) Q:DA=""  DO
"RTN","AWCMCPR1",93,0)
 ..S AWCDTA=$G(^XTMP("AWCCPRS",AWCSRTDT,DA,0)),AWCDIV=$P(AWCDTA,U,4),AWCTYPE=$P(AWCDTA,U,5)
"RTN","AWCMCPR1",94,0)
 ..I AWCDIV="" S AWCDIV=+$$SITE^VASITE ;for people without division assignments
"RTN","AWCMCPR1",95,0)
 ..S ^TMP($J,AWCDIV,AWCTYPE,AWCSRTDT,DA)=""
"RTN","AWCMCPR1",96,0)
 ;
"RTN","AWCMCPR1",97,0)
DIVS ; count the divisions for drop-down box on web page (used in AWCMCPR2)
"RTN","AWCMCPR1",98,0)
 I '$D(^TMP($J)) D NODATA G PPAGE ;no data yet for time frame being processed
"RTN","AWCMCPR1",99,0)
 S AWCDCNTR=0
"RTN","AWCMCPR1",100,0)
 F AWCDIV=0:0 S AWCDIV=$O(^TMP($J,AWCDIV)) Q:AWCDIV=""  DO
"RTN","AWCMCPR1",101,0)
 .S AWCFDIV(AWCDIV)=$P(^DIC(4,AWCDIV,0),U)_U_$P($G(^DIC(4,+AWCDIV,99)),U)_U
"RTN","AWCMCPR1",102,0)
 .S AWCDCNTR=AWCDCNTR+1
"RTN","AWCMCPR1",103,0)
 ; if only one division no drop-down box is needed
"RTN","AWCMCPR1",104,0)
 I AWCDCNTR=1 K AWCFDIV
"RTN","AWCMCPR1",105,0)
 ; generate one HTML page per facility
"RTN","AWCMCPR1",106,0)
DIVPG F AWCDIV=0:0 S AWCDIV=$O(^TMP($J,AWCDIV)) Q:AWCDIV=""  DO  G:POP EXIT
"RTN","AWCMCPR1",107,0)
 .S AWCDEV=$P($G(^AWC(177100.12,1,0)),U,5) I AWCDEV="" S POP=1 Q  ;no HFS device in param file
"RTN","AWCMCPR1",108,0)
 .S (AWCDIVNM,AWCDIVN1)=$P(^DIC(4,AWCDIV,0),U)
"RTN","AWCMCPR1",109,0)
 .S AWCDIVNM=$P($G(^DIC(4,+AWCDIV,99)),U) Q:AWCDIVNM=""
"RTN","AWCMCPR1",110,0)
 .S AWCFILE=$P(^AWC(177100.12,1,0),U,6)_"_"_AWCDIVNM_".htm" ;web page name with division number
"RTN","AWCMCPR1",111,0)
 .Q:AWCFILE=("_"_AWCDIV)!(AWCDEV="")  ;webpage or device is missing in parameter file
"RTN","AWCMCPR1",112,0)
 .; Check VMS or NT before you put the \ in the file name
"RTN","AWCMCPR1",113,0)
 .I AWCX="NT" D
"RTN","AWCMCPR1",114,0)
 ..S AWCZ=$L(AWCDEV) I $E(AWCDEV,AWCZ,AWCZ)'="\" S AWCDEV=AWCDEV_"\" ;add \ if missing
"RTN","AWCMCPR1",115,0)
 .D OPEN^%ZISH("AWCCPR1",AWCDEV,AWCFILE,"W") Q:POP
"RTN","AWCMCPR1",116,0)
 .S AWCHFIL1=AWCDEV_AWCFILE ;needed for AWCMFTP at end
"RTN","AWCMCPR1",117,0)
 .U IO D PART1^AWCMCPR2 ;part 1 of web page
"RTN","AWCMCPR1",118,0)
 .;
"RTN","AWCMCPR1",119,0)
TMPALL .; make the TMP("AWC", array with all possible hours, increments of ten, for all types 1,2,3, with zero values
"RTN","AWCMCPR1",120,0)
 .F T=1:1:3 F X=-99999:0 S X=$O(^TMP("AWCTTIM",$J,X)) Q:X=""  S TMP("AWC",T,X)="0^0"
"RTN","AWCMCPR1",121,0)
 .;
"RTN","AWCMCPR1",122,0)
DVALS .; count the number of data values to display on graph
"RTN","AWCMCPR1",123,0)
 .S AWCVCNTR=0 F X=0:0 S X=$O(TMP("AWC",X)) Q:X=""  F Y=0:0 S Y=$O(TMP("AWC",X,Y)) Q:Y=""  S AWCVCNTR=AWCVCNTR+1
"RTN","AWCMCPR1",124,0)
 .S AWCVCNTR=AWCVCNTR/3 ;divide by 3 graph lines
"RTN","AWCMCPR1",125,0)
 .; get the data by date range provided and sort the data
"RTN","AWCMCPR1",126,0)
 .F AWCTYPE=0:0 S AWCTYPE=$O(^TMP($J,AWCDIV,AWCTYPE)) Q:AWCTYPE=""  DO
"RTN","AWCMCPR1",127,0)
 ..F AWCDATE=(AWCBEGDT-.000001):0 S AWCDATE=$O(^TMP($J,AWCDIV,AWCTYPE,AWCDATE)) Q:AWCDATE=""!(AWCDATE>AWCENDDT)  DO
"RTN","AWCMCPR1",128,0)
 ...F DA=0:0 S DA=$O(^TMP($J,AWCDIV,AWCTYPE,AWCDATE,DA)) Q:DA=""  DO
"RTN","AWCMCPR1",129,0)
 ....S AWCDTA=$G(^XTMP("AWCCPRS",AWCDATE,DA,0)),AWCXSTRT=$P(AWCDTA,U),AWCXEND=$P(AWCDTA,U,2)
"RTN","AWCMCPR1",130,0)
 ....S AWCSEC=$$HDIFF^XLFDT(AWCXEND,AWCXSTRT,2)
"RTN","AWCMCPR1",131,0)
 ....S Y=AWCDATE X ^DD("DD") S X=$P(Y,"@",2),X=$TR(X,":","")
"RTN","AWCMCPR1",132,0)
 ....; sort the times ; AWCX1 is the hours ;AWCX3 is the minutes 
"RTN","AWCMCPR1",133,0)
 ....; use 10-minute intervals and put with interval
"RTN","AWCMCPR1",134,0)
 ....S AWCX1=$E(X,1,2),AWCX3=$E(X,3,4) ;strip hours and minutes, no seconds although they are there
"RTN","AWCMCPR1",135,0)
 ....I "^00^01^02^03^04^05^"[(U_AWCX3_U) S AWCX3="00"
"RTN","AWCMCPR1",136,0)
 ....I "^06^07^08^09^10^11^12^13^14^15^"[(U_AWCX3_U) S AWCX3="10"
"RTN","AWCMCPR1",137,0)
 ....I "^16^17^18^19^20^21^22^23^24^25^"[(U_AWCX3_U) S AWCX3="20"
"RTN","AWCMCPR1",138,0)
 ....I "^26^27^28^29^30^31^32^33^34^35^"[(U_AWCX3_U) S AWCX3="30"
"RTN","AWCMCPR1",139,0)
 ....I "^36^37^38^39^40^41^42^43^44^45^"[(U_AWCX3_U) S AWCX3="40"
"RTN","AWCMCPR1",140,0)
 ....I "^46^47^48^49^50^51^52^53^54^55^"[(U_AWCX3_U) S AWCX3="50"
"RTN","AWCMCPR1",141,0)
 ....I "^56^57^58^59^"[(U_AWCX3_U) S AWCX3="60"
"RTN","AWCMCPR1",142,0)
 ....I AWCX3=60 S AWCX3="00",AWCX1=AWCX1+1
"RTN","AWCMCPR1",143,0)
 ....I AWCX1=24 S AWCX1="00"
"RTN","AWCMCPR1",144,0)
 ....S AWCTIME=+(AWCX1_AWCX3)
"RTN","AWCMCPR1",145,0)
 ....;
"RTN","AWCMCPR1",146,0)
SETTMP ....; set in TMP("AWC", array ONLY if within our selected range
"RTN","AWCMCPR1",147,0)
 ....I $D(TMP("AWC",AWCTYPE,(-9999+AWCTIME))) DO
"RTN","AWCMCPR1",148,0)
 .....S $P(TMP("AWC",AWCTYPE,(-9999+(+AWCTIME))),U)=$P($G(TMP("AWC",AWCTYPE,-9999+(+AWCTIME))),U)+AWCSEC
"RTN","AWCMCPR1",149,0)
 .....S $P(TMP("AWC",AWCTYPE,(-9999+(+AWCTIME))),U,2)=$P($G(TMP("AWC",AWCTYPE,(-9999+(+AWCTIME)))),U,2)+1
"RTN","AWCMCPR1",150,0)
 ....I $D(TMP("AWC",AWCTYPE,+AWCTIME)) DO
"RTN","AWCMCPR1",151,0)
 .....S $P(TMP("AWC",AWCTYPE,+AWCTIME),U)=$P($G(TMP("AWC",AWCTYPE,+AWCTIME)),U)+AWCSEC
"RTN","AWCMCPR1",152,0)
 .....S $P(TMP("AWC",AWCTYPE,+AWCTIME),U,2)=$P($G(TMP("AWC",AWCTYPE,+AWCTIME)),U,2)+1
"RTN","AWCMCPR1",153,0)
 .;
"RTN","AWCMCPR1",154,0)
PART2 .D PART2^AWCMCPR2 ;part II of the HTML code
"RTN","AWCMCPR1",155,0)
 .; ftp the file
"RTN","AWCMCPR1",156,0)
 .D EN^AWCMFTP
"RTN","AWCMCPR1",157,0)
 I AWCX="NT" S CMD="S AWCVAR=$ZF(-1,"_"""erase ftpawc.txt"_""""_")" X CMD
"RTN","AWCMCPR1",158,0)
 I AWCX="VMS"!(AWCX="VMSC") D PURDEL^AWCMFTP
"RTN","AWCMCPR1",159,0)
 ;
"RTN","AWCMCPR1",160,0)
EXIT D ^%ZISC
"RTN","AWCMCPR1",161,0)
 K %,%H,AWCC,AWCAVG,AWCCNT,AWCDATE,AWCDEV,AWCDHRS,AWCDIV,AWCDT,AWCDTA,AWCEND,AWCFILE,AWCFMDT,AWCSEC,AWCY,AWCX
"RTN","AWCMCPR1",162,0)
 K AWCSTRT,AWCTIME,AWCTYPE,AWCZ,AWCBEGTM,DA,DD,DIC,DIE,DO,DR,AWCENDDT,AWCENDTM,AWCLBCNT,AWCPARAM,AWCPCNTR,AWCFDIVN
"RTN","AWCMCPR1",163,0)
 K POP,AWCTTIM,AWCVCNTR,X,AWCX1,AWCX3,Y,AWCBEGDT,AWCCURTM,AWCI1,AWCI2,T,AWCTSEC,Z,AWCDIVNM,AWCWL,AWCDVDTA
"RTN","AWCMCPR1",164,0)
 K AWCTIULN,AWCLABLN,AWCREMLN,AWCMXSEC,AWCGRDON,AWCBKGRN,AWCDIVN1,AWCFDIV,AWCDVNM,AWCDVNB,AWCWEBRT,AWCDCNTR,AWCFXDTA
"RTN","AWCMCPR1",165,0)
 K AWCOS,AWCDTA1,AWCHFIL1,AWCMPW,AWCMSRV,AWCMUSR,AWCMCP,AWCSITE,AWCSITEN,AWCVMSP,AWCOS,AWCSRTDT,AWCXDIV,YYY
"RTN","AWCMCPR1",166,0)
 K %I,%ZISHO,%ZISUB,%ZISHF,AWCWBFLD,CMD,AWC,AWCDIR,AWCDIRL,AWCHFILE,AWCHFILL,AWCOS,AWCVAR,Y,%SUBMIT,VMSC,AWCXDA
"RTN","AWCMCPR1",167,0)
 K ^TMP("AWCTTIM",$J),^TMP($J),TMP("AWC"),AWCXSTRT,AWCXEND,XDUZ,TMP
"RTN","AWCMCPR1",168,0)
 Q
"RTN","AWCMCPR1",169,0)
 ;
"RTN","AWCMCPR1",170,0)
NODATA ; handle no data for the day-create a zero, dummy record for the home facility.
"RTN","AWCMCPR1",171,0)
 ; this only occurs when a page is due to be run but no activity yet.
"RTN","AWCMCPR1",172,0)
 S (AWCSTRT,AWCEND)=$H
"RTN","AWCMCPR1",173,0)
 S AWCXDIV=$P($G(^AWC(177100.12,1,1)),U,2),AWCXDA=$O(^DIC(4,"D",AWCXDIV,0)) Q:AWCXDA=""
"RTN","AWCMCPR1",174,0)
 S AWCXDIV=$P($G(^DIC(4,AWCXDA,99)),U) Q:AWCXDIV=""
"RTN","AWCMCPR1",175,0)
 S XDUZ=.5,XDUZ(2)=AWCXDIV,AWCTYPE=1
"RTN","AWCMCPR1",176,0)
 L +^XTMP("AWCCPRS",.5):1 Q:'$T
"RTN","AWCMCPR1",177,0)
 S AWCDA=+$G(^XTMP("AWCCPRS",.5)),AWCDA=AWCDA+1,^XTMP("AWCCPRS",.5)=AWCDA
"RTN","AWCMCPR1",178,0)
 L -^XTMP("AWCCPRS",.5)
"RTN","AWCMCPR1",179,0)
 S AWCFMDT=$$HTFM^XLFDT(AWCSTRT)
"RTN","AWCMCPR1",180,0)
 S ^XTMP("AWCCPRS",AWCFMDT,AWCDA,0)=AWCSTRT_U_AWCEND_U_XDUZ_U_(+$G(XDUZ(2)))_U_AWCTYPE
"RTN","AWCMCPR1",181,0)
 Q
"RTN","AWCMCPR3")
0^2^B33499521
"RTN","AWCMCPR3",1,0)
AWCMCPR3        ;VISN 7/THM-CPRS MONITOR - ROLLUP TO NATIONAL SERVER ;Feb 27, 2004
"RTN","AWCMCPR3",2,0)
 ;;7.3;TOOLKIT;**84,86**;Jan 09, 2004
"RTN","AWCMCPR3",3,0)
 ;
"RTN","AWCMCPR3",4,0)
 Q  ;enter properly
"RTN","AWCMCPR3",5,0)
 ;
"RTN","AWCMCPR3",6,0)
GENSTAT ;; possible values for AWCX are VMS, VMSC, or NT
"RTN","AWCMCPR3",7,0)
 N AWCDTA S AWCDTA=$G(^AWC(177100.12,1,0))
"RTN","AWCMCPR3",8,0)
 I $P(AWCDTA,U,17)'="1" G EXIT ;master switch
"RTN","AWCMCPR3",9,0)
 S AWCX="",AWCOS=$P(^%ZOSF("OS"),U)
"RTN","AWCMCPR3",10,0)
 I AWCOS["VAX DSM" S AWCX="VMS"
"RTN","AWCMCPR3",11,0)
 I AWCOS["OpenM-VMS" S AWCX="VMSC"
"RTN","AWCMCPR3",12,0)
 I AWCOS["OpenM" S AWCX="VMSC"
"RTN","AWCMCPR3",13,0)
 ; VMS FOR CACHE MODS TO DOUBLE CHECK FOR OS
"RTN","AWCMCPR3",14,0)
 I $T(OS^%ZOSV)'="" D
"RTN","AWCMCPR3",15,0)
 . I $$OS^%ZOSV()="VMS" S AWCX="VMSC"
"RTN","AWCMCPR3",16,0)
 . I $$OS^%ZOSV()="NT" S AWCX="NT"
"RTN","AWCMCPR3",17,0)
 ;
"RTN","AWCMCPR3",18,0)
 Q:'$D(^AWC(177100.12,1,0))  ;no parameter file set up
"RTN","AWCMCPR3",19,0)
 K ^TMP("AWC",$J),^TMP("AWCTTIM",$J) D DT^DICRW
"RTN","AWCMCPR3",20,0)
 I '$D(AWCMANL) S X="T-1",%DT="" D ^%DT S AWCBEGDT=Y
"RTN","AWCMCPR3",21,0)
 S AWCENDDT=AWCBEGDT+.2359
"RTN","AWCMCPR3",22,0)
 S AWCBEGD1=17000000+AWCBEGDT ;yyyymmdd
"RTN","AWCMCPR3",23,0)
 S AWCTTIM="",AWCBEGTM=0,AWCENDTM=2400
"RTN","AWCMCPR3",24,0)
 ;This loop skips 60 due to adding 10 to starting number. These two lines
"RTN","AWCMCPR3",25,0)
 ;cause it to print 0-50 min, skipping 60, like this: 210 220,230,240,250,300
"RTN","AWCMCPR3",26,0)
 F X=0:10:AWCENDTM S ^TMP("AWCTTIM",$J,X)="" S:$E(X,($L(X)-1),$L(X))=50 X=X+40 ;previous day
"RTN","AWCMCPR3",27,0)
 ;make the ^TMP("AWC",$J, array with all possible hours, increments of ten for all types 1,2,3, with zero values
"RTN","AWCMCPR3",28,0)
 S AWCCNTR=0 F T=1:1:3 F X=-1:0 S X=$O(^TMP("AWCTTIM",$J,X)) Q:X=""  S ^TMP("AWC",$J,T,X)="0^0"
"RTN","AWCMCPR3",29,0)
 S AWCDEV=$P($G(^AWC(177100.12,1,0)),U,5)
"RTN","AWCMCPR3",30,0)
 S AWCDIVNM=$P($G(^AWC(177100.12,1,1)),U,2) ;facility number
"RTN","AWCMCPR3",31,0)
 S AWCDIVN1=$P($G(^DIC(4,AWCDIVNM,0)),U) Q:AWCDIVN1=""  ;division name
"RTN","AWCMCPR3",32,0)
 S AWCFILE="CPRSstats_"_AWCBEGD1_"_"_AWCDIVNM_".txt" ;text file division number
"RTN","AWCMCPR3",33,0)
 Q:AWCFILE=("_"_AWCDIVNM)!(AWCDEV="")  ;webpage or device is missing in parameter file
"RTN","AWCMCPR3",34,0)
 ; CHECK VMS OR NT BEFORE YOU PUT THE \ IN FILE NAME
"RTN","AWCMCPR3",35,0)
 I AWCX="NT" D
"RTN","AWCMCPR3",36,0)
 .S AWCZ=$L(AWCDEV) I $E(AWCDEV,AWCZ,AWCZ)'="\" S AWCDEV=AWCDEV_"\" ;add \ if missing
"RTN","AWCMCPR3",37,0)
 ;
"RTN","AWCMCPR3",38,0)
 D OPEN^%ZISH("AWCMCPR3",AWCDEV,AWCFILE,"W") Q:$G(POP)=1
"RTN","AWCMCPR3",39,0)
 S AWCHFIL1=AWCDEV_AWCFILE ;needed for AWCMFTP at end
"RTN","AWCMCPR3",40,0)
 U IO
"RTN","AWCMCPR3",41,0)
DVALS ;get the data values
"RTN","AWCMCPR3",42,0)
 S AWCDATE=(AWCBEGDT-.000001)
"RTN","AWCMCPR3",43,0)
 F  S AWCDATE=$O(^AWC(177100.13,"C",AWCDATE)) Q:AWCDATE=""!(AWCDATE>AWCENDDT)  DO  G:$G(POP)=1 EXIT
"RTN","AWCMCPR3",44,0)
 .F DA=0:0 S DA=$O(^AWC(177100.13,"C",AWCDATE,DA)) Q:DA=""  DO
"RTN","AWCMCPR3",45,0)
 ..S AWCDTA=^AWC(177100.13,DA,0),AWCSEC=$P(AWCDTA,U,2),AWCTYPE=$P(AWCDTA,U,6)
"RTN","AWCMCPR3",46,0)
 ..S Y=AWCDATE X ^DD("DD") S X=$P(Y,"@",2),X=$TR(X,":","")
"RTN","AWCMCPR3",47,0)
 ..;sort the times ; AWCX1 is the hours ;AWCX3 is the minutes ;use 10-minute intervals
"RTN","AWCMCPR3",48,0)
 ..S AWCX1=$E(X,1,2),AWCX3=$E(X,3,99)
"RTN","AWCMCPR3",49,0)
 ..I "^00^01^02^03^04^05^"[(U_AWCX3_U) S AWCX3="00"
"RTN","AWCMCPR3",50,0)
 ..I "^06^07^08^09^10^11^12^13^14^15^"[(U_AWCX3_U) S AWCX3="10"
"RTN","AWCMCPR3",51,0)
 ..I "^16^17^18^19^20^21^22^23^24^25^"[(U_AWCX3_U) S AWCX3="20"
"RTN","AWCMCPR3",52,0)
 ..I "^26^27^28^29^30^31^32^33^34^35^"[(U_AWCX3_U) S AWCX3="30"
"RTN","AWCMCPR3",53,0)
 ..I "^36^37^38^39^40^41^42^43^44^45^"[(U_AWCX3_U) S AWCX3="40"
"RTN","AWCMCPR3",54,0)
 ..I "^46^47^48^49^50^51^52^53^54^55^"[(U_AWCX3_U) S AWCX3="50"
"RTN","AWCMCPR3",55,0)
 ..I "^56^57^58^59^"[(U_AWCX3_U) S AWCX3="60"
"RTN","AWCMCPR3",56,0)
 ..I AWCX3=60 S AWCX3="00",AWCX1=AWCX1+1
"RTN","AWCMCPR3",57,0)
 ..I AWCX1=24 S AWCX1="00"
"RTN","AWCMCPR3",58,0)
 ..S AWCTIME=+(AWCX1_AWCX3)
"RTN","AWCMCPR3",59,0)
 ..;
"RTN","AWCMCPR3",60,0)
SETTMP ..I $D(^TMP("AWC",$J,AWCTYPE,(-9999+AWCTIME))) DO
"RTN","AWCMCPR3",61,0)
 ...S $P(^TMP("AWC",$J,AWCTYPE,(-9999+(+AWCTIME))),U)=$P($G(^TMP("AWC",$J,AWCTYPE,-9999+(+AWCTIME))),U)+AWCSEC
"RTN","AWCMCPR3",62,0)
 ...S $P(^TMP("AWC",$J,AWCTYPE,(-9999+(+AWCTIME))),U,2)=$P($G(^TMP("AWC",$J,AWCTYPE,(-9999+(+AWCTIME)))),U,2)+1
"RTN","AWCMCPR3",63,0)
 ..I $D(^TMP("AWC",$J,AWCTYPE,+AWCTIME)) DO
"RTN","AWCMCPR3",64,0)
 ...S $P(^TMP("AWC",$J,AWCTYPE,+AWCTIME),U)=$P($G(^TMP("AWC",$J,AWCTYPE,+AWCTIME)),U)+AWCSEC
"RTN","AWCMCPR3",65,0)
 ...S $P(^TMP("AWC",$J,AWCTYPE,+AWCTIME),U,2)=$P($G(^TMP("AWC",$J,AWCTYPE,+AWCTIME)),U,2)+1
"RTN","AWCMCPR3",66,0)
 K AWCTOTX
"RTN","AWCMCPR3",67,0)
 F AWCTYPE=0:0 S AWCTYPE=$O(^TMP("AWC",$J,AWCTYPE)) Q:AWCTYPE=""  S AWCPCNTR=0 F AWCTIME=-9999:0 S AWCTIME=$O(^TMP("AWC",$J,AWCTYPE,AWCTIME)) Q:AWCTIME=""  DO
"RTN","AWCMCPR3",68,0)
 .S AWCDTA=$G(^TMP("AWC",$J,AWCTYPE,AWCTIME)),AWCSEC=$P(AWCDTA,U),AWCCNT=$P(AWCDTA,U,2)
"RTN","AWCMCPR3",69,0)
 .I $L(AWCTIME)=1 S AWCTIME="000"_AWCTIME
"RTN","AWCMCPR3",70,0)
 .I $L(AWCTIME)=2 S AWCTIME="00"_AWCTIME
"RTN","AWCMCPR3",71,0)
 .I $L(AWCTIME)=3 S AWCTIME="0"_AWCTIME
"RTN","AWCMCPR3",72,0)
 .I +AWCTIME<759 S $P(AWCTOTX(AWCTYPE,1),U,1)=$P($G(AWCTOTX(AWCTYPE,1)),U,1)+AWCSEC DO  Q
"RTN","AWCMCPR3",73,0)
 ..S $P(AWCTOTX(AWCTYPE,1),U,2)=$P(AWCTOTX(AWCTYPE,1),U,2)+AWCCNT
"RTN","AWCMCPR3",74,0)
 .I +AWCTIME>759&(+AWCTIME<1600) S $P(AWCTOTX(AWCTYPE,2),U,1)=$P($G(AWCTOTX(AWCTYPE,2)),U,1)+AWCSEC DO  Q
"RTN","AWCMCPR3",75,0)
 ..S $P(AWCTOTX(AWCTYPE,2),U,2)=$P(AWCTOTX(AWCTYPE,2),U,2)+AWCCNT
"RTN","AWCMCPR3",76,0)
 .I +AWCTIME'<1600&(+AWCTIME'>2359) S $P(AWCTOTX(AWCTYPE,3),U,1)=$P($G(AWCTOTX(AWCTYPE,3)),U,1)+AWCSEC DO  Q
"RTN","AWCMCPR3",77,0)
 ..S $P(AWCTOTX(AWCTYPE,3),U,2)=$P(AWCTOTX(AWCTYPE,3),U,2)+AWCCNT
"RTN","AWCMCPR3",78,0)
 F X=1:1:3 S AWCTOTX(X,1)=$S($P(AWCTOTX(X,1),U,2)>0:$P(AWCTOTX(X,1),U,1)/$P(AWCTOTX(X,1),U,2),1:0)
"RTN","AWCMCPR3",79,0)
 F X=1:1:3 S AWCTOTX(X,2)=$S($P(AWCTOTX(X,2),U,2)>0:$P(AWCTOTX(X,2),U,1)/$P(AWCTOTX(X,2),U,2),1:0)
"RTN","AWCMCPR3",80,0)
 F X=1:1:3 S AWCTOTX(X,3)=$S($P(AWCTOTX(X,3),U,2)>0:$P(AWCTOTX(X,3),U,1)/$P(AWCTOTX(X,3),U,2),1:0)
"RTN","AWCMCPR3",81,0)
 F X=0:0 S X=$O(AWCTOTX(X)) Q:X=""  S Y=""  F  S Y=$O(AWCTOTX(X,Y)) Q:Y=""  W X,$C(9),Y,$C(9),$J(AWCTOTX(X,Y),5,2)_$C(9)_AWCBEGD1,!
"RTN","AWCMCPR3",82,0)
 ;
"RTN","AWCMCPR3",83,0)
SENDIT ; send it
"RTN","AWCMCPR3",84,0)
 D CLOSE^%ZISH("AWCMCPR3"),^%ZISC
"RTN","AWCMCPR3",85,0)
 D EN^AWCMFTP1
"RTN","AWCMCPR3",86,0)
 I AWCX["NT" DO
"RTN","AWCMCPR3",87,0)
 .S CMD="S AWCVAR=$ZF(-1,"_"""erase ftpstatawc.txt"_""""_")" X CMD
"RTN","AWCMCPR3",88,0)
 .S CMD="S AWCVAR=$ZF(-1,"_"""erase "_AWCHFILE_""""_")" X CMD
"RTN","AWCMCPR3",89,0)
 ;
"RTN","AWCMCPR3",90,0)
EXIT K %DT,AWCAVB,AWCBEGDT,AWCBEGTM,AWCCNT,AWCCNTR,AWCDEV,AWCDIV,AWCDIVN1,AWCDIVNM,AWCDTA,AWCENDDT,AWCX,AWCY
"RTN","AWCMCPR3",91,0)
 K AWCENDTM,AWCFILE,AWCPCNTR,AWCSEC,AWCTIME,AWCTTIM,AWCTYPE,AWCVCNTR,AWCZ,DA,T,X,AWCX1,AWCX3,Y
"RTN","AWCMCPR3",92,0)
 K AWC,AWCDIR,AWCDIRL,AWCHFILE,AWCHFILL,AWCOS,AWCVAR,Y,%SUBMIT,VMSC,CMD,AWCHFIL1
"RTN","AWCMCPR3",93,0)
 K ^TMP("AWC",$J),^TMP("AWCTTIM",$J),AWCAVG,AWCBEGD1,AWCDATE,TMP,AWCMANL
"RTN","AWCMCPR3",94,0)
 K ZTSK,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTDTH,AWCHDR1
"RTN","AWCMCPR3",95,0)
 Q
"RTN","AWCMCPR3",96,0)
 ;
"RTN","AWCMCPR3",97,0)
MANUAL S IOP="HOME" D ^%ZIS K IOP
"RTN","AWCMCPR3",98,0)
 S AWCHDR1="Re-run National CPRS Monitors" W @IOF,!,AWCHDR1,!!
"RTN","AWCMCPR3",99,0)
 S %DT="AE",%DT("A")="What day do you want to re-run ?  " D ^%DT G:Y<0 EXIT
"RTN","AWCMCPR3",100,0)
 S X=$O(^AWC(177100.13,"C",(Y-.000001))) I X=""!(X>(Y_.2359)) W $C(7),!!,"There is no data in the permanent file for that day.",!! H 2 G MANUAL
"RTN","AWCMCPR3",101,0)
 S AWCBEGDT=Y,AWCMANL=1
"RTN","AWCMCPR3",102,0)
 S ZTSAVE("AWC*")="",ZTIO="",ZTRTN="GENSTAT^AWCMCPR3",ZTDESC=AWCHDR1,ZTDTH=$H D ^%ZTLOAD
"RTN","AWCMCPR3",103,0)
 W:$D(ZTSK) !!,"Queued as task# ",ZTSK,!! H 2 G EXIT
"RTN","AWCMCPS2")
0^6^B491811
"RTN","AWCMCPS2",1,0)
AWCMCPS2 ;VISN7/THM-RE-INDEX PARAMETER FILE ; Feb 27, 2004
"RTN","AWCMCPS2",2,0)
 ;;7.3;TOOLKIT;**86**;Jan 09, 2004
"RTN","AWCMCPS2",3,0)
 ;
"RTN","AWCMCPS2",4,0)
 S IOP="HOME" D ^%ZIS K IOP
"RTN","AWCMCPS2",5,0)
 ;
"RTN","AWCMCPS2",6,0)
EN W @IOF,!!,"Re-index the CPRS Monitor Parameter file (177100.12)",!!
"RTN","AWCMCPS2",7,0)
 W !,"Please wait . . . " H 2
"RTN","AWCMCPS2",8,0)
 ; re-index .01 field
"RTN","AWCMCPS2",9,0)
 K ^AWC(177100.12,"B")
"RTN","AWCMCPS2",10,0)
 S DIK="^AWC(177100.12,",DA=1,DIK(1)=".01" D EN^DIK
"RTN","AWCMCPS2",11,0)
 W "Finished.",!
"RTN","AWCMCPS2",12,0)
 ;
"RTN","AWCMCPS2",13,0)
EXIT K %,AWCMTPL,DA,AWCMOPT,DIK
"RTN","AWCMCPS2",14,0)
 Q
"RTN","AWCMCPST")
0^3^B6716732
"RTN","AWCMCPST",1,0)
AWCMCPST ;VISN 7/THM-POST-INIT FOR CPRS MONITOR ; Feb 27, 2004
"RTN","AWCMCPST",2,0)
 ;;7.3;TOOLKIT;**84,86**;Jan 09, 2004
"RTN","AWCMCPST",3,0)
 ;
"RTN","AWCMCPST",4,0)
EN ; set up ^XTMP nodes first
"RTN","AWCMCPST",5,0)
 N AWCPGDT,X,Y
"RTN","AWCMCPST",6,0)
 D DT^DICRW
"RTN","AWCMCPST",7,0)
 S X="T+10",%DT="" D ^%DT Q:Y<0  S AWCPGDT=Y
"RTN","AWCMCPST",8,0)
 ; locks applied even though nodes do not exist yet
"RTN","AWCMCPST",9,0)
 I '$D(^XTMP("AWCCPRS",0)) DO
"RTN","AWCMCPST",10,0)
 .L +^XTMP("AWCCPRS",0):1
"RTN","AWCMCPST",11,0)
 .S ^XTMP("AWCCPRS",0)=AWCPGDT_U_DT_U_"CPRS Monitor temporary global" ;zero node
"RTN","AWCMCPST",12,0)
 .L -^XTMP("AWCCPRS",0)
"RTN","AWCMCPST",13,0)
 I '$D(^XTMP("AWCCPRS",.5)) DO
"RTN","AWCMCPST",14,0)
 .L +^XTMP("AWCCPRS",.5):1
"RTN","AWCMCPST",15,0)
 .S ^XTMP("AWCCPRS",.5)=0 ;node that supplies IEN
"RTN","AWCMCPST",16,0)
 .L -^XTMP("AWCCPRS",.5)
"RTN","AWCMCPST",17,0)
 ;
"RTN","AWCMCPST",18,0)
PARAM ; set up parameter file; all settings off initially
"RTN","AWCMCPST",19,0)
 S AWCX=$$SITE^VASITE,AWCDIV=+AWCX,AWCDNAME=$P(AWCX,U,2),AWCMSTA=$P(AWCX,U,3)
"RTN","AWCMCPST",20,0)
 ; Output= Institution file pointer^Institution name^station number with suffix
"RTN","AWCMCPST",21,0)
 I AWCDIV="" W !!,$C(7),"Unable to resolve the site's station number",!! H 3
"RTN","AWCMCPST",22,0)
 G:AWCDIV="" EXIT
"RTN","AWCMCPST",23,0)
 ; Beta test sites have it already, so update it for consistency
"RTN","AWCMCPST",24,0)
 I $D(^AWC(177100.12,1,0)) DO  G EXIT
"RTN","AWCMCPST",25,0)
 .S (DIC,DIE)="^AWC(177100.12,",DIC(0)="QLM",DA=1
"RTN","AWCMCPST",26,0)
 .; set the first piece manually; can't edit a DINUMed field
"RTN","AWCMCPST",27,0)
 .; field 1.5 will be triggered on new entries at non-beta sites, but not for existing beta sites
"RTN","AWCMCPST",28,0)
 .S $P(^AWC(177100.12,DA,0),U)=AWCDIV
"RTN","AWCMCPST",29,0)
 .S DR="1///0;1.2///0;1.5////"_AWCMSTA_";2///0;3///0;5////cprsmonitor"_AWCMSTA
"RTN","AWCMCPST",30,0)
 .S DR=DR_";6///8;7///30;8///192,0,0;9///0,192,0;10///0,0,192;11///1;12///230,230,230"
"RTN","AWCMCPST",31,0)
 .S DR=DR_";13///7;20///vaftp.va.gov;21////itmuser;22////Padfoot1;23///0;24///1"
"RTN","AWCMCPST",32,0)
 .D ^DIE
"RTN","AWCMCPST",33,0)
 . ;now re-index .01 field because it changed (DIK executes KILL and then SET)
"RTN","AWCMCPST",34,0)
 .S DIK="^AWC(177100.12,",DA=1,DIK(1)=".01" D EN^DIK
"RTN","AWCMCPST",35,0)
 ; section for new sites - field 1.5 is triggered
"RTN","AWCMCPST",36,0)
 I '$D(^AWC(177100.12,1,0)) DO
"RTN","AWCMCPST",37,0)
 .S X=AWCDIV,DIC("DR")="1///0;1.2///0;2///0;3///0;5///cprsmonitor"_AWCMSTA
"RTN","AWCMCPST",38,0)
 .S DIC("DR")=DIC("DR")_";6///8;7///30;8///192,0,0;9///0,192,0;10///0,0,192;11///YES;12///230,230,230"
"RTN","AWCMCPST",39,0)
 .S DIC("DR")=DIC("DR")_";13///7;20///vaftp.va.gov;21///itmuser;22///Padfoot1;23///0;24///1"
"RTN","AWCMCPST",40,0)
 .S (DIC,DIE)="^AWC(177100.12,",DIC(0)="EQLM" K DO,DD D FILE^DICN
"RTN","AWCMCPST",41,0)
 ;
"RTN","AWCMCPST",42,0)
EXIT K AWCDIV,AWCDA,AWCDNAME,AWCMSTA,DO,DD,DIC,DIE,DR,%DT,AWCPGDT,X,Y
"RTN","AWCMCPST",43,0)
 K AWCX,DA
"RTN","AWCMCPST",44,0)
 Q
"RTN","AWCMFTP")
0^4^B30709030
"RTN","AWCMFTP",1,0)
AWCMFTP ;VISN 7/THM-FTP FILES TO SERVER from VISTA ; Feb 27, 2004
"RTN","AWCMFTP",2,0)
 ;;7.3;TOOLKIT;**84,86**;Jan 09, 2004
"RTN","AWCMFTP",3,0)
 ;
"RTN","AWCMFTP",4,0)
 W *7,!,"Enter at line EN^AWCMFTP.",!
"RTN","AWCMFTP",5,0)
 Q
"RTN","AWCMFTP",6,0)
EN ; variables killed in calling program
"RTN","AWCMFTP",7,0)
 S VMSC=""                                            ;INIT THE VAR
"RTN","AWCMFTP",8,0)
 ; AWCHFIL1= whole VMS path
"RTN","AWCMFTP",9,0)
 S AWCHFILE="AWCMOVEHTM.COM"                          ;COM file name
"RTN","AWCMFTP",10,0)
 I AWCX="NT" S AWCHFILE=AWCFILE
"RTN","AWCMFTP",11,0)
 S AWCDTAX=$G(^AWC(177100.12,1,0))
"RTN","AWCMFTP",12,0)
 S AWCDIR=$P(AWCDTAX,U,5)             ;Parameter file
"RTN","AWCMFTP",13,0)
 S:AWCDIR="" AWCDIR="SYS$SYSDEVICE:[DSMMGR]"          ;DEFAULT
"RTN","AWCMFTP",14,0)
 S AWCSITE=$$SITE^VASITE,AWCSITE=$P(AWCSITE,U,2)      ;site Name
"RTN","AWCMFTP",15,0)
 S AWCSITEN=+$$SITE^VASITE                            ;3 dig number
"RTN","AWCMFTP",16,0)
 S AWCDIRL=$$LOW^XLFSTR(AWCDIR),AWCHFILL=$$LOW^XLFSTR(AWCHFILE)
"RTN","AWCMFTP",17,0)
 S AWCWBFLD=$P(AWCDTAX,U,15),AWCWBFLD=$$LOW^XLFSTR(AWCWBFLD) ;web page folder
"RTN","AWCMFTP",18,0)
 ; Note: file deletion is not a problem for NT/Cache since it overwrites the files
"RTN","AWCMFTP",19,0)
 S AWCMVMSL=+$P(AWCDTAX,U,16) ;VMS logging
"RTN","AWCMFTP",20,0)
 S AWCMVMSD=+$P(AWCDTAX,U,18) ;VMS delete
"RTN","AWCMFTP",21,0)
 S AWCDIRCH=+$P(AWCDTAX,U,19) ;use change dir command?
"RTN","AWCMFTP",22,0)
 S AWCWBFLD=$P(AWCWBFLD,"/",2)
"RTN","AWCMFTP",23,0)
 D @AWCX
"RTN","AWCMFTP",24,0)
 Q
"RTN","AWCMFTP",25,0)
 ;
"RTN","AWCMFTP",26,0)
NT ; NT script
"RTN","AWCMFTP",27,0)
 S AWCC=1
"RTN","AWCMFTP",28,0)
 K ^TMP("AWCMFTP",$J)
"RTN","AWCMFTP",29,0)
 S ^TMP("AWCMFTP",$J,AWCC,0)="open "_AWCMSRV,AWCC=AWCC+1 ;server ip address
"RTN","AWCMFTP",30,0)
 S ^TMP("AWCMFTP",$J,AWCC,0)=AWCMUSR,AWCC=AWCC+1 ; ftp user
"RTN","AWCMFTP",31,0)
 S ^TMP("AWCMFTP",$J,AWCC,0)=AWCMPW,AWCC=AWCC+1  ;ftp password
"RTN","AWCMFTP",32,0)
 S ^TMP("AWCMFTP",$J,AWCC,0)="ascii",AWCC=AWCC+1
"RTN","AWCMFTP",33,0)
 I $G(AWCDIRCH)=1 S ^TMP("AWCMFTP",$J,AWCC,0)="cd "_AWCWBFLD,AWCC=AWCC+1 ;****
"RTN","AWCMFTP",34,0)
 S ^TMP("AWCMFTP",$J,AWCC,0)="put "_AWCDIRL_"\"_AWCHFILE,AWCC=AWCC+1 ;****
"RTN","AWCMFTP",35,0)
 S ^TMP("AWCMFTP",$J,AWCC,0)="bye"
"RTN","AWCMFTP",36,0)
 ; write it to the NT directory
"RTN","AWCMFTP",37,0)
 S Y=$$GTF^%ZISH($NA(^TMP("AWCMFTP",$J,1,0)),3,AWCDIRL,"ftpawc.txt")
"RTN","AWCMFTP",38,0)
 ; send command to NT to execute this batch file
"RTN","AWCMFTP",39,0)
 S CMD="S AWCVAR=$ZF(-1,""ftp -s:""_AWCDIRL_""\ftpawc.txt"")"
"RTN","AWCMFTP",40,0)
 X CMD G EXIT
"RTN","AWCMFTP",41,0)
 ;
"RTN","AWCMFTP",42,0)
VMSC ; VMS FOR CACHE MODS TO DOUBLE CHECK FOR OS
"RTN","AWCMFTP",43,0)
 S VMSC=1
"RTN","AWCMFTP",44,0)
 ;
"RTN","AWCMFTP",45,0)
VMS ; VMS com file script
"RTN","AWCMFTP",46,0)
 ; Captive process so we give full privs
"RTN","AWCMFTP",47,0)
 S AWC=1
"RTN","AWCMFTP",48,0)
 K ^TMP("AWCMFTP",$J)
"RTN","AWCMFTP",49,0)
 S ^TMP("AWCMFTP",$J,AWC,0)="$ set proc/priv = all"
"RTN","AWCMFTP",50,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="$ set noon"
"RTN","AWCMFTP",51,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="$ assign sys$command sys$input "
"RTN","AWCMFTP",52,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="$ set verify"
"RTN","AWCMFTP",53,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="$ a=""''f$user()'"""
"RTN","AWCMFTP",54,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="$ set def "_AWCDIR
"RTN","AWCMFTP",55,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="$ set prot=(w:rwed,g:rwed,o:rwed,s:rwed) "_AWCDIR_AWCHFILE
"RTN","AWCMFTP",56,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="$ ftp "_AWCMSRV
"RTN","AWCMFTP",57,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)=AWCMUSR
"RTN","AWCMFTP",58,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)=AWCMPW
"RTN","AWCMFTP",59,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="ascii"
"RTN","AWCMFTP",60,0)
 I $G(AWCDIRCH)=1 S ^TMP("AWCMFTP",$J,AWC,0)="cd "_AWCWBFLD ;****
"RTN","AWCMFTP",61,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="put "_AWCHFIL1
"RTN","AWCMFTP",62,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="bye"
"RTN","AWCMFTP",63,0)
 S AWC=AWC+1,^TMP("AWCMFTP",$J,AWC,0)="$ exit"
"RTN","AWCMFTP",64,0)
 ; send to VMS
"RTN","AWCMFTP",65,0)
 S Y=$$GTF^%ZISH($NA(^TMP("AWCMFTP",$J,1,0)),3,AWCDIR,AWCHFILE)
"RTN","AWCMFTP",66,0)
 G:VMSC VMSC1
"RTN","AWCMFTP",67,0)
 ;
"RTN","AWCMFTP",68,0)
 ; USE $&ZLIB EXTERNAL CALLS FOR DSM/VMS
"RTN","AWCMFTP",69,0)
 S CMD="S %SUBMIT=$&ZLIB.%SUBMIT"_"("""_AWCDIR_AWCHFILE_""""_","_"""/NOPRINT"_$S(AWCMVMSL=1:"/LOG="_AWCDIR_$P(AWCHFILE,".",1)_".LOG"""_")",1:"/NOLOG"""_")")
"RTN","AWCMFTP",70,0)
 X CMD
"RTN","AWCMFTP",71,0)
 G EXIT
"RTN","AWCMFTP",72,0)
VMSC1 ;
"RTN","AWCMFTP",73,0)
 ; VMS Cache - use $ZF(-1 calls for OS commands
"RTN","AWCMFTP",74,0)
 S CMD="S AWCVAR=$ZF(-1,AWCVAR)"
"RTN","AWCMFTP",75,0)
 S AWCVAR="SUBMIT "_AWCDIR_AWCHFILE_"/NOPRINT"_$S(AWCMVMSL=1:"/LOG="_AWCDIR_$P(AWCHFILE,".",1)_".LOG",1:"/NOLOG")
"RTN","AWCMFTP",76,0)
 X CMD
"RTN","AWCMFTP",77,0)
 ;
"RTN","AWCMFTP",78,0)
EXIT K CMD,^TMP("AWCMFTP"),^TMP("AWCMFTPD"),AWCMVMSL,AWCMVMSD,AWCDTAX,AWC,AWCDIRCH
"RTN","AWCMFTP",79,0)
 Q
"RTN","AWCMFTP",80,0)
 ;
"RTN","AWCMFTP",81,0)
PURDEL ; purging/deletion script - whether this occurs is controlled in file 177100.12
"RTN","AWCMFTP",82,0)
 ; this part creates a com file to purge or delete files we have created and then it deletes itself
"RTN","AWCMFTP",83,0)
 ;
"RTN","AWCMFTP",84,0)
 S AWCDTAX=$G(^AWC(177100.12,1,0))
"RTN","AWCMFTP",85,0)
 S AWCMVMSL=+$P(AWCDTAX,U,16) ;VMS logging
"RTN","AWCMFTP",86,0)
 S AWCMVMSD=+$P(AWCDTAX,U,18) ;VMS delete
"RTN","AWCMFTP",87,0)
 S AWCHFILE="AWCPURGE.COM"
"RTN","AWCMFTP",88,0)
 ; captive process again so we give full privs
"RTN","AWCMFTP",89,0)
 K ^TMP("AWCMFTPD",$J)
"RTN","AWCMFTP",90,0)
 S AWC=1,^TMP("AWCMFTPD",$J,AWC,0)="$ wait 00:05"
"RTN","AWCMFTP",91,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ set proc/priv = all"
"RTN","AWCMFTP",92,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ set noon"
"RTN","AWCMFTP",93,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ assign sys$command sys$input "
"RTN","AWCMFTP",94,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ set verify"
"RTN","AWCMFTP",95,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ a=""''f$user()'"""
"RTN","AWCMFTP",96,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ set def "_AWCDIR
"RTN","AWCMFTP",97,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ set prot=(w:rwed,g:rwed,o:rwed,s:rwed) "_AWCDIR_"AWCMOVEHTM.LOG;*"
"RTN","AWCMFTP",98,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ set prot=(w:rwed,g:rwed,o:rwed,s:rwed) "_AWCDIR_"AWCMOVEHTM.COM;*"
"RTN","AWCMFTP",99,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ set prot=(w:rwed,g:rwed,o:rwed,s:rwed) "_AWCHFIL1_";*"
"RTN","AWCMFTP",100,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ set prot=(w:rwed,g:rwed,o:rwed,s:rwed) "_AWCDIR_"AWCPURGE.COM;*"
"RTN","AWCMFTP",101,0)
 ; purge or keep log files - 0 deletes all, 1 leaves one copy
"RTN","AWCMFTP",102,0)
 I AWCMVMSL=1 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ purge/keep=1 "_AWCDIR_"AWCMOVEHTM.LOG"
"RTN","AWCMFTP",103,0)
 I AWCMVMSL=0 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ delete "_AWCDIR_"AWCMOVEHTM.LOG;*"
"RTN","AWCMFTP",104,0)
 ; purge or delete all COM versions - 0 deletes all, 1 leaves one copy
"RTN","AWCMFTP",105,0)
 I AWCMVMSD=1 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ delete "_AWCDIR_"AWCMOVEHTM.COM;*"
"RTN","AWCMFTP",106,0)
 I AWCMVMSD=0 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ purge/keep=1 "_AWCDIR_"AWCMOVEHTM.COM;*"
"RTN","AWCMFTP",107,0)
 ; delete the web pages - automatic, not user controlled
"RTN","AWCMFTP",108,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ delete "_$P(AWCHFIL1,"_",1)_"*.*;*"
"RTN","AWCMFTP",109,0)
 S AWC=AWC+1,^TMP("AWCMFTPD",$J,AWC,0)="$ exit"
"RTN","AWCMFTP",110,0)
 ; send to VMS
"RTN","AWCMFTP",111,0)
 S Y=$$GTF^%ZISH($NA(^TMP("AWCMFTPD",$J,1,0)),3,AWCDIR,AWCHFILE)
"RTN","AWCMFTP",112,0)
 I AWCX="VMS" S CMD="S %SUBMIT=$&ZLIB.%SUBMIT"_"("""_AWCDIR_AWCHFILE_""""_","_"""/DELETE /NOPRINT /NOLOG"""_")"
"RTN","AWCMFTP",113,0)
 I AWCX="VMSC" S CMD="S AWCVAR=$ZF(-1,AWCVAR)"
"RTN","AWCMFTP",114,0)
 I AWCX="VMSC" S AWCVAR="SUBMIT "_AWCDIR_AWCHFILE_"/DELETE /NOPRINT /NOLOG"
"RTN","AWCMFTP",115,0)
 X CMD
"RTN","AWCMFTP",116,0)
 Q
"RTN","AWCMFTP1")
0^5^B17410452
"RTN","AWCMFTP1",1,0)
AWCMFTP1 ;VISN7/THM-FTP FILES TO NATIONAL ROLL-UP SERVER from VISTA ; Feb 27, 2004
"RTN","AWCMFTP1",2,0)
 ;;7.3;TOOLKIT;**84,86**;Jan 09, 2004
"RTN","AWCMFTP1",3,0)
 ;
"RTN","AWCMFTP1",4,0)
 W *7,!,"Enter at line EN^AWCMFTP1.",!
"RTN","AWCMFTP1",5,0)
 Q
"RTN","AWCMFTP1",6,0)
EN ; variables killed in calling program
"RTN","AWCMFTP1",7,0)
 S VMSC=""                                            ;INIT THE VAR
"RTN","AWCMFTP1",8,0)
 S AWCHFILE="AWCMOVESTAT.COM"                          ;COM file name
"RTN","AWCMFTP1",9,0)
 I AWCX="NT" S AWCHFILE=AWCFILE
"RTN","AWCMFTP1",10,0)
 S AWCDTAX=$G(^AWC(177100.12,1,0))
"RTN","AWCMFTP1",11,0)
 S AWCDIR=$P(AWCDTAX,U,5)             ;Parameter file
"RTN","AWCMFTP1",12,0)
 S:AWCDIR="" AWCDIR="SYS$SYSDEVICE:[DSMMGR]"          ;DEFAULT
"RTN","AWCMFTP1",13,0)
 S AWCSITE=$$SITE^VASITE,AWCSITE=$P(AWCSITE,U,2)      ;site Name
"RTN","AWCMFTP1",14,0)
 S AWCSITEN=+$$SITE^VASITE                            ;3 dig number
"RTN","AWCMFTP1",15,0)
 S AWCDIRL=$$LOW^XLFSTR(AWCDIR),AWCHFILL=$$LOW^XLFSTR(AWCHFILE)
"RTN","AWCMFTP1",16,0)
 S AWCDTX=$G(^AWC(177100.12,1,1))
"RTN","AWCMFTP1",17,0)
 S AWCWBFLD=$P(^AWC(177100.12,1,0),U,15),AWCWBFLD=$$LOW^XLFSTR(AWCWBFLD) ;web page folder
"RTN","AWCMFTP1",18,0)
 S AWCMVMSL=$P(AWCDTAX,U,16) ;VMS logging on or off
"RTN","AWCMFTP1",19,0)
 S AWCMVMSD=$P(AWCDTAX,U,18) ;DELETE COM files on or off
"RTN","AWCMFTP1",20,0)
 S AWCWBFLD=$P(AWCWBFLD,"/",2)
"RTN","AWCMFTP1",21,0)
 S AWCDIRCH=+$P(AWCDTAX,U,19) ;use change dir command?
"RTN","AWCMFTP1",22,0)
 S AWCMSRV=$P(AWCDTX,U,6),AWCMUSR=$P(AWCDTX,U,7),AWCMPW=$P(AWCDTX,U,8)
"RTN","AWCMFTP1",23,0)
 D @AWCX
"RTN","AWCMFTP1",24,0)
 Q
"RTN","AWCMFTP1",25,0)
 ;
"RTN","AWCMFTP1",26,0)
NT S AWCC=1
"RTN","AWCMFTP1",27,0)
 K ^TMP("AWCMFTP1",$J)
"RTN","AWCMFTP1",28,0)
 S ^TMP("AWCMFTP1",$J,AWCC,0)="open "_AWCMSRV,AWCC=AWCC+1 ;server ip address
"RTN","AWCMFTP1",29,0)
 S ^TMP("AWCMFTP1",$J,AWCC,0)=AWCMUSR,AWCC=AWCC+1 ; ftp user
"RTN","AWCMFTP1",30,0)
 S ^TMP("AWCMFTP1",$J,AWCC,0)=AWCMPW,AWCC=AWCC+1  ;ftp password
"RTN","AWCMFTP1",31,0)
 S ^TMP("AWCMFTP1",$J,AWCC,0)="ascii",AWCC=AWCC+1
"RTN","AWCMFTP1",32,0)
 S ^TMP("AWCMFTP1",$J,AWCC,0)="put "_AWCDIRL_"\"_AWCHFILE,AWCC=AWCC+1
"RTN","AWCMFTP1",33,0)
 S ^TMP("AWCMFTP1",$J,AWCC,0)="bye"
"RTN","AWCMFTP1",34,0)
 ; write it to the NT directory
"RTN","AWCMFTP1",35,0)
 S Y=$$GTF^%ZISH($NA(^TMP("AWCMFTP1",$J,1,0)),3,AWCDIRL,"ftpstatawc.txt")
"RTN","AWCMFTP1",36,0)
 ; send command to NT to execute this batch file
"RTN","AWCMFTP1",37,0)
 S CMD="S AWCVAR=$ZF(-1,""ftp -s:"_AWCDIRL_"\ftpstatawc.txt"")" X CMD
"RTN","AWCMFTP1",38,0)
 G EXIT
"RTN","AWCMFTP1",39,0)
 ;
"RTN","AWCMFTP1",40,0)
VMSC ; VMS FOR CACHE MODS TO DOUBLE CHECK FOR OS
"RTN","AWCMFTP1",41,0)
 S VMSC=1
"RTN","AWCMFTP1",42,0)
 ;
"RTN","AWCMFTP1",43,0)
VMS K ^TMP("AWCMFTP1",$J)
"RTN","AWCMFTP1",44,0)
 S AWC=1,^TMP("AWCMFTP1",$J,AWC,0)="$ set noon"
"RTN","AWCMFTP1",45,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ set proc/priv = all"
"RTN","AWCMFTP1",46,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ assign sys$command sys$input "
"RTN","AWCMFTP1",47,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ set verify"
"RTN","AWCMFTP1",48,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ a=""''f$user()'"""
"RTN","AWCMFTP1",49,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ set def "_AWCDIR
"RTN","AWCMFTP1",50,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ set prot=(w:rwed,g:rwed,o:rwed,s:rwed) "_AWCDIR_AWCHFILE
"RTN","AWCMFTP1",51,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ ftp "_AWCMSRV
"RTN","AWCMFTP1",52,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)=AWCMUSR
"RTN","AWCMFTP1",53,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)=AWCMPW
"RTN","AWCMFTP1",54,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="ascii"
"RTN","AWCMFTP1",55,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="put "_AWCHFIL1
"RTN","AWCMFTP1",56,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="bye"
"RTN","AWCMFTP1",57,0)
 ; purge or keep log files after FTP
"RTN","AWCMFTP1",58,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ wait 00:01"
"RTN","AWCMFTP1",59,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ set prot=(w:rwed,g:rwed,o:rwed,s:rwed) "_AWCDIR_AWCHFILE_";*"
"RTN","AWCMFTP1",60,0)
 I AWCMVMSL=1 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ purge/keep=1 "_AWCDIR_"AWCMOVESTAT.LOG"
"RTN","AWCMFTP1",61,0)
 I AWCMVMSL=0 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ delete "_AWCDIR_"AWCMOVESTAT.LOG;*"
"RTN","AWCMFTP1",62,0)
 ; purge or delete all web page versions after FTP
"RTN","AWCMFTP1",63,0)
 I AWCMVMSD=1 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ delete "_AWCDIR_AWCHFILE_";*"
"RTN","AWCMFTP1",64,0)
 I AWCMVMSD=0 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ purge/keep=1 "_AWCDIR_AWCHFILE
"RTN","AWCMFTP1",65,0)
 ; delete the stat text file - automatic,not user controlled
"RTN","AWCMFTP1",66,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ delete CPRSstats*.*;*"
"RTN","AWCMFTP1",67,0)
 S AWC=AWC+1,^TMP("AWCMFTP1",$J,AWC,0)="$ exit"
"RTN","AWCMFTP1",68,0)
 ; send to VMS
"RTN","AWCMFTP1",69,0)
 S Y=$$GTF^%ZISH($NA(^TMP("AWCMFTP1",$J,1,0)),3,AWCDIR,AWCHFILE)
"RTN","AWCMFTP1",70,0)
 G:VMSC VMSC1
"RTN","AWCMFTP1",71,0)
 ; USE $&ZLIB EXTERNAL CALLS FOR DSM
"RTN","AWCMFTP1",72,0)
 S CMD="S %SUBMIT=$&ZLIB.%SUBMIT"_"("""_AWCDIR_AWCHFILE_""""_","_"""/NOPRINT"_$S(AWCMVMSL=1:"/LOG="_AWCDIR_"AWCMOVESTAT.LOG"""_")",1:"/NOLOG"""_")")
"RTN","AWCMFTP1",73,0)
 X CMD
"RTN","AWCMFTP1",74,0)
 G EXIT
"RTN","AWCMFTP1",75,0)
VMSC1 ;
"RTN","AWCMFTP1",76,0)
 ; vms cache
"RTN","AWCMFTP1",77,0)
 ; USE $ZF CALLS FOR OS COMMANDS IN CACHE
"RTN","AWCMFTP1",78,0)
 S CMD="S AWCVAR=$ZF(-1,AWCVAR)"
"RTN","AWCMFTP1",79,0)
 S AWCVAR="SUBMIT "_AWCDIR_AWCHFILE_"/NOPRINT"_$S(AWCMVMSL=1:"/LOG="_AWCDIR_"AWCMOVESTAT.LOG",1:"/NOLOG")
"RTN","AWCMFTP1",80,0)
 X CMD
"RTN","AWCMFTP1",81,0)
 ;
"RTN","AWCMFTP1",82,0)
EXIT ;
"RTN","AWCMFTP1",83,0)
 K CMD,^TMP("AWCMFTP1",$J),AWCMVMSL,AWCMVMSD,AWCDTAX,AWCDTX,AWC,AWCMANL
"RTN","AWCMFTP1",84,0)
 Q
"VER")
8.0^22.0
"^DD",177100.12,177100.12,0)
FIELD^^25^26
"^DD",177100.12,177100.12,0,"DDA")
N
"^DD",177100.12,177100.12,0,"DT")
3040201
"^DD",177100.12,177100.12,0,"IX","B",177100.12,.01)

"^DD",177100.12,177100.12,0,"NM","CPRS MONITOR")

"^DD",177100.12,177100.12,0,"VRPK")
XT
"^DD",177100.12,177100.12,.01,0)
FACILITY^RP4'X^DIC(4,^0;1^S DINUM=1 Q
"^DD",177100.12,177100.12,.01,1,0)
^.1
"^DD",177100.12,177100.12,.01,1,1,0)
177100.12^B
"^DD",177100.12,177100.12,.01,1,1,1)
S ^AWC(177100.12,"B",$E(X,1,30),DA)=""
"^DD",177100.12,177100.12,.01,1,1,2)
K ^AWC(177100.12,"B",$E(X,1,30),DA)
"^DD",177100.12,177100.12,.01,1,2,0)
^^TRIGGER^177100.12^1.5
"^DD",177100.12,177100.12,.01,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^AWC(177100.12,D0,1)):^(1),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y X ^DD(177100.12,.01,1,2,1.1) X ^DD(177100.12,.01,1,2,1.4)
"^DD",177100.12,177100.12,.01,1,2,1.1)
S X=DIV S I(0,0)=$G(D0),D0=DIV S:'D0!'$D(^DIC(4,+D0,0)) D0=-1 S Y(101)=$S($D(^DIC(4,D0,99)):^(99),1:"") S X=$P(Y(101),U,1) S D0=I(0,0)
"^DD",177100.12,177100.12,.01,1,2,1.4)
S DIH=$G(^AWC(177100.12,DIV(0),1)),DIV=X S $P(^(1),U,2)=DIV,DIH=177100.12,DIG=1.5 D ^DICR
"^DD",177100.12,177100.12,.01,1,2,2)
Q
"^DD",177100.12,177100.12,.01,1,2,"%D",0)
^^1^1^3031228^
"^DD",177100.12,177100.12,.01,1,2,"%D",1,0)
Stuff the station number into field 1.5 when Facility is entered.
"^DD",177100.12,177100.12,.01,1,2,"CREATE VALUE")
FACILITY:#99
"^DD",177100.12,177100.12,.01,1,2,"DELETE VALUE")
NO EFFECT
"^DD",177100.12,177100.12,.01,1,2,"DT")
3031228
"^DD",177100.12,177100.12,.01,1,2,"FIELD")
#1.5
"^DD",177100.12,177100.12,.01,3)
Enter the station number or name of the main facility where this software will run.
"^DD",177100.12,177100.12,.01,21,0)
^^2^2^3031226^
"^DD",177100.12,177100.12,.01,21,1,0)
This is a pointer to file 4, the INSTITUTION file which will provide the
"^DD",177100.12,177100.12,.01,21,2,0)
name of your facility.
"^DD",177100.12,177100.12,.01,"DT")
3031228
"^DD",177100.12,177100.12,1,0)
TIU TAB^RS^1:ON;0:OFF;^0;2^Q
"^DD",177100.12,177100.12,1,3)
Enter 1 for ON, 0 for OFF, or you may type in ON or OFF.
"^DD",177100.12,177100.12,1,21,0)
^^2^2^3030801^
"^DD",177100.12,177100.12,1,21,1,0)
This is a logical switch that controls whether data is captured for the
"^DD",177100.12,177100.12,1,21,2,0)
item.
"^DD",177100.12,177100.12,1,"DT")
3031230
"^DD",177100.12,177100.12,1.2,0)
SYSTEM ACTIVE^RS^1:YES;0:NO;^0;17^Q
"^DD",177100.12,177100.12,1.2,3)
Enter Y or 1 to turn the data capture on or N or 0 to turn it off.
"^DD",177100.12,177100.12,1.2,21,0)
^^1^1^3030821^
"^DD",177100.12,177100.12,1.2,21,1,0)
This is the master switch for the entire data capture system.
"^DD",177100.12,177100.12,1.2,"DT")
3031230
"^DD",177100.12,177100.12,1.5,0)
STATION NUMBER^F^^1;2^K:$L(X)>3!($L(X)<3)!'(X?3N) X
"^DD",177100.12,177100.12,1.5,3)
This field is triggered by the FACILITY field (#.01).
"^DD",177100.12,177100.12,1.5,5,1,0)
177100.12^.01^2
"^DD",177100.12,177100.12,1.5,21,0)
^^3^3^3031226^
"^DD",177100.12,177100.12,1.5,21,1,0)
This is the local station number and is triggered by field .01, the 
"^DD",177100.12,177100.12,1.5,21,2,0)
FACILITY field. All national statistics will be aggregated under this
"^DD",177100.12,177100.12,1.5,21,3,0)
number.
"^DD",177100.12,177100.12,1.5,"DT")
3031226
"^DD",177100.12,177100.12,2,0)
LAB COVERSHEET^RS^1:ON;0:OFF;^0;3^Q
"^DD",177100.12,177100.12,2,3)
Enter 1 for ON, 0 for OFF, or you may type in ON or OFF.
"^DD",177100.12,177100.12,2,21,0)
^^2^2^3030801^
"^DD",177100.12,177100.12,2,21,1,0)
This is a logical switch that controls whether data is captured for the
"^DD",177100.12,177100.12,2,21,2,0)
item.
"^DD",177100.12,177100.12,2,"DT")
3031230
"^DD",177100.12,177100.12,3,0)
REMINDERS COVERSHEET^RS^1:ON;0:OFF;^0;4^Q
"^DD",177100.12,177100.12,3,3)
Enter 1 for ON, 0 for OFF, or you may type in ON or OFF.
"^DD",177100.12,177100.12,3,21,0)
^^2^2^3030801^
"^DD",177100.12,177100.12,3,21,1,0)
This is a logical switch that controls whether data is captured for the
"^DD",177100.12,177100.12,3,21,2,0)
item.
"^DD",177100.12,177100.12,3,"DT")
3031230
"^DD",177100.12,177100.12,4,0)
HFS LOCATION^RF^^0;5^K:$L(X)>40!($L(X)<3) X
"^DD",177100.12,177100.12,4,3)
Answer must be 3-40 characters in length.  This is a required field.
"^DD",177100.12,177100.12,4,21,0)
^^5^5^3031228^
"^DD",177100.12,177100.12,4,21,1,0)
This is a host file location that will be used to write the html pages to 
"^DD",177100.12,177100.12,4,21,2,0)
be sent by ftp to the web server.  This may be any directory accessible 
"^DD",177100.12,177100.12,4,21,3,0)
by the operating system. It should be noted that the proper permissions 
"^DD",177100.12,177100.12,4,21,4,0)
must exist on the directory, e.g., read, write, and delete for all 
"^DD",177100.12,177100.12,4,21,5,0)
functions to work properly.
"^DD",177100.12,177100.12,4,"DT")
3031228
"^DD",177100.12,177100.12,5,0)
WEB PAGE NAME^RFX^^0;6^K:$L(X)>20!($L(X)<5) X I $D(X) K:"^.html^.htm^.HTML^.HTM^"[(U_"."_$P(X,".",2)_U) X
"^DD",177100.12,177100.12,5,3)
Enter the name of the web page, without .htm or .html.
"^DD",177100.12,177100.12,5,21,0)
^^2^2^3030828^
"^DD",177100.12,177100.12,5,21,1,0)
This is the name of the webpage for the server. It may be anything the 
"^DD",177100.12,177100.12,5,21,2,0)
facility wishes.
"^DD",177100.12,177100.12,5,"DT")
3040201
"^DD",177100.12,177100.12,6,0)
NUMBER OF HOURS TO DISPLAY^RNJ2,0^^0;7^K:+X'=X!(X>12)!(X<5)!(X?.E1"."1.N) X
"^DD",177100.12,177100.12,6,3)
Type a number between 5 and 12.  The recommended is eight hours.
"^DD",177100.12,177100.12,6,21,0)
^^1^1^3031226^
"^DD",177100.12,177100.12,6,21,1,0)
This controls the number of hours displayed on the web page.
"^DD",177100.12,177100.12,6,"DT")
3031226
"^DD",177100.12,177100.12,7,0)
MAXIMUM SECONDS TO DISPLAY^RNJ3,0^^0;8^K:+X'=X!(X>240)!(X<10)!(X?.E1"."1.N) X
"^DD",177100.12,177100.12,7,3)
Type a number between 10 and 240.  The recommended is ten seconds.
"^DD",177100.12,177100.12,7,21,0)
^^3^3^3030828^^
"^DD",177100.12,177100.12,7,21,1,0)
This field controls how many seconds display on the html graph.  It can 
"^DD",177100.12,177100.12,7,21,2,0)
be set from 10 to 240 seconds.  Anything over 240 will flatline at the top
"^DD",177100.12,177100.12,7,21,3,0)
of the graph.  
"^DD",177100.12,177100.12,7,"DT")
3030828
"^DD",177100.12,177100.12,8,0)
TIU LINE COLOR^RF^^0;9^K:$L(X)>11!($L(X)<5)!'(X?1.3N1","1.3N1","1.3N) X
"^DD",177100.12,177100.12,8,3)
Answer must be 5-11 characters in length.  This is an RGB color code.  Example: 100,23,109.
"^DD",177100.12,177100.12,8,21,0)
^.001^2^2^3030801^^^
"^DD",177100.12,177100.12,8,21,1,0)
The RGB color code for the TIU line.  It must be in the form 1-3 numbers, 
"^DD",177100.12,177100.12,8,21,2,0)
1 comma,1-3 numbers, 1 comma, 1-3 numbers.
"^DD",177100.12,177100.12,8,"DT")
3031230
"^DD",177100.12,177100.12,9,0)
LAB LINE COLOR^RF^^0;10^K:$L(X)>11!($L(X)<5)!'(X?1.3N1","1.3N1","1.3N) X
"^DD",177100.12,177100.12,9,3)
Answer must be 5-11 characters in length.  This is an RGB color code.  Example: 100,23,109.
"^DD",177100.12,177100.12,9,21,0)
^^2^2^3030801^
"^DD",177100.12,177100.12,9,21,1,0)
The RGB color code for the LAB line.  It must be in the form 1-3 numbers,
"^DD",177100.12,177100.12,9,21,2,0)
1 comma,1-3 numbers, 1 comma, 1-3 numbers.
"^DD",177100.12,177100.12,9,"DT")
3031205
"^DD",177100.12,177100.12,10,0)
REMINDERS LINE COLOR^RF^^0;11^K:$L(X)>11!($L(X)<5)!'(X?1.3N1","1.3N1","1.3N) X
"^DD",177100.12,177100.12,10,3)
Answer must be 5-11 characters in length.  This is an RGB color code.  Example: 100,23,109.
"^DD",177100.12,177100.12,10,21,0)
^^2^2^3030801^
"^DD",177100.12,177100.12,10,21,1,0)
The RGB color code for the REMINDER line.  It must be in the form 1-3
"^DD",177100.12,177100.12,10,21,2,0)
numbers, 1 comma,1-3 numbers, 1 comma, 1-3 numbers.
"^DD",177100.12,177100.12,10,"DT")
3031230
"^DD",177100.12,177100.12,11,0)
DISPLAY GRID?^RS^0:NO;1:YES;^0;12^Q
"^DD",177100.12,177100.12,11,3)
Enter 1 or Y to display the grid, 0 or N not to display it.
"^DD",177100.12,177100.12,11,21,0)
^^3^3^3030801^
"^DD",177100.12,177100.12,11,21,1,0)
This determines whether the graph on the webpage has the grid display off
"^DD",177100.12,177100.12,11,21,2,0)
or on. It is suggested to leave the grid on at all times to facilitate 
"^DD",177100.12,177100.12,11,21,3,0)
viewing the data values displayed.
"^DD",177100.12,177100.12,11,"DT")
3031228
"^DD",177100.12,177100.12,12,0)
BACKGROUND COLOR^RFX^^0;13^K:$L(X)>11!($L(X)<5)!'(X?1.3N1","1.3N1","1.3N) X
"^DD",177100.12,177100.12,12,3)
Answer must be 5-11 characters in length.  This is an RGB color code.  Example: 100,23,109.
"^DD",177100.12,177100.12,12,21,0)
^^2^2^3030801^
"^DD",177100.12,177100.12,12,21,1,0)
The RGB color code for the graph background.  It must be in the form 1-3
"^DD",177100.12,177100.12,12,21,2,0)
numbers, 1 comma,1-3 numbers, 1 comma, 1-3 numbers. Example: 100,23,109.
"^DD",177100.12,177100.12,12,"DT")
3031205
"^DD",177100.12,177100.12,13,0)
NUMBER OF DAYS TO KEEP DATA^NJ4,0^^0;14^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1.N) X
"^DD",177100.12,177100.12,13,3)
Type a number between 1 and 9999, 0 Decimal Digits
"^DD",177100.12,177100.12,13,21,0)
^^3^3^3031228^
"^DD",177100.12,177100.12,13,21,1,0)
This is the number of days to keep the data on file.  It is suggested to 
"^DD",177100.12,177100.12,13,21,2,0)
keep the maximum on file so as to be able to produce trends with VA 
"^DD",177100.12,177100.12,13,21,3,0)
Fileman.  You may select from 1 day to 9999 days.
"^DD",177100.12,177100.12,13,"DT")
3031228
"^DD",177100.12,177100.12,14,0)
WEB PAGE ROOT LOCATION^RF^^0;15^K:$L(X)>50!($L(X)<1) X
"^DD",177100.12,177100.12,14,3)
Answer must be 1-50 characters in length.  This entry should not end in / .
"^DD",177100.12,177100.12,14,21,0)
^^16^16^3031226^
"^DD",177100.12,177100.12,14,21,1,0)
This is the root of the web page to be able to display other divisions.  
"^DD",177100.12,177100.12,14,21,2,0)
It is also used to enable the auto-refresh of the web pages.
"^DD",177100.12,177100.12,14,21,3,0)
 
"^DD",177100.12,177100.12,14,21,4,0)
The proper format is: vaww.facility.med.va.gov/web server foldername. You
"^DD",177100.12,177100.12,14,21,5,0)
do not have to have a "/" on the end.
"^DD",177100.12,177100.12,14,21,6,0)
 
"^DD",177100.12,177100.12,14,21,7,0)
If this is not filled in properly, the other sites (divisions, satellite 
"^DD",177100.12,177100.12,14,21,8,0)
offices, CBOCs, etc.) will not display properly.
"^DD",177100.12,177100.12,14,21,9,0)
 
"^DD",177100.12,177100.12,14,21,10,0)
Example: web server folder name for monitor page: cprsmonitor
"^DD",177100.12,177100.12,14,21,11,0)
                                                  ===========
"^DD",177100.12,177100.12,14,21,12,0)
         facility name: zzzhospital
"^DD",177100.12,177100.12,14,21,13,0)
                        ===========
"^DD",177100.12,177100.12,14,21,14,0)
The entry would be:  vaww.zzzhospital.med.va.gov/cprsmonitor
"^DD",177100.12,177100.12,14,21,15,0)
 
"^DD",177100.12,177100.12,14,21,16,0)
Each satellite office page will be appended to this to make a full URL.
"^DD",177100.12,177100.12,14,"DT")
3031226
"^DD",177100.12,177100.12,17,0)
WEB SERVER ADDRESS^RFX^^1;3^K:$L(X)>50!($L(X)<7) X
"^DD",177100.12,177100.12,17,3)
Answer must be 7-50 characters in length and a valid DNS entry.
"^DD",177100.12,177100.12,17,21,0)
^^2^2^3030828^
"^DD",177100.12,177100.12,17,21,1,0)
This is the IP address of the webserver that will display the monitor 
"^DD",177100.12,177100.12,17,21,2,0)
page.
"^DD",177100.12,177100.12,17,"DT")
3031226
"^DD",177100.12,177100.12,18,0)
WEB SERVER FTP USER^RF^^1;4^K:$L(X)>30!($L(X)<3) X
"^DD",177100.12,177100.12,18,2)
S Y(0)=Y S Y="<Hidden>"
"^DD",177100.12,177100.12,18,2.1)
S Y="<Hidden>"
"^DD",177100.12,177100.12,18,3)
Answer must be 3-30 characters in length.
"^DD",177100.12,177100.12,18,21,0)
^^8^8^3031224^
"^DD",177100.12,177100.12,18,21,1,0)
This is the NT username that will be used to log into the WEB SITE FTP
"^DD",177100.12,177100.12,18,21,2,0)
server where the facility monitor pages are stored. It must be a valid NT
"^DD",177100.12,177100.12,18,21,3,0)
account but does not have to be in any groups or have special access.
"^DD",177100.12,177100.12,18,21,4,0)
 
"^DD",177100.12,177100.12,18,21,5,0)
This field must be input in this way:  domain\username
"^DD",177100.12,177100.12,18,21,6,0)
                                Like:  vhann\vhaxxxname
"^DD",177100.12,177100.12,18,21,7,0)
 
"^DD",177100.12,177100.12,18,21,8,0)
                Example:  vha07\vhabirsmythj
"^DD",177100.12,177100.12,18,"DT")
3031226
"^DD",177100.12,177100.12,19,0)
WEB SERVER FTP PASSWORD^RFOX^^1;5^K:$L(X)>16!($L(X)<8) X
"^DD",177100.12,177100.12,19,2)
S Y(0)=Y S Y="<Hidden>"
"^DD",177100.12,177100.12,19,2.1)
S Y="<Hidden>"
"^DD",177100.12,177100.12,19,3)
This is the NT password for the LOCAL FTP USER.
"^DD",177100.12,177100.12,19,21,0)
^^2^2^3031224^
"^DD",177100.12,177100.12,19,21,1,0)
This is the password to be used with the username (field 18) to log into 
"^DD",177100.12,177100.12,19,21,2,0)
the WEB SITE FTP server where the monitor pages are stored.
"^DD",177100.12,177100.12,19,"DT")
3031224
"^DD",177100.12,177100.12,20,0)
NATIONAL FTP SERVER ADDRESS^RFX^^1;6^K:$L(X)>50!($L(X)<7) X
"^DD",177100.12,177100.12,20,3)
Answer must be 7-50 characters in length and must be a valid DNS entry.
"^DD",177100.12,177100.12,20,21,0)
^^2^2^3031226^
"^DD",177100.12,177100.12,20,21,1,0)
This is the DNS of the National server which will keep the national cprs
"^DD",177100.12,177100.12,20,21,2,0)
monitor time aggregation for the nation.
"^DD",177100.12,177100.12,20,"DT")
3031226
"^DD",177100.12,177100.12,21,0)
NATIONAL FTP USER^RF^^1;7^K:$L(X)>30!($L(X)<3) X
"^DD",177100.12,177100.12,21,2)
S Y(0)=Y S Y="<Hidden>"
"^DD",177100.12,177100.12,21,2.1)
S Y="<Hidden>"
"^DD",177100.12,177100.12,21,3)
Answer must be 3-30 characters in length.  This is the National ftp user name.
"^DD",177100.12,177100.12,21,21,0)
^^1^1^3031226^
"^DD",177100.12,177100.12,21,21,1,0)
This is the NT username for the National CPRS monitor times web server.  
"^DD",177100.12,177100.12,21,"DT")
3031226
"^DD",177100.12,177100.12,22,0)
NATIONAL FTP PASSWORD^RFOX^^1;8^K:$L(X)>16!($L(X)<8) X
"^DD",177100.12,177100.12,22,2)
S Y(0)=Y S Y="<Hidden>"
"^DD",177100.12,177100.12,22,2.1)
S Y="<Hidden>"
"^DD",177100.12,177100.12,22,3)
This is the FTP password to roll up the national data.
"^DD",177100.12,177100.12,22,21,0)
^^2^2^3030828^
"^DD",177100.12,177100.12,22,21,1,0)
This is the password used with the NATIONAL FTP USER to access the 
"^DD",177100.12,177100.12,22,21,2,0)
National CPRS Monitor ftp site to roll up the data.
"^DD",177100.12,177100.12,22,"DT")
3030915
"^DD",177100.12,177100.12,23,0)
LOG VMS FTP ACTIVITY^S^1:YES;0:NO;^0;16^Q
"^DD",177100.12,177100.12,23,3)
Enter 1 to log VMS activity or 0 (or enter nothing) to not log VMS activity.
"^DD",177100.12,177100.12,23,21,0)
^^1^1^3031118^
"^DD",177100.12,177100.12,23,21,1,0)
Turns on or off VMS FTP activity logging.  This affects VMS sites only.
"^DD",177100.12,177100.12,23,"DT")
3031226
"^DD",177100.12,177100.12,24,0)
DELETE OLD COM FILES (VMS)^S^0:NO;1:YES;^0;18^Q
"^DD",177100.12,177100.12,24,3)
Enter Y or 1 to delete the AWCMOVEHTM.COM after ftp or N or 0 (or nothing) to leave them.  This affects VMS sites only.
"^DD",177100.12,177100.12,24,21,0)
^^2^2^3031118^
"^DD",177100.12,177100.12,24,21,1,0)
Controls the deletion of web pages after the ftp process has completed.  
"^DD",177100.12,177100.12,24,21,2,0)
This affects VMS sites only.
"^DD",177100.12,177100.12,24,"DT")
3031226
"^DD",177100.12,177100.12,25,0)
USE 'CD' COMMAND IN FTP SCRIPT^S^0:NO;1:YES;^0;19^Q
"^DD",177100.12,177100.12,25,3)
If your site web server setup requires a "change directory" command, enter 1 for YES. If you change this value, always check to make sure it does what you want.
"^DD",177100.12,177100.12,25,21,0)
^^26^26^3040130^
"^DD",177100.12,177100.12,25,21,1,0)
 
"^DD",177100.12,177100.12,25,21,2,0)
This field controls an additional instruction for the VMS com files that
"^DD",177100.12,177100.12,25,21,3,0)
this application constructs during exection. The com file has commands for
"^DD",177100.12,177100.12,25,21,4,0)
the FTP program to move a web page to a server.
"^DD",177100.12,177100.12,25,21,5,0)
 
"^DD",177100.12,177100.12,25,21,6,0)
Some sites, according to the revision of they have (Windows 2000 
"^DD",177100.12,177100.12,25,21,7,0)
server versus Windows 2003 server) and may arrive in the FTP root 
"^DD",177100.12,177100.12,25,21,8,0)
directory and may need to issue this command to go to the correct 
"^DD",177100.12,177100.12,25,21,9,0)
directory:
"^DD",177100.12,177100.12,25,21,10,0)
 
"^DD",177100.12,177100.12,25,21,11,0)
        where 'mydirectory' is the name of the directory that needs
"^DD",177100.12,177100.12,25,21,12,0)
          to be changed to:
"^DD",177100.12,177100.12,25,21,13,0)
 
"^DD",177100.12,177100.12,25,21,14,0)
                cd mydirectory
"^DD",177100.12,177100.12,25,21,15,0)
 
"^DD",177100.12,177100.12,25,21,16,0)
Setting this field to 1 or YES will insert the above command into the 
"^DD",177100.12,177100.12,25,21,17,0)
script and force a directory change.
"^DD",177100.12,177100.12,25,21,18,0)
 
"^DD",177100.12,177100.12,25,21,19,0)
The necessity of this command is dictated by the IIS revision.  Under
"^DD",177100.12,177100.12,25,21,20,0)
IIS versions less than v6, a proper virtual directory access is not
"^DD",177100.12,177100.12,25,21,21,0)
feasible and the command must be used.
"^DD",177100.12,177100.12,25,21,22,0)
SURE to check the success.
"^DD",177100.12,177100.12,25,21,23,0)
 
"^DD",177100.12,177100.12,25,21,24,0)
NT sites do not need this switch but if used will not interfere with the 
"^DD",177100.12,177100.12,25,21,25,0)
transfer.  VMS sites must be careful because if you issue this command 
"^DD",177100.12,177100.12,25,21,26,0)
and it is not needed, the com file will fail.
"^DD",177100.12,177100.12,25,"DT")
3040130
"^DIC",177100.12,177100.12,0)
CPRS MONITOR^177100.12
"^DIC",177100.12,177100.12,0,"GL")
^AWC(177100.12,
"^DIC",177100.12,177100.12,"%",0)
^1.005^^0
"^DIC",177100.12,177100.12,"%D",0)
^1.001^3^3^3031229^^^^
"^DIC",177100.12,177100.12,"%D",1,0)
This is a parameter file for CPRS response time monitoring.  It keeps all 
"^DIC",177100.12,177100.12,"%D",2,0)
necessary information to make web pages with the response times graphed 
"^DIC",177100.12,177100.12,"%D",3,0)
on them.
"^DIC",177100.12,"B","CPRS MONITOR",177100.12)

**END**
**END**
