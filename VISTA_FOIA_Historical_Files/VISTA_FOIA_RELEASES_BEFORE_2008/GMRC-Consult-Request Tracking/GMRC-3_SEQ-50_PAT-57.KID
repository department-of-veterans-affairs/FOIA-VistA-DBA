EMERGENCY Released GMRC*3*57 SEQ #50
Extracted from mail message
**KIDS**:GMRC*3.0*57^

**INSTALL NAME**
GMRC*3.0*57
"BLD",6733,0)
GMRC*3.0*57^CONSULT/REQUEST TRACKING^0^3070801^y
"BLD",6733,1,0)
^^4^4^3070724^
"BLD",6733,1,1,0)
This build is for patch GMRC*3*57.  The patch creates a new service in 
"BLD",6733,1,2,0)
123.5 that supports the VA Suicide Hotline.
"BLD",6733,1,3,0)
One post install routine adds the new serivce and also includes in the 
"BLD",6733,1,4,0)
sub-service of the All Services grouper.
"BLD",6733,4,0)
^9.64PA^123.5^1
"BLD",6733,4,123.5,0)
123.5
"BLD",6733,4,123.5,2,0)
^9.641^123.5^1
"BLD",6733,4,123.5,2,123.5,0)
REQUEST SERVICES  (File-top level)
"BLD",6733,4,123.5,2,123.5,1,0)
^9.6411^.01^1
"BLD",6733,4,123.5,2,123.5,1,.01,0)
SERVICE NAME
"BLD",6733,4,123.5,222)
y^y^p^^^^n^^n
"BLD",6733,4,123.5,224)

"BLD",6733,4,"APDD",123.5,123.5)

"BLD",6733,4,"APDD",123.5,123.5,.01)

"BLD",6733,4,"B",123.5,123.5)

"BLD",6733,6)
6^
"BLD",6733,6.3)
10
"BLD",6733,"INI")
PRE^GMRCYP57
"BLD",6733,"INID")
^n
"BLD",6733,"INIT")
GMRCYP57
"BLD",6733,"KRN",0)
^9.67PA^8989.52^19
"BLD",6733,"KRN",.4,0)
.4
"BLD",6733,"KRN",.401,0)
.401
"BLD",6733,"KRN",.402,0)
.402
"BLD",6733,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",6733,"KRN",.402,"NM",1,0)
GMRC SETUP REQUEST SERVICE    FILE #123.5^123.5^0
"BLD",6733,"KRN",.402,"NM","B","GMRC SETUP REQUEST SERVICE    FILE #123.5",1)

"BLD",6733,"KRN",.403,0)
.403
"BLD",6733,"KRN",.5,0)
.5
"BLD",6733,"KRN",.84,0)
.84
"BLD",6733,"KRN",3.6,0)
3.6
"BLD",6733,"KRN",3.8,0)
3.8
"BLD",6733,"KRN",9.2,0)
9.2
"BLD",6733,"KRN",9.8,0)
9.8
"BLD",6733,"KRN",19,0)
19
"BLD",6733,"KRN",19.1,0)
19.1
"BLD",6733,"KRN",101,0)
101
"BLD",6733,"KRN",409.61,0)
409.61
"BLD",6733,"KRN",771,0)
771
"BLD",6733,"KRN",870,0)
870
"BLD",6733,"KRN",8989.51,0)
8989.51
"BLD",6733,"KRN",8989.52,0)
8989.52
"BLD",6733,"KRN",8994,0)
8994
"BLD",6733,"KRN","B",.4,.4)

"BLD",6733,"KRN","B",.401,.401)

"BLD",6733,"KRN","B",.402,.402)

"BLD",6733,"KRN","B",.403,.403)

"BLD",6733,"KRN","B",.5,.5)

"BLD",6733,"KRN","B",.84,.84)

"BLD",6733,"KRN","B",3.6,3.6)

"BLD",6733,"KRN","B",3.8,3.8)

"BLD",6733,"KRN","B",9.2,9.2)

"BLD",6733,"KRN","B",9.8,9.8)

"BLD",6733,"KRN","B",19,19)

"BLD",6733,"KRN","B",19.1,19.1)

"BLD",6733,"KRN","B",101,101)

"BLD",6733,"KRN","B",409.61,409.61)

"BLD",6733,"KRN","B",771,771)

"BLD",6733,"KRN","B",870,870)

"BLD",6733,"KRN","B",8989.51,8989.51)

"BLD",6733,"KRN","B",8989.52,8989.52)

"BLD",6733,"KRN","B",8994,8994)

"BLD",6733,"QUES",0)
^9.62^^
"BLD",6733,"REQB",0)
^9.611^^
"FIA",123.5)
REQUEST SERVICES
"FIA",123.5,0)
^GMR(123.5,
"FIA",123.5,0,0)
123.5I
"FIA",123.5,0,1)
y^y^p^^^^n^^n
"FIA",123.5,0,10)

"FIA",123.5,0,11)

"FIA",123.5,0,"RLRO")

"FIA",123.5,0,"VR")
3.0^GMRC
"FIA",123.5,123.5)
1
"FIA",123.5,123.5,.01)

"INI")
PRE^GMRCYP57
"INIT")
GMRCYP57
"KRN",.402,1137,-1)
0^1
"KRN",.402,1137,0)
GMRC SETUP REQUEST SERVICE^3070726.0811^^123.5^^^3070727
"KRN",.402,1137,"DIAB",1,1,123.51,0)
ALL
"KRN",.402,1137,"DIAB",1,1,123.5134,0)
ALL
"KRN",.402,1137,"DIAB",1,1,123.52,0)
ALL
"KRN",.402,1137,"DIAB",1,1,123.53,0)
ALL
"KRN",.402,1137,"DIAB",1,1,123.54,0)
ALL
"KRN",.402,1137,"DIAB",1,1,123.555,0)
ALL
"KRN",.402,1137,"DIAB",1,1,123.57,0)
ALL
"KRN",.402,1137,"DIAB",1,1,123.58,0)
ALL
"KRN",.402,1137,"DIAB",1,1,123.59,0)
ALL
"KRN",.402,1137,"DIAB",3,0,123.5,3)
PRINT NAME;"ABBREVIATED PRINT NAME (Optional)~"
"KRN",.402,1137,"DR",1,123.5)
I '$D(GMRCSAFE) D EN^DDIOL("Editing of this file should only be done via the Setup Request Services option.") S Y="";
"KRN",.402,1137,"DR",1,123.5,1)
I $O(^GMR(123.5,DA,"IFCS",0)) D EN^DDIOL("Service is configured to receive inter-facility consults from another facility.","","!!");
"KRN",.402,1137,"DR",1,123.5,2)
I $O(^GMR(123.5,DA,"IFCS",0)) D EN^DDIOL("Editing of the SERVICE NAME may disrupt inter-facility consult operations.","","!");D EN^DDIOL(" ") I $G(GMRCSAFE) S Y=123.01;S:$P(^GMR(123.5,DA,0),U)="SUICIDE HOTLINE" Y="@1";.01;@1;
"KRN",.402,1137,"DR",1,123.5,3)
123.01///^S X="CONSULTS";I $G(GMRCSAFE) S Y=1.1;1.11ABBREVIATED PRINT NAME (Optional)~~;11;1.1;123.03///^S X="GMRCACTM SERVICE ACTION MENU";2;123.09;1.04;1.05;125;I $G(GMRCSAFE) S Y=123.08;1.01;1.02;124;1.03;D EN^DDIOL(" ");
"KRN",.402,1137,"DR",1,123.5,4)
D EN^DDIOL("Inter-facility information");I $O(^GMR(123.5,DA,"IFCS",0)) D EN^DDIOL(" ") S Y=134;132;133;I +$G(^GMR(123.5,DA,"IFC")) D EN^DDIOL(" ") S Y=123.08;134;D EN^DDIOL(" ");123.08;123.1;123.2;.08;123.3;123.31;123.35;123.33;
"KRN",.402,1137,"DR",1,123.5,5)
123.34;.07;D EN^DDIOL(" ");123.5;1.06;.06;10;
"KRN",.402,1137,"DR",2,123.51)
.01:2
"KRN",.402,1137,"DR",2,123.5134)
.01
"KRN",.402,1137,"DR",2,123.52)
.01
"KRN",.402,1137,"DR",2,123.53)
.01
"KRN",.402,1137,"DR",2,123.54)
.01:2
"KRN",.402,1137,"DR",2,123.55)
.01;
"KRN",.402,1137,"DR",2,123.555)
.01:.02
"KRN",.402,1137,"DR",2,123.57)
.01
"KRN",.402,1137,"DR",2,123.58)
.01:.02
"KRN",.402,1137,"DR",2,123.59)
.01
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",128,-1)
1^1
"PKG",128,0)
CONSULT/REQUEST TRACKING^GMRC^13
"PKG",128,20,0)
^9.402P^^
"PKG",128,22,0)
^9.49I^1^1
"PKG",128,22,1,0)
3.0^2980101
"PKG",128,22,1,"PAH",1,0)
57^3070801^123456789151
"PKG",128,22,1,"PAH",1,1,0)
^^4^4^3070801
"PKG",128,22,1,"PAH",1,1,1,0)
This build is for patch GMRC*3*57.  The patch creates a new service in 
"PKG",128,22,1,"PAH",1,1,2,0)
123.5 that supports the VA Suicide Hotline.
"PKG",128,22,1,"PAH",1,1,3,0)
One post install routine adds the new serivce and also includes in the 
"PKG",128,22,1,"PAH",1,1,4,0)
sub-service of the All Services grouper.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","GMRCYP57")
0^^B7894057^n/a
"RTN","GMRCYP57",1,0)
GMRCYP57 ;BP/WAT - POST INSTALL FOR GMRC*3*57 ;JUL 24, 2007 0830
"RTN","GMRCYP57",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**57**;DEC 27, 1997;Build 10
"RTN","GMRCYP57",3,0)
 ;
"RTN","GMRCYP57",4,0)
 ;This patch creates a new entry into the Request Services file, #123.5.
"RTN","GMRCYP57",5,0)
 ;This new entry supports the entering of IFCs originating from the VA's Suicide Prevention Hotline
"RTN","GMRCYP57",6,0)
 ;External References
"RTN","GMRCYP57",7,0)
 ;$$LKUP^XUAF4(): Institution Lookup, ICR # 2171
"RTN","GMRCYP57",8,0)
 ;BMES^XPDUTL(): Output a Message, ICR# 10141
"RTN","GMRCYP57",9,0)
 ;^DIC
"RTN","GMRCYP57",10,0)
 ;MIX^DIC1
"RTN","GMRCYP57",11,0)
 ;UPDATE^DIE
"RTN","GMRCYP57",12,0)
 ;^DIK
"RTN","GMRCYP57",13,0)
 ;SVC^GMRC101H
"RTN","GMRCYP57",14,0)
 ;MSG^XQOR
"RTN","GMRCYP57",15,0)
 ;****LOCAL VARIABLES****
"RTN","GMRCYP57",16,0)
 ;FDA - FileMan Data Array
"RTN","GMRCYP57",17,0)
 ;GMRCERR - array to hold any errors returned by UPDATE^DIE
"RTN","GMRCYP57",18,0)
 ;GMRCIEN - Internal Entry Number Array - used to return the IEN of the newly added service and pass that IEN to the second UPDATE^DIE call as part of the FDA(2) array
"RTN","GMRCYP57",19,0)
 N FDA,GMRC,ERR,GMRCIEN,STAIEN,ERRMSG
"RTN","GMRCYP57",20,0)
 S ERRMSG(1)="INSTALL ABORTED - NO CHANGES WERE MADE TO YOUR SYSTEM."
"RTN","GMRCYP57",21,0)
 S ERRMSG(2)="COULD NOT FIND ""UPSTATE NEW YORK HCS"" IN INSTITUTION FILE"
"RTN","GMRCYP57",22,0)
 S ERRMSG(3)="CONFIRM FILE ENTRY AND RE-INSTALL"
"RTN","GMRCYP57",23,0)
 S ERRMSG(4)="IF STILL UNSUCCESSFUL, CONTACT VA NAT'L HELP DESK OR SUBMIT REMEDY TICKET"
"RTN","GMRCYP57",24,0)
 S STAIEN=$$LKUP^XUAF4(528) ;return IEN from INSTITUTION file for this station number
"RTN","GMRCYP57",25,0)
 I 'STAIEN D BMES^XPDUTL(ERRMSG)
"RTN","GMRCYP57",26,0)
 Q:'STAIEN
"RTN","GMRCYP57",27,0)
 D ADDENTRY
"RTN","GMRCYP57",28,0)
 D AD2ALSVC
"RTN","GMRCYP57",29,0)
 D ORDUPDT
"RTN","GMRCYP57",30,0)
 Q
"RTN","GMRCYP57",31,0)
ADDENTRY ; add new service to 123.5
"RTN","GMRCYP57",32,0)
 S FDA(1,123.5,"+1,",.01)="SUICIDE HOTLINE"
"RTN","GMRCYP57",33,0)
 S FDA(1,123.5134,"+2,+1,",.01)=STAIEN
"RTN","GMRCYP57",34,0)
 S FDA(1,123.5,"+1,",2)="2"
"RTN","GMRCYP57",35,0)
 D UPDATE^DIE("","FDA(1)","GMRCIEN","GMRCERR($J)")
"RTN","GMRCYP57",36,0)
 Q
"RTN","GMRCYP57",37,0)
AD2ALSVC ;add new service as sub-serivce of All Services
"RTN","GMRCYP57",38,0)
 S FDA(2,123.5,"?1,",.01)="ALL SERVICES"
"RTN","GMRCYP57",39,0)
 S FDA(2,123.51,"+4,?1,",.01)=$P(GMRCIEN(1),U,1)
"RTN","GMRCYP57",40,0)
 D UPDATE^DIE("","FDA(2)","GMRCIEN","GMRCERR($J)")
"RTN","GMRCYP57",41,0)
 Q
"RTN","GMRCYP57",42,0)
ORDUPDT ;update orderable items file with new service entry
"RTN","GMRCYP57",43,0)
 ;GMRCSRVC - ien of new service, GMRCSSNM - name of new service
"RTN","GMRCYP57",44,0)
 N DIC,GMRCMSG,GMRCSRVC,GMRCSSNM,GMRCACT
"RTN","GMRCYP57",45,0)
 S DIC="^GMR(123.5,",DIC(0)="B",X="SUICIDE HOTLINE" D ^DIC Q:Y=-1
"RTN","GMRCYP57",46,0)
 S GMRCSRVC=$P(Y,U)
"RTN","GMRCYP57",47,0)
 S GMRCSSNM=$P(Y,U,2)
"RTN","GMRCYP57",48,0)
 S GMRCACT="MUP"
"RTN","GMRCYP57",49,0)
 D SVC^GMRC101H(GMRCSRVC,GMRCSSNM,GMRCACT),MSG^XQOR("GMRC ORDERABLE ITEM UPDATE",.GMRCMSG)
"RTN","GMRCYP57",50,0)
 K X,Y
"RTN","GMRCYP57",51,0)
 Q
"RTN","GMRCYP57",52,0)
PRE ;clean up and old entries of SUICIDE CONSULTS from previous test versions
"RTN","GMRCYP57",53,0)
 N DIC,DIK,DA,SVCIEN,SBSVCIEN,SVCIENSH
"RTN","GMRCYP57",54,0)
 ;SVCIEN - IEN of "ALL SERVICES"
"RTN","GMRCYP57",55,0)
 ;SBSVCIEN - IEN corresponding to SUICIDE HOTLINE entry in SUBSERVICE of ALL SERVICES
"RTN","GMRCYP57",56,0)
 ;SVCIENSH - IEN of 'SUICIDE HOTLINE"
"RTN","GMRCYP57",57,0)
 S DIC="^GMR(123.5,",DIC(0)="B",X="ALL SERVICES" D ^DIC
"RTN","GMRCYP57",58,0)
 Q:Y=-1  S SVCIEN=$P(Y,U) K X,Y
"RTN","GMRCYP57",59,0)
 ;now i have IEN for all services
"RTN","GMRCYP57",60,0)
 S DIC="^GMR(123.5,1,10,",DIC(0)="",D="AC",X="SUICIDE HOTLINE" D MIX^DIC1
"RTN","GMRCYP57",61,0)
 ;1st piece is subservice ien, 2nd piece is top leve ien for suicide hotline
"RTN","GMRCYP57",62,0)
 Q:Y=-1
"RTN","GMRCYP57",63,0)
 S SBSVCIEN=$P(Y,U),SVCIENSH=$P(Y,U,2) K X,Y,D
"RTN","GMRCYP57",64,0)
 ;now i have ien for suicide subservice and ien for suicide top level entry
"RTN","GMRCYP57",65,0)
 ;remove suicide as a subservice of all services
"RTN","GMRCYP57",66,0)
 S DIK="^GMR(123.5,"_SVCIEN_",10,",DA=SBSVCIEN,DA(1)=SVCIEN D ^DIK
"RTN","GMRCYP57",67,0)
 Q:Y=-1
"RTN","GMRCYP57",68,0)
 N GMRCMSG,GMRCSRVC,GMRCSSNM,GMRCACT
"RTN","GMRCYP57",69,0)
 S DIC="^GMR(123.5,",DIC(0)="B",X="SUICIDE HOTLINE" D ^DIC Q:Y=-1
"RTN","GMRCYP57",70,0)
 S GMRCSRVC=$P(Y,U)
"RTN","GMRCYP57",71,0)
 S GMRCSSNM=$P(Y,U,2)
"RTN","GMRCYP57",72,0)
 S GMRCACT="MDC"
"RTN","GMRCYP57",73,0)
 D SVC^GMRC101H(GMRCSRVC,GMRCSSNM,GMRCACT),MSG^XQOR("GMRC ORDERABLE ITEM UPDATE",.GMRCMSG)
"RTN","GMRCYP57",74,0)
 ;remove suicide from 123.5
"RTN","GMRCYP57",75,0)
 S DIK="^GMR(123.5,",DA=SVCIENSH D ^DIK
"RTN","GMRCYP57",76,0)
 K X,Y
"RTN","GMRCYP57",77,0)
 Q
"VER")
8.0^22.0
"^DD",123.5,123.5,.01,0)
SERVICE NAME^RFX^^0;1^K:$L(X)>63!($L(X)<2)!'(X'?1P.E)!($O(^GMR(123.5,"B",X,0))'="") X
"^DD",123.5,123.5,.01,1,0)
^.1
"^DD",123.5,123.5,.01,1,1,0)
123.5^B
"^DD",123.5,123.5,.01,1,1,1)
S ^GMR(123.5,"B",$E(X,1,63),DA)=""
"^DD",123.5,123.5,.01,1,1,2)
K ^GMR(123.5,"B",$E(X,1,63),DA)
"^DD",123.5,123.5,.01,1,1,"%D",0)
^^2^2^2990903^^^^
"^DD",123.5,123.5,.01,1,1,"%D",1,0)
This is the regular cross-reference for this file allowing look-up by
"^DD",123.5,123.5,.01,1,1,"%D",2,0)
Service Name.
"^DD",123.5,123.5,.01,1,2,0)
123.5^AC1^MUMPS
"^DD",123.5,123.5,.01,1,2,1)
D SETAC^GMRCDDX
"^DD",123.5,123.5,.01,1,2,2)
D KILLAC^GMRCDDX
"^DD",123.5,123.5,.01,1,2,3)
This cross-reference is what helps maintain the alphabetical look-up of services.
"^DD",123.5,123.5,.01,1,2,"%D",0)
^^5^5^2971103^
"^DD",123.5,123.5,.01,1,2,"%D",1,0)
This cross-reference calls the GMRCDDX routine to set and kill "AC"
"^DD",123.5,123.5,.01,1,2,"%D",2,0)
cross-references that are defined for DD 123.51 (Sub-Service/Specialty
"^DD",123.5,123.5,.01,1,2,"%D",3,0)
multiple),.01 field.  The ACP cross reference helps identify all entries
"^DD",123.5,123.5,.01,1,2,"%D",4,0)
in file 123.5 which have the service being edited as a child.  For each
"^DD",123.5,123.5,.01,1,2,"%D",5,0)
occurrence as a child, the "AC" cross-reference is updated.
"^DD",123.5,123.5,.01,1,2,"DT")
2971103
"^DD",123.5,123.5,.01,3)
Type a unique name of a service or specialty that can receive consults.
"^DD",123.5,123.5,.01,21,0)
^.001^3^3^3000217^^^^
"^DD",123.5,123.5,.01,21,1,0)
This is the Name of a service or specialty which may receive consult/
"^DD",123.5,123.5,.01,21,2,0)
requests.  This may also be a name which represents a group of services
"^DD",123.5,123.5,.01,"DEL",1,0)
I $P(^GMR(123.5,DA,0),U)="SUICIDE HOTLINE" D EN^DDIOL("...Mandatory Entry.  Please see GMRC*3.0*57 for details...")
"^DD",123.5,123.5,.01,"DT")
3070725
"BLD",6733,6)
^50
**END**
**END**
