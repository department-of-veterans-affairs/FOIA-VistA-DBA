$TXT Created by BLOCKER,DAVE at VAALTL.ISCVAA.ISC-BIRM.VA.GOV  (KIDS) on WEDNESDAY, 12/30/98 at 14:22
=============================================================================
Run Date: JAN 15, 1999                     Designation: PSA*3*3
Package : PSA - DRUG ACCOUNTABILITY           Priority: Mandatory
Version : 3         SEQ #7                     Status: Released
=============================================================================

Associated patches: (v)PSA*3*1     <<= must be installed BEFORE `PSA*3*3'

Subject: PROCESSING & VERIFICATION FIXES

Category: 
  - Routine

Description: 
============

  1). The Drug Transaction History [PSA DRUG DISPLAY] option, has a problem
  building the array of drugs within the option. The result is
  an allocation error within the symbol table. The variable being used
  cannot hold all the data, so the storage method was changed to a 
  temporary global.
  
  2). The inability to enter decimal digits for the DISPENSE UNITS PER ORDER
  UNIT field (#10), in the DRUG ACCOUNTABILITY ORDER file (#58.811) has
  been corrected.
  
  3). If the processor disagreed with the value of the Order Unit sent by
  the vendor, they could select another order unit. In some instances the
  internal entry number for the new selected order unit would match that 
  of the one sent by the vendor. In these cases, the selected order unit is 
  ignored.
  
  4). References to a test file that never made it to release have also been
  eliminated to avoid an error while processing.
  
  5). During processing of invoices, if an incorrect Electronic signature
  code was entered to start the process, the program continued with the 
  processing.
  
  6). When an invoice is being uploaded, and a drug is found that has more  
  than one vendor stock number, the VSN is concatenated into the temporary
  global's NDC field. When a match is tried on the NDC field in the drug
  file, an error occurs because of the addition of the VSN.
  
  7). In the Credit Resolution [PSA CREDIT RESOLUTION] option, if the drug
  name was changed, then the option would skip the quantity adjustment
  portion, thereby not allowing credits to be entered for the line item
  of the invoice. The checking for drug name adjustments has been removed.
  
  8). When processing an order, the system executes a background job to file
  the order in the DRUG ACCOUNTABILITY ORDER file (#58.811).
  When the program  tried to file the name of the person who processed the
  order, it would fail the input transform and exit the DIE call before
  filing the rest of the data elements.
  
  9). The AR/WS package calls a routine in Drug Accountability that gathers
  dispensing data. When Drug Accountability starts checking for drugs
  being tracked at multiple inpatient sites, a null subscript error occurs.
  
  10). When the All Location Dispense/Purge [PSA IV ALL LOCATIONS] option
  is performed as a background job each evening, it searches for drugs whose
  stock level has fallen below the re-order level. If such occurrences are
  found, these items are placed into a mail message. There is a problem 
  with the controlled substances entries, because their vendor stock number
  is not placed into the message formatting parameters, therefore an
  undefined error is occurring.
  
  11). When invoice data is sent to a multi-divisional facility and uploaded,
  invoices can be deleted or merged together. This is due to the vendor's
  program treating each division as its own entity.
  
  13). On some occasions the person whose last 4 digits of their SSN that
  matched the internal entry number of the person who is supposed to be
  stored was replaced. All entries are now forcibly stuffed.
  
  14). When the nightly back-ground job is trying to store the Unit Dose 
  data, it will try to stuff the data into an inactive pharmacy location,
  when this fails, it will update nothing.
  
  15a). The option Outpatient Dispensing (All Drugs) [PSA OP ALL DRUGS], 
  does not ask the user for device selection for output to a printer, 
  therefore when it is executing as a back-ground job, it has no place to 
  print the data.
  
  15b). When the user selects a date range for this report, the dates are 
  confused later on in the program, so the search dates could far exceed 
  what was input.
  
  15c). When the program tried to obtain the information about the Outpatient
  data that was returned to stock, there was a code problem asking for the
  zero piece of a node.
  
  15d). Prescription data that was released through CMOP, is not excluded
  from the report.
  
  16). When editing an IV Additive Drug in the Enter/Edit a Drug 
  [PSA DRUG ENTER/EDIT] option, the dispensing unit by the IV module was
  displayed as a numeric instead of its set of codes value.
  
  17). During processing, there were occurrences of the Stock Level and
  Reorder Level's values being switched, this also occurred after the
  verification process, when the Stock level was set to the reorder level.
  
  18). During processing, if an order number exists in the files that is
  almost identical to the one being processed/verified, the one being  
  processed will be ignored, and the resulting error will be in routine
  PSAPROC7 with the error occurring in FILE^DICN.
  
  19). When the Drug Accountability package files invoice data into the
  DRUG ACCOUNTABILITY STATS file (#58.8), drugs that are marked as
  inactive in the DRUG file (#50), are included in the process. The 
  screen to prevent inactive drugs from being added does prevent the drug
  from being entered into the file, but due to the lack of checks further
  on down the line, the entry's balance is updated (even though there is
  not a .01 field). This patch will display that the drug is inactive in 
  several places within the package, and it will also correct the entries
  currently on file that do not have a .01 field for the drug entered
  in the DRUG ACCOUNTABILITY STATS file (#58.8).
  
  20). On some occasions, incomplete invoice data is uploaded into VISTA,
  this results in errors later in the processing procedures. Incomplete
  invoices are now deleted upon discovery.
  
  21). When the verification error report is sent to a printer, the variable
  that contains the invoice data, was not saved to be used by the print job.
  
  22). When invoices are verified, the drug balances in the DRUG
  ACCOUNTABILITY STATS file (#58.8) are supposed to be updated. The new
  values are calculated by multiplying the invoiced quantity by the
  DISPENSED UNIT PER ORDER UNIT field (#10), in the DRUG ACCOUNTABILITY
  ORDER file (#58.811). If this field was not defined, no updating occurred.
  Checks have been added to ensure the quantity is adjusted by using the
  DISPENSE UNIT PER ORDER UNIT field (#15) of the DRUG file (#50) if
  necessary.
  Associated NOISs
  ================
  BRK-0698-10658
  BRX-0598-11322
  CHS-0898-41212
  EKH-0698-40385
  HUN-1197-20363
  IOW-0598-41172
  IOW-0598-41610
  IOW-0398-42726
  IOW-0598-40107
  IOW-0598-40112
  IOW-0598-40114
  IOW-0598-40870
  IOW-0598-42345
  IOW-0698-41320
  IOW-1098-41685
  NHM-0598-11138
  NHM-0598-11671
  NHM-0698-10731
  NHM-0698-10735
  NHM-0698-10739
  PTH-0598-21655
  PTH-0598-21713
  PTH-0598-21957
  PTH-0698-20514
  PTH-0698-20914
  PTH-0698-21864
  SPO-0698-50973
  
  Test Sites
  ==========
  HUNTINGTON, WV
  IOWA CITY, IA
  PITTSBURGH, PA
  PORTLAND, OR
  MURFREESBORO, TN
  NORTH HAMPTON, MA
  TOPEKA, KS
  
  Routine Information:
  ====================
  The second line now reads as follows:
  
  <TAB>;;3.0; DRUG ACCOUNTABILITY/INVENTORY INTERFACE;**[patch list]**; 10/27/97
  
  CHECK^XTSUMBLD results:
  
  Routine  Before Patch   After Patch     Patch List
  -------  ------------   -----------     ----------
  PSACOST    14783760       14839113             3
  PSACREDO   26649127       26339970             3
  PSACREDR   14273862       14737181             3
  PSADJ      23789288       23794635             3
  PSADRUGP   11872307       12414836             3
  PSAFIX       N/A           2140174             3
  PSAHIS     13807754       13942374             3
  PSAHIS1    18436535       18461905             3
  PSAOP      21695511       22047889             3
  PSAOP2     20232617       17645118             3
  PSAOP4     5206859        5416467              3
  PSAORDP1   27731155       29536552             3
  PSAPROC    22417506       23001281             3
  PSAPROC3   28579694       27987674             3
  PSAPROC4   21937272       22230314             3
  PSAPROC5   23171401       23210459             3
  PSAPROC6   30695461       30343262             3
  PSAPROC7   16502381       15061035             3
  PSAPROC8   24719696       24719890             3
  PSAPSI     16173511       21045147             3
  PSAPSI2    16081772       16179066             3
  PSAPSI4    2393228        2380666              3
  PSAREORD   15081925       15276579             3
  PSARWS     10478249       11036019             3
  PSAUDP      5937624        6158238             3
  PSAUP1     17354244       19193298             3
  PSAUP4     25600678       25802889             3
  PSAUP5     20799726       21619902             3
  PSAUP6      5921674        5957782             3
  PSAUTL1    20691221       20829786             3
  PSAUTL4    13772386       14057491             3
  PSAVER2    20211928       20246232             3
  PSAVER3    26343675       27822316             3
  PSAVER6    15445732       16191522            1,3
  
  
  Installation Instructions:
  ==========================
  
  Suggested time to install: non-peak requirement hours
  
  1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu.
  
  2. Review your mapped set. If the routines are mapped, they should
     be removed from the mapped set at this time.
  
  3. From the Kernel Installation and Distribution System menu, select
     the Installation menu.
  
  4. From this menu, you may select to use the following options
     (when prompted for INSTALL NAME, enter PSA*3.0*3)
    a. Backup a Transport Global - this option will create a backup
       message of any routines exported with the patch. It will NOT
       backup any other changes such as DDs or templates.
    b. Compare Transport Global to Current System - this option will
       allow you to view all changes that will be made when the patch
       is installed. It compares all components of the patch (routines,
       DDs, templates, etc.,).
    c. Verify Checksums in Transport Global - this option will ensure
       the integrity of the routines that are in the transport global.
  
  5. Use the Install Package(s) option and select the package PSA*3.0*3.
  
  6. When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
     Protocols? YES//' respond  NO.
  
  7. If any routines were unmapped as part of step 2, they should be
     returned to the mapped set once the installation has run to
     completion.

Routine Information:
====================

Routine Name:
  - PSAUP5


Routine Checksum:

Routine Name:
  - PSAHIS


Routine Checksum:

Routine Name:
  - PSAHIS1


Routine Checksum:

Routine Name:
  - PSAPROC


Routine Checksum:

Routine Name:
  - PSAVER6


Routine Checksum:

Routine Name:
  - PSACREDR


Routine Checksum:

Routine Name:
  - PSAPROC7


Routine Checksum:

Routine Name:
  - PSARWS


Routine Checksum:

Routine Name:
  - PSAREORD


Routine Checksum:

Routine Name:
  - PSAUP1


Routine Checksum:

Routine Name:
  - PSAVER2


Routine Checksum:

Routine Name:
  - PSAVER3


Routine Checksum:

Routine Name:
  - PSAUDP


Routine Checksum:

Routine Name:
  - PSAOP2


Routine Checksum:

Routine Name:
  - PSAOP4


Routine Checksum:

Routine Name:
  - PSACOST


Routine Checksum:

Routine Name:
  - PSACREDO


Routine Checksum:

Routine Name:
  - PSADJ


Routine Checksum:

Routine Name:
  - PSADRUGP


Routine Checksum:

Routine Name:
  - PSAORDP1


Routine Checksum:

Routine Name:
  - PSAPROC3


Routine Checksum:

Routine Name:
  - PSAUP4


Routine Checksum:

Routine Name:
  - PSAUTL1


Routine Checksum:

Routine Name:
  - PSAUTL4


Routine Checksum:

Routine Name:
  - PSAOP


Routine Checksum:

Routine Name:
  - PSAPROC6


Routine Checksum:

Routine Name:
  - PSAPSI4


Routine Checksum:

Routine Name:
  - PSAPROC8


Routine Checksum:

Routine Name:
  - PSAUP6


Routine Checksum:

Routine Name:
  - PSAPROC5


Routine Checksum:

Routine Name:
  - PSAPROC4


Routine Checksum:

Routine Name:
  - PSAPSI


Routine Checksum:

Routine Name:
  - PSAPSI2


Routine Checksum:

Routine Name:
  - PSAFIX


Routine Checksum:

=============================================================================
User Information:                               
Entered By  : BLOCKER,DAVE                   Date Entered : NOV 10, 1997
Completed By: DAVIS,DOUG                    Date Completed: JAN 14, 1999
Released By : CONSENTINO,ALBERT             Date Released : JAN 15, 1999
=============================================================================


Packman Mail Message:
=====================

$END TXT
